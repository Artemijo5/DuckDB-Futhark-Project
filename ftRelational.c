// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
struct futhark_u8_2d;
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1);
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1);
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data);
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1);
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);

// Opaque values
struct futhark_opaque_joinPairs_bsq;
struct futhark_opaque_joinPairs_double;
struct futhark_opaque_joinPairs_float;
struct futhark_opaque_joinPairs_int;
struct futhark_opaque_joinPairs_long;
struct futhark_opaque_joinPairs_short;
struct futhark_opaque_partitionInfo;
struct futhark_opaque_partitionedSet_GFTR;
struct futhark_opaque_partitionedSet_GFUR;
struct futhark_opaque_radix_hashTable;
struct futhark_opaque_sortInfo_double;
struct futhark_opaque_sortInfo_float;
struct futhark_opaque_sortInfo_int;
struct futhark_opaque_sortInfo_long;
struct futhark_opaque_sortInfo_short;
struct futhark_opaque_sortStruct_double;
struct futhark_opaque_sortStruct_float;
struct futhark_opaque_sortStruct_int;
struct futhark_opaque_sortStruct_long;
struct futhark_opaque_sortStruct_short;
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj);
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs);
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj);
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs);
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj);
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs);
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj);
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs);
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj);
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs);
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj);
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs);
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj);
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n);
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj);
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth);
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks);
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj);
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n);
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx);
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj);
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs);
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj);
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs);
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj);
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs);
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj);
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs);
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj);
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs);
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj);
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj);
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj);
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj);
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj);
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL);

// Entry points
int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4);
int futhark_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4);
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0);
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0);
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4);
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3);
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4);
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4);
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4);
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4);
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4);
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4);
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1);
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1);
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1);
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1);
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1);
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0);
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0);
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0);
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0);
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0);
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6, const int32_t in7);
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6, const int32_t in7);
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int16_t in1, const struct futhark_f64_1d *in2);
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int16_t in1, const struct futhark_f32_1d *in2);
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int16_t in1, const struct futhark_i32_1d *in2);
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int16_t in1, const struct futhark_i64_1d *in2);
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int16_t in1, const struct futhark_i16_1d *in2);
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int16_t in0, const struct futhark_opaque_sortStruct_double *in1);
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int16_t in0, const struct futhark_opaque_sortStruct_float *in1);
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int16_t in0, const struct futhark_opaque_sortStruct_int *in1);
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int16_t in0, const struct futhark_opaque_sortStruct_long *in1);
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int16_t in0, const struct futhark_opaque_sortStruct_short *in1);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_c
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
};
struct tuning_params {
    int dummy;
};
static const int num_tuning_params = 0;
static const char *tuning_param_names[] = {NULL};
static const char *tuning_param_vars[] = {NULL};
static const char *tuning_param_classes[] = {NULL};
static int64_t tuning_param_defaults[] = {0};
// Start of backends/c.h

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char *cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
};

static void backend_context_config_setup(struct futhark_context_config* cfg) {
  (void)cfg;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  (void)cfg;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config* cfg, const char *param_name, size_t param_value) {
  (void)cfg; (void)param_name; (void)param_value;
  return 1;
}

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
};

int backend_context_setup(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  (void)ctx;
}

int futhark_context_sync(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

// End of backends/c.h

struct program {
    int dummy;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_133595, struct memblock *mem_out_p_133596, struct memblock *mem_out_p_133597, int64_t *out_prim_out_133598, struct memblock pR_mem_133175, struct memblock pS_mem_133176, struct memblock bounds_mem_133177, struct memblock depths_mem_133178, struct memblock first_info_idx_mem_133179, struct memblock last_info_idx_mem_133180, int64_t nR_119031, int64_t b_119032, int64_t nS_119033, int64_t dz2081U_119034, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035, int32_t radix_sizze_119036, int32_t maxDepth_119041);
FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct memblock *mem_out_p_133625, struct memblock *mem_out_p_133626, struct memblock *mem_out_p_133627, int64_t *out_prim_out_133628, struct memblock pR_mem_133175, struct memblock pS_mem_133176, struct memblock bounds_mem_133177, struct memblock depths_mem_133178, struct memblock first_info_idx_mem_133179, struct memblock last_info_idx_mem_133180, int64_t nR_120163, int64_t b_120164, int64_t nS_120165, int64_t dz2081U_120166, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167, int32_t radix_sizze_120168, int32_t maxDepth_120173);
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_133648, struct memblock ks_mem_133175, int64_t n_62709);
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_133649, struct memblock ks_mem_133175, int64_t n_62532);
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_133650, struct memblock ks_mem_133175, int64_t n_62181);
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_133651, struct memblock ks_mem_133175, int64_t n_62355);
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_133652, struct memblock ks_mem_133175, int64_t n_62007);
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_133653, struct memblock *mem_out_p_133654, int64_t *out_prim_out_133655, int32_t *out_prim_out_133656, struct memblock pXs_mem_133175, int64_t n_115648, int64_t b_115649, int32_t radix_sizze_115650, int64_t offset_115652, int64_t sizze_thresh_115653, int32_t max_depth_115654);
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_133664, struct memblock *mem_out_p_133665, int64_t *out_prim_out_133666, struct memblock pXs_mem_133175, struct memblock bounds_mem_133176, struct memblock depths_mem_133177, int64_t n_116366, int64_t b_116367, int64_t dz2080U_116368, int64_t dz2081U_116369, int32_t radix_sizze_116370, int32_t maxDepth_116374, int64_t scatter_psizze_116375);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_133671, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_66322, int64_t dz2083U_66323, int64_t incr_66324, int64_t psizze_66325, int64_t pL_bytes_66327);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_133672, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65858, int64_t dz2083U_65859, int64_t incr_65860, int64_t psizze_65861);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133673, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_67830, int64_t n_67831, int64_t incr_67832, int64_t psizze_67833);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_133674, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65578, int64_t dz2083U_65579, int64_t incr_65580, int64_t psizze_65581);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133675, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_67529, int64_t n_67530, int64_t incr_67531, int64_t psizze_67532);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_133676, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65018, int64_t dz2083U_65019, int64_t incr_65020, int64_t psizze_65021);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133677, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_66927, int64_t n_66928, int64_t incr_66929, int64_t psizze_66930);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_133678, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65298, int64_t dz2083U_65299, int64_t incr_65300, int64_t psizze_65301);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133679, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_67228, int64_t n_67229, int64_t incr_67230, int64_t psizze_67231);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_133680, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_64738, int64_t dz2083U_64739, int64_t incr_64740, int64_t psizze_64741);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133681, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_66626, int64_t n_66627, int64_t incr_66628, int64_t psizze_66629);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_133682, struct memblock *mem_out_p_133683, struct memblock *mem_out_p_133684, int64_t *out_prim_out_133685, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_110890, int64_t nS_110891, int64_t offset_R_110894, int64_t offset_S_110895, int64_t partitionSizze_110896, int64_t scatter_psizze_110897);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_133696, struct memblock *mem_out_p_133697, struct memblock *mem_out_p_133698, int64_t *out_prim_out_133699, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_108656, int64_t nS_108657, int64_t offset_R_108660, int64_t offset_S_108661, int64_t partitionSizze_108662, int64_t scatter_psizze_108663);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_133710, struct memblock *mem_out_p_133711, struct memblock *mem_out_p_133712, int64_t *out_prim_out_133713, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_104200, int64_t nS_104201, int64_t offset_R_104204, int64_t offset_S_104205, int64_t partitionSizze_104206, int64_t scatter_psizze_104207);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_133724, struct memblock *mem_out_p_133725, struct memblock *mem_out_p_133726, int64_t *out_prim_out_133727, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_106422, int64_t nS_106423, int64_t offset_R_106426, int64_t offset_S_106427, int64_t partitionSizze_106428, int64_t scatter_psizze_106429);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_133738, struct memblock *mem_out_p_133739, struct memblock *mem_out_p_133740, int64_t *out_prim_out_133741, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_101966, int64_t nS_101967, int64_t offset_R_101970, int64_t offset_S_101971, int64_t partitionSizze_101972, int64_t scatter_psizze_101973);
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_133752, struct memblock eta_p_mem_133175, int64_t nz2080U_62786);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_133753, struct memblock *mem_out_p_133754, struct memblock xs_mem_133175, int64_t n_99501, int64_t incr_99502);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_133765, struct memblock *mem_out_p_133766, struct memblock xs_mem_133175, int64_t n_97356, int64_t incr_97357);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_133777, struct memblock *mem_out_p_133778, struct memblock xs_mem_133175, int64_t n_93070, int64_t incr_93071);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_133789, struct memblock *mem_out_p_133790, struct memblock xs_mem_133175, int64_t n_95211, int64_t incr_95212);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_133801, struct memblock *mem_out_p_133802, struct memblock xs_mem_133175, int64_t n_90925, int64_t incr_90926);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_133813, struct memblock *mem_out_p_133814, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_84397, int64_t b_84398);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_133825, struct memblock *mem_out_p_133826, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_82032, int64_t b_82033);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_133837, struct memblock *mem_out_p_133838, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_77312, int64_t b_77313);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_133849, struct memblock *mem_out_p_133850, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_79667, int64_t b_79668);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_133861, struct memblock *mem_out_p_133862, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_74947, int64_t b_74948);
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_133873, struct memblock eta_p_mem_133175, int64_t nz2080U_62746);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_133874, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_64456, int64_t incr_64457, int64_t block_sizze_64458);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_133875, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_64122, int64_t incr_64123, int64_t block_sizze_64124);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_133876, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_63454, int64_t incr_63455, int64_t block_sizze_63456);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_133877, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_63788, int64_t incr_63789, int64_t block_sizze_63790);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_133878, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_63120, int64_t incr_63121, int64_t block_sizze_63122);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_133879, struct memblock *mem_out_p_133880, struct memblock xs_mem_133175, struct memblock pL_mem_133176, int64_t n_113463, int64_t b_113464, int64_t pL_b_113465, int16_t block_sizze_113466, int64_t gather_psizze_113467, int32_t radix_sizze_113468, int64_t sizze_thresh_113471, int32_t max_depth_113472, int32_t bit_step_113473);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133893, struct memblock *mem_out_p_133894, struct memblock xs_mem_133175, int64_t n_114834, int64_t b_114835, int16_t block_sizze_114836, int64_t gather_psizze_114837, int32_t radix_sizze_114838, int64_t offset_114840, int64_t sizze_thresh_114841, int32_t max_depth_114842, int32_t bit_step_114843);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_133906, struct memblock *mem_out_p_133907, struct memblock xs_mem_133175, int64_t n_88779, int64_t incr_88780, int16_t block_sizze_88781);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_133911, struct memblock *mem_out_p_133912, struct memblock xs_mem_133175, int64_t n_87890, int64_t incr_87891, int16_t block_sizze_87892);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_133916, struct memblock *mem_out_p_133917, struct memblock xs_mem_133175, int64_t n_86133, int64_t incr_86134, int16_t block_sizze_86135);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_133921, struct memblock *mem_out_p_133922, struct memblock xs_mem_133175, int64_t n_87001, int64_t incr_87002, int16_t block_sizze_87003);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_133926, struct memblock *mem_out_p_133927, struct memblock xs_mem_133175, int64_t n_85265, int64_t incr_85266, int16_t block_sizze_85267);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_133931, struct memblock *mem_out_p_133932, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_72476, int64_t b_72477, int16_t block_sizze_72478);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_133937, struct memblock *mem_out_p_133938, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_71526, int64_t b_71527, int16_t block_sizze_71528);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_133943, struct memblock *mem_out_p_133944, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_69692, int64_t b_69693, int16_t block_sizze_69694);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_133949, struct memblock *mem_out_p_133950, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_70580, int64_t b_70581, int16_t block_sizze_70582);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_133955, struct memblock *mem_out_p_133956, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_68798, int64_t b_68799, int16_t block_sizze_68800);
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_11872(struct futhark_context *ctx, struct memblock *mem_out_p_133961, struct memblock *mem_out_p_133962, int64_t *out_prim_out_133963, int64_t *out_prim_out_133964, int32_t *out_prim_out_133965, struct memblock pXs_mem_133175, int64_t n_112609, int64_t b_112610, int32_t curDepth_112611, int32_t i_112613, int32_t j_112614);
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_133971, int32_t bit_68176, int16_t x_68177);
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_133972, int32_t bit_69958, int64_t x_69959);
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5357(struct futhark_context *ctx, int64_t *out_prim_out_133973, int64_t upper_bound_72505, int64_t n_72506);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11373(struct futhark_context *ctx, struct memblock *mem_out_p_133974, struct memblock nameless_mem_133175, int64_t n_84422, int64_t incr_84423);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11394(struct futhark_context *ctx, struct memblock *mem_out_p_133975, struct memblock nameless_mem_133175, int64_t n_85290, int64_t incr_85291);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11416(struct futhark_context *ctx, struct memblock *mem_out_p_133976, struct memblock nameless_mem_133175, int64_t n_86158, int64_t incr_86159);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11438(struct futhark_context *ctx, struct memblock *mem_out_p_133977, struct memblock nameless_mem_133175, int64_t n_87026, int64_t incr_87027);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11459(struct futhark_context *ctx, struct memblock *mem_out_p_133978, struct memblock nameless_mem_133175, int64_t n_87915, int64_t incr_87916);
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_10477(struct futhark_context *ctx, int64_t *out_prim_out_133979, int64_t *out_prim_out_133980, int64_t *out_prim_out_133981, int64_t *out_prim_out_133982, int64_t *out_prim_out_133983, int64_t slo_72735, int64_t shi_72736, int64_t tlo_72737, int64_t thi_72738, int64_t count_72739);
FUTHARK_FUN_ATTR int futrts_partitioned_scatter_11973(struct futhark_context *ctx, struct memblock *mem_out_p_133984, struct memblock dest_mem_133175, struct memblock is_mem_133176, struct memblock vs_mem_133177, int64_t nd_115892, int64_t n_115893, int64_t psizze_115894);
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_133986, int32_t bit_67870, int8_t x_67871, int32_t b_67872);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
struct futhark_u8_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 1 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) (dim0 * dim1) * 1);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 1 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] * arr->shape[1]) * 1);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        if (1 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 1 * (i0 * arr->shape[1] + i1 * 1), 1);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i16_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 2 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 2);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 2 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 2);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (2 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 2 * (i0 * 1), 2);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_sortStruct_short {
    struct futhark_i16_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_short *v = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i16_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_short *obj = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int16_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i16_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_int {
    struct futhark_i32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_int *v = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_int *obj = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int32_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_long {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_long *v = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_long *obj = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_float {
    struct futhark_f32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_float *v = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_float *obj = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(float);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_double {
    struct futhark_f64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_double *v = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_double *obj = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(double);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_short {
    struct futhark_i64_1d *v0;
    struct futhark_i16_1d *v1;
};
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs)
{
    struct futhark_opaque_sortInfo_short *v = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i16_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_short *obj = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i16_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_int {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
};
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_int *v = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_int *obj = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_long *v = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_long *obj = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_float {
    struct futhark_i64_1d *v0;
    struct futhark_f32_1d *v1;
};
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_float *v = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_float *obj = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_double {
    struct futhark_i64_1d *v0;
    struct futhark_f64_1d *v1;
};
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_double *v = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_double *obj = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_short {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i16_1d *v2;
};
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs)
{
    struct futhark_opaque_joinPairs_short *v = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i16_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_short *obj = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i16_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_int {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i32_1d *v2;
};
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_int *v = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_int *obj = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_long *v = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_long *obj = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_1d *v2;
};
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_float *v = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_float *obj = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
};
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_double *v = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_double *obj = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFTR {
    struct futhark_u8_2d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_partitionedSet_GFTR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_u8_2d));
        *v->v0 = *f_ks;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFTR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(int8_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_u8_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFUR {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks)
{
    struct futhark_opaque_partitionedSet_GFUR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_ks;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFUR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionInfo {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
    int32_t v2;
};
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int32_t v;
    
    v = obj->v2;
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth)
{
    struct futhark_opaque_partitionInfo *v = malloc(sizeof(struct futhark_opaque_partitionInfo));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_bounds;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_depths;
        (void) (*v->v1->mem.references)++;
    }
    v->v2 = f_maxDepth;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
    }
    return ret;
}
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionInfo *obj = malloc(sizeof(struct futhark_opaque_partitionInfo));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_radix_hashTable {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx)
{
    struct futhark_opaque_radix_hashTable *v = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_first_info_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_last_info_idx;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_radix_hashTable *obj = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_bsq {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_u8_2d *v2;
};
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v2, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs)
{
    struct futhark_opaque_joinPairs_bsq *v = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_u8_2d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_bsq *obj = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_u8_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_133595, struct memblock *mem_out_p_133596, struct memblock *mem_out_p_133597, int64_t *out_prim_out_133598, struct memblock pR_mem_133175, struct memblock pS_mem_133176, struct memblock bounds_mem_133177, struct memblock depths_mem_133178, struct memblock first_info_idx_mem_133179, struct memblock last_info_idx_mem_133180, int64_t nR_119031, int64_t b_119032, int64_t nS_119033, int64_t dz2081U_119034, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035, int32_t radix_sizze_119036, int32_t maxDepth_119041)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133182_cached_sizze_133599 = 0;
    unsigned char *mem_133182 = NULL;
    int64_t mem_133184_cached_sizze_133600 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133186_cached_sizze_133601 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133188_cached_sizze_133602 = 0;
    unsigned char *mem_133188 = NULL;
    int64_t mem_133190_cached_sizze_133603 = 0;
    unsigned char *mem_133190 = NULL;
    int64_t mem_133192_cached_sizze_133604 = 0;
    unsigned char *mem_133192 = NULL;
    int64_t mem_133211_cached_sizze_133605 = 0;
    unsigned char *mem_133211 = NULL;
    int64_t mem_133221_cached_sizze_133606 = 0;
    unsigned char *mem_133221 = NULL;
    int64_t mem_133222_cached_sizze_133607 = 0;
    unsigned char *mem_133222 = NULL;
    int64_t mem_133235_cached_sizze_133608 = 0;
    unsigned char *mem_133235 = NULL;
    int64_t mem_133236_cached_sizze_133609 = 0;
    unsigned char *mem_133236 = NULL;
    int64_t mem_133249_cached_sizze_133610 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133250_cached_sizze_133611 = 0;
    unsigned char *mem_133250 = NULL;
    int64_t mem_133263_cached_sizze_133612 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133264_cached_sizze_133613 = 0;
    unsigned char *mem_133264 = NULL;
    int64_t mem_133268_cached_sizze_133614 = 0;
    unsigned char *mem_133268 = NULL;
    int64_t mem_133269_cached_sizze_133615 = 0;
    unsigned char *mem_133269 = NULL;
    int64_t mem_133282_cached_sizze_133616 = 0;
    unsigned char *mem_133282 = NULL;
    int64_t mem_133283_cached_sizze_133617 = 0;
    unsigned char *mem_133283 = NULL;
    int64_t mem_133284_cached_sizze_133618 = 0;
    unsigned char *mem_133284 = NULL;
    int64_t mem_133285_cached_sizze_133619 = 0;
    unsigned char *mem_133285 = NULL;
    int64_t mem_133298_cached_sizze_133620 = 0;
    unsigned char *mem_133298 = NULL;
    int64_t mem_133299_cached_sizze_133621 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133319_cached_sizze_133622 = 0;
    unsigned char *mem_133319 = NULL;
    int64_t mem_133327_cached_sizze_133623 = 0;
    unsigned char *mem_133327 = NULL;
    int64_t mem_133329_cached_sizze_133624 = 0;
    unsigned char *mem_133329 = NULL;
    struct memblock mem_133399;
    
    mem_133399.references = NULL;
    
    struct memblock mem_133383;
    
    mem_133383.references = NULL;
    
    struct memblock mem_133381;
    
    mem_133381.references = NULL;
    
    struct memblock mem_param_tmp_133584;
    
    mem_param_tmp_133584.references = NULL;
    
    struct memblock mem_param_tmp_133583;
    
    mem_param_tmp_133583.references = NULL;
    
    struct memblock mem_133361;
    
    mem_133361.references = NULL;
    
    struct memblock mem_133359;
    
    mem_133359.references = NULL;
    
    struct memblock mem_param_133357;
    
    mem_param_133357.references = NULL;
    
    struct memblock mem_param_133354;
    
    mem_param_133354.references = NULL;
    
    struct memblock ext_mem_133378;
    
    ext_mem_133378.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock mem_133351;
    
    mem_133351.references = NULL;
    
    struct memblock mem_133343;
    
    mem_133343.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t i32_res_123532 = sext_i32_i64(radix_sizze_119036);
    bool nonnegative_123533 = sle64((int64_t) 0, i32_res_123532);
    bool nonzzero_cert_123534;
    
    if (!nonnegative_123533) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:8:47-309:53\n   #1  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_123535 = shl64((int64_t) 1, i32_res_123532);
    bool assert_cond_123536 = arg_123535 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035;
    bool assert_c_123537;
    
    if (!assert_cond_123536) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftRelational.fut:309:4-311:18\n   #1  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t getRadix_arg1_127855 = sub32(radix_sizze_119036, 1);
    int32_t i64_res_127856 = sext_i64_i32(b_119032);
    int32_t zm_lhs_127857 = mul32(8, i64_res_127856);
    int32_t min_arg1_127858 = sub32(zm_lhs_127857, 1);
    int32_t min_res_127859 = smin32(getRadix_arg1_127855, min_arg1_127858);
    int32_t i32_arg0_127863 = sub32(i64_res_127856, 1);
    int64_t i32_res_127864 = sext_i32_i64(i32_arg0_127863);
    int32_t zm_rhs_127866 = sdiv32(min_res_127859, 8);
    int32_t zm_lhs_127867 = sub32(i64_res_127856, zm_rhs_127866);
    int32_t i32_arg0_127868 = sub32(zm_lhs_127867, 1);
    int64_t i32_res_127869 = sext_i32_i64(i32_arg0_127868);
    int64_t zm_lhs_127870 = mul64((int64_t) 8, b_119032);
    int64_t min_arg1_127871 = sub64(zm_lhs_127870, (int64_t) 1);
    int64_t min_res_127872 = smin64(i32_res_127869, min_arg1_127871);
    int32_t lastBit_127874 = smod32(min_res_127859, 8);
    int32_t zm_lhs_127877 = sub32(8, lastBit_127874);
    int32_t i32_arg0_127878 = sub32(zm_lhs_127877, 1);
    int8_t unsign_arg0_127879 = zext_i32_i8(i32_arg0_127878);
    int8_t unsign_arg0_127880 = lshr8((int8_t) -1, unsign_arg0_127879);
    bool x_127889 = sle64((int64_t) 0, i32_res_127864);
    bool y_127890 = slt64(i32_res_127864, b_119032);
    bool bounds_check_127891 = x_127889 && y_127890;
    bool index_certs_127892;
    
    if (!bounds_check_127891) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:37:13-42\n   #2  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_127900 = sle64((int64_t) 0, min_res_127872);
    bool y_127901 = slt64(min_res_127872, b_119032);
    bool bounds_check_127902 = x_127900 && y_127901;
    bool index_certs_127903;
    
    if (!bounds_check_127902) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_127872, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:37:13-42\n   #2  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_lhs_127911 = add32(8, radix_sizze_119036);
    int32_t zs_lhs_127912 = sub32(zm_lhs_127911, 1);
    int32_t i32_arg0_127913 = sdiv32(zs_lhs_127912, 8);
    int64_t i32_res_127914 = sext_i32_i64(i32_arg0_127913);
    bool bounds_invalid_upwards_127915 = slt64(i32_res_127914, (int64_t) 0);
    bool valid_127916 = !bounds_invalid_upwards_127915;
    bool range_valid_c_127917;
    
    if (!valid_127916) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) i32_res_127914, " is invalid.", "-> #0  ftHashJoin.fut:41:15-30\n   #1  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zeze_rhs_123782 = sub64(dz2081U_119034, (int64_t) 1);
    int64_t bytes_133181 = (int64_t) 8 * nR_119031;
    
    if (mem_133182_cached_sizze_133599 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133182, &mem_133182_cached_sizze_133599, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133184_cached_sizze_133600 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133600, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133186_cached_sizze_133601 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133601, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133188_cached_sizze_133602 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133188, &mem_133188_cached_sizze_133602, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133190_cached_sizze_133603 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133190, &mem_133190_cached_sizze_133603, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133192_cached_sizze_133604 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133192, &mem_133192_cached_sizze_133604, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133211_cached_sizze_133605 < b_119032) {
        err = lexical_realloc(ctx, &mem_133211, &mem_133211_cached_sizze_133605, b_119032);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133109;
    int64_t discard_133110;
    int64_t defunc_res_133031;
    int64_t scanacc_133093;
    int64_t scanacc_133094;
    int64_t redout_133097;
    
    scanacc_133093 = (int64_t) 0;
    scanacc_133094 = (int64_t) 0;
    redout_133097 = (int64_t) 0;
    for (int64_t i_133102 = 0; i_133102 < nR_119031; i_133102++) {
        for (int64_t i_133042 = 0; i_133042 < b_119032; i_133042++) {
            int8_t eta_p_129230 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133042];
            bool cond_129231 = sle64(i_133042, i32_res_127864);
            bool cond_t_res_129232 = sle64(min_res_127872, i_133042);
            bool x_129233 = cond_129231 && cond_t_res_129232;
            int8_t lifted_lambda_res_129234;
            
            if (x_129233) {
                lifted_lambda_res_129234 = eta_p_129230;
            } else {
                lifted_lambda_res_129234 = (int8_t) 0;
            }
            ((int8_t *) mem_133211)[i_133042] = lifted_lambda_res_129234;
        }
        
        int8_t za_lhs_129235 = ((int8_t *) mem_133211)[i32_res_127864];
        int8_t mod1_x_129236 = (int8_t) -1 & za_lhs_129235;
        
        ((int8_t *) mem_133211)[i32_res_127864] = mod1_x_129236;
        
        int8_t za_lhs_129238 = ((int8_t *) mem_133211)[min_res_127872];
        int8_t tmp_129239 = unsign_arg0_127880 & za_lhs_129238;
        
        ((int8_t *) mem_133211)[min_res_127872] = tmp_129239;
        
        int64_t radix_to_idx_res_129241;
        int64_t y_129243 = (int64_t) 0;
        
        for (int64_t i_129242 = 0; i_129242 < i32_res_127914; i_129242++) {
            int64_t zm_lhs_129244 = sub64(b_119032, i_129242);
            int64_t u8_arg0_129245 = sub64(zm_lhs_129244, (int64_t) 1);
            bool x_129246 = sle64((int64_t) 0, u8_arg0_129245);
            bool y_129247 = slt64(u8_arg0_129245, b_119032);
            bool bounds_check_129248 = x_129246 && y_129247;
            bool index_certs_129249;
            
            if (!bounds_check_129248) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_arg0_129245, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:42:23-33\n   #1  ftRelational.fut:304:1-311:54\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t u8_arg0_129250 = ((int8_t *) mem_133211)[u8_arg0_129245];
            int64_t u8_res_129251 = zext_i8_i64(u8_arg0_129250);
            int64_t zlzl_rhs_129252 = mul64((int64_t) 8, i_129242);
            int64_t r_129253 = shl64(u8_res_129251, zlzl_rhs_129252);
            int64_t loopres_129254 = y_129243 | r_129253;
            int64_t y_tmp_133527 = loopres_129254;
            
            y_129243 = y_tmp_133527;
        }
        radix_to_idx_res_129241 = y_129243;
        
        bool x_129255 = sle64((int64_t) 0, radix_to_idx_res_129241);
        bool y_129256 = slt64(radix_to_idx_res_129241, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035);
        bool bounds_check_129257 = x_129255 && y_129256;
        bool index_certs_129258;
        
        if (!bounds_check_129257) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_res_129241, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035, "].", "-> #0  ftHashJoin.fut:349:13-35\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t spi_129259 = ((int64_t *) first_info_idx_mem_133179.mem)[radix_to_idx_res_129241];
        bool cond_129260 = slt64(spi_129259, (int64_t) 0);
        int64_t rv_partitionMatchBounds_res_129261;
        
        if (cond_129260) {
            rv_partitionMatchBounds_res_129261 = (int64_t) -1;
        } else {
            bool x_129262 = sle64((int64_t) 0, spi_129259);
            bool y_129263 = slt64(spi_129259, dz2081U_119034);
            bool bounds_check_129264 = x_129262 && y_129263;
            bool index_certs_129265;
            
            if (!bounds_check_129264) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) spi_129259, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:352:8-21\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t zeze_lhs_129266 = ((int32_t *) depths_mem_133178.mem)[spi_129259];
            bool cond_129267 = zeze_lhs_129266 == 1;
            bool x_133434 = !cond_129267;
            int64_t end_spi_129269;
            
            if (x_133434) {
                int64_t x_133436 = ((int64_t *) last_info_idx_mem_133180.mem)[radix_to_idx_res_129241];
                
                end_spi_129269 = x_133436;
            } else {
                end_spi_129269 = (int64_t) 0;
            }
            
            int64_t zs_lhs_129270 = sub64(end_spi_129269, spi_129259);
            int64_t max_arg1_129271 = sdiv64(zs_lhs_129270, (int64_t) 2);
            int64_t max_res_129272 = smax64((int64_t) 1, max_arg1_129271);
            bool loop_cond_129273 = slt64((int64_t) 0, max_res_129272);
            int64_t rv_partitionMatchBounds_res_f_res_129268;
            
            if (cond_129267) {
                rv_partitionMatchBounds_res_f_res_129268 = spi_129259;
            } else {
                bool loop_not_taken_129286 = !loop_cond_129273;
                bool protect_assert_disj_129287 = bounds_check_127891 || loop_not_taken_129286;
                bool index_certs_129288;
                
                if (!protect_assert_disj_129287) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftRelational.fut:304:1-311:54\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map2_arg2_129277 = add64((int64_t) 1, i32_res_127864);
                
                if (mem_133221_cached_sizze_133606 < b_119032) {
                    err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133606, b_119032);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_133222_cached_sizze_133607 < b_119032) {
                    err = lexical_realloc(ctx, &mem_133222, &mem_133222_cached_sizze_133607, b_119032);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                bool rv_partitionMatchBounds_res_f_res_f_res_129289;
                int64_t rv_partitionMatchBounds_res_f_res_f_res_129290;
                int64_t rv_partitionMatchBounds_res_f_res_f_res_129291;
                bool loop_while_129292;
                int64_t heshi_129293;
                int64_t step_129294;
                
                loop_while_129292 = loop_cond_129273;
                heshi_129293 = spi_129259;
                step_129294 = max_res_129272;
                while (loop_while_129292) {
                    bool x_129295 = sle64((int64_t) 0, heshi_129293);
                    bool y_129296 = slt64(heshi_129293, dz2081U_119034);
                    bool bounds_check_129297 = x_129295 && y_129296;
                    bool index_certs_129298;
                    
                    if (!bounds_check_129297) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_129293, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:358:25-40\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t cur_depth_129299 = ((int32_t *) depths_mem_133178.mem)[heshi_129293];
                    bool cond_129300 = heshi_129293 == spi_129259;
                    int64_t cur_S_129316 = ((int64_t *) bounds_mem_133177.mem)[heshi_129293];
                    bool x_129317 = sle64((int64_t) 0, cur_S_129316);
                    bool y_129318 = slt64(cur_S_129316, nS_119033);
                    bool bounds_check_129319 = x_129317 && y_129318;
                    bool index_certs_129320;
                    
                    if (!bounds_check_129319) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_129316, "] out of bounds for array of shape [", (long long) nS_119033, "].", "-> #0  ftHashJoin.fut:361:21-40\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_129323 = sub64(heshi_129293, (int64_t) 1);
                    bool x_129324 = sle64((int64_t) 0, tmp_129323);
                    bool y_129325 = slt64(tmp_129323, dz2081U_119034);
                    bool bounds_check_129326 = x_129324 && y_129325;
                    bool protect_assert_disj_133429 = cond_129300 || bounds_check_129326;
                    bool index_certs_129327;
                    
                    if (!protect_assert_disj_133429) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129323, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:362:55-72\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t zm_lhs_129346 = mul32(radix_sizze_119036, cur_depth_129299);
                    int32_t byteSeq_eq_arg1_129347 = sub32(zm_lhs_129346, 1);
                    int32_t zm_rhs_129389 = sdiv32(byteSeq_eq_arg1_129347, 8);
                    int32_t zm_lhs_129390 = sub32(i64_res_127856, zm_rhs_129389);
                    int32_t i32_arg0_129391 = sub32(zm_lhs_129390, 1);
                    int64_t i32_res_129392 = sext_i32_i64(i32_arg0_129391);
                    bool zzero_lte_i_129399 = sle64((int64_t) 0, i32_res_129392);
                    int64_t j_m_i_129393 = sub64(map2_arg2_129277, i32_res_129392);
                    int64_t m_129395 = sub64(j_m_i_129393, (int64_t) 1);
                    int64_t i_p_m_t_s_129396 = add64(i32_res_129392, m_129395);
                    bool i_p_m_t_s_leq_w_129398 = slt64(i_p_m_t_s_129396, b_119032);
                    bool y_129401 = i_p_m_t_s_leq_w_129398 && zzero_lte_i_129399;
                    bool zzero_leq_i_p_m_t_s_129397 = sle64((int64_t) 0, i_p_m_t_s_129396);
                    bool y_129402 = zzero_leq_i_p_m_t_s_129397 && y_129401;
                    bool i_lte_j_129400 = sle64(i32_res_129392, map2_arg2_129277);
                    bool forwards_ok_129403 = i_lte_j_129400 && y_129402;
                    bool empty_slice_129394 = j_m_i_129393 == (int64_t) 0;
                    bool ok_or_empty_129404 = empty_slice_129394 || forwards_ok_129403;
                    bool index_certs_129405;
                    
                    if (!ok_or_empty_129404) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_129392, ":", (long long) map2_arg2_129277, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:51:38-49\n   #1  ftHashJoin.fut:137:3-40\n   #2  ftHashJoin.fut:366:14-52\n   #3  ftHashJoin.fut:424:3-430:70\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftRelational.fut:308:4-311:35\n   #6  ftRelational.fut:304:1-311:54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t min_res_129348 = smin32(min_arg1_127858, byteSeq_eq_arg1_129347);
                    int32_t zm_rhs_129349 = sdiv32(min_res_129348, 8);
                    int32_t zm_lhs_129350 = sub32(i64_res_127856, zm_rhs_129349);
                    int32_t i32_arg0_129351 = sub32(zm_lhs_129350, 1);
                    int64_t i32_res_129352 = sext_i32_i64(i32_arg0_129351);
                    int64_t min_res_129353 = smin64(min_arg1_127871, i32_res_129352);
                    bool y_129370 = slt64(min_res_129353, b_119032);
                    bool x_129369 = sle64((int64_t) 0, min_res_129353);
                    bool bounds_check_129371 = x_129369 && y_129370;
                    bool index_certs_129372;
                    
                    if (!bounds_check_129371) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_129353, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftRelational.fut:304:1-311:54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t prev_depth_129301;
                    
                    if (cond_129300) {
                        prev_depth_129301 = cur_depth_129299;
                    } else {
                        bool index_certs_129306;
                        
                        if (!bounds_check_129326) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129323, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:359:60-77\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t prev_depth_f_res_129307 = ((int32_t *) depths_mem_133178.mem)[tmp_129323];
                        
                        prev_depth_129301 = prev_depth_f_res_129307;
                    }
                    
                    bool cond_129308 = heshi_129293 == end_spi_129269;
                    int32_t next_depth_129309;
                    
                    if (cond_129308) {
                        next_depth_129309 = cur_depth_129299;
                    } else {
                        int64_t tmp_129310 = add64((int64_t) 1, heshi_129293);
                        bool x_129311 = sle64((int64_t) 0, tmp_129310);
                        bool y_129312 = slt64(tmp_129310, dz2081U_119034);
                        bool bounds_check_129313 = x_129311 && y_129312;
                        bool index_certs_129314;
                        
                        if (!bounds_check_129313) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129310, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:360:64-81\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t next_depth_f_res_129315 = ((int32_t *) depths_mem_133178.mem)[tmp_129310];
                        
                        next_depth_129309 = next_depth_f_res_129315;
                    }
                    
                    bool x_133426 = !cond_129300;
                    int64_t tmp_129328;
                    
                    if (x_133426) {
                        int64_t x_133430 = ((int64_t *) bounds_mem_133177.mem)[tmp_129323];
                        
                        tmp_129328 = x_133430;
                    } else {
                        tmp_129328 = (int64_t) 0;
                    }
                    
                    int64_t lmad_ext_133218 = b_119032 * tmp_129328;
                    int64_t lmad_ext_133219 = b_119032 * cur_S_129316;
                    int64_t ext_133220;
                    
                    if (cond_129300) {
                        ext_133220 = lmad_ext_133219;
                    } else {
                        ext_133220 = lmad_ext_133218;
                    }
                    if (!cond_129300) {
                        bool x_129329 = sle64((int64_t) 0, tmp_129328);
                        bool y_129330 = slt64(tmp_129328, nS_119033);
                        bool bounds_check_129331 = x_129329 && y_129330;
                        bool index_certs_129332;
                        
                        if (!bounds_check_129331) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129328, "] out of bounds for array of shape [", (long long) nS_119033, "].", "-> #0  ftHashJoin.fut:362:52-73\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                    }
                    for (int64_t i_133048 = 0; i_133048 < b_119032; i_133048++) {
                        int8_t eta_p_130125 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133048];
                        int8_t eta_p_130126 = ((int8_t *) pS_mem_133176.mem)[cur_S_129316 * b_119032 + i_133048];
                        bool cond_130128 = sle64(i_133048, i32_res_127864);
                        bool cond_t_res_130129 = sle64(min_res_129353, i_133048);
                        bool x_130130 = cond_130128 && cond_t_res_130129;
                        int8_t lifted_lambda_res_130131;
                        
                        if (x_130130) {
                            lifted_lambda_res_130131 = eta_p_130125;
                        } else {
                            lifted_lambda_res_130131 = (int8_t) 0;
                        }
                        
                        int8_t lifted_lambda_res_130136;
                        
                        if (x_130130) {
                            lifted_lambda_res_130136 = eta_p_130126;
                        } else {
                            lifted_lambda_res_130136 = (int8_t) 0;
                        }
                        ((int8_t *) mem_133221)[i_133048] = lifted_lambda_res_130136;
                        ((int8_t *) mem_133222)[i_133048] = lifted_lambda_res_130131;
                    }
                    
                    int8_t za_lhs_129383 = ((int8_t *) mem_133221)[i32_res_127864];
                    int8_t mod1_x_129384 = (int8_t) -1 & za_lhs_129383;
                    
                    ((int8_t *) mem_133221)[i32_res_127864] = mod1_x_129384;
                    
                    int8_t za_lhs_129386 = ((int8_t *) mem_133221)[min_res_129353];
                    int32_t lastBit_129354 = smod32(min_res_129348, 8);
                    int32_t zm_lhs_129355 = sub32(8, lastBit_129354);
                    int32_t i32_arg0_129356 = sub32(zm_lhs_129355, 1);
                    int8_t unsign_arg0_129357 = zext_i32_i8(i32_arg0_129356);
                    int8_t unsign_arg0_129358 = lshr8((int8_t) -1, unsign_arg0_129357);
                    int8_t tmp_129387 = unsign_arg0_129358 & za_lhs_129386;
                    
                    ((int8_t *) mem_133221)[min_res_129353] = tmp_129387;
                    
                    int8_t za_lhs_129366 = ((int8_t *) mem_133222)[i32_res_127864];
                    int8_t mod1_x_129367 = (int8_t) -1 & za_lhs_129366;
                    
                    ((int8_t *) mem_133222)[i32_res_127864] = mod1_x_129367;
                    
                    int8_t za_lhs_129373 = ((int8_t *) mem_133222)[min_res_129353];
                    int8_t tmp_129374 = unsign_arg0_129358 & za_lhs_129373;
                    
                    ((int8_t *) mem_133222)[min_res_129353] = tmp_129374;
                    
                    bool defunc_0_reduce_res_132948;
                    bool redout_133051 = 1;
                    
                    for (int64_t i_133052 = 0; i_133052 < j_m_i_129393; i_133052++) {
                        int64_t slice_133165 = i32_res_129392 + i_133052;
                        int8_t eta_p_130119 = ((int8_t *) mem_133222)[slice_133165];
                        int8_t eta_p_130120 = ((int8_t *) mem_133221)[slice_133165];
                        bool defunc_0_f_res_130121 = eta_p_130119 == eta_p_130120;
                        bool x_129416 = defunc_0_f_res_130121 && redout_133051;
                        bool redout_tmp_133533 = x_129416;
                        
                        redout_133051 = redout_tmp_133533;
                    }
                    defunc_0_reduce_res_132948 = redout_133051;
                    
                    bool cond_129417;
                    
                    if (defunc_0_reduce_res_132948) {
                        int32_t zm_lhs_132703 = mul32(radix_sizze_119036, prev_depth_129301);
                        int32_t byteSeq_neq_arg1_132704 = sub32(zm_lhs_132703, 1);
                        int32_t zm_rhs_132705 = sdiv32(byteSeq_neq_arg1_132704, 8);
                        int32_t zm_lhs_132706 = sub32(i64_res_127856, zm_rhs_132705);
                        int32_t i32_arg0_132707 = sub32(zm_lhs_132706, 1);
                        int64_t i32_res_132708 = sext_i32_i64(i32_arg0_132707);
                        int64_t j_m_i_132709 = sub64(map2_arg2_129277, i32_res_132708);
                        bool cond_t_res_132710;
                        
                        if (cond_129300) {
                            cond_t_res_132710 = 1;
                        } else {
                            int32_t min_res_132711 = smin32(min_arg1_127858, byteSeq_neq_arg1_132704);
                            int32_t zm_rhs_132712 = sdiv32(min_res_132711, 8);
                            int32_t zm_lhs_132713 = sub32(i64_res_127856, zm_rhs_132712);
                            int32_t i32_arg0_132714 = sub32(zm_lhs_132713, 1);
                            int64_t i32_res_132715 = sext_i32_i64(i32_arg0_132714);
                            int64_t min_res_132716 = smin64(min_arg1_127871, i32_res_132715);
                            bool index_certs_132737;
                            
                            if (!bounds_check_127891) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftRelational.fut:304:1-311:54\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool x_132741 = sle64((int64_t) 0, min_res_132716);
                            bool y_132742 = slt64(min_res_132716, b_119032);
                            bool bounds_check_132743 = x_132741 && y_132742;
                            bool index_certs_132744;
                            
                            if (!bounds_check_132743) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_132716, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftRelational.fut:304:1-311:54\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool empty_slice_132754 = j_m_i_132709 == (int64_t) 0;
                            int64_t m_132755 = sub64(j_m_i_132709, (int64_t) 1);
                            int64_t i_p_m_t_s_132756 = add64(i32_res_132708, m_132755);
                            bool zzero_leq_i_p_m_t_s_132757 = sle64((int64_t) 0, i_p_m_t_s_132756);
                            bool i_p_m_t_s_leq_w_132758 = slt64(i_p_m_t_s_132756, b_119032);
                            bool zzero_lte_i_132759 = sle64((int64_t) 0, i32_res_132708);
                            bool i_lte_j_132760 = sle64(i32_res_132708, map2_arg2_129277);
                            bool y_132761 = i_p_m_t_s_leq_w_132758 && zzero_lte_i_132759;
                            bool y_132762 = zzero_leq_i_p_m_t_s_132757 && y_132761;
                            bool forwards_ok_132763 = i_lte_j_132760 && y_132762;
                            bool ok_or_empty_132764 = empty_slice_132754 || forwards_ok_132763;
                            bool index_certs_132765;
                            
                            if (!ok_or_empty_132764) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_132708, ":", (long long) map2_arg2_129277, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:59:38-49\n   #1  ftHashJoin.fut:141:3-41\n   #2  ftHashJoin.fut:368:30-71\n   #3  ftHashJoin.fut:424:3-430:70\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftRelational.fut:308:4-311:35\n   #6  ftRelational.fut:304:1-311:54\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t lastBit_132717 = smod32(min_res_132711, 8);
                            int32_t zm_lhs_132718 = sub32(8, lastBit_132717);
                            int32_t i32_arg0_132719 = sub32(zm_lhs_132718, 1);
                            int8_t unsign_arg0_132720 = zext_i32_i8(i32_arg0_132719);
                            int8_t unsign_arg0_132721 = lshr8((int8_t) -1, unsign_arg0_132720);
                            
                            if (mem_133235_cached_sizze_133608 < b_119032) {
                                err = lexical_realloc(ctx, &mem_133235, &mem_133235_cached_sizze_133608, b_119032);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133236_cached_sizze_133609 < b_119032) {
                                err = lexical_realloc(ctx, &mem_133236, &mem_133236_cached_sizze_133609, b_119032);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_133057 = 0; i_133057 < b_119032; i_133057++) {
                                int8_t eta_p_132725 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133057];
                                int8_t eta_p_132726 = ((int8_t *) pS_mem_133176.mem)[ext_133220 + i_133057];
                                bool cond_132727 = sle64(i_133057, i32_res_127864);
                                bool cond_t_res_132728 = sle64(min_res_132716, i_133057);
                                bool x_132729 = cond_132727 && cond_t_res_132728;
                                int8_t lifted_lambda_res_132730;
                                
                                if (x_132729) {
                                    lifted_lambda_res_132730 = eta_p_132725;
                                } else {
                                    lifted_lambda_res_132730 = (int8_t) 0;
                                }
                                
                                int8_t lifted_lambda_res_132734;
                                
                                if (x_132729) {
                                    lifted_lambda_res_132734 = eta_p_132726;
                                } else {
                                    lifted_lambda_res_132734 = (int8_t) 0;
                                }
                                ((int8_t *) mem_133235)[i_133057] = lifted_lambda_res_132734;
                                ((int8_t *) mem_133236)[i_133057] = lifted_lambda_res_132730;
                            }
                            
                            int8_t za_lhs_132738 = ((int8_t *) mem_133236)[i32_res_127864];
                            int8_t mod1_x_132739 = (int8_t) -1 & za_lhs_132738;
                            
                            ((int8_t *) mem_133236)[i32_res_127864] = mod1_x_132739;
                            
                            int8_t za_lhs_132745 = ((int8_t *) mem_133236)[min_res_132716];
                            int8_t tmp_132746 = unsign_arg0_132721 & za_lhs_132745;
                            
                            ((int8_t *) mem_133236)[min_res_132716] = tmp_132746;
                            
                            int8_t za_lhs_132748 = ((int8_t *) mem_133235)[i32_res_127864];
                            int8_t mod1_x_132749 = (int8_t) -1 & za_lhs_132748;
                            
                            ((int8_t *) mem_133235)[i32_res_127864] = mod1_x_132749;
                            
                            int8_t za_lhs_132751 = ((int8_t *) mem_133235)[min_res_132716];
                            int8_t tmp_132752 = unsign_arg0_132721 & za_lhs_132751;
                            
                            ((int8_t *) mem_133235)[min_res_132716] = tmp_132752;
                            
                            bool defunc_0_reduce_res_132768;
                            bool redout_133060 = 0;
                            
                            for (int64_t i_133061 = 0; i_133061 < j_m_i_132709; i_133061++) {
                                int64_t slice_133161 = i32_res_132708 + i_133061;
                                int8_t eta_p_132769 = ((int8_t *) mem_133236)[slice_133161];
                                int8_t eta_p_132770 = ((int8_t *) mem_133235)[slice_133161];
                                bool defunc_0_f_res_132771 = eta_p_132769 == eta_p_132770;
                                bool defunc_0_f_res_132772 = !defunc_0_f_res_132771;
                                bool defunc_0_op_res_132775 = defunc_0_f_res_132772 || redout_133060;
                                bool redout_tmp_133536 = defunc_0_op_res_132775;
                                
                                redout_133060 = redout_tmp_133536;
                            }
                            defunc_0_reduce_res_132768 = redout_133060;
                            cond_t_res_132710 = defunc_0_reduce_res_132768;
                        }
                        cond_129417 = cond_t_res_132710;
                    } else {
                        cond_129417 = 0;
                    }
                    
                    int64_t loopres_129492;
                    int64_t loopres_129493;
                    
                    if (cond_129417) {
                        loopres_129492 = heshi_129293;
                        loopres_129493 = (int64_t) 0;
                    } else {
                        bool defunc_0_reduce_res_132945;
                        bool redout_133062 = 1;
                        
                        for (int64_t i_133063 = 0; i_133063 < j_m_i_129393; i_133063++) {
                            int64_t slice_133159 = i32_res_129392 + i_133063;
                            int8_t eta_p_130150 = ((int8_t *) mem_133222)[slice_133159];
                            int8_t eta_p_130151 = ((int8_t *) mem_133221)[slice_133159];
                            bool defunc_0_f_res_130152 = eta_p_130150 == eta_p_130151;
                            bool x_129502 = defunc_0_f_res_130152 && redout_133062;
                            bool redout_tmp_133537 = x_129502;
                            
                            redout_133062 = redout_tmp_133537;
                        }
                        defunc_0_reduce_res_132945 = redout_133062;
                        
                        bool loop_cond_t_res_129508 = slt32(0, cur_depth_129299);
                        int64_t loopres_f_res_129503;
                        int64_t loopres_f_res_129504;
                        
                        if (defunc_0_reduce_res_132945) {
                            int64_t tmp_132777 = sub64(heshi_129293, step_129294);
                            int64_t max_arg1_132778 = sdiv64(step_129294, (int64_t) 2);
                            int64_t max_res_132779 = smax64((int64_t) 1, max_arg1_132778);
                            
                            loopres_f_res_129503 = tmp_132777;
                            loopres_f_res_129504 = max_res_132779;
                        } else {
                            if (mem_133249_cached_sizze_133610 < b_119032) {
                                err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133610, b_119032);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133250_cached_sizze_133611 < b_119032) {
                                err = lexical_realloc(ctx, &mem_133250, &mem_133250_cached_sizze_133611, b_119032);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133263_cached_sizze_133612 < b_119032) {
                                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133612, b_119032);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133264_cached_sizze_133613 < b_119032) {
                                err = lexical_realloc(ctx, &mem_133264, &mem_133264_cached_sizze_133613, b_119032);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            
                            bool radix_lt_res_129509;
                            int32_t radix_lt_res_129510;
                            bool radix_lt_res_129511;
                            bool loop_while_129512;
                            int32_t p_129513;
                            bool p_129514;
                            
                            loop_while_129512 = loop_cond_t_res_129508;
                            p_129513 = 0;
                            p_129514 = 0;
                            while (loop_while_129512) {
                                int32_t zt_rhs_129515 = add32(1, p_129513);
                                int32_t zm_lhs_129516 = mul32(radix_sizze_119036, zt_rhs_129515);
                                int32_t byteSeq_lt_arg1_129517 = sub32(zm_lhs_129516, 1);
                                int32_t byteSeq_lt_arg0_129518 = mul32(radix_sizze_119036, p_129513);
                                int32_t min_res_129519 = smin32(min_arg1_127858, byteSeq_lt_arg1_129517);
                                int32_t zm_rhs_129520 = sdiv32(byteSeq_lt_arg0_129518, 8);
                                int32_t zm_lhs_129521 = sub32(i64_res_127856, zm_rhs_129520);
                                int32_t i32_arg0_129522 = sub32(zm_lhs_129521, 1);
                                int64_t i32_res_129523 = sext_i32_i64(i32_arg0_129522);
                                int32_t zm_rhs_129524 = sdiv32(min_res_129519, 8);
                                int32_t zm_lhs_129525 = sub32(i64_res_127856, zm_rhs_129524);
                                int32_t i32_arg0_129526 = sub32(zm_lhs_129525, 1);
                                int64_t i32_res_129527 = sext_i32_i64(i32_arg0_129526);
                                int64_t min_res_129528 = smin64(min_arg1_127871, i32_res_129527);
                                bool x_129544 = sle64((int64_t) 0, i32_res_129523);
                                bool y_129545 = slt64(i32_res_129523, b_119032);
                                bool bounds_check_129546 = x_129544 && y_129545;
                                bool index_certs_129547;
                                
                                if (!bounds_check_129546) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_129523, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:304:1-311:54\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_129551 = sle64((int64_t) 0, min_res_129528);
                                bool y_129552 = slt64(min_res_129528, b_119032);
                                bool bounds_check_129553 = x_129551 && y_129552;
                                bool index_certs_129554;
                                
                                if (!bounds_check_129553) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_129528, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:304:1-311:54\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t firstBit_129529 = smod32(byteSeq_lt_arg0_129518, 8);
                                int32_t lastBit_129530 = smod32(min_res_129519, 8);
                                int8_t unsign_arg0_129531 = zext_i32_i8(firstBit_129529);
                                int8_t first_bitMask_129532 = shl8((int8_t) -1, unsign_arg0_129531);
                                int32_t zm_lhs_129533 = sub32(8, lastBit_129530);
                                int32_t i32_arg0_129534 = sub32(zm_lhs_129533, 1);
                                int8_t unsign_arg0_129535 = zext_i32_i8(i32_arg0_129534);
                                int8_t unsign_arg0_129536 = lshr8((int8_t) -1, unsign_arg0_129535);
                                
                                for (int64_t i_133068 = 0; i_133068 < b_119032; i_133068++) {
                                    int8_t eta_p_130581 = ((int8_t *) pS_mem_133176.mem)[cur_S_129316 * b_119032 + i_133068];
                                    int8_t eta_p_130582 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133068];
                                    bool cond_130588 = sle64(i_133068, i32_res_129523);
                                    bool cond_t_res_130589 = sle64(min_res_129528, i_133068);
                                    bool x_130590 = cond_130588 && cond_t_res_130589;
                                    int8_t lifted_lambda_res_130591;
                                    
                                    if (x_130590) {
                                        lifted_lambda_res_130591 = eta_p_130582;
                                    } else {
                                        lifted_lambda_res_130591 = (int8_t) 0;
                                    }
                                    
                                    int8_t lifted_lambda_res_130596;
                                    
                                    if (x_130590) {
                                        lifted_lambda_res_130596 = eta_p_130581;
                                    } else {
                                        lifted_lambda_res_130596 = (int8_t) 0;
                                    }
                                    ((int8_t *) mem_133249)[i_133068] = lifted_lambda_res_130596;
                                    ((int8_t *) mem_133250)[i_133068] = lifted_lambda_res_130591;
                                }
                                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133263, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133250, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
                                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133264, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133249, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
                                
                                int8_t za_lhs_129548 = ((int8_t *) mem_133263)[i32_res_129523];
                                int8_t mod1_x_129549 = first_bitMask_129532 & za_lhs_129548;
                                
                                ((int8_t *) mem_133263)[i32_res_129523] = mod1_x_129549;
                                
                                int8_t za_lhs_129555 = ((int8_t *) mem_133263)[min_res_129528];
                                int8_t tmp_129556 = unsign_arg0_129536 & za_lhs_129555;
                                
                                ((int8_t *) mem_133263)[min_res_129528] = tmp_129556;
                                
                                int8_t za_lhs_129565 = ((int8_t *) mem_133264)[i32_res_129523];
                                int8_t mod1_x_129566 = first_bitMask_129532 & za_lhs_129565;
                                
                                ((int8_t *) mem_133264)[i32_res_129523] = mod1_x_129566;
                                
                                int8_t za_lhs_129568 = ((int8_t *) mem_133264)[min_res_129528];
                                int8_t tmp_129569 = unsign_arg0_129536 & za_lhs_129568;
                                
                                ((int8_t *) mem_133264)[min_res_129528] = tmp_129569;
                                
                                int32_t zm_rhs_129571 = sdiv32(byteSeq_lt_arg1_129517, 8);
                                int32_t zm_lhs_129572 = sub32(i64_res_127856, zm_rhs_129571);
                                int32_t i32_arg0_129573 = sub32(zm_lhs_129572, 1);
                                int64_t i32_res_129574 = sext_i32_i64(i32_arg0_129573);
                                bool loop_cond_t_res_129575 = slt64(i32_res_129574, i32_res_129523);
                                bool byteSeq_lt_res_129576;
                                int64_t byteSeq_lt_res_129577;
                                bool byteSeq_lt_res_129578;
                                bool loop_while_129579;
                                int64_t p_129580;
                                bool p_129581;
                                
                                loop_while_129579 = loop_cond_t_res_129575;
                                p_129580 = i32_res_129574;
                                p_129581 = 0;
                                while (loop_while_129579) {
                                    bool x_129582 = sle64((int64_t) 0, p_129580);
                                    bool y_129583 = slt64(p_129580, b_119032);
                                    bool bounds_check_129584 = x_129582 && y_129583;
                                    bool index_certs_129585;
                                    
                                    if (!bounds_check_129584) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129580, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:89:17-27\n   #1  ftRelational.fut:304:1-311:54\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int8_t zl_lhs_129586 = ((int8_t *) mem_133263)[p_129580];
                                    int8_t zl_rhs_129587 = ((int8_t *) mem_133264)[p_129580];
                                    bool dlt_129588 = ult8(zl_lhs_129586, zl_rhs_129587);
                                    bool dgt_129589 = ult8(zl_rhs_129587, zl_lhs_129586);
                                    bool tmp_129590 = dlt_129588 || dgt_129589;
                                    bool cond_129591 = !tmp_129590;
                                    int64_t tmp_129592;
                                    
                                    if (cond_129591) {
                                        int64_t tmp_t_res_132780 = add64((int64_t) 1, p_129580);
                                        
                                        tmp_129592 = tmp_t_res_132780;
                                    } else {
                                        tmp_129592 = i32_res_129523;
                                    }
                                    
                                    bool cond_129594 = !dlt_129588;
                                    bool loop_cond_t_res_129595 = slt64(tmp_129592, i32_res_129523);
                                    bool x_129596 = cond_129594 && loop_cond_t_res_129595;
                                    bool loop_while_tmp_133543 = x_129596;
                                    int64_t p_tmp_133544 = tmp_129592;
                                    bool p_tmp_133545 = dlt_129588;
                                    
                                    loop_while_129579 = loop_while_tmp_133543;
                                    p_129580 = p_tmp_133544;
                                    p_129581 = p_tmp_133545;
                                }
                                byteSeq_lt_res_129576 = loop_while_129579;
                                byteSeq_lt_res_129577 = p_129580;
                                byteSeq_lt_res_129578 = p_129581;
                                
                                int8_t za_lhs_129604 = ((int8_t *) mem_133250)[i32_res_129523];
                                int8_t mod1_x_129605 = first_bitMask_129532 & za_lhs_129604;
                                
                                ((int8_t *) mem_133250)[i32_res_129523] = mod1_x_129605;
                                
                                int8_t za_lhs_129607 = ((int8_t *) mem_133250)[min_res_129528];
                                int8_t tmp_129608 = unsign_arg0_129536 & za_lhs_129607;
                                
                                ((int8_t *) mem_133250)[min_res_129528] = tmp_129608;
                                
                                int8_t za_lhs_129617 = ((int8_t *) mem_133249)[i32_res_129523];
                                int8_t mod1_x_129618 = first_bitMask_129532 & za_lhs_129617;
                                
                                ((int8_t *) mem_133249)[i32_res_129523] = mod1_x_129618;
                                
                                int8_t za_lhs_129620 = ((int8_t *) mem_133249)[min_res_129528];
                                int8_t tmp_129621 = unsign_arg0_129536 & za_lhs_129620;
                                
                                ((int8_t *) mem_133249)[min_res_129528] = tmp_129621;
                                
                                bool byteSeq_gt_res_129623;
                                int64_t byteSeq_gt_res_129624;
                                bool byteSeq_gt_res_129625;
                                bool loop_while_129626;
                                int64_t p_129627;
                                bool p_129628;
                                
                                loop_while_129626 = loop_cond_t_res_129575;
                                p_129627 = i32_res_129574;
                                p_129628 = 0;
                                while (loop_while_129626) {
                                    bool x_129629 = sle64((int64_t) 0, p_129627);
                                    bool y_129630 = slt64(p_129627, b_119032);
                                    bool bounds_check_129631 = x_129629 && y_129630;
                                    bool index_certs_129632;
                                    
                                    if (!bounds_check_129631) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129627, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:126:17-27\n   #1  ftRelational.fut:304:1-311:54\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int8_t zl_lhs_129633 = ((int8_t *) mem_133250)[p_129627];
                                    int8_t zl_rhs_129634 = ((int8_t *) mem_133249)[p_129627];
                                    bool dlt_129635 = ult8(zl_lhs_129633, zl_rhs_129634);
                                    bool dgt_129636 = ult8(zl_rhs_129634, zl_lhs_129633);
                                    bool tmp_129637 = dlt_129635 || dgt_129636;
                                    bool cond_129638 = !tmp_129637;
                                    int64_t tmp_129639;
                                    
                                    if (cond_129638) {
                                        int64_t tmp_t_res_132781 = add64((int64_t) 1, p_129627);
                                        
                                        tmp_129639 = tmp_t_res_132781;
                                    } else {
                                        tmp_129639 = i32_res_129523;
                                    }
                                    
                                    bool cond_129641 = !dgt_129636;
                                    bool loop_cond_t_res_129642 = slt64(tmp_129639, i32_res_129523);
                                    bool x_129643 = cond_129641 && loop_cond_t_res_129642;
                                    bool loop_while_tmp_133546 = x_129643;
                                    int64_t p_tmp_133547 = tmp_129639;
                                    bool p_tmp_133548 = dgt_129636;
                                    
                                    loop_while_129626 = loop_while_tmp_133546;
                                    p_129627 = p_tmp_133547;
                                    p_129628 = p_tmp_133548;
                                }
                                byteSeq_gt_res_129623 = loop_while_129626;
                                byteSeq_gt_res_129624 = p_129627;
                                byteSeq_gt_res_129625 = p_129628;
                                
                                bool tmp_129644 = byteSeq_lt_res_129578 || byteSeq_gt_res_129625;
                                bool cond_129645 = !tmp_129644;
                                int32_t tmp_129646;
                                
                                if (cond_129645) {
                                    tmp_129646 = zt_rhs_129515;
                                } else {
                                    tmp_129646 = cur_depth_129299;
                                }
                                
                                bool cond_129647 = !byteSeq_lt_res_129578;
                                bool loop_cond_t_res_129648 = slt32(tmp_129646, cur_depth_129299);
                                bool x_129649 = cond_129647 && loop_cond_t_res_129648;
                                bool loop_while_tmp_133538 = x_129649;
                                int32_t p_tmp_133539 = tmp_129646;
                                bool p_tmp_133540 = byteSeq_lt_res_129578;
                                
                                loop_while_129512 = loop_while_tmp_133538;
                                p_129513 = p_tmp_133539;
                                p_129514 = p_tmp_133540;
                            }
                            radix_lt_res_129509 = loop_while_129512;
                            radix_lt_res_129510 = p_129513;
                            radix_lt_res_129511 = p_129514;
                            
                            int64_t loopres_f_res_f_res_129650;
                            int64_t loopres_f_res_f_res_129651;
                            
                            if (radix_lt_res_129511) {
                                bool loop_cond_t_res_132793 = slt32(0, prev_depth_129301);
                                bool cond_132792;
                                
                                if (cond_129300) {
                                    cond_132792 = 1;
                                } else {
                                    if (mem_133284_cached_sizze_133618 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133284, &mem_133284_cached_sizze_133618, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133285_cached_sizze_133619 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133285, &mem_133285_cached_sizze_133619, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133298_cached_sizze_133620 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133298, &mem_133298_cached_sizze_133620, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133299_cached_sizze_133621 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133621, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    
                                    bool radix_gt_res_132794;
                                    int32_t radix_gt_res_132795;
                                    bool radix_gt_res_132796;
                                    bool loop_while_132797;
                                    int32_t p_132798;
                                    bool p_132799;
                                    
                                    loop_while_132797 = loop_cond_t_res_132793;
                                    p_132798 = 0;
                                    p_132799 = 0;
                                    while (loop_while_132797) {
                                        int32_t zt_rhs_132800 = add32(1, p_132798);
                                        int32_t zm_lhs_132801 = mul32(radix_sizze_119036, zt_rhs_132800);
                                        int32_t byteSeq_lt_arg1_132802 = sub32(zm_lhs_132801, 1);
                                        int32_t byteSeq_lt_arg0_132803 = mul32(radix_sizze_119036, p_132798);
                                        int32_t min_res_132804 = smin32(min_arg1_127858, byteSeq_lt_arg1_132802);
                                        int32_t zm_rhs_132805 = sdiv32(byteSeq_lt_arg0_132803, 8);
                                        int32_t zm_lhs_132806 = sub32(i64_res_127856, zm_rhs_132805);
                                        int32_t i32_arg0_132807 = sub32(zm_lhs_132806, 1);
                                        int64_t i32_res_132808 = sext_i32_i64(i32_arg0_132807);
                                        int32_t zm_rhs_132809 = sdiv32(min_res_132804, 8);
                                        int32_t zm_lhs_132810 = sub32(i64_res_127856, zm_rhs_132809);
                                        int32_t i32_arg0_132811 = sub32(zm_lhs_132810, 1);
                                        int64_t i32_res_132812 = sext_i32_i64(i32_arg0_132811);
                                        int64_t min_res_132813 = smin64(min_arg1_127871, i32_res_132812);
                                        bool x_132849 = sle64((int64_t) 0, i32_res_132808);
                                        bool y_132850 = slt64(i32_res_132808, b_119032);
                                        bool bounds_check_132851 = x_132849 && y_132850;
                                        bool index_certs_132852;
                                        
                                        if (!bounds_check_132851) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_132808, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:304:1-311:54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_132856 = sle64((int64_t) 0, min_res_132813);
                                        bool y_132857 = slt64(min_res_132813, b_119032);
                                        bool bounds_check_132858 = x_132856 && y_132857;
                                        bool index_certs_132859;
                                        
                                        if (!bounds_check_132858) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_132813, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:304:1-311:54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t firstBit_132814 = smod32(byteSeq_lt_arg0_132803, 8);
                                        int32_t lastBit_132815 = smod32(min_res_132804, 8);
                                        int8_t unsign_arg0_132816 = zext_i32_i8(firstBit_132814);
                                        int8_t first_bitMask_132817 = shl8((int8_t) -1, unsign_arg0_132816);
                                        int32_t zm_lhs_132818 = sub32(8, lastBit_132815);
                                        int32_t i32_arg0_132819 = sub32(zm_lhs_132818, 1);
                                        int8_t unsign_arg0_132820 = zext_i32_i8(i32_arg0_132819);
                                        int8_t unsign_arg0_132821 = lshr8((int8_t) -1, unsign_arg0_132820);
                                        
                                        for (int64_t i_133075 = 0; i_133075 < b_119032; i_133075++) {
                                            int8_t eta_p_132827 = ((int8_t *) pS_mem_133176.mem)[ext_133220 + i_133075];
                                            int8_t eta_p_132828 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133075];
                                            bool cond_132829 = sle64(i_133075, i32_res_132808);
                                            bool cond_t_res_132830 = sle64(min_res_132813, i_133075);
                                            bool x_132831 = cond_132829 && cond_t_res_132830;
                                            int8_t lifted_lambda_res_132832;
                                            
                                            if (x_132831) {
                                                lifted_lambda_res_132832 = eta_p_132828;
                                            } else {
                                                lifted_lambda_res_132832 = (int8_t) 0;
                                            }
                                            
                                            int8_t lifted_lambda_res_132836;
                                            
                                            if (x_132831) {
                                                lifted_lambda_res_132836 = eta_p_132827;
                                            } else {
                                                lifted_lambda_res_132836 = (int8_t) 0;
                                            }
                                            ((int8_t *) mem_133284)[i_133075] = lifted_lambda_res_132836;
                                            ((int8_t *) mem_133285)[i_133075] = lifted_lambda_res_132832;
                                        }
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133298, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133285, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133299, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133284, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
                                        
                                        int8_t za_lhs_132853 = ((int8_t *) mem_133298)[i32_res_132808];
                                        int8_t mod1_x_132854 = first_bitMask_132817 & za_lhs_132853;
                                        
                                        ((int8_t *) mem_133298)[i32_res_132808] = mod1_x_132854;
                                        
                                        int8_t za_lhs_132860 = ((int8_t *) mem_133298)[min_res_132813];
                                        int8_t tmp_132861 = unsign_arg0_132821 & za_lhs_132860;
                                        
                                        ((int8_t *) mem_133298)[min_res_132813] = tmp_132861;
                                        
                                        int8_t za_lhs_132863 = ((int8_t *) mem_133299)[i32_res_132808];
                                        int8_t mod1_x_132864 = first_bitMask_132817 & za_lhs_132863;
                                        
                                        ((int8_t *) mem_133299)[i32_res_132808] = mod1_x_132864;
                                        
                                        int8_t za_lhs_132866 = ((int8_t *) mem_133299)[min_res_132813];
                                        int8_t tmp_132867 = unsign_arg0_132821 & za_lhs_132866;
                                        
                                        ((int8_t *) mem_133299)[min_res_132813] = tmp_132867;
                                        
                                        int32_t zm_rhs_132869 = sdiv32(byteSeq_lt_arg1_132802, 8);
                                        int32_t zm_lhs_132870 = sub32(i64_res_127856, zm_rhs_132869);
                                        int32_t i32_arg0_132871 = sub32(zm_lhs_132870, 1);
                                        int64_t i32_res_132872 = sext_i32_i64(i32_arg0_132871);
                                        bool loop_cond_t_res_132873 = slt64(i32_res_132872, i32_res_132808);
                                        bool byteSeq_lt_res_132874;
                                        int64_t byteSeq_lt_res_132875;
                                        bool byteSeq_lt_res_132876;
                                        bool loop_while_132877;
                                        int64_t p_132878;
                                        bool p_132879;
                                        
                                        loop_while_132877 = loop_cond_t_res_132873;
                                        p_132878 = i32_res_132872;
                                        p_132879 = 0;
                                        while (loop_while_132877) {
                                            bool x_132880 = sle64((int64_t) 0, p_132878);
                                            bool y_132881 = slt64(p_132878, b_119032);
                                            bool bounds_check_132882 = x_132880 && y_132881;
                                            bool index_certs_132883;
                                            
                                            if (!bounds_check_132882) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_132878, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:89:17-27\n   #1  ftRelational.fut:304:1-311:54\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_132884 = ((int8_t *) mem_133298)[p_132878];
                                            int8_t zl_rhs_132885 = ((int8_t *) mem_133299)[p_132878];
                                            bool dlt_132886 = ult8(zl_lhs_132884, zl_rhs_132885);
                                            bool dgt_132887 = ult8(zl_rhs_132885, zl_lhs_132884);
                                            bool tmp_132888 = dlt_132886 || dgt_132887;
                                            bool cond_132889 = !tmp_132888;
                                            int64_t tmp_132890;
                                            
                                            if (cond_132889) {
                                                int64_t tmp_t_res_132891 = add64((int64_t) 1, p_132878);
                                                
                                                tmp_132890 = tmp_t_res_132891;
                                            } else {
                                                tmp_132890 = i32_res_132808;
                                            }
                                            
                                            bool cond_132892 = !dlt_132886;
                                            bool loop_cond_t_res_132893 = slt64(tmp_132890, i32_res_132808);
                                            bool x_132894 = cond_132892 && loop_cond_t_res_132893;
                                            bool loop_while_tmp_133554 = x_132894;
                                            int64_t p_tmp_133555 = tmp_132890;
                                            bool p_tmp_133556 = dlt_132886;
                                            
                                            loop_while_132877 = loop_while_tmp_133554;
                                            p_132878 = p_tmp_133555;
                                            p_132879 = p_tmp_133556;
                                        }
                                        byteSeq_lt_res_132874 = loop_while_132877;
                                        byteSeq_lt_res_132875 = p_132878;
                                        byteSeq_lt_res_132876 = p_132879;
                                        
                                        int8_t za_lhs_132895 = ((int8_t *) mem_133285)[i32_res_132808];
                                        int8_t mod1_x_132896 = first_bitMask_132817 & za_lhs_132895;
                                        
                                        ((int8_t *) mem_133285)[i32_res_132808] = mod1_x_132896;
                                        
                                        int8_t za_lhs_132898 = ((int8_t *) mem_133285)[min_res_132813];
                                        int8_t tmp_132899 = unsign_arg0_132821 & za_lhs_132898;
                                        
                                        ((int8_t *) mem_133285)[min_res_132813] = tmp_132899;
                                        
                                        int8_t za_lhs_132901 = ((int8_t *) mem_133284)[i32_res_132808];
                                        int8_t mod1_x_132902 = first_bitMask_132817 & za_lhs_132901;
                                        
                                        ((int8_t *) mem_133284)[i32_res_132808] = mod1_x_132902;
                                        
                                        int8_t za_lhs_132904 = ((int8_t *) mem_133284)[min_res_132813];
                                        int8_t tmp_132905 = unsign_arg0_132821 & za_lhs_132904;
                                        
                                        ((int8_t *) mem_133284)[min_res_132813] = tmp_132905;
                                        
                                        bool byteSeq_gt_res_132907;
                                        int64_t byteSeq_gt_res_132908;
                                        bool byteSeq_gt_res_132909;
                                        bool loop_while_132910;
                                        int64_t p_132911;
                                        bool p_132912;
                                        
                                        loop_while_132910 = loop_cond_t_res_132873;
                                        p_132911 = i32_res_132872;
                                        p_132912 = 0;
                                        while (loop_while_132910) {
                                            bool x_132913 = sle64((int64_t) 0, p_132911);
                                            bool y_132914 = slt64(p_132911, b_119032);
                                            bool bounds_check_132915 = x_132913 && y_132914;
                                            bool index_certs_132916;
                                            
                                            if (!bounds_check_132915) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_132911, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:126:17-27\n   #1  ftRelational.fut:304:1-311:54\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_132917 = ((int8_t *) mem_133285)[p_132911];
                                            int8_t zl_rhs_132918 = ((int8_t *) mem_133284)[p_132911];
                                            bool dlt_132919 = ult8(zl_lhs_132917, zl_rhs_132918);
                                            bool dgt_132920 = ult8(zl_rhs_132918, zl_lhs_132917);
                                            bool tmp_132921 = dlt_132919 || dgt_132920;
                                            bool cond_132922 = !tmp_132921;
                                            int64_t tmp_132923;
                                            
                                            if (cond_132922) {
                                                int64_t tmp_t_res_132924 = add64((int64_t) 1, p_132911);
                                                
                                                tmp_132923 = tmp_t_res_132924;
                                            } else {
                                                tmp_132923 = i32_res_132808;
                                            }
                                            
                                            bool cond_132925 = !dgt_132920;
                                            bool loop_cond_t_res_132926 = slt64(tmp_132923, i32_res_132808);
                                            bool x_132927 = cond_132925 && loop_cond_t_res_132926;
                                            bool loop_while_tmp_133557 = x_132927;
                                            int64_t p_tmp_133558 = tmp_132923;
                                            bool p_tmp_133559 = dgt_132920;
                                            
                                            loop_while_132910 = loop_while_tmp_133557;
                                            p_132911 = p_tmp_133558;
                                            p_132912 = p_tmp_133559;
                                        }
                                        byteSeq_gt_res_132907 = loop_while_132910;
                                        byteSeq_gt_res_132908 = p_132911;
                                        byteSeq_gt_res_132909 = p_132912;
                                        
                                        bool tmp_132928 = byteSeq_lt_res_132876 || byteSeq_gt_res_132909;
                                        bool cond_132929 = !tmp_132928;
                                        int32_t tmp_132930;
                                        
                                        if (cond_132929) {
                                            tmp_132930 = zt_rhs_132800;
                                        } else {
                                            tmp_132930 = prev_depth_129301;
                                        }
                                        
                                        bool cond_132931 = !byteSeq_gt_res_132909;
                                        bool loop_cond_t_res_132932 = slt32(tmp_132930, prev_depth_129301);
                                        bool x_132933 = cond_132931 && loop_cond_t_res_132932;
                                        bool loop_while_tmp_133549 = x_132933;
                                        int32_t p_tmp_133550 = tmp_132930;
                                        bool p_tmp_133551 = byteSeq_gt_res_132909;
                                        
                                        loop_while_132797 = loop_while_tmp_133549;
                                        p_132798 = p_tmp_133550;
                                        p_132799 = p_tmp_133551;
                                    }
                                    radix_gt_res_132794 = loop_while_132797;
                                    radix_gt_res_132795 = p_132798;
                                    radix_gt_res_132796 = p_132799;
                                    cond_132792 = radix_gt_res_132796;
                                }
                                
                                int64_t loopres_f_res_f_res_t_res_132934;
                                int64_t loopres_f_res_f_res_t_res_132935;
                                
                                if (cond_132792) {
                                    loopres_f_res_f_res_t_res_132934 = (int64_t) -1;
                                    loopres_f_res_f_res_t_res_132935 = (int64_t) 0;
                                } else {
                                    int64_t tmp_132936 = sub64(heshi_129293, step_129294);
                                    int64_t max_arg1_132937 = sdiv64(step_129294, (int64_t) 2);
                                    int64_t max_res_132938 = smax64((int64_t) 1, max_arg1_132937);
                                    
                                    loopres_f_res_f_res_t_res_132934 = tmp_132936;
                                    loopres_f_res_f_res_t_res_132935 = max_res_132938;
                                }
                                loopres_f_res_f_res_129650 = loopres_f_res_f_res_t_res_132934;
                                loopres_f_res_f_res_129651 = loopres_f_res_f_res_t_res_132935;
                            } else {
                                int64_t tmp_129335 = add64((int64_t) 1, heshi_129293);
                                bool x_129336 = sle64((int64_t) 0, tmp_129335);
                                bool y_129337 = slt64(tmp_129335, dz2081U_119034);
                                bool bounds_check_129338 = x_129336 && y_129337;
                                bool protect_assert_disj_133419 = cond_129308 || bounds_check_129338;
                                bool protect_assert_disj_133445 = cond_129308 || protect_assert_disj_133419;
                                bool index_certs_129339;
                                
                                if (!protect_assert_disj_133445) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129335, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:363:59-76\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_t_res_129801 = slt32(0, next_depth_129309);
                                bool x_133442 = !cond_129308;
                                bool protect_cond_conj_133446 = x_133442 && x_133442;
                                int64_t tmp_129340;
                                
                                if (protect_cond_conj_133446) {
                                    int64_t x_133420 = ((int64_t *) bounds_mem_133177.mem)[tmp_129335];
                                    
                                    tmp_129340 = x_133420;
                                } else {
                                    tmp_129340 = (int64_t) 0;
                                }
                                
                                int64_t lmad_ext_133265 = b_119032 * tmp_129340;
                                int64_t ext_133267;
                                
                                if (cond_129308) {
                                    ext_133267 = lmad_ext_133219;
                                } else {
                                    ext_133267 = lmad_ext_133265;
                                }
                                
                                bool cond_129800;
                                
                                if (cond_129308) {
                                    cond_129800 = 1;
                                } else {
                                    if (!cond_129308) {
                                        bool x_129341 = sle64((int64_t) 0, tmp_129340);
                                        bool y_129342 = slt64(tmp_129340, nS_119033);
                                        bool bounds_check_129343 = x_129341 && y_129342;
                                        bool index_certs_129344;
                                        
                                        if (!bounds_check_129343) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129340, "] out of bounds for array of shape [", (long long) nS_119033, "].", "-> #0  ftHashJoin.fut:363:56-77\n   #1  ftHashJoin.fut:424:3-430:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                    }
                                    if (mem_133268_cached_sizze_133614 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133268, &mem_133268_cached_sizze_133614, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133269_cached_sizze_133615 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133269, &mem_133269_cached_sizze_133615, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133282_cached_sizze_133616 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133282, &mem_133282_cached_sizze_133616, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133283_cached_sizze_133617 < b_119032) {
                                        err = lexical_realloc(ctx, &mem_133283, &mem_133283_cached_sizze_133617, b_119032);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    
                                    bool radix_lt_res_129802;
                                    int32_t radix_lt_res_129803;
                                    bool radix_lt_res_129804;
                                    bool loop_while_129805;
                                    int32_t p_129806;
                                    bool p_129807;
                                    
                                    loop_while_129805 = loop_cond_t_res_129801;
                                    p_129806 = 0;
                                    p_129807 = 0;
                                    while (loop_while_129805) {
                                        int32_t zt_rhs_129808 = add32(1, p_129806);
                                        int32_t zm_lhs_129809 = mul32(radix_sizze_119036, zt_rhs_129808);
                                        int32_t byteSeq_lt_arg1_129810 = sub32(zm_lhs_129809, 1);
                                        int32_t byteSeq_lt_arg0_129811 = mul32(radix_sizze_119036, p_129806);
                                        int32_t min_res_129812 = smin32(min_arg1_127858, byteSeq_lt_arg1_129810);
                                        int32_t zm_rhs_129813 = sdiv32(byteSeq_lt_arg0_129811, 8);
                                        int32_t zm_lhs_129814 = sub32(i64_res_127856, zm_rhs_129813);
                                        int32_t i32_arg0_129815 = sub32(zm_lhs_129814, 1);
                                        int64_t i32_res_129816 = sext_i32_i64(i32_arg0_129815);
                                        int32_t zm_rhs_129817 = sdiv32(min_res_129812, 8);
                                        int32_t zm_lhs_129818 = sub32(i64_res_127856, zm_rhs_129817);
                                        int32_t i32_arg0_129819 = sub32(zm_lhs_129818, 1);
                                        int64_t i32_res_129820 = sext_i32_i64(i32_arg0_129819);
                                        int64_t min_res_129821 = smin64(min_arg1_127871, i32_res_129820);
                                        bool x_129837 = sle64((int64_t) 0, i32_res_129816);
                                        bool y_129838 = slt64(i32_res_129816, b_119032);
                                        bool bounds_check_129839 = x_129837 && y_129838;
                                        bool index_certs_129840;
                                        
                                        if (!bounds_check_129839) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_129816, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:304:1-311:54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129844 = sle64((int64_t) 0, min_res_129821);
                                        bool y_129845 = slt64(min_res_129821, b_119032);
                                        bool bounds_check_129846 = x_129844 && y_129845;
                                        bool index_certs_129847;
                                        
                                        if (!bounds_check_129846) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_129821, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:304:1-311:54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t firstBit_129822 = smod32(byteSeq_lt_arg0_129811, 8);
                                        int32_t lastBit_129823 = smod32(min_res_129812, 8);
                                        int8_t unsign_arg0_129824 = zext_i32_i8(firstBit_129822);
                                        int8_t first_bitMask_129825 = shl8((int8_t) -1, unsign_arg0_129824);
                                        int32_t zm_lhs_129826 = sub32(8, lastBit_129823);
                                        int32_t i32_arg0_129827 = sub32(zm_lhs_129826, 1);
                                        int8_t unsign_arg0_129828 = zext_i32_i8(i32_arg0_129827);
                                        int8_t unsign_arg0_129829 = lshr8((int8_t) -1, unsign_arg0_129828);
                                        
                                        for (int64_t i_133082 = 0; i_133082 < b_119032; i_133082++) {
                                            int8_t eta_p_130479 = ((int8_t *) pS_mem_133176.mem)[ext_133267 + i_133082];
                                            int8_t eta_p_130480 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133082];
                                            bool cond_130486 = sle64(i_133082, i32_res_129816);
                                            bool cond_t_res_130487 = sle64(min_res_129821, i_133082);
                                            bool x_130488 = cond_130486 && cond_t_res_130487;
                                            int8_t lifted_lambda_res_130489;
                                            
                                            if (x_130488) {
                                                lifted_lambda_res_130489 = eta_p_130480;
                                            } else {
                                                lifted_lambda_res_130489 = (int8_t) 0;
                                            }
                                            
                                            int8_t lifted_lambda_res_130494;
                                            
                                            if (x_130488) {
                                                lifted_lambda_res_130494 = eta_p_130479;
                                            } else {
                                                lifted_lambda_res_130494 = (int8_t) 0;
                                            }
                                            ((int8_t *) mem_133268)[i_133082] = lifted_lambda_res_130494;
                                            ((int8_t *) mem_133269)[i_133082] = lifted_lambda_res_130489;
                                        }
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133282, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133269, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133283, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133268, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
                                        
                                        int8_t za_lhs_129841 = ((int8_t *) mem_133282)[i32_res_129816];
                                        int8_t mod1_x_129842 = first_bitMask_129825 & za_lhs_129841;
                                        
                                        ((int8_t *) mem_133282)[i32_res_129816] = mod1_x_129842;
                                        
                                        int8_t za_lhs_129848 = ((int8_t *) mem_133282)[min_res_129821];
                                        int8_t tmp_129849 = unsign_arg0_129829 & za_lhs_129848;
                                        
                                        ((int8_t *) mem_133282)[min_res_129821] = tmp_129849;
                                        
                                        int8_t za_lhs_129858 = ((int8_t *) mem_133283)[i32_res_129816];
                                        int8_t mod1_x_129859 = first_bitMask_129825 & za_lhs_129858;
                                        
                                        ((int8_t *) mem_133283)[i32_res_129816] = mod1_x_129859;
                                        
                                        int8_t za_lhs_129861 = ((int8_t *) mem_133283)[min_res_129821];
                                        int8_t tmp_129862 = unsign_arg0_129829 & za_lhs_129861;
                                        
                                        ((int8_t *) mem_133283)[min_res_129821] = tmp_129862;
                                        
                                        int32_t zm_rhs_129864 = sdiv32(byteSeq_lt_arg1_129810, 8);
                                        int32_t zm_lhs_129865 = sub32(i64_res_127856, zm_rhs_129864);
                                        int32_t i32_arg0_129866 = sub32(zm_lhs_129865, 1);
                                        int64_t i32_res_129867 = sext_i32_i64(i32_arg0_129866);
                                        bool loop_cond_t_res_129868 = slt64(i32_res_129867, i32_res_129816);
                                        bool byteSeq_lt_res_129869;
                                        int64_t byteSeq_lt_res_129870;
                                        bool byteSeq_lt_res_129871;
                                        bool loop_while_129872;
                                        int64_t p_129873;
                                        bool p_129874;
                                        
                                        loop_while_129872 = loop_cond_t_res_129868;
                                        p_129873 = i32_res_129867;
                                        p_129874 = 0;
                                        while (loop_while_129872) {
                                            bool x_129875 = sle64((int64_t) 0, p_129873);
                                            bool y_129876 = slt64(p_129873, b_119032);
                                            bool bounds_check_129877 = x_129875 && y_129876;
                                            bool index_certs_129878;
                                            
                                            if (!bounds_check_129877) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129873, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:89:17-27\n   #1  ftRelational.fut:304:1-311:54\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_129879 = ((int8_t *) mem_133282)[p_129873];
                                            int8_t zl_rhs_129880 = ((int8_t *) mem_133283)[p_129873];
                                            bool dlt_129881 = ult8(zl_lhs_129879, zl_rhs_129880);
                                            bool dgt_129882 = ult8(zl_rhs_129880, zl_lhs_129879);
                                            bool tmp_129883 = dlt_129881 || dgt_129882;
                                            bool cond_129884 = !tmp_129883;
                                            int64_t tmp_129885;
                                            
                                            if (cond_129884) {
                                                int64_t tmp_t_res_132939 = add64((int64_t) 1, p_129873);
                                                
                                                tmp_129885 = tmp_t_res_132939;
                                            } else {
                                                tmp_129885 = i32_res_129816;
                                            }
                                            
                                            bool cond_129887 = !dlt_129881;
                                            bool loop_cond_t_res_129888 = slt64(tmp_129885, i32_res_129816);
                                            bool x_129889 = cond_129887 && loop_cond_t_res_129888;
                                            bool loop_while_tmp_133565 = x_129889;
                                            int64_t p_tmp_133566 = tmp_129885;
                                            bool p_tmp_133567 = dlt_129881;
                                            
                                            loop_while_129872 = loop_while_tmp_133565;
                                            p_129873 = p_tmp_133566;
                                            p_129874 = p_tmp_133567;
                                        }
                                        byteSeq_lt_res_129869 = loop_while_129872;
                                        byteSeq_lt_res_129870 = p_129873;
                                        byteSeq_lt_res_129871 = p_129874;
                                        
                                        int8_t za_lhs_129897 = ((int8_t *) mem_133269)[i32_res_129816];
                                        int8_t mod1_x_129898 = first_bitMask_129825 & za_lhs_129897;
                                        
                                        ((int8_t *) mem_133269)[i32_res_129816] = mod1_x_129898;
                                        
                                        int8_t za_lhs_129900 = ((int8_t *) mem_133269)[min_res_129821];
                                        int8_t tmp_129901 = unsign_arg0_129829 & za_lhs_129900;
                                        
                                        ((int8_t *) mem_133269)[min_res_129821] = tmp_129901;
                                        
                                        int8_t za_lhs_129910 = ((int8_t *) mem_133268)[i32_res_129816];
                                        int8_t mod1_x_129911 = first_bitMask_129825 & za_lhs_129910;
                                        
                                        ((int8_t *) mem_133268)[i32_res_129816] = mod1_x_129911;
                                        
                                        int8_t za_lhs_129913 = ((int8_t *) mem_133268)[min_res_129821];
                                        int8_t tmp_129914 = unsign_arg0_129829 & za_lhs_129913;
                                        
                                        ((int8_t *) mem_133268)[min_res_129821] = tmp_129914;
                                        
                                        bool byteSeq_gt_res_129916;
                                        int64_t byteSeq_gt_res_129917;
                                        bool byteSeq_gt_res_129918;
                                        bool loop_while_129919;
                                        int64_t p_129920;
                                        bool p_129921;
                                        
                                        loop_while_129919 = loop_cond_t_res_129868;
                                        p_129920 = i32_res_129867;
                                        p_129921 = 0;
                                        while (loop_while_129919) {
                                            bool x_129922 = sle64((int64_t) 0, p_129920);
                                            bool y_129923 = slt64(p_129920, b_119032);
                                            bool bounds_check_129924 = x_129922 && y_129923;
                                            bool index_certs_129925;
                                            
                                            if (!bounds_check_129924) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129920, "] out of bounds for array of shape [", (long long) b_119032, "].", "-> #0  ftHashJoin.fut:126:17-27\n   #1  ftRelational.fut:304:1-311:54\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_129926 = ((int8_t *) mem_133269)[p_129920];
                                            int8_t zl_rhs_129927 = ((int8_t *) mem_133268)[p_129920];
                                            bool dlt_129928 = ult8(zl_lhs_129926, zl_rhs_129927);
                                            bool dgt_129929 = ult8(zl_rhs_129927, zl_lhs_129926);
                                            bool tmp_129930 = dlt_129928 || dgt_129929;
                                            bool cond_129931 = !tmp_129930;
                                            int64_t tmp_129932;
                                            
                                            if (cond_129931) {
                                                int64_t tmp_t_res_132940 = add64((int64_t) 1, p_129920);
                                                
                                                tmp_129932 = tmp_t_res_132940;
                                            } else {
                                                tmp_129932 = i32_res_129816;
                                            }
                                            
                                            bool cond_129934 = !dgt_129929;
                                            bool loop_cond_t_res_129935 = slt64(tmp_129932, i32_res_129816);
                                            bool x_129936 = cond_129934 && loop_cond_t_res_129935;
                                            bool loop_while_tmp_133568 = x_129936;
                                            int64_t p_tmp_133569 = tmp_129932;
                                            bool p_tmp_133570 = dgt_129929;
                                            
                                            loop_while_129919 = loop_while_tmp_133568;
                                            p_129920 = p_tmp_133569;
                                            p_129921 = p_tmp_133570;
                                        }
                                        byteSeq_gt_res_129916 = loop_while_129919;
                                        byteSeq_gt_res_129917 = p_129920;
                                        byteSeq_gt_res_129918 = p_129921;
                                        
                                        bool tmp_129937 = byteSeq_lt_res_129871 || byteSeq_gt_res_129918;
                                        bool cond_129938 = !tmp_129937;
                                        int32_t tmp_129939;
                                        
                                        if (cond_129938) {
                                            tmp_129939 = zt_rhs_129808;
                                        } else {
                                            tmp_129939 = next_depth_129309;
                                        }
                                        
                                        bool cond_129940 = !byteSeq_lt_res_129871;
                                        bool loop_cond_t_res_129941 = slt32(tmp_129939, next_depth_129309);
                                        bool x_129942 = cond_129940 && loop_cond_t_res_129941;
                                        bool loop_while_tmp_133560 = x_129942;
                                        int32_t p_tmp_133561 = tmp_129939;
                                        bool p_tmp_133562 = byteSeq_lt_res_129871;
                                        
                                        loop_while_129805 = loop_while_tmp_133560;
                                        p_129806 = p_tmp_133561;
                                        p_129807 = p_tmp_133562;
                                    }
                                    radix_lt_res_129802 = loop_while_129805;
                                    radix_lt_res_129803 = p_129806;
                                    radix_lt_res_129804 = p_129807;
                                    cond_129800 = radix_lt_res_129804;
                                }
                                
                                int64_t loopres_f_res_f_res_f_res_129943;
                                int64_t loopres_f_res_f_res_f_res_129944;
                                
                                if (cond_129800) {
                                    loopres_f_res_f_res_f_res_129943 = (int64_t) -1;
                                    loopres_f_res_f_res_f_res_129944 = (int64_t) 0;
                                } else {
                                    int64_t tmp_129945 = add64(heshi_129293, step_129294);
                                    int64_t max_arg1_129946 = sdiv64(step_129294, (int64_t) 2);
                                    int64_t max_res_129947 = smax64((int64_t) 1, max_arg1_129946);
                                    
                                    loopres_f_res_f_res_f_res_129943 = tmp_129945;
                                    loopres_f_res_f_res_f_res_129944 = max_res_129947;
                                }
                                loopres_f_res_f_res_129650 = loopres_f_res_f_res_f_res_129943;
                                loopres_f_res_f_res_129651 = loopres_f_res_f_res_f_res_129944;
                            }
                            loopres_f_res_129503 = loopres_f_res_f_res_129650;
                            loopres_f_res_129504 = loopres_f_res_f_res_129651;
                        }
                        loopres_129492 = loopres_f_res_129503;
                        loopres_129493 = loopres_f_res_129504;
                    }
                    
                    bool loop_cond_129948 = slt64((int64_t) 0, loopres_129493);
                    bool loop_while_tmp_133528 = loop_cond_129948;
                    int64_t heshi_tmp_133529 = loopres_129492;
                    int64_t step_tmp_133530 = loopres_129493;
                    
                    loop_while_129292 = loop_while_tmp_133528;
                    heshi_129293 = heshi_tmp_133529;
                    step_129294 = step_tmp_133530;
                }
                rv_partitionMatchBounds_res_f_res_f_res_129289 = loop_while_129292;
                rv_partitionMatchBounds_res_f_res_f_res_129290 = heshi_129293;
                rv_partitionMatchBounds_res_f_res_f_res_129291 = step_129294;
                rv_partitionMatchBounds_res_f_res_129268 = rv_partitionMatchBounds_res_f_res_f_res_129290;
            }
            rv_partitionMatchBounds_res_129261 = rv_partitionMatchBounds_res_f_res_129268;
        }
        
        bool cond_129950 = slt64(rv_partitionMatchBounds_res_129261, (int64_t) 0);
        bool cond_129952 = sle64((int64_t) 0, rv_partitionMatchBounds_res_129261);
        bool y_129953 = slt64(rv_partitionMatchBounds_res_129261, dz2081U_119034);
        bool bounds_check_129954 = cond_129952 && y_129953;
        bool loop_not_taken_129955 = !cond_129952;
        bool protect_assert_disj_129956 = bounds_check_129954 || loop_not_taken_129955;
        bool protect_assert_disj_129957 = cond_129950 || protect_assert_disj_129956;
        bool index_certs_129958;
        
        if (!protect_assert_disj_129957) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) rv_partitionMatchBounds_res_129261, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:437:43-56\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool cond_129963 = rv_partitionMatchBounds_res_129261 == zeze_rhs_123782;
        int64_t tmp_129965 = add64((int64_t) 1, rv_partitionMatchBounds_res_129261);
        bool x_129966 = sle64((int64_t) 0, tmp_129965);
        bool y_129967 = slt64(tmp_129965, dz2081U_119034);
        bool bounds_check_129968 = x_129966 && y_129967;
        bool protect_assert_disj_129969 = cond_129963 || bounds_check_129968;
        bool protect_assert_disj_129970 = cond_129950 || protect_assert_disj_129969;
        bool index_certs_129971;
        
        if (!protect_assert_disj_129970) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129965, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:438:54-69\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_129951 = !cond_129950;
        bool protect_cond_conj_129959 = x_129951 && cond_129952;
        int64_t inf_s_idx_t_res_129960;
        
        if (protect_cond_conj_129959) {
            int64_t x_132949 = ((int64_t *) bounds_mem_133177.mem)[rv_partitionMatchBounds_res_129261];
            
            inf_s_idx_t_res_129960 = x_132949;
        } else {
            inf_s_idx_t_res_129960 = (int64_t) 0;
        }
        
        int64_t inf_s_idx_129962;
        
        if (cond_129952) {
            inf_s_idx_129962 = inf_s_idx_t_res_129960;
        } else {
            inf_s_idx_129962 = (int64_t) 0;
        }
        
        bool x_129964 = !cond_129963;
        bool protect_cond_conj_129972 = x_129951 && x_129964;
        int64_t sup_s_idx_f_res_129973;
        
        if (protect_cond_conj_129972) {
            int64_t x_132950 = ((int64_t *) bounds_mem_133177.mem)[tmp_129965];
            
            sup_s_idx_f_res_129973 = x_132950;
        } else {
            sup_s_idx_f_res_129973 = (int64_t) 0;
        }
        
        int64_t sup_s_idx_129975;
        
        if (cond_129963) {
            sup_s_idx_129975 = nS_119033;
        } else {
            sup_s_idx_129975 = sup_s_idx_f_res_129973;
        }
        
        int64_t j_m_i_129976 = sub64(sup_s_idx_129975, inf_s_idx_129962);
        int64_t lifted_lambda_res_129977;
        int64_t lifted_lambda_res_129978;
        
        if (cond_129950) {
            lifted_lambda_res_129977 = (int64_t) 0;
            lifted_lambda_res_129978 = (int64_t) -1;
        } else {
            bool zzero_lte_i_129989 = sle64((int64_t) 0, inf_s_idx_129962);
            int64_t m_129985 = sub64(j_m_i_129976, (int64_t) 1);
            int64_t i_p_m_t_s_129986 = add64(inf_s_idx_129962, m_129985);
            bool i_p_m_t_s_leq_w_129988 = slt64(i_p_m_t_s_129986, nS_119033);
            bool y_129991 = i_p_m_t_s_leq_w_129988 && zzero_lte_i_129989;
            bool zzero_leq_i_p_m_t_s_129987 = sle64((int64_t) 0, i_p_m_t_s_129986);
            bool y_129992 = zzero_leq_i_p_m_t_s_129987 && y_129991;
            bool i_lte_j_129990 = sle64(inf_s_idx_129962, sup_s_idx_129975);
            bool forwards_ok_129993 = i_lte_j_129990 && y_129992;
            bool empty_slice_129984 = j_m_i_129976 == (int64_t) 0;
            bool ok_or_empty_129994 = empty_slice_129984 || forwards_ok_129993;
            bool index_certs_129995;
            
            if (!ok_or_empty_129994) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_s_idx_129962, ":", (long long) sup_s_idx_129975, "] out of bounds for array of shape [", (long long) nS_119033, "].", "-> #0  ftHashJoin.fut:439:23-46\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_f_res_129996;
            int64_t lifted_lambda_res_f_res_129997;
            
            if (cond_129952) {
                bool loop_cond_132958 = slt64((int64_t) 0, j_m_i_129976);
                bool rv_findPairCount_res_132959;
                int64_t rv_findPairCount_res_132960;
                int64_t rv_findPairCount_res_132961;
                int64_t rv_findPairCount_res_132962;
                bool loop_while_132963;
                int64_t count_132964;
                int64_t j_132965;
                int64_t i0_132966;
                
                loop_while_132963 = loop_cond_132958;
                count_132964 = (int64_t) 0;
                j_132965 = (int64_t) 0;
                i0_132966 = (int64_t) -1;
                while (loop_while_132963) {
                    bool x_132967 = sle64((int64_t) 0, j_132965);
                    bool y_132968 = slt64(j_132965, j_m_i_129976);
                    bool bounds_check_132969 = x_132967 && y_132968;
                    bool index_certs_132970;
                    
                    if (!bounds_check_132969) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_132965, "] out of bounds for array of shape [", (long long) j_m_i_129976, "].", "-> #0  ftHashJoin.fut:388:33-38\n   #1  ftHashJoin.fut:443:30-55\n   #2  /prelude/soacs.fut:67:23-24\n   #3  /prelude/soacs.fut:67:27-37\n   #4  ftRelational.fut:308:4-311:35\n   #5  ftRelational.fut:304:1-311:54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_132971 = inf_s_idx_129962 + j_132965;
                    bool defunc_0_reduce_res_132973;
                    bool redout_133085 = 1;
                    
                    for (int64_t i_133086 = 0; i_133086 < b_119032; i_133086++) {
                        int8_t eta_p_132974 = ((int8_t *) pR_mem_133175.mem)[i_133102 * b_119032 + i_133086];
                        int8_t eta_p_132975 = ((int8_t *) pS_mem_133176.mem)[slice_132971 * b_119032 + i_133086];
                        bool defunc_0_f_res_132976 = eta_p_132974 == eta_p_132975;
                        bool x_132979 = defunc_0_f_res_132976 && redout_133085;
                        bool redout_tmp_133575 = x_132979;
                        
                        redout_133085 = redout_tmp_133575;
                    }
                    defunc_0_reduce_res_132973 = redout_133085;
                    
                    int64_t loopres_132981;
                    int64_t loopres_132982;
                    int64_t loopres_132983;
                    
                    if (defunc_0_reduce_res_132973) {
                        int64_t tmp_132984 = add64((int64_t) 1, count_132964);
                        int64_t tmp_132985 = add64((int64_t) 1, j_132965);
                        bool cond_132986 = slt64(i0_132966, (int64_t) 0);
                        int64_t tmp_132987;
                        
                        if (cond_132986) {
                            tmp_132987 = j_132965;
                        } else {
                            tmp_132987 = i0_132966;
                        }
                        loopres_132981 = tmp_132984;
                        loopres_132982 = tmp_132985;
                        loopres_132983 = tmp_132987;
                    } else {
                        int64_t tmp_132988 = add64((int64_t) 1, j_132965);
                        
                        loopres_132981 = count_132964;
                        loopres_132982 = tmp_132988;
                        loopres_132983 = i0_132966;
                    }
                    
                    bool loop_cond_132989 = slt64(loopres_132982, j_m_i_129976);
                    bool loop_while_tmp_133571 = loop_cond_132989;
                    int64_t count_tmp_133572 = loopres_132981;
                    int64_t j_tmp_133573 = loopres_132982;
                    int64_t i0_tmp_133574 = loopres_132983;
                    
                    loop_while_132963 = loop_while_tmp_133571;
                    count_132964 = count_tmp_133572;
                    j_132965 = j_tmp_133573;
                    i0_132966 = i0_tmp_133574;
                }
                rv_findPairCount_res_132959 = loop_while_132963;
                rv_findPairCount_res_132960 = count_132964;
                rv_findPairCount_res_132961 = j_132965;
                rv_findPairCount_res_132962 = i0_132966;
                
                int64_t tmp_132990 = add64(inf_s_idx_129962, rv_findPairCount_res_132962);
                
                lifted_lambda_res_f_res_129996 = rv_findPairCount_res_132960;
                lifted_lambda_res_f_res_129997 = tmp_132990;
            } else {
                lifted_lambda_res_f_res_129996 = (int64_t) 0;
                lifted_lambda_res_f_res_129997 = (int64_t) -1;
            }
            lifted_lambda_res_129977 = lifted_lambda_res_f_res_129996;
            lifted_lambda_res_129978 = lifted_lambda_res_f_res_129997;
        }
        
        bool lifted_lambda_res_130034 = slt64((int64_t) 1, lifted_lambda_res_129977);
        int64_t defunc_0_f_res_130035 = btoi_bool_i64(lifted_lambda_res_130034);
        int64_t defunc_0_op_res_123902 = add64(defunc_0_f_res_130035, scanacc_133093);
        int64_t defunc_0_op_res_123873 = add64(lifted_lambda_res_129977, scanacc_133094);
        int64_t zp_res_123893 = add64(lifted_lambda_res_129977, redout_133097);
        
        ((int64_t *) mem_133182)[i_133102] = defunc_0_op_res_123902;
        ((int64_t *) mem_133184)[i_133102] = defunc_0_op_res_123873;
        ((int64_t *) mem_133186)[i_133102] = defunc_0_f_res_130035;
        ((int64_t *) mem_133188)[i_133102] = lifted_lambda_res_129977;
        ((int64_t *) mem_133190)[i_133102] = lifted_lambda_res_129978;
        ((int64_t *) mem_133192)[i_133102] = rv_partitionMatchBounds_res_129261;
        
        int64_t scanacc_tmp_133517 = defunc_0_op_res_123902;
        int64_t scanacc_tmp_133518 = defunc_0_op_res_123873;
        int64_t redout_tmp_133521 = zp_res_123893;
        
        scanacc_133093 = scanacc_tmp_133517;
        scanacc_133094 = scanacc_tmp_133518;
        redout_133097 = redout_tmp_133521;
    }
    discard_133109 = scanacc_133093;
    discard_133110 = scanacc_133094;
    defunc_res_133031 = redout_133097;
    
    bool cond_123903 = nR_119031 == (int64_t) 0;
    bool x_123904 = !cond_123903;
    int64_t tmp_123905 = sub64(nR_119031, (int64_t) 1);
    bool x_123906 = sle64((int64_t) 0, tmp_123905);
    bool y_123907 = slt64(tmp_123905, nR_119031);
    bool bounds_check_123908 = x_123906 && y_123907;
    bool protect_assert_disj_123909 = cond_123903 || bounds_check_123908;
    bool index_certs_123910;
    
    if (!protect_assert_disj_123909) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_123905, "] out of bounds for array of shape [", (long long) nR_119031, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:308:4-311:35\n   #3  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_123911;
    
    if (x_123904) {
        int64_t x_132992 = ((int64_t *) mem_133182)[tmp_123905];
        
        m_f_res_123911 = x_132992;
    } else {
        m_f_res_123911 = (int64_t) 0;
    }
    
    int64_t m_123913;
    
    if (cond_123903) {
        m_123913 = (int64_t) 0;
    } else {
        m_123913 = m_f_res_123911;
    }
    
    bool cond_123936 = slt64((int64_t) 0, m_123913);
    int64_t m_123923 = sub64(m_123913, (int64_t) 1);
    bool i_p_m_t_s_leq_w_123925 = slt64(m_123923, nR_119031);
    bool zzero_leq_i_p_m_t_s_123924 = sle64((int64_t) 0, m_123923);
    bool y_123927 = zzero_leq_i_p_m_t_s_123924 && i_p_m_t_s_leq_w_123925;
    bool i_lte_j_123926 = sle64((int64_t) 0, m_123913);
    bool forwards_ok_123928 = i_lte_j_123926 && y_123927;
    bool eq_x_zz_123920 = (int64_t) 0 == m_f_res_123911;
    bool p_and_eq_x_y_123921 = x_123904 && eq_x_zz_123920;
    bool empty_slice_123922 = cond_123903 || p_and_eq_x_y_123921;
    bool ok_or_empty_123929 = empty_slice_123922 || forwards_ok_123928;
    bool index_certs_123930;
    
    if (!ok_or_empty_123929) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_123913, "] out of bounds for array of shape [", (long long) nR_119031, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:308:4-311:35\n   #3  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133326 = (int64_t) 8 * m_123913;
    
    if (mem_133327_cached_sizze_133623 < bytes_133326) {
        err = lexical_realloc(ctx, &mem_133327, &mem_133327_cached_sizze_133623, bytes_133326);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133327, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133188, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_123913});
    
    int64_t max_mult_123937;
    
    if (cond_123936) {
        if (mem_133329_cached_sizze_133624 < bytes_133181) {
            err = lexical_realloc(ctx, &mem_133329, &mem_133329_cached_sizze_133624, bytes_133181);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133117 = 0; i_133117 < nR_119031; i_133117++) {
            int64_t eta_p_132998 = ((int64_t *) mem_133186)[i_133117];
            int64_t eta_p_132999 = ((int64_t *) mem_133182)[i_133117];
            bool cond_133000 = eta_p_132998 == (int64_t) 1;
            int64_t lifted_lambda_res_133001;
            
            if (cond_133000) {
                int64_t lifted_lambda_res_t_res_133002 = sub64(eta_p_132999, (int64_t) 1);
                
                lifted_lambda_res_133001 = lifted_lambda_res_t_res_133002;
            } else {
                lifted_lambda_res_133001 = (int64_t) -1;
            }
            ((int64_t *) mem_133329)[i_133117] = lifted_lambda_res_133001;
        }
        for (int64_t write_iter_133119 = 0; write_iter_133119 < nR_119031; write_iter_133119++) {
            int64_t write_iv_133121 = ((int64_t *) mem_133329)[write_iter_133119];
            int64_t write_iv_133122 = ((int64_t *) mem_133188)[write_iter_133119];
            
            if (sle64((int64_t) 0, write_iv_133121) && slt64(write_iv_133121, m_123913)) {
                ((int64_t *) mem_133327)[write_iv_133121] = write_iv_133122;
            }
        }
        
        int64_t defunc_0_reduce_res_133012;
        int64_t redout_133124 = (int64_t) -9223372036854775808;
        
        for (int64_t i_133125 = 0; i_133125 < m_123913; i_133125++) {
            int64_t x_133013 = ((int64_t *) mem_133327)[i_133125];
            int64_t max_res_133016 = smax64(x_133013, redout_133124);
            int64_t redout_tmp_133578 = max_res_133016;
            
            redout_133124 = redout_tmp_133578;
        }
        defunc_0_reduce_res_133012 = redout_133124;
        max_mult_123937 = defunc_0_reduce_res_133012;
    } else {
        max_mult_123937 = (int64_t) 1;
    }
    
    int64_t bytes_133342 = (int64_t) 8 * defunc_res_133031;
    bool bounds_invalid_upwards_123948 = slt64(max_mult_123937, (int64_t) 1);
    bool valid_123950 = !bounds_invalid_upwards_123948;
    bool range_valid_c_123951;
    
    if (!valid_123950) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_123937, " is invalid.", "-> #0  ftHashJoin.fut:468:18-30\n   #1  ftRelational.fut:308:4-311:35\n   #2  ftRelational.fut:304:1-311:54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133380 = b_119032 * defunc_res_133031;
    
    if (mem_133319_cached_sizze_133622 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133319, &mem_133319_cached_sizze_133622, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133113 = 0; i_133113 < nR_119031; i_133113++) {
        int64_t eta_p_128922 = ((int64_t *) mem_133188)[i_133113];
        int64_t zv_lhs_128924 = add64((int64_t) -1, i_133113);
        int64_t tmp_128925 = smod64(zv_lhs_128924, nR_119031);
        int64_t lifted_lambda_res_128926 = ((int64_t *) mem_133184)[tmp_128925];
        bool cond_128928 = i_133113 == (int64_t) 0;
        int64_t lifted_lambda_res_128929;
        
        if (cond_128928) {
            lifted_lambda_res_128929 = (int64_t) 0;
        } else {
            lifted_lambda_res_128929 = lifted_lambda_res_128926;
        }
        
        bool cond_128931 = slt64((int64_t) 0, eta_p_128922);
        int64_t lifted_lambda_res_128932;
        
        if (cond_128931) {
            lifted_lambda_res_128932 = lifted_lambda_res_128929;
        } else {
            lifted_lambda_res_128932 = (int64_t) -1;
        }
        ((int64_t *) mem_133319)[i_133113] = lifted_lambda_res_128932;
    }
    if (memblock_alloc(ctx, &mem_133343, bytes_133342, "mem_133343")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133580 = 0; nest_i_133580 < defunc_res_133031; nest_i_133580++) {
        ((int64_t *) mem_133343.mem)[nest_i_133580] = (int64_t) 0;
    }
    for (int64_t write_iter_133126 = 0; write_iter_133126 < nR_119031; write_iter_133126++) {
        int64_t write_iv_133128 = ((int64_t *) mem_133319)[write_iter_133126];
        
        if (sle64((int64_t) 0, write_iv_133128) && slt64(write_iv_133128, defunc_res_133031)) {
            ((int64_t *) mem_133343.mem)[write_iv_133128] = write_iter_133126;
        }
    }
    if (memblock_alloc(ctx, &mem_133351, bytes_133342, "mem_133351")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133582 = 0; nest_i_133582 < defunc_res_133031; nest_i_133582++) {
        ((int64_t *) mem_133351.mem)[nest_i_133582] = (int64_t) 1;
    }
    
    int64_t distance_123949 = sub64(max_mult_123937, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_133354, &mem_133351, "mem_133351") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133357, &mem_133343, "mem_133343") != 0)
        return 1;
    for (int64_t i_123954 = 0; i_123954 < distance_123949; i_123954++) {
        int64_t index_primexp_123957 = add64((int64_t) 1, i_123954);
        
        if (memblock_alloc(ctx, &mem_133359, bytes_133342, "mem_133359")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133359.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133357.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_133031});
        if (memblock_alloc(ctx, &mem_133361, bytes_133342, "mem_133361")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133361.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133354.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_133031});
        
        int64_t replicate_arg1_123969 = add64((int64_t) 2, i_123954);
        
        for (int64_t write_iter_133131 = 0; write_iter_133131 < nR_119031; write_iter_133131++) {
            int64_t zlze_lhs_132673 = ((int64_t *) mem_133188)[write_iter_133131];
            bool cond_132674 = sle64(zlze_lhs_132673, index_primexp_123957);
            int64_t lifted_lambda_res_132675;
            
            if (cond_132674) {
                lifted_lambda_res_132675 = (int64_t) -1;
            } else {
                int64_t zp_lhs_132676 = ((int64_t *) mem_133319)[write_iter_133131];
                int64_t lifted_lambda_res_f_res_132677 = add64(index_primexp_123957, zp_lhs_132676);
                
                lifted_lambda_res_132675 = lifted_lambda_res_f_res_132677;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_132675) && slt64(lifted_lambda_res_132675, defunc_res_133031)) {
                ((int64_t *) mem_133361.mem)[lifted_lambda_res_132675] = replicate_arg1_123969;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_132675) && slt64(lifted_lambda_res_132675, defunc_res_133031)) {
                ((int64_t *) mem_133359.mem)[lifted_lambda_res_132675] = write_iter_133131;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_133583, &mem_133361, "mem_133361") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133584, &mem_133359, "mem_133359") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133354, &mem_param_tmp_133583, "mem_param_tmp_133583") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133357, &mem_param_tmp_133584, "mem_param_tmp_133584") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133379, &mem_param_133354, "mem_param_133354") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133378, &mem_param_133357, "mem_param_133357") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133343, "mem_133343") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133351, "mem_133351") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133381, bytes_133380, "mem_133381")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133383, bytes_133342, "mem_133383")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133143 = 0; i_133143 < defunc_res_133031; i_133143++) {
        int64_t eta_p_130045 = ((int64_t *) ext_mem_133378.mem)[i_133143];
        bool x_130047 = sle64((int64_t) 0, eta_p_130045);
        bool y_130048 = slt64(eta_p_130045, nR_119031);
        bool bounds_check_130049 = x_130047 && y_130048;
        bool index_certs_130050;
        
        if (!bounds_check_130049) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_130045, "] out of bounds for array of shape [", (long long) nR_119031, "].", "-> #0  ftHashJoin.fut:478:16-22\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:308:4-311:35\n   #3  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t fm_130052 = ((int64_t *) mem_133192)[eta_p_130045];
        int64_t inf_s_idx_130053 = ((int64_t *) mem_133190)[eta_p_130045];
        bool cond_130054 = fm_130052 == zeze_rhs_123782;
        bool x_130055 = !cond_130054;
        int64_t tmp_130056 = add64((int64_t) 1, fm_130052);
        bool x_130057 = sle64((int64_t) 0, tmp_130056);
        bool y_130058 = slt64(tmp_130056, dz2081U_119034);
        bool bounds_check_130059 = x_130057 && y_130058;
        bool protect_assert_disj_130060 = cond_130054 || bounds_check_130059;
        bool index_certs_130061;
        
        if (!protect_assert_disj_130060) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_130056, "] out of bounds for array of shape [", (long long) dz2081U_119034, "].", "-> #0  ftHashJoin.fut:481:50-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:308:4-311:35\n   #3  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t sup_s_idx_f_res_130062;
        
        if (x_130055) {
            int64_t x_133024 = ((int64_t *) bounds_mem_133177.mem)[tmp_130056];
            
            sup_s_idx_f_res_130062 = x_133024;
        } else {
            sup_s_idx_f_res_130062 = (int64_t) 0;
        }
        
        int64_t sup_s_idx_130064;
        
        if (cond_130054) {
            sup_s_idx_130064 = nS_119033;
        } else {
            sup_s_idx_130064 = sup_s_idx_f_res_130062;
        }
        
        int64_t j_m_i_130065 = sub64(sup_s_idx_130064, inf_s_idx_130053);
        bool empty_slice_130066 = j_m_i_130065 == (int64_t) 0;
        int64_t m_130067 = sub64(j_m_i_130065, (int64_t) 1);
        int64_t i_p_m_t_s_130068 = add64(inf_s_idx_130053, m_130067);
        bool zzero_leq_i_p_m_t_s_130069 = sle64((int64_t) 0, i_p_m_t_s_130068);
        bool i_p_m_t_s_leq_w_130070 = slt64(i_p_m_t_s_130068, nS_119033);
        bool zzero_lte_i_130071 = sle64((int64_t) 0, inf_s_idx_130053);
        bool i_lte_j_130072 = sle64(inf_s_idx_130053, sup_s_idx_130064);
        bool y_130073 = i_p_m_t_s_leq_w_130070 && zzero_lte_i_130071;
        bool y_130074 = zzero_leq_i_p_m_t_s_130069 && y_130073;
        bool forwards_ok_130075 = i_lte_j_130072 && y_130074;
        bool ok_or_empty_130076 = empty_slice_130066 || forwards_ok_130075;
        bool index_certs_130077;
        
        if (!ok_or_empty_130076) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_s_idx_130053, ":", (long long) sup_s_idx_130064, "] out of bounds for array of shape [", (long long) nS_119033, "].", "-> #0  ftHashJoin.fut:482:19-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:308:4-311:35\n   #3  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_130116;
        
        if (!bounds_check_130049) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_130045, "] out of bounds for array of shape [", (long long) nR_119031, "].", "-> #0  ftHashJoin.fut:487:39-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:487:22-46\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t eta_p_130044 = ((int64_t *) ext_mem_133379.mem)[i_133143];
        bool cond_130078 = slt64((int64_t) 0, eta_p_130044);
        bool loop_cond_t_res_130079 = slt64((int64_t) 0, j_m_i_130065);
        bool x_130080 = cond_130078 && loop_cond_t_res_130079;
        bool rv_find_kth_match_res_130081;
        int64_t rv_find_kth_match_res_130082;
        int64_t rv_find_kth_match_res_130083;
        bool loop_while_130084;
        int64_t count_130085;
        int64_t j_130086;
        
        loop_while_130084 = x_130080;
        count_130085 = (int64_t) 0;
        j_130086 = (int64_t) 0;
        while (loop_while_130084) {
            bool x_130087 = sle64((int64_t) 0, j_130086);
            bool y_130088 = slt64(j_130086, j_m_i_130065);
            bool bounds_check_130089 = x_130087 && y_130088;
            bool index_certs_130090;
            
            if (!bounds_check_130089) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_130086, "] out of bounds for array of shape [", (long long) j_m_i_130065, "].", "-> #0  ftHashJoin.fut:400:33-38\n   #1  ftHashJoin.fut:483:11-39\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:308:4-311:35\n   #4  ftRelational.fut:304:1-311:54\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t slice_130091 = inf_s_idx_130053 + j_130086;
            bool defunc_0_reduce_res_133027;
            bool redout_133137 = 1;
            
            for (int64_t i_133138 = 0; i_133138 < b_119032; i_133138++) {
                int8_t eta_p_132683 = ((int8_t *) pR_mem_133175.mem)[eta_p_130045 * b_119032 + i_133138];
                int8_t eta_p_132684 = ((int8_t *) pS_mem_133176.mem)[slice_130091 * b_119032 + i_133138];
                bool defunc_0_f_res_132685 = eta_p_132683 == eta_p_132684;
                bool x_130101 = defunc_0_f_res_132685 && redout_133137;
                bool redout_tmp_133594 = x_130101;
                
                redout_133137 = redout_tmp_133594;
            }
            defunc_0_reduce_res_133027 = redout_133137;
            
            int64_t loopres_130102;
            int64_t loopres_130103;
            
            if (defunc_0_reduce_res_133027) {
                int64_t tmp_133025 = add64((int64_t) 1, count_130085);
                int64_t tmp_133026 = add64((int64_t) 1, j_130086);
                
                loopres_130102 = tmp_133025;
                loopres_130103 = tmp_133026;
            } else {
                int64_t tmp_130106 = add64((int64_t) 1, j_130086);
                
                loopres_130102 = count_130085;
                loopres_130103 = tmp_130106;
            }
            
            bool cond_130107 = slt64(loopres_130102, eta_p_130044);
            bool loop_cond_t_res_130108 = slt64(loopres_130103, j_m_i_130065);
            bool x_130109 = cond_130107 && loop_cond_t_res_130108;
            bool loop_while_tmp_133591 = x_130109;
            int64_t count_tmp_133592 = loopres_130102;
            int64_t j_tmp_133593 = loopres_130103;
            
            loop_while_130084 = loop_while_tmp_133591;
            count_130085 = count_tmp_133592;
            j_130086 = j_tmp_133593;
        }
        rv_find_kth_match_res_130081 = loop_while_130084;
        rv_find_kth_match_res_130082 = count_130085;
        rv_find_kth_match_res_130083 = j_130086;
        
        int64_t rv_find_kth_match_res_130110 = sub64(rv_find_kth_match_res_130083, (int64_t) 1);
        int64_t lifted_lambda_res_130111 = add64(inf_s_idx_130053, rv_find_kth_match_res_130110);
        
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133381.mem, i_133143 * b_119032, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_133175.mem, eta_p_130045 * b_119032, (int64_t []) {(int64_t) 1}, (int64_t []) {b_119032});
        ((int64_t *) mem_133383.mem)[i_133143] = lifted_lambda_res_130111;
    }
    if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133399, bytes_133342, "mem_133399")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133399.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133378.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_133031});
    if (memblock_unref(ctx, &ext_mem_133378, "ext_mem_133378") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133399, "mem_133399") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133383, "mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133381, "mem_133381") != 0)
        return 1;
    prim_out_133516 = defunc_res_133031;
    if (memblock_set(ctx, &*mem_out_p_133595, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133596, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133597, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133598 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133182);
        free(mem_133184);
        free(mem_133186);
        free(mem_133188);
        free(mem_133190);
        free(mem_133192);
        free(mem_133211);
        free(mem_133221);
        free(mem_133222);
        free(mem_133235);
        free(mem_133236);
        free(mem_133249);
        free(mem_133250);
        free(mem_133263);
        free(mem_133264);
        free(mem_133268);
        free(mem_133269);
        free(mem_133282);
        free(mem_133283);
        free(mem_133284);
        free(mem_133285);
        free(mem_133298);
        free(mem_133299);
        free(mem_133319);
        free(mem_133327);
        free(mem_133329);
        if (memblock_unref(ctx, &mem_133399, "mem_133399") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133383, "mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133381, "mem_133381") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133584, "mem_param_tmp_133584") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133583, "mem_param_tmp_133583") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133361, "mem_133361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133359, "mem_133359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133357, "mem_param_133357") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133354, "mem_param_133354") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133378, "ext_mem_133378") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133351, "mem_133351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133343, "mem_133343") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct memblock *mem_out_p_133625, struct memblock *mem_out_p_133626, struct memblock *mem_out_p_133627, int64_t *out_prim_out_133628, struct memblock pR_mem_133175, struct memblock pS_mem_133176, struct memblock bounds_mem_133177, struct memblock depths_mem_133178, struct memblock first_info_idx_mem_133179, struct memblock last_info_idx_mem_133180, int64_t nR_120163, int64_t b_120164, int64_t nS_120165, int64_t dz2081U_120166, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167, int32_t radix_sizze_120168, int32_t maxDepth_120173)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133182_cached_sizze_133629 = 0;
    unsigned char *mem_133182 = NULL;
    int64_t mem_133184_cached_sizze_133630 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133191_cached_sizze_133631 = 0;
    unsigned char *mem_133191 = NULL;
    int64_t mem_133201_cached_sizze_133632 = 0;
    unsigned char *mem_133201 = NULL;
    int64_t mem_133202_cached_sizze_133633 = 0;
    unsigned char *mem_133202 = NULL;
    int64_t mem_133215_cached_sizze_133634 = 0;
    unsigned char *mem_133215 = NULL;
    int64_t mem_133216_cached_sizze_133635 = 0;
    unsigned char *mem_133216 = NULL;
    int64_t mem_133229_cached_sizze_133636 = 0;
    unsigned char *mem_133229 = NULL;
    int64_t mem_133230_cached_sizze_133637 = 0;
    unsigned char *mem_133230 = NULL;
    int64_t mem_133243_cached_sizze_133638 = 0;
    unsigned char *mem_133243 = NULL;
    int64_t mem_133244_cached_sizze_133639 = 0;
    unsigned char *mem_133244 = NULL;
    int64_t mem_133248_cached_sizze_133640 = 0;
    unsigned char *mem_133248 = NULL;
    int64_t mem_133249_cached_sizze_133641 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133262_cached_sizze_133642 = 0;
    unsigned char *mem_133262 = NULL;
    int64_t mem_133263_cached_sizze_133643 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133264_cached_sizze_133644 = 0;
    unsigned char *mem_133264 = NULL;
    int64_t mem_133265_cached_sizze_133645 = 0;
    unsigned char *mem_133265 = NULL;
    int64_t mem_133278_cached_sizze_133646 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133279_cached_sizze_133647 = 0;
    unsigned char *mem_133279 = NULL;
    struct memblock ext_mem_133311;
    
    ext_mem_133311.references = NULL;
    
    struct memblock mem_133304;
    
    mem_133304.references = NULL;
    
    struct memblock mem_133302;
    
    mem_133302.references = NULL;
    
    struct memblock mem_133289;
    
    mem_133289.references = NULL;
    
    struct memblock mem_133287;
    
    mem_133287.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t i32_res_123532 = sext_i32_i64(radix_sizze_120168);
    bool nonnegative_123533 = sle64((int64_t) 0, i32_res_123532);
    bool nonzzero_cert_123534;
    
    if (!nonnegative_123533) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:8:47-318:53\n   #1  ftRelational.fut:313:1-320:73\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_123535 = shl64((int64_t) 1, i32_res_123532);
    bool assert_cond_123536 = arg_123535 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167;
    bool assert_c_123537;
    
    if (!assert_cond_123536) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftRelational.fut:318:4-320:37\n   #1  ftRelational.fut:313:1-320:73\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t getRadix_arg1_127855 = sub32(radix_sizze_120168, 1);
    int32_t i64_res_127856 = sext_i64_i32(b_120164);
    int32_t zm_lhs_127857 = mul32(8, i64_res_127856);
    int32_t min_arg1_127858 = sub32(zm_lhs_127857, 1);
    int32_t min_res_127859 = smin32(getRadix_arg1_127855, min_arg1_127858);
    int32_t i32_arg0_127863 = sub32(i64_res_127856, 1);
    int64_t i32_res_127864 = sext_i32_i64(i32_arg0_127863);
    int32_t zm_rhs_127866 = sdiv32(min_res_127859, 8);
    int32_t zm_lhs_127867 = sub32(i64_res_127856, zm_rhs_127866);
    int32_t i32_arg0_127868 = sub32(zm_lhs_127867, 1);
    int64_t i32_res_127869 = sext_i32_i64(i32_arg0_127868);
    int64_t zm_lhs_127870 = mul64((int64_t) 8, b_120164);
    int64_t min_arg1_127871 = sub64(zm_lhs_127870, (int64_t) 1);
    int64_t min_res_127872 = smin64(i32_res_127869, min_arg1_127871);
    int32_t lastBit_127874 = smod32(min_res_127859, 8);
    int32_t zm_lhs_127877 = sub32(8, lastBit_127874);
    int32_t i32_arg0_127878 = sub32(zm_lhs_127877, 1);
    int8_t unsign_arg0_127879 = zext_i32_i8(i32_arg0_127878);
    int8_t unsign_arg0_127880 = lshr8((int8_t) -1, unsign_arg0_127879);
    bool x_127889 = sle64((int64_t) 0, i32_res_127864);
    bool y_127890 = slt64(i32_res_127864, b_120164);
    bool bounds_check_127891 = x_127889 && y_127890;
    bool index_certs_127892;
    
    if (!bounds_check_127891) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:37:13-42\n   #2  ftRelational.fut:313:1-320:73\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_127900 = sle64((int64_t) 0, min_res_127872);
    bool y_127901 = slt64(min_res_127872, b_120164);
    bool bounds_check_127902 = x_127900 && y_127901;
    bool index_certs_127903;
    
    if (!bounds_check_127902) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_127872, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:37:13-42\n   #2  ftRelational.fut:313:1-320:73\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_lhs_127911 = add32(8, radix_sizze_120168);
    int32_t zs_lhs_127912 = sub32(zm_lhs_127911, 1);
    int32_t i32_arg0_127913 = sdiv32(zs_lhs_127912, 8);
    int64_t i32_res_127914 = sext_i32_i64(i32_arg0_127913);
    bool bounds_invalid_upwards_127915 = slt64(i32_res_127914, (int64_t) 0);
    bool valid_127916 = !bounds_invalid_upwards_127915;
    bool range_valid_c_127917;
    
    if (!valid_127916) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) i32_res_127914, " is invalid.", "-> #0  ftHashJoin.fut:41:15-30\n   #1  ftRelational.fut:313:1-320:73\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zeze_rhs_123782 = sub64(dz2081U_120166, (int64_t) 1);
    int64_t bytes_133181 = (int64_t) 8 * nR_120163;
    
    if (mem_133182_cached_sizze_133629 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133182, &mem_133182_cached_sizze_133629, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133184_cached_sizze_133630 < bytes_133181) {
        err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133630, bytes_133181);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133191_cached_sizze_133631 < b_120164) {
        err = lexical_realloc(ctx, &mem_133191, &mem_133191_cached_sizze_133631, b_120164);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133098;
    int64_t defunc_res_132916;
    int64_t scanacc_133091;
    int64_t redout_133093;
    
    scanacc_133091 = (int64_t) 0;
    redout_133093 = (int64_t) 0;
    for (int64_t i_133095 = 0; i_133095 < nR_120163; i_133095++) {
        for (int64_t i_133042 = 0; i_133042 < b_120164; i_133042++) {
            int8_t eta_p_129145 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133042];
            bool cond_129146 = sle64(i_133042, i32_res_127864);
            bool cond_t_res_129147 = sle64(min_res_127872, i_133042);
            bool x_129148 = cond_129146 && cond_t_res_129147;
            int8_t lifted_lambda_res_129149;
            
            if (x_129148) {
                lifted_lambda_res_129149 = eta_p_129145;
            } else {
                lifted_lambda_res_129149 = (int8_t) 0;
            }
            ((int8_t *) mem_133191)[i_133042] = lifted_lambda_res_129149;
        }
        
        int8_t za_lhs_129150 = ((int8_t *) mem_133191)[i32_res_127864];
        int8_t mod1_x_129151 = (int8_t) -1 & za_lhs_129150;
        
        ((int8_t *) mem_133191)[i32_res_127864] = mod1_x_129151;
        
        int8_t za_lhs_129153 = ((int8_t *) mem_133191)[min_res_127872];
        int8_t tmp_129154 = unsign_arg0_127880 & za_lhs_129153;
        
        ((int8_t *) mem_133191)[min_res_127872] = tmp_129154;
        
        int64_t radix_to_idx_res_129156;
        int64_t y_129158 = (int64_t) 0;
        
        for (int64_t i_129157 = 0; i_129157 < i32_res_127914; i_129157++) {
            int64_t zm_lhs_129159 = sub64(b_120164, i_129157);
            int64_t u8_arg0_129160 = sub64(zm_lhs_129159, (int64_t) 1);
            bool x_129161 = sle64((int64_t) 0, u8_arg0_129160);
            bool y_129162 = slt64(u8_arg0_129160, b_120164);
            bool bounds_check_129163 = x_129161 && y_129162;
            bool index_certs_129164;
            
            if (!bounds_check_129163) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_arg0_129160, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:42:23-33\n   #1  ftRelational.fut:313:1-320:73\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t u8_arg0_129165 = ((int8_t *) mem_133191)[u8_arg0_129160];
            int64_t u8_res_129166 = zext_i8_i64(u8_arg0_129165);
            int64_t zlzl_rhs_129167 = mul64((int64_t) 8, i_129157);
            int64_t r_129168 = shl64(u8_res_129166, zlzl_rhs_129167);
            int64_t loopres_129169 = y_129158 | r_129168;
            int64_t y_tmp_133522 = loopres_129169;
            
            y_129158 = y_tmp_133522;
        }
        radix_to_idx_res_129156 = y_129158;
        
        bool x_129170 = sle64((int64_t) 0, radix_to_idx_res_129156);
        bool y_129171 = slt64(radix_to_idx_res_129156, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167);
        bool bounds_check_129172 = x_129170 && y_129171;
        bool index_certs_129173;
        
        if (!bounds_check_129172) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_res_129156, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167, "].", "-> #0  ftHashJoin.fut:349:13-35\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t spi_129174 = ((int64_t *) first_info_idx_mem_133179.mem)[radix_to_idx_res_129156];
        bool cond_129175 = slt64(spi_129174, (int64_t) 0);
        int64_t rv_partitionMatchBounds_res_129176;
        
        if (cond_129175) {
            rv_partitionMatchBounds_res_129176 = (int64_t) -1;
        } else {
            bool x_129177 = sle64((int64_t) 0, spi_129174);
            bool y_129178 = slt64(spi_129174, dz2081U_120166);
            bool bounds_check_129179 = x_129177 && y_129178;
            bool index_certs_129180;
            
            if (!bounds_check_129179) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) spi_129174, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:352:8-21\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t zeze_lhs_129181 = ((int32_t *) depths_mem_133178.mem)[spi_129174];
            bool cond_129182 = zeze_lhs_129181 == 1;
            bool x_133434 = !cond_129182;
            int64_t end_spi_129184;
            
            if (x_133434) {
                int64_t x_133436 = ((int64_t *) last_info_idx_mem_133180.mem)[radix_to_idx_res_129156];
                
                end_spi_129184 = x_133436;
            } else {
                end_spi_129184 = (int64_t) 0;
            }
            
            int64_t zs_lhs_129185 = sub64(end_spi_129184, spi_129174);
            int64_t max_arg1_129186 = sdiv64(zs_lhs_129185, (int64_t) 2);
            int64_t max_res_129187 = smax64((int64_t) 1, max_arg1_129186);
            bool loop_cond_129188 = slt64((int64_t) 0, max_res_129187);
            int64_t rv_partitionMatchBounds_res_f_res_129183;
            
            if (cond_129182) {
                rv_partitionMatchBounds_res_f_res_129183 = spi_129174;
            } else {
                bool loop_not_taken_129201 = !loop_cond_129188;
                bool protect_assert_disj_129202 = bounds_check_127891 || loop_not_taken_129201;
                bool index_certs_129203;
                
                if (!protect_assert_disj_129202) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftRelational.fut:313:1-320:73\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map2_arg2_129192 = add64((int64_t) 1, i32_res_127864);
                
                if (mem_133201_cached_sizze_133632 < b_120164) {
                    err = lexical_realloc(ctx, &mem_133201, &mem_133201_cached_sizze_133632, b_120164);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_133202_cached_sizze_133633 < b_120164) {
                    err = lexical_realloc(ctx, &mem_133202, &mem_133202_cached_sizze_133633, b_120164);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                bool rv_partitionMatchBounds_res_f_res_f_res_129204;
                int64_t rv_partitionMatchBounds_res_f_res_f_res_129205;
                int64_t rv_partitionMatchBounds_res_f_res_f_res_129206;
                bool loop_while_129207;
                int64_t heshi_129208;
                int64_t step_129209;
                
                loop_while_129207 = loop_cond_129188;
                heshi_129208 = spi_129174;
                step_129209 = max_res_129187;
                while (loop_while_129207) {
                    bool x_129210 = sle64((int64_t) 0, heshi_129208);
                    bool y_129211 = slt64(heshi_129208, dz2081U_120166);
                    bool bounds_check_129212 = x_129210 && y_129211;
                    bool index_certs_129213;
                    
                    if (!bounds_check_129212) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_129208, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:358:25-40\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t cur_depth_129214 = ((int32_t *) depths_mem_133178.mem)[heshi_129208];
                    bool cond_129215 = heshi_129208 == spi_129174;
                    int64_t cur_S_129231 = ((int64_t *) bounds_mem_133177.mem)[heshi_129208];
                    bool x_129232 = sle64((int64_t) 0, cur_S_129231);
                    bool y_129233 = slt64(cur_S_129231, nS_120165);
                    bool bounds_check_129234 = x_129232 && y_129233;
                    bool index_certs_129235;
                    
                    if (!bounds_check_129234) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_129231, "] out of bounds for array of shape [", (long long) nS_120165, "].", "-> #0  ftHashJoin.fut:361:21-40\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_129238 = sub64(heshi_129208, (int64_t) 1);
                    bool x_129239 = sle64((int64_t) 0, tmp_129238);
                    bool y_129240 = slt64(tmp_129238, dz2081U_120166);
                    bool bounds_check_129241 = x_129239 && y_129240;
                    bool protect_assert_disj_133429 = cond_129215 || bounds_check_129241;
                    bool index_certs_129242;
                    
                    if (!protect_assert_disj_133429) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129238, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:362:55-72\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t zm_lhs_129261 = mul32(radix_sizze_120168, cur_depth_129214);
                    int32_t byteSeq_eq_arg1_129262 = sub32(zm_lhs_129261, 1);
                    int32_t zm_rhs_129304 = sdiv32(byteSeq_eq_arg1_129262, 8);
                    int32_t zm_lhs_129305 = sub32(i64_res_127856, zm_rhs_129304);
                    int32_t i32_arg0_129306 = sub32(zm_lhs_129305, 1);
                    int64_t i32_res_129307 = sext_i32_i64(i32_arg0_129306);
                    bool zzero_lte_i_129314 = sle64((int64_t) 0, i32_res_129307);
                    int64_t j_m_i_129308 = sub64(map2_arg2_129192, i32_res_129307);
                    int64_t m_129310 = sub64(j_m_i_129308, (int64_t) 1);
                    int64_t i_p_m_t_s_129311 = add64(i32_res_129307, m_129310);
                    bool i_p_m_t_s_leq_w_129313 = slt64(i_p_m_t_s_129311, b_120164);
                    bool y_129316 = i_p_m_t_s_leq_w_129313 && zzero_lte_i_129314;
                    bool zzero_leq_i_p_m_t_s_129312 = sle64((int64_t) 0, i_p_m_t_s_129311);
                    bool y_129317 = zzero_leq_i_p_m_t_s_129312 && y_129316;
                    bool i_lte_j_129315 = sle64(i32_res_129307, map2_arg2_129192);
                    bool forwards_ok_129318 = i_lte_j_129315 && y_129317;
                    bool empty_slice_129309 = j_m_i_129308 == (int64_t) 0;
                    bool ok_or_empty_129319 = empty_slice_129309 || forwards_ok_129318;
                    bool index_certs_129320;
                    
                    if (!ok_or_empty_129319) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_129307, ":", (long long) map2_arg2_129192, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:51:38-49\n   #1  ftHashJoin.fut:137:3-40\n   #2  ftHashJoin.fut:366:14-52\n   #3  ftHashJoin.fut:497:3-503:70\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftRelational.fut:317:4-320:54\n   #6  ftRelational.fut:313:1-320:73\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t min_res_129263 = smin32(min_arg1_127858, byteSeq_eq_arg1_129262);
                    int32_t zm_rhs_129264 = sdiv32(min_res_129263, 8);
                    int32_t zm_lhs_129265 = sub32(i64_res_127856, zm_rhs_129264);
                    int32_t i32_arg0_129266 = sub32(zm_lhs_129265, 1);
                    int64_t i32_res_129267 = sext_i32_i64(i32_arg0_129266);
                    int64_t min_res_129268 = smin64(min_arg1_127871, i32_res_129267);
                    bool y_129285 = slt64(min_res_129268, b_120164);
                    bool x_129284 = sle64((int64_t) 0, min_res_129268);
                    bool bounds_check_129286 = x_129284 && y_129285;
                    bool index_certs_129287;
                    
                    if (!bounds_check_129286) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_129268, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftRelational.fut:313:1-320:73\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t prev_depth_129216;
                    
                    if (cond_129215) {
                        prev_depth_129216 = cur_depth_129214;
                    } else {
                        bool index_certs_129221;
                        
                        if (!bounds_check_129241) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129238, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:359:60-77\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t prev_depth_f_res_129222 = ((int32_t *) depths_mem_133178.mem)[tmp_129238];
                        
                        prev_depth_129216 = prev_depth_f_res_129222;
                    }
                    
                    bool cond_129223 = heshi_129208 == end_spi_129184;
                    int32_t next_depth_129224;
                    
                    if (cond_129223) {
                        next_depth_129224 = cur_depth_129214;
                    } else {
                        int64_t tmp_129225 = add64((int64_t) 1, heshi_129208);
                        bool x_129226 = sle64((int64_t) 0, tmp_129225);
                        bool y_129227 = slt64(tmp_129225, dz2081U_120166);
                        bool bounds_check_129228 = x_129226 && y_129227;
                        bool index_certs_129229;
                        
                        if (!bounds_check_129228) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129225, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:360:64-81\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t next_depth_f_res_129230 = ((int32_t *) depths_mem_133178.mem)[tmp_129225];
                        
                        next_depth_129224 = next_depth_f_res_129230;
                    }
                    
                    bool x_133426 = !cond_129215;
                    int64_t tmp_129243;
                    
                    if (x_133426) {
                        int64_t x_133430 = ((int64_t *) bounds_mem_133177.mem)[tmp_129238];
                        
                        tmp_129243 = x_133430;
                    } else {
                        tmp_129243 = (int64_t) 0;
                    }
                    
                    int64_t lmad_ext_133198 = b_120164 * tmp_129243;
                    int64_t lmad_ext_133199 = b_120164 * cur_S_129231;
                    int64_t ext_133200;
                    
                    if (cond_129215) {
                        ext_133200 = lmad_ext_133199;
                    } else {
                        ext_133200 = lmad_ext_133198;
                    }
                    if (!cond_129215) {
                        bool x_129244 = sle64((int64_t) 0, tmp_129243);
                        bool y_129245 = slt64(tmp_129243, nS_120165);
                        bool bounds_check_129246 = x_129244 && y_129245;
                        bool index_certs_129247;
                        
                        if (!bounds_check_129246) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129243, "] out of bounds for array of shape [", (long long) nS_120165, "].", "-> #0  ftHashJoin.fut:362:52-73\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                    }
                    for (int64_t i_133048 = 0; i_133048 < b_120164; i_133048++) {
                        int8_t eta_p_129974 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133048];
                        int8_t eta_p_129975 = ((int8_t *) pS_mem_133176.mem)[cur_S_129231 * b_120164 + i_133048];
                        bool cond_129977 = sle64(i_133048, i32_res_127864);
                        bool cond_t_res_129978 = sle64(min_res_129268, i_133048);
                        bool x_129979 = cond_129977 && cond_t_res_129978;
                        int8_t lifted_lambda_res_129980;
                        
                        if (x_129979) {
                            lifted_lambda_res_129980 = eta_p_129974;
                        } else {
                            lifted_lambda_res_129980 = (int8_t) 0;
                        }
                        
                        int8_t lifted_lambda_res_129985;
                        
                        if (x_129979) {
                            lifted_lambda_res_129985 = eta_p_129975;
                        } else {
                            lifted_lambda_res_129985 = (int8_t) 0;
                        }
                        ((int8_t *) mem_133201)[i_133048] = lifted_lambda_res_129985;
                        ((int8_t *) mem_133202)[i_133048] = lifted_lambda_res_129980;
                    }
                    
                    int8_t za_lhs_129298 = ((int8_t *) mem_133201)[i32_res_127864];
                    int8_t mod1_x_129299 = (int8_t) -1 & za_lhs_129298;
                    
                    ((int8_t *) mem_133201)[i32_res_127864] = mod1_x_129299;
                    
                    int8_t za_lhs_129301 = ((int8_t *) mem_133201)[min_res_129268];
                    int32_t lastBit_129269 = smod32(min_res_129263, 8);
                    int32_t zm_lhs_129270 = sub32(8, lastBit_129269);
                    int32_t i32_arg0_129271 = sub32(zm_lhs_129270, 1);
                    int8_t unsign_arg0_129272 = zext_i32_i8(i32_arg0_129271);
                    int8_t unsign_arg0_129273 = lshr8((int8_t) -1, unsign_arg0_129272);
                    int8_t tmp_129302 = unsign_arg0_129273 & za_lhs_129301;
                    
                    ((int8_t *) mem_133201)[min_res_129268] = tmp_129302;
                    
                    int8_t za_lhs_129281 = ((int8_t *) mem_133202)[i32_res_127864];
                    int8_t mod1_x_129282 = (int8_t) -1 & za_lhs_129281;
                    
                    ((int8_t *) mem_133202)[i32_res_127864] = mod1_x_129282;
                    
                    int8_t za_lhs_129288 = ((int8_t *) mem_133202)[min_res_129268];
                    int8_t tmp_129289 = unsign_arg0_129273 & za_lhs_129288;
                    
                    ((int8_t *) mem_133202)[min_res_129268] = tmp_129289;
                    
                    bool defunc_0_reduce_res_132901;
                    bool redout_133051 = 1;
                    
                    for (int64_t i_133052 = 0; i_133052 < j_m_i_129308; i_133052++) {
                        int64_t slice_133161 = i32_res_129307 + i_133052;
                        int8_t eta_p_129968 = ((int8_t *) mem_133202)[slice_133161];
                        int8_t eta_p_129969 = ((int8_t *) mem_133201)[slice_133161];
                        bool defunc_0_f_res_129970 = eta_p_129968 == eta_p_129969;
                        bool x_129331 = defunc_0_f_res_129970 && redout_133051;
                        bool redout_tmp_133528 = x_129331;
                        
                        redout_133051 = redout_tmp_133528;
                    }
                    defunc_0_reduce_res_132901 = redout_133051;
                    
                    bool cond_129332;
                    
                    if (defunc_0_reduce_res_132901) {
                        int32_t zm_lhs_132656 = mul32(radix_sizze_120168, prev_depth_129216);
                        int32_t byteSeq_neq_arg1_132657 = sub32(zm_lhs_132656, 1);
                        int32_t zm_rhs_132658 = sdiv32(byteSeq_neq_arg1_132657, 8);
                        int32_t zm_lhs_132659 = sub32(i64_res_127856, zm_rhs_132658);
                        int32_t i32_arg0_132660 = sub32(zm_lhs_132659, 1);
                        int64_t i32_res_132661 = sext_i32_i64(i32_arg0_132660);
                        int64_t j_m_i_132662 = sub64(map2_arg2_129192, i32_res_132661);
                        bool cond_t_res_132663;
                        
                        if (cond_129215) {
                            cond_t_res_132663 = 1;
                        } else {
                            int32_t min_res_132664 = smin32(min_arg1_127858, byteSeq_neq_arg1_132657);
                            int32_t zm_rhs_132665 = sdiv32(min_res_132664, 8);
                            int32_t zm_lhs_132666 = sub32(i64_res_127856, zm_rhs_132665);
                            int32_t i32_arg0_132667 = sub32(zm_lhs_132666, 1);
                            int64_t i32_res_132668 = sext_i32_i64(i32_arg0_132667);
                            int64_t min_res_132669 = smin64(min_arg1_127871, i32_res_132668);
                            bool index_certs_132690;
                            
                            if (!bounds_check_127891) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftRelational.fut:313:1-320:73\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool x_132694 = sle64((int64_t) 0, min_res_132669);
                            bool y_132695 = slt64(min_res_132669, b_120164);
                            bool bounds_check_132696 = x_132694 && y_132695;
                            bool index_certs_132697;
                            
                            if (!bounds_check_132696) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_132669, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftRelational.fut:313:1-320:73\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool empty_slice_132707 = j_m_i_132662 == (int64_t) 0;
                            int64_t m_132708 = sub64(j_m_i_132662, (int64_t) 1);
                            int64_t i_p_m_t_s_132709 = add64(i32_res_132661, m_132708);
                            bool zzero_leq_i_p_m_t_s_132710 = sle64((int64_t) 0, i_p_m_t_s_132709);
                            bool i_p_m_t_s_leq_w_132711 = slt64(i_p_m_t_s_132709, b_120164);
                            bool zzero_lte_i_132712 = sle64((int64_t) 0, i32_res_132661);
                            bool i_lte_j_132713 = sle64(i32_res_132661, map2_arg2_129192);
                            bool y_132714 = i_p_m_t_s_leq_w_132711 && zzero_lte_i_132712;
                            bool y_132715 = zzero_leq_i_p_m_t_s_132710 && y_132714;
                            bool forwards_ok_132716 = i_lte_j_132713 && y_132715;
                            bool ok_or_empty_132717 = empty_slice_132707 || forwards_ok_132716;
                            bool index_certs_132718;
                            
                            if (!ok_or_empty_132717) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_132661, ":", (long long) map2_arg2_129192, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:59:38-49\n   #1  ftHashJoin.fut:141:3-41\n   #2  ftHashJoin.fut:368:30-71\n   #3  ftHashJoin.fut:497:3-503:70\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftRelational.fut:317:4-320:54\n   #6  ftRelational.fut:313:1-320:73\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t lastBit_132670 = smod32(min_res_132664, 8);
                            int32_t zm_lhs_132671 = sub32(8, lastBit_132670);
                            int32_t i32_arg0_132672 = sub32(zm_lhs_132671, 1);
                            int8_t unsign_arg0_132673 = zext_i32_i8(i32_arg0_132672);
                            int8_t unsign_arg0_132674 = lshr8((int8_t) -1, unsign_arg0_132673);
                            
                            if (mem_133215_cached_sizze_133634 < b_120164) {
                                err = lexical_realloc(ctx, &mem_133215, &mem_133215_cached_sizze_133634, b_120164);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133216_cached_sizze_133635 < b_120164) {
                                err = lexical_realloc(ctx, &mem_133216, &mem_133216_cached_sizze_133635, b_120164);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_133057 = 0; i_133057 < b_120164; i_133057++) {
                                int8_t eta_p_132678 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133057];
                                int8_t eta_p_132679 = ((int8_t *) pS_mem_133176.mem)[ext_133200 + i_133057];
                                bool cond_132680 = sle64(i_133057, i32_res_127864);
                                bool cond_t_res_132681 = sle64(min_res_132669, i_133057);
                                bool x_132682 = cond_132680 && cond_t_res_132681;
                                int8_t lifted_lambda_res_132683;
                                
                                if (x_132682) {
                                    lifted_lambda_res_132683 = eta_p_132678;
                                } else {
                                    lifted_lambda_res_132683 = (int8_t) 0;
                                }
                                
                                int8_t lifted_lambda_res_132687;
                                
                                if (x_132682) {
                                    lifted_lambda_res_132687 = eta_p_132679;
                                } else {
                                    lifted_lambda_res_132687 = (int8_t) 0;
                                }
                                ((int8_t *) mem_133215)[i_133057] = lifted_lambda_res_132687;
                                ((int8_t *) mem_133216)[i_133057] = lifted_lambda_res_132683;
                            }
                            
                            int8_t za_lhs_132691 = ((int8_t *) mem_133216)[i32_res_127864];
                            int8_t mod1_x_132692 = (int8_t) -1 & za_lhs_132691;
                            
                            ((int8_t *) mem_133216)[i32_res_127864] = mod1_x_132692;
                            
                            int8_t za_lhs_132698 = ((int8_t *) mem_133216)[min_res_132669];
                            int8_t tmp_132699 = unsign_arg0_132674 & za_lhs_132698;
                            
                            ((int8_t *) mem_133216)[min_res_132669] = tmp_132699;
                            
                            int8_t za_lhs_132701 = ((int8_t *) mem_133215)[i32_res_127864];
                            int8_t mod1_x_132702 = (int8_t) -1 & za_lhs_132701;
                            
                            ((int8_t *) mem_133215)[i32_res_127864] = mod1_x_132702;
                            
                            int8_t za_lhs_132704 = ((int8_t *) mem_133215)[min_res_132669];
                            int8_t tmp_132705 = unsign_arg0_132674 & za_lhs_132704;
                            
                            ((int8_t *) mem_133215)[min_res_132669] = tmp_132705;
                            
                            bool defunc_0_reduce_res_132721;
                            bool redout_133060 = 0;
                            
                            for (int64_t i_133061 = 0; i_133061 < j_m_i_132662; i_133061++) {
                                int64_t slice_133157 = i32_res_132661 + i_133061;
                                int8_t eta_p_132722 = ((int8_t *) mem_133216)[slice_133157];
                                int8_t eta_p_132723 = ((int8_t *) mem_133215)[slice_133157];
                                bool defunc_0_f_res_132724 = eta_p_132722 == eta_p_132723;
                                bool defunc_0_f_res_132725 = !defunc_0_f_res_132724;
                                bool defunc_0_op_res_132728 = defunc_0_f_res_132725 || redout_133060;
                                bool redout_tmp_133531 = defunc_0_op_res_132728;
                                
                                redout_133060 = redout_tmp_133531;
                            }
                            defunc_0_reduce_res_132721 = redout_133060;
                            cond_t_res_132663 = defunc_0_reduce_res_132721;
                        }
                        cond_129332 = cond_t_res_132663;
                    } else {
                        cond_129332 = 0;
                    }
                    
                    int64_t loopres_129407;
                    int64_t loopres_129408;
                    
                    if (cond_129332) {
                        loopres_129407 = heshi_129208;
                        loopres_129408 = (int64_t) 0;
                    } else {
                        bool defunc_0_reduce_res_132898;
                        bool redout_133062 = 1;
                        
                        for (int64_t i_133063 = 0; i_133063 < j_m_i_129308; i_133063++) {
                            int64_t slice_133155 = i32_res_129307 + i_133063;
                            int8_t eta_p_129999 = ((int8_t *) mem_133202)[slice_133155];
                            int8_t eta_p_130000 = ((int8_t *) mem_133201)[slice_133155];
                            bool defunc_0_f_res_130001 = eta_p_129999 == eta_p_130000;
                            bool x_129417 = defunc_0_f_res_130001 && redout_133062;
                            bool redout_tmp_133532 = x_129417;
                            
                            redout_133062 = redout_tmp_133532;
                        }
                        defunc_0_reduce_res_132898 = redout_133062;
                        
                        bool loop_cond_t_res_129423 = slt32(0, cur_depth_129214);
                        int64_t loopres_f_res_129418;
                        int64_t loopres_f_res_129419;
                        
                        if (defunc_0_reduce_res_132898) {
                            int64_t tmp_132730 = sub64(heshi_129208, step_129209);
                            int64_t max_arg1_132731 = sdiv64(step_129209, (int64_t) 2);
                            int64_t max_res_132732 = smax64((int64_t) 1, max_arg1_132731);
                            
                            loopres_f_res_129418 = tmp_132730;
                            loopres_f_res_129419 = max_res_132732;
                        } else {
                            if (mem_133229_cached_sizze_133636 < b_120164) {
                                err = lexical_realloc(ctx, &mem_133229, &mem_133229_cached_sizze_133636, b_120164);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133230_cached_sizze_133637 < b_120164) {
                                err = lexical_realloc(ctx, &mem_133230, &mem_133230_cached_sizze_133637, b_120164);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133243_cached_sizze_133638 < b_120164) {
                                err = lexical_realloc(ctx, &mem_133243, &mem_133243_cached_sizze_133638, b_120164);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_133244_cached_sizze_133639 < b_120164) {
                                err = lexical_realloc(ctx, &mem_133244, &mem_133244_cached_sizze_133639, b_120164);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            
                            bool radix_lt_res_129424;
                            int32_t radix_lt_res_129425;
                            bool radix_lt_res_129426;
                            bool loop_while_129427;
                            int32_t p_129428;
                            bool p_129429;
                            
                            loop_while_129427 = loop_cond_t_res_129423;
                            p_129428 = 0;
                            p_129429 = 0;
                            while (loop_while_129427) {
                                int32_t zt_rhs_129430 = add32(1, p_129428);
                                int32_t zm_lhs_129431 = mul32(radix_sizze_120168, zt_rhs_129430);
                                int32_t byteSeq_lt_arg1_129432 = sub32(zm_lhs_129431, 1);
                                int32_t byteSeq_lt_arg0_129433 = mul32(radix_sizze_120168, p_129428);
                                int32_t min_res_129434 = smin32(min_arg1_127858, byteSeq_lt_arg1_129432);
                                int32_t zm_rhs_129435 = sdiv32(byteSeq_lt_arg0_129433, 8);
                                int32_t zm_lhs_129436 = sub32(i64_res_127856, zm_rhs_129435);
                                int32_t i32_arg0_129437 = sub32(zm_lhs_129436, 1);
                                int64_t i32_res_129438 = sext_i32_i64(i32_arg0_129437);
                                int32_t zm_rhs_129439 = sdiv32(min_res_129434, 8);
                                int32_t zm_lhs_129440 = sub32(i64_res_127856, zm_rhs_129439);
                                int32_t i32_arg0_129441 = sub32(zm_lhs_129440, 1);
                                int64_t i32_res_129442 = sext_i32_i64(i32_arg0_129441);
                                int64_t min_res_129443 = smin64(min_arg1_127871, i32_res_129442);
                                bool x_129459 = sle64((int64_t) 0, i32_res_129438);
                                bool y_129460 = slt64(i32_res_129438, b_120164);
                                bool bounds_check_129461 = x_129459 && y_129460;
                                bool index_certs_129462;
                                
                                if (!bounds_check_129461) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_129438, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:313:1-320:73\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_129466 = sle64((int64_t) 0, min_res_129443);
                                bool y_129467 = slt64(min_res_129443, b_120164);
                                bool bounds_check_129468 = x_129466 && y_129467;
                                bool index_certs_129469;
                                
                                if (!bounds_check_129468) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_129443, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:313:1-320:73\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t firstBit_129444 = smod32(byteSeq_lt_arg0_129433, 8);
                                int32_t lastBit_129445 = smod32(min_res_129434, 8);
                                int8_t unsign_arg0_129446 = zext_i32_i8(firstBit_129444);
                                int8_t first_bitMask_129447 = shl8((int8_t) -1, unsign_arg0_129446);
                                int32_t zm_lhs_129448 = sub32(8, lastBit_129445);
                                int32_t i32_arg0_129449 = sub32(zm_lhs_129448, 1);
                                int8_t unsign_arg0_129450 = zext_i32_i8(i32_arg0_129449);
                                int8_t unsign_arg0_129451 = lshr8((int8_t) -1, unsign_arg0_129450);
                                
                                for (int64_t i_133068 = 0; i_133068 < b_120164; i_133068++) {
                                    int8_t eta_p_130430 = ((int8_t *) pS_mem_133176.mem)[cur_S_129231 * b_120164 + i_133068];
                                    int8_t eta_p_130431 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133068];
                                    bool cond_130437 = sle64(i_133068, i32_res_129438);
                                    bool cond_t_res_130438 = sle64(min_res_129443, i_133068);
                                    bool x_130439 = cond_130437 && cond_t_res_130438;
                                    int8_t lifted_lambda_res_130440;
                                    
                                    if (x_130439) {
                                        lifted_lambda_res_130440 = eta_p_130431;
                                    } else {
                                        lifted_lambda_res_130440 = (int8_t) 0;
                                    }
                                    
                                    int8_t lifted_lambda_res_130445;
                                    
                                    if (x_130439) {
                                        lifted_lambda_res_130445 = eta_p_130430;
                                    } else {
                                        lifted_lambda_res_130445 = (int8_t) 0;
                                    }
                                    ((int8_t *) mem_133229)[i_133068] = lifted_lambda_res_130445;
                                    ((int8_t *) mem_133230)[i_133068] = lifted_lambda_res_130440;
                                }
                                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133243, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133230, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
                                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133244, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
                                
                                int8_t za_lhs_129463 = ((int8_t *) mem_133243)[i32_res_129438];
                                int8_t mod1_x_129464 = first_bitMask_129447 & za_lhs_129463;
                                
                                ((int8_t *) mem_133243)[i32_res_129438] = mod1_x_129464;
                                
                                int8_t za_lhs_129470 = ((int8_t *) mem_133243)[min_res_129443];
                                int8_t tmp_129471 = unsign_arg0_129451 & za_lhs_129470;
                                
                                ((int8_t *) mem_133243)[min_res_129443] = tmp_129471;
                                
                                int8_t za_lhs_129480 = ((int8_t *) mem_133244)[i32_res_129438];
                                int8_t mod1_x_129481 = first_bitMask_129447 & za_lhs_129480;
                                
                                ((int8_t *) mem_133244)[i32_res_129438] = mod1_x_129481;
                                
                                int8_t za_lhs_129483 = ((int8_t *) mem_133244)[min_res_129443];
                                int8_t tmp_129484 = unsign_arg0_129451 & za_lhs_129483;
                                
                                ((int8_t *) mem_133244)[min_res_129443] = tmp_129484;
                                
                                int32_t zm_rhs_129486 = sdiv32(byteSeq_lt_arg1_129432, 8);
                                int32_t zm_lhs_129487 = sub32(i64_res_127856, zm_rhs_129486);
                                int32_t i32_arg0_129488 = sub32(zm_lhs_129487, 1);
                                int64_t i32_res_129489 = sext_i32_i64(i32_arg0_129488);
                                bool loop_cond_t_res_129490 = slt64(i32_res_129489, i32_res_129438);
                                bool byteSeq_lt_res_129491;
                                int64_t byteSeq_lt_res_129492;
                                bool byteSeq_lt_res_129493;
                                bool loop_while_129494;
                                int64_t p_129495;
                                bool p_129496;
                                
                                loop_while_129494 = loop_cond_t_res_129490;
                                p_129495 = i32_res_129489;
                                p_129496 = 0;
                                while (loop_while_129494) {
                                    bool x_129497 = sle64((int64_t) 0, p_129495);
                                    bool y_129498 = slt64(p_129495, b_120164);
                                    bool bounds_check_129499 = x_129497 && y_129498;
                                    bool index_certs_129500;
                                    
                                    if (!bounds_check_129499) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129495, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:89:17-27\n   #1  ftRelational.fut:313:1-320:73\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int8_t zl_lhs_129501 = ((int8_t *) mem_133243)[p_129495];
                                    int8_t zl_rhs_129502 = ((int8_t *) mem_133244)[p_129495];
                                    bool dlt_129503 = ult8(zl_lhs_129501, zl_rhs_129502);
                                    bool dgt_129504 = ult8(zl_rhs_129502, zl_lhs_129501);
                                    bool tmp_129505 = dlt_129503 || dgt_129504;
                                    bool cond_129506 = !tmp_129505;
                                    int64_t tmp_129507;
                                    
                                    if (cond_129506) {
                                        int64_t tmp_t_res_132733 = add64((int64_t) 1, p_129495);
                                        
                                        tmp_129507 = tmp_t_res_132733;
                                    } else {
                                        tmp_129507 = i32_res_129438;
                                    }
                                    
                                    bool cond_129509 = !dlt_129503;
                                    bool loop_cond_t_res_129510 = slt64(tmp_129507, i32_res_129438);
                                    bool x_129511 = cond_129509 && loop_cond_t_res_129510;
                                    bool loop_while_tmp_133538 = x_129511;
                                    int64_t p_tmp_133539 = tmp_129507;
                                    bool p_tmp_133540 = dlt_129503;
                                    
                                    loop_while_129494 = loop_while_tmp_133538;
                                    p_129495 = p_tmp_133539;
                                    p_129496 = p_tmp_133540;
                                }
                                byteSeq_lt_res_129491 = loop_while_129494;
                                byteSeq_lt_res_129492 = p_129495;
                                byteSeq_lt_res_129493 = p_129496;
                                
                                int8_t za_lhs_129519 = ((int8_t *) mem_133230)[i32_res_129438];
                                int8_t mod1_x_129520 = first_bitMask_129447 & za_lhs_129519;
                                
                                ((int8_t *) mem_133230)[i32_res_129438] = mod1_x_129520;
                                
                                int8_t za_lhs_129522 = ((int8_t *) mem_133230)[min_res_129443];
                                int8_t tmp_129523 = unsign_arg0_129451 & za_lhs_129522;
                                
                                ((int8_t *) mem_133230)[min_res_129443] = tmp_129523;
                                
                                int8_t za_lhs_129532 = ((int8_t *) mem_133229)[i32_res_129438];
                                int8_t mod1_x_129533 = first_bitMask_129447 & za_lhs_129532;
                                
                                ((int8_t *) mem_133229)[i32_res_129438] = mod1_x_129533;
                                
                                int8_t za_lhs_129535 = ((int8_t *) mem_133229)[min_res_129443];
                                int8_t tmp_129536 = unsign_arg0_129451 & za_lhs_129535;
                                
                                ((int8_t *) mem_133229)[min_res_129443] = tmp_129536;
                                
                                bool byteSeq_gt_res_129538;
                                int64_t byteSeq_gt_res_129539;
                                bool byteSeq_gt_res_129540;
                                bool loop_while_129541;
                                int64_t p_129542;
                                bool p_129543;
                                
                                loop_while_129541 = loop_cond_t_res_129490;
                                p_129542 = i32_res_129489;
                                p_129543 = 0;
                                while (loop_while_129541) {
                                    bool x_129544 = sle64((int64_t) 0, p_129542);
                                    bool y_129545 = slt64(p_129542, b_120164);
                                    bool bounds_check_129546 = x_129544 && y_129545;
                                    bool index_certs_129547;
                                    
                                    if (!bounds_check_129546) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129542, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:126:17-27\n   #1  ftRelational.fut:313:1-320:73\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int8_t zl_lhs_129548 = ((int8_t *) mem_133230)[p_129542];
                                    int8_t zl_rhs_129549 = ((int8_t *) mem_133229)[p_129542];
                                    bool dlt_129550 = ult8(zl_lhs_129548, zl_rhs_129549);
                                    bool dgt_129551 = ult8(zl_rhs_129549, zl_lhs_129548);
                                    bool tmp_129552 = dlt_129550 || dgt_129551;
                                    bool cond_129553 = !tmp_129552;
                                    int64_t tmp_129554;
                                    
                                    if (cond_129553) {
                                        int64_t tmp_t_res_132734 = add64((int64_t) 1, p_129542);
                                        
                                        tmp_129554 = tmp_t_res_132734;
                                    } else {
                                        tmp_129554 = i32_res_129438;
                                    }
                                    
                                    bool cond_129556 = !dgt_129551;
                                    bool loop_cond_t_res_129557 = slt64(tmp_129554, i32_res_129438);
                                    bool x_129558 = cond_129556 && loop_cond_t_res_129557;
                                    bool loop_while_tmp_133541 = x_129558;
                                    int64_t p_tmp_133542 = tmp_129554;
                                    bool p_tmp_133543 = dgt_129551;
                                    
                                    loop_while_129541 = loop_while_tmp_133541;
                                    p_129542 = p_tmp_133542;
                                    p_129543 = p_tmp_133543;
                                }
                                byteSeq_gt_res_129538 = loop_while_129541;
                                byteSeq_gt_res_129539 = p_129542;
                                byteSeq_gt_res_129540 = p_129543;
                                
                                bool tmp_129559 = byteSeq_lt_res_129493 || byteSeq_gt_res_129540;
                                bool cond_129560 = !tmp_129559;
                                int32_t tmp_129561;
                                
                                if (cond_129560) {
                                    tmp_129561 = zt_rhs_129430;
                                } else {
                                    tmp_129561 = cur_depth_129214;
                                }
                                
                                bool cond_129562 = !byteSeq_lt_res_129493;
                                bool loop_cond_t_res_129563 = slt32(tmp_129561, cur_depth_129214);
                                bool x_129564 = cond_129562 && loop_cond_t_res_129563;
                                bool loop_while_tmp_133533 = x_129564;
                                int32_t p_tmp_133534 = tmp_129561;
                                bool p_tmp_133535 = byteSeq_lt_res_129493;
                                
                                loop_while_129427 = loop_while_tmp_133533;
                                p_129428 = p_tmp_133534;
                                p_129429 = p_tmp_133535;
                            }
                            radix_lt_res_129424 = loop_while_129427;
                            radix_lt_res_129425 = p_129428;
                            radix_lt_res_129426 = p_129429;
                            
                            int64_t loopres_f_res_f_res_129565;
                            int64_t loopres_f_res_f_res_129566;
                            
                            if (radix_lt_res_129426) {
                                bool loop_cond_t_res_132746 = slt32(0, prev_depth_129216);
                                bool cond_132745;
                                
                                if (cond_129215) {
                                    cond_132745 = 1;
                                } else {
                                    if (mem_133264_cached_sizze_133644 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133264, &mem_133264_cached_sizze_133644, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133265_cached_sizze_133645 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133265, &mem_133265_cached_sizze_133645, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133278_cached_sizze_133646 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133646, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133279_cached_sizze_133647 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133279, &mem_133279_cached_sizze_133647, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    
                                    bool radix_gt_res_132747;
                                    int32_t radix_gt_res_132748;
                                    bool radix_gt_res_132749;
                                    bool loop_while_132750;
                                    int32_t p_132751;
                                    bool p_132752;
                                    
                                    loop_while_132750 = loop_cond_t_res_132746;
                                    p_132751 = 0;
                                    p_132752 = 0;
                                    while (loop_while_132750) {
                                        int32_t zt_rhs_132753 = add32(1, p_132751);
                                        int32_t zm_lhs_132754 = mul32(radix_sizze_120168, zt_rhs_132753);
                                        int32_t byteSeq_lt_arg1_132755 = sub32(zm_lhs_132754, 1);
                                        int32_t byteSeq_lt_arg0_132756 = mul32(radix_sizze_120168, p_132751);
                                        int32_t min_res_132757 = smin32(min_arg1_127858, byteSeq_lt_arg1_132755);
                                        int32_t zm_rhs_132758 = sdiv32(byteSeq_lt_arg0_132756, 8);
                                        int32_t zm_lhs_132759 = sub32(i64_res_127856, zm_rhs_132758);
                                        int32_t i32_arg0_132760 = sub32(zm_lhs_132759, 1);
                                        int64_t i32_res_132761 = sext_i32_i64(i32_arg0_132760);
                                        int32_t zm_rhs_132762 = sdiv32(min_res_132757, 8);
                                        int32_t zm_lhs_132763 = sub32(i64_res_127856, zm_rhs_132762);
                                        int32_t i32_arg0_132764 = sub32(zm_lhs_132763, 1);
                                        int64_t i32_res_132765 = sext_i32_i64(i32_arg0_132764);
                                        int64_t min_res_132766 = smin64(min_arg1_127871, i32_res_132765);
                                        bool x_132802 = sle64((int64_t) 0, i32_res_132761);
                                        bool y_132803 = slt64(i32_res_132761, b_120164);
                                        bool bounds_check_132804 = x_132802 && y_132803;
                                        bool index_certs_132805;
                                        
                                        if (!bounds_check_132804) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_132761, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:313:1-320:73\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_132809 = sle64((int64_t) 0, min_res_132766);
                                        bool y_132810 = slt64(min_res_132766, b_120164);
                                        bool bounds_check_132811 = x_132809 && y_132810;
                                        bool index_certs_132812;
                                        
                                        if (!bounds_check_132811) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_132766, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:313:1-320:73\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t firstBit_132767 = smod32(byteSeq_lt_arg0_132756, 8);
                                        int32_t lastBit_132768 = smod32(min_res_132757, 8);
                                        int8_t unsign_arg0_132769 = zext_i32_i8(firstBit_132767);
                                        int8_t first_bitMask_132770 = shl8((int8_t) -1, unsign_arg0_132769);
                                        int32_t zm_lhs_132771 = sub32(8, lastBit_132768);
                                        int32_t i32_arg0_132772 = sub32(zm_lhs_132771, 1);
                                        int8_t unsign_arg0_132773 = zext_i32_i8(i32_arg0_132772);
                                        int8_t unsign_arg0_132774 = lshr8((int8_t) -1, unsign_arg0_132773);
                                        
                                        for (int64_t i_133075 = 0; i_133075 < b_120164; i_133075++) {
                                            int8_t eta_p_132780 = ((int8_t *) pS_mem_133176.mem)[ext_133200 + i_133075];
                                            int8_t eta_p_132781 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133075];
                                            bool cond_132782 = sle64(i_133075, i32_res_132761);
                                            bool cond_t_res_132783 = sle64(min_res_132766, i_133075);
                                            bool x_132784 = cond_132782 && cond_t_res_132783;
                                            int8_t lifted_lambda_res_132785;
                                            
                                            if (x_132784) {
                                                lifted_lambda_res_132785 = eta_p_132781;
                                            } else {
                                                lifted_lambda_res_132785 = (int8_t) 0;
                                            }
                                            
                                            int8_t lifted_lambda_res_132789;
                                            
                                            if (x_132784) {
                                                lifted_lambda_res_132789 = eta_p_132780;
                                            } else {
                                                lifted_lambda_res_132789 = (int8_t) 0;
                                            }
                                            ((int8_t *) mem_133264)[i_133075] = lifted_lambda_res_132789;
                                            ((int8_t *) mem_133265)[i_133075] = lifted_lambda_res_132785;
                                        }
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133278, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133265, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133279, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133264, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
                                        
                                        int8_t za_lhs_132806 = ((int8_t *) mem_133278)[i32_res_132761];
                                        int8_t mod1_x_132807 = first_bitMask_132770 & za_lhs_132806;
                                        
                                        ((int8_t *) mem_133278)[i32_res_132761] = mod1_x_132807;
                                        
                                        int8_t za_lhs_132813 = ((int8_t *) mem_133278)[min_res_132766];
                                        int8_t tmp_132814 = unsign_arg0_132774 & za_lhs_132813;
                                        
                                        ((int8_t *) mem_133278)[min_res_132766] = tmp_132814;
                                        
                                        int8_t za_lhs_132816 = ((int8_t *) mem_133279)[i32_res_132761];
                                        int8_t mod1_x_132817 = first_bitMask_132770 & za_lhs_132816;
                                        
                                        ((int8_t *) mem_133279)[i32_res_132761] = mod1_x_132817;
                                        
                                        int8_t za_lhs_132819 = ((int8_t *) mem_133279)[min_res_132766];
                                        int8_t tmp_132820 = unsign_arg0_132774 & za_lhs_132819;
                                        
                                        ((int8_t *) mem_133279)[min_res_132766] = tmp_132820;
                                        
                                        int32_t zm_rhs_132822 = sdiv32(byteSeq_lt_arg1_132755, 8);
                                        int32_t zm_lhs_132823 = sub32(i64_res_127856, zm_rhs_132822);
                                        int32_t i32_arg0_132824 = sub32(zm_lhs_132823, 1);
                                        int64_t i32_res_132825 = sext_i32_i64(i32_arg0_132824);
                                        bool loop_cond_t_res_132826 = slt64(i32_res_132825, i32_res_132761);
                                        bool byteSeq_lt_res_132827;
                                        int64_t byteSeq_lt_res_132828;
                                        bool byteSeq_lt_res_132829;
                                        bool loop_while_132830;
                                        int64_t p_132831;
                                        bool p_132832;
                                        
                                        loop_while_132830 = loop_cond_t_res_132826;
                                        p_132831 = i32_res_132825;
                                        p_132832 = 0;
                                        while (loop_while_132830) {
                                            bool x_132833 = sle64((int64_t) 0, p_132831);
                                            bool y_132834 = slt64(p_132831, b_120164);
                                            bool bounds_check_132835 = x_132833 && y_132834;
                                            bool index_certs_132836;
                                            
                                            if (!bounds_check_132835) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_132831, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:89:17-27\n   #1  ftRelational.fut:313:1-320:73\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_132837 = ((int8_t *) mem_133278)[p_132831];
                                            int8_t zl_rhs_132838 = ((int8_t *) mem_133279)[p_132831];
                                            bool dlt_132839 = ult8(zl_lhs_132837, zl_rhs_132838);
                                            bool dgt_132840 = ult8(zl_rhs_132838, zl_lhs_132837);
                                            bool tmp_132841 = dlt_132839 || dgt_132840;
                                            bool cond_132842 = !tmp_132841;
                                            int64_t tmp_132843;
                                            
                                            if (cond_132842) {
                                                int64_t tmp_t_res_132844 = add64((int64_t) 1, p_132831);
                                                
                                                tmp_132843 = tmp_t_res_132844;
                                            } else {
                                                tmp_132843 = i32_res_132761;
                                            }
                                            
                                            bool cond_132845 = !dlt_132839;
                                            bool loop_cond_t_res_132846 = slt64(tmp_132843, i32_res_132761);
                                            bool x_132847 = cond_132845 && loop_cond_t_res_132846;
                                            bool loop_while_tmp_133549 = x_132847;
                                            int64_t p_tmp_133550 = tmp_132843;
                                            bool p_tmp_133551 = dlt_132839;
                                            
                                            loop_while_132830 = loop_while_tmp_133549;
                                            p_132831 = p_tmp_133550;
                                            p_132832 = p_tmp_133551;
                                        }
                                        byteSeq_lt_res_132827 = loop_while_132830;
                                        byteSeq_lt_res_132828 = p_132831;
                                        byteSeq_lt_res_132829 = p_132832;
                                        
                                        int8_t za_lhs_132848 = ((int8_t *) mem_133265)[i32_res_132761];
                                        int8_t mod1_x_132849 = first_bitMask_132770 & za_lhs_132848;
                                        
                                        ((int8_t *) mem_133265)[i32_res_132761] = mod1_x_132849;
                                        
                                        int8_t za_lhs_132851 = ((int8_t *) mem_133265)[min_res_132766];
                                        int8_t tmp_132852 = unsign_arg0_132774 & za_lhs_132851;
                                        
                                        ((int8_t *) mem_133265)[min_res_132766] = tmp_132852;
                                        
                                        int8_t za_lhs_132854 = ((int8_t *) mem_133264)[i32_res_132761];
                                        int8_t mod1_x_132855 = first_bitMask_132770 & za_lhs_132854;
                                        
                                        ((int8_t *) mem_133264)[i32_res_132761] = mod1_x_132855;
                                        
                                        int8_t za_lhs_132857 = ((int8_t *) mem_133264)[min_res_132766];
                                        int8_t tmp_132858 = unsign_arg0_132774 & za_lhs_132857;
                                        
                                        ((int8_t *) mem_133264)[min_res_132766] = tmp_132858;
                                        
                                        bool byteSeq_gt_res_132860;
                                        int64_t byteSeq_gt_res_132861;
                                        bool byteSeq_gt_res_132862;
                                        bool loop_while_132863;
                                        int64_t p_132864;
                                        bool p_132865;
                                        
                                        loop_while_132863 = loop_cond_t_res_132826;
                                        p_132864 = i32_res_132825;
                                        p_132865 = 0;
                                        while (loop_while_132863) {
                                            bool x_132866 = sle64((int64_t) 0, p_132864);
                                            bool y_132867 = slt64(p_132864, b_120164);
                                            bool bounds_check_132868 = x_132866 && y_132867;
                                            bool index_certs_132869;
                                            
                                            if (!bounds_check_132868) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_132864, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:126:17-27\n   #1  ftRelational.fut:313:1-320:73\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_132870 = ((int8_t *) mem_133265)[p_132864];
                                            int8_t zl_rhs_132871 = ((int8_t *) mem_133264)[p_132864];
                                            bool dlt_132872 = ult8(zl_lhs_132870, zl_rhs_132871);
                                            bool dgt_132873 = ult8(zl_rhs_132871, zl_lhs_132870);
                                            bool tmp_132874 = dlt_132872 || dgt_132873;
                                            bool cond_132875 = !tmp_132874;
                                            int64_t tmp_132876;
                                            
                                            if (cond_132875) {
                                                int64_t tmp_t_res_132877 = add64((int64_t) 1, p_132864);
                                                
                                                tmp_132876 = tmp_t_res_132877;
                                            } else {
                                                tmp_132876 = i32_res_132761;
                                            }
                                            
                                            bool cond_132878 = !dgt_132873;
                                            bool loop_cond_t_res_132879 = slt64(tmp_132876, i32_res_132761);
                                            bool x_132880 = cond_132878 && loop_cond_t_res_132879;
                                            bool loop_while_tmp_133552 = x_132880;
                                            int64_t p_tmp_133553 = tmp_132876;
                                            bool p_tmp_133554 = dgt_132873;
                                            
                                            loop_while_132863 = loop_while_tmp_133552;
                                            p_132864 = p_tmp_133553;
                                            p_132865 = p_tmp_133554;
                                        }
                                        byteSeq_gt_res_132860 = loop_while_132863;
                                        byteSeq_gt_res_132861 = p_132864;
                                        byteSeq_gt_res_132862 = p_132865;
                                        
                                        bool tmp_132881 = byteSeq_lt_res_132829 || byteSeq_gt_res_132862;
                                        bool cond_132882 = !tmp_132881;
                                        int32_t tmp_132883;
                                        
                                        if (cond_132882) {
                                            tmp_132883 = zt_rhs_132753;
                                        } else {
                                            tmp_132883 = prev_depth_129216;
                                        }
                                        
                                        bool cond_132884 = !byteSeq_gt_res_132862;
                                        bool loop_cond_t_res_132885 = slt32(tmp_132883, prev_depth_129216);
                                        bool x_132886 = cond_132884 && loop_cond_t_res_132885;
                                        bool loop_while_tmp_133544 = x_132886;
                                        int32_t p_tmp_133545 = tmp_132883;
                                        bool p_tmp_133546 = byteSeq_gt_res_132862;
                                        
                                        loop_while_132750 = loop_while_tmp_133544;
                                        p_132751 = p_tmp_133545;
                                        p_132752 = p_tmp_133546;
                                    }
                                    radix_gt_res_132747 = loop_while_132750;
                                    radix_gt_res_132748 = p_132751;
                                    radix_gt_res_132749 = p_132752;
                                    cond_132745 = radix_gt_res_132749;
                                }
                                
                                int64_t loopres_f_res_f_res_t_res_132887;
                                int64_t loopres_f_res_f_res_t_res_132888;
                                
                                if (cond_132745) {
                                    loopres_f_res_f_res_t_res_132887 = (int64_t) -1;
                                    loopres_f_res_f_res_t_res_132888 = (int64_t) 0;
                                } else {
                                    int64_t tmp_132889 = sub64(heshi_129208, step_129209);
                                    int64_t max_arg1_132890 = sdiv64(step_129209, (int64_t) 2);
                                    int64_t max_res_132891 = smax64((int64_t) 1, max_arg1_132890);
                                    
                                    loopres_f_res_f_res_t_res_132887 = tmp_132889;
                                    loopres_f_res_f_res_t_res_132888 = max_res_132891;
                                }
                                loopres_f_res_f_res_129565 = loopres_f_res_f_res_t_res_132887;
                                loopres_f_res_f_res_129566 = loopres_f_res_f_res_t_res_132888;
                            } else {
                                int64_t tmp_129250 = add64((int64_t) 1, heshi_129208);
                                bool x_129251 = sle64((int64_t) 0, tmp_129250);
                                bool y_129252 = slt64(tmp_129250, dz2081U_120166);
                                bool bounds_check_129253 = x_129251 && y_129252;
                                bool protect_assert_disj_133419 = cond_129223 || bounds_check_129253;
                                bool protect_assert_disj_133445 = cond_129223 || protect_assert_disj_133419;
                                bool index_certs_129254;
                                
                                if (!protect_assert_disj_133445) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129250, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:363:59-76\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_t_res_129716 = slt32(0, next_depth_129224);
                                bool x_133442 = !cond_129223;
                                bool protect_cond_conj_133446 = x_133442 && x_133442;
                                int64_t tmp_129255;
                                
                                if (protect_cond_conj_133446) {
                                    int64_t x_133420 = ((int64_t *) bounds_mem_133177.mem)[tmp_129250];
                                    
                                    tmp_129255 = x_133420;
                                } else {
                                    tmp_129255 = (int64_t) 0;
                                }
                                
                                int64_t lmad_ext_133245 = b_120164 * tmp_129255;
                                int64_t ext_133247;
                                
                                if (cond_129223) {
                                    ext_133247 = lmad_ext_133199;
                                } else {
                                    ext_133247 = lmad_ext_133245;
                                }
                                
                                bool cond_129715;
                                
                                if (cond_129223) {
                                    cond_129715 = 1;
                                } else {
                                    if (!cond_129223) {
                                        bool x_129256 = sle64((int64_t) 0, tmp_129255);
                                        bool y_129257 = slt64(tmp_129255, nS_120165);
                                        bool bounds_check_129258 = x_129256 && y_129257;
                                        bool index_certs_129259;
                                        
                                        if (!bounds_check_129258) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129255, "] out of bounds for array of shape [", (long long) nS_120165, "].", "-> #0  ftHashJoin.fut:363:56-77\n   #1  ftHashJoin.fut:497:3-503:70\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                    }
                                    if (mem_133248_cached_sizze_133640 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133248, &mem_133248_cached_sizze_133640, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133249_cached_sizze_133641 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133641, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133262_cached_sizze_133642 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133262, &mem_133262_cached_sizze_133642, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_133263_cached_sizze_133643 < b_120164) {
                                        err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133643, b_120164);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    
                                    bool radix_lt_res_129717;
                                    int32_t radix_lt_res_129718;
                                    bool radix_lt_res_129719;
                                    bool loop_while_129720;
                                    int32_t p_129721;
                                    bool p_129722;
                                    
                                    loop_while_129720 = loop_cond_t_res_129716;
                                    p_129721 = 0;
                                    p_129722 = 0;
                                    while (loop_while_129720) {
                                        int32_t zt_rhs_129723 = add32(1, p_129721);
                                        int32_t zm_lhs_129724 = mul32(radix_sizze_120168, zt_rhs_129723);
                                        int32_t byteSeq_lt_arg1_129725 = sub32(zm_lhs_129724, 1);
                                        int32_t byteSeq_lt_arg0_129726 = mul32(radix_sizze_120168, p_129721);
                                        int32_t min_res_129727 = smin32(min_arg1_127858, byteSeq_lt_arg1_129725);
                                        int32_t zm_rhs_129728 = sdiv32(byteSeq_lt_arg0_129726, 8);
                                        int32_t zm_lhs_129729 = sub32(i64_res_127856, zm_rhs_129728);
                                        int32_t i32_arg0_129730 = sub32(zm_lhs_129729, 1);
                                        int64_t i32_res_129731 = sext_i32_i64(i32_arg0_129730);
                                        int32_t zm_rhs_129732 = sdiv32(min_res_129727, 8);
                                        int32_t zm_lhs_129733 = sub32(i64_res_127856, zm_rhs_129732);
                                        int32_t i32_arg0_129734 = sub32(zm_lhs_129733, 1);
                                        int64_t i32_res_129735 = sext_i32_i64(i32_arg0_129734);
                                        int64_t min_res_129736 = smin64(min_arg1_127871, i32_res_129735);
                                        bool x_129752 = sle64((int64_t) 0, i32_res_129731);
                                        bool y_129753 = slt64(i32_res_129731, b_120164);
                                        bool bounds_check_129754 = x_129752 && y_129753;
                                        bool index_certs_129755;
                                        
                                        if (!bounds_check_129754) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_129731, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:313:1-320:73\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129759 = sle64((int64_t) 0, min_res_129736);
                                        bool y_129760 = slt64(min_res_129736, b_120164);
                                        bool bounds_check_129761 = x_129759 && y_129760;
                                        bool index_certs_129762;
                                        
                                        if (!bounds_check_129761) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_129736, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:82:12-27\n   #2  ftRelational.fut:313:1-320:73\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t firstBit_129737 = smod32(byteSeq_lt_arg0_129726, 8);
                                        int32_t lastBit_129738 = smod32(min_res_129727, 8);
                                        int8_t unsign_arg0_129739 = zext_i32_i8(firstBit_129737);
                                        int8_t first_bitMask_129740 = shl8((int8_t) -1, unsign_arg0_129739);
                                        int32_t zm_lhs_129741 = sub32(8, lastBit_129738);
                                        int32_t i32_arg0_129742 = sub32(zm_lhs_129741, 1);
                                        int8_t unsign_arg0_129743 = zext_i32_i8(i32_arg0_129742);
                                        int8_t unsign_arg0_129744 = lshr8((int8_t) -1, unsign_arg0_129743);
                                        
                                        for (int64_t i_133082 = 0; i_133082 < b_120164; i_133082++) {
                                            int8_t eta_p_130328 = ((int8_t *) pS_mem_133176.mem)[ext_133247 + i_133082];
                                            int8_t eta_p_130329 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133082];
                                            bool cond_130335 = sle64(i_133082, i32_res_129731);
                                            bool cond_t_res_130336 = sle64(min_res_129736, i_133082);
                                            bool x_130337 = cond_130335 && cond_t_res_130336;
                                            int8_t lifted_lambda_res_130338;
                                            
                                            if (x_130337) {
                                                lifted_lambda_res_130338 = eta_p_130329;
                                            } else {
                                                lifted_lambda_res_130338 = (int8_t) 0;
                                            }
                                            
                                            int8_t lifted_lambda_res_130343;
                                            
                                            if (x_130337) {
                                                lifted_lambda_res_130343 = eta_p_130328;
                                            } else {
                                                lifted_lambda_res_130343 = (int8_t) 0;
                                            }
                                            ((int8_t *) mem_133248)[i_133082] = lifted_lambda_res_130343;
                                            ((int8_t *) mem_133249)[i_133082] = lifted_lambda_res_130338;
                                        }
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133262, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133249, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
                                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133263, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133248, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
                                        
                                        int8_t za_lhs_129756 = ((int8_t *) mem_133262)[i32_res_129731];
                                        int8_t mod1_x_129757 = first_bitMask_129740 & za_lhs_129756;
                                        
                                        ((int8_t *) mem_133262)[i32_res_129731] = mod1_x_129757;
                                        
                                        int8_t za_lhs_129763 = ((int8_t *) mem_133262)[min_res_129736];
                                        int8_t tmp_129764 = unsign_arg0_129744 & za_lhs_129763;
                                        
                                        ((int8_t *) mem_133262)[min_res_129736] = tmp_129764;
                                        
                                        int8_t za_lhs_129773 = ((int8_t *) mem_133263)[i32_res_129731];
                                        int8_t mod1_x_129774 = first_bitMask_129740 & za_lhs_129773;
                                        
                                        ((int8_t *) mem_133263)[i32_res_129731] = mod1_x_129774;
                                        
                                        int8_t za_lhs_129776 = ((int8_t *) mem_133263)[min_res_129736];
                                        int8_t tmp_129777 = unsign_arg0_129744 & za_lhs_129776;
                                        
                                        ((int8_t *) mem_133263)[min_res_129736] = tmp_129777;
                                        
                                        int32_t zm_rhs_129779 = sdiv32(byteSeq_lt_arg1_129725, 8);
                                        int32_t zm_lhs_129780 = sub32(i64_res_127856, zm_rhs_129779);
                                        int32_t i32_arg0_129781 = sub32(zm_lhs_129780, 1);
                                        int64_t i32_res_129782 = sext_i32_i64(i32_arg0_129781);
                                        bool loop_cond_t_res_129783 = slt64(i32_res_129782, i32_res_129731);
                                        bool byteSeq_lt_res_129784;
                                        int64_t byteSeq_lt_res_129785;
                                        bool byteSeq_lt_res_129786;
                                        bool loop_while_129787;
                                        int64_t p_129788;
                                        bool p_129789;
                                        
                                        loop_while_129787 = loop_cond_t_res_129783;
                                        p_129788 = i32_res_129782;
                                        p_129789 = 0;
                                        while (loop_while_129787) {
                                            bool x_129790 = sle64((int64_t) 0, p_129788);
                                            bool y_129791 = slt64(p_129788, b_120164);
                                            bool bounds_check_129792 = x_129790 && y_129791;
                                            bool index_certs_129793;
                                            
                                            if (!bounds_check_129792) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129788, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:89:17-27\n   #1  ftRelational.fut:313:1-320:73\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_129794 = ((int8_t *) mem_133262)[p_129788];
                                            int8_t zl_rhs_129795 = ((int8_t *) mem_133263)[p_129788];
                                            bool dlt_129796 = ult8(zl_lhs_129794, zl_rhs_129795);
                                            bool dgt_129797 = ult8(zl_rhs_129795, zl_lhs_129794);
                                            bool tmp_129798 = dlt_129796 || dgt_129797;
                                            bool cond_129799 = !tmp_129798;
                                            int64_t tmp_129800;
                                            
                                            if (cond_129799) {
                                                int64_t tmp_t_res_132892 = add64((int64_t) 1, p_129788);
                                                
                                                tmp_129800 = tmp_t_res_132892;
                                            } else {
                                                tmp_129800 = i32_res_129731;
                                            }
                                            
                                            bool cond_129802 = !dlt_129796;
                                            bool loop_cond_t_res_129803 = slt64(tmp_129800, i32_res_129731);
                                            bool x_129804 = cond_129802 && loop_cond_t_res_129803;
                                            bool loop_while_tmp_133560 = x_129804;
                                            int64_t p_tmp_133561 = tmp_129800;
                                            bool p_tmp_133562 = dlt_129796;
                                            
                                            loop_while_129787 = loop_while_tmp_133560;
                                            p_129788 = p_tmp_133561;
                                            p_129789 = p_tmp_133562;
                                        }
                                        byteSeq_lt_res_129784 = loop_while_129787;
                                        byteSeq_lt_res_129785 = p_129788;
                                        byteSeq_lt_res_129786 = p_129789;
                                        
                                        int8_t za_lhs_129812 = ((int8_t *) mem_133249)[i32_res_129731];
                                        int8_t mod1_x_129813 = first_bitMask_129740 & za_lhs_129812;
                                        
                                        ((int8_t *) mem_133249)[i32_res_129731] = mod1_x_129813;
                                        
                                        int8_t za_lhs_129815 = ((int8_t *) mem_133249)[min_res_129736];
                                        int8_t tmp_129816 = unsign_arg0_129744 & za_lhs_129815;
                                        
                                        ((int8_t *) mem_133249)[min_res_129736] = tmp_129816;
                                        
                                        int8_t za_lhs_129825 = ((int8_t *) mem_133248)[i32_res_129731];
                                        int8_t mod1_x_129826 = first_bitMask_129740 & za_lhs_129825;
                                        
                                        ((int8_t *) mem_133248)[i32_res_129731] = mod1_x_129826;
                                        
                                        int8_t za_lhs_129828 = ((int8_t *) mem_133248)[min_res_129736];
                                        int8_t tmp_129829 = unsign_arg0_129744 & za_lhs_129828;
                                        
                                        ((int8_t *) mem_133248)[min_res_129736] = tmp_129829;
                                        
                                        bool byteSeq_gt_res_129831;
                                        int64_t byteSeq_gt_res_129832;
                                        bool byteSeq_gt_res_129833;
                                        bool loop_while_129834;
                                        int64_t p_129835;
                                        bool p_129836;
                                        
                                        loop_while_129834 = loop_cond_t_res_129783;
                                        p_129835 = i32_res_129782;
                                        p_129836 = 0;
                                        while (loop_while_129834) {
                                            bool x_129837 = sle64((int64_t) 0, p_129835);
                                            bool y_129838 = slt64(p_129835, b_120164);
                                            bool bounds_check_129839 = x_129837 && y_129838;
                                            bool index_certs_129840;
                                            
                                            if (!bounds_check_129839) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_129835, "] out of bounds for array of shape [", (long long) b_120164, "].", "-> #0  ftHashJoin.fut:126:17-27\n   #1  ftRelational.fut:313:1-320:73\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_129841 = ((int8_t *) mem_133249)[p_129835];
                                            int8_t zl_rhs_129842 = ((int8_t *) mem_133248)[p_129835];
                                            bool dlt_129843 = ult8(zl_lhs_129841, zl_rhs_129842);
                                            bool dgt_129844 = ult8(zl_rhs_129842, zl_lhs_129841);
                                            bool tmp_129845 = dlt_129843 || dgt_129844;
                                            bool cond_129846 = !tmp_129845;
                                            int64_t tmp_129847;
                                            
                                            if (cond_129846) {
                                                int64_t tmp_t_res_132893 = add64((int64_t) 1, p_129835);
                                                
                                                tmp_129847 = tmp_t_res_132893;
                                            } else {
                                                tmp_129847 = i32_res_129731;
                                            }
                                            
                                            bool cond_129849 = !dgt_129844;
                                            bool loop_cond_t_res_129850 = slt64(tmp_129847, i32_res_129731);
                                            bool x_129851 = cond_129849 && loop_cond_t_res_129850;
                                            bool loop_while_tmp_133563 = x_129851;
                                            int64_t p_tmp_133564 = tmp_129847;
                                            bool p_tmp_133565 = dgt_129844;
                                            
                                            loop_while_129834 = loop_while_tmp_133563;
                                            p_129835 = p_tmp_133564;
                                            p_129836 = p_tmp_133565;
                                        }
                                        byteSeq_gt_res_129831 = loop_while_129834;
                                        byteSeq_gt_res_129832 = p_129835;
                                        byteSeq_gt_res_129833 = p_129836;
                                        
                                        bool tmp_129852 = byteSeq_lt_res_129786 || byteSeq_gt_res_129833;
                                        bool cond_129853 = !tmp_129852;
                                        int32_t tmp_129854;
                                        
                                        if (cond_129853) {
                                            tmp_129854 = zt_rhs_129723;
                                        } else {
                                            tmp_129854 = next_depth_129224;
                                        }
                                        
                                        bool cond_129855 = !byteSeq_lt_res_129786;
                                        bool loop_cond_t_res_129856 = slt32(tmp_129854, next_depth_129224);
                                        bool x_129857 = cond_129855 && loop_cond_t_res_129856;
                                        bool loop_while_tmp_133555 = x_129857;
                                        int32_t p_tmp_133556 = tmp_129854;
                                        bool p_tmp_133557 = byteSeq_lt_res_129786;
                                        
                                        loop_while_129720 = loop_while_tmp_133555;
                                        p_129721 = p_tmp_133556;
                                        p_129722 = p_tmp_133557;
                                    }
                                    radix_lt_res_129717 = loop_while_129720;
                                    radix_lt_res_129718 = p_129721;
                                    radix_lt_res_129719 = p_129722;
                                    cond_129715 = radix_lt_res_129719;
                                }
                                
                                int64_t loopres_f_res_f_res_f_res_129858;
                                int64_t loopres_f_res_f_res_f_res_129859;
                                
                                if (cond_129715) {
                                    loopres_f_res_f_res_f_res_129858 = (int64_t) -1;
                                    loopres_f_res_f_res_f_res_129859 = (int64_t) 0;
                                } else {
                                    int64_t tmp_129860 = add64(heshi_129208, step_129209);
                                    int64_t max_arg1_129861 = sdiv64(step_129209, (int64_t) 2);
                                    int64_t max_res_129862 = smax64((int64_t) 1, max_arg1_129861);
                                    
                                    loopres_f_res_f_res_f_res_129858 = tmp_129860;
                                    loopres_f_res_f_res_f_res_129859 = max_res_129862;
                                }
                                loopres_f_res_f_res_129565 = loopres_f_res_f_res_f_res_129858;
                                loopres_f_res_f_res_129566 = loopres_f_res_f_res_f_res_129859;
                            }
                            loopres_f_res_129418 = loopres_f_res_f_res_129565;
                            loopres_f_res_129419 = loopres_f_res_f_res_129566;
                        }
                        loopres_129407 = loopres_f_res_129418;
                        loopres_129408 = loopres_f_res_129419;
                    }
                    
                    bool loop_cond_129863 = slt64((int64_t) 0, loopres_129408);
                    bool loop_while_tmp_133523 = loop_cond_129863;
                    int64_t heshi_tmp_133524 = loopres_129407;
                    int64_t step_tmp_133525 = loopres_129408;
                    
                    loop_while_129207 = loop_while_tmp_133523;
                    heshi_129208 = heshi_tmp_133524;
                    step_129209 = step_tmp_133525;
                }
                rv_partitionMatchBounds_res_f_res_f_res_129204 = loop_while_129207;
                rv_partitionMatchBounds_res_f_res_f_res_129205 = heshi_129208;
                rv_partitionMatchBounds_res_f_res_f_res_129206 = step_129209;
                rv_partitionMatchBounds_res_f_res_129183 = rv_partitionMatchBounds_res_f_res_f_res_129205;
            }
            rv_partitionMatchBounds_res_129176 = rv_partitionMatchBounds_res_f_res_129183;
        }
        
        bool cond_129870 = sle64((int64_t) 0, rv_partitionMatchBounds_res_129176);
        bool y_129871 = slt64(rv_partitionMatchBounds_res_129176, dz2081U_120166);
        bool bounds_check_129872 = cond_129870 && y_129871;
        bool loop_not_taken_129873 = !cond_129870;
        bool protect_assert_disj_129874 = bounds_check_129872 || loop_not_taken_129873;
        bool index_certs_129875;
        
        if (!protect_assert_disj_129874) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) rv_partitionMatchBounds_res_129176, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:508:39-52\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t inf_s_idx_t_res_129876;
        
        if (cond_129870) {
            int64_t x_132902 = ((int64_t *) bounds_mem_133177.mem)[rv_partitionMatchBounds_res_129176];
            
            inf_s_idx_t_res_129876 = x_132902;
        } else {
            inf_s_idx_t_res_129876 = (int64_t) 0;
        }
        
        int64_t inf_s_idx_129878;
        
        if (cond_129870) {
            inf_s_idx_129878 = inf_s_idx_t_res_129876;
        } else {
            inf_s_idx_129878 = (int64_t) 0;
        }
        
        bool cond_129879 = rv_partitionMatchBounds_res_129176 == zeze_rhs_123782;
        bool x_129880 = !cond_129879;
        int64_t tmp_129881 = add64((int64_t) 1, rv_partitionMatchBounds_res_129176);
        bool x_129882 = sle64((int64_t) 0, tmp_129881);
        bool y_129883 = slt64(tmp_129881, dz2081U_120166);
        bool bounds_check_129884 = x_129882 && y_129883;
        bool protect_assert_disj_129885 = cond_129879 || bounds_check_129884;
        bool index_certs_129886;
        
        if (!protect_assert_disj_129885) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129881, "] out of bounds for array of shape [", (long long) dz2081U_120166, "].", "-> #0  ftHashJoin.fut:509:50-65\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t sup_s_idx_f_res_129887;
        
        if (x_129880) {
            int64_t x_132903 = ((int64_t *) bounds_mem_133177.mem)[tmp_129881];
            
            sup_s_idx_f_res_129887 = x_132903;
        } else {
            sup_s_idx_f_res_129887 = (int64_t) 0;
        }
        
        int64_t sup_s_idx_129889;
        
        if (cond_129879) {
            sup_s_idx_129889 = nS_120165;
        } else {
            sup_s_idx_129889 = sup_s_idx_f_res_129887;
        }
        
        int64_t j_m_i_129890 = sub64(sup_s_idx_129889, inf_s_idx_129878);
        bool empty_slice_129891 = j_m_i_129890 == (int64_t) 0;
        int64_t m_129892 = sub64(j_m_i_129890, (int64_t) 1);
        int64_t i_p_m_t_s_129893 = add64(inf_s_idx_129878, m_129892);
        bool zzero_leq_i_p_m_t_s_129894 = sle64((int64_t) 0, i_p_m_t_s_129893);
        bool i_p_m_t_s_leq_w_129895 = slt64(i_p_m_t_s_129893, nS_120165);
        bool zzero_lte_i_129896 = sle64((int64_t) 0, inf_s_idx_129878);
        bool i_lte_j_129897 = sle64(inf_s_idx_129878, sup_s_idx_129889);
        bool y_129898 = i_p_m_t_s_leq_w_129895 && zzero_lte_i_129896;
        bool y_129899 = zzero_leq_i_p_m_t_s_129894 && y_129898;
        bool forwards_ok_129900 = i_lte_j_129897 && y_129899;
        bool ok_or_empty_129901 = empty_slice_129891 || forwards_ok_129900;
        bool index_certs_129902;
        
        if (!ok_or_empty_129901) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_s_idx_129878, ":", (long long) sup_s_idx_129889, "] out of bounds for array of shape [", (long long) nS_120165, "].", "-> #0  ftHashJoin.fut:510:19-42\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool loop_cond_t_res_129903 = slt64((int64_t) 0, j_m_i_129890);
        bool rv_find_match_if_exists_res_129904;
        int32_t rv_find_match_if_exists_res_129905;
        int64_t rv_find_match_if_exists_res_129906;
        bool loop_while_129907;
        int32_t count_129908;
        int64_t j_129909;
        
        loop_while_129907 = loop_cond_t_res_129903;
        count_129908 = 0;
        j_129909 = (int64_t) 0;
        while (loop_while_129907) {
            bool x_129910 = sle64((int64_t) 0, j_129909);
            bool y_129911 = slt64(j_129909, j_m_i_129890);
            bool bounds_check_129912 = x_129910 && y_129911;
            bool index_certs_129913;
            
            if (!bounds_check_129912) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_129909, "] out of bounds for array of shape [", (long long) j_m_i_129890, "].", "-> #0  ftHashJoin.fut:411:33-38\n   #1  ftHashJoin.fut:511:16-48\n   #2  /prelude/soacs.fut:67:23-24\n   #3  /prelude/soacs.fut:67:27-37\n   #4  ftRelational.fut:317:4-320:54\n   #5  ftRelational.fut:313:1-320:73\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t slice_129914 = inf_s_idx_129878 + j_129909;
            bool defunc_0_reduce_res_132906;
            bool redout_133085 = 1;
            
            for (int64_t i_133086 = 0; i_133086 < b_120164; i_133086++) {
                int8_t eta_p_131995 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133086];
                int8_t eta_p_131996 = ((int8_t *) pS_mem_133176.mem)[slice_129914 * b_120164 + i_133086];
                bool defunc_0_f_res_131997 = eta_p_131995 == eta_p_131996;
                bool x_129924 = defunc_0_f_res_131997 && redout_133085;
                bool redout_tmp_133569 = x_129924;
                
                redout_133085 = redout_tmp_133569;
            }
            defunc_0_reduce_res_132906 = redout_133085;
            
            int32_t loopres_129925;
            int64_t loopres_129926;
            
            if (defunc_0_reduce_res_132906) {
                int32_t tmp_132904 = add32(1, count_129908);
                int64_t tmp_132905 = add64((int64_t) 1, j_129909);
                
                loopres_129925 = tmp_132904;
                loopres_129926 = tmp_132905;
            } else {
                int64_t tmp_129929 = add64((int64_t) 1, j_129909);
                
                loopres_129925 = count_129908;
                loopres_129926 = tmp_129929;
            }
            
            bool cond_129930 = slt32(loopres_129925, 1);
            bool loop_cond_t_res_129931 = slt64(loopres_129926, j_m_i_129890);
            bool x_129932 = cond_129930 && loop_cond_t_res_129931;
            bool loop_while_tmp_133566 = x_129932;
            int32_t count_tmp_133567 = loopres_129925;
            int64_t j_tmp_133568 = loopres_129926;
            
            loop_while_129907 = loop_while_tmp_133566;
            count_129908 = count_tmp_133567;
            j_129909 = j_tmp_133568;
        }
        rv_find_match_if_exists_res_129904 = loop_while_129907;
        rv_find_match_if_exists_res_129905 = count_129908;
        rv_find_match_if_exists_res_129906 = j_129909;
        
        bool cond_129933 = slt64(rv_find_match_if_exists_res_129906, j_m_i_129890);
        bool cond_129934;
        
        if (cond_129933) {
            cond_129934 = 1;
        } else {
            bool x_129935 = sle64((int64_t) 0, m_129892);
            bool y_129936 = slt64(m_129892, j_m_i_129890);
            bool bounds_check_129937 = x_129935 && y_129936;
            bool index_certs_129938;
            
            if (!bounds_check_129937) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_129892, "] out of bounds for array of shape [", (long long) j_m_i_129890, "].", "-> #0  ftHashJoin.fut:415:45-53\n   #1  ftHashJoin.fut:511:16-48\n   #2  /prelude/soacs.fut:67:23-24\n   #3  /prelude/soacs.fut:67:27-37\n   #4  ftRelational.fut:317:4-320:54\n   #5  ftRelational.fut:313:1-320:73\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool defunc_0_reduce_res_132908;
            bool redout_133087 = 1;
            
            for (int64_t i_133088 = 0; i_133088 < b_120164; i_133088++) {
                int8_t eta_p_132006 = ((int8_t *) pR_mem_133175.mem)[i_133095 * b_120164 + i_133088];
                int8_t eta_p_132007 = ((int8_t *) pS_mem_133176.mem)[i_p_m_t_s_129893 * b_120164 + i_133088];
                bool defunc_0_f_res_132008 = eta_p_132006 == eta_p_132007;
                bool x_129948 = defunc_0_f_res_132008 && redout_133087;
                bool redout_tmp_133570 = x_129948;
                
                redout_133087 = redout_tmp_133570;
            }
            defunc_0_reduce_res_132908 = redout_133087;
            cond_129934 = defunc_0_reduce_res_132908;
        }
        
        int64_t rv_find_match_if_exists_res_129949;
        
        if (cond_129934) {
            int64_t rv_find_match_if_exists_res_t_res_132910 = sub64(rv_find_match_if_exists_res_129906, (int64_t) 1);
            
            rv_find_match_if_exists_res_129949 = rv_find_match_if_exists_res_t_res_132910;
        } else {
            rv_find_match_if_exists_res_129949 = (int64_t) -1;
        }
        
        bool cond_129951 = slt64((int64_t) 0, rv_find_match_if_exists_res_129949);
        int64_t lifted_lambda_res_129952;
        
        if (cond_129951) {
            int64_t lifted_lambda_res_t_res_132911 = add64(inf_s_idx_129878, rv_find_match_if_exists_res_129949);
            
            lifted_lambda_res_129952 = lifted_lambda_res_t_res_132911;
        } else {
            lifted_lambda_res_129952 = (int64_t) -1;
        }
        
        bool lifted_lambda_res_129955 = slt64((int64_t) 0, lifted_lambda_res_129952);
        int64_t bool_res_129956 = btoi_bool_i64(lifted_lambda_res_129955);
        int64_t defunc_0_op_res_123892 = add64(bool_res_129956, scanacc_133091);
        int64_t zp_res_123883 = add64(bool_res_129956, redout_133093);
        
        ((int64_t *) mem_133182)[i_133095] = defunc_0_op_res_123892;
        ((int64_t *) mem_133184)[i_133095] = lifted_lambda_res_129952;
        
        int64_t scanacc_tmp_133517 = defunc_0_op_res_123892;
        int64_t redout_tmp_133519 = zp_res_123883;
        
        scanacc_133091 = scanacc_tmp_133517;
        redout_133093 = redout_tmp_133519;
    }
    discard_133098 = scanacc_133091;
    defunc_res_132916 = redout_133093;
    
    int64_t bytes_133286 = (int64_t) 8 * defunc_res_132916;
    int64_t bytes_133303 = b_120164 * defunc_res_132916;
    
    if (memblock_alloc(ctx, &mem_133287, bytes_133286, "mem_133287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133571 = 0; nest_i_133571 < defunc_res_132916; nest_i_133571++) {
        ((int64_t *) mem_133287.mem)[nest_i_133571] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133289, bytes_133286, "mem_133289")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133572 = 0; nest_i_133572 < defunc_res_132916; nest_i_133572++) {
        ((int64_t *) mem_133289.mem)[nest_i_133572] = (int64_t) -1;
    }
    for (int64_t write_iter_133099 = 0; write_iter_133099 < nR_120163; write_iter_133099++) {
        int64_t write_iv_133103 = ((int64_t *) mem_133184)[write_iter_133099];
        int64_t zv_lhs_132378 = add64((int64_t) -1, write_iter_133099);
        int64_t tmp_132379 = smod64(zv_lhs_132378, nR_120163);
        int64_t lifted_lambda_res_132380 = ((int64_t *) mem_133182)[tmp_132379];
        bool cond_132381 = write_iter_133099 == (int64_t) 0;
        int64_t lifted_lambda_res_132382;
        
        if (cond_132381) {
            lifted_lambda_res_132382 = (int64_t) 0;
        } else {
            lifted_lambda_res_132382 = lifted_lambda_res_132380;
        }
        
        bool cond_132383 = slt64((int64_t) 0, write_iv_133103);
        int64_t lifted_lambda_res_132384;
        
        if (cond_132383) {
            lifted_lambda_res_132384 = lifted_lambda_res_132382;
        } else {
            lifted_lambda_res_132384 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_132384) && slt64(lifted_lambda_res_132384, defunc_res_132916)) {
            ((int64_t *) mem_133287.mem)[lifted_lambda_res_132384] = write_iv_133103;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_132384) && slt64(lifted_lambda_res_132384, defunc_res_132916)) {
            ((int64_t *) mem_133289.mem)[lifted_lambda_res_132384] = write_iter_133099;
        }
    }
    if (memblock_alloc(ctx, &mem_133302, b_120164, "mem_133302")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133575 = 0; nest_i_133575 < b_120164; nest_i_133575++) {
        ((int8_t *) mem_133302.mem)[nest_i_133575] = (int8_t) 0;
    }
    if (memblock_alloc(ctx, &mem_133304, bytes_133303, "mem_133304")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133108 = 0; i_133108 < defunc_res_132916; i_133108++) {
        int64_t eta_p_123918 = ((int64_t *) mem_133289.mem)[i_133108];
        bool cond_123919 = sle64((int64_t) 0, eta_p_123918);
        bool cond_t_res_123920 = slt64(eta_p_123918, nR_120163);
        bool x_123921 = cond_123919 && cond_t_res_123920;
        int64_t lmad_ext_133309 = b_120164 * eta_p_123918;
        int64_t ext_133310;
        
        if (x_123921) {
            ext_133310 = lmad_ext_133309;
        } else {
            ext_133310 = (int64_t) 0;
        }
        if (x_123921) {
            bool index_certs_132913;
            
            if (!x_123921) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_123918, "] out of bounds for array of shape [", (long long) nR_120163, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:317:4-320:54\n   #4  ftRelational.fut:313:1-320:73\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_133311, &pR_mem_133175, "pR_mem_133175") != 0)
                return 1;
        } else if (memblock_set(ctx, &ext_mem_133311, &mem_133302, "mem_133302") != 0)
            return 1;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133304.mem, i_133108 * b_120164, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_133311.mem, ext_133310, (int64_t []) {(int64_t) 1}, (int64_t []) {b_120164});
        if (memblock_unref(ctx, &ext_mem_133311, "ext_mem_133311") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133302, "mem_133302") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133289, "mem_133289") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133287, "mem_133287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133304, "mem_133304") != 0)
        return 1;
    prim_out_133516 = defunc_res_132916;
    if (memblock_set(ctx, &*mem_out_p_133625, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133626, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133627, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133628 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133182);
        free(mem_133184);
        free(mem_133191);
        free(mem_133201);
        free(mem_133202);
        free(mem_133215);
        free(mem_133216);
        free(mem_133229);
        free(mem_133230);
        free(mem_133243);
        free(mem_133244);
        free(mem_133248);
        free(mem_133249);
        free(mem_133262);
        free(mem_133263);
        free(mem_133264);
        free(mem_133265);
        free(mem_133278);
        free(mem_133279);
        if (memblock_unref(ctx, &ext_mem_133311, "ext_mem_133311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133304, "mem_133304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133302, "mem_133302") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133289, "mem_133289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133287, "mem_133287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_133648, struct memblock ks_mem_133175, int64_t n_62709)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_comm_res_128906;
    double defunc_0_reduce_comm_res_128907;
    int64_t redout_133040;
    double redout_133041;
    
    redout_133040 = n_62709;
    redout_133041 = INFINITY;
    for (int64_t i_133042 = 0; i_133042 < n_62709; i_133042++) {
        double x_121185 = ((double *) ks_mem_133175.mem)[i_133042];
        bool defunc_0_lt_res_121190 = redout_133041 < x_121185;
        bool defunc_0_eq_res_121192 = redout_133041 == x_121185;
        bool cond_f_res_t_res_121193 = slt64(redout_133040, i_133042);
        bool x_121194 = defunc_0_eq_res_121192 && cond_f_res_t_res_121193;
        bool x_127612 = !defunc_0_lt_res_121190;
        bool y_127613 = x_121194 && x_127612;
        bool cond_121191 = defunc_0_lt_res_121190 || y_127613;
        int64_t defunc_0_op_res_121195;
        
        if (cond_121191) {
            defunc_0_op_res_121195 = redout_133040;
        } else {
            defunc_0_op_res_121195 = i_133042;
        }
        
        double defunc_0_op_res_121196;
        
        if (cond_121191) {
            defunc_0_op_res_121196 = redout_133041;
        } else {
            defunc_0_op_res_121196 = x_121185;
        }
        
        int64_t redout_tmp_133514 = defunc_0_op_res_121195;
        double redout_tmp_133515 = defunc_0_op_res_121196;
        
        redout_133040 = redout_tmp_133514;
        redout_133041 = redout_tmp_133515;
    }
    defunc_0_reduce_comm_res_128906 = redout_133040;
    defunc_0_reduce_comm_res_128907 = redout_133041;
    prim_out_133513 = defunc_0_reduce_comm_res_128906;
    *out_prim_out_133648 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_133649, struct memblock ks_mem_133175, int64_t n_62532)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_comm_res_128906;
    float defunc_0_reduce_comm_res_128907;
    int64_t redout_133040;
    float redout_133041;
    
    redout_133040 = n_62532;
    redout_133041 = INFINITY;
    for (int64_t i_133042 = 0; i_133042 < n_62532; i_133042++) {
        float x_121185 = ((float *) ks_mem_133175.mem)[i_133042];
        bool defunc_0_lt_res_121190 = redout_133041 < x_121185;
        bool defunc_0_eq_res_121192 = redout_133041 == x_121185;
        bool cond_f_res_t_res_121193 = slt64(redout_133040, i_133042);
        bool x_121194 = defunc_0_eq_res_121192 && cond_f_res_t_res_121193;
        bool x_127612 = !defunc_0_lt_res_121190;
        bool y_127613 = x_121194 && x_127612;
        bool cond_121191 = defunc_0_lt_res_121190 || y_127613;
        int64_t defunc_0_op_res_121195;
        
        if (cond_121191) {
            defunc_0_op_res_121195 = redout_133040;
        } else {
            defunc_0_op_res_121195 = i_133042;
        }
        
        float defunc_0_op_res_121196;
        
        if (cond_121191) {
            defunc_0_op_res_121196 = redout_133041;
        } else {
            defunc_0_op_res_121196 = x_121185;
        }
        
        int64_t redout_tmp_133514 = defunc_0_op_res_121195;
        float redout_tmp_133515 = defunc_0_op_res_121196;
        
        redout_133040 = redout_tmp_133514;
        redout_133041 = redout_tmp_133515;
    }
    defunc_0_reduce_comm_res_128906 = redout_133040;
    defunc_0_reduce_comm_res_128907 = redout_133041;
    prim_out_133513 = defunc_0_reduce_comm_res_128906;
    *out_prim_out_133649 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_133650, struct memblock ks_mem_133175, int64_t n_62181)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_comm_res_128906;
    int32_t defunc_0_reduce_comm_res_128907;
    int64_t redout_133040;
    int32_t redout_133041;
    
    redout_133040 = n_62181;
    redout_133041 = 2147483647;
    for (int64_t i_133042 = 0; i_133042 < n_62181; i_133042++) {
        int32_t x_121185 = ((int32_t *) ks_mem_133175.mem)[i_133042];
        bool defunc_0_lt_res_121190 = slt32(redout_133041, x_121185);
        bool defunc_0_eq_res_121192 = redout_133041 == x_121185;
        bool cond_f_res_t_res_121193 = slt64(redout_133040, i_133042);
        bool x_121194 = defunc_0_eq_res_121192 && cond_f_res_t_res_121193;
        bool x_127612 = !defunc_0_lt_res_121190;
        bool y_127613 = x_121194 && x_127612;
        bool cond_121191 = defunc_0_lt_res_121190 || y_127613;
        int64_t defunc_0_op_res_121195;
        
        if (cond_121191) {
            defunc_0_op_res_121195 = redout_133040;
        } else {
            defunc_0_op_res_121195 = i_133042;
        }
        
        int32_t defunc_0_op_res_121196;
        
        if (cond_121191) {
            defunc_0_op_res_121196 = redout_133041;
        } else {
            defunc_0_op_res_121196 = x_121185;
        }
        
        int64_t redout_tmp_133514 = defunc_0_op_res_121195;
        int32_t redout_tmp_133515 = defunc_0_op_res_121196;
        
        redout_133040 = redout_tmp_133514;
        redout_133041 = redout_tmp_133515;
    }
    defunc_0_reduce_comm_res_128906 = redout_133040;
    defunc_0_reduce_comm_res_128907 = redout_133041;
    prim_out_133513 = defunc_0_reduce_comm_res_128906;
    *out_prim_out_133650 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_133651, struct memblock ks_mem_133175, int64_t n_62355)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_comm_res_128906;
    int64_t defunc_0_reduce_comm_res_128907;
    int64_t redout_133040;
    int64_t redout_133041;
    
    redout_133040 = n_62355;
    redout_133041 = (int64_t) 9223372036854775807;
    for (int64_t i_133042 = 0; i_133042 < n_62355; i_133042++) {
        int64_t x_121185 = ((int64_t *) ks_mem_133175.mem)[i_133042];
        bool defunc_0_lt_res_121190 = slt64(redout_133041, x_121185);
        bool defunc_0_eq_res_121192 = redout_133041 == x_121185;
        bool cond_f_res_t_res_121193 = slt64(redout_133040, i_133042);
        bool x_121194 = defunc_0_eq_res_121192 && cond_f_res_t_res_121193;
        bool x_127612 = !defunc_0_lt_res_121190;
        bool y_127613 = x_121194 && x_127612;
        bool cond_121191 = defunc_0_lt_res_121190 || y_127613;
        int64_t defunc_0_op_res_121195;
        
        if (cond_121191) {
            defunc_0_op_res_121195 = redout_133040;
        } else {
            defunc_0_op_res_121195 = i_133042;
        }
        
        int64_t defunc_0_op_res_121196;
        
        if (cond_121191) {
            defunc_0_op_res_121196 = redout_133041;
        } else {
            defunc_0_op_res_121196 = x_121185;
        }
        
        int64_t redout_tmp_133514 = defunc_0_op_res_121195;
        int64_t redout_tmp_133515 = defunc_0_op_res_121196;
        
        redout_133040 = redout_tmp_133514;
        redout_133041 = redout_tmp_133515;
    }
    defunc_0_reduce_comm_res_128906 = redout_133040;
    defunc_0_reduce_comm_res_128907 = redout_133041;
    prim_out_133513 = defunc_0_reduce_comm_res_128906;
    *out_prim_out_133651 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_133652, struct memblock ks_mem_133175, int64_t n_62007)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_comm_res_128906;
    int16_t defunc_0_reduce_comm_res_128907;
    int64_t redout_133040;
    int16_t redout_133041;
    
    redout_133040 = n_62007;
    redout_133041 = (int16_t) 32767;
    for (int64_t i_133042 = 0; i_133042 < n_62007; i_133042++) {
        int16_t x_121185 = ((int16_t *) ks_mem_133175.mem)[i_133042];
        bool defunc_0_lt_res_121190 = slt16(redout_133041, x_121185);
        bool defunc_0_eq_res_121192 = redout_133041 == x_121185;
        bool cond_f_res_t_res_121193 = slt64(redout_133040, i_133042);
        bool x_121194 = defunc_0_eq_res_121192 && cond_f_res_t_res_121193;
        bool x_127612 = !defunc_0_lt_res_121190;
        bool y_127613 = x_121194 && x_127612;
        bool cond_121191 = defunc_0_lt_res_121190 || y_127613;
        int64_t defunc_0_op_res_121195;
        
        if (cond_121191) {
            defunc_0_op_res_121195 = redout_133040;
        } else {
            defunc_0_op_res_121195 = i_133042;
        }
        
        int16_t defunc_0_op_res_121196;
        
        if (cond_121191) {
            defunc_0_op_res_121196 = redout_133041;
        } else {
            defunc_0_op_res_121196 = x_121185;
        }
        
        int64_t redout_tmp_133514 = defunc_0_op_res_121195;
        int16_t redout_tmp_133515 = defunc_0_op_res_121196;
        
        redout_133040 = redout_tmp_133514;
        redout_133041 = redout_tmp_133515;
    }
    defunc_0_reduce_comm_res_128906 = redout_133040;
    defunc_0_reduce_comm_res_128907 = redout_133041;
    prim_out_133513 = defunc_0_reduce_comm_res_128906;
    *out_prim_out_133652 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_133653, struct memblock *mem_out_p_133654, int64_t *out_prim_out_133655, int32_t *out_prim_out_133656, struct memblock pXs_mem_133175, int64_t n_115648, int64_t b_115649, int32_t radix_sizze_115650, int64_t offset_115652, int64_t sizze_thresh_115653, int32_t max_depth_115654)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133185_cached_sizze_133657 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133187_cached_sizze_133658 = 0;
    unsigned char *mem_133187 = NULL;
    int64_t mem_133189_cached_sizze_133659 = 0;
    unsigned char *mem_133189 = NULL;
    int64_t mem_133191_cached_sizze_133660 = 0;
    unsigned char *mem_133191 = NULL;
    int64_t mem_133217_cached_sizze_133661 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133662 = 0;
    unsigned char *mem_133219 = NULL;
    int64_t mem_133221_cached_sizze_133663 = 0;
    unsigned char *mem_133221 = NULL;
    struct memblock mem_133276;
    
    mem_133276.references = NULL;
    
    struct memblock mem_param_tmp_133518;
    
    mem_param_tmp_133518.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133536;
    
    mem_param_tmp_133536.references = NULL;
    
    struct memblock mem_param_tmp_133535;
    
    mem_param_tmp_133535.references = NULL;
    
    struct memblock mem_133262;
    
    mem_133262.references = NULL;
    
    struct memblock mem_133260;
    
    mem_133260.references = NULL;
    
    struct memblock ext_mem_133249;
    
    ext_mem_133249.references = NULL;
    
    struct memblock ext_mem_133250;
    
    ext_mem_133250.references = NULL;
    
    struct memblock mem_133247;
    
    mem_133247.references = NULL;
    
    struct memblock mem_param_133245;
    
    mem_param_133245.references = NULL;
    
    struct memblock mem_param_133242;
    
    mem_param_133242.references = NULL;
    
    struct memblock ext_mem_133267;
    
    ext_mem_133267.references = NULL;
    
    struct memblock ext_mem_133268;
    
    ext_mem_133268.references = NULL;
    
    struct memblock mem_param_133183;
    
    mem_param_133183.references = NULL;
    
    struct memblock mem_param_133180;
    
    mem_param_133180.references = NULL;
    
    struct memblock ext_mem_133273;
    
    ext_mem_133273.references = NULL;
    
    struct memblock ext_mem_133274;
    
    ext_mem_133274.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock ext_mem_133177;
    
    ext_mem_133177.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133515;
    int32_t prim_out_133516;
    int32_t getPartitionBounds_arg3_121496 = sub32(radix_sizze_115650, 1);
    int64_t calc_partitions_from_partitioned_set_res_121497;
    int64_t calc_partitions_from_partitioned_set_res_121498;
    int32_t calc_partitions_from_partitioned_set_res_121501;
    
    if (futrts_getPartitionBounds_11872(ctx, &ext_mem_133177, &ext_mem_133176, &calc_partitions_from_partitioned_set_res_121497, &calc_partitions_from_partitioned_set_res_121498, &calc_partitions_from_partitioned_set_res_121501, pXs_mem_133175, n_115648, b_115649, 1, 0, getPartitionBounds_arg3_121496) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool cond_121502 = slt32(calc_partitions_from_partitioned_set_res_121501, max_depth_115654);
    int64_t calc_partitions_from_partitioned_set_res_121503;
    int64_t calc_partitions_from_partitioned_set_res_121504;
    bool calc_partitions_from_partitioned_set_res_121505;
    int32_t calc_partitions_from_partitioned_set_res_121508;
    int64_t loop_dz2088U_121509;
    int64_t loop_dz2089U_121510;
    bool loop_while_121511;
    int32_t p_121514;
    
    if (memblock_set(ctx, &mem_param_133180, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133183, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    loop_dz2088U_121509 = calc_partitions_from_partitioned_set_res_121497;
    loop_dz2089U_121510 = calc_partitions_from_partitioned_set_res_121498;
    loop_while_121511 = cond_121502;
    p_121514 = calc_partitions_from_partitioned_set_res_121501;
    while (loop_while_121511) {
        int64_t zl_rhs_121517 = sub64(loop_dz2088U_121509, (int64_t) 1);
        int64_t bytes_133184 = (int64_t) 8 * loop_dz2088U_121509;
        
        if (mem_133185_cached_sizze_133657 < bytes_133184) {
            err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133657, bytes_133184);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133187_cached_sizze_133658 < bytes_133184) {
            err = lexical_realloc(ctx, &mem_133187, &mem_133187_cached_sizze_133658, bytes_133184);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133189_cached_sizze_133659 < bytes_133184) {
            err = lexical_realloc(ctx, &mem_133189, &mem_133189_cached_sizze_133659, bytes_133184);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133191_cached_sizze_133660 < bytes_133184) {
            err = lexical_realloc(ctx, &mem_133191, &mem_133191_cached_sizze_133660, bytes_133184);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_133054;
        int64_t scanacc_133044 = (int64_t) 0;
        
        for (int64_t i_133049 = 0; i_133049 < loop_dz2088U_121509; i_133049++) {
            int64_t tmp_128930 = ((int64_t *) mem_param_133180.mem)[i_133049];
            bool cond_128931 = slt64(i_133049, zl_rhs_121517);
            int64_t tmp_128932;
            
            if (cond_128931) {
                int64_t tmp_128970 = add64((int64_t) 1, i_133049);
                bool x_128971 = sle64((int64_t) 0, tmp_128970);
                bool y_128972 = slt64(tmp_128970, loop_dz2088U_121509);
                bool bounds_check_128973 = x_128971 && y_128972;
                bool index_certs_128974;
                
                if (!bounds_check_128973) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128970, "] out of bounds for array of shape [", (long long) loop_dz2088U_121509, "].", "-> #0  ftRelational.fut:246:55-62\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:234:1-271:32\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_t_res_128975 = ((int64_t *) mem_param_133180.mem)[tmp_128970];
                
                tmp_128932 = tmp_t_res_128975;
            } else {
                tmp_128932 = n_115648;
            }
            
            int64_t zg_lhs_128941 = sub64(tmp_128932, tmp_128930);
            bool lifted_lambda_res_128942 = slt64(sizze_thresh_115653, zg_lhs_128941);
            int64_t defunc_0_f_res_128943 = btoi_bool_i64(lifted_lambda_res_128942);
            int64_t defunc_0_op_res_121549 = add64(defunc_0_f_res_128943, scanacc_133044);
            
            ((int64_t *) mem_133185)[i_133049] = defunc_0_op_res_121549;
            ((int64_t *) mem_133187)[i_133049] = defunc_0_f_res_128943;
            ((int64_t *) mem_133189)[i_133049] = tmp_128930;
            ((int64_t *) mem_133191)[i_133049] = tmp_128932;
            
            int64_t scanacc_tmp_133525 = defunc_0_op_res_121549;
            
            scanacc_133044 = scanacc_tmp_133525;
        }
        discard_133054 = scanacc_133044;
        
        bool cond_121550 = loop_dz2088U_121509 == (int64_t) 0;
        bool x_121551 = !cond_121550;
        bool x_121553 = sle64((int64_t) 0, zl_rhs_121517);
        bool y_121554 = slt64(zl_rhs_121517, loop_dz2088U_121509);
        bool bounds_check_121555 = x_121553 && y_121554;
        bool protect_assert_disj_121556 = cond_121550 || bounds_check_121555;
        bool index_certs_121557;
        
        if (!protect_assert_disj_121556) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_121517, "] out of bounds for array of shape [", (long long) loop_dz2088U_121509, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:234:1-271:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t m_f_res_121558;
        
        if (x_121551) {
            int64_t x_128976 = ((int64_t *) mem_133185)[zl_rhs_121517];
            
            m_f_res_121558 = x_128976;
        } else {
            m_f_res_121558 = (int64_t) 0;
        }
        
        int64_t m_121560;
        
        if (cond_121550) {
            m_121560 = (int64_t) 0;
        } else {
            m_121560 = m_f_res_121558;
        }
        
        int64_t m_121570 = sub64(m_121560, (int64_t) 1);
        bool i_p_m_t_s_leq_w_121572 = slt64(m_121570, loop_dz2088U_121509);
        bool zzero_leq_i_p_m_t_s_121571 = sle64((int64_t) 0, m_121570);
        bool y_121574 = zzero_leq_i_p_m_t_s_121571 && i_p_m_t_s_leq_w_121572;
        bool i_lte_j_121573 = sle64((int64_t) 0, m_121560);
        bool forwards_ok_121575 = i_lte_j_121573 && y_121574;
        bool eq_x_zz_121567 = (int64_t) 0 == m_f_res_121558;
        bool p_and_eq_x_y_121568 = x_121551 && eq_x_zz_121567;
        bool empty_slice_121569 = cond_121550 || p_and_eq_x_y_121568;
        bool ok_or_empty_121576 = empty_slice_121569 || forwards_ok_121575;
        bool index_certs_121577;
        
        if (!ok_or_empty_121576) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_121560, "] out of bounds for array of shape [", (long long) loop_dz2088U_121509, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:234:1-271:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133216 = (int64_t) 8 * m_121560;
        
        if (mem_133217_cached_sizze_133661 < bytes_133216) {
            err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133661, bytes_133216);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133530 = 0; i_133530 < m_121560; i_133530++) {
            int64_t x_133531 = (int64_t) 0 + i_133530 * (int64_t) 1;
            
            ((int64_t *) mem_133217)[i_133530] = x_133531;
        }
        if (mem_133219_cached_sizze_133662 < bytes_133216) {
            err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133662, bytes_133216);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133191, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_121560});
        if (mem_133221_cached_sizze_133663 < bytes_133216) {
            err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133663, bytes_133216);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133221, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133189, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_121560});
        for (int64_t write_iter_133055 = 0; write_iter_133055 < loop_dz2088U_121509; write_iter_133055++) {
            int64_t write_iv_133059 = ((int64_t *) mem_133187)[write_iter_133055];
            int64_t write_iv_133060 = ((int64_t *) mem_133185)[write_iter_133055];
            int64_t write_iv_133061 = ((int64_t *) mem_133189)[write_iter_133055];
            int64_t write_iv_133062 = ((int64_t *) mem_133191)[write_iter_133055];
            bool cond_128912 = write_iv_133059 == (int64_t) 1;
            int64_t lifted_lambda_res_128913;
            
            if (cond_128912) {
                int64_t lifted_lambda_res_t_res_128977 = sub64(write_iv_133060, (int64_t) 1);
                
                lifted_lambda_res_128913 = lifted_lambda_res_t_res_128977;
            } else {
                lifted_lambda_res_128913 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_128913) && slt64(lifted_lambda_res_128913, m_121560)) {
                ((int64_t *) mem_133221)[lifted_lambda_res_128913] = write_iv_133061;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_128913) && slt64(lifted_lambda_res_128913, m_121560)) {
                ((int64_t *) mem_133219)[lifted_lambda_res_128913] = write_iv_133062;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_128913) && slt64(lifted_lambda_res_128913, m_121560)) {
                ((int64_t *) mem_133217)[lifted_lambda_res_128913] = write_iter_133055;
            }
        }
        
        int32_t new_i_121591 = mul32(radix_sizze_115650, p_121514);
        int32_t zt_rhs_121592 = add32(1, p_121514);
        int32_t zm_lhs_121593 = mul32(radix_sizze_115650, zt_rhs_121592);
        int32_t new_j_121594 = sub32(zm_lhs_121593, 1);
        int64_t loopres_121595;
        int64_t loopres_121596;
        int32_t loopres_121599;
        int64_t loopres_121600;
        int64_t loopres_121601;
        int64_t loop_dz2084Uz2089U_121603;
        int64_t loop_dz2085Uz2080U_121604;
        int32_t q_121607;
        int64_t ad_121608;
        int64_t ox_121609;
        
        if (memblock_set(ctx, &mem_param_133242, &mem_param_133180, "mem_param_133180") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133245, &mem_param_133183, "mem_param_133183") != 0)
            return 1;
        loop_dz2084Uz2089U_121603 = loop_dz2088U_121509;
        loop_dz2085Uz2080U_121604 = loop_dz2089U_121510;
        q_121607 = p_121514;
        ad_121608 = (int64_t) 0;
        ox_121609 = (int64_t) 0;
        for (int64_t i_121602 = 0; i_121602 < m_121560; i_121602++) {
            int64_t bounds_121610 = ((int64_t *) mem_133221)[i_121602];
            int64_t bounds_121611 = ((int64_t *) mem_133219)[i_121602];
            int64_t bounds_121612 = ((int64_t *) mem_133217)[i_121602];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_121613 = sub64(bounds_121611, bounds_121610);
            bool empty_slice_121614 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_121613 == (int64_t) 0;
            int64_t m_121615 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_121613, (int64_t) 1);
            int64_t i_p_m_t_s_121616 = add64(bounds_121610, m_121615);
            bool zzero_leq_i_p_m_t_s_121617 = sle64((int64_t) 0, i_p_m_t_s_121616);
            bool i_p_m_t_s_leq_w_121618 = slt64(i_p_m_t_s_121616, n_115648);
            bool zzero_lte_i_121619 = sle64((int64_t) 0, bounds_121610);
            bool i_lte_j_121620 = sle64(bounds_121610, bounds_121611);
            bool y_121621 = i_p_m_t_s_leq_w_121618 && zzero_lte_i_121619;
            bool y_121622 = zzero_leq_i_p_m_t_s_121617 && y_121621;
            bool forwards_ok_121623 = i_lte_j_121620 && y_121622;
            bool ok_or_empty_121624 = empty_slice_121614 || forwards_ok_121623;
            bool index_certs_121625;
            
            if (!ok_or_empty_121624) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_121610, ":", (long long) bounds_121611, "] out of bounds for array of shape [", (long long) n_115648, "].", "-> #0  ftRelational.fut:252:21-43\n   #1  ftRelational.fut:234:1-271:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133246 = b_115649 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_121613;
            
            if (memblock_alloc(ctx, &mem_133247, bytes_133246, "mem_133247")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133247.mem, (int64_t) 0, (int64_t []) {b_115649, (int64_t) 1}, (uint8_t *) pXs_mem_133175.mem, b_115649 * bounds_121610, (int64_t []) {b_115649, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_121613, b_115649});
            
            int64_t loopres_121629;
            int64_t loopres_121630;
            int32_t loopres_121633;
            
            if (futrts_getPartitionBounds_11872(ctx, &ext_mem_133250, &ext_mem_133249, &loopres_121629, &loopres_121630, &loopres_121633, mem_133247, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_121613, b_115649, zt_rhs_121592, new_i_121591, new_j_121594) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
                return 1;
            
            int64_t zm_lhs_121634 = add64(ox_121609, bounds_121612);
            int64_t stitch_121635 = sub64(zm_lhs_121634, ad_121608);
            bool empty_slice_121636 = stitch_121635 == (int64_t) 0;
            int64_t m_121637 = sub64(stitch_121635, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_121638 = sle64((int64_t) 0, m_121637);
            bool i_p_m_t_s_leq_w_121639 = slt64(m_121637, loop_dz2084Uz2089U_121603);
            bool i_lte_j_121640 = sle64((int64_t) 0, stitch_121635);
            bool y_121641 = zzero_leq_i_p_m_t_s_121638 && i_p_m_t_s_leq_w_121639;
            bool forwards_ok_121642 = i_lte_j_121640 && y_121641;
            bool ok_or_empty_121643 = empty_slice_121636 || forwards_ok_121642;
            bool index_certs_121644;
            
            if (!ok_or_empty_121643) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_121635, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_121603, "].", "-> #0  ftRelational.fut:260:18-36\n   #1  ftRelational.fut:234:1-271:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_121649 = loopres_121629 + stitch_121635;
            int64_t zpzp_rhs_121650 = add64((int64_t) 1, stitch_121635);
            int64_t j_m_i_121651 = sub64(loop_dz2084Uz2089U_121603, zpzp_rhs_121650);
            bool empty_slice_121652 = j_m_i_121651 == (int64_t) 0;
            int64_t m_121653 = sub64(j_m_i_121651, (int64_t) 1);
            int64_t i_p_m_t_s_121654 = add64(zpzp_rhs_121650, m_121653);
            bool zzero_leq_i_p_m_t_s_121655 = sle64((int64_t) 0, i_p_m_t_s_121654);
            bool i_p_m_t_s_leq_w_121656 = slt64(i_p_m_t_s_121654, loop_dz2084Uz2089U_121603);
            bool zzero_lte_i_121657 = sle64((int64_t) 0, zpzp_rhs_121650);
            bool i_lte_j_121658 = sle64(zpzp_rhs_121650, loop_dz2084Uz2089U_121603);
            bool y_121659 = i_p_m_t_s_leq_w_121656 && zzero_lte_i_121657;
            bool y_121660 = zzero_leq_i_p_m_t_s_121655 && y_121659;
            bool forwards_ok_121661 = i_lte_j_121658 && y_121660;
            bool ok_or_empty_121662 = empty_slice_121652 || forwards_ok_121661;
            bool index_certs_121663;
            
            if (!ok_or_empty_121662) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_121650, ":", (long long) loop_dz2084Uz2089U_121603, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_121603, "].", "-> #0  ftRelational.fut:260:90-126\n   #1  ftRelational.fut:234:1-271:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_121665 = conc_tmp_121649 + j_m_i_121651;
            int64_t bytes_133259 = (int64_t) 8 * conc_tmp_121665;
            bool i_p_m_t_s_leq_w_121667 = slt64(m_121637, loop_dz2085Uz2080U_121604);
            bool y_121668 = zzero_leq_i_p_m_t_s_121638 && i_p_m_t_s_leq_w_121667;
            bool ok_or_empty_121669 = empty_slice_121636 || y_121668;
            bool index_certs_121670;
            
            if (!ok_or_empty_121669) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_121635, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_121604, "].", "-> #0  ftRelational.fut:261:18-36\n   #1  ftRelational.fut:234:1-271:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_121672 = loopres_121630 + stitch_121635;
            int64_t j_m_i_121673 = sub64(loop_dz2085Uz2080U_121604, zpzp_rhs_121650);
            bool empty_slice_121674 = j_m_i_121673 == (int64_t) 0;
            int64_t m_121675 = sub64(j_m_i_121673, (int64_t) 1);
            int64_t i_p_m_t_s_121676 = add64(zpzp_rhs_121650, m_121675);
            bool zzero_leq_i_p_m_t_s_121677 = sle64((int64_t) 0, i_p_m_t_s_121676);
            bool i_p_m_t_s_leq_w_121678 = slt64(i_p_m_t_s_121676, loop_dz2085Uz2080U_121604);
            bool i_lte_j_121679 = sle64(zpzp_rhs_121650, loop_dz2085Uz2080U_121604);
            bool y_121680 = zzero_lte_i_121657 && i_p_m_t_s_leq_w_121678;
            bool y_121681 = zzero_leq_i_p_m_t_s_121677 && y_121680;
            bool forwards_ok_121682 = i_lte_j_121679 && y_121681;
            bool ok_or_empty_121683 = empty_slice_121674 || forwards_ok_121682;
            bool index_certs_121684;
            
            if (!ok_or_empty_121683) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_121650, ":", (long long) loop_dz2085Uz2080U_121604, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_121604, "].", "-> #0  ftRelational.fut:261:62-98\n   #1  ftRelational.fut:234:1-271:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_121686 = conc_tmp_121672 + j_m_i_121673;
            int64_t bytes_133261 = (int64_t) 4 * conc_tmp_121686;
            
            if (memblock_alloc(ctx, &mem_133260, bytes_133259, "mem_133260")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_133069 = 0; i_133069 < loopres_121629; i_133069++) {
                int64_t eta_p_121647 = ((int64_t *) ext_mem_133250.mem)[i_133069];
                int64_t lifted_lambda_res_121648 = add64(bounds_121610, eta_p_121647);
                
                ((int64_t *) mem_133260.mem)[stitch_121635 + i_133069] = lifted_lambda_res_121648;
            }
            if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
                return 1;
            
            int64_t tmp_offs_133545 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133260.mem, tmp_offs_133545, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133242.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_121635});
            tmp_offs_133545 += stitch_121635;
            if (!(tmp_offs_133545 == stitch_121635)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133260.mem, tmp_offs_133545, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133260.mem, stitch_121635, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_121629});
            }
            tmp_offs_133545 += loopres_121629;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133260.mem, tmp_offs_133545, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133242.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_121650, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_121651});
            tmp_offs_133545 += j_m_i_121651;
            if (memblock_alloc(ctx, &mem_133262, bytes_133261, "mem_133262")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_133546 = (int64_t) 0;
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133262.mem, tmp_offs_133546, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_121635});
            tmp_offs_133546 += stitch_121635;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133262.mem, tmp_offs_133546, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133249.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_121630});
            tmp_offs_133546 += loopres_121630;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133262.mem, tmp_offs_133546, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133245.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_121650, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_121673});
            tmp_offs_133546 += j_m_i_121673;
            if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
                return 1;
            
            int64_t tmp_121688 = add64((int64_t) 1, ad_121608);
            int64_t tmp_121689 = add64(ox_121609, loopres_121629);
            
            if (memblock_set(ctx, &mem_param_tmp_133535, &mem_133260, "mem_133260") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133536, &mem_133262, "mem_133262") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2089U_tmp_133537 = conc_tmp_121665;
            int64_t loop_dz2085Uz2080U_tmp_133538 = conc_tmp_121686;
            int32_t q_tmp_133541 = zt_rhs_121592;
            int64_t ad_tmp_133542 = tmp_121688;
            int64_t ox_tmp_133543 = tmp_121689;
            
            if (memblock_set(ctx, &mem_param_133242, &mem_param_tmp_133535, "mem_param_tmp_133535") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133245, &mem_param_tmp_133536, "mem_param_tmp_133536") != 0)
                return 1;
            loop_dz2084Uz2089U_121603 = loop_dz2084Uz2089U_tmp_133537;
            loop_dz2085Uz2080U_121604 = loop_dz2085Uz2080U_tmp_133538;
            q_121607 = q_tmp_133541;
            ad_121608 = ad_tmp_133542;
            ox_121609 = ox_tmp_133543;
        }
        if (memblock_set(ctx, &ext_mem_133268, &mem_param_133242, "mem_param_133242") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133267, &mem_param_133245, "mem_param_133245") != 0)
            return 1;
        loopres_121595 = loop_dz2084Uz2089U_121603;
        loopres_121596 = loop_dz2085Uz2080U_121604;
        loopres_121599 = q_121607;
        loopres_121600 = ad_121608;
        loopres_121601 = ox_121609;
        
        bool tmp_121690 = slt64((int64_t) 0, m_121560);
        bool cond_121691 = slt32(loopres_121599, max_depth_115654);
        bool x_121692 = tmp_121690 && cond_121691;
        
        if (memblock_set(ctx, &mem_param_tmp_133517, &ext_mem_133268, "ext_mem_133268") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133518, &ext_mem_133267, "ext_mem_133267") != 0)
            return 1;
        
        int64_t loop_dz2088U_tmp_133519 = loopres_121595;
        int64_t loop_dz2089U_tmp_133520 = loopres_121596;
        bool loop_while_tmp_133521 = x_121692;
        int32_t p_tmp_133524 = loopres_121599;
        
        if (memblock_set(ctx, &mem_param_133180, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133183, &mem_param_tmp_133518, "mem_param_tmp_133518") != 0)
            return 1;
        loop_dz2088U_121509 = loop_dz2088U_tmp_133519;
        loop_dz2089U_121510 = loop_dz2089U_tmp_133520;
        loop_while_121511 = loop_while_tmp_133521;
        p_121514 = p_tmp_133524;
    }
    if (memblock_set(ctx, &ext_mem_133274, &mem_param_133180, "mem_param_133180") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133273, &mem_param_133183, "mem_param_133183") != 0)
        return 1;
    calc_partitions_from_partitioned_set_res_121503 = loop_dz2088U_121509;
    calc_partitions_from_partitioned_set_res_121504 = loop_dz2089U_121510;
    calc_partitions_from_partitioned_set_res_121505 = loop_while_121511;
    calc_partitions_from_partitioned_set_res_121508 = p_121514;
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    
    int64_t bytes_133275 = (int64_t) 8 * calc_partitions_from_partitioned_set_res_121503;
    bool dim_match_121696 = calc_partitions_from_partitioned_set_res_121503 == calc_partitions_from_partitioned_set_res_121504;
    bool empty_or_match_cert_121697;
    
    if (!dim_match_121696) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) calc_partitions_from_partitioned_set_res_121504, "] cannot match shape of type `[", (long long) calc_partitions_from_partitioned_set_res_121503, "]i32`.", "-> #0  ftRelational.fut:269:14-54\n   #1  ftRelational.fut:234:1-271:32\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133276, bytes_133275, "mem_133276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133073 = 0; i_133073 < calc_partitions_from_partitioned_set_res_121503; i_133073++) {
        int64_t eta_p_121694 = ((int64_t *) ext_mem_133274.mem)[i_133073];
        int64_t lifted_lambda_res_121695 = add64(offset_115652, eta_p_121694);
        
        ((int64_t *) mem_133276.mem)[i_133073] = lifted_lambda_res_121695;
    }
    if (memblock_unref(ctx, &ext_mem_133274, "ext_mem_133274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133276, "mem_133276") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &ext_mem_133273, "ext_mem_133273") != 0)
        return 1;
    prim_out_133515 = calc_partitions_from_partitioned_set_res_121503;
    prim_out_133516 = calc_partitions_from_partitioned_set_res_121508;
    if (memblock_set(ctx, &*mem_out_p_133653, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133654, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    *out_prim_out_133655 = prim_out_133515;
    *out_prim_out_133656 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133185);
        free(mem_133187);
        free(mem_133189);
        free(mem_133191);
        free(mem_133217);
        free(mem_133219);
        free(mem_133221);
        if (memblock_unref(ctx, &mem_133276, "mem_133276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133518, "mem_param_tmp_133518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133536, "mem_param_tmp_133536") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133535, "mem_param_tmp_133535") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133262, "mem_133262") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133260, "mem_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133245, "mem_param_133245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133242, "mem_param_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133267, "ext_mem_133267") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133268, "ext_mem_133268") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133183, "mem_param_133183") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133180, "mem_param_133180") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133273, "ext_mem_133273") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133274, "ext_mem_133274") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_133664, struct memblock *mem_out_p_133665, int64_t *out_prim_out_133666, struct memblock pXs_mem_133175, struct memblock bounds_mem_133176, struct memblock depths_mem_133177, int64_t n_116366, int64_t b_116367, int64_t dz2080U_116368, int64_t dz2081U_116369, int32_t radix_sizze_116370, int32_t maxDepth_116374, int64_t scatter_psizze_116375)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133667 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133185_cached_sizze_133668 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133217_cached_sizze_133669 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133670 = 0;
    unsigned char *mem_133219 = NULL;
    struct memblock ext_mem_133243;
    
    ext_mem_133243.references = NULL;
    
    struct memblock mem_133241;
    
    mem_133241.references = NULL;
    
    struct memblock mem_133239;
    
    mem_133239.references = NULL;
    
    struct memblock ext_mem_133237;
    
    ext_mem_133237.references = NULL;
    
    struct memblock mem_133235;
    
    mem_133235.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock ext_mem_133212;
    
    ext_mem_133212.references = NULL;
    
    struct memblock ext_mem_133215;
    
    ext_mem_133215.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133515;
    int64_t bytes_133178 = (int64_t) 8 * dz2080U_116368;
    int64_t i32_res_121042 = sext_i32_i64(radix_sizze_116370);
    bool nonnegative_121043 = sle64((int64_t) 0, i32_res_121042);
    bool nonzzero_cert_121044;
    
    if (!nonnegative_121043) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftRelational.fut:298:78-83\n   #1  ftRelational.fut:273:1-300:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045 = shl64((int64_t) 1, i32_res_121042);
    int32_t getRadix_arg1_127855 = sub32(radix_sizze_116370, 1);
    int32_t i64_res_127856 = sext_i64_i32(b_116367);
    int32_t zm_lhs_127857 = mul32(8, i64_res_127856);
    int32_t min_arg1_127858 = sub32(zm_lhs_127857, 1);
    int32_t min_res_127859 = smin32(getRadix_arg1_127855, min_arg1_127858);
    int32_t i32_arg0_127863 = sub32(i64_res_127856, 1);
    int64_t i32_res_127864 = sext_i32_i64(i32_arg0_127863);
    int32_t zm_rhs_127866 = sdiv32(min_res_127859, 8);
    int32_t zm_lhs_127867 = sub32(i64_res_127856, zm_rhs_127866);
    int32_t i32_arg0_127868 = sub32(zm_lhs_127867, 1);
    int64_t i32_res_127869 = sext_i32_i64(i32_arg0_127868);
    int64_t zm_lhs_127870 = mul64((int64_t) 8, b_116367);
    int64_t min_arg1_127871 = sub64(zm_lhs_127870, (int64_t) 1);
    int64_t min_res_127872 = smin64(i32_res_127869, min_arg1_127871);
    bool x_127889 = sle64((int64_t) 0, i32_res_127864);
    bool y_127890 = slt64(i32_res_127864, b_116367);
    bool bounds_check_127891 = x_127889 && y_127890;
    bool index_certs_127892;
    
    if (!bounds_check_127891) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127864, "] out of bounds for array of shape [", (long long) b_116367, "].", "-> #0  ftHashJoin.fut:32:48-64\n   #1  ftHashJoin.fut:37:13-42\n   #2  ftRelational.fut:273:1-300:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_127900 = sle64((int64_t) 0, min_res_127872);
    bool y_127901 = slt64(min_res_127872, b_116367);
    bool bounds_check_127902 = x_127900 && y_127901;
    bool index_certs_127903;
    
    if (!bounds_check_127902) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_127872, "] out of bounds for array of shape [", (long long) b_116367, "].", "-> #0  ftHashJoin.fut:33:38-54\n   #1  ftHashJoin.fut:37:13-42\n   #2  ftRelational.fut:273:1-300:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_lhs_127911 = add32(8, radix_sizze_116370);
    int32_t zs_lhs_127912 = sub32(zm_lhs_127911, 1);
    int32_t i32_arg0_127913 = sdiv32(zs_lhs_127912, 8);
    int64_t i32_res_127914 = sext_i32_i64(i32_arg0_127913);
    bool bounds_invalid_upwards_127915 = slt64(i32_res_127914, (int64_t) 0);
    bool valid_127916 = !bounds_invalid_upwards_127915;
    bool range_valid_c_127917;
    
    if (!valid_127916) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) i32_res_127914, " is invalid.", "-> #0  ftHashJoin.fut:41:15-30\n   #1  ftRelational.fut:273:1-300:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133232 = (int64_t) 8 * dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133516 = 0; i_133516 < dz2080U_116368; i_133516++) {
        int64_t x_133517 = (int64_t) 0 + i_133516 * (int64_t) 1;
        
        ((int64_t *) mem_133179.mem)[i_133516] = x_133517;
    }
    
    int32_t lastBit_127874 = smod32(min_res_127859, 8);
    int32_t zm_lhs_127877 = sub32(8, lastBit_127874);
    int32_t i32_arg0_127878 = sub32(zm_lhs_127877, 1);
    int8_t unsign_arg0_127879 = zext_i32_i8(i32_arg0_127878);
    int8_t unsign_arg0_127880 = lshr8((int8_t) -1, unsign_arg0_127879);
    
    if (mem_133181_cached_sizze_133667 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133667, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133185_cached_sizze_133668 < b_116367) {
        err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133668, b_116367);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133046 = 0; i_133046 < dz2080U_116368; i_133046++) {
        int64_t radix_to_idx_arg1_121053 = ((int64_t *) bounds_mem_133176.mem)[i_133046];
        bool x_121054 = sle64((int64_t) 0, radix_to_idx_arg1_121053);
        bool y_121055 = slt64(radix_to_idx_arg1_121053, n_116366);
        bool bounds_check_121056 = x_121054 && y_121055;
        bool index_certs_121057;
        
        if (!bounds_check_121056) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_arg1_121053, "] out of bounds for array of shape [", (long long) n_116366, "].", "-> #0  ftRelational.fut:283:46-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:273:1-300:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_133042 = 0; i_133042 < b_116367; i_133042++) {
            int8_t eta_p_127884 = ((int8_t *) pXs_mem_133175.mem)[radix_to_idx_arg1_121053 * b_116367 + i_133042];
            bool cond_127885 = sle64(i_133042, i32_res_127864);
            bool cond_t_res_127886 = sle64(min_res_127872, i_133042);
            bool x_127887 = cond_127885 && cond_t_res_127886;
            int8_t lifted_lambda_res_127888;
            
            if (x_127887) {
                lifted_lambda_res_127888 = eta_p_127884;
            } else {
                lifted_lambda_res_127888 = (int8_t) 0;
            }
            ((int8_t *) mem_133185)[i_133042] = lifted_lambda_res_127888;
        }
        
        int8_t za_lhs_127893 = ((int8_t *) mem_133185)[i32_res_127864];
        int8_t mod1_x_127894 = (int8_t) -1 & za_lhs_127893;
        
        ((int8_t *) mem_133185)[i32_res_127864] = mod1_x_127894;
        
        int8_t za_lhs_127904 = ((int8_t *) mem_133185)[min_res_127872];
        int8_t tmp_127905 = unsign_arg0_127880 & za_lhs_127904;
        
        ((int8_t *) mem_133185)[min_res_127872] = tmp_127905;
        
        int64_t radix_to_idx_res_127918;
        int64_t y_127920 = (int64_t) 0;
        
        for (int64_t i_127919 = 0; i_127919 < i32_res_127914; i_127919++) {
            int64_t zm_lhs_127921 = sub64(b_116367, i_127919);
            int64_t u8_arg0_127922 = sub64(zm_lhs_127921, (int64_t) 1);
            bool x_127923 = sle64((int64_t) 0, u8_arg0_127922);
            bool y_127924 = slt64(u8_arg0_127922, b_116367);
            bool bounds_check_127925 = x_127923 && y_127924;
            bool index_certs_127926;
            
            if (!bounds_check_127925) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_arg0_127922, "] out of bounds for array of shape [", (long long) b_116367, "].", "-> #0  ftHashJoin.fut:42:23-33\n   #1  ftRelational.fut:273:1-300:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t u8_arg0_127927 = ((int8_t *) mem_133185)[u8_arg0_127922];
            int64_t u8_res_127928 = zext_i8_i64(u8_arg0_127927);
            int64_t zlzl_rhs_127929 = mul64((int64_t) 8, i_127919);
            int64_t r_127930 = shl64(u8_res_127928, zlzl_rhs_127929);
            int64_t loopres_127931 = y_127920 | r_127930;
            int64_t y_tmp_133520 = loopres_127931;
            
            y_127920 = y_tmp_133520;
        }
        radix_to_idx_res_127918 = y_127920;
        ((int64_t *) mem_133181)[i_133046] = radix_to_idx_res_127918;
    }
    
    bool cond_121063 = maxDepth_116374 == 1;
    
    if (cond_121063) {
        if (memblock_alloc(ctx, &mem_133209, dz2080U_116368, "mem_133209")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133521 = 0; nest_i_133521 < dz2080U_116368; nest_i_133521++) {
            ((bool *) mem_133209.mem)[nest_i_133521] = 1;
        }
        if (memblock_set(ctx, &ext_mem_133215, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133212, &mem_133209, "mem_133209") != 0)
            return 1;
    } else {
        int64_t zeze_rhs_121067 = sub64(dz2080U_116368, (int64_t) 1);
        
        if (memblock_alloc(ctx, &mem_133195, dz2080U_116368, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133196, dz2080U_116368, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133052 = 0; i_133052 < dz2080U_116368; i_133052++) {
            int64_t cur_i_121075 = ((int64_t *) mem_133181)[i_133052];
            bool cond_121076 = i_133052 == (int64_t) 0;
            int64_t pre_i_121077;
            
            if (cond_121076) {
                pre_i_121077 = (int64_t) -1;
            } else {
                int64_t tmp_121078 = sub64(i_133052, (int64_t) 1);
                bool x_121079 = sle64((int64_t) 0, tmp_121078);
                bool y_121080 = slt64(tmp_121078, dz2080U_116368);
                bool bounds_check_121081 = x_121079 && y_121080;
                bool index_certs_121082;
                
                if (!bounds_check_121081) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_121078, "] out of bounds for array of shape [", (long long) dz2080U_116368, "].", "-> #0  ftRelational.fut:290:42-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:288:10-295:8\n   #3  ftRelational.fut:273:1-300:86\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pre_i_f_res_121083 = ((int64_t *) mem_133181)[tmp_121078];
                
                pre_i_121077 = pre_i_f_res_121083;
            }
            
            bool is_first_121084 = cur_i_121075 == pre_i_121077;
            bool is_first_121085 = !is_first_121084;
            bool cond_121086 = i_133052 == zeze_rhs_121067;
            int64_t pos_i_121087;
            
            if (cond_121086) {
                pos_i_121087 = (int64_t) -1;
            } else {
                int64_t tmp_121088 = add64((int64_t) 1, i_133052);
                bool x_121089 = sle64((int64_t) 0, tmp_121088);
                bool y_121090 = slt64(tmp_121088, dz2080U_116368);
                bool bounds_check_121091 = x_121089 && y_121090;
                bool index_certs_121092;
                
                if (!bounds_check_121091) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_121088, "] out of bounds for array of shape [", (long long) dz2080U_116368, "].", "-> #0  ftRelational.fut:292:46-78\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:288:10-295:8\n   #3  ftRelational.fut:273:1-300:86\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pos_i_f_res_121093 = ((int64_t *) mem_133181)[tmp_121088];
                
                pos_i_121087 = pos_i_f_res_121093;
            }
            
            bool is_last_121094 = cur_i_121075 == pos_i_121087;
            bool is_last_121095 = !is_last_121094;
            
            ((bool *) mem_133195.mem)[i_133052] = is_first_121085;
            ((bool *) mem_133196.mem)[i_133052] = is_last_121095;
        }
        if (memblock_set(ctx, &ext_mem_133215, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133212, &mem_133196, "mem_133196") != 0)
            return 1;
    }
    if (mem_133217_cached_sizze_133669 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133669, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133219_cached_sizze_133670 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133670, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133059 = 0; i_133059 < dz2080U_116368; i_133059++) {
        bool eta_p_128907 = ((bool *) ext_mem_133215.mem)[i_133059];
        bool eta_p_128909 = ((bool *) ext_mem_133212.mem)[i_133059];
        int64_t lifted_lambda_res_128911;
        
        if (eta_p_128907) {
            int64_t lifted_lambda_res_t_res_128948 = ((int64_t *) mem_133181)[i_133059];
            
            lifted_lambda_res_128911 = lifted_lambda_res_t_res_128948;
        } else {
            lifted_lambda_res_128911 = (int64_t) -1;
        }
        
        int64_t lifted_lambda_res_128918;
        
        if (eta_p_128909) {
            int64_t lifted_lambda_res_t_res_128953 = ((int64_t *) mem_133181)[i_133059];
            
            lifted_lambda_res_128918 = lifted_lambda_res_t_res_128953;
        } else {
            lifted_lambda_res_128918 = (int64_t) -1;
        }
        ((int64_t *) mem_133217)[i_133059] = lifted_lambda_res_128918;
        ((int64_t *) mem_133219)[i_133059] = lifted_lambda_res_128911;
    }
    if (memblock_unref(ctx, &ext_mem_133212, "ext_mem_133212") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133215, "ext_mem_133215") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133233, bytes_133232, "mem_133233")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133526 = 0; nest_i_133526 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045; nest_i_133526++) {
        ((int64_t *) mem_133233.mem)[nest_i_133526] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133235, bytes_133178, "mem_133235")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2080U_116368});
    if (futrts_partitioned_scatter_11973(ctx, &ext_mem_133237, mem_133233, mem_133235, mem_133179, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045, dz2080U_116368, scatter_psizze_116375) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133239, bytes_133232, "mem_133239")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133527 = 0; nest_i_133527 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045; nest_i_133527++) {
        ((int64_t *) mem_133239.mem)[nest_i_133527] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133241, bytes_133178, "mem_133241")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133241.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2080U_116368});
    if (futrts_partitioned_scatter_11973(ctx, &ext_mem_133243, mem_133239, mem_133241, mem_133179, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045, dz2080U_116368, scatter_psizze_116375) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133239, "mem_133239") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133241, "mem_133241") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &ext_mem_133237, "ext_mem_133237") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &ext_mem_133243, "ext_mem_133243") != 0)
        return 1;
    prim_out_133515 = dzlz7bUZLztztZRz20U2z20Ursz7dUzg_121045;
    if (memblock_set(ctx, &*mem_out_p_133664, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133665, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    *out_prim_out_133666 = prim_out_133515;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133185);
        free(mem_133217);
        free(mem_133219);
        if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133241, "mem_133241") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133239, "mem_133239") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133237, "ext_mem_133237") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133212, "ext_mem_133212") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133215, "ext_mem_133215") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_133671, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_66322, int64_t dz2083U_66323, int64_t incr_66324, int64_t psizze_66325, int64_t pL_bytes_66327)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133220;
    
    mem_133220.references = NULL;
    
    struct memblock mem_param_tmp_133518;
    
    mem_param_tmp_133518.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock mem_133197;
    
    mem_133197.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_param_133193;
    
    mem_param_133193.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133217;
    
    ext_mem_133217.references = NULL;
    
    struct memblock ext_mem_133218;
    
    ext_mem_133218.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * niz2084U_66322;
    bool zzero_121184 = psizze_66325 == (int64_t) 0;
    bool nonzzero_121185 = !zzero_121184;
    bool nonzzero_cert_121186;
    
    if (!nonzzero_121185) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:52:1-53:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = niz2084U_66322 * pL_bytes_66327;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < niz2084U_66322; i_133042++) {
        int64_t eta_p_121180 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121181 = sub64(eta_p_121180, incr_66324);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121181;
    }
    
    int64_t zm_lhs_121182 = add64(dz2083U_66323, psizze_66325);
    int64_t zs_lhs_121183 = sub64(zm_lhs_121182, (int64_t) 1);
    int64_t m_121187 = sdiv64(zs_lhs_121183, psizze_66325);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < niz2084U_66322; nest_i_133515++) {
        for (int64_t nest_i_133516 = 0; nest_i_133516 < pL_bytes_66327; nest_i_133516++) {
            ((int8_t *) mem_133186.mem)[nest_i_133515 * pL_bytes_66327 + nest_i_133516] = (int8_t) 0;
        }
    }
    
    bool loop_cond_121189 = slt64((int64_t) 0, m_121187);
    bool partitioned_gather_res_121190;
    int64_t partitioned_gather_res_121193;
    bool loop_while_121194;
    int64_t p_121197;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133193, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121194 = loop_cond_121189;
    p_121197 = (int64_t) 0;
    while (loop_while_121194) {
        int64_t lower_bound_121198 = mul64(psizze_66325, p_121197);
        int64_t min_arg1_121199 = add64(psizze_66325, lower_bound_121198);
        int64_t min_res_121200 = smin64(dz2083U_66323, min_arg1_121199);
        int64_t j_m_i_121201 = sub64(min_res_121200, lower_bound_121198);
        bool empty_slice_121202 = j_m_i_121201 == (int64_t) 0;
        int64_t m_121203 = sub64(j_m_i_121201, (int64_t) 1);
        int64_t i_p_m_t_s_121204 = add64(lower_bound_121198, m_121203);
        bool zzero_leq_i_p_m_t_s_121205 = sle64((int64_t) 0, i_p_m_t_s_121204);
        bool i_p_m_t_s_leq_w_121206 = slt64(i_p_m_t_s_121204, dz2083U_66323);
        bool zzero_lte_i_121207 = sle64((int64_t) 0, lower_bound_121198);
        bool i_lte_j_121208 = sle64(lower_bound_121198, min_res_121200);
        bool y_121209 = i_p_m_t_s_leq_w_121206 && zzero_lte_i_121207;
        bool y_121210 = zzero_leq_i_p_m_t_s_121205 && y_121209;
        bool forwards_ok_121211 = i_lte_j_121208 && y_121210;
        bool ok_or_empty_121212 = empty_slice_121202 || forwards_ok_121211;
        bool index_certs_121213;
        
        if (!ok_or_empty_121212) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121198, ":", (long long) min_res_121200, "] out of bounds for array of shape [", (long long) dz2083U_66323, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:52:1-53:69\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133195, bytes_133177, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133195.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_66322});
        if (memblock_alloc(ctx, &mem_133197, bytes_133185, "mem_133197")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < niz2084U_66322; i_133046++) {
            int64_t eta_p_121216 = ((int64_t *) mem_param_133189.mem)[i_133046];
            bool cond_121218 = sle64(lower_bound_121198, eta_p_121216);
            bool cond_t_res_121219 = slt64(eta_p_121216, min_res_121200);
            bool x_121220 = cond_121218 && cond_t_res_121219;
            int64_t binop_y_133202 = pL_bytes_66327 * i_133046;
            int64_t lmad_ext_133204 = pL_bytes_66327 * eta_p_121216;
            int64_t ext_133206;
            
            if (x_121220) {
                ext_133206 = lmad_ext_133204;
            } else {
                ext_133206 = binop_y_133202;
            }
            if (x_121220) {
                int64_t tmp_128906 = sub64(eta_p_121216, lower_bound_121198);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121201);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121201, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:52:1-53:69\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_set(ctx, &ext_mem_133207, &ys_mem_133176, "ys_mem_133176") != 0)
                    return 1;
            } else if (memblock_set(ctx, &ext_mem_133207, &mem_param_133193, "mem_param_133193") != 0)
                return 1;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_133197.mem, i_133046 * pL_bytes_66327, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_133207.mem, ext_133206, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_bytes_66327});
            if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
                return 1;
        }
        
        int64_t tmp_121228 = add64((int64_t) 1, p_121197);
        bool loop_cond_121229 = slt64(tmp_121228, m_121187);
        
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133518, &mem_133197, "mem_133197") != 0)
            return 1;
        
        bool loop_while_tmp_133519 = loop_cond_121229;
        int64_t p_tmp_133522 = tmp_121228;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133193, &mem_param_tmp_133518, "mem_param_tmp_133518") != 0)
            return 1;
        loop_while_121194 = loop_while_tmp_133519;
        p_121197 = p_tmp_133522;
    }
    if (memblock_set(ctx, &ext_mem_133218, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133217, &mem_param_133193, "mem_param_133193") != 0)
        return 1;
    partitioned_gather_res_121190 = loop_while_121194;
    partitioned_gather_res_121193 = p_121197;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133220, bytes_133185, "mem_133220")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133220.mem, (int64_t) 0, (int64_t []) {pL_bytes_66327, (int64_t) 1}, (uint8_t *) ext_mem_133217.mem, (int64_t) 0, (int64_t []) {pL_bytes_66327, (int64_t) 1}, (int64_t []) {niz2084U_66322, pL_bytes_66327});
    if (memblock_unref(ctx, &ext_mem_133217, "ext_mem_133217") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133220, "mem_133220") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133671, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133220, "mem_133220") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133518, "mem_param_tmp_133518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133197, "mem_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133193, "mem_param_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133217, "ext_mem_133217") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133218, "ext_mem_133218") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_133672, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65858, int64_t dz2083U_65859, int64_t incr_65860, int64_t psizze_65861)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * niz2084U_65858;
    bool zzero_121182 = psizze_65861 == (int64_t) 0;
    bool nonzzero_121183 = !zzero_121182;
    bool nonzzero_cert_121184;
    
    if (!nonzzero_121183) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:50:5-41\n   #2  ftRelational.fut:49:1-50:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < niz2084U_65858; i_133042++) {
        int64_t eta_p_121178 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121179 = sub64(eta_p_121178, incr_65860);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121179;
    }
    
    int64_t zm_lhs_121180 = add64(dz2083U_65859, psizze_65861);
    int64_t zs_lhs_121181 = sub64(zm_lhs_121180, (int64_t) 1);
    int64_t m_121185 = sdiv64(zs_lhs_121181, psizze_65861);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133177, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < niz2084U_65858; nest_i_133515++) {
        ((double *) mem_133186.mem)[nest_i_133515] = 0.0;
    }
    
    bool loop_cond_121187 = slt64((int64_t) 0, m_121185);
    bool partitioned_gather_res_121188;
    int64_t partitioned_gather_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_65861, p_121195);
        int64_t min_arg1_121197 = add64(psizze_65861, lower_bound_121196);
        int64_t min_res_121198 = smin64(dz2083U_65859, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, dz2083U_65859);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) dz2083U_65859, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:50:5-41\n   #2  ftRelational.fut:49:1-50:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65858});
        if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < niz2084U_65858; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133189.mem)[i_133046];
            double eta_p_121215 = ((double *) mem_param_133192.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            double lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:50:5-41\n   #4  ftRelational.fut:49:1-50:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double tmp_128911 = ((double *) ys_mem_133176.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((double *) mem_133196.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121185);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121227;
        int64_t p_tmp_133521 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133518;
        p_121195 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121188 = loop_while_121192;
    partitioned_gather_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133177, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65858});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133672, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133673, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_67830, int64_t n_67831, int64_t incr_67832, int64_t psizze_67833)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_param_tmp_133515;
    
    mem_param_tmp_133515.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_133193;
    
    mem_133193.references = NULL;
    
    struct memblock mem_param_133191;
    
    mem_param_133191.references = NULL;
    
    struct memblock mem_param_133188;
    
    mem_param_133188.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133178 = (int64_t) 8 * ni_67830;
    bool zzero_121183 = psizze_67833 == (int64_t) 0;
    bool nonzzero_121184 = !zzero_121183;
    bool nonzzero_cert_121185;
    
    if (!nonzzero_121184) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:64:5-50\n   #2  ftRelational.fut:63:1-64:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < ni_67830; i_133042++) {
        int64_t eta_p_121179 = ((int64_t *) is_mem_133176.mem)[i_133042];
        int64_t lifted_lambda_res_121180 = sub64(eta_p_121179, incr_67832);
        
        ((int64_t *) mem_133179.mem)[i_133042] = lifted_lambda_res_121180;
    }
    
    int64_t zm_lhs_121181 = add64(n_67831, psizze_67833);
    int64_t zs_lhs_121182 = sub64(zm_lhs_121181, (int64_t) 1);
    int64_t m_121186 = sdiv64(zs_lhs_121182, psizze_67833);
    bool loop_cond_121187 = slt64((int64_t) 0, m_121186);
    bool partitioned_gather_over_array_res_121188;
    int64_t partitioned_gather_over_array_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133188, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133191, &preVals_mem_133175, "preVals_mem_133175") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_67833, p_121195);
        int64_t min_arg1_121197 = add64(psizze_67833, lower_bound_121196);
        int64_t min_res_121198 = smin64(n_67831, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, n_67831);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) n_67831, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:64:5-50\n   #2  ftRelational.fut:63:1-64:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133193, bytes_133178, "mem_133193")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133193.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133188.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_67830});
        if (memblock_alloc(ctx, &mem_133195, bytes_133178, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < ni_67830; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133188.mem)[i_133046];
            double eta_p_121215 = ((double *) mem_param_133191.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            double lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:64:5-50\n   #4  ftRelational.fut:63:1-64:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double tmp_128911 = ((double *) ys_mem_133177.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((double *) mem_133195.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121186);
        
        if (memblock_set(ctx, &mem_param_tmp_133515, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133195, "mem_133195") != 0)
            return 1;
        
        bool loop_while_tmp_133517 = loop_cond_121227;
        int64_t p_tmp_133520 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133188, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133191, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133517;
        p_121195 = p_tmp_133520;
    }
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133188, "mem_param_133188") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133206, &mem_param_133191, "mem_param_133191") != 0)
        return 1;
    partitioned_gather_over_array_res_121188 = loop_while_121192;
    partitioned_gather_over_array_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133209, bytes_133178, "mem_133209")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133206.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_67830});
    if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133209, "mem_133209") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133673, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133191, "mem_param_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133188, "mem_param_133188") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_133674, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65578, int64_t dz2083U_65579, int64_t incr_65580, int64_t psizze_65581)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * niz2084U_65578;
    bool zzero_121182 = psizze_65581 == (int64_t) 0;
    bool nonzzero_121183 = !zzero_121182;
    bool nonzzero_cert_121184;
    
    if (!nonzzero_121183) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:48:5-41\n   #2  ftRelational.fut:47:1-48:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = (int64_t) 4 * niz2084U_65578;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < niz2084U_65578; i_133042++) {
        int64_t eta_p_121178 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121179 = sub64(eta_p_121178, incr_65580);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121179;
    }
    
    int64_t zm_lhs_121180 = add64(dz2083U_65579, psizze_65581);
    int64_t zs_lhs_121181 = sub64(zm_lhs_121180, (int64_t) 1);
    int64_t m_121185 = sdiv64(zs_lhs_121181, psizze_65581);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < niz2084U_65578; nest_i_133515++) {
        ((float *) mem_133186.mem)[nest_i_133515] = 0.0F;
    }
    
    bool loop_cond_121187 = slt64((int64_t) 0, m_121185);
    bool partitioned_gather_res_121188;
    int64_t partitioned_gather_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_65581, p_121195);
        int64_t min_arg1_121197 = add64(psizze_65581, lower_bound_121196);
        int64_t min_res_121198 = smin64(dz2083U_65579, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, dz2083U_65579);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) dz2083U_65579, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:48:5-41\n   #2  ftRelational.fut:47:1-48:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65578});
        if (memblock_alloc(ctx, &mem_133196, bytes_133185, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < niz2084U_65578; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133189.mem)[i_133046];
            float eta_p_121215 = ((float *) mem_param_133192.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            float lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:48:5-41\n   #4  ftRelational.fut:47:1-48:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float tmp_128911 = ((float *) ys_mem_133176.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((float *) mem_133196.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121185);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121227;
        int64_t p_tmp_133521 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133518;
        p_121195 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121188 = loop_while_121192;
    partitioned_gather_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133185, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65578});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133674, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133675, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_67529, int64_t n_67530, int64_t incr_67531, int64_t psizze_67532)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_param_tmp_133515;
    
    mem_param_tmp_133515.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_133193;
    
    mem_133193.references = NULL;
    
    struct memblock mem_param_133191;
    
    mem_param_133191.references = NULL;
    
    struct memblock mem_param_133188;
    
    mem_param_133188.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133178 = (int64_t) 8 * ni_67529;
    bool zzero_121183 = psizze_67532 == (int64_t) 0;
    bool nonzzero_121184 = !zzero_121183;
    bool nonzzero_cert_121185;
    
    if (!nonzzero_121184) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:62:5-50\n   #2  ftRelational.fut:61:1-62:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133208 = (int64_t) 4 * ni_67529;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < ni_67529; i_133042++) {
        int64_t eta_p_121179 = ((int64_t *) is_mem_133176.mem)[i_133042];
        int64_t lifted_lambda_res_121180 = sub64(eta_p_121179, incr_67531);
        
        ((int64_t *) mem_133179.mem)[i_133042] = lifted_lambda_res_121180;
    }
    
    int64_t zm_lhs_121181 = add64(n_67530, psizze_67532);
    int64_t zs_lhs_121182 = sub64(zm_lhs_121181, (int64_t) 1);
    int64_t m_121186 = sdiv64(zs_lhs_121182, psizze_67532);
    bool loop_cond_121187 = slt64((int64_t) 0, m_121186);
    bool partitioned_gather_over_array_res_121188;
    int64_t partitioned_gather_over_array_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133188, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133191, &preVals_mem_133175, "preVals_mem_133175") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_67532, p_121195);
        int64_t min_arg1_121197 = add64(psizze_67532, lower_bound_121196);
        int64_t min_res_121198 = smin64(n_67530, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, n_67530);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) n_67530, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:62:5-50\n   #2  ftRelational.fut:61:1-62:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133193, bytes_133178, "mem_133193")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133193.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133188.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_67529});
        if (memblock_alloc(ctx, &mem_133195, bytes_133208, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < ni_67529; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133188.mem)[i_133046];
            float eta_p_121215 = ((float *) mem_param_133191.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            float lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:62:5-50\n   #4  ftRelational.fut:61:1-62:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float tmp_128911 = ((float *) ys_mem_133177.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((float *) mem_133195.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121186);
        
        if (memblock_set(ctx, &mem_param_tmp_133515, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133195, "mem_133195") != 0)
            return 1;
        
        bool loop_while_tmp_133517 = loop_cond_121227;
        int64_t p_tmp_133520 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133188, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133191, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133517;
        p_121195 = p_tmp_133520;
    }
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133188, "mem_param_133188") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133206, &mem_param_133191, "mem_param_133191") != 0)
        return 1;
    partitioned_gather_over_array_res_121188 = loop_while_121192;
    partitioned_gather_over_array_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133209, bytes_133208, "mem_133209")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133206.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_67529});
    if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133209, "mem_133209") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133675, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133191, "mem_param_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133188, "mem_param_133188") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_133676, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65018, int64_t dz2083U_65019, int64_t incr_65020, int64_t psizze_65021)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * niz2084U_65018;
    bool zzero_121182 = psizze_65021 == (int64_t) 0;
    bool nonzzero_121183 = !zzero_121182;
    bool nonzzero_cert_121184;
    
    if (!nonzzero_121183) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:44:5-41\n   #2  ftRelational.fut:43:1-44:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = (int64_t) 4 * niz2084U_65018;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < niz2084U_65018; i_133042++) {
        int64_t eta_p_121178 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121179 = sub64(eta_p_121178, incr_65020);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121179;
    }
    
    int64_t zm_lhs_121180 = add64(dz2083U_65019, psizze_65021);
    int64_t zs_lhs_121181 = sub64(zm_lhs_121180, (int64_t) 1);
    int64_t m_121185 = sdiv64(zs_lhs_121181, psizze_65021);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < niz2084U_65018; nest_i_133515++) {
        ((int32_t *) mem_133186.mem)[nest_i_133515] = 0;
    }
    
    bool loop_cond_121187 = slt64((int64_t) 0, m_121185);
    bool partitioned_gather_res_121188;
    int64_t partitioned_gather_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_65021, p_121195);
        int64_t min_arg1_121197 = add64(psizze_65021, lower_bound_121196);
        int64_t min_res_121198 = smin64(dz2083U_65019, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, dz2083U_65019);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) dz2083U_65019, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:44:5-41\n   #2  ftRelational.fut:43:1-44:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65018});
        if (memblock_alloc(ctx, &mem_133196, bytes_133185, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < niz2084U_65018; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133189.mem)[i_133046];
            int32_t eta_p_121215 = ((int32_t *) mem_param_133192.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            int32_t lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:44:5-41\n   #4  ftRelational.fut:43:1-44:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t tmp_128911 = ((int32_t *) ys_mem_133176.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((int32_t *) mem_133196.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121185);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121227;
        int64_t p_tmp_133521 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133518;
        p_121195 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121188 = loop_while_121192;
    partitioned_gather_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133185, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65018});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133676, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133677, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_66927, int64_t n_66928, int64_t incr_66929, int64_t psizze_66930)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_param_tmp_133515;
    
    mem_param_tmp_133515.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_133193;
    
    mem_133193.references = NULL;
    
    struct memblock mem_param_133191;
    
    mem_param_133191.references = NULL;
    
    struct memblock mem_param_133188;
    
    mem_param_133188.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133178 = (int64_t) 8 * ni_66927;
    bool zzero_121183 = psizze_66930 == (int64_t) 0;
    bool nonzzero_121184 = !zzero_121183;
    bool nonzzero_cert_121185;
    
    if (!nonzzero_121184) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:58:5-50\n   #2  ftRelational.fut:57:1-58:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133208 = (int64_t) 4 * ni_66927;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < ni_66927; i_133042++) {
        int64_t eta_p_121179 = ((int64_t *) is_mem_133176.mem)[i_133042];
        int64_t lifted_lambda_res_121180 = sub64(eta_p_121179, incr_66929);
        
        ((int64_t *) mem_133179.mem)[i_133042] = lifted_lambda_res_121180;
    }
    
    int64_t zm_lhs_121181 = add64(n_66928, psizze_66930);
    int64_t zs_lhs_121182 = sub64(zm_lhs_121181, (int64_t) 1);
    int64_t m_121186 = sdiv64(zs_lhs_121182, psizze_66930);
    bool loop_cond_121187 = slt64((int64_t) 0, m_121186);
    bool partitioned_gather_over_array_res_121188;
    int64_t partitioned_gather_over_array_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133188, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133191, &preVals_mem_133175, "preVals_mem_133175") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_66930, p_121195);
        int64_t min_arg1_121197 = add64(psizze_66930, lower_bound_121196);
        int64_t min_res_121198 = smin64(n_66928, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, n_66928);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) n_66928, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:58:5-50\n   #2  ftRelational.fut:57:1-58:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133193, bytes_133178, "mem_133193")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133193.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133188.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_66927});
        if (memblock_alloc(ctx, &mem_133195, bytes_133208, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < ni_66927; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133188.mem)[i_133046];
            int32_t eta_p_121215 = ((int32_t *) mem_param_133191.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            int32_t lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:58:5-50\n   #4  ftRelational.fut:57:1-58:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t tmp_128911 = ((int32_t *) ys_mem_133177.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((int32_t *) mem_133195.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121186);
        
        if (memblock_set(ctx, &mem_param_tmp_133515, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133195, "mem_133195") != 0)
            return 1;
        
        bool loop_while_tmp_133517 = loop_cond_121227;
        int64_t p_tmp_133520 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133188, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133191, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133517;
        p_121195 = p_tmp_133520;
    }
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133188, "mem_param_133188") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133206, &mem_param_133191, "mem_param_133191") != 0)
        return 1;
    partitioned_gather_over_array_res_121188 = loop_while_121192;
    partitioned_gather_over_array_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133209, bytes_133208, "mem_133209")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133206.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_66927});
    if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133209, "mem_133209") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133677, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133191, "mem_param_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133188, "mem_param_133188") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_133678, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_65298, int64_t dz2083U_65299, int64_t incr_65300, int64_t psizze_65301)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * niz2084U_65298;
    bool zzero_121182 = psizze_65301 == (int64_t) 0;
    bool nonzzero_121183 = !zzero_121182;
    bool nonzzero_cert_121184;
    
    if (!nonzzero_121183) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:46:5-41\n   #2  ftRelational.fut:45:1-46:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < niz2084U_65298; i_133042++) {
        int64_t eta_p_121178 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121179 = sub64(eta_p_121178, incr_65300);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121179;
    }
    
    int64_t zm_lhs_121180 = add64(dz2083U_65299, psizze_65301);
    int64_t zs_lhs_121181 = sub64(zm_lhs_121180, (int64_t) 1);
    int64_t m_121185 = sdiv64(zs_lhs_121181, psizze_65301);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133177, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < niz2084U_65298; nest_i_133515++) {
        ((int64_t *) mem_133186.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    bool loop_cond_121187 = slt64((int64_t) 0, m_121185);
    bool partitioned_gather_res_121188;
    int64_t partitioned_gather_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_65301, p_121195);
        int64_t min_arg1_121197 = add64(psizze_65301, lower_bound_121196);
        int64_t min_res_121198 = smin64(dz2083U_65299, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, dz2083U_65299);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) dz2083U_65299, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:46:5-41\n   #2  ftRelational.fut:45:1-46:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65298});
        if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < niz2084U_65298; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133189.mem)[i_133046];
            int64_t eta_p_121215 = ((int64_t *) mem_param_133192.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            int64_t lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:46:5-41\n   #4  ftRelational.fut:45:1-46:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_128911 = ((int64_t *) ys_mem_133176.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((int64_t *) mem_133196.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121185);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121227;
        int64_t p_tmp_133521 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133518;
        p_121195 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121188 = loop_while_121192;
    partitioned_gather_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133177, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_65298});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133678, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133679, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_67228, int64_t n_67229, int64_t incr_67230, int64_t psizze_67231)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_param_tmp_133515;
    
    mem_param_tmp_133515.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_133193;
    
    mem_133193.references = NULL;
    
    struct memblock mem_param_133191;
    
    mem_param_133191.references = NULL;
    
    struct memblock mem_param_133188;
    
    mem_param_133188.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133178 = (int64_t) 8 * ni_67228;
    bool zzero_121183 = psizze_67231 == (int64_t) 0;
    bool nonzzero_121184 = !zzero_121183;
    bool nonzzero_cert_121185;
    
    if (!nonzzero_121184) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:60:5-50\n   #2  ftRelational.fut:59:1-60:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < ni_67228; i_133042++) {
        int64_t eta_p_121179 = ((int64_t *) is_mem_133176.mem)[i_133042];
        int64_t lifted_lambda_res_121180 = sub64(eta_p_121179, incr_67230);
        
        ((int64_t *) mem_133179.mem)[i_133042] = lifted_lambda_res_121180;
    }
    
    int64_t zm_lhs_121181 = add64(n_67229, psizze_67231);
    int64_t zs_lhs_121182 = sub64(zm_lhs_121181, (int64_t) 1);
    int64_t m_121186 = sdiv64(zs_lhs_121182, psizze_67231);
    bool loop_cond_121187 = slt64((int64_t) 0, m_121186);
    bool partitioned_gather_over_array_res_121188;
    int64_t partitioned_gather_over_array_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133188, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133191, &preVals_mem_133175, "preVals_mem_133175") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_67231, p_121195);
        int64_t min_arg1_121197 = add64(psizze_67231, lower_bound_121196);
        int64_t min_res_121198 = smin64(n_67229, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, n_67229);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) n_67229, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:60:5-50\n   #2  ftRelational.fut:59:1-60:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133193, bytes_133178, "mem_133193")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133193.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133188.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_67228});
        if (memblock_alloc(ctx, &mem_133195, bytes_133178, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < ni_67228; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133188.mem)[i_133046];
            int64_t eta_p_121215 = ((int64_t *) mem_param_133191.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            int64_t lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:60:5-50\n   #4  ftRelational.fut:59:1-60:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_128911 = ((int64_t *) ys_mem_133177.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((int64_t *) mem_133195.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121186);
        
        if (memblock_set(ctx, &mem_param_tmp_133515, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133195, "mem_133195") != 0)
            return 1;
        
        bool loop_while_tmp_133517 = loop_cond_121227;
        int64_t p_tmp_133520 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133188, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133191, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133517;
        p_121195 = p_tmp_133520;
    }
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133188, "mem_param_133188") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133206, &mem_param_133191, "mem_param_133191") != 0)
        return 1;
    partitioned_gather_over_array_res_121188 = loop_while_121192;
    partitioned_gather_over_array_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133209, bytes_133178, "mem_133209")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133206.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_67228});
    if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133209, "mem_133209") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133679, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133191, "mem_param_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133188, "mem_param_133188") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_133680, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t niz2084U_64738, int64_t dz2083U_64739, int64_t incr_64740, int64_t psizze_64741)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * niz2084U_64738;
    bool zzero_121182 = psizze_64741 == (int64_t) 0;
    bool nonzzero_121183 = !zzero_121182;
    bool nonzzero_cert_121184;
    
    if (!nonzzero_121183) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:42:5-41\n   #2  ftRelational.fut:41:1-42:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = (int64_t) 2 * niz2084U_64738;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < niz2084U_64738; i_133042++) {
        int64_t eta_p_121178 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121179 = sub64(eta_p_121178, incr_64740);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121179;
    }
    
    int64_t zm_lhs_121180 = add64(dz2083U_64739, psizze_64741);
    int64_t zs_lhs_121181 = sub64(zm_lhs_121180, (int64_t) 1);
    int64_t m_121185 = sdiv64(zs_lhs_121181, psizze_64741);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < niz2084U_64738; nest_i_133515++) {
        ((int16_t *) mem_133186.mem)[nest_i_133515] = (int16_t) 0;
    }
    
    bool loop_cond_121187 = slt64((int64_t) 0, m_121185);
    bool partitioned_gather_res_121188;
    int64_t partitioned_gather_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_64741, p_121195);
        int64_t min_arg1_121197 = add64(psizze_64741, lower_bound_121196);
        int64_t min_res_121198 = smin64(dz2083U_64739, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, dz2083U_64739);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) dz2083U_64739, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:42:5-41\n   #2  ftRelational.fut:41:1-42:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_64738});
        if (memblock_alloc(ctx, &mem_133196, bytes_133185, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < niz2084U_64738; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133189.mem)[i_133046];
            int16_t eta_p_121215 = ((int16_t *) mem_param_133192.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            int16_t lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:42:5-41\n   #4  ftRelational.fut:41:1-42:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t tmp_128911 = ((int16_t *) ys_mem_133176.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((int16_t *) mem_133196.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121185);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121227;
        int64_t p_tmp_133521 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133518;
        p_121195 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121188 = loop_while_121192;
    partitioned_gather_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133185, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_64738});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133680, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133681, struct memblock preVals_mem_133175, struct memblock is_mem_133176, struct memblock ys_mem_133177, int64_t ni_66626, int64_t n_66627, int64_t incr_66628, int64_t psizze_66629)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_param_tmp_133515;
    
    mem_param_tmp_133515.references = NULL;
    
    struct memblock mem_133195;
    
    mem_133195.references = NULL;
    
    struct memblock mem_133193;
    
    mem_133193.references = NULL;
    
    struct memblock mem_param_133191;
    
    mem_param_133191.references = NULL;
    
    struct memblock mem_param_133188;
    
    mem_param_133188.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133178 = (int64_t) 8 * ni_66626;
    bool zzero_121183 = psizze_66629 == (int64_t) 0;
    bool nonzzero_121184 = !zzero_121183;
    bool nonzzero_cert_121185;
    
    if (!nonzzero_121184) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:56:5-50\n   #2  ftRelational.fut:55:1-56:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133208 = (int64_t) 2 * ni_66626;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < ni_66626; i_133042++) {
        int64_t eta_p_121179 = ((int64_t *) is_mem_133176.mem)[i_133042];
        int64_t lifted_lambda_res_121180 = sub64(eta_p_121179, incr_66628);
        
        ((int64_t *) mem_133179.mem)[i_133042] = lifted_lambda_res_121180;
    }
    
    int64_t zm_lhs_121181 = add64(n_66627, psizze_66629);
    int64_t zs_lhs_121182 = sub64(zm_lhs_121181, (int64_t) 1);
    int64_t m_121186 = sdiv64(zs_lhs_121182, psizze_66629);
    bool loop_cond_121187 = slt64((int64_t) 0, m_121186);
    bool partitioned_gather_over_array_res_121188;
    int64_t partitioned_gather_over_array_res_121191;
    bool loop_while_121192;
    int64_t p_121195;
    
    if (memblock_set(ctx, &mem_param_133188, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133191, &preVals_mem_133175, "preVals_mem_133175") != 0)
        return 1;
    loop_while_121192 = loop_cond_121187;
    p_121195 = (int64_t) 0;
    while (loop_while_121192) {
        int64_t lower_bound_121196 = mul64(psizze_66629, p_121195);
        int64_t min_arg1_121197 = add64(psizze_66629, lower_bound_121196);
        int64_t min_res_121198 = smin64(n_66627, min_arg1_121197);
        int64_t j_m_i_121199 = sub64(min_res_121198, lower_bound_121196);
        bool empty_slice_121200 = j_m_i_121199 == (int64_t) 0;
        int64_t m_121201 = sub64(j_m_i_121199, (int64_t) 1);
        int64_t i_p_m_t_s_121202 = add64(lower_bound_121196, m_121201);
        bool zzero_leq_i_p_m_t_s_121203 = sle64((int64_t) 0, i_p_m_t_s_121202);
        bool i_p_m_t_s_leq_w_121204 = slt64(i_p_m_t_s_121202, n_66627);
        bool zzero_lte_i_121205 = sle64((int64_t) 0, lower_bound_121196);
        bool i_lte_j_121206 = sle64(lower_bound_121196, min_res_121198);
        bool y_121207 = i_p_m_t_s_leq_w_121204 && zzero_lte_i_121205;
        bool y_121208 = zzero_leq_i_p_m_t_s_121203 && y_121207;
        bool forwards_ok_121209 = i_lte_j_121206 && y_121208;
        bool ok_or_empty_121210 = empty_slice_121200 || forwards_ok_121209;
        bool index_certs_121211;
        
        if (!ok_or_empty_121210) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121196, ":", (long long) min_res_121198, "] out of bounds for array of shape [", (long long) n_66627, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:56:5-50\n   #2  ftRelational.fut:55:1-56:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133193, bytes_133178, "mem_133193")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133193.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133188.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_66626});
        if (memblock_alloc(ctx, &mem_133195, bytes_133208, "mem_133195")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < ni_66626; i_133046++) {
            int64_t eta_p_121214 = ((int64_t *) mem_param_133188.mem)[i_133046];
            int16_t eta_p_121215 = ((int16_t *) mem_param_133191.mem)[i_133046];
            bool cond_121216 = sle64(lower_bound_121196, eta_p_121214);
            bool cond_t_res_121217 = slt64(eta_p_121214, min_res_121198);
            bool x_121218 = cond_121216 && cond_t_res_121217;
            int16_t lifted_lambda_res_121219;
            
            if (x_121218) {
                int64_t tmp_128906 = sub64(eta_p_121214, lower_bound_121196);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121199);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121199, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:56:5-50\n   #4  ftRelational.fut:55:1-56:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t tmp_128911 = ((int16_t *) ys_mem_133177.mem)[eta_p_121214];
                
                lifted_lambda_res_121219 = tmp_128911;
            } else {
                lifted_lambda_res_121219 = eta_p_121215;
            }
            ((int16_t *) mem_133195.mem)[i_133046] = lifted_lambda_res_121219;
        }
        
        int64_t tmp_121226 = add64((int64_t) 1, p_121195);
        bool loop_cond_121227 = slt64(tmp_121226, m_121186);
        
        if (memblock_set(ctx, &mem_param_tmp_133515, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133195, "mem_133195") != 0)
            return 1;
        
        bool loop_while_tmp_133517 = loop_cond_121227;
        int64_t p_tmp_133520 = tmp_121226;
        
        if (memblock_set(ctx, &mem_param_133188, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133191, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        loop_while_121192 = loop_while_tmp_133517;
        p_121195 = p_tmp_133520;
    }
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133188, "mem_param_133188") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133206, &mem_param_133191, "mem_param_133191") != 0)
        return 1;
    partitioned_gather_over_array_res_121188 = loop_while_121192;
    partitioned_gather_over_array_res_121191 = p_121195;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133209, bytes_133208, "mem_133209")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133206.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_66626});
    if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133209, "mem_133209") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133681, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133515, "mem_param_tmp_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133195, "mem_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133193, "mem_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133191, "mem_param_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133188, "mem_param_133188") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_133682, struct memblock *mem_out_p_133683, struct memblock *mem_out_p_133684, int64_t *out_prim_out_133685, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_110890, int64_t nS_110891, int64_t offset_R_110894, int64_t offset_S_110895, int64_t partitionSizze_110896, int64_t scatter_psizze_110897)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133243_cached_sizze_133686 = 0;
    unsigned char *mem_133243 = NULL;
    int64_t mem_133245_cached_sizze_133687 = 0;
    unsigned char *mem_133245 = NULL;
    int64_t mem_133247_cached_sizze_133688 = 0;
    unsigned char *mem_133247 = NULL;
    int64_t mem_133249_cached_sizze_133689 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133251_cached_sizze_133690 = 0;
    unsigned char *mem_133251 = NULL;
    int64_t mem_133253_cached_sizze_133691 = 0;
    unsigned char *mem_133253 = NULL;
    int64_t mem_133255_cached_sizze_133692 = 0;
    unsigned char *mem_133255 = NULL;
    int64_t mem_133299_cached_sizze_133693 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133331_cached_sizze_133694 = 0;
    unsigned char *mem_133331 = NULL;
    int64_t mem_133333_cached_sizze_133695 = 0;
    unsigned char *mem_133333 = NULL;
    struct memblock mem_133393;
    
    mem_133393.references = NULL;
    
    struct memblock mem_133391;
    
    mem_133391.references = NULL;
    
    struct memblock mem_133389;
    
    mem_133389.references = NULL;
    
    struct memblock mem_param_tmp_133569;
    
    mem_param_tmp_133569.references = NULL;
    
    struct memblock mem_param_tmp_133568;
    
    mem_param_tmp_133568.references = NULL;
    
    struct memblock mem_param_tmp_133567;
    
    mem_param_tmp_133567.references = NULL;
    
    struct memblock mem_133360;
    
    mem_133360.references = NULL;
    
    struct memblock mem_133358;
    
    mem_133358.references = NULL;
    
    struct memblock mem_133356;
    
    mem_133356.references = NULL;
    
    struct memblock mem_param_133354;
    
    mem_param_133354.references = NULL;
    
    struct memblock mem_param_133351;
    
    mem_param_133351.references = NULL;
    
    struct memblock mem_param_133348;
    
    mem_param_133348.references = NULL;
    
    struct memblock ext_mem_133385;
    
    ext_mem_133385.references = NULL;
    
    struct memblock ext_mem_133386;
    
    ext_mem_133386.references = NULL;
    
    struct memblock ext_mem_133387;
    
    ext_mem_133387.references = NULL;
    
    struct memblock mem_133311;
    
    mem_133311.references = NULL;
    
    struct memblock mem_133309;
    
    mem_133309.references = NULL;
    
    struct memblock mem_133307;
    
    mem_133307.references = NULL;
    
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_133235;
    
    mem_133235.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_param_tmp_133529;
    
    mem_param_tmp_133529.references = NULL;
    
    struct memblock mem_param_tmp_133528;
    
    mem_param_tmp_133528.references = NULL;
    
    struct memblock mem_133201;
    
    mem_133201.references = NULL;
    
    struct memblock mem_133199;
    
    mem_133199.references = NULL;
    
    struct memblock ext_mem_133216;
    
    ext_mem_133216.references = NULL;
    
    struct memblock ext_mem_133219;
    
    ext_mem_133219.references = NULL;
    
    struct memblock ext_mem_133222;
    
    ext_mem_133222.references = NULL;
    
    struct memblock ext_mem_133225;
    
    ext_mem_133225.references = NULL;
    
    struct memblock mem_param_133197;
    
    mem_param_133197.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133230;
    
    ext_mem_133230.references = NULL;
    
    struct memblock ext_mem_133231;
    
    ext_mem_133231.references = NULL;
    
    struct memblock mem_133191;
    
    mem_133191.references = NULL;
    
    struct memblock mem_133189;
    
    mem_133189.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock ext_mem_133240;
    
    ext_mem_133240.references = NULL;
    
    struct memblock ext_mem_133241;
    
    ext_mem_133241.references = NULL;
    
    struct memblock mem_133181;
    
    mem_133181.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock ext_mem_133177;
    
    ext_mem_133177.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t zm_lhs_122223 = add64(nR_110890, partitionSizze_110896);
    int64_t zs_lhs_122224 = sub64(zm_lhs_122223, (int64_t) 1);
    bool zzero_122225 = partitionSizze_110896 == (int64_t) 0;
    bool nonzzero_122226 = !zzero_122225;
    bool nonzzero_cert_122227;
    
    if (!nonzzero_122226) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:274:43-57\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_122228 = sdiv64(zs_lhs_122224, partitionSizze_110896);
    int64_t zm_lhs_122229 = add64(nS_110891, partitionSizze_110896);
    int64_t zs_lhs_122230 = sub64(zm_lhs_122229, (int64_t) 1);
    int64_t numIter_S_122231 = sdiv64(zs_lhs_122230, partitionSizze_110896);
    
    if (futrts_indicesWithIncrement_11459(ctx, &ext_mem_133177, tR_mem_133175, nR_110890, offset_R_110894) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_133178 = (int64_t) 8 * nR_110890;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133517 = 0; nest_i_133517 < nR_110890; nest_i_133517++) {
        ((int64_t *) mem_133179.mem)[nest_i_133517] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133181, bytes_133178, "mem_133181")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133518 = 0; nest_i_133518 < nR_110890; nest_i_133518++) {
        ((int64_t *) mem_133181.mem)[nest_i_133518] = (int64_t) 0;
    }
    
    bool loop_cond_122235 = slt64((int64_t) 0, numIter_R_122228);
    bool defunc_0_mergeJoin_res_122236;
    int64_t defunc_0_mergeJoin_res_122237;
    int64_t defunc_0_mergeJoin_res_122240;
    bool loop_while_122241;
    int64_t iter_122242;
    int64_t first_relevant_in_S_122245;
    
    if (memblock_set(ctx, &mem_param_133184, &mem_133181, "mem_133181") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &mem_133179, "mem_133179") != 0)
        return 1;
    loop_while_122241 = loop_cond_122235;
    iter_122242 = (int64_t) 0;
    first_relevant_in_S_122245 = (int64_t) 0;
    while (loop_while_122241) {
        int64_t tR_start_122246 = mul64(partitionSizze_110896, iter_122242);
        int64_t min_arg1_122247 = add64(partitionSizze_110896, tR_start_122246);
        int64_t min_res_122248 = smin64(nR_110890, min_arg1_122247);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 = sub64(min_res_122248, tR_start_122246);
        bool empty_slice_122250 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 == (int64_t) 0;
        int64_t m_122251 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, (int64_t) 1);
        int64_t i_p_m_t_s_122252 = add64(tR_start_122246, m_122251);
        bool zzero_leq_i_p_m_t_s_122253 = sle64((int64_t) 0, i_p_m_t_s_122252);
        bool i_p_m_t_s_leq_w_122254 = slt64(i_p_m_t_s_122252, nR_110890);
        bool zzero_lte_i_122255 = sle64((int64_t) 0, tR_start_122246);
        bool i_lte_j_122256 = sle64(tR_start_122246, min_res_122248);
        bool y_122257 = i_p_m_t_s_leq_w_122254 && zzero_lte_i_122255;
        bool y_122258 = zzero_leq_i_p_m_t_s_122253 && y_122257;
        bool forwards_ok_122259 = i_lte_j_122256 && y_122258;
        bool ok_or_empty_122260 = empty_slice_122250 || forwards_ok_122259;
        bool index_certs_122261;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_110890, "].", "-> #0  ftSMJ.fut:281:17-36\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133188 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249;
        bool cond_122265 = slt64(first_relevant_in_S_122245, numIter_S_122231);
        bool y_122266 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool loop_not_taken_122267 = !cond_122265;
        bool protect_assert_disj_122268 = y_122266 || loop_not_taken_122267;
        bool index_certs_122269;
        
        if (!protect_assert_disj_122268) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:296:26-34\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_122272 = sle64((int64_t) 0, m_122251);
        bool y_122273 = slt64(m_122251, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool bounds_check_122274 = x_122272 && y_122273;
        bool protect_assert_disj_122275 = loop_not_taken_122267 || bounds_check_122274;
        bool index_certs_122276;
        
        if (!protect_assert_disj_122275) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:297:28-47\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_122473;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_110890, "].", "-> #0  ftSMJ.fut:198:15-63\n   #1  ftSMJ.fut:307:20-64\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133189, bytes_133188, "mem_133189")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133526 = 0; nest_i_133526 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133526++) {
            ((int64_t *) mem_133189.mem)[nest_i_133526] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_133191, bytes_133188, "mem_133191")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133527 = 0; nest_i_133527 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133527++) {
            ((int64_t *) mem_133191.mem)[nest_i_133527] = (int64_t) 0;
        }
        
        double gt_lhs_122270;
        
        if (cond_122265) {
            double x_129472 = ((double *) tR_mem_133175.mem)[tR_start_122246];
            
            gt_lhs_122270 = x_129472;
        } else {
            gt_lhs_122270 = 0.0;
        }
        
        double lt_lhs_122277;
        
        if (cond_122265) {
            double x_129473 = ((double *) tR_mem_133175.mem)[i_p_m_t_s_122252];
            
            lt_lhs_122277 = x_129473;
        } else {
            lt_lhs_122277 = 0.0;
        }
        
        int64_t ext_133229;
        int64_t ext_133228;
        int64_t ext_133227;
        int64_t ext_133226;
        bool loopres_122279;
        int64_t loopres_122280;
        int64_t loopres_122283;
        bool loop_while_122284;
        int64_t s_iter_122285;
        int64_t minRelevant_122288;
        int64_t ctx_param_ext_133192;
        int64_t ctx_param_ext_133193;
        int64_t ctx_param_ext_133195;
        int64_t ctx_param_ext_133196;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133197, &mem_133189, "mem_133189") != 0)
            return 1;
        ctx_param_ext_133192 = (int64_t) 0;
        ctx_param_ext_133193 = (int64_t) 1;
        ctx_param_ext_133195 = (int64_t) 0;
        ctx_param_ext_133196 = (int64_t) 1;
        loop_while_122284 = cond_122265;
        s_iter_122285 = first_relevant_in_S_122245;
        minRelevant_122288 = first_relevant_in_S_122245;
        while (loop_while_122284) {
            int64_t tS_start_122289 = mul64(partitionSizze_110896, s_iter_122285);
            int64_t min_arg1_122290 = add64(partitionSizze_110896, tS_start_122289);
            int64_t min_res_122291 = smin64(nS_110891, min_arg1_122290);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 = sub64(min_res_122291, tS_start_122289);
            bool empty_slice_122293 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 == (int64_t) 0;
            int64_t m_122294 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 1);
            int64_t i_p_m_t_s_122295 = add64(tS_start_122289, m_122294);
            bool zzero_leq_i_p_m_t_s_122296 = sle64((int64_t) 0, i_p_m_t_s_122295);
            bool i_p_m_t_s_leq_w_122297 = slt64(i_p_m_t_s_122295, nS_110891);
            bool zzero_lte_i_122298 = sle64((int64_t) 0, tS_start_122289);
            bool i_lte_j_122299 = sle64(tS_start_122289, min_res_122291);
            bool y_122300 = i_p_m_t_s_leq_w_122297 && zzero_lte_i_122298;
            bool y_122301 = zzero_leq_i_p_m_t_s_122296 && y_122300;
            bool forwards_ok_122302 = i_lte_j_122299 && y_122301;
            bool ok_or_empty_122303 = empty_slice_122293 || forwards_ok_122302;
            bool index_certs_122304;
            
            if (!ok_or_empty_122303) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_122289, ":", (long long) min_res_122291, "] out of bounds for array of shape [", (long long) nS_110891, "].", "-> #0  ftSMJ.fut:294:19-38\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_122305 = sle64((int64_t) 0, m_122294);
            bool y_122306 = slt64(m_122294, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool bounds_check_122307 = x_122305 && y_122306;
            bool index_certs_122308;
            
            if (!bounds_check_122307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122294, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:296:40-59\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_122311 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool index_certs_122312;
            
            if (!y_122311) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:297:53-61\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double gt_rhs_122309 = ((double *) tS_mem_133176.mem)[i_p_m_t_s_122295];
            bool defunc_0_gt_res_122310 = gt_rhs_122309 < gt_lhs_122270;
            double lt_rhs_122313 = ((double *) tS_mem_133176.mem)[tS_start_122289];
            bool defunc_0_lt_res_122314 = lt_lhs_122277 < lt_rhs_122313;
            bool thisStillRel_122315 = !defunc_0_lt_res_122314;
            int64_t ext_133218;
            
            if (defunc_0_lt_res_122314) {
                ext_133218 = ctx_param_ext_133192;
            } else {
                ext_133218 = (int64_t) 0;
            }
            
            int64_t ext_133217;
            
            if (defunc_0_lt_res_122314) {
                ext_133217 = ctx_param_ext_133193;
            } else {
                ext_133217 = (int64_t) 1;
            }
            
            int64_t ext_133215;
            
            if (defunc_0_lt_res_122314) {
                ext_133215 = ctx_param_ext_133195;
            } else {
                ext_133215 = (int64_t) 0;
            }
            
            int64_t ext_133214;
            
            if (defunc_0_lt_res_122314) {
                ext_133214 = ctx_param_ext_133196;
            } else {
                ext_133214 = (int64_t) 1;
            }
            
            int64_t ext_133224;
            
            if (defunc_0_gt_res_122310) {
                ext_133224 = ctx_param_ext_133192;
            } else {
                ext_133224 = ext_133218;
            }
            
            int64_t ext_133223;
            
            if (defunc_0_gt_res_122310) {
                ext_133223 = ctx_param_ext_133193;
            } else {
                ext_133223 = ext_133217;
            }
            
            int64_t ext_133221;
            
            if (defunc_0_gt_res_122310) {
                ext_133221 = ctx_param_ext_133195;
            } else {
                ext_133221 = ext_133215;
            }
            
            int64_t ext_133220;
            
            if (defunc_0_gt_res_122310) {
                ext_133220 = ctx_param_ext_133196;
            } else {
                ext_133220 = ext_133214;
            }
            
            int64_t loopres_122316;
            bool loopres_122319;
            int64_t loopres_122320;
            
            if (defunc_0_gt_res_122310) {
                int64_t tmp_129474 = add64((int64_t) 1, s_iter_122285);
                
                if (memblock_set(ctx, &ext_mem_133225, &mem_param_133194, "mem_param_133194") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &mem_param_133197, "mem_param_133197") != 0)
                    return 1;
                loopres_122316 = tmp_129474;
                loopres_122319 = 1;
                loopres_122320 = tmp_129474;
            } else {
                int64_t loopres_f_res_122322;
                bool loopres_f_res_122325;
                
                if (defunc_0_lt_res_122314) {
                    if (memblock_set(ctx, &ext_mem_133219, &mem_param_133194, "mem_param_133194") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_param_133197, "mem_param_133197") != 0)
                        return 1;
                    loopres_f_res_122322 = s_iter_122285;
                    loopres_f_res_122325 = thisStillRel_122315;
                } else {
                    bool index_certs_122326;
                    
                    if (!bounds_check_122274) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:301:25-44\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lt_lhs_122327 = ((double *) tR_mem_133175.mem)[i_p_m_t_s_122252];
                    bool defunc_0_lt_res_122328 = lt_lhs_122327 < gt_rhs_122309;
                    bool nextRel_122329 = !defunc_0_lt_res_122328;
                    int64_t find_joinTuples_arg3_122330 = add64(offset_S_110895, tS_start_122289);
                    int64_t max_arg1_122331 = sdiv64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 2);
                    int64_t max_res_122332 = smax64((int64_t) 1, max_arg1_122331);
                    bool loop_cond_122333 = slt64((int64_t) 0, max_res_122332);
                    
                    if (memblock_alloc(ctx, &mem_133199, bytes_133188, "mem_133199")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_133201, bytes_133188, "mem_133201")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_133044 = 0; i_133044 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; i_133044++) {
                        int64_t eta_p_129190 = ((int64_t *) mem_param_133194.mem)[ctx_param_ext_133192 + i_133044 * ctx_param_ext_133193];
                        int64_t slice_133152 = tR_start_122246 + i_133044;
                        double eta_p_129191 = ((double *) tR_mem_133175.mem)[slice_133152];
                        int64_t eta_p_129192 = ((int64_t *) mem_param_133197.mem)[ctx_param_ext_133195 + i_133044 * ctx_param_ext_133196];
                        bool defunc_0_f_res_129193;
                        int64_t defunc_0_f_res_129194;
                        int64_t defunc_0_f_res_129195;
                        bool loop_while_129196;
                        int64_t first_match_129197;
                        int64_t step_129198;
                        
                        loop_while_129196 = loop_cond_122333;
                        first_match_129197 = (int64_t) 0;
                        step_129198 = max_res_122332;
                        while (loop_while_129196) {
                            bool x_129199 = sle64((int64_t) 0, first_match_129197);
                            bool y_129200 = slt64(first_match_129197, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                            bool bounds_check_129201 = x_129199 && y_129200;
                            bool index_certs_129202;
                            
                            if (!bounds_check_129201) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) first_match_129197, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:220:20-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129203 = tS_start_122289 + first_match_129197;
                            double sv_129204 = ((double *) tS_mem_133176.mem)[slice_129203];
                            bool cond_129205 = first_match_129197 == (int64_t) 0;
                            double pv_129206;
                            
                            if (cond_129205) {
                                pv_129206 = sv_129204;
                            } else {
                                int64_t tmp_129207 = sub64(first_match_129197, (int64_t) 1);
                                bool x_129208 = sle64((int64_t) 0, tmp_129207);
                                bool y_129209 = slt64(tmp_129207, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129210 = x_129208 && y_129209;
                                bool index_certs_129211;
                                
                                if (!bounds_check_129210) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129207, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:221:51-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129212 = tS_start_122289 + tmp_129207;
                                double pv_f_res_129213 = ((double *) tS_mem_133176.mem)[slice_129212];
                                
                                pv_129206 = pv_f_res_129213;
                            }
                            
                            bool cond_129214 = first_match_129197 == m_122294;
                            double nv_129215;
                            
                            if (cond_129214) {
                                nv_129215 = sv_129204;
                            } else {
                                int64_t tmp_129216 = add64((int64_t) 1, first_match_129197);
                                bool x_129217 = sle64((int64_t) 0, tmp_129216);
                                bool y_129218 = slt64(tmp_129216, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129219 = x_129217 && y_129218;
                                bool index_certs_129220;
                                
                                if (!bounds_check_129219) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129216, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:222:54-71\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129221 = tS_start_122289 + tmp_129216;
                                double nv_f_res_129222 = ((double *) tS_mem_133176.mem)[slice_129221];
                                
                                nv_129215 = nv_f_res_129222;
                            }
                            
                            bool defunc_0_eq_res_129223 = eta_p_129191 == sv_129204;
                            bool defunc_0_gt_res_129224 = pv_129206 < eta_p_129191;
                            bool x_129225 = !cond_129205;
                            bool y_129226 = defunc_0_gt_res_129224 && x_129225;
                            bool cond_t_res_129227 = cond_129205 || y_129226;
                            bool x_129228 = defunc_0_eq_res_129223 && cond_t_res_129227;
                            int64_t loopres_129229;
                            int64_t loopres_129230;
                            
                            if (x_129228) {
                                loopres_129229 = first_match_129197;
                                loopres_129230 = (int64_t) 0;
                            } else {
                                int64_t loopres_f_res_129231;
                                int64_t loopres_f_res_129232;
                                
                                if (defunc_0_eq_res_129223) {
                                    int64_t tmp_129475 = sub64(first_match_129197, step_129198);
                                    int64_t max_arg1_129476 = sdiv64(step_129198, (int64_t) 2);
                                    int64_t max_res_129477 = smax64((int64_t) 1, max_arg1_129476);
                                    
                                    loopres_f_res_129231 = tmp_129475;
                                    loopres_f_res_129232 = max_res_129477;
                                } else {
                                    bool defunc_0_lt_res_129236 = eta_p_129191 < sv_129204;
                                    int64_t loopres_f_res_f_res_129237;
                                    int64_t loopres_f_res_f_res_129238;
                                    
                                    if (defunc_0_lt_res_129236) {
                                        int64_t loopres_f_res_f_res_t_res_129478;
                                        int64_t loopres_f_res_f_res_t_res_129479;
                                        
                                        if (cond_t_res_129227) {
                                            loopres_f_res_f_res_t_res_129478 = (int64_t) -1;
                                            loopres_f_res_f_res_t_res_129479 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129480 = sub64(first_match_129197, step_129198);
                                            int64_t max_arg1_129481 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129482 = smax64((int64_t) 1, max_arg1_129481);
                                            
                                            loopres_f_res_f_res_t_res_129478 = tmp_129480;
                                            loopres_f_res_f_res_t_res_129479 = max_res_129482;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_t_res_129478;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_t_res_129479;
                                    } else {
                                        bool defunc_0_lt_res_129246 = eta_p_129191 < nv_129215;
                                        bool x_129247 = !cond_129214;
                                        bool y_129248 = defunc_0_lt_res_129246 && x_129247;
                                        bool cond_129249 = cond_129214 || y_129248;
                                        int64_t loopres_f_res_f_res_f_res_129250;
                                        int64_t loopres_f_res_f_res_f_res_129251;
                                        
                                        if (cond_129249) {
                                            loopres_f_res_f_res_f_res_129250 = (int64_t) -1;
                                            loopres_f_res_f_res_f_res_129251 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129252 = add64(first_match_129197, step_129198);
                                            int64_t max_arg1_129253 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129254 = smax64((int64_t) 1, max_arg1_129253);
                                            
                                            loopres_f_res_f_res_f_res_129250 = tmp_129252;
                                            loopres_f_res_f_res_f_res_129251 = max_res_129254;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_f_res_129250;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_f_res_129251;
                                    }
                                    loopres_f_res_129231 = loopres_f_res_f_res_129237;
                                    loopres_f_res_129232 = loopres_f_res_f_res_129238;
                                }
                                loopres_129229 = loopres_f_res_129231;
                                loopres_129230 = loopres_f_res_129232;
                            }
                            
                            bool loop_cond_129255 = slt64((int64_t) 0, loopres_129230);
                            bool loop_while_tmp_133541 = loop_cond_129255;
                            int64_t first_match_tmp_133542 = loopres_129229;
                            int64_t step_tmp_133543 = loopres_129230;
                            
                            loop_while_129196 = loop_while_tmp_133541;
                            first_match_129197 = first_match_tmp_133542;
                            step_129198 = step_tmp_133543;
                        }
                        defunc_0_f_res_129193 = loop_while_129196;
                        defunc_0_f_res_129194 = first_match_129197;
                        defunc_0_f_res_129195 = step_129198;
                        
                        int64_t zs_lhs_129256 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, defunc_0_f_res_129194);
                        int64_t max_arg1_129257 = sdiv64(zs_lhs_129256, (int64_t) 2);
                        int64_t max_res_129258 = smax64((int64_t) 1, max_arg1_129257);
                        bool cond_129259 = defunc_0_f_res_129194 == (int64_t) -1;
                        int64_t defunc_0_f_res_129260;
                        
                        if (cond_129259) {
                            defunc_0_f_res_129260 = (int64_t) -1;
                        } else {
                            bool loop_cond_129262 = slt64((int64_t) 0, max_res_129258);
                            bool defunc_0_f_res_f_res_129263;
                            int64_t defunc_0_f_res_f_res_129264;
                            int64_t defunc_0_f_res_f_res_129265;
                            bool loop_while_129266;
                            int64_t last_match_129267;
                            int64_t step_129268;
                            
                            loop_while_129266 = loop_cond_129262;
                            last_match_129267 = m_122294;
                            step_129268 = max_res_129258;
                            while (loop_while_129266) {
                                bool x_129269 = sle64((int64_t) 0, last_match_129267);
                                bool y_129270 = slt64(last_match_129267, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129271 = x_129269 && y_129270;
                                bool index_certs_129272;
                                
                                if (!bounds_check_129271) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) last_match_129267, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:241:20-34\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129273 = tS_start_122289 + last_match_129267;
                                double sv_129274 = ((double *) tS_mem_133176.mem)[slice_129273];
                                bool cond_129275 = last_match_129267 == m_122294;
                                double nv_129276;
                                
                                if (cond_129275) {
                                    nv_129276 = sv_129274;
                                } else {
                                    int64_t tmp_129277 = add64((int64_t) 1, last_match_129267);
                                    bool x_129278 = sle64((int64_t) 0, tmp_129277);
                                    bool y_129279 = slt64(tmp_129277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                    bool bounds_check_129280 = x_129278 && y_129279;
                                    bool index_certs_129281;
                                    
                                    if (!bounds_check_129280) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:242:53-69\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129282 = tS_start_122289 + tmp_129277;
                                    double nv_f_res_129283 = ((double *) tS_mem_133176.mem)[slice_129282];
                                    
                                    nv_129276 = nv_f_res_129283;
                                }
                                
                                bool defunc_0_eq_res_129284 = eta_p_129191 == sv_129274;
                                bool defunc_0_lt_res_129285 = eta_p_129191 < nv_129276;
                                bool x_129286 = !cond_129275;
                                bool y_129287 = defunc_0_lt_res_129285 && x_129286;
                                bool cond_t_res_129288 = cond_129275 || y_129287;
                                bool x_129289 = defunc_0_eq_res_129284 && cond_t_res_129288;
                                int64_t loopres_129290;
                                int64_t loopres_129291;
                                
                                if (x_129289) {
                                    loopres_129290 = last_match_129267;
                                    loopres_129291 = (int64_t) 0;
                                } else {
                                    int64_t loopres_f_res_129292;
                                    int64_t loopres_f_res_129293;
                                    
                                    if (defunc_0_eq_res_129284) {
                                        int64_t tmp_129483 = add64(last_match_129267, step_129268);
                                        int64_t max_arg1_129484 = sdiv64(step_129268, (int64_t) 2);
                                        int64_t max_res_129485 = smax64((int64_t) 1, max_arg1_129484);
                                        
                                        loopres_f_res_129292 = tmp_129483;
                                        loopres_f_res_129293 = max_res_129485;
                                    } else {
                                        bool defunc_0_lt_res_129297 = eta_p_129191 < sv_129274;
                                        int64_t loopres_f_res_f_res_129298;
                                        int64_t loopres_f_res_f_res_129299;
                                        
                                        if (defunc_0_lt_res_129297) {
                                            int64_t tmp_129486 = sub64(last_match_129267, step_129268);
                                            int64_t max_arg1_129487 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129488 = smax64((int64_t) 1, max_arg1_129487);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129486;
                                            loopres_f_res_f_res_129299 = max_res_129488;
                                        } else {
                                            int64_t tmp_129303 = add64(last_match_129267, step_129268);
                                            int64_t max_arg1_129304 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129305 = smax64((int64_t) 1, max_arg1_129304);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129303;
                                            loopres_f_res_f_res_129299 = max_res_129305;
                                        }
                                        loopres_f_res_129292 = loopres_f_res_f_res_129298;
                                        loopres_f_res_129293 = loopres_f_res_f_res_129299;
                                    }
                                    loopres_129290 = loopres_f_res_129292;
                                    loopres_129291 = loopres_f_res_129293;
                                }
                                
                                bool loop_cond_129306 = slt64((int64_t) 0, loopres_129291);
                                bool loop_while_tmp_133544 = loop_cond_129306;
                                int64_t last_match_tmp_133545 = loopres_129290;
                                int64_t step_tmp_133546 = loopres_129291;
                                
                                loop_while_129266 = loop_while_tmp_133544;
                                last_match_129267 = last_match_tmp_133545;
                                step_129268 = step_tmp_133546;
                            }
                            defunc_0_f_res_f_res_129263 = loop_while_129266;
                            defunc_0_f_res_f_res_129264 = last_match_129267;
                            defunc_0_f_res_f_res_129265 = step_129268;
                            defunc_0_f_res_129260 = defunc_0_f_res_f_res_129264;
                        }
                        
                        bool cond_129307 = slt64(defunc_0_f_res_129194, (int64_t) 0);
                        int64_t cm_129308;
                        
                        if (cond_129307) {
                            cm_129308 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_129309 = sub64(defunc_0_f_res_129260, defunc_0_f_res_129194);
                            int64_t cm_f_res_129310 = add64((int64_t) 1, zp_lhs_129309);
                            
                            cm_129308 = cm_f_res_129310;
                        }
                        
                        int64_t lifted_lambda_res_129314;
                        
                        if (cond_129307) {
                            lifted_lambda_res_129314 = defunc_0_f_res_129194;
                        } else {
                            int64_t lifted_lambda_res_f_res_129315 = add64(find_joinTuples_arg3_122330, defunc_0_f_res_129194);
                            
                            lifted_lambda_res_129314 = lifted_lambda_res_f_res_129315;
                        }
                        
                        bool cond_129317 = slt64(eta_p_129192, (int64_t) 0);
                        int64_t lifted_lambda_res_129318;
                        
                        if (cond_129317) {
                            lifted_lambda_res_129318 = lifted_lambda_res_129314;
                        } else {
                            lifted_lambda_res_129318 = eta_p_129192;
                        }
                        
                        int64_t defunc_0_f_res_129321 = add64(eta_p_129190, cm_129308);
                        
                        ((int64_t *) mem_133199.mem)[i_133044] = defunc_0_f_res_129321;
                        ((int64_t *) mem_133201.mem)[i_133044] = lifted_lambda_res_129318;
                    }
                    
                    int64_t tmp_122469 = add64((int64_t) 1, s_iter_122285);
                    
                    if (memblock_set(ctx, &ext_mem_133219, &mem_133199, "mem_133199") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_133201, "mem_133201") != 0)
                        return 1;
                    loopres_f_res_122322 = tmp_122469;
                    loopres_f_res_122325 = nextRel_122329;
                }
                if (memblock_set(ctx, &ext_mem_133225, &ext_mem_133219, "ext_mem_133219") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &ext_mem_133216, "ext_mem_133216") != 0)
                    return 1;
                loopres_122316 = loopres_f_res_122322;
                loopres_122319 = loopres_f_res_122325;
                loopres_122320 = minRelevant_122288;
            }
            
            bool cond_122470 = slt64(loopres_122316, numIter_S_122231);
            bool x_122471 = loopres_122319 && cond_122470;
            
            if (memblock_set(ctx, &mem_param_tmp_133528, &ext_mem_133225, "ext_mem_133225") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133529, &ext_mem_133222, "ext_mem_133222") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_133530 = ext_133224;
            int64_t ctx_param_ext_tmp_133531 = ext_133223;
            int64_t ctx_param_ext_tmp_133532 = ext_133221;
            int64_t ctx_param_ext_tmp_133533 = ext_133220;
            bool loop_while_tmp_133534 = x_122471;
            int64_t s_iter_tmp_133535 = loopres_122316;
            int64_t minRelevant_tmp_133538 = loopres_122320;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133197, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
                return 1;
            ctx_param_ext_133192 = ctx_param_ext_tmp_133530;
            ctx_param_ext_133193 = ctx_param_ext_tmp_133531;
            ctx_param_ext_133195 = ctx_param_ext_tmp_133532;
            ctx_param_ext_133196 = ctx_param_ext_tmp_133533;
            loop_while_122284 = loop_while_tmp_133534;
            s_iter_122285 = s_iter_tmp_133535;
            minRelevant_122288 = minRelevant_tmp_133538;
        }
        if (memblock_set(ctx, &ext_mem_133231, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133230, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        ext_133229 = ctx_param_ext_133192;
        ext_133228 = ctx_param_ext_133193;
        ext_133227 = ctx_param_ext_133195;
        ext_133226 = ctx_param_ext_133196;
        loopres_122279 = loop_while_122284;
        loopres_122280 = s_iter_122285;
        loopres_122283 = minRelevant_122288;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133233, bytes_133178, "mem_133233")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133187.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_110890});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133230.mem, ext_133227, (int64_t []) {ext_133226}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133235, bytes_133178, "mem_133235")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_110890});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133231.mem, ext_133229, (int64_t []) {ext_133228}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        
        int64_t tmp_122477 = add64((int64_t) 1, iter_122242);
        bool loop_cond_122478 = slt64(tmp_122477, numIter_R_122228);
        
        if (memblock_set(ctx, &mem_param_tmp_133519, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &mem_133233, "mem_133233") != 0)
            return 1;
        
        bool loop_while_tmp_133521 = loop_cond_122478;
        int64_t iter_tmp_133522 = tmp_122477;
        int64_t first_relevant_in_S_tmp_133525 = loopres_122283;
        
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        loop_while_122241 = loop_while_tmp_133521;
        iter_122242 = iter_tmp_133522;
        first_relevant_in_S_122245 = first_relevant_in_S_tmp_133525;
    }
    if (memblock_set(ctx, &ext_mem_133241, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133240, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    defunc_0_mergeJoin_res_122236 = loop_while_122241;
    defunc_0_mergeJoin_res_122237 = iter_122242;
    defunc_0_mergeJoin_res_122240 = first_relevant_in_S_122245;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
        return 1;
    if (mem_133243_cached_sizze_133686 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133243, &mem_133243_cached_sizze_133686, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133245_cached_sizze_133687 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133245, &mem_133245_cached_sizze_133687, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133247_cached_sizze_133688 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133247, &mem_133247_cached_sizze_133688, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133249_cached_sizze_133689 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133689, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133251_cached_sizze_133690 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133251, &mem_133251_cached_sizze_133690, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133253_cached_sizze_133691 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133253, &mem_133253_cached_sizze_133691, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133255_cached_sizze_133692 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133255, &mem_133255_cached_sizze_133692, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133072;
    int64_t discard_133073;
    int64_t defunc_res_129534;
    int64_t scanacc_133054;
    int64_t scanacc_133055;
    int64_t redout_133058;
    
    scanacc_133054 = (int64_t) 0;
    scanacc_133055 = (int64_t) 0;
    redout_133058 = (int64_t) 0;
    for (int64_t i_133064 = 0; i_133064 < nR_110890; i_133064++) {
        int64_t zg_lhs_129015 = ((int64_t *) ext_mem_133241.mem)[i_133064];
        bool cond_129016 = slt64((int64_t) 0, zg_lhs_129015);
        int64_t lifted_lambda_res_129017;
        
        if (cond_129016) {
            lifted_lambda_res_129017 = i_133064;
        } else {
            lifted_lambda_res_129017 = (int64_t) -1;
        }
        
        bool cond_129019 = sle64((int64_t) 0, lifted_lambda_res_129017);
        bool cond_t_res_129020 = slt64(lifted_lambda_res_129017, nR_110890);
        bool x_129021 = cond_129019 && cond_t_res_129020;
        int64_t lifted_lambda_res_129022;
        
        if (x_129021) {
            bool index_certs_129491;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_110890, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_129492 = ((int64_t *) ext_mem_133241.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129022 = lifted_lambda_res_t_res_129492;
        } else {
            lifted_lambda_res_129022 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_129026 = slt64((int64_t) 1, lifted_lambda_res_129022);
        int64_t defunc_0_f_res_129027 = btoi_bool_i64(lifted_lambda_res_129026);
        double lifted_lambda_res_129039;
        int64_t lifted_lambda_res_129040;
        int64_t lifted_lambda_res_129041;
        
        if (x_129021) {
            bool index_certs_129493;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_110890, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:377:7-378:57\n   #4  ftRelational.fut:200:82-85\n   #5  ftRelational.fut:191:1-200:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double lifted_lambda_res_t_res_129494 = ((double *) tR_mem_133175.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129495 = ((int64_t *) ext_mem_133177.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129496 = ((int64_t *) ext_mem_133240.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129039 = lifted_lambda_res_t_res_129494;
            lifted_lambda_res_129040 = lifted_lambda_res_t_res_129495;
            lifted_lambda_res_129041 = lifted_lambda_res_t_res_129496;
        } else {
            lifted_lambda_res_129039 = 0.0;
            lifted_lambda_res_129040 = (int64_t) -1;
            lifted_lambda_res_129041 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_122541 = add64(defunc_0_f_res_129027, scanacc_133054);
        int64_t lifted_lambda_res_122502 = add64(lifted_lambda_res_129022, scanacc_133055);
        int64_t zp_res_122522 = add64(lifted_lambda_res_129022, redout_133058);
        
        ((int64_t *) mem_133243)[i_133064] = defunc_0_op_res_122541;
        ((int64_t *) mem_133245)[i_133064] = lifted_lambda_res_122502;
        ((double *) mem_133247)[i_133064] = lifted_lambda_res_129039;
        ((int64_t *) mem_133249)[i_133064] = lifted_lambda_res_129040;
        ((int64_t *) mem_133251)[i_133064] = lifted_lambda_res_129041;
        ((int64_t *) mem_133253)[i_133064] = defunc_0_f_res_129027;
        ((int64_t *) mem_133255)[i_133064] = lifted_lambda_res_129022;
        
        int64_t scanacc_tmp_133547 = defunc_0_op_res_122541;
        int64_t scanacc_tmp_133548 = lifted_lambda_res_122502;
        int64_t redout_tmp_133551 = zp_res_122522;
        
        scanacc_133054 = scanacc_tmp_133547;
        scanacc_133055 = scanacc_tmp_133548;
        redout_133058 = redout_tmp_133551;
    }
    discard_133072 = scanacc_133054;
    discard_133073 = scanacc_133055;
    defunc_res_129534 = redout_133058;
    if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
        return 1;
    
    int64_t bytes_133306 = (int64_t) 8 * defunc_res_129534;
    bool cond_122542 = nR_110890 == (int64_t) 0;
    bool x_122543 = !cond_122542;
    int64_t tmp_122544 = sub64(nR_110890, (int64_t) 1);
    bool x_122545 = sle64((int64_t) 0, tmp_122544);
    bool y_122546 = slt64(tmp_122544, nR_110890);
    bool bounds_check_122547 = x_122545 && y_122546;
    bool protect_assert_disj_122548 = cond_122542 || bounds_check_122547;
    bool index_certs_122549;
    
    if (!protect_assert_disj_122548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_122544, "] out of bounds for array of shape [", (long long) nR_110890, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_122550;
    
    if (x_122543) {
        int64_t x_129497 = ((int64_t *) mem_133243)[tmp_122544];
        
        m_f_res_122550 = x_129497;
    } else {
        m_f_res_122550 = (int64_t) 0;
    }
    
    int64_t m_122552;
    
    if (cond_122542) {
        m_122552 = (int64_t) 0;
    } else {
        m_122552 = m_f_res_122550;
    }
    
    bool cond_122575 = slt64((int64_t) 0, m_122552);
    int64_t m_122562 = sub64(m_122552, (int64_t) 1);
    bool i_p_m_t_s_leq_w_122564 = slt64(m_122562, nR_110890);
    bool zzero_leq_i_p_m_t_s_122563 = sle64((int64_t) 0, m_122562);
    bool y_122566 = zzero_leq_i_p_m_t_s_122563 && i_p_m_t_s_leq_w_122564;
    bool i_lte_j_122565 = sle64((int64_t) 0, m_122552);
    bool forwards_ok_122567 = i_lte_j_122565 && y_122566;
    bool eq_x_zz_122559 = (int64_t) 0 == m_f_res_122550;
    bool p_and_eq_x_y_122560 = x_122543 && eq_x_zz_122559;
    bool empty_slice_122561 = cond_122542 || p_and_eq_x_y_122560;
    bool ok_or_empty_122568 = empty_slice_122561 || forwards_ok_122567;
    bool index_certs_122569;
    
    if (!ok_or_empty_122568) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122552, "] out of bounds for array of shape [", (long long) nR_110890, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:200:82-85\n   #4  ftRelational.fut:191:1-200:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133330 = (int64_t) 8 * m_122552;
    
    if (mem_133331_cached_sizze_133694 < bytes_133330) {
        err = lexical_realloc(ctx, &mem_133331, &mem_133331_cached_sizze_133694, bytes_133330);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133331, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122552});
    
    int64_t max_mult_122576;
    
    if (cond_122575) {
        if (mem_133333_cached_sizze_133695 < bytes_133178) {
            err = lexical_realloc(ctx, &mem_133333, &mem_133333_cached_sizze_133695, bytes_133178);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133091 = 0; i_133091 < nR_110890; i_133091++) {
            int64_t eta_p_129503 = ((int64_t *) mem_133253)[i_133091];
            int64_t eta_p_129504 = ((int64_t *) mem_133243)[i_133091];
            bool cond_129505 = eta_p_129503 == (int64_t) 1;
            int64_t lifted_lambda_res_129506;
            
            if (cond_129505) {
                int64_t lifted_lambda_res_t_res_129507 = sub64(eta_p_129504, (int64_t) 1);
                
                lifted_lambda_res_129506 = lifted_lambda_res_t_res_129507;
            } else {
                lifted_lambda_res_129506 = (int64_t) -1;
            }
            ((int64_t *) mem_133333)[i_133091] = lifted_lambda_res_129506;
        }
        for (int64_t write_iter_133093 = 0; write_iter_133093 < nR_110890; write_iter_133093++) {
            int64_t write_iv_133095 = ((int64_t *) mem_133333)[write_iter_133093];
            int64_t write_iv_133096 = ((int64_t *) mem_133255)[write_iter_133093];
            
            if (sle64((int64_t) 0, write_iv_133095) && slt64(write_iv_133095, m_122552)) {
                ((int64_t *) mem_133331)[write_iv_133095] = write_iv_133096;
            }
        }
        
        int64_t defunc_0_reduce_res_129517;
        int64_t redout_133098 = (int64_t) -9223372036854775808;
        
        for (int64_t i_133099 = 0; i_133099 < m_122552; i_133099++) {
            int64_t x_129518 = ((int64_t *) mem_133331)[i_133099];
            int64_t max_res_129521 = smax64(x_129518, redout_133098);
            int64_t redout_tmp_133559 = max_res_129521;
            
            redout_133098 = redout_tmp_133559;
        }
        defunc_0_reduce_res_129517 = redout_133098;
        max_mult_122576 = defunc_0_reduce_res_129517;
    } else {
        max_mult_122576 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_122582 = slt64(max_mult_122576, (int64_t) 1);
    bool valid_122584 = !bounds_invalid_upwards_122582;
    bool range_valid_c_122585;
    
    if (!valid_122584) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_122576, " is invalid.", "-> #0  ftSMJ.fut:352:16-28\n   #1  ftSMJ.fut:377:7-378:57\n   #2  ftRelational.fut:200:82-85\n   #3  ftRelational.fut:191:1-200:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_133299_cached_sizze_133693 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133693, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133076 = 0; i_133076 < nR_110890; i_133076++) {
        int64_t eta_p_128922 = ((int64_t *) mem_133255)[i_133076];
        int64_t zv_lhs_128924 = add64((int64_t) -1, i_133076);
        int64_t tmp_128925 = smod64(zv_lhs_128924, nR_110890);
        int64_t lifted_lambda_res_128926 = ((int64_t *) mem_133245)[tmp_128925];
        bool cond_128928 = i_133076 == (int64_t) 0;
        int64_t lifted_lambda_res_128929;
        
        if (cond_128928) {
            lifted_lambda_res_128929 = (int64_t) 0;
        } else {
            lifted_lambda_res_128929 = lifted_lambda_res_128926;
        }
        
        bool cond_128931 = slt64((int64_t) 0, eta_p_128922);
        int64_t lifted_lambda_res_128932;
        
        if (cond_128931) {
            lifted_lambda_res_128932 = lifted_lambda_res_128929;
        } else {
            lifted_lambda_res_128932 = (int64_t) -1;
        }
        ((int64_t *) mem_133299)[i_133076] = lifted_lambda_res_128932;
    }
    if (memblock_alloc(ctx, &mem_133307, bytes_133306, "mem_133307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133561 = 0; nest_i_133561 < defunc_res_129534; nest_i_133561++) {
        ((double *) mem_133307.mem)[nest_i_133561] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_133309, bytes_133306, "mem_133309")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133562 = 0; nest_i_133562 < defunc_res_129534; nest_i_133562++) {
        ((int64_t *) mem_133309.mem)[nest_i_133562] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133311, bytes_133306, "mem_133311")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133563 = 0; nest_i_133563 < defunc_res_129534; nest_i_133563++) {
        ((int64_t *) mem_133311.mem)[nest_i_133563] = (int64_t) -1;
    }
    for (int64_t write_iter_133078 = 0; write_iter_133078 < nR_110890; write_iter_133078++) {
        int64_t write_iv_133082 = ((int64_t *) mem_133299)[write_iter_133078];
        double write_iv_133083 = ((double *) mem_133247)[write_iter_133078];
        int64_t write_iv_133084 = ((int64_t *) mem_133249)[write_iter_133078];
        int64_t write_iv_133085 = ((int64_t *) mem_133251)[write_iter_133078];
        
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((double *) mem_133307.mem)[write_iv_133082] = write_iv_133083;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133309.mem)[write_iv_133082] = write_iv_133084;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133311.mem)[write_iv_133082] = write_iv_133085;
        }
    }
    
    int64_t distance_122583 = sub64(max_mult_122576, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_133348, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133351, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133354, &mem_133311, "mem_133311") != 0)
        return 1;
    for (int64_t i_122589 = 0; i_122589 < distance_122583; i_122589++) {
        int64_t index_primexp_122593 = add64((int64_t) 1, i_122589);
        
        if (memblock_alloc(ctx, &mem_133356, bytes_133306, "mem_133356")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133356.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133354.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133358, bytes_133306, "mem_133358")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133360, bytes_133306, "mem_133360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133348.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        for (int64_t write_iter_133100 = 0; write_iter_133100 < nR_110890; write_iter_133100++) {
            int64_t write_iv_133105 = ((int64_t *) mem_133251)[write_iter_133100];
            double write_iv_133106 = ((double *) mem_133247)[write_iter_133100];
            int64_t write_iv_133107 = ((int64_t *) mem_133249)[write_iter_133100];
            int64_t zg_lhs_129457 = ((int64_t *) mem_133255)[write_iter_133100];
            bool cond_129458 = slt64(index_primexp_122593, zg_lhs_129457);
            int64_t lifted_lambda_res_129459;
            
            if (cond_129458) {
                int64_t zp_lhs_129527 = ((int64_t *) mem_133299)[write_iter_133100];
                int64_t lifted_lambda_res_t_res_129528 = add64(index_primexp_122593, zp_lhs_129527);
                
                lifted_lambda_res_129459 = lifted_lambda_res_t_res_129528;
            } else {
                lifted_lambda_res_129459 = (int64_t) -1;
            }
            
            int64_t tmp_129463 = add64(index_primexp_122593, write_iv_133105);
            
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((double *) mem_133360.mem)[lifted_lambda_res_129459] = write_iv_133106;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133358.mem)[lifted_lambda_res_129459] = write_iv_133107;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133356.mem)[lifted_lambda_res_129459] = tmp_129463;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_133567, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133568, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133569, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133348, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133351, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133354, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133387, &mem_param_133348, "mem_param_133348") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133386, &mem_param_133351, "mem_param_133351") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133385, &mem_param_133354, "mem_param_133354") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133389, bytes_133306, "mem_133389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133391, bytes_133306, "mem_133391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133386.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133393, bytes_133306, "mem_133393")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133393.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133391, "mem_133391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133393, "mem_133393") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133389, "mem_133389") != 0)
        return 1;
    prim_out_133516 = defunc_res_129534;
    if (memblock_set(ctx, &*mem_out_p_133682, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133683, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133684, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133685 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133243);
        free(mem_133245);
        free(mem_133247);
        free(mem_133249);
        free(mem_133251);
        free(mem_133253);
        free(mem_133255);
        free(mem_133299);
        free(mem_133331);
        free(mem_133333);
        if (memblock_unref(ctx, &mem_133393, "mem_133393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133391, "mem_133391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133389, "mem_133389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133354, "mem_param_133354") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133351, "mem_param_133351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133348, "mem_param_133348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133201, "mem_133201") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133199, "mem_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133216, "ext_mem_133216") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133219, "ext_mem_133219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133222, "ext_mem_133222") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133225, "ext_mem_133225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_133696, struct memblock *mem_out_p_133697, struct memblock *mem_out_p_133698, int64_t *out_prim_out_133699, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_108656, int64_t nS_108657, int64_t offset_R_108660, int64_t offset_S_108661, int64_t partitionSizze_108662, int64_t scatter_psizze_108663)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133243_cached_sizze_133700 = 0;
    unsigned char *mem_133243 = NULL;
    int64_t mem_133245_cached_sizze_133701 = 0;
    unsigned char *mem_133245 = NULL;
    int64_t mem_133247_cached_sizze_133702 = 0;
    unsigned char *mem_133247 = NULL;
    int64_t mem_133249_cached_sizze_133703 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133251_cached_sizze_133704 = 0;
    unsigned char *mem_133251 = NULL;
    int64_t mem_133253_cached_sizze_133705 = 0;
    unsigned char *mem_133253 = NULL;
    int64_t mem_133255_cached_sizze_133706 = 0;
    unsigned char *mem_133255 = NULL;
    int64_t mem_133299_cached_sizze_133707 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133331_cached_sizze_133708 = 0;
    unsigned char *mem_133331 = NULL;
    int64_t mem_133333_cached_sizze_133709 = 0;
    unsigned char *mem_133333 = NULL;
    struct memblock mem_133393;
    
    mem_133393.references = NULL;
    
    struct memblock mem_133391;
    
    mem_133391.references = NULL;
    
    struct memblock mem_133389;
    
    mem_133389.references = NULL;
    
    struct memblock mem_param_tmp_133569;
    
    mem_param_tmp_133569.references = NULL;
    
    struct memblock mem_param_tmp_133568;
    
    mem_param_tmp_133568.references = NULL;
    
    struct memblock mem_param_tmp_133567;
    
    mem_param_tmp_133567.references = NULL;
    
    struct memblock mem_133360;
    
    mem_133360.references = NULL;
    
    struct memblock mem_133358;
    
    mem_133358.references = NULL;
    
    struct memblock mem_133356;
    
    mem_133356.references = NULL;
    
    struct memblock mem_param_133354;
    
    mem_param_133354.references = NULL;
    
    struct memblock mem_param_133351;
    
    mem_param_133351.references = NULL;
    
    struct memblock mem_param_133348;
    
    mem_param_133348.references = NULL;
    
    struct memblock ext_mem_133385;
    
    ext_mem_133385.references = NULL;
    
    struct memblock ext_mem_133386;
    
    ext_mem_133386.references = NULL;
    
    struct memblock ext_mem_133387;
    
    ext_mem_133387.references = NULL;
    
    struct memblock mem_133311;
    
    mem_133311.references = NULL;
    
    struct memblock mem_133309;
    
    mem_133309.references = NULL;
    
    struct memblock mem_133307;
    
    mem_133307.references = NULL;
    
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_133235;
    
    mem_133235.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_param_tmp_133529;
    
    mem_param_tmp_133529.references = NULL;
    
    struct memblock mem_param_tmp_133528;
    
    mem_param_tmp_133528.references = NULL;
    
    struct memblock mem_133201;
    
    mem_133201.references = NULL;
    
    struct memblock mem_133199;
    
    mem_133199.references = NULL;
    
    struct memblock ext_mem_133216;
    
    ext_mem_133216.references = NULL;
    
    struct memblock ext_mem_133219;
    
    ext_mem_133219.references = NULL;
    
    struct memblock ext_mem_133222;
    
    ext_mem_133222.references = NULL;
    
    struct memblock ext_mem_133225;
    
    ext_mem_133225.references = NULL;
    
    struct memblock mem_param_133197;
    
    mem_param_133197.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133230;
    
    ext_mem_133230.references = NULL;
    
    struct memblock ext_mem_133231;
    
    ext_mem_133231.references = NULL;
    
    struct memblock mem_133191;
    
    mem_133191.references = NULL;
    
    struct memblock mem_133189;
    
    mem_133189.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock ext_mem_133240;
    
    ext_mem_133240.references = NULL;
    
    struct memblock ext_mem_133241;
    
    ext_mem_133241.references = NULL;
    
    struct memblock mem_133181;
    
    mem_133181.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock ext_mem_133177;
    
    ext_mem_133177.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t zm_lhs_122223 = add64(nR_108656, partitionSizze_108662);
    int64_t zs_lhs_122224 = sub64(zm_lhs_122223, (int64_t) 1);
    bool zzero_122225 = partitionSizze_108662 == (int64_t) 0;
    bool nonzzero_122226 = !zzero_122225;
    bool nonzzero_cert_122227;
    
    if (!nonzzero_122226) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:274:43-57\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_122228 = sdiv64(zs_lhs_122224, partitionSizze_108662);
    int64_t zm_lhs_122229 = add64(nS_108657, partitionSizze_108662);
    int64_t zs_lhs_122230 = sub64(zm_lhs_122229, (int64_t) 1);
    int64_t numIter_S_122231 = sdiv64(zs_lhs_122230, partitionSizze_108662);
    
    if (futrts_indicesWithIncrement_11438(ctx, &ext_mem_133177, tR_mem_133175, nR_108656, offset_R_108660) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_133178 = (int64_t) 8 * nR_108656;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133517 = 0; nest_i_133517 < nR_108656; nest_i_133517++) {
        ((int64_t *) mem_133179.mem)[nest_i_133517] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133181, bytes_133178, "mem_133181")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133518 = 0; nest_i_133518 < nR_108656; nest_i_133518++) {
        ((int64_t *) mem_133181.mem)[nest_i_133518] = (int64_t) 0;
    }
    
    bool loop_cond_122235 = slt64((int64_t) 0, numIter_R_122228);
    bool defunc_0_mergeJoin_res_122236;
    int64_t defunc_0_mergeJoin_res_122237;
    int64_t defunc_0_mergeJoin_res_122240;
    bool loop_while_122241;
    int64_t iter_122242;
    int64_t first_relevant_in_S_122245;
    
    if (memblock_set(ctx, &mem_param_133184, &mem_133181, "mem_133181") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &mem_133179, "mem_133179") != 0)
        return 1;
    loop_while_122241 = loop_cond_122235;
    iter_122242 = (int64_t) 0;
    first_relevant_in_S_122245 = (int64_t) 0;
    while (loop_while_122241) {
        int64_t tR_start_122246 = mul64(partitionSizze_108662, iter_122242);
        int64_t min_arg1_122247 = add64(partitionSizze_108662, tR_start_122246);
        int64_t min_res_122248 = smin64(nR_108656, min_arg1_122247);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 = sub64(min_res_122248, tR_start_122246);
        bool empty_slice_122250 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 == (int64_t) 0;
        int64_t m_122251 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, (int64_t) 1);
        int64_t i_p_m_t_s_122252 = add64(tR_start_122246, m_122251);
        bool zzero_leq_i_p_m_t_s_122253 = sle64((int64_t) 0, i_p_m_t_s_122252);
        bool i_p_m_t_s_leq_w_122254 = slt64(i_p_m_t_s_122252, nR_108656);
        bool zzero_lte_i_122255 = sle64((int64_t) 0, tR_start_122246);
        bool i_lte_j_122256 = sle64(tR_start_122246, min_res_122248);
        bool y_122257 = i_p_m_t_s_leq_w_122254 && zzero_lte_i_122255;
        bool y_122258 = zzero_leq_i_p_m_t_s_122253 && y_122257;
        bool forwards_ok_122259 = i_lte_j_122256 && y_122258;
        bool ok_or_empty_122260 = empty_slice_122250 || forwards_ok_122259;
        bool index_certs_122261;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_108656, "].", "-> #0  ftSMJ.fut:281:17-36\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133188 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249;
        bool cond_122265 = slt64(first_relevant_in_S_122245, numIter_S_122231);
        bool y_122266 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool loop_not_taken_122267 = !cond_122265;
        bool protect_assert_disj_122268 = y_122266 || loop_not_taken_122267;
        bool index_certs_122269;
        
        if (!protect_assert_disj_122268) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:296:26-34\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_122272 = sle64((int64_t) 0, m_122251);
        bool y_122273 = slt64(m_122251, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool bounds_check_122274 = x_122272 && y_122273;
        bool protect_assert_disj_122275 = loop_not_taken_122267 || bounds_check_122274;
        bool index_certs_122276;
        
        if (!protect_assert_disj_122275) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:297:28-47\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_122473;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_108656, "].", "-> #0  ftSMJ.fut:198:15-63\n   #1  ftSMJ.fut:307:20-64\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133189, bytes_133188, "mem_133189")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133526 = 0; nest_i_133526 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133526++) {
            ((int64_t *) mem_133189.mem)[nest_i_133526] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_133191, bytes_133188, "mem_133191")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133527 = 0; nest_i_133527 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133527++) {
            ((int64_t *) mem_133191.mem)[nest_i_133527] = (int64_t) 0;
        }
        
        float gt_lhs_122270;
        
        if (cond_122265) {
            float x_129472 = ((float *) tR_mem_133175.mem)[tR_start_122246];
            
            gt_lhs_122270 = x_129472;
        } else {
            gt_lhs_122270 = 0.0F;
        }
        
        float lt_lhs_122277;
        
        if (cond_122265) {
            float x_129473 = ((float *) tR_mem_133175.mem)[i_p_m_t_s_122252];
            
            lt_lhs_122277 = x_129473;
        } else {
            lt_lhs_122277 = 0.0F;
        }
        
        int64_t ext_133229;
        int64_t ext_133228;
        int64_t ext_133227;
        int64_t ext_133226;
        bool loopres_122279;
        int64_t loopres_122280;
        int64_t loopres_122283;
        bool loop_while_122284;
        int64_t s_iter_122285;
        int64_t minRelevant_122288;
        int64_t ctx_param_ext_133192;
        int64_t ctx_param_ext_133193;
        int64_t ctx_param_ext_133195;
        int64_t ctx_param_ext_133196;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133197, &mem_133189, "mem_133189") != 0)
            return 1;
        ctx_param_ext_133192 = (int64_t) 0;
        ctx_param_ext_133193 = (int64_t) 1;
        ctx_param_ext_133195 = (int64_t) 0;
        ctx_param_ext_133196 = (int64_t) 1;
        loop_while_122284 = cond_122265;
        s_iter_122285 = first_relevant_in_S_122245;
        minRelevant_122288 = first_relevant_in_S_122245;
        while (loop_while_122284) {
            int64_t tS_start_122289 = mul64(partitionSizze_108662, s_iter_122285);
            int64_t min_arg1_122290 = add64(partitionSizze_108662, tS_start_122289);
            int64_t min_res_122291 = smin64(nS_108657, min_arg1_122290);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 = sub64(min_res_122291, tS_start_122289);
            bool empty_slice_122293 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 == (int64_t) 0;
            int64_t m_122294 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 1);
            int64_t i_p_m_t_s_122295 = add64(tS_start_122289, m_122294);
            bool zzero_leq_i_p_m_t_s_122296 = sle64((int64_t) 0, i_p_m_t_s_122295);
            bool i_p_m_t_s_leq_w_122297 = slt64(i_p_m_t_s_122295, nS_108657);
            bool zzero_lte_i_122298 = sle64((int64_t) 0, tS_start_122289);
            bool i_lte_j_122299 = sle64(tS_start_122289, min_res_122291);
            bool y_122300 = i_p_m_t_s_leq_w_122297 && zzero_lte_i_122298;
            bool y_122301 = zzero_leq_i_p_m_t_s_122296 && y_122300;
            bool forwards_ok_122302 = i_lte_j_122299 && y_122301;
            bool ok_or_empty_122303 = empty_slice_122293 || forwards_ok_122302;
            bool index_certs_122304;
            
            if (!ok_or_empty_122303) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_122289, ":", (long long) min_res_122291, "] out of bounds for array of shape [", (long long) nS_108657, "].", "-> #0  ftSMJ.fut:294:19-38\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_122305 = sle64((int64_t) 0, m_122294);
            bool y_122306 = slt64(m_122294, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool bounds_check_122307 = x_122305 && y_122306;
            bool index_certs_122308;
            
            if (!bounds_check_122307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122294, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:296:40-59\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_122311 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool index_certs_122312;
            
            if (!y_122311) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:297:53-61\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float gt_rhs_122309 = ((float *) tS_mem_133176.mem)[i_p_m_t_s_122295];
            bool defunc_0_gt_res_122310 = gt_rhs_122309 < gt_lhs_122270;
            float lt_rhs_122313 = ((float *) tS_mem_133176.mem)[tS_start_122289];
            bool defunc_0_lt_res_122314 = lt_lhs_122277 < lt_rhs_122313;
            bool thisStillRel_122315 = !defunc_0_lt_res_122314;
            int64_t ext_133218;
            
            if (defunc_0_lt_res_122314) {
                ext_133218 = ctx_param_ext_133192;
            } else {
                ext_133218 = (int64_t) 0;
            }
            
            int64_t ext_133217;
            
            if (defunc_0_lt_res_122314) {
                ext_133217 = ctx_param_ext_133193;
            } else {
                ext_133217 = (int64_t) 1;
            }
            
            int64_t ext_133215;
            
            if (defunc_0_lt_res_122314) {
                ext_133215 = ctx_param_ext_133195;
            } else {
                ext_133215 = (int64_t) 0;
            }
            
            int64_t ext_133214;
            
            if (defunc_0_lt_res_122314) {
                ext_133214 = ctx_param_ext_133196;
            } else {
                ext_133214 = (int64_t) 1;
            }
            
            int64_t ext_133224;
            
            if (defunc_0_gt_res_122310) {
                ext_133224 = ctx_param_ext_133192;
            } else {
                ext_133224 = ext_133218;
            }
            
            int64_t ext_133223;
            
            if (defunc_0_gt_res_122310) {
                ext_133223 = ctx_param_ext_133193;
            } else {
                ext_133223 = ext_133217;
            }
            
            int64_t ext_133221;
            
            if (defunc_0_gt_res_122310) {
                ext_133221 = ctx_param_ext_133195;
            } else {
                ext_133221 = ext_133215;
            }
            
            int64_t ext_133220;
            
            if (defunc_0_gt_res_122310) {
                ext_133220 = ctx_param_ext_133196;
            } else {
                ext_133220 = ext_133214;
            }
            
            int64_t loopres_122316;
            bool loopres_122319;
            int64_t loopres_122320;
            
            if (defunc_0_gt_res_122310) {
                int64_t tmp_129474 = add64((int64_t) 1, s_iter_122285);
                
                if (memblock_set(ctx, &ext_mem_133225, &mem_param_133194, "mem_param_133194") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &mem_param_133197, "mem_param_133197") != 0)
                    return 1;
                loopres_122316 = tmp_129474;
                loopres_122319 = 1;
                loopres_122320 = tmp_129474;
            } else {
                int64_t loopres_f_res_122322;
                bool loopres_f_res_122325;
                
                if (defunc_0_lt_res_122314) {
                    if (memblock_set(ctx, &ext_mem_133219, &mem_param_133194, "mem_param_133194") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_param_133197, "mem_param_133197") != 0)
                        return 1;
                    loopres_f_res_122322 = s_iter_122285;
                    loopres_f_res_122325 = thisStillRel_122315;
                } else {
                    bool index_certs_122326;
                    
                    if (!bounds_check_122274) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:301:25-44\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lt_lhs_122327 = ((float *) tR_mem_133175.mem)[i_p_m_t_s_122252];
                    bool defunc_0_lt_res_122328 = lt_lhs_122327 < gt_rhs_122309;
                    bool nextRel_122329 = !defunc_0_lt_res_122328;
                    int64_t find_joinTuples_arg3_122330 = add64(offset_S_108661, tS_start_122289);
                    int64_t max_arg1_122331 = sdiv64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 2);
                    int64_t max_res_122332 = smax64((int64_t) 1, max_arg1_122331);
                    bool loop_cond_122333 = slt64((int64_t) 0, max_res_122332);
                    
                    if (memblock_alloc(ctx, &mem_133199, bytes_133188, "mem_133199")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_133201, bytes_133188, "mem_133201")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_133044 = 0; i_133044 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; i_133044++) {
                        int64_t eta_p_129190 = ((int64_t *) mem_param_133194.mem)[ctx_param_ext_133192 + i_133044 * ctx_param_ext_133193];
                        int64_t slice_133152 = tR_start_122246 + i_133044;
                        float eta_p_129191 = ((float *) tR_mem_133175.mem)[slice_133152];
                        int64_t eta_p_129192 = ((int64_t *) mem_param_133197.mem)[ctx_param_ext_133195 + i_133044 * ctx_param_ext_133196];
                        bool defunc_0_f_res_129193;
                        int64_t defunc_0_f_res_129194;
                        int64_t defunc_0_f_res_129195;
                        bool loop_while_129196;
                        int64_t first_match_129197;
                        int64_t step_129198;
                        
                        loop_while_129196 = loop_cond_122333;
                        first_match_129197 = (int64_t) 0;
                        step_129198 = max_res_122332;
                        while (loop_while_129196) {
                            bool x_129199 = sle64((int64_t) 0, first_match_129197);
                            bool y_129200 = slt64(first_match_129197, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                            bool bounds_check_129201 = x_129199 && y_129200;
                            bool index_certs_129202;
                            
                            if (!bounds_check_129201) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) first_match_129197, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:220:20-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129203 = tS_start_122289 + first_match_129197;
                            float sv_129204 = ((float *) tS_mem_133176.mem)[slice_129203];
                            bool cond_129205 = first_match_129197 == (int64_t) 0;
                            float pv_129206;
                            
                            if (cond_129205) {
                                pv_129206 = sv_129204;
                            } else {
                                int64_t tmp_129207 = sub64(first_match_129197, (int64_t) 1);
                                bool x_129208 = sle64((int64_t) 0, tmp_129207);
                                bool y_129209 = slt64(tmp_129207, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129210 = x_129208 && y_129209;
                                bool index_certs_129211;
                                
                                if (!bounds_check_129210) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129207, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:221:51-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129212 = tS_start_122289 + tmp_129207;
                                float pv_f_res_129213 = ((float *) tS_mem_133176.mem)[slice_129212];
                                
                                pv_129206 = pv_f_res_129213;
                            }
                            
                            bool cond_129214 = first_match_129197 == m_122294;
                            float nv_129215;
                            
                            if (cond_129214) {
                                nv_129215 = sv_129204;
                            } else {
                                int64_t tmp_129216 = add64((int64_t) 1, first_match_129197);
                                bool x_129217 = sle64((int64_t) 0, tmp_129216);
                                bool y_129218 = slt64(tmp_129216, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129219 = x_129217 && y_129218;
                                bool index_certs_129220;
                                
                                if (!bounds_check_129219) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129216, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:222:54-71\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129221 = tS_start_122289 + tmp_129216;
                                float nv_f_res_129222 = ((float *) tS_mem_133176.mem)[slice_129221];
                                
                                nv_129215 = nv_f_res_129222;
                            }
                            
                            bool defunc_0_eq_res_129223 = eta_p_129191 == sv_129204;
                            bool defunc_0_gt_res_129224 = pv_129206 < eta_p_129191;
                            bool x_129225 = !cond_129205;
                            bool y_129226 = defunc_0_gt_res_129224 && x_129225;
                            bool cond_t_res_129227 = cond_129205 || y_129226;
                            bool x_129228 = defunc_0_eq_res_129223 && cond_t_res_129227;
                            int64_t loopres_129229;
                            int64_t loopres_129230;
                            
                            if (x_129228) {
                                loopres_129229 = first_match_129197;
                                loopres_129230 = (int64_t) 0;
                            } else {
                                int64_t loopres_f_res_129231;
                                int64_t loopres_f_res_129232;
                                
                                if (defunc_0_eq_res_129223) {
                                    int64_t tmp_129475 = sub64(first_match_129197, step_129198);
                                    int64_t max_arg1_129476 = sdiv64(step_129198, (int64_t) 2);
                                    int64_t max_res_129477 = smax64((int64_t) 1, max_arg1_129476);
                                    
                                    loopres_f_res_129231 = tmp_129475;
                                    loopres_f_res_129232 = max_res_129477;
                                } else {
                                    bool defunc_0_lt_res_129236 = eta_p_129191 < sv_129204;
                                    int64_t loopres_f_res_f_res_129237;
                                    int64_t loopres_f_res_f_res_129238;
                                    
                                    if (defunc_0_lt_res_129236) {
                                        int64_t loopres_f_res_f_res_t_res_129478;
                                        int64_t loopres_f_res_f_res_t_res_129479;
                                        
                                        if (cond_t_res_129227) {
                                            loopres_f_res_f_res_t_res_129478 = (int64_t) -1;
                                            loopres_f_res_f_res_t_res_129479 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129480 = sub64(first_match_129197, step_129198);
                                            int64_t max_arg1_129481 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129482 = smax64((int64_t) 1, max_arg1_129481);
                                            
                                            loopres_f_res_f_res_t_res_129478 = tmp_129480;
                                            loopres_f_res_f_res_t_res_129479 = max_res_129482;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_t_res_129478;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_t_res_129479;
                                    } else {
                                        bool defunc_0_lt_res_129246 = eta_p_129191 < nv_129215;
                                        bool x_129247 = !cond_129214;
                                        bool y_129248 = defunc_0_lt_res_129246 && x_129247;
                                        bool cond_129249 = cond_129214 || y_129248;
                                        int64_t loopres_f_res_f_res_f_res_129250;
                                        int64_t loopres_f_res_f_res_f_res_129251;
                                        
                                        if (cond_129249) {
                                            loopres_f_res_f_res_f_res_129250 = (int64_t) -1;
                                            loopres_f_res_f_res_f_res_129251 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129252 = add64(first_match_129197, step_129198);
                                            int64_t max_arg1_129253 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129254 = smax64((int64_t) 1, max_arg1_129253);
                                            
                                            loopres_f_res_f_res_f_res_129250 = tmp_129252;
                                            loopres_f_res_f_res_f_res_129251 = max_res_129254;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_f_res_129250;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_f_res_129251;
                                    }
                                    loopres_f_res_129231 = loopres_f_res_f_res_129237;
                                    loopres_f_res_129232 = loopres_f_res_f_res_129238;
                                }
                                loopres_129229 = loopres_f_res_129231;
                                loopres_129230 = loopres_f_res_129232;
                            }
                            
                            bool loop_cond_129255 = slt64((int64_t) 0, loopres_129230);
                            bool loop_while_tmp_133541 = loop_cond_129255;
                            int64_t first_match_tmp_133542 = loopres_129229;
                            int64_t step_tmp_133543 = loopres_129230;
                            
                            loop_while_129196 = loop_while_tmp_133541;
                            first_match_129197 = first_match_tmp_133542;
                            step_129198 = step_tmp_133543;
                        }
                        defunc_0_f_res_129193 = loop_while_129196;
                        defunc_0_f_res_129194 = first_match_129197;
                        defunc_0_f_res_129195 = step_129198;
                        
                        int64_t zs_lhs_129256 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, defunc_0_f_res_129194);
                        int64_t max_arg1_129257 = sdiv64(zs_lhs_129256, (int64_t) 2);
                        int64_t max_res_129258 = smax64((int64_t) 1, max_arg1_129257);
                        bool cond_129259 = defunc_0_f_res_129194 == (int64_t) -1;
                        int64_t defunc_0_f_res_129260;
                        
                        if (cond_129259) {
                            defunc_0_f_res_129260 = (int64_t) -1;
                        } else {
                            bool loop_cond_129262 = slt64((int64_t) 0, max_res_129258);
                            bool defunc_0_f_res_f_res_129263;
                            int64_t defunc_0_f_res_f_res_129264;
                            int64_t defunc_0_f_res_f_res_129265;
                            bool loop_while_129266;
                            int64_t last_match_129267;
                            int64_t step_129268;
                            
                            loop_while_129266 = loop_cond_129262;
                            last_match_129267 = m_122294;
                            step_129268 = max_res_129258;
                            while (loop_while_129266) {
                                bool x_129269 = sle64((int64_t) 0, last_match_129267);
                                bool y_129270 = slt64(last_match_129267, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129271 = x_129269 && y_129270;
                                bool index_certs_129272;
                                
                                if (!bounds_check_129271) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) last_match_129267, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:241:20-34\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129273 = tS_start_122289 + last_match_129267;
                                float sv_129274 = ((float *) tS_mem_133176.mem)[slice_129273];
                                bool cond_129275 = last_match_129267 == m_122294;
                                float nv_129276;
                                
                                if (cond_129275) {
                                    nv_129276 = sv_129274;
                                } else {
                                    int64_t tmp_129277 = add64((int64_t) 1, last_match_129267);
                                    bool x_129278 = sle64((int64_t) 0, tmp_129277);
                                    bool y_129279 = slt64(tmp_129277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                    bool bounds_check_129280 = x_129278 && y_129279;
                                    bool index_certs_129281;
                                    
                                    if (!bounds_check_129280) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:242:53-69\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129282 = tS_start_122289 + tmp_129277;
                                    float nv_f_res_129283 = ((float *) tS_mem_133176.mem)[slice_129282];
                                    
                                    nv_129276 = nv_f_res_129283;
                                }
                                
                                bool defunc_0_eq_res_129284 = eta_p_129191 == sv_129274;
                                bool defunc_0_lt_res_129285 = eta_p_129191 < nv_129276;
                                bool x_129286 = !cond_129275;
                                bool y_129287 = defunc_0_lt_res_129285 && x_129286;
                                bool cond_t_res_129288 = cond_129275 || y_129287;
                                bool x_129289 = defunc_0_eq_res_129284 && cond_t_res_129288;
                                int64_t loopres_129290;
                                int64_t loopres_129291;
                                
                                if (x_129289) {
                                    loopres_129290 = last_match_129267;
                                    loopres_129291 = (int64_t) 0;
                                } else {
                                    int64_t loopres_f_res_129292;
                                    int64_t loopres_f_res_129293;
                                    
                                    if (defunc_0_eq_res_129284) {
                                        int64_t tmp_129483 = add64(last_match_129267, step_129268);
                                        int64_t max_arg1_129484 = sdiv64(step_129268, (int64_t) 2);
                                        int64_t max_res_129485 = smax64((int64_t) 1, max_arg1_129484);
                                        
                                        loopres_f_res_129292 = tmp_129483;
                                        loopres_f_res_129293 = max_res_129485;
                                    } else {
                                        bool defunc_0_lt_res_129297 = eta_p_129191 < sv_129274;
                                        int64_t loopres_f_res_f_res_129298;
                                        int64_t loopres_f_res_f_res_129299;
                                        
                                        if (defunc_0_lt_res_129297) {
                                            int64_t tmp_129486 = sub64(last_match_129267, step_129268);
                                            int64_t max_arg1_129487 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129488 = smax64((int64_t) 1, max_arg1_129487);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129486;
                                            loopres_f_res_f_res_129299 = max_res_129488;
                                        } else {
                                            int64_t tmp_129303 = add64(last_match_129267, step_129268);
                                            int64_t max_arg1_129304 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129305 = smax64((int64_t) 1, max_arg1_129304);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129303;
                                            loopres_f_res_f_res_129299 = max_res_129305;
                                        }
                                        loopres_f_res_129292 = loopres_f_res_f_res_129298;
                                        loopres_f_res_129293 = loopres_f_res_f_res_129299;
                                    }
                                    loopres_129290 = loopres_f_res_129292;
                                    loopres_129291 = loopres_f_res_129293;
                                }
                                
                                bool loop_cond_129306 = slt64((int64_t) 0, loopres_129291);
                                bool loop_while_tmp_133544 = loop_cond_129306;
                                int64_t last_match_tmp_133545 = loopres_129290;
                                int64_t step_tmp_133546 = loopres_129291;
                                
                                loop_while_129266 = loop_while_tmp_133544;
                                last_match_129267 = last_match_tmp_133545;
                                step_129268 = step_tmp_133546;
                            }
                            defunc_0_f_res_f_res_129263 = loop_while_129266;
                            defunc_0_f_res_f_res_129264 = last_match_129267;
                            defunc_0_f_res_f_res_129265 = step_129268;
                            defunc_0_f_res_129260 = defunc_0_f_res_f_res_129264;
                        }
                        
                        bool cond_129307 = slt64(defunc_0_f_res_129194, (int64_t) 0);
                        int64_t cm_129308;
                        
                        if (cond_129307) {
                            cm_129308 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_129309 = sub64(defunc_0_f_res_129260, defunc_0_f_res_129194);
                            int64_t cm_f_res_129310 = add64((int64_t) 1, zp_lhs_129309);
                            
                            cm_129308 = cm_f_res_129310;
                        }
                        
                        int64_t lifted_lambda_res_129314;
                        
                        if (cond_129307) {
                            lifted_lambda_res_129314 = defunc_0_f_res_129194;
                        } else {
                            int64_t lifted_lambda_res_f_res_129315 = add64(find_joinTuples_arg3_122330, defunc_0_f_res_129194);
                            
                            lifted_lambda_res_129314 = lifted_lambda_res_f_res_129315;
                        }
                        
                        bool cond_129317 = slt64(eta_p_129192, (int64_t) 0);
                        int64_t lifted_lambda_res_129318;
                        
                        if (cond_129317) {
                            lifted_lambda_res_129318 = lifted_lambda_res_129314;
                        } else {
                            lifted_lambda_res_129318 = eta_p_129192;
                        }
                        
                        int64_t defunc_0_f_res_129321 = add64(eta_p_129190, cm_129308);
                        
                        ((int64_t *) mem_133199.mem)[i_133044] = defunc_0_f_res_129321;
                        ((int64_t *) mem_133201.mem)[i_133044] = lifted_lambda_res_129318;
                    }
                    
                    int64_t tmp_122469 = add64((int64_t) 1, s_iter_122285);
                    
                    if (memblock_set(ctx, &ext_mem_133219, &mem_133199, "mem_133199") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_133201, "mem_133201") != 0)
                        return 1;
                    loopres_f_res_122322 = tmp_122469;
                    loopres_f_res_122325 = nextRel_122329;
                }
                if (memblock_set(ctx, &ext_mem_133225, &ext_mem_133219, "ext_mem_133219") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &ext_mem_133216, "ext_mem_133216") != 0)
                    return 1;
                loopres_122316 = loopres_f_res_122322;
                loopres_122319 = loopres_f_res_122325;
                loopres_122320 = minRelevant_122288;
            }
            
            bool cond_122470 = slt64(loopres_122316, numIter_S_122231);
            bool x_122471 = loopres_122319 && cond_122470;
            
            if (memblock_set(ctx, &mem_param_tmp_133528, &ext_mem_133225, "ext_mem_133225") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133529, &ext_mem_133222, "ext_mem_133222") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_133530 = ext_133224;
            int64_t ctx_param_ext_tmp_133531 = ext_133223;
            int64_t ctx_param_ext_tmp_133532 = ext_133221;
            int64_t ctx_param_ext_tmp_133533 = ext_133220;
            bool loop_while_tmp_133534 = x_122471;
            int64_t s_iter_tmp_133535 = loopres_122316;
            int64_t minRelevant_tmp_133538 = loopres_122320;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133197, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
                return 1;
            ctx_param_ext_133192 = ctx_param_ext_tmp_133530;
            ctx_param_ext_133193 = ctx_param_ext_tmp_133531;
            ctx_param_ext_133195 = ctx_param_ext_tmp_133532;
            ctx_param_ext_133196 = ctx_param_ext_tmp_133533;
            loop_while_122284 = loop_while_tmp_133534;
            s_iter_122285 = s_iter_tmp_133535;
            minRelevant_122288 = minRelevant_tmp_133538;
        }
        if (memblock_set(ctx, &ext_mem_133231, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133230, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        ext_133229 = ctx_param_ext_133192;
        ext_133228 = ctx_param_ext_133193;
        ext_133227 = ctx_param_ext_133195;
        ext_133226 = ctx_param_ext_133196;
        loopres_122279 = loop_while_122284;
        loopres_122280 = s_iter_122285;
        loopres_122283 = minRelevant_122288;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133233, bytes_133178, "mem_133233")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133187.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_108656});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133230.mem, ext_133227, (int64_t []) {ext_133226}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133235, bytes_133178, "mem_133235")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_108656});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133231.mem, ext_133229, (int64_t []) {ext_133228}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        
        int64_t tmp_122477 = add64((int64_t) 1, iter_122242);
        bool loop_cond_122478 = slt64(tmp_122477, numIter_R_122228);
        
        if (memblock_set(ctx, &mem_param_tmp_133519, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &mem_133233, "mem_133233") != 0)
            return 1;
        
        bool loop_while_tmp_133521 = loop_cond_122478;
        int64_t iter_tmp_133522 = tmp_122477;
        int64_t first_relevant_in_S_tmp_133525 = loopres_122283;
        
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        loop_while_122241 = loop_while_tmp_133521;
        iter_122242 = iter_tmp_133522;
        first_relevant_in_S_122245 = first_relevant_in_S_tmp_133525;
    }
    if (memblock_set(ctx, &ext_mem_133241, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133240, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    defunc_0_mergeJoin_res_122236 = loop_while_122241;
    defunc_0_mergeJoin_res_122237 = iter_122242;
    defunc_0_mergeJoin_res_122240 = first_relevant_in_S_122245;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
        return 1;
    if (mem_133243_cached_sizze_133700 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133243, &mem_133243_cached_sizze_133700, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133245_cached_sizze_133701 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133245, &mem_133245_cached_sizze_133701, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_133246 = (int64_t) 4 * nR_108656;
    
    if (mem_133247_cached_sizze_133702 < bytes_133246) {
        err = lexical_realloc(ctx, &mem_133247, &mem_133247_cached_sizze_133702, bytes_133246);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133249_cached_sizze_133703 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133703, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133251_cached_sizze_133704 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133251, &mem_133251_cached_sizze_133704, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133253_cached_sizze_133705 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133253, &mem_133253_cached_sizze_133705, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133255_cached_sizze_133706 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133255, &mem_133255_cached_sizze_133706, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133072;
    int64_t discard_133073;
    int64_t defunc_res_129534;
    int64_t scanacc_133054;
    int64_t scanacc_133055;
    int64_t redout_133058;
    
    scanacc_133054 = (int64_t) 0;
    scanacc_133055 = (int64_t) 0;
    redout_133058 = (int64_t) 0;
    for (int64_t i_133064 = 0; i_133064 < nR_108656; i_133064++) {
        int64_t zg_lhs_129015 = ((int64_t *) ext_mem_133241.mem)[i_133064];
        bool cond_129016 = slt64((int64_t) 0, zg_lhs_129015);
        int64_t lifted_lambda_res_129017;
        
        if (cond_129016) {
            lifted_lambda_res_129017 = i_133064;
        } else {
            lifted_lambda_res_129017 = (int64_t) -1;
        }
        
        bool cond_129019 = sle64((int64_t) 0, lifted_lambda_res_129017);
        bool cond_t_res_129020 = slt64(lifted_lambda_res_129017, nR_108656);
        bool x_129021 = cond_129019 && cond_t_res_129020;
        int64_t lifted_lambda_res_129022;
        
        if (x_129021) {
            bool index_certs_129491;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_108656, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_129492 = ((int64_t *) ext_mem_133241.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129022 = lifted_lambda_res_t_res_129492;
        } else {
            lifted_lambda_res_129022 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_129026 = slt64((int64_t) 1, lifted_lambda_res_129022);
        int64_t defunc_0_f_res_129027 = btoi_bool_i64(lifted_lambda_res_129026);
        float lifted_lambda_res_129039;
        int64_t lifted_lambda_res_129040;
        int64_t lifted_lambda_res_129041;
        
        if (x_129021) {
            bool index_certs_129493;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_108656, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:377:7-378:57\n   #4  ftRelational.fut:189:82-85\n   #5  ftRelational.fut:180:1-189:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float lifted_lambda_res_t_res_129494 = ((float *) tR_mem_133175.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129495 = ((int64_t *) ext_mem_133177.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129496 = ((int64_t *) ext_mem_133240.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129039 = lifted_lambda_res_t_res_129494;
            lifted_lambda_res_129040 = lifted_lambda_res_t_res_129495;
            lifted_lambda_res_129041 = lifted_lambda_res_t_res_129496;
        } else {
            lifted_lambda_res_129039 = 0.0F;
            lifted_lambda_res_129040 = (int64_t) -1;
            lifted_lambda_res_129041 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_122541 = add64(defunc_0_f_res_129027, scanacc_133054);
        int64_t lifted_lambda_res_122502 = add64(lifted_lambda_res_129022, scanacc_133055);
        int64_t zp_res_122522 = add64(lifted_lambda_res_129022, redout_133058);
        
        ((int64_t *) mem_133243)[i_133064] = defunc_0_op_res_122541;
        ((int64_t *) mem_133245)[i_133064] = lifted_lambda_res_122502;
        ((float *) mem_133247)[i_133064] = lifted_lambda_res_129039;
        ((int64_t *) mem_133249)[i_133064] = lifted_lambda_res_129040;
        ((int64_t *) mem_133251)[i_133064] = lifted_lambda_res_129041;
        ((int64_t *) mem_133253)[i_133064] = defunc_0_f_res_129027;
        ((int64_t *) mem_133255)[i_133064] = lifted_lambda_res_129022;
        
        int64_t scanacc_tmp_133547 = defunc_0_op_res_122541;
        int64_t scanacc_tmp_133548 = lifted_lambda_res_122502;
        int64_t redout_tmp_133551 = zp_res_122522;
        
        scanacc_133054 = scanacc_tmp_133547;
        scanacc_133055 = scanacc_tmp_133548;
        redout_133058 = redout_tmp_133551;
    }
    discard_133072 = scanacc_133054;
    discard_133073 = scanacc_133055;
    defunc_res_129534 = redout_133058;
    if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
        return 1;
    
    int64_t bytes_133306 = (int64_t) 4 * defunc_res_129534;
    int64_t bytes_133308 = (int64_t) 8 * defunc_res_129534;
    bool cond_122542 = nR_108656 == (int64_t) 0;
    bool x_122543 = !cond_122542;
    int64_t tmp_122544 = sub64(nR_108656, (int64_t) 1);
    bool x_122545 = sle64((int64_t) 0, tmp_122544);
    bool y_122546 = slt64(tmp_122544, nR_108656);
    bool bounds_check_122547 = x_122545 && y_122546;
    bool protect_assert_disj_122548 = cond_122542 || bounds_check_122547;
    bool index_certs_122549;
    
    if (!protect_assert_disj_122548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_122544, "] out of bounds for array of shape [", (long long) nR_108656, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_122550;
    
    if (x_122543) {
        int64_t x_129497 = ((int64_t *) mem_133243)[tmp_122544];
        
        m_f_res_122550 = x_129497;
    } else {
        m_f_res_122550 = (int64_t) 0;
    }
    
    int64_t m_122552;
    
    if (cond_122542) {
        m_122552 = (int64_t) 0;
    } else {
        m_122552 = m_f_res_122550;
    }
    
    bool cond_122575 = slt64((int64_t) 0, m_122552);
    int64_t m_122562 = sub64(m_122552, (int64_t) 1);
    bool i_p_m_t_s_leq_w_122564 = slt64(m_122562, nR_108656);
    bool zzero_leq_i_p_m_t_s_122563 = sle64((int64_t) 0, m_122562);
    bool y_122566 = zzero_leq_i_p_m_t_s_122563 && i_p_m_t_s_leq_w_122564;
    bool i_lte_j_122565 = sle64((int64_t) 0, m_122552);
    bool forwards_ok_122567 = i_lte_j_122565 && y_122566;
    bool eq_x_zz_122559 = (int64_t) 0 == m_f_res_122550;
    bool p_and_eq_x_y_122560 = x_122543 && eq_x_zz_122559;
    bool empty_slice_122561 = cond_122542 || p_and_eq_x_y_122560;
    bool ok_or_empty_122568 = empty_slice_122561 || forwards_ok_122567;
    bool index_certs_122569;
    
    if (!ok_or_empty_122568) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122552, "] out of bounds for array of shape [", (long long) nR_108656, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:189:82-85\n   #4  ftRelational.fut:180:1-189:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133330 = (int64_t) 8 * m_122552;
    
    if (mem_133331_cached_sizze_133708 < bytes_133330) {
        err = lexical_realloc(ctx, &mem_133331, &mem_133331_cached_sizze_133708, bytes_133330);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133331, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122552});
    
    int64_t max_mult_122576;
    
    if (cond_122575) {
        if (mem_133333_cached_sizze_133709 < bytes_133178) {
            err = lexical_realloc(ctx, &mem_133333, &mem_133333_cached_sizze_133709, bytes_133178);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133091 = 0; i_133091 < nR_108656; i_133091++) {
            int64_t eta_p_129503 = ((int64_t *) mem_133253)[i_133091];
            int64_t eta_p_129504 = ((int64_t *) mem_133243)[i_133091];
            bool cond_129505 = eta_p_129503 == (int64_t) 1;
            int64_t lifted_lambda_res_129506;
            
            if (cond_129505) {
                int64_t lifted_lambda_res_t_res_129507 = sub64(eta_p_129504, (int64_t) 1);
                
                lifted_lambda_res_129506 = lifted_lambda_res_t_res_129507;
            } else {
                lifted_lambda_res_129506 = (int64_t) -1;
            }
            ((int64_t *) mem_133333)[i_133091] = lifted_lambda_res_129506;
        }
        for (int64_t write_iter_133093 = 0; write_iter_133093 < nR_108656; write_iter_133093++) {
            int64_t write_iv_133095 = ((int64_t *) mem_133333)[write_iter_133093];
            int64_t write_iv_133096 = ((int64_t *) mem_133255)[write_iter_133093];
            
            if (sle64((int64_t) 0, write_iv_133095) && slt64(write_iv_133095, m_122552)) {
                ((int64_t *) mem_133331)[write_iv_133095] = write_iv_133096;
            }
        }
        
        int64_t defunc_0_reduce_res_129517;
        int64_t redout_133098 = (int64_t) -9223372036854775808;
        
        for (int64_t i_133099 = 0; i_133099 < m_122552; i_133099++) {
            int64_t x_129518 = ((int64_t *) mem_133331)[i_133099];
            int64_t max_res_129521 = smax64(x_129518, redout_133098);
            int64_t redout_tmp_133559 = max_res_129521;
            
            redout_133098 = redout_tmp_133559;
        }
        defunc_0_reduce_res_129517 = redout_133098;
        max_mult_122576 = defunc_0_reduce_res_129517;
    } else {
        max_mult_122576 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_122582 = slt64(max_mult_122576, (int64_t) 1);
    bool valid_122584 = !bounds_invalid_upwards_122582;
    bool range_valid_c_122585;
    
    if (!valid_122584) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_122576, " is invalid.", "-> #0  ftSMJ.fut:352:16-28\n   #1  ftSMJ.fut:377:7-378:57\n   #2  ftRelational.fut:189:82-85\n   #3  ftRelational.fut:180:1-189:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_133299_cached_sizze_133707 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133707, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133076 = 0; i_133076 < nR_108656; i_133076++) {
        int64_t eta_p_128922 = ((int64_t *) mem_133255)[i_133076];
        int64_t zv_lhs_128924 = add64((int64_t) -1, i_133076);
        int64_t tmp_128925 = smod64(zv_lhs_128924, nR_108656);
        int64_t lifted_lambda_res_128926 = ((int64_t *) mem_133245)[tmp_128925];
        bool cond_128928 = i_133076 == (int64_t) 0;
        int64_t lifted_lambda_res_128929;
        
        if (cond_128928) {
            lifted_lambda_res_128929 = (int64_t) 0;
        } else {
            lifted_lambda_res_128929 = lifted_lambda_res_128926;
        }
        
        bool cond_128931 = slt64((int64_t) 0, eta_p_128922);
        int64_t lifted_lambda_res_128932;
        
        if (cond_128931) {
            lifted_lambda_res_128932 = lifted_lambda_res_128929;
        } else {
            lifted_lambda_res_128932 = (int64_t) -1;
        }
        ((int64_t *) mem_133299)[i_133076] = lifted_lambda_res_128932;
    }
    if (memblock_alloc(ctx, &mem_133307, bytes_133306, "mem_133307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133561 = 0; nest_i_133561 < defunc_res_129534; nest_i_133561++) {
        ((float *) mem_133307.mem)[nest_i_133561] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_133309, bytes_133308, "mem_133309")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133562 = 0; nest_i_133562 < defunc_res_129534; nest_i_133562++) {
        ((int64_t *) mem_133309.mem)[nest_i_133562] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133311, bytes_133308, "mem_133311")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133563 = 0; nest_i_133563 < defunc_res_129534; nest_i_133563++) {
        ((int64_t *) mem_133311.mem)[nest_i_133563] = (int64_t) -1;
    }
    for (int64_t write_iter_133078 = 0; write_iter_133078 < nR_108656; write_iter_133078++) {
        int64_t write_iv_133082 = ((int64_t *) mem_133299)[write_iter_133078];
        float write_iv_133083 = ((float *) mem_133247)[write_iter_133078];
        int64_t write_iv_133084 = ((int64_t *) mem_133249)[write_iter_133078];
        int64_t write_iv_133085 = ((int64_t *) mem_133251)[write_iter_133078];
        
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((float *) mem_133307.mem)[write_iv_133082] = write_iv_133083;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133309.mem)[write_iv_133082] = write_iv_133084;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133311.mem)[write_iv_133082] = write_iv_133085;
        }
    }
    
    int64_t distance_122583 = sub64(max_mult_122576, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_133348, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133351, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133354, &mem_133311, "mem_133311") != 0)
        return 1;
    for (int64_t i_122589 = 0; i_122589 < distance_122583; i_122589++) {
        int64_t index_primexp_122593 = add64((int64_t) 1, i_122589);
        
        if (memblock_alloc(ctx, &mem_133356, bytes_133308, "mem_133356")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133356.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133354.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133358, bytes_133308, "mem_133358")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133360, bytes_133306, "mem_133360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_133360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133348.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        for (int64_t write_iter_133100 = 0; write_iter_133100 < nR_108656; write_iter_133100++) {
            int64_t write_iv_133105 = ((int64_t *) mem_133251)[write_iter_133100];
            float write_iv_133106 = ((float *) mem_133247)[write_iter_133100];
            int64_t write_iv_133107 = ((int64_t *) mem_133249)[write_iter_133100];
            int64_t zg_lhs_129457 = ((int64_t *) mem_133255)[write_iter_133100];
            bool cond_129458 = slt64(index_primexp_122593, zg_lhs_129457);
            int64_t lifted_lambda_res_129459;
            
            if (cond_129458) {
                int64_t zp_lhs_129527 = ((int64_t *) mem_133299)[write_iter_133100];
                int64_t lifted_lambda_res_t_res_129528 = add64(index_primexp_122593, zp_lhs_129527);
                
                lifted_lambda_res_129459 = lifted_lambda_res_t_res_129528;
            } else {
                lifted_lambda_res_129459 = (int64_t) -1;
            }
            
            int64_t tmp_129463 = add64(index_primexp_122593, write_iv_133105);
            
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((float *) mem_133360.mem)[lifted_lambda_res_129459] = write_iv_133106;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133358.mem)[lifted_lambda_res_129459] = write_iv_133107;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133356.mem)[lifted_lambda_res_129459] = tmp_129463;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_133567, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133568, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133569, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133348, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133351, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133354, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133387, &mem_param_133348, "mem_param_133348") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133386, &mem_param_133351, "mem_param_133351") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133385, &mem_param_133354, "mem_param_133354") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133389, bytes_133306, "mem_133389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133391, bytes_133308, "mem_133391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133386.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133393, bytes_133308, "mem_133393")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133393.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133391, "mem_133391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133393, "mem_133393") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133389, "mem_133389") != 0)
        return 1;
    prim_out_133516 = defunc_res_129534;
    if (memblock_set(ctx, &*mem_out_p_133696, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133697, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133698, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133699 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133243);
        free(mem_133245);
        free(mem_133247);
        free(mem_133249);
        free(mem_133251);
        free(mem_133253);
        free(mem_133255);
        free(mem_133299);
        free(mem_133331);
        free(mem_133333);
        if (memblock_unref(ctx, &mem_133393, "mem_133393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133391, "mem_133391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133389, "mem_133389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133354, "mem_param_133354") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133351, "mem_param_133351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133348, "mem_param_133348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133201, "mem_133201") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133199, "mem_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133216, "ext_mem_133216") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133219, "ext_mem_133219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133222, "ext_mem_133222") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133225, "ext_mem_133225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_133710, struct memblock *mem_out_p_133711, struct memblock *mem_out_p_133712, int64_t *out_prim_out_133713, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_104200, int64_t nS_104201, int64_t offset_R_104204, int64_t offset_S_104205, int64_t partitionSizze_104206, int64_t scatter_psizze_104207)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133243_cached_sizze_133714 = 0;
    unsigned char *mem_133243 = NULL;
    int64_t mem_133245_cached_sizze_133715 = 0;
    unsigned char *mem_133245 = NULL;
    int64_t mem_133247_cached_sizze_133716 = 0;
    unsigned char *mem_133247 = NULL;
    int64_t mem_133249_cached_sizze_133717 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133251_cached_sizze_133718 = 0;
    unsigned char *mem_133251 = NULL;
    int64_t mem_133253_cached_sizze_133719 = 0;
    unsigned char *mem_133253 = NULL;
    int64_t mem_133255_cached_sizze_133720 = 0;
    unsigned char *mem_133255 = NULL;
    int64_t mem_133299_cached_sizze_133721 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133331_cached_sizze_133722 = 0;
    unsigned char *mem_133331 = NULL;
    int64_t mem_133333_cached_sizze_133723 = 0;
    unsigned char *mem_133333 = NULL;
    struct memblock mem_133393;
    
    mem_133393.references = NULL;
    
    struct memblock mem_133391;
    
    mem_133391.references = NULL;
    
    struct memblock mem_133389;
    
    mem_133389.references = NULL;
    
    struct memblock mem_param_tmp_133569;
    
    mem_param_tmp_133569.references = NULL;
    
    struct memblock mem_param_tmp_133568;
    
    mem_param_tmp_133568.references = NULL;
    
    struct memblock mem_param_tmp_133567;
    
    mem_param_tmp_133567.references = NULL;
    
    struct memblock mem_133360;
    
    mem_133360.references = NULL;
    
    struct memblock mem_133358;
    
    mem_133358.references = NULL;
    
    struct memblock mem_133356;
    
    mem_133356.references = NULL;
    
    struct memblock mem_param_133354;
    
    mem_param_133354.references = NULL;
    
    struct memblock mem_param_133351;
    
    mem_param_133351.references = NULL;
    
    struct memblock mem_param_133348;
    
    mem_param_133348.references = NULL;
    
    struct memblock ext_mem_133385;
    
    ext_mem_133385.references = NULL;
    
    struct memblock ext_mem_133386;
    
    ext_mem_133386.references = NULL;
    
    struct memblock ext_mem_133387;
    
    ext_mem_133387.references = NULL;
    
    struct memblock mem_133311;
    
    mem_133311.references = NULL;
    
    struct memblock mem_133309;
    
    mem_133309.references = NULL;
    
    struct memblock mem_133307;
    
    mem_133307.references = NULL;
    
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_133235;
    
    mem_133235.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_param_tmp_133529;
    
    mem_param_tmp_133529.references = NULL;
    
    struct memblock mem_param_tmp_133528;
    
    mem_param_tmp_133528.references = NULL;
    
    struct memblock mem_133201;
    
    mem_133201.references = NULL;
    
    struct memblock mem_133199;
    
    mem_133199.references = NULL;
    
    struct memblock ext_mem_133216;
    
    ext_mem_133216.references = NULL;
    
    struct memblock ext_mem_133219;
    
    ext_mem_133219.references = NULL;
    
    struct memblock ext_mem_133222;
    
    ext_mem_133222.references = NULL;
    
    struct memblock ext_mem_133225;
    
    ext_mem_133225.references = NULL;
    
    struct memblock mem_param_133197;
    
    mem_param_133197.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133230;
    
    ext_mem_133230.references = NULL;
    
    struct memblock ext_mem_133231;
    
    ext_mem_133231.references = NULL;
    
    struct memblock mem_133191;
    
    mem_133191.references = NULL;
    
    struct memblock mem_133189;
    
    mem_133189.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock ext_mem_133240;
    
    ext_mem_133240.references = NULL;
    
    struct memblock ext_mem_133241;
    
    ext_mem_133241.references = NULL;
    
    struct memblock mem_133181;
    
    mem_133181.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock ext_mem_133177;
    
    ext_mem_133177.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t zm_lhs_122223 = add64(nR_104200, partitionSizze_104206);
    int64_t zs_lhs_122224 = sub64(zm_lhs_122223, (int64_t) 1);
    bool zzero_122225 = partitionSizze_104206 == (int64_t) 0;
    bool nonzzero_122226 = !zzero_122225;
    bool nonzzero_cert_122227;
    
    if (!nonzzero_122226) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:274:43-57\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_122228 = sdiv64(zs_lhs_122224, partitionSizze_104206);
    int64_t zm_lhs_122229 = add64(nS_104201, partitionSizze_104206);
    int64_t zs_lhs_122230 = sub64(zm_lhs_122229, (int64_t) 1);
    int64_t numIter_S_122231 = sdiv64(zs_lhs_122230, partitionSizze_104206);
    
    if (futrts_indicesWithIncrement_11394(ctx, &ext_mem_133177, tR_mem_133175, nR_104200, offset_R_104204) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_133178 = (int64_t) 8 * nR_104200;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133517 = 0; nest_i_133517 < nR_104200; nest_i_133517++) {
        ((int64_t *) mem_133179.mem)[nest_i_133517] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133181, bytes_133178, "mem_133181")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133518 = 0; nest_i_133518 < nR_104200; nest_i_133518++) {
        ((int64_t *) mem_133181.mem)[nest_i_133518] = (int64_t) 0;
    }
    
    bool loop_cond_122235 = slt64((int64_t) 0, numIter_R_122228);
    bool defunc_0_mergeJoin_res_122236;
    int64_t defunc_0_mergeJoin_res_122237;
    int64_t defunc_0_mergeJoin_res_122240;
    bool loop_while_122241;
    int64_t iter_122242;
    int64_t first_relevant_in_S_122245;
    
    if (memblock_set(ctx, &mem_param_133184, &mem_133181, "mem_133181") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &mem_133179, "mem_133179") != 0)
        return 1;
    loop_while_122241 = loop_cond_122235;
    iter_122242 = (int64_t) 0;
    first_relevant_in_S_122245 = (int64_t) 0;
    while (loop_while_122241) {
        int64_t tR_start_122246 = mul64(partitionSizze_104206, iter_122242);
        int64_t min_arg1_122247 = add64(partitionSizze_104206, tR_start_122246);
        int64_t min_res_122248 = smin64(nR_104200, min_arg1_122247);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 = sub64(min_res_122248, tR_start_122246);
        bool empty_slice_122250 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 == (int64_t) 0;
        int64_t m_122251 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, (int64_t) 1);
        int64_t i_p_m_t_s_122252 = add64(tR_start_122246, m_122251);
        bool zzero_leq_i_p_m_t_s_122253 = sle64((int64_t) 0, i_p_m_t_s_122252);
        bool i_p_m_t_s_leq_w_122254 = slt64(i_p_m_t_s_122252, nR_104200);
        bool zzero_lte_i_122255 = sle64((int64_t) 0, tR_start_122246);
        bool i_lte_j_122256 = sle64(tR_start_122246, min_res_122248);
        bool y_122257 = i_p_m_t_s_leq_w_122254 && zzero_lte_i_122255;
        bool y_122258 = zzero_leq_i_p_m_t_s_122253 && y_122257;
        bool forwards_ok_122259 = i_lte_j_122256 && y_122258;
        bool ok_or_empty_122260 = empty_slice_122250 || forwards_ok_122259;
        bool index_certs_122261;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_104200, "].", "-> #0  ftSMJ.fut:281:17-36\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133188 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249;
        bool cond_122265 = slt64(first_relevant_in_S_122245, numIter_S_122231);
        bool y_122266 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool loop_not_taken_122267 = !cond_122265;
        bool protect_assert_disj_122268 = y_122266 || loop_not_taken_122267;
        bool index_certs_122269;
        
        if (!protect_assert_disj_122268) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:296:26-34\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_122272 = sle64((int64_t) 0, m_122251);
        bool y_122273 = slt64(m_122251, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool bounds_check_122274 = x_122272 && y_122273;
        bool protect_assert_disj_122275 = loop_not_taken_122267 || bounds_check_122274;
        bool index_certs_122276;
        
        if (!protect_assert_disj_122275) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:297:28-47\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_122473;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_104200, "].", "-> #0  ftSMJ.fut:198:15-63\n   #1  ftSMJ.fut:307:20-64\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133189, bytes_133188, "mem_133189")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133526 = 0; nest_i_133526 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133526++) {
            ((int64_t *) mem_133189.mem)[nest_i_133526] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_133191, bytes_133188, "mem_133191")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133527 = 0; nest_i_133527 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133527++) {
            ((int64_t *) mem_133191.mem)[nest_i_133527] = (int64_t) 0;
        }
        
        int32_t gt_lhs_122270;
        
        if (cond_122265) {
            int32_t x_129472 = ((int32_t *) tR_mem_133175.mem)[tR_start_122246];
            
            gt_lhs_122270 = x_129472;
        } else {
            gt_lhs_122270 = 0;
        }
        
        int32_t lt_lhs_122277;
        
        if (cond_122265) {
            int32_t x_129473 = ((int32_t *) tR_mem_133175.mem)[i_p_m_t_s_122252];
            
            lt_lhs_122277 = x_129473;
        } else {
            lt_lhs_122277 = 0;
        }
        
        int64_t ext_133229;
        int64_t ext_133228;
        int64_t ext_133227;
        int64_t ext_133226;
        bool loopres_122279;
        int64_t loopres_122280;
        int64_t loopres_122283;
        bool loop_while_122284;
        int64_t s_iter_122285;
        int64_t minRelevant_122288;
        int64_t ctx_param_ext_133192;
        int64_t ctx_param_ext_133193;
        int64_t ctx_param_ext_133195;
        int64_t ctx_param_ext_133196;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133197, &mem_133189, "mem_133189") != 0)
            return 1;
        ctx_param_ext_133192 = (int64_t) 0;
        ctx_param_ext_133193 = (int64_t) 1;
        ctx_param_ext_133195 = (int64_t) 0;
        ctx_param_ext_133196 = (int64_t) 1;
        loop_while_122284 = cond_122265;
        s_iter_122285 = first_relevant_in_S_122245;
        minRelevant_122288 = first_relevant_in_S_122245;
        while (loop_while_122284) {
            int64_t tS_start_122289 = mul64(partitionSizze_104206, s_iter_122285);
            int64_t min_arg1_122290 = add64(partitionSizze_104206, tS_start_122289);
            int64_t min_res_122291 = smin64(nS_104201, min_arg1_122290);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 = sub64(min_res_122291, tS_start_122289);
            bool empty_slice_122293 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 == (int64_t) 0;
            int64_t m_122294 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 1);
            int64_t i_p_m_t_s_122295 = add64(tS_start_122289, m_122294);
            bool zzero_leq_i_p_m_t_s_122296 = sle64((int64_t) 0, i_p_m_t_s_122295);
            bool i_p_m_t_s_leq_w_122297 = slt64(i_p_m_t_s_122295, nS_104201);
            bool zzero_lte_i_122298 = sle64((int64_t) 0, tS_start_122289);
            bool i_lte_j_122299 = sle64(tS_start_122289, min_res_122291);
            bool y_122300 = i_p_m_t_s_leq_w_122297 && zzero_lte_i_122298;
            bool y_122301 = zzero_leq_i_p_m_t_s_122296 && y_122300;
            bool forwards_ok_122302 = i_lte_j_122299 && y_122301;
            bool ok_or_empty_122303 = empty_slice_122293 || forwards_ok_122302;
            bool index_certs_122304;
            
            if (!ok_or_empty_122303) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_122289, ":", (long long) min_res_122291, "] out of bounds for array of shape [", (long long) nS_104201, "].", "-> #0  ftSMJ.fut:294:19-38\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_122305 = sle64((int64_t) 0, m_122294);
            bool y_122306 = slt64(m_122294, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool bounds_check_122307 = x_122305 && y_122306;
            bool index_certs_122308;
            
            if (!bounds_check_122307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122294, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:296:40-59\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_122311 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool index_certs_122312;
            
            if (!y_122311) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:297:53-61\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t gt_rhs_122309 = ((int32_t *) tS_mem_133176.mem)[i_p_m_t_s_122295];
            bool defunc_0_gt_res_122310 = slt32(gt_rhs_122309, gt_lhs_122270);
            int32_t lt_rhs_122313 = ((int32_t *) tS_mem_133176.mem)[tS_start_122289];
            bool defunc_0_lt_res_122314 = slt32(lt_lhs_122277, lt_rhs_122313);
            bool thisStillRel_122315 = !defunc_0_lt_res_122314;
            int64_t ext_133218;
            
            if (defunc_0_lt_res_122314) {
                ext_133218 = ctx_param_ext_133192;
            } else {
                ext_133218 = (int64_t) 0;
            }
            
            int64_t ext_133217;
            
            if (defunc_0_lt_res_122314) {
                ext_133217 = ctx_param_ext_133193;
            } else {
                ext_133217 = (int64_t) 1;
            }
            
            int64_t ext_133215;
            
            if (defunc_0_lt_res_122314) {
                ext_133215 = ctx_param_ext_133195;
            } else {
                ext_133215 = (int64_t) 0;
            }
            
            int64_t ext_133214;
            
            if (defunc_0_lt_res_122314) {
                ext_133214 = ctx_param_ext_133196;
            } else {
                ext_133214 = (int64_t) 1;
            }
            
            int64_t ext_133224;
            
            if (defunc_0_gt_res_122310) {
                ext_133224 = ctx_param_ext_133192;
            } else {
                ext_133224 = ext_133218;
            }
            
            int64_t ext_133223;
            
            if (defunc_0_gt_res_122310) {
                ext_133223 = ctx_param_ext_133193;
            } else {
                ext_133223 = ext_133217;
            }
            
            int64_t ext_133221;
            
            if (defunc_0_gt_res_122310) {
                ext_133221 = ctx_param_ext_133195;
            } else {
                ext_133221 = ext_133215;
            }
            
            int64_t ext_133220;
            
            if (defunc_0_gt_res_122310) {
                ext_133220 = ctx_param_ext_133196;
            } else {
                ext_133220 = ext_133214;
            }
            
            int64_t loopres_122316;
            bool loopres_122319;
            int64_t loopres_122320;
            
            if (defunc_0_gt_res_122310) {
                int64_t tmp_129474 = add64((int64_t) 1, s_iter_122285);
                
                if (memblock_set(ctx, &ext_mem_133225, &mem_param_133194, "mem_param_133194") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &mem_param_133197, "mem_param_133197") != 0)
                    return 1;
                loopres_122316 = tmp_129474;
                loopres_122319 = 1;
                loopres_122320 = tmp_129474;
            } else {
                int64_t loopres_f_res_122322;
                bool loopres_f_res_122325;
                
                if (defunc_0_lt_res_122314) {
                    if (memblock_set(ctx, &ext_mem_133219, &mem_param_133194, "mem_param_133194") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_param_133197, "mem_param_133197") != 0)
                        return 1;
                    loopres_f_res_122322 = s_iter_122285;
                    loopres_f_res_122325 = thisStillRel_122315;
                } else {
                    bool index_certs_122326;
                    
                    if (!bounds_check_122274) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:301:25-44\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lt_lhs_122327 = ((int32_t *) tR_mem_133175.mem)[i_p_m_t_s_122252];
                    bool defunc_0_lt_res_122328 = slt32(lt_lhs_122327, gt_rhs_122309);
                    bool nextRel_122329 = !defunc_0_lt_res_122328;
                    int64_t find_joinTuples_arg3_122330 = add64(offset_S_104205, tS_start_122289);
                    int64_t max_arg1_122331 = sdiv64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 2);
                    int64_t max_res_122332 = smax64((int64_t) 1, max_arg1_122331);
                    bool loop_cond_122333 = slt64((int64_t) 0, max_res_122332);
                    
                    if (memblock_alloc(ctx, &mem_133199, bytes_133188, "mem_133199")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_133201, bytes_133188, "mem_133201")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_133044 = 0; i_133044 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; i_133044++) {
                        int64_t eta_p_129190 = ((int64_t *) mem_param_133194.mem)[ctx_param_ext_133192 + i_133044 * ctx_param_ext_133193];
                        int64_t slice_133152 = tR_start_122246 + i_133044;
                        int32_t eta_p_129191 = ((int32_t *) tR_mem_133175.mem)[slice_133152];
                        int64_t eta_p_129192 = ((int64_t *) mem_param_133197.mem)[ctx_param_ext_133195 + i_133044 * ctx_param_ext_133196];
                        bool defunc_0_f_res_129193;
                        int64_t defunc_0_f_res_129194;
                        int64_t defunc_0_f_res_129195;
                        bool loop_while_129196;
                        int64_t first_match_129197;
                        int64_t step_129198;
                        
                        loop_while_129196 = loop_cond_122333;
                        first_match_129197 = (int64_t) 0;
                        step_129198 = max_res_122332;
                        while (loop_while_129196) {
                            bool x_129199 = sle64((int64_t) 0, first_match_129197);
                            bool y_129200 = slt64(first_match_129197, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                            bool bounds_check_129201 = x_129199 && y_129200;
                            bool index_certs_129202;
                            
                            if (!bounds_check_129201) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) first_match_129197, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:220:20-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129203 = tS_start_122289 + first_match_129197;
                            int32_t sv_129204 = ((int32_t *) tS_mem_133176.mem)[slice_129203];
                            bool cond_129205 = first_match_129197 == (int64_t) 0;
                            int32_t pv_129206;
                            
                            if (cond_129205) {
                                pv_129206 = sv_129204;
                            } else {
                                int64_t tmp_129207 = sub64(first_match_129197, (int64_t) 1);
                                bool x_129208 = sle64((int64_t) 0, tmp_129207);
                                bool y_129209 = slt64(tmp_129207, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129210 = x_129208 && y_129209;
                                bool index_certs_129211;
                                
                                if (!bounds_check_129210) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129207, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:221:51-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129212 = tS_start_122289 + tmp_129207;
                                int32_t pv_f_res_129213 = ((int32_t *) tS_mem_133176.mem)[slice_129212];
                                
                                pv_129206 = pv_f_res_129213;
                            }
                            
                            bool cond_129214 = first_match_129197 == m_122294;
                            int32_t nv_129215;
                            
                            if (cond_129214) {
                                nv_129215 = sv_129204;
                            } else {
                                int64_t tmp_129216 = add64((int64_t) 1, first_match_129197);
                                bool x_129217 = sle64((int64_t) 0, tmp_129216);
                                bool y_129218 = slt64(tmp_129216, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129219 = x_129217 && y_129218;
                                bool index_certs_129220;
                                
                                if (!bounds_check_129219) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129216, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:222:54-71\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129221 = tS_start_122289 + tmp_129216;
                                int32_t nv_f_res_129222 = ((int32_t *) tS_mem_133176.mem)[slice_129221];
                                
                                nv_129215 = nv_f_res_129222;
                            }
                            
                            bool defunc_0_eq_res_129223 = eta_p_129191 == sv_129204;
                            bool defunc_0_gt_res_129224 = slt32(pv_129206, eta_p_129191);
                            bool x_129225 = !cond_129205;
                            bool y_129226 = defunc_0_gt_res_129224 && x_129225;
                            bool cond_t_res_129227 = cond_129205 || y_129226;
                            bool x_129228 = defunc_0_eq_res_129223 && cond_t_res_129227;
                            int64_t loopres_129229;
                            int64_t loopres_129230;
                            
                            if (x_129228) {
                                loopres_129229 = first_match_129197;
                                loopres_129230 = (int64_t) 0;
                            } else {
                                int64_t loopres_f_res_129231;
                                int64_t loopres_f_res_129232;
                                
                                if (defunc_0_eq_res_129223) {
                                    int64_t tmp_129475 = sub64(first_match_129197, step_129198);
                                    int64_t max_arg1_129476 = sdiv64(step_129198, (int64_t) 2);
                                    int64_t max_res_129477 = smax64((int64_t) 1, max_arg1_129476);
                                    
                                    loopres_f_res_129231 = tmp_129475;
                                    loopres_f_res_129232 = max_res_129477;
                                } else {
                                    bool defunc_0_lt_res_129236 = slt32(eta_p_129191, sv_129204);
                                    int64_t loopres_f_res_f_res_129237;
                                    int64_t loopres_f_res_f_res_129238;
                                    
                                    if (defunc_0_lt_res_129236) {
                                        int64_t loopres_f_res_f_res_t_res_129478;
                                        int64_t loopres_f_res_f_res_t_res_129479;
                                        
                                        if (cond_t_res_129227) {
                                            loopres_f_res_f_res_t_res_129478 = (int64_t) -1;
                                            loopres_f_res_f_res_t_res_129479 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129480 = sub64(first_match_129197, step_129198);
                                            int64_t max_arg1_129481 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129482 = smax64((int64_t) 1, max_arg1_129481);
                                            
                                            loopres_f_res_f_res_t_res_129478 = tmp_129480;
                                            loopres_f_res_f_res_t_res_129479 = max_res_129482;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_t_res_129478;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_t_res_129479;
                                    } else {
                                        bool defunc_0_lt_res_129246 = slt32(eta_p_129191, nv_129215);
                                        bool x_129247 = !cond_129214;
                                        bool y_129248 = defunc_0_lt_res_129246 && x_129247;
                                        bool cond_129249 = cond_129214 || y_129248;
                                        int64_t loopres_f_res_f_res_f_res_129250;
                                        int64_t loopres_f_res_f_res_f_res_129251;
                                        
                                        if (cond_129249) {
                                            loopres_f_res_f_res_f_res_129250 = (int64_t) -1;
                                            loopres_f_res_f_res_f_res_129251 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129252 = add64(first_match_129197, step_129198);
                                            int64_t max_arg1_129253 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129254 = smax64((int64_t) 1, max_arg1_129253);
                                            
                                            loopres_f_res_f_res_f_res_129250 = tmp_129252;
                                            loopres_f_res_f_res_f_res_129251 = max_res_129254;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_f_res_129250;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_f_res_129251;
                                    }
                                    loopres_f_res_129231 = loopres_f_res_f_res_129237;
                                    loopres_f_res_129232 = loopres_f_res_f_res_129238;
                                }
                                loopres_129229 = loopres_f_res_129231;
                                loopres_129230 = loopres_f_res_129232;
                            }
                            
                            bool loop_cond_129255 = slt64((int64_t) 0, loopres_129230);
                            bool loop_while_tmp_133541 = loop_cond_129255;
                            int64_t first_match_tmp_133542 = loopres_129229;
                            int64_t step_tmp_133543 = loopres_129230;
                            
                            loop_while_129196 = loop_while_tmp_133541;
                            first_match_129197 = first_match_tmp_133542;
                            step_129198 = step_tmp_133543;
                        }
                        defunc_0_f_res_129193 = loop_while_129196;
                        defunc_0_f_res_129194 = first_match_129197;
                        defunc_0_f_res_129195 = step_129198;
                        
                        int64_t zs_lhs_129256 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, defunc_0_f_res_129194);
                        int64_t max_arg1_129257 = sdiv64(zs_lhs_129256, (int64_t) 2);
                        int64_t max_res_129258 = smax64((int64_t) 1, max_arg1_129257);
                        bool cond_129259 = defunc_0_f_res_129194 == (int64_t) -1;
                        int64_t defunc_0_f_res_129260;
                        
                        if (cond_129259) {
                            defunc_0_f_res_129260 = (int64_t) -1;
                        } else {
                            bool loop_cond_129262 = slt64((int64_t) 0, max_res_129258);
                            bool defunc_0_f_res_f_res_129263;
                            int64_t defunc_0_f_res_f_res_129264;
                            int64_t defunc_0_f_res_f_res_129265;
                            bool loop_while_129266;
                            int64_t last_match_129267;
                            int64_t step_129268;
                            
                            loop_while_129266 = loop_cond_129262;
                            last_match_129267 = m_122294;
                            step_129268 = max_res_129258;
                            while (loop_while_129266) {
                                bool x_129269 = sle64((int64_t) 0, last_match_129267);
                                bool y_129270 = slt64(last_match_129267, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129271 = x_129269 && y_129270;
                                bool index_certs_129272;
                                
                                if (!bounds_check_129271) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) last_match_129267, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:241:20-34\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129273 = tS_start_122289 + last_match_129267;
                                int32_t sv_129274 = ((int32_t *) tS_mem_133176.mem)[slice_129273];
                                bool cond_129275 = last_match_129267 == m_122294;
                                int32_t nv_129276;
                                
                                if (cond_129275) {
                                    nv_129276 = sv_129274;
                                } else {
                                    int64_t tmp_129277 = add64((int64_t) 1, last_match_129267);
                                    bool x_129278 = sle64((int64_t) 0, tmp_129277);
                                    bool y_129279 = slt64(tmp_129277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                    bool bounds_check_129280 = x_129278 && y_129279;
                                    bool index_certs_129281;
                                    
                                    if (!bounds_check_129280) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:242:53-69\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129282 = tS_start_122289 + tmp_129277;
                                    int32_t nv_f_res_129283 = ((int32_t *) tS_mem_133176.mem)[slice_129282];
                                    
                                    nv_129276 = nv_f_res_129283;
                                }
                                
                                bool defunc_0_eq_res_129284 = eta_p_129191 == sv_129274;
                                bool defunc_0_lt_res_129285 = slt32(eta_p_129191, nv_129276);
                                bool x_129286 = !cond_129275;
                                bool y_129287 = defunc_0_lt_res_129285 && x_129286;
                                bool cond_t_res_129288 = cond_129275 || y_129287;
                                bool x_129289 = defunc_0_eq_res_129284 && cond_t_res_129288;
                                int64_t loopres_129290;
                                int64_t loopres_129291;
                                
                                if (x_129289) {
                                    loopres_129290 = last_match_129267;
                                    loopres_129291 = (int64_t) 0;
                                } else {
                                    int64_t loopres_f_res_129292;
                                    int64_t loopres_f_res_129293;
                                    
                                    if (defunc_0_eq_res_129284) {
                                        int64_t tmp_129483 = add64(last_match_129267, step_129268);
                                        int64_t max_arg1_129484 = sdiv64(step_129268, (int64_t) 2);
                                        int64_t max_res_129485 = smax64((int64_t) 1, max_arg1_129484);
                                        
                                        loopres_f_res_129292 = tmp_129483;
                                        loopres_f_res_129293 = max_res_129485;
                                    } else {
                                        bool defunc_0_lt_res_129297 = slt32(eta_p_129191, sv_129274);
                                        int64_t loopres_f_res_f_res_129298;
                                        int64_t loopres_f_res_f_res_129299;
                                        
                                        if (defunc_0_lt_res_129297) {
                                            int64_t tmp_129486 = sub64(last_match_129267, step_129268);
                                            int64_t max_arg1_129487 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129488 = smax64((int64_t) 1, max_arg1_129487);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129486;
                                            loopres_f_res_f_res_129299 = max_res_129488;
                                        } else {
                                            int64_t tmp_129303 = add64(last_match_129267, step_129268);
                                            int64_t max_arg1_129304 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129305 = smax64((int64_t) 1, max_arg1_129304);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129303;
                                            loopres_f_res_f_res_129299 = max_res_129305;
                                        }
                                        loopres_f_res_129292 = loopres_f_res_f_res_129298;
                                        loopres_f_res_129293 = loopres_f_res_f_res_129299;
                                    }
                                    loopres_129290 = loopres_f_res_129292;
                                    loopres_129291 = loopres_f_res_129293;
                                }
                                
                                bool loop_cond_129306 = slt64((int64_t) 0, loopres_129291);
                                bool loop_while_tmp_133544 = loop_cond_129306;
                                int64_t last_match_tmp_133545 = loopres_129290;
                                int64_t step_tmp_133546 = loopres_129291;
                                
                                loop_while_129266 = loop_while_tmp_133544;
                                last_match_129267 = last_match_tmp_133545;
                                step_129268 = step_tmp_133546;
                            }
                            defunc_0_f_res_f_res_129263 = loop_while_129266;
                            defunc_0_f_res_f_res_129264 = last_match_129267;
                            defunc_0_f_res_f_res_129265 = step_129268;
                            defunc_0_f_res_129260 = defunc_0_f_res_f_res_129264;
                        }
                        
                        bool cond_129307 = slt64(defunc_0_f_res_129194, (int64_t) 0);
                        int64_t cm_129308;
                        
                        if (cond_129307) {
                            cm_129308 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_129309 = sub64(defunc_0_f_res_129260, defunc_0_f_res_129194);
                            int64_t cm_f_res_129310 = add64((int64_t) 1, zp_lhs_129309);
                            
                            cm_129308 = cm_f_res_129310;
                        }
                        
                        int64_t lifted_lambda_res_129314;
                        
                        if (cond_129307) {
                            lifted_lambda_res_129314 = defunc_0_f_res_129194;
                        } else {
                            int64_t lifted_lambda_res_f_res_129315 = add64(find_joinTuples_arg3_122330, defunc_0_f_res_129194);
                            
                            lifted_lambda_res_129314 = lifted_lambda_res_f_res_129315;
                        }
                        
                        bool cond_129317 = slt64(eta_p_129192, (int64_t) 0);
                        int64_t lifted_lambda_res_129318;
                        
                        if (cond_129317) {
                            lifted_lambda_res_129318 = lifted_lambda_res_129314;
                        } else {
                            lifted_lambda_res_129318 = eta_p_129192;
                        }
                        
                        int64_t defunc_0_f_res_129321 = add64(eta_p_129190, cm_129308);
                        
                        ((int64_t *) mem_133199.mem)[i_133044] = defunc_0_f_res_129321;
                        ((int64_t *) mem_133201.mem)[i_133044] = lifted_lambda_res_129318;
                    }
                    
                    int64_t tmp_122469 = add64((int64_t) 1, s_iter_122285);
                    
                    if (memblock_set(ctx, &ext_mem_133219, &mem_133199, "mem_133199") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_133201, "mem_133201") != 0)
                        return 1;
                    loopres_f_res_122322 = tmp_122469;
                    loopres_f_res_122325 = nextRel_122329;
                }
                if (memblock_set(ctx, &ext_mem_133225, &ext_mem_133219, "ext_mem_133219") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &ext_mem_133216, "ext_mem_133216") != 0)
                    return 1;
                loopres_122316 = loopres_f_res_122322;
                loopres_122319 = loopres_f_res_122325;
                loopres_122320 = minRelevant_122288;
            }
            
            bool cond_122470 = slt64(loopres_122316, numIter_S_122231);
            bool x_122471 = loopres_122319 && cond_122470;
            
            if (memblock_set(ctx, &mem_param_tmp_133528, &ext_mem_133225, "ext_mem_133225") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133529, &ext_mem_133222, "ext_mem_133222") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_133530 = ext_133224;
            int64_t ctx_param_ext_tmp_133531 = ext_133223;
            int64_t ctx_param_ext_tmp_133532 = ext_133221;
            int64_t ctx_param_ext_tmp_133533 = ext_133220;
            bool loop_while_tmp_133534 = x_122471;
            int64_t s_iter_tmp_133535 = loopres_122316;
            int64_t minRelevant_tmp_133538 = loopres_122320;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133197, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
                return 1;
            ctx_param_ext_133192 = ctx_param_ext_tmp_133530;
            ctx_param_ext_133193 = ctx_param_ext_tmp_133531;
            ctx_param_ext_133195 = ctx_param_ext_tmp_133532;
            ctx_param_ext_133196 = ctx_param_ext_tmp_133533;
            loop_while_122284 = loop_while_tmp_133534;
            s_iter_122285 = s_iter_tmp_133535;
            minRelevant_122288 = minRelevant_tmp_133538;
        }
        if (memblock_set(ctx, &ext_mem_133231, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133230, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        ext_133229 = ctx_param_ext_133192;
        ext_133228 = ctx_param_ext_133193;
        ext_133227 = ctx_param_ext_133195;
        ext_133226 = ctx_param_ext_133196;
        loopres_122279 = loop_while_122284;
        loopres_122280 = s_iter_122285;
        loopres_122283 = minRelevant_122288;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133233, bytes_133178, "mem_133233")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133187.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_104200});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133230.mem, ext_133227, (int64_t []) {ext_133226}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133235, bytes_133178, "mem_133235")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_104200});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133231.mem, ext_133229, (int64_t []) {ext_133228}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        
        int64_t tmp_122477 = add64((int64_t) 1, iter_122242);
        bool loop_cond_122478 = slt64(tmp_122477, numIter_R_122228);
        
        if (memblock_set(ctx, &mem_param_tmp_133519, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &mem_133233, "mem_133233") != 0)
            return 1;
        
        bool loop_while_tmp_133521 = loop_cond_122478;
        int64_t iter_tmp_133522 = tmp_122477;
        int64_t first_relevant_in_S_tmp_133525 = loopres_122283;
        
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        loop_while_122241 = loop_while_tmp_133521;
        iter_122242 = iter_tmp_133522;
        first_relevant_in_S_122245 = first_relevant_in_S_tmp_133525;
    }
    if (memblock_set(ctx, &ext_mem_133241, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133240, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    defunc_0_mergeJoin_res_122236 = loop_while_122241;
    defunc_0_mergeJoin_res_122237 = iter_122242;
    defunc_0_mergeJoin_res_122240 = first_relevant_in_S_122245;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
        return 1;
    if (mem_133243_cached_sizze_133714 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133243, &mem_133243_cached_sizze_133714, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133245_cached_sizze_133715 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133245, &mem_133245_cached_sizze_133715, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_133246 = (int64_t) 4 * nR_104200;
    
    if (mem_133247_cached_sizze_133716 < bytes_133246) {
        err = lexical_realloc(ctx, &mem_133247, &mem_133247_cached_sizze_133716, bytes_133246);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133249_cached_sizze_133717 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133717, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133251_cached_sizze_133718 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133251, &mem_133251_cached_sizze_133718, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133253_cached_sizze_133719 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133253, &mem_133253_cached_sizze_133719, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133255_cached_sizze_133720 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133255, &mem_133255_cached_sizze_133720, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133072;
    int64_t discard_133073;
    int64_t defunc_res_129534;
    int64_t scanacc_133054;
    int64_t scanacc_133055;
    int64_t redout_133058;
    
    scanacc_133054 = (int64_t) 0;
    scanacc_133055 = (int64_t) 0;
    redout_133058 = (int64_t) 0;
    for (int64_t i_133064 = 0; i_133064 < nR_104200; i_133064++) {
        int64_t zg_lhs_129015 = ((int64_t *) ext_mem_133241.mem)[i_133064];
        bool cond_129016 = slt64((int64_t) 0, zg_lhs_129015);
        int64_t lifted_lambda_res_129017;
        
        if (cond_129016) {
            lifted_lambda_res_129017 = i_133064;
        } else {
            lifted_lambda_res_129017 = (int64_t) -1;
        }
        
        bool cond_129019 = sle64((int64_t) 0, lifted_lambda_res_129017);
        bool cond_t_res_129020 = slt64(lifted_lambda_res_129017, nR_104200);
        bool x_129021 = cond_129019 && cond_t_res_129020;
        int64_t lifted_lambda_res_129022;
        
        if (x_129021) {
            bool index_certs_129491;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_104200, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_129492 = ((int64_t *) ext_mem_133241.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129022 = lifted_lambda_res_t_res_129492;
        } else {
            lifted_lambda_res_129022 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_129026 = slt64((int64_t) 1, lifted_lambda_res_129022);
        int64_t defunc_0_f_res_129027 = btoi_bool_i64(lifted_lambda_res_129026);
        int32_t lifted_lambda_res_129039;
        int64_t lifted_lambda_res_129040;
        int64_t lifted_lambda_res_129041;
        
        if (x_129021) {
            bool index_certs_129493;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_104200, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:377:7-378:57\n   #4  ftRelational.fut:167:82-85\n   #5  ftRelational.fut:158:1-167:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t lifted_lambda_res_t_res_129494 = ((int32_t *) tR_mem_133175.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129495 = ((int64_t *) ext_mem_133177.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129496 = ((int64_t *) ext_mem_133240.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129039 = lifted_lambda_res_t_res_129494;
            lifted_lambda_res_129040 = lifted_lambda_res_t_res_129495;
            lifted_lambda_res_129041 = lifted_lambda_res_t_res_129496;
        } else {
            lifted_lambda_res_129039 = 0;
            lifted_lambda_res_129040 = (int64_t) -1;
            lifted_lambda_res_129041 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_122541 = add64(defunc_0_f_res_129027, scanacc_133054);
        int64_t lifted_lambda_res_122502 = add64(lifted_lambda_res_129022, scanacc_133055);
        int64_t zp_res_122522 = add64(lifted_lambda_res_129022, redout_133058);
        
        ((int64_t *) mem_133243)[i_133064] = defunc_0_op_res_122541;
        ((int64_t *) mem_133245)[i_133064] = lifted_lambda_res_122502;
        ((int32_t *) mem_133247)[i_133064] = lifted_lambda_res_129039;
        ((int64_t *) mem_133249)[i_133064] = lifted_lambda_res_129040;
        ((int64_t *) mem_133251)[i_133064] = lifted_lambda_res_129041;
        ((int64_t *) mem_133253)[i_133064] = defunc_0_f_res_129027;
        ((int64_t *) mem_133255)[i_133064] = lifted_lambda_res_129022;
        
        int64_t scanacc_tmp_133547 = defunc_0_op_res_122541;
        int64_t scanacc_tmp_133548 = lifted_lambda_res_122502;
        int64_t redout_tmp_133551 = zp_res_122522;
        
        scanacc_133054 = scanacc_tmp_133547;
        scanacc_133055 = scanacc_tmp_133548;
        redout_133058 = redout_tmp_133551;
    }
    discard_133072 = scanacc_133054;
    discard_133073 = scanacc_133055;
    defunc_res_129534 = redout_133058;
    if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
        return 1;
    
    int64_t bytes_133306 = (int64_t) 4 * defunc_res_129534;
    int64_t bytes_133308 = (int64_t) 8 * defunc_res_129534;
    bool cond_122542 = nR_104200 == (int64_t) 0;
    bool x_122543 = !cond_122542;
    int64_t tmp_122544 = sub64(nR_104200, (int64_t) 1);
    bool x_122545 = sle64((int64_t) 0, tmp_122544);
    bool y_122546 = slt64(tmp_122544, nR_104200);
    bool bounds_check_122547 = x_122545 && y_122546;
    bool protect_assert_disj_122548 = cond_122542 || bounds_check_122547;
    bool index_certs_122549;
    
    if (!protect_assert_disj_122548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_122544, "] out of bounds for array of shape [", (long long) nR_104200, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_122550;
    
    if (x_122543) {
        int64_t x_129497 = ((int64_t *) mem_133243)[tmp_122544];
        
        m_f_res_122550 = x_129497;
    } else {
        m_f_res_122550 = (int64_t) 0;
    }
    
    int64_t m_122552;
    
    if (cond_122542) {
        m_122552 = (int64_t) 0;
    } else {
        m_122552 = m_f_res_122550;
    }
    
    bool cond_122575 = slt64((int64_t) 0, m_122552);
    int64_t m_122562 = sub64(m_122552, (int64_t) 1);
    bool i_p_m_t_s_leq_w_122564 = slt64(m_122562, nR_104200);
    bool zzero_leq_i_p_m_t_s_122563 = sle64((int64_t) 0, m_122562);
    bool y_122566 = zzero_leq_i_p_m_t_s_122563 && i_p_m_t_s_leq_w_122564;
    bool i_lte_j_122565 = sle64((int64_t) 0, m_122552);
    bool forwards_ok_122567 = i_lte_j_122565 && y_122566;
    bool eq_x_zz_122559 = (int64_t) 0 == m_f_res_122550;
    bool p_and_eq_x_y_122560 = x_122543 && eq_x_zz_122559;
    bool empty_slice_122561 = cond_122542 || p_and_eq_x_y_122560;
    bool ok_or_empty_122568 = empty_slice_122561 || forwards_ok_122567;
    bool index_certs_122569;
    
    if (!ok_or_empty_122568) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122552, "] out of bounds for array of shape [", (long long) nR_104200, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:167:82-85\n   #4  ftRelational.fut:158:1-167:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133330 = (int64_t) 8 * m_122552;
    
    if (mem_133331_cached_sizze_133722 < bytes_133330) {
        err = lexical_realloc(ctx, &mem_133331, &mem_133331_cached_sizze_133722, bytes_133330);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133331, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122552});
    
    int64_t max_mult_122576;
    
    if (cond_122575) {
        if (mem_133333_cached_sizze_133723 < bytes_133178) {
            err = lexical_realloc(ctx, &mem_133333, &mem_133333_cached_sizze_133723, bytes_133178);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133091 = 0; i_133091 < nR_104200; i_133091++) {
            int64_t eta_p_129503 = ((int64_t *) mem_133253)[i_133091];
            int64_t eta_p_129504 = ((int64_t *) mem_133243)[i_133091];
            bool cond_129505 = eta_p_129503 == (int64_t) 1;
            int64_t lifted_lambda_res_129506;
            
            if (cond_129505) {
                int64_t lifted_lambda_res_t_res_129507 = sub64(eta_p_129504, (int64_t) 1);
                
                lifted_lambda_res_129506 = lifted_lambda_res_t_res_129507;
            } else {
                lifted_lambda_res_129506 = (int64_t) -1;
            }
            ((int64_t *) mem_133333)[i_133091] = lifted_lambda_res_129506;
        }
        for (int64_t write_iter_133093 = 0; write_iter_133093 < nR_104200; write_iter_133093++) {
            int64_t write_iv_133095 = ((int64_t *) mem_133333)[write_iter_133093];
            int64_t write_iv_133096 = ((int64_t *) mem_133255)[write_iter_133093];
            
            if (sle64((int64_t) 0, write_iv_133095) && slt64(write_iv_133095, m_122552)) {
                ((int64_t *) mem_133331)[write_iv_133095] = write_iv_133096;
            }
        }
        
        int64_t defunc_0_reduce_res_129517;
        int64_t redout_133098 = (int64_t) -9223372036854775808;
        
        for (int64_t i_133099 = 0; i_133099 < m_122552; i_133099++) {
            int64_t x_129518 = ((int64_t *) mem_133331)[i_133099];
            int64_t max_res_129521 = smax64(x_129518, redout_133098);
            int64_t redout_tmp_133559 = max_res_129521;
            
            redout_133098 = redout_tmp_133559;
        }
        defunc_0_reduce_res_129517 = redout_133098;
        max_mult_122576 = defunc_0_reduce_res_129517;
    } else {
        max_mult_122576 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_122582 = slt64(max_mult_122576, (int64_t) 1);
    bool valid_122584 = !bounds_invalid_upwards_122582;
    bool range_valid_c_122585;
    
    if (!valid_122584) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_122576, " is invalid.", "-> #0  ftSMJ.fut:352:16-28\n   #1  ftSMJ.fut:377:7-378:57\n   #2  ftRelational.fut:167:82-85\n   #3  ftRelational.fut:158:1-167:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_133299_cached_sizze_133721 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133721, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133076 = 0; i_133076 < nR_104200; i_133076++) {
        int64_t eta_p_128922 = ((int64_t *) mem_133255)[i_133076];
        int64_t zv_lhs_128924 = add64((int64_t) -1, i_133076);
        int64_t tmp_128925 = smod64(zv_lhs_128924, nR_104200);
        int64_t lifted_lambda_res_128926 = ((int64_t *) mem_133245)[tmp_128925];
        bool cond_128928 = i_133076 == (int64_t) 0;
        int64_t lifted_lambda_res_128929;
        
        if (cond_128928) {
            lifted_lambda_res_128929 = (int64_t) 0;
        } else {
            lifted_lambda_res_128929 = lifted_lambda_res_128926;
        }
        
        bool cond_128931 = slt64((int64_t) 0, eta_p_128922);
        int64_t lifted_lambda_res_128932;
        
        if (cond_128931) {
            lifted_lambda_res_128932 = lifted_lambda_res_128929;
        } else {
            lifted_lambda_res_128932 = (int64_t) -1;
        }
        ((int64_t *) mem_133299)[i_133076] = lifted_lambda_res_128932;
    }
    if (memblock_alloc(ctx, &mem_133307, bytes_133306, "mem_133307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133561 = 0; nest_i_133561 < defunc_res_129534; nest_i_133561++) {
        ((int32_t *) mem_133307.mem)[nest_i_133561] = 0;
    }
    if (memblock_alloc(ctx, &mem_133309, bytes_133308, "mem_133309")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133562 = 0; nest_i_133562 < defunc_res_129534; nest_i_133562++) {
        ((int64_t *) mem_133309.mem)[nest_i_133562] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133311, bytes_133308, "mem_133311")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133563 = 0; nest_i_133563 < defunc_res_129534; nest_i_133563++) {
        ((int64_t *) mem_133311.mem)[nest_i_133563] = (int64_t) -1;
    }
    for (int64_t write_iter_133078 = 0; write_iter_133078 < nR_104200; write_iter_133078++) {
        int64_t write_iv_133082 = ((int64_t *) mem_133299)[write_iter_133078];
        int32_t write_iv_133083 = ((int32_t *) mem_133247)[write_iter_133078];
        int64_t write_iv_133084 = ((int64_t *) mem_133249)[write_iter_133078];
        int64_t write_iv_133085 = ((int64_t *) mem_133251)[write_iter_133078];
        
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int32_t *) mem_133307.mem)[write_iv_133082] = write_iv_133083;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133309.mem)[write_iv_133082] = write_iv_133084;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133311.mem)[write_iv_133082] = write_iv_133085;
        }
    }
    
    int64_t distance_122583 = sub64(max_mult_122576, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_133348, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133351, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133354, &mem_133311, "mem_133311") != 0)
        return 1;
    for (int64_t i_122589 = 0; i_122589 < distance_122583; i_122589++) {
        int64_t index_primexp_122593 = add64((int64_t) 1, i_122589);
        
        if (memblock_alloc(ctx, &mem_133356, bytes_133308, "mem_133356")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133356.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133354.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133358, bytes_133308, "mem_133358")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133360, bytes_133306, "mem_133360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_133360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133348.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        for (int64_t write_iter_133100 = 0; write_iter_133100 < nR_104200; write_iter_133100++) {
            int64_t write_iv_133105 = ((int64_t *) mem_133251)[write_iter_133100];
            int32_t write_iv_133106 = ((int32_t *) mem_133247)[write_iter_133100];
            int64_t write_iv_133107 = ((int64_t *) mem_133249)[write_iter_133100];
            int64_t zg_lhs_129457 = ((int64_t *) mem_133255)[write_iter_133100];
            bool cond_129458 = slt64(index_primexp_122593, zg_lhs_129457);
            int64_t lifted_lambda_res_129459;
            
            if (cond_129458) {
                int64_t zp_lhs_129527 = ((int64_t *) mem_133299)[write_iter_133100];
                int64_t lifted_lambda_res_t_res_129528 = add64(index_primexp_122593, zp_lhs_129527);
                
                lifted_lambda_res_129459 = lifted_lambda_res_t_res_129528;
            } else {
                lifted_lambda_res_129459 = (int64_t) -1;
            }
            
            int64_t tmp_129463 = add64(index_primexp_122593, write_iv_133105);
            
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int32_t *) mem_133360.mem)[lifted_lambda_res_129459] = write_iv_133106;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133358.mem)[lifted_lambda_res_129459] = write_iv_133107;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133356.mem)[lifted_lambda_res_129459] = tmp_129463;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_133567, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133568, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133569, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133348, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133351, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133354, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133387, &mem_param_133348, "mem_param_133348") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133386, &mem_param_133351, "mem_param_133351") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133385, &mem_param_133354, "mem_param_133354") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133389, bytes_133306, "mem_133389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133391, bytes_133308, "mem_133391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133386.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133393, bytes_133308, "mem_133393")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133393.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133391, "mem_133391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133393, "mem_133393") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133389, "mem_133389") != 0)
        return 1;
    prim_out_133516 = defunc_res_129534;
    if (memblock_set(ctx, &*mem_out_p_133710, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133711, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133712, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133713 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133243);
        free(mem_133245);
        free(mem_133247);
        free(mem_133249);
        free(mem_133251);
        free(mem_133253);
        free(mem_133255);
        free(mem_133299);
        free(mem_133331);
        free(mem_133333);
        if (memblock_unref(ctx, &mem_133393, "mem_133393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133391, "mem_133391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133389, "mem_133389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133354, "mem_param_133354") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133351, "mem_param_133351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133348, "mem_param_133348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133201, "mem_133201") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133199, "mem_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133216, "ext_mem_133216") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133219, "ext_mem_133219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133222, "ext_mem_133222") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133225, "ext_mem_133225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_133724, struct memblock *mem_out_p_133725, struct memblock *mem_out_p_133726, int64_t *out_prim_out_133727, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_106422, int64_t nS_106423, int64_t offset_R_106426, int64_t offset_S_106427, int64_t partitionSizze_106428, int64_t scatter_psizze_106429)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133243_cached_sizze_133728 = 0;
    unsigned char *mem_133243 = NULL;
    int64_t mem_133245_cached_sizze_133729 = 0;
    unsigned char *mem_133245 = NULL;
    int64_t mem_133247_cached_sizze_133730 = 0;
    unsigned char *mem_133247 = NULL;
    int64_t mem_133249_cached_sizze_133731 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133251_cached_sizze_133732 = 0;
    unsigned char *mem_133251 = NULL;
    int64_t mem_133253_cached_sizze_133733 = 0;
    unsigned char *mem_133253 = NULL;
    int64_t mem_133255_cached_sizze_133734 = 0;
    unsigned char *mem_133255 = NULL;
    int64_t mem_133299_cached_sizze_133735 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133331_cached_sizze_133736 = 0;
    unsigned char *mem_133331 = NULL;
    int64_t mem_133333_cached_sizze_133737 = 0;
    unsigned char *mem_133333 = NULL;
    struct memblock mem_133393;
    
    mem_133393.references = NULL;
    
    struct memblock mem_133391;
    
    mem_133391.references = NULL;
    
    struct memblock mem_133389;
    
    mem_133389.references = NULL;
    
    struct memblock mem_param_tmp_133569;
    
    mem_param_tmp_133569.references = NULL;
    
    struct memblock mem_param_tmp_133568;
    
    mem_param_tmp_133568.references = NULL;
    
    struct memblock mem_param_tmp_133567;
    
    mem_param_tmp_133567.references = NULL;
    
    struct memblock mem_133360;
    
    mem_133360.references = NULL;
    
    struct memblock mem_133358;
    
    mem_133358.references = NULL;
    
    struct memblock mem_133356;
    
    mem_133356.references = NULL;
    
    struct memblock mem_param_133354;
    
    mem_param_133354.references = NULL;
    
    struct memblock mem_param_133351;
    
    mem_param_133351.references = NULL;
    
    struct memblock mem_param_133348;
    
    mem_param_133348.references = NULL;
    
    struct memblock ext_mem_133385;
    
    ext_mem_133385.references = NULL;
    
    struct memblock ext_mem_133386;
    
    ext_mem_133386.references = NULL;
    
    struct memblock ext_mem_133387;
    
    ext_mem_133387.references = NULL;
    
    struct memblock mem_133311;
    
    mem_133311.references = NULL;
    
    struct memblock mem_133309;
    
    mem_133309.references = NULL;
    
    struct memblock mem_133307;
    
    mem_133307.references = NULL;
    
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_133235;
    
    mem_133235.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_param_tmp_133529;
    
    mem_param_tmp_133529.references = NULL;
    
    struct memblock mem_param_tmp_133528;
    
    mem_param_tmp_133528.references = NULL;
    
    struct memblock mem_133201;
    
    mem_133201.references = NULL;
    
    struct memblock mem_133199;
    
    mem_133199.references = NULL;
    
    struct memblock ext_mem_133216;
    
    ext_mem_133216.references = NULL;
    
    struct memblock ext_mem_133219;
    
    ext_mem_133219.references = NULL;
    
    struct memblock ext_mem_133222;
    
    ext_mem_133222.references = NULL;
    
    struct memblock ext_mem_133225;
    
    ext_mem_133225.references = NULL;
    
    struct memblock mem_param_133197;
    
    mem_param_133197.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133230;
    
    ext_mem_133230.references = NULL;
    
    struct memblock ext_mem_133231;
    
    ext_mem_133231.references = NULL;
    
    struct memblock mem_133191;
    
    mem_133191.references = NULL;
    
    struct memblock mem_133189;
    
    mem_133189.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock ext_mem_133240;
    
    ext_mem_133240.references = NULL;
    
    struct memblock ext_mem_133241;
    
    ext_mem_133241.references = NULL;
    
    struct memblock mem_133181;
    
    mem_133181.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock ext_mem_133177;
    
    ext_mem_133177.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t zm_lhs_122223 = add64(nR_106422, partitionSizze_106428);
    int64_t zs_lhs_122224 = sub64(zm_lhs_122223, (int64_t) 1);
    bool zzero_122225 = partitionSizze_106428 == (int64_t) 0;
    bool nonzzero_122226 = !zzero_122225;
    bool nonzzero_cert_122227;
    
    if (!nonzzero_122226) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:274:43-57\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_122228 = sdiv64(zs_lhs_122224, partitionSizze_106428);
    int64_t zm_lhs_122229 = add64(nS_106423, partitionSizze_106428);
    int64_t zs_lhs_122230 = sub64(zm_lhs_122229, (int64_t) 1);
    int64_t numIter_S_122231 = sdiv64(zs_lhs_122230, partitionSizze_106428);
    
    if (futrts_indicesWithIncrement_11416(ctx, &ext_mem_133177, tR_mem_133175, nR_106422, offset_R_106426) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_133178 = (int64_t) 8 * nR_106422;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133517 = 0; nest_i_133517 < nR_106422; nest_i_133517++) {
        ((int64_t *) mem_133179.mem)[nest_i_133517] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133181, bytes_133178, "mem_133181")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133518 = 0; nest_i_133518 < nR_106422; nest_i_133518++) {
        ((int64_t *) mem_133181.mem)[nest_i_133518] = (int64_t) 0;
    }
    
    bool loop_cond_122235 = slt64((int64_t) 0, numIter_R_122228);
    bool defunc_0_mergeJoin_res_122236;
    int64_t defunc_0_mergeJoin_res_122237;
    int64_t defunc_0_mergeJoin_res_122240;
    bool loop_while_122241;
    int64_t iter_122242;
    int64_t first_relevant_in_S_122245;
    
    if (memblock_set(ctx, &mem_param_133184, &mem_133181, "mem_133181") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &mem_133179, "mem_133179") != 0)
        return 1;
    loop_while_122241 = loop_cond_122235;
    iter_122242 = (int64_t) 0;
    first_relevant_in_S_122245 = (int64_t) 0;
    while (loop_while_122241) {
        int64_t tR_start_122246 = mul64(partitionSizze_106428, iter_122242);
        int64_t min_arg1_122247 = add64(partitionSizze_106428, tR_start_122246);
        int64_t min_res_122248 = smin64(nR_106422, min_arg1_122247);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 = sub64(min_res_122248, tR_start_122246);
        bool empty_slice_122250 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 == (int64_t) 0;
        int64_t m_122251 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, (int64_t) 1);
        int64_t i_p_m_t_s_122252 = add64(tR_start_122246, m_122251);
        bool zzero_leq_i_p_m_t_s_122253 = sle64((int64_t) 0, i_p_m_t_s_122252);
        bool i_p_m_t_s_leq_w_122254 = slt64(i_p_m_t_s_122252, nR_106422);
        bool zzero_lte_i_122255 = sle64((int64_t) 0, tR_start_122246);
        bool i_lte_j_122256 = sle64(tR_start_122246, min_res_122248);
        bool y_122257 = i_p_m_t_s_leq_w_122254 && zzero_lte_i_122255;
        bool y_122258 = zzero_leq_i_p_m_t_s_122253 && y_122257;
        bool forwards_ok_122259 = i_lte_j_122256 && y_122258;
        bool ok_or_empty_122260 = empty_slice_122250 || forwards_ok_122259;
        bool index_certs_122261;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_106422, "].", "-> #0  ftSMJ.fut:281:17-36\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133188 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249;
        bool cond_122265 = slt64(first_relevant_in_S_122245, numIter_S_122231);
        bool y_122266 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool loop_not_taken_122267 = !cond_122265;
        bool protect_assert_disj_122268 = y_122266 || loop_not_taken_122267;
        bool index_certs_122269;
        
        if (!protect_assert_disj_122268) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:296:26-34\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_122272 = sle64((int64_t) 0, m_122251);
        bool y_122273 = slt64(m_122251, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool bounds_check_122274 = x_122272 && y_122273;
        bool protect_assert_disj_122275 = loop_not_taken_122267 || bounds_check_122274;
        bool index_certs_122276;
        
        if (!protect_assert_disj_122275) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:297:28-47\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_122473;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_106422, "].", "-> #0  ftSMJ.fut:198:15-63\n   #1  ftSMJ.fut:307:20-64\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133189, bytes_133188, "mem_133189")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133526 = 0; nest_i_133526 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133526++) {
            ((int64_t *) mem_133189.mem)[nest_i_133526] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_133191, bytes_133188, "mem_133191")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133527 = 0; nest_i_133527 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133527++) {
            ((int64_t *) mem_133191.mem)[nest_i_133527] = (int64_t) 0;
        }
        
        int64_t gt_lhs_122270;
        
        if (cond_122265) {
            int64_t x_129472 = ((int64_t *) tR_mem_133175.mem)[tR_start_122246];
            
            gt_lhs_122270 = x_129472;
        } else {
            gt_lhs_122270 = (int64_t) 0;
        }
        
        int64_t lt_lhs_122277;
        
        if (cond_122265) {
            int64_t x_129473 = ((int64_t *) tR_mem_133175.mem)[i_p_m_t_s_122252];
            
            lt_lhs_122277 = x_129473;
        } else {
            lt_lhs_122277 = (int64_t) 0;
        }
        
        int64_t ext_133229;
        int64_t ext_133228;
        int64_t ext_133227;
        int64_t ext_133226;
        bool loopres_122279;
        int64_t loopres_122280;
        int64_t loopres_122283;
        bool loop_while_122284;
        int64_t s_iter_122285;
        int64_t minRelevant_122288;
        int64_t ctx_param_ext_133192;
        int64_t ctx_param_ext_133193;
        int64_t ctx_param_ext_133195;
        int64_t ctx_param_ext_133196;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133197, &mem_133189, "mem_133189") != 0)
            return 1;
        ctx_param_ext_133192 = (int64_t) 0;
        ctx_param_ext_133193 = (int64_t) 1;
        ctx_param_ext_133195 = (int64_t) 0;
        ctx_param_ext_133196 = (int64_t) 1;
        loop_while_122284 = cond_122265;
        s_iter_122285 = first_relevant_in_S_122245;
        minRelevant_122288 = first_relevant_in_S_122245;
        while (loop_while_122284) {
            int64_t tS_start_122289 = mul64(partitionSizze_106428, s_iter_122285);
            int64_t min_arg1_122290 = add64(partitionSizze_106428, tS_start_122289);
            int64_t min_res_122291 = smin64(nS_106423, min_arg1_122290);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 = sub64(min_res_122291, tS_start_122289);
            bool empty_slice_122293 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 == (int64_t) 0;
            int64_t m_122294 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 1);
            int64_t i_p_m_t_s_122295 = add64(tS_start_122289, m_122294);
            bool zzero_leq_i_p_m_t_s_122296 = sle64((int64_t) 0, i_p_m_t_s_122295);
            bool i_p_m_t_s_leq_w_122297 = slt64(i_p_m_t_s_122295, nS_106423);
            bool zzero_lte_i_122298 = sle64((int64_t) 0, tS_start_122289);
            bool i_lte_j_122299 = sle64(tS_start_122289, min_res_122291);
            bool y_122300 = i_p_m_t_s_leq_w_122297 && zzero_lte_i_122298;
            bool y_122301 = zzero_leq_i_p_m_t_s_122296 && y_122300;
            bool forwards_ok_122302 = i_lte_j_122299 && y_122301;
            bool ok_or_empty_122303 = empty_slice_122293 || forwards_ok_122302;
            bool index_certs_122304;
            
            if (!ok_or_empty_122303) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_122289, ":", (long long) min_res_122291, "] out of bounds for array of shape [", (long long) nS_106423, "].", "-> #0  ftSMJ.fut:294:19-38\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_122305 = sle64((int64_t) 0, m_122294);
            bool y_122306 = slt64(m_122294, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool bounds_check_122307 = x_122305 && y_122306;
            bool index_certs_122308;
            
            if (!bounds_check_122307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122294, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:296:40-59\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_122311 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool index_certs_122312;
            
            if (!y_122311) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:297:53-61\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t gt_rhs_122309 = ((int64_t *) tS_mem_133176.mem)[i_p_m_t_s_122295];
            bool defunc_0_gt_res_122310 = slt64(gt_rhs_122309, gt_lhs_122270);
            int64_t lt_rhs_122313 = ((int64_t *) tS_mem_133176.mem)[tS_start_122289];
            bool defunc_0_lt_res_122314 = slt64(lt_lhs_122277, lt_rhs_122313);
            bool thisStillRel_122315 = !defunc_0_lt_res_122314;
            int64_t ext_133218;
            
            if (defunc_0_lt_res_122314) {
                ext_133218 = ctx_param_ext_133192;
            } else {
                ext_133218 = (int64_t) 0;
            }
            
            int64_t ext_133217;
            
            if (defunc_0_lt_res_122314) {
                ext_133217 = ctx_param_ext_133193;
            } else {
                ext_133217 = (int64_t) 1;
            }
            
            int64_t ext_133215;
            
            if (defunc_0_lt_res_122314) {
                ext_133215 = ctx_param_ext_133195;
            } else {
                ext_133215 = (int64_t) 0;
            }
            
            int64_t ext_133214;
            
            if (defunc_0_lt_res_122314) {
                ext_133214 = ctx_param_ext_133196;
            } else {
                ext_133214 = (int64_t) 1;
            }
            
            int64_t ext_133224;
            
            if (defunc_0_gt_res_122310) {
                ext_133224 = ctx_param_ext_133192;
            } else {
                ext_133224 = ext_133218;
            }
            
            int64_t ext_133223;
            
            if (defunc_0_gt_res_122310) {
                ext_133223 = ctx_param_ext_133193;
            } else {
                ext_133223 = ext_133217;
            }
            
            int64_t ext_133221;
            
            if (defunc_0_gt_res_122310) {
                ext_133221 = ctx_param_ext_133195;
            } else {
                ext_133221 = ext_133215;
            }
            
            int64_t ext_133220;
            
            if (defunc_0_gt_res_122310) {
                ext_133220 = ctx_param_ext_133196;
            } else {
                ext_133220 = ext_133214;
            }
            
            int64_t loopres_122316;
            bool loopres_122319;
            int64_t loopres_122320;
            
            if (defunc_0_gt_res_122310) {
                int64_t tmp_129474 = add64((int64_t) 1, s_iter_122285);
                
                if (memblock_set(ctx, &ext_mem_133225, &mem_param_133194, "mem_param_133194") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &mem_param_133197, "mem_param_133197") != 0)
                    return 1;
                loopres_122316 = tmp_129474;
                loopres_122319 = 1;
                loopres_122320 = tmp_129474;
            } else {
                int64_t loopres_f_res_122322;
                bool loopres_f_res_122325;
                
                if (defunc_0_lt_res_122314) {
                    if (memblock_set(ctx, &ext_mem_133219, &mem_param_133194, "mem_param_133194") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_param_133197, "mem_param_133197") != 0)
                        return 1;
                    loopres_f_res_122322 = s_iter_122285;
                    loopres_f_res_122325 = thisStillRel_122315;
                } else {
                    bool index_certs_122326;
                    
                    if (!bounds_check_122274) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:301:25-44\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lt_lhs_122327 = ((int64_t *) tR_mem_133175.mem)[i_p_m_t_s_122252];
                    bool defunc_0_lt_res_122328 = slt64(lt_lhs_122327, gt_rhs_122309);
                    bool nextRel_122329 = !defunc_0_lt_res_122328;
                    int64_t find_joinTuples_arg3_122330 = add64(offset_S_106427, tS_start_122289);
                    int64_t max_arg1_122331 = sdiv64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 2);
                    int64_t max_res_122332 = smax64((int64_t) 1, max_arg1_122331);
                    bool loop_cond_122333 = slt64((int64_t) 0, max_res_122332);
                    
                    if (memblock_alloc(ctx, &mem_133199, bytes_133188, "mem_133199")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_133201, bytes_133188, "mem_133201")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_133044 = 0; i_133044 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; i_133044++) {
                        int64_t eta_p_129190 = ((int64_t *) mem_param_133194.mem)[ctx_param_ext_133192 + i_133044 * ctx_param_ext_133193];
                        int64_t slice_133152 = tR_start_122246 + i_133044;
                        int64_t eta_p_129191 = ((int64_t *) tR_mem_133175.mem)[slice_133152];
                        int64_t eta_p_129192 = ((int64_t *) mem_param_133197.mem)[ctx_param_ext_133195 + i_133044 * ctx_param_ext_133196];
                        bool defunc_0_f_res_129193;
                        int64_t defunc_0_f_res_129194;
                        int64_t defunc_0_f_res_129195;
                        bool loop_while_129196;
                        int64_t first_match_129197;
                        int64_t step_129198;
                        
                        loop_while_129196 = loop_cond_122333;
                        first_match_129197 = (int64_t) 0;
                        step_129198 = max_res_122332;
                        while (loop_while_129196) {
                            bool x_129199 = sle64((int64_t) 0, first_match_129197);
                            bool y_129200 = slt64(first_match_129197, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                            bool bounds_check_129201 = x_129199 && y_129200;
                            bool index_certs_129202;
                            
                            if (!bounds_check_129201) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) first_match_129197, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:220:20-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129203 = tS_start_122289 + first_match_129197;
                            int64_t sv_129204 = ((int64_t *) tS_mem_133176.mem)[slice_129203];
                            bool cond_129205 = first_match_129197 == (int64_t) 0;
                            int64_t pv_129206;
                            
                            if (cond_129205) {
                                pv_129206 = sv_129204;
                            } else {
                                int64_t tmp_129207 = sub64(first_match_129197, (int64_t) 1);
                                bool x_129208 = sle64((int64_t) 0, tmp_129207);
                                bool y_129209 = slt64(tmp_129207, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129210 = x_129208 && y_129209;
                                bool index_certs_129211;
                                
                                if (!bounds_check_129210) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129207, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:221:51-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129212 = tS_start_122289 + tmp_129207;
                                int64_t pv_f_res_129213 = ((int64_t *) tS_mem_133176.mem)[slice_129212];
                                
                                pv_129206 = pv_f_res_129213;
                            }
                            
                            bool cond_129214 = first_match_129197 == m_122294;
                            int64_t nv_129215;
                            
                            if (cond_129214) {
                                nv_129215 = sv_129204;
                            } else {
                                int64_t tmp_129216 = add64((int64_t) 1, first_match_129197);
                                bool x_129217 = sle64((int64_t) 0, tmp_129216);
                                bool y_129218 = slt64(tmp_129216, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129219 = x_129217 && y_129218;
                                bool index_certs_129220;
                                
                                if (!bounds_check_129219) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129216, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:222:54-71\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129221 = tS_start_122289 + tmp_129216;
                                int64_t nv_f_res_129222 = ((int64_t *) tS_mem_133176.mem)[slice_129221];
                                
                                nv_129215 = nv_f_res_129222;
                            }
                            
                            bool defunc_0_eq_res_129223 = eta_p_129191 == sv_129204;
                            bool defunc_0_gt_res_129224 = slt64(pv_129206, eta_p_129191);
                            bool x_129225 = !cond_129205;
                            bool y_129226 = defunc_0_gt_res_129224 && x_129225;
                            bool cond_t_res_129227 = cond_129205 || y_129226;
                            bool x_129228 = defunc_0_eq_res_129223 && cond_t_res_129227;
                            int64_t loopres_129229;
                            int64_t loopres_129230;
                            
                            if (x_129228) {
                                loopres_129229 = first_match_129197;
                                loopres_129230 = (int64_t) 0;
                            } else {
                                int64_t loopres_f_res_129231;
                                int64_t loopres_f_res_129232;
                                
                                if (defunc_0_eq_res_129223) {
                                    int64_t tmp_129475 = sub64(first_match_129197, step_129198);
                                    int64_t max_arg1_129476 = sdiv64(step_129198, (int64_t) 2);
                                    int64_t max_res_129477 = smax64((int64_t) 1, max_arg1_129476);
                                    
                                    loopres_f_res_129231 = tmp_129475;
                                    loopres_f_res_129232 = max_res_129477;
                                } else {
                                    bool defunc_0_lt_res_129236 = slt64(eta_p_129191, sv_129204);
                                    int64_t loopres_f_res_f_res_129237;
                                    int64_t loopres_f_res_f_res_129238;
                                    
                                    if (defunc_0_lt_res_129236) {
                                        int64_t loopres_f_res_f_res_t_res_129478;
                                        int64_t loopres_f_res_f_res_t_res_129479;
                                        
                                        if (cond_t_res_129227) {
                                            loopres_f_res_f_res_t_res_129478 = (int64_t) -1;
                                            loopres_f_res_f_res_t_res_129479 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129480 = sub64(first_match_129197, step_129198);
                                            int64_t max_arg1_129481 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129482 = smax64((int64_t) 1, max_arg1_129481);
                                            
                                            loopres_f_res_f_res_t_res_129478 = tmp_129480;
                                            loopres_f_res_f_res_t_res_129479 = max_res_129482;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_t_res_129478;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_t_res_129479;
                                    } else {
                                        bool defunc_0_lt_res_129246 = slt64(eta_p_129191, nv_129215);
                                        bool x_129247 = !cond_129214;
                                        bool y_129248 = defunc_0_lt_res_129246 && x_129247;
                                        bool cond_129249 = cond_129214 || y_129248;
                                        int64_t loopres_f_res_f_res_f_res_129250;
                                        int64_t loopres_f_res_f_res_f_res_129251;
                                        
                                        if (cond_129249) {
                                            loopres_f_res_f_res_f_res_129250 = (int64_t) -1;
                                            loopres_f_res_f_res_f_res_129251 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129252 = add64(first_match_129197, step_129198);
                                            int64_t max_arg1_129253 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129254 = smax64((int64_t) 1, max_arg1_129253);
                                            
                                            loopres_f_res_f_res_f_res_129250 = tmp_129252;
                                            loopres_f_res_f_res_f_res_129251 = max_res_129254;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_f_res_129250;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_f_res_129251;
                                    }
                                    loopres_f_res_129231 = loopres_f_res_f_res_129237;
                                    loopres_f_res_129232 = loopres_f_res_f_res_129238;
                                }
                                loopres_129229 = loopres_f_res_129231;
                                loopres_129230 = loopres_f_res_129232;
                            }
                            
                            bool loop_cond_129255 = slt64((int64_t) 0, loopres_129230);
                            bool loop_while_tmp_133541 = loop_cond_129255;
                            int64_t first_match_tmp_133542 = loopres_129229;
                            int64_t step_tmp_133543 = loopres_129230;
                            
                            loop_while_129196 = loop_while_tmp_133541;
                            first_match_129197 = first_match_tmp_133542;
                            step_129198 = step_tmp_133543;
                        }
                        defunc_0_f_res_129193 = loop_while_129196;
                        defunc_0_f_res_129194 = first_match_129197;
                        defunc_0_f_res_129195 = step_129198;
                        
                        int64_t zs_lhs_129256 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, defunc_0_f_res_129194);
                        int64_t max_arg1_129257 = sdiv64(zs_lhs_129256, (int64_t) 2);
                        int64_t max_res_129258 = smax64((int64_t) 1, max_arg1_129257);
                        bool cond_129259 = defunc_0_f_res_129194 == (int64_t) -1;
                        int64_t defunc_0_f_res_129260;
                        
                        if (cond_129259) {
                            defunc_0_f_res_129260 = (int64_t) -1;
                        } else {
                            bool loop_cond_129262 = slt64((int64_t) 0, max_res_129258);
                            bool defunc_0_f_res_f_res_129263;
                            int64_t defunc_0_f_res_f_res_129264;
                            int64_t defunc_0_f_res_f_res_129265;
                            bool loop_while_129266;
                            int64_t last_match_129267;
                            int64_t step_129268;
                            
                            loop_while_129266 = loop_cond_129262;
                            last_match_129267 = m_122294;
                            step_129268 = max_res_129258;
                            while (loop_while_129266) {
                                bool x_129269 = sle64((int64_t) 0, last_match_129267);
                                bool y_129270 = slt64(last_match_129267, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129271 = x_129269 && y_129270;
                                bool index_certs_129272;
                                
                                if (!bounds_check_129271) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) last_match_129267, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:241:20-34\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129273 = tS_start_122289 + last_match_129267;
                                int64_t sv_129274 = ((int64_t *) tS_mem_133176.mem)[slice_129273];
                                bool cond_129275 = last_match_129267 == m_122294;
                                int64_t nv_129276;
                                
                                if (cond_129275) {
                                    nv_129276 = sv_129274;
                                } else {
                                    int64_t tmp_129277 = add64((int64_t) 1, last_match_129267);
                                    bool x_129278 = sle64((int64_t) 0, tmp_129277);
                                    bool y_129279 = slt64(tmp_129277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                    bool bounds_check_129280 = x_129278 && y_129279;
                                    bool index_certs_129281;
                                    
                                    if (!bounds_check_129280) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:242:53-69\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129282 = tS_start_122289 + tmp_129277;
                                    int64_t nv_f_res_129283 = ((int64_t *) tS_mem_133176.mem)[slice_129282];
                                    
                                    nv_129276 = nv_f_res_129283;
                                }
                                
                                bool defunc_0_eq_res_129284 = eta_p_129191 == sv_129274;
                                bool defunc_0_lt_res_129285 = slt64(eta_p_129191, nv_129276);
                                bool x_129286 = !cond_129275;
                                bool y_129287 = defunc_0_lt_res_129285 && x_129286;
                                bool cond_t_res_129288 = cond_129275 || y_129287;
                                bool x_129289 = defunc_0_eq_res_129284 && cond_t_res_129288;
                                int64_t loopres_129290;
                                int64_t loopres_129291;
                                
                                if (x_129289) {
                                    loopres_129290 = last_match_129267;
                                    loopres_129291 = (int64_t) 0;
                                } else {
                                    int64_t loopres_f_res_129292;
                                    int64_t loopres_f_res_129293;
                                    
                                    if (defunc_0_eq_res_129284) {
                                        int64_t tmp_129483 = add64(last_match_129267, step_129268);
                                        int64_t max_arg1_129484 = sdiv64(step_129268, (int64_t) 2);
                                        int64_t max_res_129485 = smax64((int64_t) 1, max_arg1_129484);
                                        
                                        loopres_f_res_129292 = tmp_129483;
                                        loopres_f_res_129293 = max_res_129485;
                                    } else {
                                        bool defunc_0_lt_res_129297 = slt64(eta_p_129191, sv_129274);
                                        int64_t loopres_f_res_f_res_129298;
                                        int64_t loopres_f_res_f_res_129299;
                                        
                                        if (defunc_0_lt_res_129297) {
                                            int64_t tmp_129486 = sub64(last_match_129267, step_129268);
                                            int64_t max_arg1_129487 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129488 = smax64((int64_t) 1, max_arg1_129487);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129486;
                                            loopres_f_res_f_res_129299 = max_res_129488;
                                        } else {
                                            int64_t tmp_129303 = add64(last_match_129267, step_129268);
                                            int64_t max_arg1_129304 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129305 = smax64((int64_t) 1, max_arg1_129304);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129303;
                                            loopres_f_res_f_res_129299 = max_res_129305;
                                        }
                                        loopres_f_res_129292 = loopres_f_res_f_res_129298;
                                        loopres_f_res_129293 = loopres_f_res_f_res_129299;
                                    }
                                    loopres_129290 = loopres_f_res_129292;
                                    loopres_129291 = loopres_f_res_129293;
                                }
                                
                                bool loop_cond_129306 = slt64((int64_t) 0, loopres_129291);
                                bool loop_while_tmp_133544 = loop_cond_129306;
                                int64_t last_match_tmp_133545 = loopres_129290;
                                int64_t step_tmp_133546 = loopres_129291;
                                
                                loop_while_129266 = loop_while_tmp_133544;
                                last_match_129267 = last_match_tmp_133545;
                                step_129268 = step_tmp_133546;
                            }
                            defunc_0_f_res_f_res_129263 = loop_while_129266;
                            defunc_0_f_res_f_res_129264 = last_match_129267;
                            defunc_0_f_res_f_res_129265 = step_129268;
                            defunc_0_f_res_129260 = defunc_0_f_res_f_res_129264;
                        }
                        
                        bool cond_129307 = slt64(defunc_0_f_res_129194, (int64_t) 0);
                        int64_t cm_129308;
                        
                        if (cond_129307) {
                            cm_129308 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_129309 = sub64(defunc_0_f_res_129260, defunc_0_f_res_129194);
                            int64_t cm_f_res_129310 = add64((int64_t) 1, zp_lhs_129309);
                            
                            cm_129308 = cm_f_res_129310;
                        }
                        
                        int64_t lifted_lambda_res_129314;
                        
                        if (cond_129307) {
                            lifted_lambda_res_129314 = defunc_0_f_res_129194;
                        } else {
                            int64_t lifted_lambda_res_f_res_129315 = add64(find_joinTuples_arg3_122330, defunc_0_f_res_129194);
                            
                            lifted_lambda_res_129314 = lifted_lambda_res_f_res_129315;
                        }
                        
                        bool cond_129317 = slt64(eta_p_129192, (int64_t) 0);
                        int64_t lifted_lambda_res_129318;
                        
                        if (cond_129317) {
                            lifted_lambda_res_129318 = lifted_lambda_res_129314;
                        } else {
                            lifted_lambda_res_129318 = eta_p_129192;
                        }
                        
                        int64_t defunc_0_f_res_129321 = add64(eta_p_129190, cm_129308);
                        
                        ((int64_t *) mem_133199.mem)[i_133044] = defunc_0_f_res_129321;
                        ((int64_t *) mem_133201.mem)[i_133044] = lifted_lambda_res_129318;
                    }
                    
                    int64_t tmp_122469 = add64((int64_t) 1, s_iter_122285);
                    
                    if (memblock_set(ctx, &ext_mem_133219, &mem_133199, "mem_133199") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_133201, "mem_133201") != 0)
                        return 1;
                    loopres_f_res_122322 = tmp_122469;
                    loopres_f_res_122325 = nextRel_122329;
                }
                if (memblock_set(ctx, &ext_mem_133225, &ext_mem_133219, "ext_mem_133219") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &ext_mem_133216, "ext_mem_133216") != 0)
                    return 1;
                loopres_122316 = loopres_f_res_122322;
                loopres_122319 = loopres_f_res_122325;
                loopres_122320 = minRelevant_122288;
            }
            
            bool cond_122470 = slt64(loopres_122316, numIter_S_122231);
            bool x_122471 = loopres_122319 && cond_122470;
            
            if (memblock_set(ctx, &mem_param_tmp_133528, &ext_mem_133225, "ext_mem_133225") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133529, &ext_mem_133222, "ext_mem_133222") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_133530 = ext_133224;
            int64_t ctx_param_ext_tmp_133531 = ext_133223;
            int64_t ctx_param_ext_tmp_133532 = ext_133221;
            int64_t ctx_param_ext_tmp_133533 = ext_133220;
            bool loop_while_tmp_133534 = x_122471;
            int64_t s_iter_tmp_133535 = loopres_122316;
            int64_t minRelevant_tmp_133538 = loopres_122320;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133197, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
                return 1;
            ctx_param_ext_133192 = ctx_param_ext_tmp_133530;
            ctx_param_ext_133193 = ctx_param_ext_tmp_133531;
            ctx_param_ext_133195 = ctx_param_ext_tmp_133532;
            ctx_param_ext_133196 = ctx_param_ext_tmp_133533;
            loop_while_122284 = loop_while_tmp_133534;
            s_iter_122285 = s_iter_tmp_133535;
            minRelevant_122288 = minRelevant_tmp_133538;
        }
        if (memblock_set(ctx, &ext_mem_133231, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133230, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        ext_133229 = ctx_param_ext_133192;
        ext_133228 = ctx_param_ext_133193;
        ext_133227 = ctx_param_ext_133195;
        ext_133226 = ctx_param_ext_133196;
        loopres_122279 = loop_while_122284;
        loopres_122280 = s_iter_122285;
        loopres_122283 = minRelevant_122288;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133233, bytes_133178, "mem_133233")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133187.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_106422});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133230.mem, ext_133227, (int64_t []) {ext_133226}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133235, bytes_133178, "mem_133235")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_106422});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133231.mem, ext_133229, (int64_t []) {ext_133228}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        
        int64_t tmp_122477 = add64((int64_t) 1, iter_122242);
        bool loop_cond_122478 = slt64(tmp_122477, numIter_R_122228);
        
        if (memblock_set(ctx, &mem_param_tmp_133519, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &mem_133233, "mem_133233") != 0)
            return 1;
        
        bool loop_while_tmp_133521 = loop_cond_122478;
        int64_t iter_tmp_133522 = tmp_122477;
        int64_t first_relevant_in_S_tmp_133525 = loopres_122283;
        
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        loop_while_122241 = loop_while_tmp_133521;
        iter_122242 = iter_tmp_133522;
        first_relevant_in_S_122245 = first_relevant_in_S_tmp_133525;
    }
    if (memblock_set(ctx, &ext_mem_133241, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133240, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    defunc_0_mergeJoin_res_122236 = loop_while_122241;
    defunc_0_mergeJoin_res_122237 = iter_122242;
    defunc_0_mergeJoin_res_122240 = first_relevant_in_S_122245;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
        return 1;
    if (mem_133243_cached_sizze_133728 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133243, &mem_133243_cached_sizze_133728, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133245_cached_sizze_133729 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133245, &mem_133245_cached_sizze_133729, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133247_cached_sizze_133730 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133247, &mem_133247_cached_sizze_133730, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133249_cached_sizze_133731 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133731, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133251_cached_sizze_133732 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133251, &mem_133251_cached_sizze_133732, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133253_cached_sizze_133733 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133253, &mem_133253_cached_sizze_133733, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133255_cached_sizze_133734 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133255, &mem_133255_cached_sizze_133734, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133072;
    int64_t discard_133073;
    int64_t defunc_res_129534;
    int64_t scanacc_133054;
    int64_t scanacc_133055;
    int64_t redout_133058;
    
    scanacc_133054 = (int64_t) 0;
    scanacc_133055 = (int64_t) 0;
    redout_133058 = (int64_t) 0;
    for (int64_t i_133064 = 0; i_133064 < nR_106422; i_133064++) {
        int64_t zg_lhs_129015 = ((int64_t *) ext_mem_133241.mem)[i_133064];
        bool cond_129016 = slt64((int64_t) 0, zg_lhs_129015);
        int64_t lifted_lambda_res_129017;
        
        if (cond_129016) {
            lifted_lambda_res_129017 = i_133064;
        } else {
            lifted_lambda_res_129017 = (int64_t) -1;
        }
        
        bool cond_129019 = sle64((int64_t) 0, lifted_lambda_res_129017);
        bool cond_t_res_129020 = slt64(lifted_lambda_res_129017, nR_106422);
        bool x_129021 = cond_129019 && cond_t_res_129020;
        int64_t lifted_lambda_res_129022;
        
        if (x_129021) {
            bool index_certs_129491;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_106422, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_129492 = ((int64_t *) ext_mem_133241.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129022 = lifted_lambda_res_t_res_129492;
        } else {
            lifted_lambda_res_129022 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_129026 = slt64((int64_t) 1, lifted_lambda_res_129022);
        int64_t defunc_0_f_res_129027 = btoi_bool_i64(lifted_lambda_res_129026);
        int64_t lifted_lambda_res_129039;
        int64_t lifted_lambda_res_129040;
        int64_t lifted_lambda_res_129041;
        
        if (x_129021) {
            bool index_certs_129493;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_106422, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:377:7-378:57\n   #4  ftRelational.fut:178:82-85\n   #5  ftRelational.fut:169:1-178:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_129494 = ((int64_t *) tR_mem_133175.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129495 = ((int64_t *) ext_mem_133177.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129496 = ((int64_t *) ext_mem_133240.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129039 = lifted_lambda_res_t_res_129494;
            lifted_lambda_res_129040 = lifted_lambda_res_t_res_129495;
            lifted_lambda_res_129041 = lifted_lambda_res_t_res_129496;
        } else {
            lifted_lambda_res_129039 = (int64_t) 0;
            lifted_lambda_res_129040 = (int64_t) -1;
            lifted_lambda_res_129041 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_122541 = add64(defunc_0_f_res_129027, scanacc_133054);
        int64_t lifted_lambda_res_122502 = add64(lifted_lambda_res_129022, scanacc_133055);
        int64_t zp_res_122522 = add64(lifted_lambda_res_129022, redout_133058);
        
        ((int64_t *) mem_133243)[i_133064] = defunc_0_op_res_122541;
        ((int64_t *) mem_133245)[i_133064] = lifted_lambda_res_122502;
        ((int64_t *) mem_133247)[i_133064] = lifted_lambda_res_129039;
        ((int64_t *) mem_133249)[i_133064] = lifted_lambda_res_129040;
        ((int64_t *) mem_133251)[i_133064] = lifted_lambda_res_129041;
        ((int64_t *) mem_133253)[i_133064] = defunc_0_f_res_129027;
        ((int64_t *) mem_133255)[i_133064] = lifted_lambda_res_129022;
        
        int64_t scanacc_tmp_133547 = defunc_0_op_res_122541;
        int64_t scanacc_tmp_133548 = lifted_lambda_res_122502;
        int64_t redout_tmp_133551 = zp_res_122522;
        
        scanacc_133054 = scanacc_tmp_133547;
        scanacc_133055 = scanacc_tmp_133548;
        redout_133058 = redout_tmp_133551;
    }
    discard_133072 = scanacc_133054;
    discard_133073 = scanacc_133055;
    defunc_res_129534 = redout_133058;
    if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
        return 1;
    
    int64_t bytes_133306 = (int64_t) 8 * defunc_res_129534;
    bool cond_122542 = nR_106422 == (int64_t) 0;
    bool x_122543 = !cond_122542;
    int64_t tmp_122544 = sub64(nR_106422, (int64_t) 1);
    bool x_122545 = sle64((int64_t) 0, tmp_122544);
    bool y_122546 = slt64(tmp_122544, nR_106422);
    bool bounds_check_122547 = x_122545 && y_122546;
    bool protect_assert_disj_122548 = cond_122542 || bounds_check_122547;
    bool index_certs_122549;
    
    if (!protect_assert_disj_122548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_122544, "] out of bounds for array of shape [", (long long) nR_106422, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_122550;
    
    if (x_122543) {
        int64_t x_129497 = ((int64_t *) mem_133243)[tmp_122544];
        
        m_f_res_122550 = x_129497;
    } else {
        m_f_res_122550 = (int64_t) 0;
    }
    
    int64_t m_122552;
    
    if (cond_122542) {
        m_122552 = (int64_t) 0;
    } else {
        m_122552 = m_f_res_122550;
    }
    
    bool cond_122575 = slt64((int64_t) 0, m_122552);
    int64_t m_122562 = sub64(m_122552, (int64_t) 1);
    bool i_p_m_t_s_leq_w_122564 = slt64(m_122562, nR_106422);
    bool zzero_leq_i_p_m_t_s_122563 = sle64((int64_t) 0, m_122562);
    bool y_122566 = zzero_leq_i_p_m_t_s_122563 && i_p_m_t_s_leq_w_122564;
    bool i_lte_j_122565 = sle64((int64_t) 0, m_122552);
    bool forwards_ok_122567 = i_lte_j_122565 && y_122566;
    bool eq_x_zz_122559 = (int64_t) 0 == m_f_res_122550;
    bool p_and_eq_x_y_122560 = x_122543 && eq_x_zz_122559;
    bool empty_slice_122561 = cond_122542 || p_and_eq_x_y_122560;
    bool ok_or_empty_122568 = empty_slice_122561 || forwards_ok_122567;
    bool index_certs_122569;
    
    if (!ok_or_empty_122568) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122552, "] out of bounds for array of shape [", (long long) nR_106422, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:178:82-85\n   #4  ftRelational.fut:169:1-178:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133330 = (int64_t) 8 * m_122552;
    
    if (mem_133331_cached_sizze_133736 < bytes_133330) {
        err = lexical_realloc(ctx, &mem_133331, &mem_133331_cached_sizze_133736, bytes_133330);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133331, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122552});
    
    int64_t max_mult_122576;
    
    if (cond_122575) {
        if (mem_133333_cached_sizze_133737 < bytes_133178) {
            err = lexical_realloc(ctx, &mem_133333, &mem_133333_cached_sizze_133737, bytes_133178);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133091 = 0; i_133091 < nR_106422; i_133091++) {
            int64_t eta_p_129503 = ((int64_t *) mem_133253)[i_133091];
            int64_t eta_p_129504 = ((int64_t *) mem_133243)[i_133091];
            bool cond_129505 = eta_p_129503 == (int64_t) 1;
            int64_t lifted_lambda_res_129506;
            
            if (cond_129505) {
                int64_t lifted_lambda_res_t_res_129507 = sub64(eta_p_129504, (int64_t) 1);
                
                lifted_lambda_res_129506 = lifted_lambda_res_t_res_129507;
            } else {
                lifted_lambda_res_129506 = (int64_t) -1;
            }
            ((int64_t *) mem_133333)[i_133091] = lifted_lambda_res_129506;
        }
        for (int64_t write_iter_133093 = 0; write_iter_133093 < nR_106422; write_iter_133093++) {
            int64_t write_iv_133095 = ((int64_t *) mem_133333)[write_iter_133093];
            int64_t write_iv_133096 = ((int64_t *) mem_133255)[write_iter_133093];
            
            if (sle64((int64_t) 0, write_iv_133095) && slt64(write_iv_133095, m_122552)) {
                ((int64_t *) mem_133331)[write_iv_133095] = write_iv_133096;
            }
        }
        
        int64_t defunc_0_reduce_res_129517;
        int64_t redout_133098 = (int64_t) -9223372036854775808;
        
        for (int64_t i_133099 = 0; i_133099 < m_122552; i_133099++) {
            int64_t x_129518 = ((int64_t *) mem_133331)[i_133099];
            int64_t max_res_129521 = smax64(x_129518, redout_133098);
            int64_t redout_tmp_133559 = max_res_129521;
            
            redout_133098 = redout_tmp_133559;
        }
        defunc_0_reduce_res_129517 = redout_133098;
        max_mult_122576 = defunc_0_reduce_res_129517;
    } else {
        max_mult_122576 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_122582 = slt64(max_mult_122576, (int64_t) 1);
    bool valid_122584 = !bounds_invalid_upwards_122582;
    bool range_valid_c_122585;
    
    if (!valid_122584) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_122576, " is invalid.", "-> #0  ftSMJ.fut:352:16-28\n   #1  ftSMJ.fut:377:7-378:57\n   #2  ftRelational.fut:178:82-85\n   #3  ftRelational.fut:169:1-178:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_133299_cached_sizze_133735 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133735, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133076 = 0; i_133076 < nR_106422; i_133076++) {
        int64_t eta_p_128922 = ((int64_t *) mem_133255)[i_133076];
        int64_t zv_lhs_128924 = add64((int64_t) -1, i_133076);
        int64_t tmp_128925 = smod64(zv_lhs_128924, nR_106422);
        int64_t lifted_lambda_res_128926 = ((int64_t *) mem_133245)[tmp_128925];
        bool cond_128928 = i_133076 == (int64_t) 0;
        int64_t lifted_lambda_res_128929;
        
        if (cond_128928) {
            lifted_lambda_res_128929 = (int64_t) 0;
        } else {
            lifted_lambda_res_128929 = lifted_lambda_res_128926;
        }
        
        bool cond_128931 = slt64((int64_t) 0, eta_p_128922);
        int64_t lifted_lambda_res_128932;
        
        if (cond_128931) {
            lifted_lambda_res_128932 = lifted_lambda_res_128929;
        } else {
            lifted_lambda_res_128932 = (int64_t) -1;
        }
        ((int64_t *) mem_133299)[i_133076] = lifted_lambda_res_128932;
    }
    if (memblock_alloc(ctx, &mem_133307, bytes_133306, "mem_133307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133561 = 0; nest_i_133561 < defunc_res_129534; nest_i_133561++) {
        ((int64_t *) mem_133307.mem)[nest_i_133561] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_133309, bytes_133306, "mem_133309")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133562 = 0; nest_i_133562 < defunc_res_129534; nest_i_133562++) {
        ((int64_t *) mem_133309.mem)[nest_i_133562] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133311, bytes_133306, "mem_133311")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133563 = 0; nest_i_133563 < defunc_res_129534; nest_i_133563++) {
        ((int64_t *) mem_133311.mem)[nest_i_133563] = (int64_t) -1;
    }
    for (int64_t write_iter_133078 = 0; write_iter_133078 < nR_106422; write_iter_133078++) {
        int64_t write_iv_133082 = ((int64_t *) mem_133299)[write_iter_133078];
        int64_t write_iv_133083 = ((int64_t *) mem_133247)[write_iter_133078];
        int64_t write_iv_133084 = ((int64_t *) mem_133249)[write_iter_133078];
        int64_t write_iv_133085 = ((int64_t *) mem_133251)[write_iter_133078];
        
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133307.mem)[write_iv_133082] = write_iv_133083;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133309.mem)[write_iv_133082] = write_iv_133084;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133311.mem)[write_iv_133082] = write_iv_133085;
        }
    }
    
    int64_t distance_122583 = sub64(max_mult_122576, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_133348, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133351, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133354, &mem_133311, "mem_133311") != 0)
        return 1;
    for (int64_t i_122589 = 0; i_122589 < distance_122583; i_122589++) {
        int64_t index_primexp_122593 = add64((int64_t) 1, i_122589);
        
        if (memblock_alloc(ctx, &mem_133356, bytes_133306, "mem_133356")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133356.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133354.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133358, bytes_133306, "mem_133358")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133360, bytes_133306, "mem_133360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133348.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        for (int64_t write_iter_133100 = 0; write_iter_133100 < nR_106422; write_iter_133100++) {
            int64_t write_iv_133105 = ((int64_t *) mem_133251)[write_iter_133100];
            int64_t write_iv_133106 = ((int64_t *) mem_133247)[write_iter_133100];
            int64_t write_iv_133107 = ((int64_t *) mem_133249)[write_iter_133100];
            int64_t zg_lhs_129457 = ((int64_t *) mem_133255)[write_iter_133100];
            bool cond_129458 = slt64(index_primexp_122593, zg_lhs_129457);
            int64_t lifted_lambda_res_129459;
            
            if (cond_129458) {
                int64_t zp_lhs_129527 = ((int64_t *) mem_133299)[write_iter_133100];
                int64_t lifted_lambda_res_t_res_129528 = add64(index_primexp_122593, zp_lhs_129527);
                
                lifted_lambda_res_129459 = lifted_lambda_res_t_res_129528;
            } else {
                lifted_lambda_res_129459 = (int64_t) -1;
            }
            
            int64_t tmp_129463 = add64(index_primexp_122593, write_iv_133105);
            
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133360.mem)[lifted_lambda_res_129459] = write_iv_133106;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133358.mem)[lifted_lambda_res_129459] = write_iv_133107;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133356.mem)[lifted_lambda_res_129459] = tmp_129463;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_133567, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133568, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133569, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133348, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133351, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133354, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133387, &mem_param_133348, "mem_param_133348") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133386, &mem_param_133351, "mem_param_133351") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133385, &mem_param_133354, "mem_param_133354") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133389, bytes_133306, "mem_133389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133391, bytes_133306, "mem_133391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133386.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133393, bytes_133306, "mem_133393")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133393.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133391, "mem_133391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133393, "mem_133393") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133389, "mem_133389") != 0)
        return 1;
    prim_out_133516 = defunc_res_129534;
    if (memblock_set(ctx, &*mem_out_p_133724, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133725, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133726, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133727 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133243);
        free(mem_133245);
        free(mem_133247);
        free(mem_133249);
        free(mem_133251);
        free(mem_133253);
        free(mem_133255);
        free(mem_133299);
        free(mem_133331);
        free(mem_133333);
        if (memblock_unref(ctx, &mem_133393, "mem_133393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133391, "mem_133391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133389, "mem_133389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133354, "mem_param_133354") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133351, "mem_param_133351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133348, "mem_param_133348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133201, "mem_133201") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133199, "mem_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133216, "ext_mem_133216") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133219, "ext_mem_133219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133222, "ext_mem_133222") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133225, "ext_mem_133225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_133738, struct memblock *mem_out_p_133739, struct memblock *mem_out_p_133740, int64_t *out_prim_out_133741, struct memblock tR_mem_133175, struct memblock tS_mem_133176, int64_t nR_101966, int64_t nS_101967, int64_t offset_R_101970, int64_t offset_S_101971, int64_t partitionSizze_101972, int64_t scatter_psizze_101973)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133243_cached_sizze_133742 = 0;
    unsigned char *mem_133243 = NULL;
    int64_t mem_133245_cached_sizze_133743 = 0;
    unsigned char *mem_133245 = NULL;
    int64_t mem_133247_cached_sizze_133744 = 0;
    unsigned char *mem_133247 = NULL;
    int64_t mem_133249_cached_sizze_133745 = 0;
    unsigned char *mem_133249 = NULL;
    int64_t mem_133251_cached_sizze_133746 = 0;
    unsigned char *mem_133251 = NULL;
    int64_t mem_133253_cached_sizze_133747 = 0;
    unsigned char *mem_133253 = NULL;
    int64_t mem_133255_cached_sizze_133748 = 0;
    unsigned char *mem_133255 = NULL;
    int64_t mem_133299_cached_sizze_133749 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133331_cached_sizze_133750 = 0;
    unsigned char *mem_133331 = NULL;
    int64_t mem_133333_cached_sizze_133751 = 0;
    unsigned char *mem_133333 = NULL;
    struct memblock mem_133393;
    
    mem_133393.references = NULL;
    
    struct memblock mem_133391;
    
    mem_133391.references = NULL;
    
    struct memblock mem_133389;
    
    mem_133389.references = NULL;
    
    struct memblock mem_param_tmp_133569;
    
    mem_param_tmp_133569.references = NULL;
    
    struct memblock mem_param_tmp_133568;
    
    mem_param_tmp_133568.references = NULL;
    
    struct memblock mem_param_tmp_133567;
    
    mem_param_tmp_133567.references = NULL;
    
    struct memblock mem_133360;
    
    mem_133360.references = NULL;
    
    struct memblock mem_133358;
    
    mem_133358.references = NULL;
    
    struct memblock mem_133356;
    
    mem_133356.references = NULL;
    
    struct memblock mem_param_133354;
    
    mem_param_133354.references = NULL;
    
    struct memblock mem_param_133351;
    
    mem_param_133351.references = NULL;
    
    struct memblock mem_param_133348;
    
    mem_param_133348.references = NULL;
    
    struct memblock ext_mem_133385;
    
    ext_mem_133385.references = NULL;
    
    struct memblock ext_mem_133386;
    
    ext_mem_133386.references = NULL;
    
    struct memblock ext_mem_133387;
    
    ext_mem_133387.references = NULL;
    
    struct memblock mem_133311;
    
    mem_133311.references = NULL;
    
    struct memblock mem_133309;
    
    mem_133309.references = NULL;
    
    struct memblock mem_133307;
    
    mem_133307.references = NULL;
    
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_133235;
    
    mem_133235.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_param_tmp_133529;
    
    mem_param_tmp_133529.references = NULL;
    
    struct memblock mem_param_tmp_133528;
    
    mem_param_tmp_133528.references = NULL;
    
    struct memblock mem_133201;
    
    mem_133201.references = NULL;
    
    struct memblock mem_133199;
    
    mem_133199.references = NULL;
    
    struct memblock ext_mem_133216;
    
    ext_mem_133216.references = NULL;
    
    struct memblock ext_mem_133219;
    
    ext_mem_133219.references = NULL;
    
    struct memblock ext_mem_133222;
    
    ext_mem_133222.references = NULL;
    
    struct memblock ext_mem_133225;
    
    ext_mem_133225.references = NULL;
    
    struct memblock mem_param_133197;
    
    mem_param_133197.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133230;
    
    ext_mem_133230.references = NULL;
    
    struct memblock ext_mem_133231;
    
    ext_mem_133231.references = NULL;
    
    struct memblock mem_133191;
    
    mem_133191.references = NULL;
    
    struct memblock mem_133189;
    
    mem_133189.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock ext_mem_133240;
    
    ext_mem_133240.references = NULL;
    
    struct memblock ext_mem_133241;
    
    ext_mem_133241.references = NULL;
    
    struct memblock mem_133181;
    
    mem_133181.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock ext_mem_133177;
    
    ext_mem_133177.references = NULL;
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133516;
    int64_t zm_lhs_122223 = add64(nR_101966, partitionSizze_101972);
    int64_t zs_lhs_122224 = sub64(zm_lhs_122223, (int64_t) 1);
    bool zzero_122225 = partitionSizze_101972 == (int64_t) 0;
    bool nonzzero_122226 = !zzero_122225;
    bool nonzzero_cert_122227;
    
    if (!nonzzero_122226) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:274:43-57\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_122228 = sdiv64(zs_lhs_122224, partitionSizze_101972);
    int64_t zm_lhs_122229 = add64(nS_101967, partitionSizze_101972);
    int64_t zs_lhs_122230 = sub64(zm_lhs_122229, (int64_t) 1);
    int64_t numIter_S_122231 = sdiv64(zs_lhs_122230, partitionSizze_101972);
    
    if (futrts_indicesWithIncrement_11373(ctx, &ext_mem_133177, tR_mem_133175, nR_101966, offset_R_101970) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_133178 = (int64_t) 8 * nR_101966;
    
    if (memblock_alloc(ctx, &mem_133179, bytes_133178, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133517 = 0; nest_i_133517 < nR_101966; nest_i_133517++) {
        ((int64_t *) mem_133179.mem)[nest_i_133517] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133181, bytes_133178, "mem_133181")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133518 = 0; nest_i_133518 < nR_101966; nest_i_133518++) {
        ((int64_t *) mem_133181.mem)[nest_i_133518] = (int64_t) 0;
    }
    
    bool loop_cond_122235 = slt64((int64_t) 0, numIter_R_122228);
    bool defunc_0_mergeJoin_res_122236;
    int64_t defunc_0_mergeJoin_res_122237;
    int64_t defunc_0_mergeJoin_res_122240;
    bool loop_while_122241;
    int64_t iter_122242;
    int64_t first_relevant_in_S_122245;
    
    if (memblock_set(ctx, &mem_param_133184, &mem_133181, "mem_133181") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &mem_133179, "mem_133179") != 0)
        return 1;
    loop_while_122241 = loop_cond_122235;
    iter_122242 = (int64_t) 0;
    first_relevant_in_S_122245 = (int64_t) 0;
    while (loop_while_122241) {
        int64_t tR_start_122246 = mul64(partitionSizze_101972, iter_122242);
        int64_t min_arg1_122247 = add64(partitionSizze_101972, tR_start_122246);
        int64_t min_res_122248 = smin64(nR_101966, min_arg1_122247);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 = sub64(min_res_122248, tR_start_122246);
        bool empty_slice_122250 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249 == (int64_t) 0;
        int64_t m_122251 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, (int64_t) 1);
        int64_t i_p_m_t_s_122252 = add64(tR_start_122246, m_122251);
        bool zzero_leq_i_p_m_t_s_122253 = sle64((int64_t) 0, i_p_m_t_s_122252);
        bool i_p_m_t_s_leq_w_122254 = slt64(i_p_m_t_s_122252, nR_101966);
        bool zzero_lte_i_122255 = sle64((int64_t) 0, tR_start_122246);
        bool i_lte_j_122256 = sle64(tR_start_122246, min_res_122248);
        bool y_122257 = i_p_m_t_s_leq_w_122254 && zzero_lte_i_122255;
        bool y_122258 = zzero_leq_i_p_m_t_s_122253 && y_122257;
        bool forwards_ok_122259 = i_lte_j_122256 && y_122258;
        bool ok_or_empty_122260 = empty_slice_122250 || forwards_ok_122259;
        bool index_certs_122261;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_101966, "].", "-> #0  ftSMJ.fut:281:17-36\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133188 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249;
        bool cond_122265 = slt64(first_relevant_in_S_122245, numIter_S_122231);
        bool y_122266 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool loop_not_taken_122267 = !cond_122265;
        bool protect_assert_disj_122268 = y_122266 || loop_not_taken_122267;
        bool index_certs_122269;
        
        if (!protect_assert_disj_122268) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:296:26-34\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_122272 = sle64((int64_t) 0, m_122251);
        bool y_122273 = slt64(m_122251, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249);
        bool bounds_check_122274 = x_122272 && y_122273;
        bool protect_assert_disj_122275 = loop_not_taken_122267 || bounds_check_122274;
        bool index_certs_122276;
        
        if (!protect_assert_disj_122275) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:297:28-47\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_122473;
        
        if (!ok_or_empty_122260) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_122246, ":", (long long) min_res_122248, "] out of bounds for array of shape [", (long long) nR_101966, "].", "-> #0  ftSMJ.fut:198:15-63\n   #1  ftSMJ.fut:307:20-64\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133189, bytes_133188, "mem_133189")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133526 = 0; nest_i_133526 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133526++) {
            ((int64_t *) mem_133189.mem)[nest_i_133526] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_133191, bytes_133188, "mem_133191")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_133527 = 0; nest_i_133527 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; nest_i_133527++) {
            ((int64_t *) mem_133191.mem)[nest_i_133527] = (int64_t) 0;
        }
        
        int16_t gt_lhs_122270;
        
        if (cond_122265) {
            int16_t x_129472 = ((int16_t *) tR_mem_133175.mem)[tR_start_122246];
            
            gt_lhs_122270 = x_129472;
        } else {
            gt_lhs_122270 = (int16_t) 0;
        }
        
        int16_t lt_lhs_122277;
        
        if (cond_122265) {
            int16_t x_129473 = ((int16_t *) tR_mem_133175.mem)[i_p_m_t_s_122252];
            
            lt_lhs_122277 = x_129473;
        } else {
            lt_lhs_122277 = (int16_t) 0;
        }
        
        int64_t ext_133229;
        int64_t ext_133228;
        int64_t ext_133227;
        int64_t ext_133226;
        bool loopres_122279;
        int64_t loopres_122280;
        int64_t loopres_122283;
        bool loop_while_122284;
        int64_t s_iter_122285;
        int64_t minRelevant_122288;
        int64_t ctx_param_ext_133192;
        int64_t ctx_param_ext_133193;
        int64_t ctx_param_ext_133195;
        int64_t ctx_param_ext_133196;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133197, &mem_133189, "mem_133189") != 0)
            return 1;
        ctx_param_ext_133192 = (int64_t) 0;
        ctx_param_ext_133193 = (int64_t) 1;
        ctx_param_ext_133195 = (int64_t) 0;
        ctx_param_ext_133196 = (int64_t) 1;
        loop_while_122284 = cond_122265;
        s_iter_122285 = first_relevant_in_S_122245;
        minRelevant_122288 = first_relevant_in_S_122245;
        while (loop_while_122284) {
            int64_t tS_start_122289 = mul64(partitionSizze_101972, s_iter_122285);
            int64_t min_arg1_122290 = add64(partitionSizze_101972, tS_start_122289);
            int64_t min_res_122291 = smin64(nS_101967, min_arg1_122290);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 = sub64(min_res_122291, tS_start_122289);
            bool empty_slice_122293 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292 == (int64_t) 0;
            int64_t m_122294 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 1);
            int64_t i_p_m_t_s_122295 = add64(tS_start_122289, m_122294);
            bool zzero_leq_i_p_m_t_s_122296 = sle64((int64_t) 0, i_p_m_t_s_122295);
            bool i_p_m_t_s_leq_w_122297 = slt64(i_p_m_t_s_122295, nS_101967);
            bool zzero_lte_i_122298 = sle64((int64_t) 0, tS_start_122289);
            bool i_lte_j_122299 = sle64(tS_start_122289, min_res_122291);
            bool y_122300 = i_p_m_t_s_leq_w_122297 && zzero_lte_i_122298;
            bool y_122301 = zzero_leq_i_p_m_t_s_122296 && y_122300;
            bool forwards_ok_122302 = i_lte_j_122299 && y_122301;
            bool ok_or_empty_122303 = empty_slice_122293 || forwards_ok_122302;
            bool index_certs_122304;
            
            if (!ok_or_empty_122303) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_122289, ":", (long long) min_res_122291, "] out of bounds for array of shape [", (long long) nS_101967, "].", "-> #0  ftSMJ.fut:294:19-38\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_122305 = sle64((int64_t) 0, m_122294);
            bool y_122306 = slt64(m_122294, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool bounds_check_122307 = x_122305 && y_122306;
            bool index_certs_122308;
            
            if (!bounds_check_122307) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122294, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:296:40-59\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_122311 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
            bool index_certs_122312;
            
            if (!y_122311) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:297:53-61\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t gt_rhs_122309 = ((int16_t *) tS_mem_133176.mem)[i_p_m_t_s_122295];
            bool defunc_0_gt_res_122310 = slt16(gt_rhs_122309, gt_lhs_122270);
            int16_t lt_rhs_122313 = ((int16_t *) tS_mem_133176.mem)[tS_start_122289];
            bool defunc_0_lt_res_122314 = slt16(lt_lhs_122277, lt_rhs_122313);
            bool thisStillRel_122315 = !defunc_0_lt_res_122314;
            int64_t ext_133218;
            
            if (defunc_0_lt_res_122314) {
                ext_133218 = ctx_param_ext_133192;
            } else {
                ext_133218 = (int64_t) 0;
            }
            
            int64_t ext_133217;
            
            if (defunc_0_lt_res_122314) {
                ext_133217 = ctx_param_ext_133193;
            } else {
                ext_133217 = (int64_t) 1;
            }
            
            int64_t ext_133215;
            
            if (defunc_0_lt_res_122314) {
                ext_133215 = ctx_param_ext_133195;
            } else {
                ext_133215 = (int64_t) 0;
            }
            
            int64_t ext_133214;
            
            if (defunc_0_lt_res_122314) {
                ext_133214 = ctx_param_ext_133196;
            } else {
                ext_133214 = (int64_t) 1;
            }
            
            int64_t ext_133224;
            
            if (defunc_0_gt_res_122310) {
                ext_133224 = ctx_param_ext_133192;
            } else {
                ext_133224 = ext_133218;
            }
            
            int64_t ext_133223;
            
            if (defunc_0_gt_res_122310) {
                ext_133223 = ctx_param_ext_133193;
            } else {
                ext_133223 = ext_133217;
            }
            
            int64_t ext_133221;
            
            if (defunc_0_gt_res_122310) {
                ext_133221 = ctx_param_ext_133195;
            } else {
                ext_133221 = ext_133215;
            }
            
            int64_t ext_133220;
            
            if (defunc_0_gt_res_122310) {
                ext_133220 = ctx_param_ext_133196;
            } else {
                ext_133220 = ext_133214;
            }
            
            int64_t loopres_122316;
            bool loopres_122319;
            int64_t loopres_122320;
            
            if (defunc_0_gt_res_122310) {
                int64_t tmp_129474 = add64((int64_t) 1, s_iter_122285);
                
                if (memblock_set(ctx, &ext_mem_133225, &mem_param_133194, "mem_param_133194") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &mem_param_133197, "mem_param_133197") != 0)
                    return 1;
                loopres_122316 = tmp_129474;
                loopres_122319 = 1;
                loopres_122320 = tmp_129474;
            } else {
                int64_t loopres_f_res_122322;
                bool loopres_f_res_122325;
                
                if (defunc_0_lt_res_122314) {
                    if (memblock_set(ctx, &ext_mem_133219, &mem_param_133194, "mem_param_133194") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_param_133197, "mem_param_133197") != 0)
                        return 1;
                    loopres_f_res_122322 = s_iter_122285;
                    loopres_f_res_122325 = thisStillRel_122315;
                } else {
                    bool index_certs_122326;
                    
                    if (!bounds_check_122274) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249, "].", "-> #0  ftSMJ.fut:301:25-44\n   #1  ftSMJ.fut:377:84-86\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lt_lhs_122327 = ((int16_t *) tR_mem_133175.mem)[i_p_m_t_s_122252];
                    bool defunc_0_lt_res_122328 = slt16(lt_lhs_122327, gt_rhs_122309);
                    bool nextRel_122329 = !defunc_0_lt_res_122328;
                    int64_t find_joinTuples_arg3_122330 = add64(offset_S_101971, tS_start_122289);
                    int64_t max_arg1_122331 = sdiv64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, (int64_t) 2);
                    int64_t max_res_122332 = smax64((int64_t) 1, max_arg1_122331);
                    bool loop_cond_122333 = slt64((int64_t) 0, max_res_122332);
                    
                    if (memblock_alloc(ctx, &mem_133199, bytes_133188, "mem_133199")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_133201, bytes_133188, "mem_133201")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_133044 = 0; i_133044 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249; i_133044++) {
                        int64_t eta_p_129190 = ((int64_t *) mem_param_133194.mem)[ctx_param_ext_133192 + i_133044 * ctx_param_ext_133193];
                        int64_t slice_133152 = tR_start_122246 + i_133044;
                        int16_t eta_p_129191 = ((int16_t *) tR_mem_133175.mem)[slice_133152];
                        int64_t eta_p_129192 = ((int64_t *) mem_param_133197.mem)[ctx_param_ext_133195 + i_133044 * ctx_param_ext_133196];
                        bool defunc_0_f_res_129193;
                        int64_t defunc_0_f_res_129194;
                        int64_t defunc_0_f_res_129195;
                        bool loop_while_129196;
                        int64_t first_match_129197;
                        int64_t step_129198;
                        
                        loop_while_129196 = loop_cond_122333;
                        first_match_129197 = (int64_t) 0;
                        step_129198 = max_res_122332;
                        while (loop_while_129196) {
                            bool x_129199 = sle64((int64_t) 0, first_match_129197);
                            bool y_129200 = slt64(first_match_129197, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                            bool bounds_check_129201 = x_129199 && y_129200;
                            bool index_certs_129202;
                            
                            if (!bounds_check_129201) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) first_match_129197, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:220:20-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129203 = tS_start_122289 + first_match_129197;
                            int16_t sv_129204 = ((int16_t *) tS_mem_133176.mem)[slice_129203];
                            bool cond_129205 = first_match_129197 == (int64_t) 0;
                            int16_t pv_129206;
                            
                            if (cond_129205) {
                                pv_129206 = sv_129204;
                            } else {
                                int64_t tmp_129207 = sub64(first_match_129197, (int64_t) 1);
                                bool x_129208 = sle64((int64_t) 0, tmp_129207);
                                bool y_129209 = slt64(tmp_129207, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129210 = x_129208 && y_129209;
                                bool index_certs_129211;
                                
                                if (!bounds_check_129210) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129207, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:221:51-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129212 = tS_start_122289 + tmp_129207;
                                int16_t pv_f_res_129213 = ((int16_t *) tS_mem_133176.mem)[slice_129212];
                                
                                pv_129206 = pv_f_res_129213;
                            }
                            
                            bool cond_129214 = first_match_129197 == m_122294;
                            int16_t nv_129215;
                            
                            if (cond_129214) {
                                nv_129215 = sv_129204;
                            } else {
                                int64_t tmp_129216 = add64((int64_t) 1, first_match_129197);
                                bool x_129217 = sle64((int64_t) 0, tmp_129216);
                                bool y_129218 = slt64(tmp_129216, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129219 = x_129217 && y_129218;
                                bool index_certs_129220;
                                
                                if (!bounds_check_129219) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129216, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:222:54-71\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129221 = tS_start_122289 + tmp_129216;
                                int16_t nv_f_res_129222 = ((int16_t *) tS_mem_133176.mem)[slice_129221];
                                
                                nv_129215 = nv_f_res_129222;
                            }
                            
                            bool defunc_0_eq_res_129223 = eta_p_129191 == sv_129204;
                            bool defunc_0_gt_res_129224 = slt16(pv_129206, eta_p_129191);
                            bool x_129225 = !cond_129205;
                            bool y_129226 = defunc_0_gt_res_129224 && x_129225;
                            bool cond_t_res_129227 = cond_129205 || y_129226;
                            bool x_129228 = defunc_0_eq_res_129223 && cond_t_res_129227;
                            int64_t loopres_129229;
                            int64_t loopres_129230;
                            
                            if (x_129228) {
                                loopres_129229 = first_match_129197;
                                loopres_129230 = (int64_t) 0;
                            } else {
                                int64_t loopres_f_res_129231;
                                int64_t loopres_f_res_129232;
                                
                                if (defunc_0_eq_res_129223) {
                                    int64_t tmp_129475 = sub64(first_match_129197, step_129198);
                                    int64_t max_arg1_129476 = sdiv64(step_129198, (int64_t) 2);
                                    int64_t max_res_129477 = smax64((int64_t) 1, max_arg1_129476);
                                    
                                    loopres_f_res_129231 = tmp_129475;
                                    loopres_f_res_129232 = max_res_129477;
                                } else {
                                    bool defunc_0_lt_res_129236 = slt16(eta_p_129191, sv_129204);
                                    int64_t loopres_f_res_f_res_129237;
                                    int64_t loopres_f_res_f_res_129238;
                                    
                                    if (defunc_0_lt_res_129236) {
                                        int64_t loopres_f_res_f_res_t_res_129478;
                                        int64_t loopres_f_res_f_res_t_res_129479;
                                        
                                        if (cond_t_res_129227) {
                                            loopres_f_res_f_res_t_res_129478 = (int64_t) -1;
                                            loopres_f_res_f_res_t_res_129479 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129480 = sub64(first_match_129197, step_129198);
                                            int64_t max_arg1_129481 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129482 = smax64((int64_t) 1, max_arg1_129481);
                                            
                                            loopres_f_res_f_res_t_res_129478 = tmp_129480;
                                            loopres_f_res_f_res_t_res_129479 = max_res_129482;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_t_res_129478;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_t_res_129479;
                                    } else {
                                        bool defunc_0_lt_res_129246 = slt16(eta_p_129191, nv_129215);
                                        bool x_129247 = !cond_129214;
                                        bool y_129248 = defunc_0_lt_res_129246 && x_129247;
                                        bool cond_129249 = cond_129214 || y_129248;
                                        int64_t loopres_f_res_f_res_f_res_129250;
                                        int64_t loopres_f_res_f_res_f_res_129251;
                                        
                                        if (cond_129249) {
                                            loopres_f_res_f_res_f_res_129250 = (int64_t) -1;
                                            loopres_f_res_f_res_f_res_129251 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_129252 = add64(first_match_129197, step_129198);
                                            int64_t max_arg1_129253 = sdiv64(step_129198, (int64_t) 2);
                                            int64_t max_res_129254 = smax64((int64_t) 1, max_arg1_129253);
                                            
                                            loopres_f_res_f_res_f_res_129250 = tmp_129252;
                                            loopres_f_res_f_res_f_res_129251 = max_res_129254;
                                        }
                                        loopres_f_res_f_res_129237 = loopres_f_res_f_res_f_res_129250;
                                        loopres_f_res_f_res_129238 = loopres_f_res_f_res_f_res_129251;
                                    }
                                    loopres_f_res_129231 = loopres_f_res_f_res_129237;
                                    loopres_f_res_129232 = loopres_f_res_f_res_129238;
                                }
                                loopres_129229 = loopres_f_res_129231;
                                loopres_129230 = loopres_f_res_129232;
                            }
                            
                            bool loop_cond_129255 = slt64((int64_t) 0, loopres_129230);
                            bool loop_while_tmp_133541 = loop_cond_129255;
                            int64_t first_match_tmp_133542 = loopres_129229;
                            int64_t step_tmp_133543 = loopres_129230;
                            
                            loop_while_129196 = loop_while_tmp_133541;
                            first_match_129197 = first_match_tmp_133542;
                            step_129198 = step_tmp_133543;
                        }
                        defunc_0_f_res_129193 = loop_while_129196;
                        defunc_0_f_res_129194 = first_match_129197;
                        defunc_0_f_res_129195 = step_129198;
                        
                        int64_t zs_lhs_129256 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, defunc_0_f_res_129194);
                        int64_t max_arg1_129257 = sdiv64(zs_lhs_129256, (int64_t) 2);
                        int64_t max_res_129258 = smax64((int64_t) 1, max_arg1_129257);
                        bool cond_129259 = defunc_0_f_res_129194 == (int64_t) -1;
                        int64_t defunc_0_f_res_129260;
                        
                        if (cond_129259) {
                            defunc_0_f_res_129260 = (int64_t) -1;
                        } else {
                            bool loop_cond_129262 = slt64((int64_t) 0, max_res_129258);
                            bool defunc_0_f_res_f_res_129263;
                            int64_t defunc_0_f_res_f_res_129264;
                            int64_t defunc_0_f_res_f_res_129265;
                            bool loop_while_129266;
                            int64_t last_match_129267;
                            int64_t step_129268;
                            
                            loop_while_129266 = loop_cond_129262;
                            last_match_129267 = m_122294;
                            step_129268 = max_res_129258;
                            while (loop_while_129266) {
                                bool x_129269 = sle64((int64_t) 0, last_match_129267);
                                bool y_129270 = slt64(last_match_129267, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                bool bounds_check_129271 = x_129269 && y_129270;
                                bool index_certs_129272;
                                
                                if (!bounds_check_129271) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) last_match_129267, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:241:20-34\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_129273 = tS_start_122289 + last_match_129267;
                                int16_t sv_129274 = ((int16_t *) tS_mem_133176.mem)[slice_129273];
                                bool cond_129275 = last_match_129267 == m_122294;
                                int16_t nv_129276;
                                
                                if (cond_129275) {
                                    nv_129276 = sv_129274;
                                } else {
                                    int64_t tmp_129277 = add64((int64_t) 1, last_match_129267);
                                    bool x_129278 = sle64((int64_t) 0, tmp_129277);
                                    bool y_129279 = slt64(tmp_129277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292);
                                    bool bounds_check_129280 = x_129278 && y_129279;
                                    bool index_certs_129281;
                                    
                                    if (!bounds_check_129280) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_122292, "].", "-> #0  ftSMJ.fut:242:53-69\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:84-86\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129282 = tS_start_122289 + tmp_129277;
                                    int16_t nv_f_res_129283 = ((int16_t *) tS_mem_133176.mem)[slice_129282];
                                    
                                    nv_129276 = nv_f_res_129283;
                                }
                                
                                bool defunc_0_eq_res_129284 = eta_p_129191 == sv_129274;
                                bool defunc_0_lt_res_129285 = slt16(eta_p_129191, nv_129276);
                                bool x_129286 = !cond_129275;
                                bool y_129287 = defunc_0_lt_res_129285 && x_129286;
                                bool cond_t_res_129288 = cond_129275 || y_129287;
                                bool x_129289 = defunc_0_eq_res_129284 && cond_t_res_129288;
                                int64_t loopres_129290;
                                int64_t loopres_129291;
                                
                                if (x_129289) {
                                    loopres_129290 = last_match_129267;
                                    loopres_129291 = (int64_t) 0;
                                } else {
                                    int64_t loopres_f_res_129292;
                                    int64_t loopres_f_res_129293;
                                    
                                    if (defunc_0_eq_res_129284) {
                                        int64_t tmp_129483 = add64(last_match_129267, step_129268);
                                        int64_t max_arg1_129484 = sdiv64(step_129268, (int64_t) 2);
                                        int64_t max_res_129485 = smax64((int64_t) 1, max_arg1_129484);
                                        
                                        loopres_f_res_129292 = tmp_129483;
                                        loopres_f_res_129293 = max_res_129485;
                                    } else {
                                        bool defunc_0_lt_res_129297 = slt16(eta_p_129191, sv_129274);
                                        int64_t loopres_f_res_f_res_129298;
                                        int64_t loopres_f_res_f_res_129299;
                                        
                                        if (defunc_0_lt_res_129297) {
                                            int64_t tmp_129486 = sub64(last_match_129267, step_129268);
                                            int64_t max_arg1_129487 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129488 = smax64((int64_t) 1, max_arg1_129487);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129486;
                                            loopres_f_res_f_res_129299 = max_res_129488;
                                        } else {
                                            int64_t tmp_129303 = add64(last_match_129267, step_129268);
                                            int64_t max_arg1_129304 = sdiv64(step_129268, (int64_t) 2);
                                            int64_t max_res_129305 = smax64((int64_t) 1, max_arg1_129304);
                                            
                                            loopres_f_res_f_res_129298 = tmp_129303;
                                            loopres_f_res_f_res_129299 = max_res_129305;
                                        }
                                        loopres_f_res_129292 = loopres_f_res_f_res_129298;
                                        loopres_f_res_129293 = loopres_f_res_f_res_129299;
                                    }
                                    loopres_129290 = loopres_f_res_129292;
                                    loopres_129291 = loopres_f_res_129293;
                                }
                                
                                bool loop_cond_129306 = slt64((int64_t) 0, loopres_129291);
                                bool loop_while_tmp_133544 = loop_cond_129306;
                                int64_t last_match_tmp_133545 = loopres_129290;
                                int64_t step_tmp_133546 = loopres_129291;
                                
                                loop_while_129266 = loop_while_tmp_133544;
                                last_match_129267 = last_match_tmp_133545;
                                step_129268 = step_tmp_133546;
                            }
                            defunc_0_f_res_f_res_129263 = loop_while_129266;
                            defunc_0_f_res_f_res_129264 = last_match_129267;
                            defunc_0_f_res_f_res_129265 = step_129268;
                            defunc_0_f_res_129260 = defunc_0_f_res_f_res_129264;
                        }
                        
                        bool cond_129307 = slt64(defunc_0_f_res_129194, (int64_t) 0);
                        int64_t cm_129308;
                        
                        if (cond_129307) {
                            cm_129308 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_129309 = sub64(defunc_0_f_res_129260, defunc_0_f_res_129194);
                            int64_t cm_f_res_129310 = add64((int64_t) 1, zp_lhs_129309);
                            
                            cm_129308 = cm_f_res_129310;
                        }
                        
                        int64_t lifted_lambda_res_129314;
                        
                        if (cond_129307) {
                            lifted_lambda_res_129314 = defunc_0_f_res_129194;
                        } else {
                            int64_t lifted_lambda_res_f_res_129315 = add64(find_joinTuples_arg3_122330, defunc_0_f_res_129194);
                            
                            lifted_lambda_res_129314 = lifted_lambda_res_f_res_129315;
                        }
                        
                        bool cond_129317 = slt64(eta_p_129192, (int64_t) 0);
                        int64_t lifted_lambda_res_129318;
                        
                        if (cond_129317) {
                            lifted_lambda_res_129318 = lifted_lambda_res_129314;
                        } else {
                            lifted_lambda_res_129318 = eta_p_129192;
                        }
                        
                        int64_t defunc_0_f_res_129321 = add64(eta_p_129190, cm_129308);
                        
                        ((int64_t *) mem_133199.mem)[i_133044] = defunc_0_f_res_129321;
                        ((int64_t *) mem_133201.mem)[i_133044] = lifted_lambda_res_129318;
                    }
                    
                    int64_t tmp_122469 = add64((int64_t) 1, s_iter_122285);
                    
                    if (memblock_set(ctx, &ext_mem_133219, &mem_133199, "mem_133199") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133216, &mem_133201, "mem_133201") != 0)
                        return 1;
                    loopres_f_res_122322 = tmp_122469;
                    loopres_f_res_122325 = nextRel_122329;
                }
                if (memblock_set(ctx, &ext_mem_133225, &ext_mem_133219, "ext_mem_133219") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_133222, &ext_mem_133216, "ext_mem_133216") != 0)
                    return 1;
                loopres_122316 = loopres_f_res_122322;
                loopres_122319 = loopres_f_res_122325;
                loopres_122320 = minRelevant_122288;
            }
            
            bool cond_122470 = slt64(loopres_122316, numIter_S_122231);
            bool x_122471 = loopres_122319 && cond_122470;
            
            if (memblock_set(ctx, &mem_param_tmp_133528, &ext_mem_133225, "ext_mem_133225") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133529, &ext_mem_133222, "ext_mem_133222") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_133530 = ext_133224;
            int64_t ctx_param_ext_tmp_133531 = ext_133223;
            int64_t ctx_param_ext_tmp_133532 = ext_133221;
            int64_t ctx_param_ext_tmp_133533 = ext_133220;
            bool loop_while_tmp_133534 = x_122471;
            int64_t s_iter_tmp_133535 = loopres_122316;
            int64_t minRelevant_tmp_133538 = loopres_122320;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133197, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
                return 1;
            ctx_param_ext_133192 = ctx_param_ext_tmp_133530;
            ctx_param_ext_133193 = ctx_param_ext_tmp_133531;
            ctx_param_ext_133195 = ctx_param_ext_tmp_133532;
            ctx_param_ext_133196 = ctx_param_ext_tmp_133533;
            loop_while_122284 = loop_while_tmp_133534;
            s_iter_122285 = s_iter_tmp_133535;
            minRelevant_122288 = minRelevant_tmp_133538;
        }
        if (memblock_set(ctx, &ext_mem_133231, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133230, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        ext_133229 = ctx_param_ext_133192;
        ext_133228 = ctx_param_ext_133193;
        ext_133227 = ctx_param_ext_133195;
        ext_133226 = ctx_param_ext_133196;
        loopres_122279 = loop_while_122284;
        loopres_122280 = s_iter_122285;
        loopres_122283 = minRelevant_122288;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133233, bytes_133178, "mem_133233")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133187.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_101966});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133233.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133230.mem, ext_133227, (int64_t []) {ext_133226}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_133235, bytes_133178, "mem_133235")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_101966});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133235.mem, tR_start_122246, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133231.mem, ext_133229, (int64_t []) {ext_133228}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_122249});
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        
        int64_t tmp_122477 = add64((int64_t) 1, iter_122242);
        bool loop_cond_122478 = slt64(tmp_122477, numIter_R_122228);
        
        if (memblock_set(ctx, &mem_param_tmp_133519, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &mem_133233, "mem_133233") != 0)
            return 1;
        
        bool loop_while_tmp_133521 = loop_cond_122478;
        int64_t iter_tmp_133522 = tmp_122477;
        int64_t first_relevant_in_S_tmp_133525 = loopres_122283;
        
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        loop_while_122241 = loop_while_tmp_133521;
        iter_122242 = iter_tmp_133522;
        first_relevant_in_S_122245 = first_relevant_in_S_tmp_133525;
    }
    if (memblock_set(ctx, &ext_mem_133241, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133240, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    defunc_0_mergeJoin_res_122236 = loop_while_122241;
    defunc_0_mergeJoin_res_122237 = iter_122242;
    defunc_0_mergeJoin_res_122240 = first_relevant_in_S_122245;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
        return 1;
    if (mem_133243_cached_sizze_133742 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133243, &mem_133243_cached_sizze_133742, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133245_cached_sizze_133743 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133245, &mem_133245_cached_sizze_133743, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_133246 = (int64_t) 2 * nR_101966;
    
    if (mem_133247_cached_sizze_133744 < bytes_133246) {
        err = lexical_realloc(ctx, &mem_133247, &mem_133247_cached_sizze_133744, bytes_133246);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133249_cached_sizze_133745 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133249, &mem_133249_cached_sizze_133745, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133251_cached_sizze_133746 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133251, &mem_133251_cached_sizze_133746, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133253_cached_sizze_133747 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133253, &mem_133253_cached_sizze_133747, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133255_cached_sizze_133748 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133255, &mem_133255_cached_sizze_133748, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133072;
    int64_t discard_133073;
    int64_t defunc_res_129534;
    int64_t scanacc_133054;
    int64_t scanacc_133055;
    int64_t redout_133058;
    
    scanacc_133054 = (int64_t) 0;
    scanacc_133055 = (int64_t) 0;
    redout_133058 = (int64_t) 0;
    for (int64_t i_133064 = 0; i_133064 < nR_101966; i_133064++) {
        int64_t zg_lhs_129015 = ((int64_t *) ext_mem_133241.mem)[i_133064];
        bool cond_129016 = slt64((int64_t) 0, zg_lhs_129015);
        int64_t lifted_lambda_res_129017;
        
        if (cond_129016) {
            lifted_lambda_res_129017 = i_133064;
        } else {
            lifted_lambda_res_129017 = (int64_t) -1;
        }
        
        bool cond_129019 = sle64((int64_t) 0, lifted_lambda_res_129017);
        bool cond_t_res_129020 = slt64(lifted_lambda_res_129017, nR_101966);
        bool x_129021 = cond_129019 && cond_t_res_129020;
        int64_t lifted_lambda_res_129022;
        
        if (x_129021) {
            bool index_certs_129491;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_101966, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_129492 = ((int64_t *) ext_mem_133241.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129022 = lifted_lambda_res_t_res_129492;
        } else {
            lifted_lambda_res_129022 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_129026 = slt64((int64_t) 1, lifted_lambda_res_129022);
        int64_t defunc_0_f_res_129027 = btoi_bool_i64(lifted_lambda_res_129026);
        int16_t lifted_lambda_res_129039;
        int64_t lifted_lambda_res_129040;
        int64_t lifted_lambda_res_129041;
        
        if (x_129021) {
            bool index_certs_129493;
            
            if (!x_129021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_129017, "] out of bounds for array of shape [", (long long) nR_101966, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:377:7-378:57\n   #4  ftRelational.fut:156:82-85\n   #5  ftRelational.fut:147:1-156:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t lifted_lambda_res_t_res_129494 = ((int16_t *) tR_mem_133175.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129495 = ((int64_t *) ext_mem_133177.mem)[lifted_lambda_res_129017];
            int64_t lifted_lambda_res_t_res_129496 = ((int64_t *) ext_mem_133240.mem)[lifted_lambda_res_129017];
            
            lifted_lambda_res_129039 = lifted_lambda_res_t_res_129494;
            lifted_lambda_res_129040 = lifted_lambda_res_t_res_129495;
            lifted_lambda_res_129041 = lifted_lambda_res_t_res_129496;
        } else {
            lifted_lambda_res_129039 = (int16_t) 0;
            lifted_lambda_res_129040 = (int64_t) -1;
            lifted_lambda_res_129041 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_122541 = add64(defunc_0_f_res_129027, scanacc_133054);
        int64_t lifted_lambda_res_122502 = add64(lifted_lambda_res_129022, scanacc_133055);
        int64_t zp_res_122522 = add64(lifted_lambda_res_129022, redout_133058);
        
        ((int64_t *) mem_133243)[i_133064] = defunc_0_op_res_122541;
        ((int64_t *) mem_133245)[i_133064] = lifted_lambda_res_122502;
        ((int16_t *) mem_133247)[i_133064] = lifted_lambda_res_129039;
        ((int64_t *) mem_133249)[i_133064] = lifted_lambda_res_129040;
        ((int64_t *) mem_133251)[i_133064] = lifted_lambda_res_129041;
        ((int64_t *) mem_133253)[i_133064] = defunc_0_f_res_129027;
        ((int64_t *) mem_133255)[i_133064] = lifted_lambda_res_129022;
        
        int64_t scanacc_tmp_133547 = defunc_0_op_res_122541;
        int64_t scanacc_tmp_133548 = lifted_lambda_res_122502;
        int64_t redout_tmp_133551 = zp_res_122522;
        
        scanacc_133054 = scanacc_tmp_133547;
        scanacc_133055 = scanacc_tmp_133548;
        redout_133058 = redout_tmp_133551;
    }
    discard_133072 = scanacc_133054;
    discard_133073 = scanacc_133055;
    defunc_res_129534 = redout_133058;
    if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
        return 1;
    
    int64_t bytes_133306 = (int64_t) 2 * defunc_res_129534;
    int64_t bytes_133308 = (int64_t) 8 * defunc_res_129534;
    bool cond_122542 = nR_101966 == (int64_t) 0;
    bool x_122543 = !cond_122542;
    int64_t tmp_122544 = sub64(nR_101966, (int64_t) 1);
    bool x_122545 = sle64((int64_t) 0, tmp_122544);
    bool y_122546 = slt64(tmp_122544, nR_101966);
    bool bounds_check_122547 = x_122545 && y_122546;
    bool protect_assert_disj_122548 = cond_122542 || bounds_check_122547;
    bool index_certs_122549;
    
    if (!protect_assert_disj_122548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_122544, "] out of bounds for array of shape [", (long long) nR_101966, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_122550;
    
    if (x_122543) {
        int64_t x_129497 = ((int64_t *) mem_133243)[tmp_122544];
        
        m_f_res_122550 = x_129497;
    } else {
        m_f_res_122550 = (int64_t) 0;
    }
    
    int64_t m_122552;
    
    if (cond_122542) {
        m_122552 = (int64_t) 0;
    } else {
        m_122552 = m_f_res_122550;
    }
    
    bool cond_122575 = slt64((int64_t) 0, m_122552);
    int64_t m_122562 = sub64(m_122552, (int64_t) 1);
    bool i_p_m_t_s_leq_w_122564 = slt64(m_122562, nR_101966);
    bool zzero_leq_i_p_m_t_s_122563 = sle64((int64_t) 0, m_122562);
    bool y_122566 = zzero_leq_i_p_m_t_s_122563 && i_p_m_t_s_leq_w_122564;
    bool i_lte_j_122565 = sle64((int64_t) 0, m_122552);
    bool forwards_ok_122567 = i_lte_j_122565 && y_122566;
    bool eq_x_zz_122559 = (int64_t) 0 == m_f_res_122550;
    bool p_and_eq_x_y_122560 = x_122543 && eq_x_zz_122559;
    bool empty_slice_122561 = cond_122542 || p_and_eq_x_y_122560;
    bool ok_or_empty_122568 = empty_slice_122561 || forwards_ok_122567;
    bool index_certs_122569;
    
    if (!ok_or_empty_122568) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122552, "] out of bounds for array of shape [", (long long) nR_101966, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:377:7-378:57\n   #3  ftRelational.fut:156:82-85\n   #4  ftRelational.fut:147:1-156:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133330 = (int64_t) 8 * m_122552;
    
    if (mem_133331_cached_sizze_133750 < bytes_133330) {
        err = lexical_realloc(ctx, &mem_133331, &mem_133331_cached_sizze_133750, bytes_133330);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133331, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122552});
    
    int64_t max_mult_122576;
    
    if (cond_122575) {
        if (mem_133333_cached_sizze_133751 < bytes_133178) {
            err = lexical_realloc(ctx, &mem_133333, &mem_133333_cached_sizze_133751, bytes_133178);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133091 = 0; i_133091 < nR_101966; i_133091++) {
            int64_t eta_p_129503 = ((int64_t *) mem_133253)[i_133091];
            int64_t eta_p_129504 = ((int64_t *) mem_133243)[i_133091];
            bool cond_129505 = eta_p_129503 == (int64_t) 1;
            int64_t lifted_lambda_res_129506;
            
            if (cond_129505) {
                int64_t lifted_lambda_res_t_res_129507 = sub64(eta_p_129504, (int64_t) 1);
                
                lifted_lambda_res_129506 = lifted_lambda_res_t_res_129507;
            } else {
                lifted_lambda_res_129506 = (int64_t) -1;
            }
            ((int64_t *) mem_133333)[i_133091] = lifted_lambda_res_129506;
        }
        for (int64_t write_iter_133093 = 0; write_iter_133093 < nR_101966; write_iter_133093++) {
            int64_t write_iv_133095 = ((int64_t *) mem_133333)[write_iter_133093];
            int64_t write_iv_133096 = ((int64_t *) mem_133255)[write_iter_133093];
            
            if (sle64((int64_t) 0, write_iv_133095) && slt64(write_iv_133095, m_122552)) {
                ((int64_t *) mem_133331)[write_iv_133095] = write_iv_133096;
            }
        }
        
        int64_t defunc_0_reduce_res_129517;
        int64_t redout_133098 = (int64_t) -9223372036854775808;
        
        for (int64_t i_133099 = 0; i_133099 < m_122552; i_133099++) {
            int64_t x_129518 = ((int64_t *) mem_133331)[i_133099];
            int64_t max_res_129521 = smax64(x_129518, redout_133098);
            int64_t redout_tmp_133559 = max_res_129521;
            
            redout_133098 = redout_tmp_133559;
        }
        defunc_0_reduce_res_129517 = redout_133098;
        max_mult_122576 = defunc_0_reduce_res_129517;
    } else {
        max_mult_122576 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_122582 = slt64(max_mult_122576, (int64_t) 1);
    bool valid_122584 = !bounds_invalid_upwards_122582;
    bool range_valid_c_122585;
    
    if (!valid_122584) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_122576, " is invalid.", "-> #0  ftSMJ.fut:352:16-28\n   #1  ftSMJ.fut:377:7-378:57\n   #2  ftRelational.fut:156:82-85\n   #3  ftRelational.fut:147:1-156:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_133299_cached_sizze_133749 < bytes_133178) {
        err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133749, bytes_133178);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133076 = 0; i_133076 < nR_101966; i_133076++) {
        int64_t eta_p_128922 = ((int64_t *) mem_133255)[i_133076];
        int64_t zv_lhs_128924 = add64((int64_t) -1, i_133076);
        int64_t tmp_128925 = smod64(zv_lhs_128924, nR_101966);
        int64_t lifted_lambda_res_128926 = ((int64_t *) mem_133245)[tmp_128925];
        bool cond_128928 = i_133076 == (int64_t) 0;
        int64_t lifted_lambda_res_128929;
        
        if (cond_128928) {
            lifted_lambda_res_128929 = (int64_t) 0;
        } else {
            lifted_lambda_res_128929 = lifted_lambda_res_128926;
        }
        
        bool cond_128931 = slt64((int64_t) 0, eta_p_128922);
        int64_t lifted_lambda_res_128932;
        
        if (cond_128931) {
            lifted_lambda_res_128932 = lifted_lambda_res_128929;
        } else {
            lifted_lambda_res_128932 = (int64_t) -1;
        }
        ((int64_t *) mem_133299)[i_133076] = lifted_lambda_res_128932;
    }
    if (memblock_alloc(ctx, &mem_133307, bytes_133306, "mem_133307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133561 = 0; nest_i_133561 < defunc_res_129534; nest_i_133561++) {
        ((int16_t *) mem_133307.mem)[nest_i_133561] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_133309, bytes_133308, "mem_133309")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133562 = 0; nest_i_133562 < defunc_res_129534; nest_i_133562++) {
        ((int64_t *) mem_133309.mem)[nest_i_133562] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_133311, bytes_133308, "mem_133311")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133563 = 0; nest_i_133563 < defunc_res_129534; nest_i_133563++) {
        ((int64_t *) mem_133311.mem)[nest_i_133563] = (int64_t) -1;
    }
    for (int64_t write_iter_133078 = 0; write_iter_133078 < nR_101966; write_iter_133078++) {
        int64_t write_iv_133082 = ((int64_t *) mem_133299)[write_iter_133078];
        int16_t write_iv_133083 = ((int16_t *) mem_133247)[write_iter_133078];
        int64_t write_iv_133084 = ((int64_t *) mem_133249)[write_iter_133078];
        int64_t write_iv_133085 = ((int64_t *) mem_133251)[write_iter_133078];
        
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int16_t *) mem_133307.mem)[write_iv_133082] = write_iv_133083;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133309.mem)[write_iv_133082] = write_iv_133084;
        }
        if (sle64((int64_t) 0, write_iv_133082) && slt64(write_iv_133082, defunc_res_129534)) {
            ((int64_t *) mem_133311.mem)[write_iv_133082] = write_iv_133085;
        }
    }
    
    int64_t distance_122583 = sub64(max_mult_122576, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_133348, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133351, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133354, &mem_133311, "mem_133311") != 0)
        return 1;
    for (int64_t i_122589 = 0; i_122589 < distance_122583; i_122589++) {
        int64_t index_primexp_122593 = add64((int64_t) 1, i_122589);
        
        if (memblock_alloc(ctx, &mem_133356, bytes_133308, "mem_133356")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133356.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133354.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133358, bytes_133308, "mem_133358")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        if (memblock_alloc(ctx, &mem_133360, bytes_133306, "mem_133360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_133360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_133348.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
        for (int64_t write_iter_133100 = 0; write_iter_133100 < nR_101966; write_iter_133100++) {
            int64_t write_iv_133105 = ((int64_t *) mem_133251)[write_iter_133100];
            int16_t write_iv_133106 = ((int16_t *) mem_133247)[write_iter_133100];
            int64_t write_iv_133107 = ((int64_t *) mem_133249)[write_iter_133100];
            int64_t zg_lhs_129457 = ((int64_t *) mem_133255)[write_iter_133100];
            bool cond_129458 = slt64(index_primexp_122593, zg_lhs_129457);
            int64_t lifted_lambda_res_129459;
            
            if (cond_129458) {
                int64_t zp_lhs_129527 = ((int64_t *) mem_133299)[write_iter_133100];
                int64_t lifted_lambda_res_t_res_129528 = add64(index_primexp_122593, zp_lhs_129527);
                
                lifted_lambda_res_129459 = lifted_lambda_res_t_res_129528;
            } else {
                lifted_lambda_res_129459 = (int64_t) -1;
            }
            
            int64_t tmp_129463 = add64(index_primexp_122593, write_iv_133105);
            
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int16_t *) mem_133360.mem)[lifted_lambda_res_129459] = write_iv_133106;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133358.mem)[lifted_lambda_res_129459] = write_iv_133107;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_129459) && slt64(lifted_lambda_res_129459, defunc_res_129534)) {
                ((int64_t *) mem_133356.mem)[lifted_lambda_res_129459] = tmp_129463;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_133567, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133568, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133569, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133348, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133351, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133354, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133387, &mem_param_133348, "mem_param_133348") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133386, &mem_param_133351, "mem_param_133351") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133385, &mem_param_133354, "mem_param_133354") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133389, bytes_133306, "mem_133389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_133389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133391, bytes_133308, "mem_133391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133386.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133393, bytes_133308, "mem_133393")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133393.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_129534});
    if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133391, "mem_133391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133393, "mem_133393") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133515, &mem_133389, "mem_133389") != 0)
        return 1;
    prim_out_133516 = defunc_res_129534;
    if (memblock_set(ctx, &*mem_out_p_133738, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133739, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133740, &mem_out_133515, "mem_out_133515") != 0)
        return 1;
    *out_prim_out_133741 = prim_out_133516;
    
  cleanup:
    {
        free(mem_133243);
        free(mem_133245);
        free(mem_133247);
        free(mem_133249);
        free(mem_133251);
        free(mem_133253);
        free(mem_133255);
        free(mem_133299);
        free(mem_133331);
        free(mem_133333);
        if (memblock_unref(ctx, &mem_133393, "mem_133393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133391, "mem_133391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133389, "mem_133389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133569, "mem_param_tmp_133569") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133568, "mem_param_tmp_133568") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133567, "mem_param_tmp_133567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133360, "mem_133360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133358, "mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133356, "mem_133356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133354, "mem_param_133354") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133351, "mem_param_133351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133348, "mem_param_133348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133311, "mem_133311") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133309, "mem_133309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133307, "mem_133307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133235, "mem_133235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133201, "mem_133201") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133199, "mem_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133216, "ext_mem_133216") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133219, "ext_mem_133219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133222, "ext_mem_133222") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133225, "ext_mem_133225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133197, "mem_param_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133230, "ext_mem_133230") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133231, "ext_mem_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133191, "mem_133191") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133189, "mem_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133241, "ext_mem_133241") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133181, "mem_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133177, "ext_mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133515, "mem_out_133515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_133752, struct memblock eta_p_mem_133175, int64_t nz2080U_62786)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_res_128906;
    int64_t redout_133040 = (int64_t) -9223372036854775808;
    
    for (int64_t i_133041 = 0; i_133041 < nz2080U_62786; i_133041++) {
        int64_t x_121034 = ((int64_t *) eta_p_mem_133175.mem)[i_133041];
        int64_t max_res_121037 = smax64(x_121034, redout_133040);
        int64_t redout_tmp_133514 = max_res_121037;
        
        redout_133040 = redout_tmp_133514;
    }
    defunc_0_reduce_res_128906 = redout_133040;
    prim_out_133513 = defunc_0_reduce_res_128906;
    *out_prim_out_133752 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_133753, struct memblock *mem_out_p_133754, struct memblock xs_mem_133175, int64_t n_99501, int64_t incr_99502)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133755 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133756 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133757 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133758 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133759 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133760 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133761 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133762 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133763 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133764 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_99501;
    bool cond_127083 = sle64(n_99501, (int64_t) 1);
    int64_t zs_lhs_127084 = sub64(n_99501, (int64_t) 1);
    int64_t zp_rhs_127085 = sdiv_safe64(zs_lhs_127084, (int64_t) 20);
    int64_t min_num_blocks_127086 = add64((int64_t) 1, zp_rhs_127085);
    bool loop_cond_127087 = slt64((int64_t) 1, min_num_blocks_127086);
    bool smallest_pow_2_geq_than_res_127088;
    int64_t smallest_pow_2_geq_than_res_127089;
    bool loop_while_127090;
    int64_t x_127091;
    
    loop_while_127090 = loop_cond_127087;
    x_127091 = (int64_t) 1;
    while (loop_while_127090) {
        int64_t loopres_127092 = mul64((int64_t) 2, x_127091);
        bool loop_cond_127093 = slt64(loopres_127092, min_num_blocks_127086);
        bool loop_while_tmp_133515 = loop_cond_127093;
        int64_t x_tmp_133516 = loopres_127092;
        
        loop_while_127090 = loop_while_tmp_133515;
        x_127091 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127088 = loop_while_127090;
    smallest_pow_2_geq_than_res_127089 = x_127091;
    
    bool zzero_127094 = smallest_pow_2_geq_than_res_127089 == (int64_t) 0;
    bool nonzzero_127095 = !zzero_127094;
    bool protect_assert_disj_127096 = cond_127083 || nonzzero_127095;
    bool nonzzero_cert_127097;
    
    if (!protect_assert_disj_127096) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127098 = sdiv_safe64(zs_lhs_127084, smallest_pow_2_geq_than_res_127089);
    int64_t block_sizze_127099 = add64((int64_t) 1, zp_rhs_127098);
    bool y_127105 = slt64((int64_t) 0, n_99501);
    bool protect_assert_disj_133419 = cond_127083 || y_127105;
    bool index_certs_127106;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_99501, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127120 = slt64(smallest_pow_2_geq_than_res_127089, (int64_t) 0);
    bool valid_127121 = !bounds_invalid_upwards_127120;
    bool protect_assert_disj_133427 = cond_127083 || valid_127121;
    bool range_valid_c_127122;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127089, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:143:35-39\n   #6  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127124 = slt64(block_sizze_127099, (int64_t) 0);
    bool valid_127125 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_133429 = cond_127083 || valid_127125;
    bool range_valid_c_127126;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127099, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127128 = sle64(block_sizze_127099, (int64_t) 1);
    int64_t tmp_127129 = sub64(block_sizze_127099, (int64_t) 2);
    bool bounds_invalid_upwards_127130 = slt64(tmp_127129, (int64_t) 0);
    bool valid_127132 = !bounds_invalid_upwards_127130;
    bool protect_assert_disj_127133 = cond_127128 || valid_127132;
    bool protect_assert_disj_133431 = cond_127083 || protect_assert_disj_127133;
    bool range_valid_c_127134;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127129, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_11459(ctx, &ext_mem_133176, xs_mem_133175, n_99501, incr_99502) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_99501; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127100 = smallest_pow_2_geq_than_res_127089 * block_sizze_127099;
    bool x_133414 = !cond_127083;
    int64_t greatest_divisor_leq_than_arg1_127103 = mul64((int64_t) 2, block_sizze_127099);
    int64_t merge_block_sizze_127104;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127103) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127104 = x_133416;
    } else {
        merge_block_sizze_127104 = (int64_t) 0;
    }
    
    double reduce_arg1_127107;
    
    if (x_133414) {
        double x_133420 = ((double *) xs_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127107 = x_133420;
    } else {
        reduce_arg1_127107 = 0.0;
    }
    
    double defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        double x_133422;
        int64_t x_133423;
        double redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127107;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_99501; i_133042++) {
            double x_127111 = ((double *) xs_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127117 = redout_133040 <= x_127111;
            double defunc_0_op_res_127118;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127118 = x_127111;
            } else {
                defunc_0_op_res_127118 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127119;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127119 = i_133042;
            } else {
                defunc_0_op_res_127119 = redout_133041;
            }
            
            double redout_tmp_133519 = defunc_0_op_res_127118;
            int64_t redout_tmp_133520 = defunc_0_op_res_127119;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = 0.0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127131 = add64((int64_t) 1, tmp_127129);
    int64_t binop_x_133179 = (int64_t) 8 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133180 = block_sizze_127099 * binop_x_133179;
    int64_t bytes_133193 = (int64_t) 8 * block_sizze_127099;
    bool loop_cond_127206 = slt64(block_sizze_127099, flat_dim_127100);
    bool zzero_127207 = merge_block_sizze_127104 == (int64_t) 0;
    bool nonzzero_127208 = !zzero_127207;
    
    if (cond_127083) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133755 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133755, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133756 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133756, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133757 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133757, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133758 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133758, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127089; i_133054++) {
            int64_t zp_lhs_127138 = mul64(block_sizze_127099, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127099; i_133047++) {
                int64_t k_127142 = add64(zp_lhs_127138, i_133047);
                bool cond_127143 = slt64(k_127142, n_99501);
                double lifted_lambda_res_127144;
                int64_t lifted_lambda_res_127145;
                
                if (cond_127143) {
                    bool x_128906 = sle64((int64_t) 0, k_127142);
                    bool bounds_check_128907 = cond_127143 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127142, "] out of bounds for array of shape [", (long long) n_99501, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_128909 = ((double *) xs_mem_133175.mem)[k_127142];
                    
                    lifted_lambda_res_127144 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127145 = k_127142;
                } else {
                    lifted_lambda_res_127144 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127145 = defunc_0_reduce_res_129054;
                }
                ((double *) mem_133194)[i_133047] = lifted_lambda_res_127144;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127145;
            }
            if (!cond_127128) {
                for (int64_t i_127155 = 0; i_127155 < distance_127131; i_127155++) {
                    int64_t gt_arg1_127158 = add64((int64_t) 1, i_127155);
                    bool x_127159 = sle64((int64_t) 0, gt_arg1_127158);
                    bool y_127160 = slt64(gt_arg1_127158, block_sizze_127099);
                    bool bounds_check_127161 = x_127159 && y_127160;
                    bool index_certs_127162;
                    
                    if (!bounds_check_127161) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127158, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127164 = slt64(i_127155, block_sizze_127099);
                    bool index_certs_127165;
                    
                    if (!y_127164) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127155, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_127163 = ((double *) mem_133194)[gt_arg1_127158];
                    double gt_arg0_127166 = ((double *) mem_133194)[i_127155];
                    bool defunc_0_leq_res_127167 = gt_arg0_127166 <= gt_arg1_127163;
                    bool defunc_0_lifted_gt_res_127168 = !defunc_0_leq_res_127167;
                    bool s_127169;
                    int64_t s_127172;
                    bool loop_while_127173;
                    int64_t j_127176;
                    
                    loop_while_127173 = defunc_0_lifted_gt_res_127168;
                    j_127176 = i_127155;
                    while (loop_while_127173) {
                        bool x_127177 = sle64((int64_t) 0, j_127176);
                        bool y_127178 = slt64(j_127176, block_sizze_127099);
                        bool bounds_check_127179 = x_127177 && y_127178;
                        bool index_certs_127180;
                        
                        if (!bounds_check_127179) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127176, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127183 = add64((int64_t) 1, j_127176);
                        bool x_127184 = sle64((int64_t) 0, copy_arg0_127183);
                        bool y_127185 = slt64(copy_arg0_127183, block_sizze_127099);
                        bool bounds_check_127186 = x_127184 && y_127185;
                        bool index_certs_127187;
                        
                        if (!bounds_check_127186) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127183, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_127181 = ((double *) mem_133194)[j_127176];
                        int64_t copy_arg0_127182 = ((int64_t *) mem_133196)[j_127176];
                        double copy_arg0_127188 = ((double *) mem_133194)[copy_arg0_127183];
                        int64_t copy_arg0_127189 = ((int64_t *) mem_133196)[copy_arg0_127183];
                        
                        ((double *) mem_133194)[j_127176] = copy_arg0_127188;
                        ((int64_t *) mem_133196)[j_127176] = copy_arg0_127189;
                        ((double *) mem_133194)[copy_arg0_127183] = copy_arg0_127181;
                        ((int64_t *) mem_133196)[copy_arg0_127183] = copy_arg0_127182;
                        
                        int64_t tmp_127194 = sub64(j_127176, (int64_t) 1);
                        bool cond_127195 = sle64((int64_t) 0, tmp_127194);
                        bool loop_cond_127196;
                        
                        if (cond_127195) {
                            bool y_128911 = slt64(tmp_127194, block_sizze_127099);
                            bool bounds_check_128912 = cond_127195 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127194, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_128910 = ((double *) mem_133194)[j_127176];
                            double gt_arg0_128914 = ((double *) mem_133194)[tmp_127194];
                            bool defunc_0_leq_res_128915 = gt_arg0_128914 <= gt_arg1_128910;
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127196 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127196 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127196;
                        int64_t j_tmp_133530 = tmp_127194;
                        
                        loop_while_127173 = loop_while_tmp_133527;
                        j_127176 = j_tmp_133530;
                    }
                    s_127169 = loop_while_127173;
                    s_127172 = j_127176;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133181, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        if (memblock_alloc(ctx, &mem_133253, bytes_133180, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        
        int64_t data_127209;
        bool data_127210;
        int64_t data_127213;
        int64_t loop_dz2084Uz2082U_127214;
        bool loop_while_127215;
        int64_t stride_127218;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127214 = flat_dim_127100;
        loop_while_127215 = loop_cond_127206;
        stride_127218 = block_sizze_127099;
        while (loop_while_127215) {
            int64_t next_stride_127219 = mul64((int64_t) 2, stride_127218);
            bool zzero_127220 = next_stride_127219 == (int64_t) 0;
            bool nonzzero_127221 = !zzero_127220;
            bool nonzzero_cert_127222;
            
            if (!nonzzero_127221) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127223 = sdiv64(flat_dim_127100, next_stride_127219);
            bool bounds_invalid_upwards_127224 = slt64(num_merges_127223, (int64_t) 0);
            bool valid_127225 = !bounds_invalid_upwards_127224;
            bool range_valid_c_127226;
            
            if (!valid_127225) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127223, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:143:35-39\n   #6  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127228 = sub64(next_stride_127219, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127229 = sle64((int64_t) 0, m_127228);
            bool cond_127231 = slt64(next_stride_127219, (int64_t) 10);
            bool protect_assert_disj_127232 = nonzzero_127208 || cond_127231;
            bool nonzzero_cert_127233;
            
            if (!protect_assert_disj_127232) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127234 = smod_safe64(next_stride_127219, merge_block_sizze_127104);
            bool num_blocks_127235 = zeze_lhs_127234 == (int64_t) 0;
            bool protect_assert_disj_127236 = cond_127231 || num_blocks_127235;
            bool assert_c_127237;
            
            if (!protect_assert_disj_127236) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127239 = sdiv_safe64(next_stride_127219, merge_block_sizze_127104);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240 = add64((int64_t) 1, num_blocks_127239);
            int64_t j_m_i_127241 = sub64(next_stride_127219, stride_127218);
            int64_t flat_dim_127242 = merge_block_sizze_127104 * num_blocks_127239;
            bool bounds_invalid_upwards_127243 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, (int64_t) 0);
            bool empty_slice_127244 = j_m_i_127241 == (int64_t) 0;
            int64_t m_127245 = sub64(j_m_i_127241, (int64_t) 1);
            bool zzero_lte_i_127246 = sle64((int64_t) 0, stride_127218);
            bool i_lte_j_127247 = sle64(stride_127218, next_stride_127219);
            bool empty_slice_127248 = stride_127218 == (int64_t) 0;
            int64_t m_127249 = sub64(stride_127218, (int64_t) 1);
            bool bounds_invalid_upwards_127250 = slt64(num_blocks_127239, (int64_t) 0);
            bool cond_127251 = slt64((int64_t) 0, stride_127218);
            bool valid_127252 = !bounds_invalid_upwards_127243;
            int64_t i_p_m_t_s_127253 = add64(stride_127218, m_127245);
            bool zzero_leq_i_p_m_t_s_127254 = sle64((int64_t) 0, m_127249);
            bool i_p_m_t_s_leq_w_127255 = slt64(m_127249, next_stride_127219);
            bool valid_127256 = !bounds_invalid_upwards_127250;
            bool i_p_m_t_s_leq_w_127257 = slt64(m_127228, flat_dim_127242);
            bool y_127258 = slt64((int64_t) 0, j_m_i_127241);
            bool protect_assert_disj_127259 = cond_127231 || valid_127252;
            bool range_valid_c_127260;
            
            if (!protect_assert_disj_127259) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127261 = sle64((int64_t) 0, i_p_m_t_s_127253);
            bool i_p_m_t_s_leq_w_127262 = slt64(i_p_m_t_s_127253, next_stride_127219);
            bool y_127263 = zzero_leq_i_p_m_t_s_127254 && i_p_m_t_s_leq_w_127255;
            bool protect_assert_disj_127264 = cond_127231 || valid_127256;
            bool range_valid_c_127265;
            
            if (!protect_assert_disj_127264) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127266 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127257;
            bool y_127267 = zzero_lte_i_127246 && i_p_m_t_s_leq_w_127262;
            bool forwards_ok_127268 = zzero_lte_i_127246 && y_127263;
            bool ok_or_empty_127269 = zzero_127220 || y_127266;
            bool protect_assert_disj_127270 = cond_127251 || y_127258;
            bool y_127271 = zzero_leq_i_p_m_t_s_127261 && y_127267;
            bool ok_or_empty_127272 = empty_slice_127248 || forwards_ok_127268;
            bool protect_assert_disj_127273 = cond_127231 || ok_or_empty_127269;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) flat_dim_127242, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127275 = !cond_127231;
            bool protect_assert_disj_127276 = protect_assert_disj_127270 || loop_not_taken_127275;
            bool index_certs_127277;
            
            if (!protect_assert_disj_127276) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127278 = i_lte_j_127247 && y_127271;
            bool protect_assert_disj_127279 = cond_127231 || ok_or_empty_127272;
            bool index_certs_127280;
            
            if (!protect_assert_disj_127279) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127281 = ok_or_empty_127272 || loop_not_taken_127275;
            bool index_certs_127282;
            
            if (!protect_assert_disj_127281) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127283 = empty_slice_127244 || forwards_ok_127278;
            bool protect_assert_disj_127284 = cond_127231 || ok_or_empty_127283;
            bool index_certs_127285;
            
            if (!protect_assert_disj_127284) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127286 = loop_not_taken_127275 || ok_or_empty_127283;
            bool index_certs_127287;
            
            if (!protect_assert_disj_127286) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 8 * num_merges_127223;
            int64_t bytes_133262 = next_stride_127219 * binop_x_133261;
            bool i_lte_j_127230 = sle64((int64_t) 0, next_stride_127219);
            
            if (mem_133263_cached_sizze_133759 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133759, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133760 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133760, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240;
            int64_t binop_x_133291 = (int64_t) 8 * num_blocks_127239;
            int64_t bytes_133292 = merge_block_sizze_127104 * binop_x_133291;
            int64_t bytes_133337 = (int64_t) 16 * stride_127218;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127223; i_133075++) {
                int64_t start_127291 = mul64(next_stride_127219, i_133075);
                int64_t j_m_i_127292 = sub64(loop_dz2084Uz2082U_127214, start_127291);
                bool empty_slice_127293 = j_m_i_127292 == (int64_t) 0;
                int64_t m_127294 = sub64(j_m_i_127292, (int64_t) 1);
                int64_t i_p_m_t_s_127295 = add64(start_127291, m_127294);
                bool zzero_leq_i_p_m_t_s_127296 = sle64((int64_t) 0, i_p_m_t_s_127295);
                bool i_p_m_t_s_leq_w_127297 = slt64(i_p_m_t_s_127295, loop_dz2084Uz2082U_127214);
                bool zzero_lte_i_127298 = sle64((int64_t) 0, start_127291);
                bool i_lte_j_127299 = sle64(start_127291, loop_dz2084Uz2082U_127214);
                bool y_127300 = i_p_m_t_s_leq_w_127297 && zzero_lte_i_127298;
                bool y_127301 = zzero_leq_i_p_m_t_s_127296 && y_127300;
                bool forwards_ok_127302 = i_lte_j_127299 && y_127301;
                bool ok_or_empty_127303 = empty_slice_127293 || forwards_ok_127302;
                bool index_certs_127304;
                
                if (!ok_or_empty_127303) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127291, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127214, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127305 = slt64(m_127228, j_m_i_127292);
                bool y_127306 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127305;
                bool forwards_ok_127307 = i_lte_j_127230 && y_127306;
                bool ok_or_empty_127308 = zzero_127220 || forwards_ok_127307;
                bool index_certs_127309;
                
                if (!ok_or_empty_127308) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) j_m_i_127292, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127231) {
                    double dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127251) {
                        double head_res_128944 = ((double *) mem_param_133257.mem)[start_127291];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127291];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127218 + start_127291;
                        double head_res_128947 = ((double *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127219; nest_i_133540++) {
                        ((double *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133337, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127219; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127219; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127241;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127218);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127241);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127218 + j_128958;
                                int64_t slice_128968 = start_127291 + slice_128967;
                                double leq_arg1_128969 = ((double *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127291 + i_128955;
                                double leq_arg0_128974 = ((double *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = leq_arg0_128974 <= leq_arg1_128969;
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        double loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127218);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127291 + i_128955;
                            double tmp_128985 = ((double *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127241);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127218 + j_128958;
                            int64_t slice_128992 = start_127291 + slice_128991;
                            double tmp_128993 = ((double *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((double *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133761 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133761, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133762 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133762, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240; i_133061++) {
                        int64_t split_count_arg3_127371 = mul64(merge_block_sizze_127104, i_133061);
                        int64_t defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127372, &defunc_0_split_count_res_127373, &defunc_0_split_count_res_127374, &defunc_0_split_count_res_127375, &defunc_0_split_count_res_127376, (int64_t) 0, stride_127218, (int64_t) 0, j_m_i_127241, split_count_arg3_127371) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127377 = slt64((int64_t) 0, defunc_0_split_count_res_127376);
                        bool defunc_0_split_count_res_127378;
                        int64_t defunc_0_split_count_res_127379;
                        int64_t defunc_0_split_count_res_127380;
                        int64_t defunc_0_split_count_res_127381;
                        int64_t defunc_0_split_count_res_127382;
                        int64_t defunc_0_split_count_res_127383;
                        bool loop_while_127384;
                        int64_t ss_127385;
                        int64_t ss_127386;
                        int64_t tt_127387;
                        int64_t tt_127388;
                        int64_t count_127389;
                        
                        loop_while_127384 = loop_cond_127377;
                        ss_127385 = defunc_0_split_count_res_127372;
                        ss_127386 = defunc_0_split_count_res_127373;
                        tt_127387 = defunc_0_split_count_res_127374;
                        tt_127388 = defunc_0_split_count_res_127375;
                        count_127389 = defunc_0_split_count_res_127376;
                        while (loop_while_127384) {
                            int64_t zlze_lhs_127390 = sub64(ss_127386, ss_127385);
                            bool cond_127391 = sle64(zlze_lhs_127390, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127392;
                            int64_t defunc_0_lifted_step_res_127393;
                            int64_t defunc_0_lifted_step_res_127394;
                            int64_t defunc_0_lifted_step_res_127395;
                            
                            if (cond_127391) {
                                int64_t tmp_128997 = add64(tt_127387, count_127389);
                                
                                defunc_0_lifted_step_res_127392 = ss_127385;
                                defunc_0_lifted_step_res_127393 = tmp_128997;
                                defunc_0_lifted_step_res_127394 = tt_127388;
                                defunc_0_lifted_step_res_127395 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127397 = sub64(tt_127388, tt_127387);
                                bool cond_127398 = sle64(zlze_lhs_127397, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127399;
                                int64_t defunc_0_lifted_step_res_f_res_127400;
                                int64_t defunc_0_lifted_step_res_f_res_127401;
                                int64_t defunc_0_lifted_step_res_f_res_127402;
                                
                                if (cond_127398) {
                                    int64_t tmp_128998 = add64(ss_127385, count_127389);
                                    
                                    defunc_0_lifted_step_res_f_res_127399 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127400 = tt_127387;
                                    defunc_0_lifted_step_res_f_res_127401 = tt_127388;
                                    defunc_0_lifted_step_res_f_res_127402 = (int64_t) 0;
                                } else {
                                    bool cond_127404 = count_127389 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127405;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127406;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127407;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127408;
                                    
                                    if (cond_127404) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127385);
                                        bool y_129001 = slt64(ss_127385, stride_127218);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127385, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127387);
                                        bool y_129007 = slt64(tt_127387, j_m_i_127241);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127387, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127291 + ss_127385;
                                        double leq_arg1_129005 = ((double *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127218 + tt_127387;
                                        int64_t slice_129011 = start_127291 + slice_129010;
                                        double leq_arg0_129012 = ((double *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = leq_arg0_129012 <= leq_arg1_129005;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127387);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127385;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127385);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127387;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = tt_127388;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = (int64_t) 0;
                                    } else {
                                        int64_t m_127427 = sdiv64(count_127389, (int64_t) 2);
                                        int64_t n_127428 = sub64(count_127389, m_127427);
                                        bool cond_127429 = n_127428 == (int64_t) 0;
                                        int64_t zgze_lhs_127430 = add64(ss_127385, m_127427);
                                        bool cond_f_res_127431 = sle64(ss_127386, zgze_lhs_127430);
                                        bool x_127432 = !cond_127429;
                                        bool y_127433 = cond_f_res_127431 && x_127432;
                                        bool cond_127434 = cond_127429 || y_127433;
                                        bool leq_y_x_127435;
                                        
                                        if (cond_127434) {
                                            leq_y_x_127435 = 1;
                                        } else {
                                            bool x_127436 = sle64((int64_t) 0, zgze_lhs_127430);
                                            bool y_127437 = slt64(zgze_lhs_127430, stride_127218);
                                            bool bounds_check_127438 = x_127436 && y_127437;
                                            bool index_certs_127439;
                                            
                                            if (!bounds_check_127438) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127430, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127442 = add64(tt_127387, n_127428);
                                            int64_t leq_arg0_127443 = sub64(zm_lhs_127442, (int64_t) 1);
                                            bool x_127444 = sle64((int64_t) 0, leq_arg0_127443);
                                            bool y_127445 = slt64(leq_arg0_127443, j_m_i_127241);
                                            bool bounds_check_127446 = x_127444 && y_127445;
                                            bool index_certs_127447;
                                            
                                            if (!bounds_check_127446) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127443, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127440 = start_127291 + zgze_lhs_127430;
                                            double leq_arg1_127441 = ((double *) mem_param_133257.mem)[slice_127440];
                                            int64_t slice_127448 = stride_127218 + leq_arg0_127443;
                                            int64_t slice_127449 = start_127291 + slice_127448;
                                            double leq_arg0_127450 = ((double *) mem_param_133257.mem)[slice_127449];
                                            bool defunc_0_leq_res_127451 = leq_arg0_127450 <= leq_arg1_127441;
                                            
                                            leq_y_x_127435 = defunc_0_leq_res_127451;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                        
                                        if (leq_y_x_127435) {
                                            int64_t tmp_129018 = add64(tt_127387, n_127428);
                                            int64_t tmp_129019 = sub64(count_127389, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tt_127388;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = tmp_129019;
                                        } else {
                                            int64_t tmp_127457 = add64(tt_127387, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tt_127387;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tmp_127457;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = count_127389;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = ss_127385;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                    }
                                    defunc_0_lifted_step_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_127405;
                                    defunc_0_lifted_step_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_127406;
                                    defunc_0_lifted_step_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_127407;
                                    defunc_0_lifted_step_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_127408;
                                }
                                defunc_0_lifted_step_res_127392 = defunc_0_lifted_step_res_f_res_127399;
                                defunc_0_lifted_step_res_127393 = defunc_0_lifted_step_res_f_res_127400;
                                defunc_0_lifted_step_res_127394 = defunc_0_lifted_step_res_f_res_127401;
                                defunc_0_lifted_step_res_127395 = defunc_0_lifted_step_res_f_res_127402;
                            }
                            
                            int64_t loopres_127458;
                            int64_t loopres_127459;
                            int64_t loopres_127460;
                            int64_t loopres_127461;
                            int64_t loopres_127462;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127458, &loopres_127459, &loopres_127460, &loopres_127461, &loopres_127462, defunc_0_lifted_step_res_127392, ss_127386, defunc_0_lifted_step_res_127393, defunc_0_lifted_step_res_127394, defunc_0_lifted_step_res_127395) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127463 = slt64((int64_t) 0, loopres_127462);
                            bool loop_while_tmp_133547 = loop_cond_127463;
                            int64_t ss_tmp_133548 = loopres_127458;
                            int64_t ss_tmp_133549 = loopres_127459;
                            int64_t tt_tmp_133550 = loopres_127460;
                            int64_t tt_tmp_133551 = loopres_127461;
                            int64_t count_tmp_133552 = loopres_127462;
                            
                            loop_while_127384 = loop_while_tmp_133547;
                            ss_127385 = ss_tmp_133548;
                            ss_127386 = ss_tmp_133549;
                            tt_127387 = tt_tmp_133550;
                            tt_127388 = tt_tmp_133551;
                            count_127389 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127378 = loop_while_127384;
                        defunc_0_split_count_res_127379 = ss_127385;
                        defunc_0_split_count_res_127380 = ss_127386;
                        defunc_0_split_count_res_127381 = tt_127387;
                        defunc_0_split_count_res_127382 = tt_127388;
                        defunc_0_split_count_res_127383 = count_127389;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127379;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127381;
                    }
                    if (mem_133293_cached_sizze_133763 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133763, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133764 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133764, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127239; i_133068++) {
                        bool y_127469 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool index_certs_127471;
                        
                        if (!y_127469) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127472 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127474 = add64((int64_t) 1, i_133068);
                        bool x_127475 = sle64((int64_t) 0, tmp_127474);
                        bool y_127476 = slt64(tmp_127474, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool bounds_check_127477 = x_127475 && y_127476;
                        bool index_certs_127478;
                        
                        if (!bounds_check_127477) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127474, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127479 = ((int64_t *) mem_133276)[tmp_127474];
                        int64_t defunc_0_f_res_127480 = ((int64_t *) mem_133278)[tmp_127474];
                        int64_t merge_sequential_arg2_127481 = add64(stride_127218, defunc_0_f_res_127473);
                        int64_t merge_sequential_arg2_127482 = add64(stride_127218, defunc_0_f_res_127480);
                        int64_t j_m_i_127483 = sub64(merge_sequential_arg2_127482, merge_sequential_arg2_127481);
                        bool empty_slice_127484 = j_m_i_127483 == (int64_t) 0;
                        int64_t m_127485 = sub64(j_m_i_127483, (int64_t) 1);
                        int64_t i_p_m_t_s_127486 = add64(merge_sequential_arg2_127481, m_127485);
                        bool zzero_leq_i_p_m_t_s_127487 = sle64((int64_t) 0, i_p_m_t_s_127486);
                        bool i_p_m_t_s_leq_w_127488 = slt64(i_p_m_t_s_127486, next_stride_127219);
                        bool zzero_lte_i_127489 = sle64((int64_t) 0, merge_sequential_arg2_127481);
                        bool i_lte_j_127490 = sle64(merge_sequential_arg2_127481, merge_sequential_arg2_127482);
                        bool y_127491 = i_p_m_t_s_leq_w_127488 && zzero_lte_i_127489;
                        bool y_127492 = zzero_leq_i_p_m_t_s_127487 && y_127491;
                        bool forwards_ok_127493 = i_lte_j_127490 && y_127492;
                        bool ok_or_empty_127494 = empty_slice_127484 || forwards_ok_127493;
                        bool index_certs_127495;
                        
                        if (!ok_or_empty_127494) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127481, ":", (long long) merge_sequential_arg2_127482, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127496 = sub64(defunc_0_f_res_127479, defunc_0_f_res_127472);
                        bool empty_slice_127497 = j_m_i_127496 == (int64_t) 0;
                        int64_t m_127498 = sub64(j_m_i_127496, (int64_t) 1);
                        int64_t i_p_m_t_s_127499 = add64(defunc_0_f_res_127472, m_127498);
                        bool zzero_leq_i_p_m_t_s_127500 = sle64((int64_t) 0, i_p_m_t_s_127499);
                        bool i_p_m_t_s_leq_w_127501 = slt64(i_p_m_t_s_127499, next_stride_127219);
                        bool zzero_lte_i_127502 = sle64((int64_t) 0, defunc_0_f_res_127472);
                        bool i_lte_j_127503 = sle64(defunc_0_f_res_127472, defunc_0_f_res_127479);
                        bool y_127504 = i_p_m_t_s_leq_w_127501 && zzero_lte_i_127502;
                        bool y_127505 = zzero_leq_i_p_m_t_s_127500 && y_127504;
                        bool forwards_ok_127506 = i_lte_j_127503 && y_127505;
                        bool ok_or_empty_127507 = empty_slice_127497 || forwards_ok_127506;
                        bool index_certs_127508;
                        
                        if (!ok_or_empty_127507) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127472, ":", (long long) defunc_0_f_res_127479, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127509 = slt64((int64_t) 0, j_m_i_127496);
                        double dummy_127510;
                        int64_t dummy_127511;
                        
                        if (cond_127509) {
                            bool index_certs_129020;
                            
                            if (!cond_127509) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:143:35-39\n   #12 ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127291 + defunc_0_f_res_127472;
                            double head_res_129022 = ((double *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127510 = head_res_129022;
                            dummy_127511 = head_res_129023;
                        } else {
                            bool y_127516 = slt64((int64_t) 0, j_m_i_127483);
                            bool index_certs_127517;
                            
                            if (!y_127516) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:143:35-39\n   #12 ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127518 = start_127291 + merge_sequential_arg2_127481;
                            double head_res_127519 = ((double *) mem_param_133257.mem)[slice_127518];
                            int64_t head_res_127520 = ((int64_t *) mem_param_133260.mem)[slice_127518];
                            
                            dummy_127510 = head_res_127519;
                            dummy_127511 = head_res_127520;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127104; nest_i_133555++) {
                            ((double *) mem_133293)[i_133068 * merge_block_sizze_127104 + nest_i_133555] = dummy_127510;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127104; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + nest_i_133556] = dummy_127511;
                        }
                        
                        int64_t data_127523;
                        int64_t i_127527 = (int64_t) 0;
                        
                        for (int64_t k_127526 = 0; k_127526 < merge_block_sizze_127104; k_127526++) {
                            int64_t j_127530 = sub64(k_127526, i_127527);
                            bool cond_127531 = j_127530 == j_m_i_127483;
                            bool cond_127532;
                            
                            if (cond_127531) {
                                cond_127532 = 1;
                            } else {
                                bool cond_127533 = slt64(i_127527, j_m_i_127496);
                                bool cond_f_res_127534;
                                
                                if (cond_127533) {
                                    bool x_129024 = sle64((int64_t) 0, j_127530);
                                    bool y_129025 = slt64(j_127530, j_m_i_127483);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127527);
                                    bool bounds_check_129032 = cond_127533 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127481 + j_127530;
                                    int64_t slice_129029 = start_127291 + slice_129028;
                                    double leq_arg1_129030 = ((double *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127472 + i_127527;
                                    int64_t slice_129035 = start_127291 + slice_129034;
                                    double leq_arg0_129036 = ((double *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = leq_arg0_129036 <= leq_arg1_129030;
                                    
                                    cond_f_res_127534 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127534 = 0;
                                }
                                cond_127532 = cond_f_res_127534;
                            }
                            
                            int64_t loopres_127549;
                            double loopres_127550;
                            int64_t loopres_127551;
                            
                            if (cond_127532) {
                                bool x_129039 = sle64((int64_t) 0, i_127527);
                                bool y_129040 = slt64(i_127527, j_m_i_127496);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127527);
                                int64_t slice_129043 = defunc_0_f_res_127472 + i_127527;
                                int64_t slice_129044 = start_127291 + slice_129043;
                                double tmp_129045 = ((double *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127549 = tmp_129038;
                                loopres_127550 = tmp_129045;
                                loopres_127551 = tmp_129046;
                            } else {
                                bool x_127561 = sle64((int64_t) 0, j_127530);
                                bool y_127562 = slt64(j_127530, j_m_i_127483);
                                bool bounds_check_127563 = x_127561 && y_127562;
                                bool index_certs_127564;
                                
                                if (!bounds_check_127563) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127565 = merge_sequential_arg2_127481 + j_127530;
                                int64_t slice_127566 = start_127291 + slice_127565;
                                double tmp_127567 = ((double *) mem_param_133257.mem)[slice_127566];
                                int64_t tmp_127568 = ((int64_t *) mem_param_133260.mem)[slice_127566];
                                
                                loopres_127549 = i_127527;
                                loopres_127550 = tmp_127567;
                                loopres_127551 = tmp_127568;
                            }
                            ((double *) mem_133293)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127550;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127551;
                            
                            int64_t i_tmp_133557 = loopres_127549;
                            
                            i_127527 = i_tmp_133557;
                        }
                        data_127523 = i_127527;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133292, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133263, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127575 = next_stride_127219 * num_merges_127223;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            if (memblock_alloc(ctx, &mem_133373, bytes_133262, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            
            bool loop_cond_127578 = slt64(next_stride_127219, flat_dim_127100);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127575;
            bool loop_while_tmp_133534 = loop_cond_127578;
            int64_t stride_tmp_133537 = next_stride_127219;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127214 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127215 = loop_while_tmp_133534;
            stride_127218 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127209 = loop_dz2084Uz2082U_127214;
        data_127210 = loop_while_127215;
        data_127213 = stride_127218;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127579 = n_99501 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127580 = sle64((int64_t) 0, zs_lhs_127084);
        bool i_p_m_t_s_leq_w_127581 = slt64(zs_lhs_127084, data_127209);
        bool y_127582 = zzero_leq_i_p_m_t_s_127580 && i_p_m_t_s_leq_w_127581;
        bool ok_or_empty_127583 = empty_slice_127579 || y_127582;
        bool index_certs_127584;
        
        if (!ok_or_empty_127583) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_99501, "] out of bounds for array of shape [", (long long) data_127209, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:143:35-39\n   #6  ftRelational.fut:142:9-143:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133177, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_99501; i_133082++) {
        int64_t eta_p_127592 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127593 = sle64((int64_t) 0, eta_p_127592);
        bool y_127594 = slt64(eta_p_127592, n_99501);
        bool bounds_check_127595 = x_127593 && y_127594;
        bool index_certs_127596;
        
        if (!bounds_check_127595) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127592, "] out of bounds for array of shape [", (long long) n_99501, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_127597 = ((int64_t *) ext_mem_133176.mem)[eta_p_127592];
        double lifted_lambda_res_127598 = ((double *) xs_mem_133175.mem)[eta_p_127592];
        
        ((int64_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127597;
        ((double *) mem_133387.mem)[i_133082] = lifted_lambda_res_127598;
    }
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133753, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133754, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_133765, struct memblock *mem_out_p_133766, struct memblock xs_mem_133175, int64_t n_97356, int64_t incr_97357)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133767 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133768 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133769 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133770 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133771 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133772 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133773 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133774 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133775 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133776 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_97356;
    bool cond_127083 = sle64(n_97356, (int64_t) 1);
    int64_t zs_lhs_127084 = sub64(n_97356, (int64_t) 1);
    int64_t zp_rhs_127085 = sdiv_safe64(zs_lhs_127084, (int64_t) 20);
    int64_t min_num_blocks_127086 = add64((int64_t) 1, zp_rhs_127085);
    bool loop_cond_127087 = slt64((int64_t) 1, min_num_blocks_127086);
    bool smallest_pow_2_geq_than_res_127088;
    int64_t smallest_pow_2_geq_than_res_127089;
    bool loop_while_127090;
    int64_t x_127091;
    
    loop_while_127090 = loop_cond_127087;
    x_127091 = (int64_t) 1;
    while (loop_while_127090) {
        int64_t loopres_127092 = mul64((int64_t) 2, x_127091);
        bool loop_cond_127093 = slt64(loopres_127092, min_num_blocks_127086);
        bool loop_while_tmp_133515 = loop_cond_127093;
        int64_t x_tmp_133516 = loopres_127092;
        
        loop_while_127090 = loop_while_tmp_133515;
        x_127091 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127088 = loop_while_127090;
    smallest_pow_2_geq_than_res_127089 = x_127091;
    
    bool zzero_127094 = smallest_pow_2_geq_than_res_127089 == (int64_t) 0;
    bool nonzzero_127095 = !zzero_127094;
    bool protect_assert_disj_127096 = cond_127083 || nonzzero_127095;
    bool nonzzero_cert_127097;
    
    if (!protect_assert_disj_127096) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127098 = sdiv_safe64(zs_lhs_127084, smallest_pow_2_geq_than_res_127089);
    int64_t block_sizze_127099 = add64((int64_t) 1, zp_rhs_127098);
    bool y_127105 = slt64((int64_t) 0, n_97356);
    bool protect_assert_disj_133419 = cond_127083 || y_127105;
    bool index_certs_127106;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_97356, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127120 = slt64(smallest_pow_2_geq_than_res_127089, (int64_t) 0);
    bool valid_127121 = !bounds_invalid_upwards_127120;
    bool protect_assert_disj_133427 = cond_127083 || valid_127121;
    bool range_valid_c_127122;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127089, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:141:35-39\n   #6  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127124 = slt64(block_sizze_127099, (int64_t) 0);
    bool valid_127125 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_133429 = cond_127083 || valid_127125;
    bool range_valid_c_127126;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127099, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127128 = sle64(block_sizze_127099, (int64_t) 1);
    int64_t tmp_127129 = sub64(block_sizze_127099, (int64_t) 2);
    bool bounds_invalid_upwards_127130 = slt64(tmp_127129, (int64_t) 0);
    bool valid_127132 = !bounds_invalid_upwards_127130;
    bool protect_assert_disj_127133 = cond_127128 || valid_127132;
    bool protect_assert_disj_133431 = cond_127083 || protect_assert_disj_127133;
    bool range_valid_c_127134;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127129, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133386 = (int64_t) 4 * n_97356;
    
    if (futrts_indicesWithIncrement_11438(ctx, &ext_mem_133176, xs_mem_133175, n_97356, incr_97357) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_97356; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127100 = smallest_pow_2_geq_than_res_127089 * block_sizze_127099;
    bool x_133414 = !cond_127083;
    int64_t greatest_divisor_leq_than_arg1_127103 = mul64((int64_t) 2, block_sizze_127099);
    int64_t merge_block_sizze_127104;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127103) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127104 = x_133416;
    } else {
        merge_block_sizze_127104 = (int64_t) 0;
    }
    
    float reduce_arg1_127107;
    
    if (x_133414) {
        float x_133420 = ((float *) xs_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127107 = x_133420;
    } else {
        reduce_arg1_127107 = 0.0F;
    }
    
    float defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        float x_133422;
        int64_t x_133423;
        float redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127107;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_97356; i_133042++) {
            float x_127111 = ((float *) xs_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127117 = redout_133040 <= x_127111;
            float defunc_0_op_res_127118;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127118 = x_127111;
            } else {
                defunc_0_op_res_127118 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127119;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127119 = i_133042;
            } else {
                defunc_0_op_res_127119 = redout_133041;
            }
            
            float redout_tmp_133519 = defunc_0_op_res_127118;
            int64_t redout_tmp_133520 = defunc_0_op_res_127119;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = 0.0F;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127131 = add64((int64_t) 1, tmp_127129);
    int64_t binop_x_133179 = (int64_t) 4 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133180 = block_sizze_127099 * binop_x_133179;
    int64_t binop_x_133182 = (int64_t) 8 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133183 = block_sizze_127099 * binop_x_133182;
    int64_t bytes_133193 = (int64_t) 4 * block_sizze_127099;
    int64_t bytes_133195 = (int64_t) 8 * block_sizze_127099;
    bool loop_cond_127206 = slt64(block_sizze_127099, flat_dim_127100);
    bool zzero_127207 = merge_block_sizze_127104 == (int64_t) 0;
    bool nonzzero_127208 = !zzero_127207;
    
    if (cond_127083) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133767 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133767, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133768 < bytes_133183) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133768, bytes_133183);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133769 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133769, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133770 < bytes_133195) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133770, bytes_133195);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127089; i_133054++) {
            int64_t zp_lhs_127138 = mul64(block_sizze_127099, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127099; i_133047++) {
                int64_t k_127142 = add64(zp_lhs_127138, i_133047);
                bool cond_127143 = slt64(k_127142, n_97356);
                float lifted_lambda_res_127144;
                int64_t lifted_lambda_res_127145;
                
                if (cond_127143) {
                    bool x_128906 = sle64((int64_t) 0, k_127142);
                    bool bounds_check_128907 = cond_127143 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127142, "] out of bounds for array of shape [", (long long) n_97356, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_128909 = ((float *) xs_mem_133175.mem)[k_127142];
                    
                    lifted_lambda_res_127144 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127145 = k_127142;
                } else {
                    lifted_lambda_res_127144 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127145 = defunc_0_reduce_res_129054;
                }
                ((float *) mem_133194)[i_133047] = lifted_lambda_res_127144;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127145;
            }
            if (!cond_127128) {
                for (int64_t i_127155 = 0; i_127155 < distance_127131; i_127155++) {
                    int64_t gt_arg1_127158 = add64((int64_t) 1, i_127155);
                    bool x_127159 = sle64((int64_t) 0, gt_arg1_127158);
                    bool y_127160 = slt64(gt_arg1_127158, block_sizze_127099);
                    bool bounds_check_127161 = x_127159 && y_127160;
                    bool index_certs_127162;
                    
                    if (!bounds_check_127161) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127158, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127164 = slt64(i_127155, block_sizze_127099);
                    bool index_certs_127165;
                    
                    if (!y_127164) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127155, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_127163 = ((float *) mem_133194)[gt_arg1_127158];
                    float gt_arg0_127166 = ((float *) mem_133194)[i_127155];
                    bool defunc_0_leq_res_127167 = gt_arg0_127166 <= gt_arg1_127163;
                    bool defunc_0_lifted_gt_res_127168 = !defunc_0_leq_res_127167;
                    bool s_127169;
                    int64_t s_127172;
                    bool loop_while_127173;
                    int64_t j_127176;
                    
                    loop_while_127173 = defunc_0_lifted_gt_res_127168;
                    j_127176 = i_127155;
                    while (loop_while_127173) {
                        bool x_127177 = sle64((int64_t) 0, j_127176);
                        bool y_127178 = slt64(j_127176, block_sizze_127099);
                        bool bounds_check_127179 = x_127177 && y_127178;
                        bool index_certs_127180;
                        
                        if (!bounds_check_127179) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127176, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127183 = add64((int64_t) 1, j_127176);
                        bool x_127184 = sle64((int64_t) 0, copy_arg0_127183);
                        bool y_127185 = slt64(copy_arg0_127183, block_sizze_127099);
                        bool bounds_check_127186 = x_127184 && y_127185;
                        bool index_certs_127187;
                        
                        if (!bounds_check_127186) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127183, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_127181 = ((float *) mem_133194)[j_127176];
                        int64_t copy_arg0_127182 = ((int64_t *) mem_133196)[j_127176];
                        float copy_arg0_127188 = ((float *) mem_133194)[copy_arg0_127183];
                        int64_t copy_arg0_127189 = ((int64_t *) mem_133196)[copy_arg0_127183];
                        
                        ((float *) mem_133194)[j_127176] = copy_arg0_127188;
                        ((int64_t *) mem_133196)[j_127176] = copy_arg0_127189;
                        ((float *) mem_133194)[copy_arg0_127183] = copy_arg0_127181;
                        ((int64_t *) mem_133196)[copy_arg0_127183] = copy_arg0_127182;
                        
                        int64_t tmp_127194 = sub64(j_127176, (int64_t) 1);
                        bool cond_127195 = sle64((int64_t) 0, tmp_127194);
                        bool loop_cond_127196;
                        
                        if (cond_127195) {
                            bool y_128911 = slt64(tmp_127194, block_sizze_127099);
                            bool bounds_check_128912 = cond_127195 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127194, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_128910 = ((float *) mem_133194)[j_127176];
                            float gt_arg0_128914 = ((float *) mem_133194)[tmp_127194];
                            bool defunc_0_leq_res_128915 = gt_arg0_128914 <= gt_arg1_128910;
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127196 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127196 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127196;
                        int64_t j_tmp_133530 = tmp_127194;
                        
                        loop_while_127173 = loop_while_tmp_133527;
                        j_127176 = j_tmp_133530;
                    }
                    s_127169 = loop_while_127173;
                    s_127172 = j_127176;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133181, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint32_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        if (memblock_alloc(ctx, &mem_133253, bytes_133183, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        
        int64_t data_127209;
        bool data_127210;
        int64_t data_127213;
        int64_t loop_dz2084Uz2082U_127214;
        bool loop_while_127215;
        int64_t stride_127218;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127214 = flat_dim_127100;
        loop_while_127215 = loop_cond_127206;
        stride_127218 = block_sizze_127099;
        while (loop_while_127215) {
            int64_t next_stride_127219 = mul64((int64_t) 2, stride_127218);
            bool zzero_127220 = next_stride_127219 == (int64_t) 0;
            bool nonzzero_127221 = !zzero_127220;
            bool nonzzero_cert_127222;
            
            if (!nonzzero_127221) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127223 = sdiv64(flat_dim_127100, next_stride_127219);
            bool bounds_invalid_upwards_127224 = slt64(num_merges_127223, (int64_t) 0);
            bool valid_127225 = !bounds_invalid_upwards_127224;
            bool range_valid_c_127226;
            
            if (!valid_127225) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127223, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:141:35-39\n   #6  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127228 = sub64(next_stride_127219, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127229 = sle64((int64_t) 0, m_127228);
            bool cond_127231 = slt64(next_stride_127219, (int64_t) 10);
            bool protect_assert_disj_127232 = nonzzero_127208 || cond_127231;
            bool nonzzero_cert_127233;
            
            if (!protect_assert_disj_127232) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127234 = smod_safe64(next_stride_127219, merge_block_sizze_127104);
            bool num_blocks_127235 = zeze_lhs_127234 == (int64_t) 0;
            bool protect_assert_disj_127236 = cond_127231 || num_blocks_127235;
            bool assert_c_127237;
            
            if (!protect_assert_disj_127236) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127239 = sdiv_safe64(next_stride_127219, merge_block_sizze_127104);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240 = add64((int64_t) 1, num_blocks_127239);
            int64_t j_m_i_127241 = sub64(next_stride_127219, stride_127218);
            int64_t flat_dim_127242 = merge_block_sizze_127104 * num_blocks_127239;
            bool bounds_invalid_upwards_127243 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, (int64_t) 0);
            bool empty_slice_127244 = j_m_i_127241 == (int64_t) 0;
            int64_t m_127245 = sub64(j_m_i_127241, (int64_t) 1);
            bool zzero_lte_i_127246 = sle64((int64_t) 0, stride_127218);
            bool i_lte_j_127247 = sle64(stride_127218, next_stride_127219);
            bool empty_slice_127248 = stride_127218 == (int64_t) 0;
            int64_t m_127249 = sub64(stride_127218, (int64_t) 1);
            bool bounds_invalid_upwards_127250 = slt64(num_blocks_127239, (int64_t) 0);
            bool cond_127251 = slt64((int64_t) 0, stride_127218);
            bool valid_127252 = !bounds_invalid_upwards_127243;
            int64_t i_p_m_t_s_127253 = add64(stride_127218, m_127245);
            bool zzero_leq_i_p_m_t_s_127254 = sle64((int64_t) 0, m_127249);
            bool i_p_m_t_s_leq_w_127255 = slt64(m_127249, next_stride_127219);
            bool valid_127256 = !bounds_invalid_upwards_127250;
            bool i_p_m_t_s_leq_w_127257 = slt64(m_127228, flat_dim_127242);
            bool y_127258 = slt64((int64_t) 0, j_m_i_127241);
            bool protect_assert_disj_127259 = cond_127231 || valid_127252;
            bool range_valid_c_127260;
            
            if (!protect_assert_disj_127259) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127261 = sle64((int64_t) 0, i_p_m_t_s_127253);
            bool i_p_m_t_s_leq_w_127262 = slt64(i_p_m_t_s_127253, next_stride_127219);
            bool y_127263 = zzero_leq_i_p_m_t_s_127254 && i_p_m_t_s_leq_w_127255;
            bool protect_assert_disj_127264 = cond_127231 || valid_127256;
            bool range_valid_c_127265;
            
            if (!protect_assert_disj_127264) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127266 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127257;
            bool y_127267 = zzero_lte_i_127246 && i_p_m_t_s_leq_w_127262;
            bool forwards_ok_127268 = zzero_lte_i_127246 && y_127263;
            bool ok_or_empty_127269 = zzero_127220 || y_127266;
            bool protect_assert_disj_127270 = cond_127251 || y_127258;
            bool y_127271 = zzero_leq_i_p_m_t_s_127261 && y_127267;
            bool ok_or_empty_127272 = empty_slice_127248 || forwards_ok_127268;
            bool protect_assert_disj_127273 = cond_127231 || ok_or_empty_127269;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) flat_dim_127242, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127275 = !cond_127231;
            bool protect_assert_disj_127276 = protect_assert_disj_127270 || loop_not_taken_127275;
            bool index_certs_127277;
            
            if (!protect_assert_disj_127276) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127278 = i_lte_j_127247 && y_127271;
            bool protect_assert_disj_127279 = cond_127231 || ok_or_empty_127272;
            bool index_certs_127280;
            
            if (!protect_assert_disj_127279) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127281 = ok_or_empty_127272 || loop_not_taken_127275;
            bool index_certs_127282;
            
            if (!protect_assert_disj_127281) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127283 = empty_slice_127244 || forwards_ok_127278;
            bool protect_assert_disj_127284 = cond_127231 || ok_or_empty_127283;
            bool index_certs_127285;
            
            if (!protect_assert_disj_127284) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127286 = loop_not_taken_127275 || ok_or_empty_127283;
            bool index_certs_127287;
            
            if (!protect_assert_disj_127286) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 4 * num_merges_127223;
            int64_t bytes_133262 = next_stride_127219 * binop_x_133261;
            int64_t binop_x_133264 = (int64_t) 8 * num_merges_127223;
            int64_t bytes_133265 = next_stride_127219 * binop_x_133264;
            bool i_lte_j_127230 = sle64((int64_t) 0, next_stride_127219);
            
            if (mem_133263_cached_sizze_133771 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133771, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133772 < bytes_133265) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133772, bytes_133265);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240;
            int64_t binop_x_133291 = (int64_t) 4 * num_blocks_127239;
            int64_t bytes_133292 = merge_block_sizze_127104 * binop_x_133291;
            int64_t binop_x_133294 = (int64_t) 8 * num_blocks_127239;
            int64_t bytes_133295 = merge_block_sizze_127104 * binop_x_133294;
            int64_t bytes_133337 = (int64_t) 8 * stride_127218;
            int64_t bytes_133339 = (int64_t) 16 * stride_127218;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127223; i_133075++) {
                int64_t start_127291 = mul64(next_stride_127219, i_133075);
                int64_t j_m_i_127292 = sub64(loop_dz2084Uz2082U_127214, start_127291);
                bool empty_slice_127293 = j_m_i_127292 == (int64_t) 0;
                int64_t m_127294 = sub64(j_m_i_127292, (int64_t) 1);
                int64_t i_p_m_t_s_127295 = add64(start_127291, m_127294);
                bool zzero_leq_i_p_m_t_s_127296 = sle64((int64_t) 0, i_p_m_t_s_127295);
                bool i_p_m_t_s_leq_w_127297 = slt64(i_p_m_t_s_127295, loop_dz2084Uz2082U_127214);
                bool zzero_lte_i_127298 = sle64((int64_t) 0, start_127291);
                bool i_lte_j_127299 = sle64(start_127291, loop_dz2084Uz2082U_127214);
                bool y_127300 = i_p_m_t_s_leq_w_127297 && zzero_lte_i_127298;
                bool y_127301 = zzero_leq_i_p_m_t_s_127296 && y_127300;
                bool forwards_ok_127302 = i_lte_j_127299 && y_127301;
                bool ok_or_empty_127303 = empty_slice_127293 || forwards_ok_127302;
                bool index_certs_127304;
                
                if (!ok_or_empty_127303) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127291, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127214, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127305 = slt64(m_127228, j_m_i_127292);
                bool y_127306 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127305;
                bool forwards_ok_127307 = i_lte_j_127230 && y_127306;
                bool ok_or_empty_127308 = zzero_127220 || forwards_ok_127307;
                bool index_certs_127309;
                
                if (!ok_or_empty_127308) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) j_m_i_127292, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127231) {
                    float dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127251) {
                        float head_res_128944 = ((float *) mem_param_133257.mem)[start_127291];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127291];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127218 + start_127291;
                        float head_res_128947 = ((float *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127219; nest_i_133540++) {
                        ((float *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133339, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127219; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127219; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127241;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127218);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127241);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127218 + j_128958;
                                int64_t slice_128968 = start_127291 + slice_128967;
                                float leq_arg1_128969 = ((float *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127291 + i_128955;
                                float leq_arg0_128974 = ((float *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = leq_arg0_128974 <= leq_arg1_128969;
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        float loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127218);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127291 + i_128955;
                            float tmp_128985 = ((float *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127241);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127218 + j_128958;
                            int64_t slice_128992 = start_127291 + slice_128991;
                            float tmp_128993 = ((float *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((float *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133773 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133773, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133774 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133774, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240; i_133061++) {
                        int64_t split_count_arg3_127371 = mul64(merge_block_sizze_127104, i_133061);
                        int64_t defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127372, &defunc_0_split_count_res_127373, &defunc_0_split_count_res_127374, &defunc_0_split_count_res_127375, &defunc_0_split_count_res_127376, (int64_t) 0, stride_127218, (int64_t) 0, j_m_i_127241, split_count_arg3_127371) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127377 = slt64((int64_t) 0, defunc_0_split_count_res_127376);
                        bool defunc_0_split_count_res_127378;
                        int64_t defunc_0_split_count_res_127379;
                        int64_t defunc_0_split_count_res_127380;
                        int64_t defunc_0_split_count_res_127381;
                        int64_t defunc_0_split_count_res_127382;
                        int64_t defunc_0_split_count_res_127383;
                        bool loop_while_127384;
                        int64_t ss_127385;
                        int64_t ss_127386;
                        int64_t tt_127387;
                        int64_t tt_127388;
                        int64_t count_127389;
                        
                        loop_while_127384 = loop_cond_127377;
                        ss_127385 = defunc_0_split_count_res_127372;
                        ss_127386 = defunc_0_split_count_res_127373;
                        tt_127387 = defunc_0_split_count_res_127374;
                        tt_127388 = defunc_0_split_count_res_127375;
                        count_127389 = defunc_0_split_count_res_127376;
                        while (loop_while_127384) {
                            int64_t zlze_lhs_127390 = sub64(ss_127386, ss_127385);
                            bool cond_127391 = sle64(zlze_lhs_127390, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127392;
                            int64_t defunc_0_lifted_step_res_127393;
                            int64_t defunc_0_lifted_step_res_127394;
                            int64_t defunc_0_lifted_step_res_127395;
                            
                            if (cond_127391) {
                                int64_t tmp_128997 = add64(tt_127387, count_127389);
                                
                                defunc_0_lifted_step_res_127392 = ss_127385;
                                defunc_0_lifted_step_res_127393 = tmp_128997;
                                defunc_0_lifted_step_res_127394 = tt_127388;
                                defunc_0_lifted_step_res_127395 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127397 = sub64(tt_127388, tt_127387);
                                bool cond_127398 = sle64(zlze_lhs_127397, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127399;
                                int64_t defunc_0_lifted_step_res_f_res_127400;
                                int64_t defunc_0_lifted_step_res_f_res_127401;
                                int64_t defunc_0_lifted_step_res_f_res_127402;
                                
                                if (cond_127398) {
                                    int64_t tmp_128998 = add64(ss_127385, count_127389);
                                    
                                    defunc_0_lifted_step_res_f_res_127399 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127400 = tt_127387;
                                    defunc_0_lifted_step_res_f_res_127401 = tt_127388;
                                    defunc_0_lifted_step_res_f_res_127402 = (int64_t) 0;
                                } else {
                                    bool cond_127404 = count_127389 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127405;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127406;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127407;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127408;
                                    
                                    if (cond_127404) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127385);
                                        bool y_129001 = slt64(ss_127385, stride_127218);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127385, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127387);
                                        bool y_129007 = slt64(tt_127387, j_m_i_127241);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127387, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127291 + ss_127385;
                                        float leq_arg1_129005 = ((float *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127218 + tt_127387;
                                        int64_t slice_129011 = start_127291 + slice_129010;
                                        float leq_arg0_129012 = ((float *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = leq_arg0_129012 <= leq_arg1_129005;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127387);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127385;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127385);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127387;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = tt_127388;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = (int64_t) 0;
                                    } else {
                                        int64_t m_127427 = sdiv64(count_127389, (int64_t) 2);
                                        int64_t n_127428 = sub64(count_127389, m_127427);
                                        bool cond_127429 = n_127428 == (int64_t) 0;
                                        int64_t zgze_lhs_127430 = add64(ss_127385, m_127427);
                                        bool cond_f_res_127431 = sle64(ss_127386, zgze_lhs_127430);
                                        bool x_127432 = !cond_127429;
                                        bool y_127433 = cond_f_res_127431 && x_127432;
                                        bool cond_127434 = cond_127429 || y_127433;
                                        bool leq_y_x_127435;
                                        
                                        if (cond_127434) {
                                            leq_y_x_127435 = 1;
                                        } else {
                                            bool x_127436 = sle64((int64_t) 0, zgze_lhs_127430);
                                            bool y_127437 = slt64(zgze_lhs_127430, stride_127218);
                                            bool bounds_check_127438 = x_127436 && y_127437;
                                            bool index_certs_127439;
                                            
                                            if (!bounds_check_127438) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127430, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127442 = add64(tt_127387, n_127428);
                                            int64_t leq_arg0_127443 = sub64(zm_lhs_127442, (int64_t) 1);
                                            bool x_127444 = sle64((int64_t) 0, leq_arg0_127443);
                                            bool y_127445 = slt64(leq_arg0_127443, j_m_i_127241);
                                            bool bounds_check_127446 = x_127444 && y_127445;
                                            bool index_certs_127447;
                                            
                                            if (!bounds_check_127446) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127443, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127440 = start_127291 + zgze_lhs_127430;
                                            float leq_arg1_127441 = ((float *) mem_param_133257.mem)[slice_127440];
                                            int64_t slice_127448 = stride_127218 + leq_arg0_127443;
                                            int64_t slice_127449 = start_127291 + slice_127448;
                                            float leq_arg0_127450 = ((float *) mem_param_133257.mem)[slice_127449];
                                            bool defunc_0_leq_res_127451 = leq_arg0_127450 <= leq_arg1_127441;
                                            
                                            leq_y_x_127435 = defunc_0_leq_res_127451;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                        
                                        if (leq_y_x_127435) {
                                            int64_t tmp_129018 = add64(tt_127387, n_127428);
                                            int64_t tmp_129019 = sub64(count_127389, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tt_127388;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = tmp_129019;
                                        } else {
                                            int64_t tmp_127457 = add64(tt_127387, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tt_127387;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tmp_127457;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = count_127389;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = ss_127385;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                    }
                                    defunc_0_lifted_step_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_127405;
                                    defunc_0_lifted_step_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_127406;
                                    defunc_0_lifted_step_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_127407;
                                    defunc_0_lifted_step_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_127408;
                                }
                                defunc_0_lifted_step_res_127392 = defunc_0_lifted_step_res_f_res_127399;
                                defunc_0_lifted_step_res_127393 = defunc_0_lifted_step_res_f_res_127400;
                                defunc_0_lifted_step_res_127394 = defunc_0_lifted_step_res_f_res_127401;
                                defunc_0_lifted_step_res_127395 = defunc_0_lifted_step_res_f_res_127402;
                            }
                            
                            int64_t loopres_127458;
                            int64_t loopres_127459;
                            int64_t loopres_127460;
                            int64_t loopres_127461;
                            int64_t loopres_127462;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127458, &loopres_127459, &loopres_127460, &loopres_127461, &loopres_127462, defunc_0_lifted_step_res_127392, ss_127386, defunc_0_lifted_step_res_127393, defunc_0_lifted_step_res_127394, defunc_0_lifted_step_res_127395) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127463 = slt64((int64_t) 0, loopres_127462);
                            bool loop_while_tmp_133547 = loop_cond_127463;
                            int64_t ss_tmp_133548 = loopres_127458;
                            int64_t ss_tmp_133549 = loopres_127459;
                            int64_t tt_tmp_133550 = loopres_127460;
                            int64_t tt_tmp_133551 = loopres_127461;
                            int64_t count_tmp_133552 = loopres_127462;
                            
                            loop_while_127384 = loop_while_tmp_133547;
                            ss_127385 = ss_tmp_133548;
                            ss_127386 = ss_tmp_133549;
                            tt_127387 = tt_tmp_133550;
                            tt_127388 = tt_tmp_133551;
                            count_127389 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127378 = loop_while_127384;
                        defunc_0_split_count_res_127379 = ss_127385;
                        defunc_0_split_count_res_127380 = ss_127386;
                        defunc_0_split_count_res_127381 = tt_127387;
                        defunc_0_split_count_res_127382 = tt_127388;
                        defunc_0_split_count_res_127383 = count_127389;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127379;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127381;
                    }
                    if (mem_133293_cached_sizze_133775 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133775, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133776 < bytes_133295) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133776, bytes_133295);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127239; i_133068++) {
                        bool y_127469 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool index_certs_127471;
                        
                        if (!y_127469) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127472 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127474 = add64((int64_t) 1, i_133068);
                        bool x_127475 = sle64((int64_t) 0, tmp_127474);
                        bool y_127476 = slt64(tmp_127474, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool bounds_check_127477 = x_127475 && y_127476;
                        bool index_certs_127478;
                        
                        if (!bounds_check_127477) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127474, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127479 = ((int64_t *) mem_133276)[tmp_127474];
                        int64_t defunc_0_f_res_127480 = ((int64_t *) mem_133278)[tmp_127474];
                        int64_t merge_sequential_arg2_127481 = add64(stride_127218, defunc_0_f_res_127473);
                        int64_t merge_sequential_arg2_127482 = add64(stride_127218, defunc_0_f_res_127480);
                        int64_t j_m_i_127483 = sub64(merge_sequential_arg2_127482, merge_sequential_arg2_127481);
                        bool empty_slice_127484 = j_m_i_127483 == (int64_t) 0;
                        int64_t m_127485 = sub64(j_m_i_127483, (int64_t) 1);
                        int64_t i_p_m_t_s_127486 = add64(merge_sequential_arg2_127481, m_127485);
                        bool zzero_leq_i_p_m_t_s_127487 = sle64((int64_t) 0, i_p_m_t_s_127486);
                        bool i_p_m_t_s_leq_w_127488 = slt64(i_p_m_t_s_127486, next_stride_127219);
                        bool zzero_lte_i_127489 = sle64((int64_t) 0, merge_sequential_arg2_127481);
                        bool i_lte_j_127490 = sle64(merge_sequential_arg2_127481, merge_sequential_arg2_127482);
                        bool y_127491 = i_p_m_t_s_leq_w_127488 && zzero_lte_i_127489;
                        bool y_127492 = zzero_leq_i_p_m_t_s_127487 && y_127491;
                        bool forwards_ok_127493 = i_lte_j_127490 && y_127492;
                        bool ok_or_empty_127494 = empty_slice_127484 || forwards_ok_127493;
                        bool index_certs_127495;
                        
                        if (!ok_or_empty_127494) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127481, ":", (long long) merge_sequential_arg2_127482, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127496 = sub64(defunc_0_f_res_127479, defunc_0_f_res_127472);
                        bool empty_slice_127497 = j_m_i_127496 == (int64_t) 0;
                        int64_t m_127498 = sub64(j_m_i_127496, (int64_t) 1);
                        int64_t i_p_m_t_s_127499 = add64(defunc_0_f_res_127472, m_127498);
                        bool zzero_leq_i_p_m_t_s_127500 = sle64((int64_t) 0, i_p_m_t_s_127499);
                        bool i_p_m_t_s_leq_w_127501 = slt64(i_p_m_t_s_127499, next_stride_127219);
                        bool zzero_lte_i_127502 = sle64((int64_t) 0, defunc_0_f_res_127472);
                        bool i_lte_j_127503 = sle64(defunc_0_f_res_127472, defunc_0_f_res_127479);
                        bool y_127504 = i_p_m_t_s_leq_w_127501 && zzero_lte_i_127502;
                        bool y_127505 = zzero_leq_i_p_m_t_s_127500 && y_127504;
                        bool forwards_ok_127506 = i_lte_j_127503 && y_127505;
                        bool ok_or_empty_127507 = empty_slice_127497 || forwards_ok_127506;
                        bool index_certs_127508;
                        
                        if (!ok_or_empty_127507) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127472, ":", (long long) defunc_0_f_res_127479, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127509 = slt64((int64_t) 0, j_m_i_127496);
                        float dummy_127510;
                        int64_t dummy_127511;
                        
                        if (cond_127509) {
                            bool index_certs_129020;
                            
                            if (!cond_127509) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:141:35-39\n   #12 ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127291 + defunc_0_f_res_127472;
                            float head_res_129022 = ((float *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127510 = head_res_129022;
                            dummy_127511 = head_res_129023;
                        } else {
                            bool y_127516 = slt64((int64_t) 0, j_m_i_127483);
                            bool index_certs_127517;
                            
                            if (!y_127516) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:141:35-39\n   #12 ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127518 = start_127291 + merge_sequential_arg2_127481;
                            float head_res_127519 = ((float *) mem_param_133257.mem)[slice_127518];
                            int64_t head_res_127520 = ((int64_t *) mem_param_133260.mem)[slice_127518];
                            
                            dummy_127510 = head_res_127519;
                            dummy_127511 = head_res_127520;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127104; nest_i_133555++) {
                            ((float *) mem_133293)[i_133068 * merge_block_sizze_127104 + nest_i_133555] = dummy_127510;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127104; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + nest_i_133556] = dummy_127511;
                        }
                        
                        int64_t data_127523;
                        int64_t i_127527 = (int64_t) 0;
                        
                        for (int64_t k_127526 = 0; k_127526 < merge_block_sizze_127104; k_127526++) {
                            int64_t j_127530 = sub64(k_127526, i_127527);
                            bool cond_127531 = j_127530 == j_m_i_127483;
                            bool cond_127532;
                            
                            if (cond_127531) {
                                cond_127532 = 1;
                            } else {
                                bool cond_127533 = slt64(i_127527, j_m_i_127496);
                                bool cond_f_res_127534;
                                
                                if (cond_127533) {
                                    bool x_129024 = sle64((int64_t) 0, j_127530);
                                    bool y_129025 = slt64(j_127530, j_m_i_127483);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127527);
                                    bool bounds_check_129032 = cond_127533 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127481 + j_127530;
                                    int64_t slice_129029 = start_127291 + slice_129028;
                                    float leq_arg1_129030 = ((float *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127472 + i_127527;
                                    int64_t slice_129035 = start_127291 + slice_129034;
                                    float leq_arg0_129036 = ((float *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = leq_arg0_129036 <= leq_arg1_129030;
                                    
                                    cond_f_res_127534 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127534 = 0;
                                }
                                cond_127532 = cond_f_res_127534;
                            }
                            
                            int64_t loopres_127549;
                            float loopres_127550;
                            int64_t loopres_127551;
                            
                            if (cond_127532) {
                                bool x_129039 = sle64((int64_t) 0, i_127527);
                                bool y_129040 = slt64(i_127527, j_m_i_127496);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127527);
                                int64_t slice_129043 = defunc_0_f_res_127472 + i_127527;
                                int64_t slice_129044 = start_127291 + slice_129043;
                                float tmp_129045 = ((float *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127549 = tmp_129038;
                                loopres_127550 = tmp_129045;
                                loopres_127551 = tmp_129046;
                            } else {
                                bool x_127561 = sle64((int64_t) 0, j_127530);
                                bool y_127562 = slt64(j_127530, j_m_i_127483);
                                bool bounds_check_127563 = x_127561 && y_127562;
                                bool index_certs_127564;
                                
                                if (!bounds_check_127563) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127565 = merge_sequential_arg2_127481 + j_127530;
                                int64_t slice_127566 = start_127291 + slice_127565;
                                float tmp_127567 = ((float *) mem_param_133257.mem)[slice_127566];
                                int64_t tmp_127568 = ((int64_t *) mem_param_133260.mem)[slice_127566];
                                
                                loopres_127549 = i_127527;
                                loopres_127550 = tmp_127567;
                                loopres_127551 = tmp_127568;
                            }
                            ((float *) mem_133293)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127550;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127551;
                            
                            int64_t i_tmp_133557 = loopres_127549;
                            
                            i_127527 = i_tmp_133557;
                        }
                        data_127523 = i_127527;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint32_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133295, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_133263, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127575 = next_stride_127219 * num_merges_127223;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint32_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            if (memblock_alloc(ctx, &mem_133373, bytes_133265, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            
            bool loop_cond_127578 = slt64(next_stride_127219, flat_dim_127100);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127575;
            bool loop_while_tmp_133534 = loop_cond_127578;
            int64_t stride_tmp_133537 = next_stride_127219;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127214 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127215 = loop_while_tmp_133534;
            stride_127218 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127209 = loop_dz2084Uz2082U_127214;
        data_127210 = loop_while_127215;
        data_127213 = stride_127218;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127579 = n_97356 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127580 = sle64((int64_t) 0, zs_lhs_127084);
        bool i_p_m_t_s_leq_w_127581 = slt64(zs_lhs_127084, data_127209);
        bool y_127582 = zzero_leq_i_p_m_t_s_127580 && i_p_m_t_s_leq_w_127581;
        bool ok_or_empty_127583 = empty_slice_127579 || y_127582;
        bool index_certs_127584;
        
        if (!ok_or_empty_127583) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_97356, "] out of bounds for array of shape [", (long long) data_127209, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:141:35-39\n   #6  ftRelational.fut:140:9-141:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_97356; i_133082++) {
        int64_t eta_p_127592 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127593 = sle64((int64_t) 0, eta_p_127592);
        bool y_127594 = slt64(eta_p_127592, n_97356);
        bool bounds_check_127595 = x_127593 && y_127594;
        bool index_certs_127596;
        
        if (!bounds_check_127595) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127592, "] out of bounds for array of shape [", (long long) n_97356, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_127597 = ((int64_t *) ext_mem_133176.mem)[eta_p_127592];
        float lifted_lambda_res_127598 = ((float *) xs_mem_133175.mem)[eta_p_127592];
        
        ((int64_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127597;
        ((float *) mem_133387.mem)[i_133082] = lifted_lambda_res_127598;
    }
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133765, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133766, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_133777, struct memblock *mem_out_p_133778, struct memblock xs_mem_133175, int64_t n_93070, int64_t incr_93071)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133779 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133780 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133781 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133782 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133783 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133784 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133785 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133786 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133787 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133788 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_93070;
    bool cond_127083 = sle64(n_93070, (int64_t) 1);
    int64_t zs_lhs_127084 = sub64(n_93070, (int64_t) 1);
    int64_t zp_rhs_127085 = sdiv_safe64(zs_lhs_127084, (int64_t) 20);
    int64_t min_num_blocks_127086 = add64((int64_t) 1, zp_rhs_127085);
    bool loop_cond_127087 = slt64((int64_t) 1, min_num_blocks_127086);
    bool smallest_pow_2_geq_than_res_127088;
    int64_t smallest_pow_2_geq_than_res_127089;
    bool loop_while_127090;
    int64_t x_127091;
    
    loop_while_127090 = loop_cond_127087;
    x_127091 = (int64_t) 1;
    while (loop_while_127090) {
        int64_t loopres_127092 = mul64((int64_t) 2, x_127091);
        bool loop_cond_127093 = slt64(loopres_127092, min_num_blocks_127086);
        bool loop_while_tmp_133515 = loop_cond_127093;
        int64_t x_tmp_133516 = loopres_127092;
        
        loop_while_127090 = loop_while_tmp_133515;
        x_127091 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127088 = loop_while_127090;
    smallest_pow_2_geq_than_res_127089 = x_127091;
    
    bool zzero_127094 = smallest_pow_2_geq_than_res_127089 == (int64_t) 0;
    bool nonzzero_127095 = !zzero_127094;
    bool protect_assert_disj_127096 = cond_127083 || nonzzero_127095;
    bool nonzzero_cert_127097;
    
    if (!protect_assert_disj_127096) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127098 = sdiv_safe64(zs_lhs_127084, smallest_pow_2_geq_than_res_127089);
    int64_t block_sizze_127099 = add64((int64_t) 1, zp_rhs_127098);
    bool y_127105 = slt64((int64_t) 0, n_93070);
    bool protect_assert_disj_133419 = cond_127083 || y_127105;
    bool index_certs_127106;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_93070, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127120 = slt64(smallest_pow_2_geq_than_res_127089, (int64_t) 0);
    bool valid_127121 = !bounds_invalid_upwards_127120;
    bool protect_assert_disj_133427 = cond_127083 || valid_127121;
    bool range_valid_c_127122;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127089, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:137:35-39\n   #6  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127124 = slt64(block_sizze_127099, (int64_t) 0);
    bool valid_127125 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_133429 = cond_127083 || valid_127125;
    bool range_valid_c_127126;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127099, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127128 = sle64(block_sizze_127099, (int64_t) 1);
    int64_t tmp_127129 = sub64(block_sizze_127099, (int64_t) 2);
    bool bounds_invalid_upwards_127130 = slt64(tmp_127129, (int64_t) 0);
    bool valid_127132 = !bounds_invalid_upwards_127130;
    bool protect_assert_disj_127133 = cond_127128 || valid_127132;
    bool protect_assert_disj_133431 = cond_127083 || protect_assert_disj_127133;
    bool range_valid_c_127134;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127129, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133386 = (int64_t) 4 * n_93070;
    
    if (futrts_indicesWithIncrement_11394(ctx, &ext_mem_133176, xs_mem_133175, n_93070, incr_93071) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_93070; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127100 = smallest_pow_2_geq_than_res_127089 * block_sizze_127099;
    bool x_133414 = !cond_127083;
    int64_t greatest_divisor_leq_than_arg1_127103 = mul64((int64_t) 2, block_sizze_127099);
    int64_t merge_block_sizze_127104;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127103) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127104 = x_133416;
    } else {
        merge_block_sizze_127104 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_127107;
    
    if (x_133414) {
        int32_t x_133420 = ((int32_t *) xs_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127107 = x_133420;
    } else {
        reduce_arg1_127107 = 0;
    }
    
    int32_t defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        int32_t x_133422;
        int64_t x_133423;
        int32_t redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127107;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_93070; i_133042++) {
            int32_t x_127111 = ((int32_t *) xs_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127117 = sle32(redout_133040, x_127111);
            int32_t defunc_0_op_res_127118;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127118 = x_127111;
            } else {
                defunc_0_op_res_127118 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127119;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127119 = i_133042;
            } else {
                defunc_0_op_res_127119 = redout_133041;
            }
            
            int32_t redout_tmp_133519 = defunc_0_op_res_127118;
            int64_t redout_tmp_133520 = defunc_0_op_res_127119;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = 0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127131 = add64((int64_t) 1, tmp_127129);
    int64_t binop_x_133179 = (int64_t) 4 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133180 = block_sizze_127099 * binop_x_133179;
    int64_t binop_x_133182 = (int64_t) 8 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133183 = block_sizze_127099 * binop_x_133182;
    int64_t bytes_133193 = (int64_t) 4 * block_sizze_127099;
    int64_t bytes_133195 = (int64_t) 8 * block_sizze_127099;
    bool loop_cond_127206 = slt64(block_sizze_127099, flat_dim_127100);
    bool zzero_127207 = merge_block_sizze_127104 == (int64_t) 0;
    bool nonzzero_127208 = !zzero_127207;
    
    if (cond_127083) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133779 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133779, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133780 < bytes_133183) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133780, bytes_133183);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133781 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133781, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133782 < bytes_133195) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133782, bytes_133195);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127089; i_133054++) {
            int64_t zp_lhs_127138 = mul64(block_sizze_127099, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127099; i_133047++) {
                int64_t k_127142 = add64(zp_lhs_127138, i_133047);
                bool cond_127143 = slt64(k_127142, n_93070);
                int32_t lifted_lambda_res_127144;
                int64_t lifted_lambda_res_127145;
                
                if (cond_127143) {
                    bool x_128906 = sle64((int64_t) 0, k_127142);
                    bool bounds_check_128907 = cond_127143 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127142, "] out of bounds for array of shape [", (long long) n_93070, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_128909 = ((int32_t *) xs_mem_133175.mem)[k_127142];
                    
                    lifted_lambda_res_127144 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127145 = k_127142;
                } else {
                    lifted_lambda_res_127144 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127145 = defunc_0_reduce_res_129054;
                }
                ((int32_t *) mem_133194)[i_133047] = lifted_lambda_res_127144;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127145;
            }
            if (!cond_127128) {
                for (int64_t i_127155 = 0; i_127155 < distance_127131; i_127155++) {
                    int64_t gt_arg1_127158 = add64((int64_t) 1, i_127155);
                    bool x_127159 = sle64((int64_t) 0, gt_arg1_127158);
                    bool y_127160 = slt64(gt_arg1_127158, block_sizze_127099);
                    bool bounds_check_127161 = x_127159 && y_127160;
                    bool index_certs_127162;
                    
                    if (!bounds_check_127161) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127158, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127164 = slt64(i_127155, block_sizze_127099);
                    bool index_certs_127165;
                    
                    if (!y_127164) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127155, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_127163 = ((int32_t *) mem_133194)[gt_arg1_127158];
                    int32_t gt_arg0_127166 = ((int32_t *) mem_133194)[i_127155];
                    bool defunc_0_leq_res_127167 = sle32(gt_arg0_127166, gt_arg1_127163);
                    bool defunc_0_lifted_gt_res_127168 = !defunc_0_leq_res_127167;
                    bool s_127169;
                    int64_t s_127172;
                    bool loop_while_127173;
                    int64_t j_127176;
                    
                    loop_while_127173 = defunc_0_lifted_gt_res_127168;
                    j_127176 = i_127155;
                    while (loop_while_127173) {
                        bool x_127177 = sle64((int64_t) 0, j_127176);
                        bool y_127178 = slt64(j_127176, block_sizze_127099);
                        bool bounds_check_127179 = x_127177 && y_127178;
                        bool index_certs_127180;
                        
                        if (!bounds_check_127179) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127176, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127183 = add64((int64_t) 1, j_127176);
                        bool x_127184 = sle64((int64_t) 0, copy_arg0_127183);
                        bool y_127185 = slt64(copy_arg0_127183, block_sizze_127099);
                        bool bounds_check_127186 = x_127184 && y_127185;
                        bool index_certs_127187;
                        
                        if (!bounds_check_127186) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127183, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_127181 = ((int32_t *) mem_133194)[j_127176];
                        int64_t copy_arg0_127182 = ((int64_t *) mem_133196)[j_127176];
                        int32_t copy_arg0_127188 = ((int32_t *) mem_133194)[copy_arg0_127183];
                        int64_t copy_arg0_127189 = ((int64_t *) mem_133196)[copy_arg0_127183];
                        
                        ((int32_t *) mem_133194)[j_127176] = copy_arg0_127188;
                        ((int64_t *) mem_133196)[j_127176] = copy_arg0_127189;
                        ((int32_t *) mem_133194)[copy_arg0_127183] = copy_arg0_127181;
                        ((int64_t *) mem_133196)[copy_arg0_127183] = copy_arg0_127182;
                        
                        int64_t tmp_127194 = sub64(j_127176, (int64_t) 1);
                        bool cond_127195 = sle64((int64_t) 0, tmp_127194);
                        bool loop_cond_127196;
                        
                        if (cond_127195) {
                            bool y_128911 = slt64(tmp_127194, block_sizze_127099);
                            bool bounds_check_128912 = cond_127195 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127194, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_128910 = ((int32_t *) mem_133194)[j_127176];
                            int32_t gt_arg0_128914 = ((int32_t *) mem_133194)[tmp_127194];
                            bool defunc_0_leq_res_128915 = sle32(gt_arg0_128914, gt_arg1_128910);
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127196 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127196 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127196;
                        int64_t j_tmp_133530 = tmp_127194;
                        
                        loop_while_127173 = loop_while_tmp_133527;
                        j_127176 = j_tmp_133530;
                    }
                    s_127169 = loop_while_127173;
                    s_127172 = j_127176;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133181, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint32_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        if (memblock_alloc(ctx, &mem_133253, bytes_133183, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        
        int64_t data_127209;
        bool data_127210;
        int64_t data_127213;
        int64_t loop_dz2084Uz2082U_127214;
        bool loop_while_127215;
        int64_t stride_127218;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127214 = flat_dim_127100;
        loop_while_127215 = loop_cond_127206;
        stride_127218 = block_sizze_127099;
        while (loop_while_127215) {
            int64_t next_stride_127219 = mul64((int64_t) 2, stride_127218);
            bool zzero_127220 = next_stride_127219 == (int64_t) 0;
            bool nonzzero_127221 = !zzero_127220;
            bool nonzzero_cert_127222;
            
            if (!nonzzero_127221) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127223 = sdiv64(flat_dim_127100, next_stride_127219);
            bool bounds_invalid_upwards_127224 = slt64(num_merges_127223, (int64_t) 0);
            bool valid_127225 = !bounds_invalid_upwards_127224;
            bool range_valid_c_127226;
            
            if (!valid_127225) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127223, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:137:35-39\n   #6  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127228 = sub64(next_stride_127219, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127229 = sle64((int64_t) 0, m_127228);
            bool cond_127231 = slt64(next_stride_127219, (int64_t) 10);
            bool protect_assert_disj_127232 = nonzzero_127208 || cond_127231;
            bool nonzzero_cert_127233;
            
            if (!protect_assert_disj_127232) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127234 = smod_safe64(next_stride_127219, merge_block_sizze_127104);
            bool num_blocks_127235 = zeze_lhs_127234 == (int64_t) 0;
            bool protect_assert_disj_127236 = cond_127231 || num_blocks_127235;
            bool assert_c_127237;
            
            if (!protect_assert_disj_127236) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127239 = sdiv_safe64(next_stride_127219, merge_block_sizze_127104);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240 = add64((int64_t) 1, num_blocks_127239);
            int64_t j_m_i_127241 = sub64(next_stride_127219, stride_127218);
            int64_t flat_dim_127242 = merge_block_sizze_127104 * num_blocks_127239;
            bool bounds_invalid_upwards_127243 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, (int64_t) 0);
            bool empty_slice_127244 = j_m_i_127241 == (int64_t) 0;
            int64_t m_127245 = sub64(j_m_i_127241, (int64_t) 1);
            bool zzero_lte_i_127246 = sle64((int64_t) 0, stride_127218);
            bool i_lte_j_127247 = sle64(stride_127218, next_stride_127219);
            bool empty_slice_127248 = stride_127218 == (int64_t) 0;
            int64_t m_127249 = sub64(stride_127218, (int64_t) 1);
            bool bounds_invalid_upwards_127250 = slt64(num_blocks_127239, (int64_t) 0);
            bool cond_127251 = slt64((int64_t) 0, stride_127218);
            bool valid_127252 = !bounds_invalid_upwards_127243;
            int64_t i_p_m_t_s_127253 = add64(stride_127218, m_127245);
            bool zzero_leq_i_p_m_t_s_127254 = sle64((int64_t) 0, m_127249);
            bool i_p_m_t_s_leq_w_127255 = slt64(m_127249, next_stride_127219);
            bool valid_127256 = !bounds_invalid_upwards_127250;
            bool i_p_m_t_s_leq_w_127257 = slt64(m_127228, flat_dim_127242);
            bool y_127258 = slt64((int64_t) 0, j_m_i_127241);
            bool protect_assert_disj_127259 = cond_127231 || valid_127252;
            bool range_valid_c_127260;
            
            if (!protect_assert_disj_127259) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127261 = sle64((int64_t) 0, i_p_m_t_s_127253);
            bool i_p_m_t_s_leq_w_127262 = slt64(i_p_m_t_s_127253, next_stride_127219);
            bool y_127263 = zzero_leq_i_p_m_t_s_127254 && i_p_m_t_s_leq_w_127255;
            bool protect_assert_disj_127264 = cond_127231 || valid_127256;
            bool range_valid_c_127265;
            
            if (!protect_assert_disj_127264) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127266 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127257;
            bool y_127267 = zzero_lte_i_127246 && i_p_m_t_s_leq_w_127262;
            bool forwards_ok_127268 = zzero_lte_i_127246 && y_127263;
            bool ok_or_empty_127269 = zzero_127220 || y_127266;
            bool protect_assert_disj_127270 = cond_127251 || y_127258;
            bool y_127271 = zzero_leq_i_p_m_t_s_127261 && y_127267;
            bool ok_or_empty_127272 = empty_slice_127248 || forwards_ok_127268;
            bool protect_assert_disj_127273 = cond_127231 || ok_or_empty_127269;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) flat_dim_127242, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127275 = !cond_127231;
            bool protect_assert_disj_127276 = protect_assert_disj_127270 || loop_not_taken_127275;
            bool index_certs_127277;
            
            if (!protect_assert_disj_127276) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127278 = i_lte_j_127247 && y_127271;
            bool protect_assert_disj_127279 = cond_127231 || ok_or_empty_127272;
            bool index_certs_127280;
            
            if (!protect_assert_disj_127279) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127281 = ok_or_empty_127272 || loop_not_taken_127275;
            bool index_certs_127282;
            
            if (!protect_assert_disj_127281) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127283 = empty_slice_127244 || forwards_ok_127278;
            bool protect_assert_disj_127284 = cond_127231 || ok_or_empty_127283;
            bool index_certs_127285;
            
            if (!protect_assert_disj_127284) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127286 = loop_not_taken_127275 || ok_or_empty_127283;
            bool index_certs_127287;
            
            if (!protect_assert_disj_127286) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 4 * num_merges_127223;
            int64_t bytes_133262 = next_stride_127219 * binop_x_133261;
            int64_t binop_x_133264 = (int64_t) 8 * num_merges_127223;
            int64_t bytes_133265 = next_stride_127219 * binop_x_133264;
            bool i_lte_j_127230 = sle64((int64_t) 0, next_stride_127219);
            
            if (mem_133263_cached_sizze_133783 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133783, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133784 < bytes_133265) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133784, bytes_133265);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240;
            int64_t binop_x_133291 = (int64_t) 4 * num_blocks_127239;
            int64_t bytes_133292 = merge_block_sizze_127104 * binop_x_133291;
            int64_t binop_x_133294 = (int64_t) 8 * num_blocks_127239;
            int64_t bytes_133295 = merge_block_sizze_127104 * binop_x_133294;
            int64_t bytes_133337 = (int64_t) 8 * stride_127218;
            int64_t bytes_133339 = (int64_t) 16 * stride_127218;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127223; i_133075++) {
                int64_t start_127291 = mul64(next_stride_127219, i_133075);
                int64_t j_m_i_127292 = sub64(loop_dz2084Uz2082U_127214, start_127291);
                bool empty_slice_127293 = j_m_i_127292 == (int64_t) 0;
                int64_t m_127294 = sub64(j_m_i_127292, (int64_t) 1);
                int64_t i_p_m_t_s_127295 = add64(start_127291, m_127294);
                bool zzero_leq_i_p_m_t_s_127296 = sle64((int64_t) 0, i_p_m_t_s_127295);
                bool i_p_m_t_s_leq_w_127297 = slt64(i_p_m_t_s_127295, loop_dz2084Uz2082U_127214);
                bool zzero_lte_i_127298 = sle64((int64_t) 0, start_127291);
                bool i_lte_j_127299 = sle64(start_127291, loop_dz2084Uz2082U_127214);
                bool y_127300 = i_p_m_t_s_leq_w_127297 && zzero_lte_i_127298;
                bool y_127301 = zzero_leq_i_p_m_t_s_127296 && y_127300;
                bool forwards_ok_127302 = i_lte_j_127299 && y_127301;
                bool ok_or_empty_127303 = empty_slice_127293 || forwards_ok_127302;
                bool index_certs_127304;
                
                if (!ok_or_empty_127303) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127291, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127214, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127305 = slt64(m_127228, j_m_i_127292);
                bool y_127306 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127305;
                bool forwards_ok_127307 = i_lte_j_127230 && y_127306;
                bool ok_or_empty_127308 = zzero_127220 || forwards_ok_127307;
                bool index_certs_127309;
                
                if (!ok_or_empty_127308) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) j_m_i_127292, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127231) {
                    int32_t dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127251) {
                        int32_t head_res_128944 = ((int32_t *) mem_param_133257.mem)[start_127291];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127291];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127218 + start_127291;
                        int32_t head_res_128947 = ((int32_t *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127219; nest_i_133540++) {
                        ((int32_t *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133339, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127219; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127219; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127241;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127218);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127241);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127218 + j_128958;
                                int64_t slice_128968 = start_127291 + slice_128967;
                                int32_t leq_arg1_128969 = ((int32_t *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127291 + i_128955;
                                int32_t leq_arg0_128974 = ((int32_t *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = sle32(leq_arg0_128974, leq_arg1_128969);
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        int32_t loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127218);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127291 + i_128955;
                            int32_t tmp_128985 = ((int32_t *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127241);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127218 + j_128958;
                            int64_t slice_128992 = start_127291 + slice_128991;
                            int32_t tmp_128993 = ((int32_t *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((int32_t *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133785 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133785, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133786 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133786, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240; i_133061++) {
                        int64_t split_count_arg3_127371 = mul64(merge_block_sizze_127104, i_133061);
                        int64_t defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127372, &defunc_0_split_count_res_127373, &defunc_0_split_count_res_127374, &defunc_0_split_count_res_127375, &defunc_0_split_count_res_127376, (int64_t) 0, stride_127218, (int64_t) 0, j_m_i_127241, split_count_arg3_127371) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127377 = slt64((int64_t) 0, defunc_0_split_count_res_127376);
                        bool defunc_0_split_count_res_127378;
                        int64_t defunc_0_split_count_res_127379;
                        int64_t defunc_0_split_count_res_127380;
                        int64_t defunc_0_split_count_res_127381;
                        int64_t defunc_0_split_count_res_127382;
                        int64_t defunc_0_split_count_res_127383;
                        bool loop_while_127384;
                        int64_t ss_127385;
                        int64_t ss_127386;
                        int64_t tt_127387;
                        int64_t tt_127388;
                        int64_t count_127389;
                        
                        loop_while_127384 = loop_cond_127377;
                        ss_127385 = defunc_0_split_count_res_127372;
                        ss_127386 = defunc_0_split_count_res_127373;
                        tt_127387 = defunc_0_split_count_res_127374;
                        tt_127388 = defunc_0_split_count_res_127375;
                        count_127389 = defunc_0_split_count_res_127376;
                        while (loop_while_127384) {
                            int64_t zlze_lhs_127390 = sub64(ss_127386, ss_127385);
                            bool cond_127391 = sle64(zlze_lhs_127390, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127392;
                            int64_t defunc_0_lifted_step_res_127393;
                            int64_t defunc_0_lifted_step_res_127394;
                            int64_t defunc_0_lifted_step_res_127395;
                            
                            if (cond_127391) {
                                int64_t tmp_128997 = add64(tt_127387, count_127389);
                                
                                defunc_0_lifted_step_res_127392 = ss_127385;
                                defunc_0_lifted_step_res_127393 = tmp_128997;
                                defunc_0_lifted_step_res_127394 = tt_127388;
                                defunc_0_lifted_step_res_127395 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127397 = sub64(tt_127388, tt_127387);
                                bool cond_127398 = sle64(zlze_lhs_127397, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127399;
                                int64_t defunc_0_lifted_step_res_f_res_127400;
                                int64_t defunc_0_lifted_step_res_f_res_127401;
                                int64_t defunc_0_lifted_step_res_f_res_127402;
                                
                                if (cond_127398) {
                                    int64_t tmp_128998 = add64(ss_127385, count_127389);
                                    
                                    defunc_0_lifted_step_res_f_res_127399 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127400 = tt_127387;
                                    defunc_0_lifted_step_res_f_res_127401 = tt_127388;
                                    defunc_0_lifted_step_res_f_res_127402 = (int64_t) 0;
                                } else {
                                    bool cond_127404 = count_127389 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127405;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127406;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127407;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127408;
                                    
                                    if (cond_127404) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127385);
                                        bool y_129001 = slt64(ss_127385, stride_127218);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127385, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127387);
                                        bool y_129007 = slt64(tt_127387, j_m_i_127241);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127387, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127291 + ss_127385;
                                        int32_t leq_arg1_129005 = ((int32_t *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127218 + tt_127387;
                                        int64_t slice_129011 = start_127291 + slice_129010;
                                        int32_t leq_arg0_129012 = ((int32_t *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = sle32(leq_arg0_129012, leq_arg1_129005);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127387);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127385;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127385);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127387;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = tt_127388;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = (int64_t) 0;
                                    } else {
                                        int64_t m_127427 = sdiv64(count_127389, (int64_t) 2);
                                        int64_t n_127428 = sub64(count_127389, m_127427);
                                        bool cond_127429 = n_127428 == (int64_t) 0;
                                        int64_t zgze_lhs_127430 = add64(ss_127385, m_127427);
                                        bool cond_f_res_127431 = sle64(ss_127386, zgze_lhs_127430);
                                        bool x_127432 = !cond_127429;
                                        bool y_127433 = cond_f_res_127431 && x_127432;
                                        bool cond_127434 = cond_127429 || y_127433;
                                        bool leq_y_x_127435;
                                        
                                        if (cond_127434) {
                                            leq_y_x_127435 = 1;
                                        } else {
                                            bool x_127436 = sle64((int64_t) 0, zgze_lhs_127430);
                                            bool y_127437 = slt64(zgze_lhs_127430, stride_127218);
                                            bool bounds_check_127438 = x_127436 && y_127437;
                                            bool index_certs_127439;
                                            
                                            if (!bounds_check_127438) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127430, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127442 = add64(tt_127387, n_127428);
                                            int64_t leq_arg0_127443 = sub64(zm_lhs_127442, (int64_t) 1);
                                            bool x_127444 = sle64((int64_t) 0, leq_arg0_127443);
                                            bool y_127445 = slt64(leq_arg0_127443, j_m_i_127241);
                                            bool bounds_check_127446 = x_127444 && y_127445;
                                            bool index_certs_127447;
                                            
                                            if (!bounds_check_127446) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127443, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127440 = start_127291 + zgze_lhs_127430;
                                            int32_t leq_arg1_127441 = ((int32_t *) mem_param_133257.mem)[slice_127440];
                                            int64_t slice_127448 = stride_127218 + leq_arg0_127443;
                                            int64_t slice_127449 = start_127291 + slice_127448;
                                            int32_t leq_arg0_127450 = ((int32_t *) mem_param_133257.mem)[slice_127449];
                                            bool defunc_0_leq_res_127451 = sle32(leq_arg0_127450, leq_arg1_127441);
                                            
                                            leq_y_x_127435 = defunc_0_leq_res_127451;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                        
                                        if (leq_y_x_127435) {
                                            int64_t tmp_129018 = add64(tt_127387, n_127428);
                                            int64_t tmp_129019 = sub64(count_127389, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tt_127388;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = tmp_129019;
                                        } else {
                                            int64_t tmp_127457 = add64(tt_127387, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tt_127387;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tmp_127457;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = count_127389;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = ss_127385;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                    }
                                    defunc_0_lifted_step_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_127405;
                                    defunc_0_lifted_step_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_127406;
                                    defunc_0_lifted_step_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_127407;
                                    defunc_0_lifted_step_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_127408;
                                }
                                defunc_0_lifted_step_res_127392 = defunc_0_lifted_step_res_f_res_127399;
                                defunc_0_lifted_step_res_127393 = defunc_0_lifted_step_res_f_res_127400;
                                defunc_0_lifted_step_res_127394 = defunc_0_lifted_step_res_f_res_127401;
                                defunc_0_lifted_step_res_127395 = defunc_0_lifted_step_res_f_res_127402;
                            }
                            
                            int64_t loopres_127458;
                            int64_t loopres_127459;
                            int64_t loopres_127460;
                            int64_t loopres_127461;
                            int64_t loopres_127462;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127458, &loopres_127459, &loopres_127460, &loopres_127461, &loopres_127462, defunc_0_lifted_step_res_127392, ss_127386, defunc_0_lifted_step_res_127393, defunc_0_lifted_step_res_127394, defunc_0_lifted_step_res_127395) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127463 = slt64((int64_t) 0, loopres_127462);
                            bool loop_while_tmp_133547 = loop_cond_127463;
                            int64_t ss_tmp_133548 = loopres_127458;
                            int64_t ss_tmp_133549 = loopres_127459;
                            int64_t tt_tmp_133550 = loopres_127460;
                            int64_t tt_tmp_133551 = loopres_127461;
                            int64_t count_tmp_133552 = loopres_127462;
                            
                            loop_while_127384 = loop_while_tmp_133547;
                            ss_127385 = ss_tmp_133548;
                            ss_127386 = ss_tmp_133549;
                            tt_127387 = tt_tmp_133550;
                            tt_127388 = tt_tmp_133551;
                            count_127389 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127378 = loop_while_127384;
                        defunc_0_split_count_res_127379 = ss_127385;
                        defunc_0_split_count_res_127380 = ss_127386;
                        defunc_0_split_count_res_127381 = tt_127387;
                        defunc_0_split_count_res_127382 = tt_127388;
                        defunc_0_split_count_res_127383 = count_127389;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127379;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127381;
                    }
                    if (mem_133293_cached_sizze_133787 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133787, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133788 < bytes_133295) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133788, bytes_133295);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127239; i_133068++) {
                        bool y_127469 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool index_certs_127471;
                        
                        if (!y_127469) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127472 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127474 = add64((int64_t) 1, i_133068);
                        bool x_127475 = sle64((int64_t) 0, tmp_127474);
                        bool y_127476 = slt64(tmp_127474, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool bounds_check_127477 = x_127475 && y_127476;
                        bool index_certs_127478;
                        
                        if (!bounds_check_127477) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127474, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127479 = ((int64_t *) mem_133276)[tmp_127474];
                        int64_t defunc_0_f_res_127480 = ((int64_t *) mem_133278)[tmp_127474];
                        int64_t merge_sequential_arg2_127481 = add64(stride_127218, defunc_0_f_res_127473);
                        int64_t merge_sequential_arg2_127482 = add64(stride_127218, defunc_0_f_res_127480);
                        int64_t j_m_i_127483 = sub64(merge_sequential_arg2_127482, merge_sequential_arg2_127481);
                        bool empty_slice_127484 = j_m_i_127483 == (int64_t) 0;
                        int64_t m_127485 = sub64(j_m_i_127483, (int64_t) 1);
                        int64_t i_p_m_t_s_127486 = add64(merge_sequential_arg2_127481, m_127485);
                        bool zzero_leq_i_p_m_t_s_127487 = sle64((int64_t) 0, i_p_m_t_s_127486);
                        bool i_p_m_t_s_leq_w_127488 = slt64(i_p_m_t_s_127486, next_stride_127219);
                        bool zzero_lte_i_127489 = sle64((int64_t) 0, merge_sequential_arg2_127481);
                        bool i_lte_j_127490 = sle64(merge_sequential_arg2_127481, merge_sequential_arg2_127482);
                        bool y_127491 = i_p_m_t_s_leq_w_127488 && zzero_lte_i_127489;
                        bool y_127492 = zzero_leq_i_p_m_t_s_127487 && y_127491;
                        bool forwards_ok_127493 = i_lte_j_127490 && y_127492;
                        bool ok_or_empty_127494 = empty_slice_127484 || forwards_ok_127493;
                        bool index_certs_127495;
                        
                        if (!ok_or_empty_127494) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127481, ":", (long long) merge_sequential_arg2_127482, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127496 = sub64(defunc_0_f_res_127479, defunc_0_f_res_127472);
                        bool empty_slice_127497 = j_m_i_127496 == (int64_t) 0;
                        int64_t m_127498 = sub64(j_m_i_127496, (int64_t) 1);
                        int64_t i_p_m_t_s_127499 = add64(defunc_0_f_res_127472, m_127498);
                        bool zzero_leq_i_p_m_t_s_127500 = sle64((int64_t) 0, i_p_m_t_s_127499);
                        bool i_p_m_t_s_leq_w_127501 = slt64(i_p_m_t_s_127499, next_stride_127219);
                        bool zzero_lte_i_127502 = sle64((int64_t) 0, defunc_0_f_res_127472);
                        bool i_lte_j_127503 = sle64(defunc_0_f_res_127472, defunc_0_f_res_127479);
                        bool y_127504 = i_p_m_t_s_leq_w_127501 && zzero_lte_i_127502;
                        bool y_127505 = zzero_leq_i_p_m_t_s_127500 && y_127504;
                        bool forwards_ok_127506 = i_lte_j_127503 && y_127505;
                        bool ok_or_empty_127507 = empty_slice_127497 || forwards_ok_127506;
                        bool index_certs_127508;
                        
                        if (!ok_or_empty_127507) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127472, ":", (long long) defunc_0_f_res_127479, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127509 = slt64((int64_t) 0, j_m_i_127496);
                        int32_t dummy_127510;
                        int64_t dummy_127511;
                        
                        if (cond_127509) {
                            bool index_certs_129020;
                            
                            if (!cond_127509) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:137:35-39\n   #12 ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127291 + defunc_0_f_res_127472;
                            int32_t head_res_129022 = ((int32_t *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127510 = head_res_129022;
                            dummy_127511 = head_res_129023;
                        } else {
                            bool y_127516 = slt64((int64_t) 0, j_m_i_127483);
                            bool index_certs_127517;
                            
                            if (!y_127516) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:137:35-39\n   #12 ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127518 = start_127291 + merge_sequential_arg2_127481;
                            int32_t head_res_127519 = ((int32_t *) mem_param_133257.mem)[slice_127518];
                            int64_t head_res_127520 = ((int64_t *) mem_param_133260.mem)[slice_127518];
                            
                            dummy_127510 = head_res_127519;
                            dummy_127511 = head_res_127520;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127104; nest_i_133555++) {
                            ((int32_t *) mem_133293)[i_133068 * merge_block_sizze_127104 + nest_i_133555] = dummy_127510;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127104; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + nest_i_133556] = dummy_127511;
                        }
                        
                        int64_t data_127523;
                        int64_t i_127527 = (int64_t) 0;
                        
                        for (int64_t k_127526 = 0; k_127526 < merge_block_sizze_127104; k_127526++) {
                            int64_t j_127530 = sub64(k_127526, i_127527);
                            bool cond_127531 = j_127530 == j_m_i_127483;
                            bool cond_127532;
                            
                            if (cond_127531) {
                                cond_127532 = 1;
                            } else {
                                bool cond_127533 = slt64(i_127527, j_m_i_127496);
                                bool cond_f_res_127534;
                                
                                if (cond_127533) {
                                    bool x_129024 = sle64((int64_t) 0, j_127530);
                                    bool y_129025 = slt64(j_127530, j_m_i_127483);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127527);
                                    bool bounds_check_129032 = cond_127533 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127481 + j_127530;
                                    int64_t slice_129029 = start_127291 + slice_129028;
                                    int32_t leq_arg1_129030 = ((int32_t *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127472 + i_127527;
                                    int64_t slice_129035 = start_127291 + slice_129034;
                                    int32_t leq_arg0_129036 = ((int32_t *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = sle32(leq_arg0_129036, leq_arg1_129030);
                                    
                                    cond_f_res_127534 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127534 = 0;
                                }
                                cond_127532 = cond_f_res_127534;
                            }
                            
                            int64_t loopres_127549;
                            int32_t loopres_127550;
                            int64_t loopres_127551;
                            
                            if (cond_127532) {
                                bool x_129039 = sle64((int64_t) 0, i_127527);
                                bool y_129040 = slt64(i_127527, j_m_i_127496);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127527);
                                int64_t slice_129043 = defunc_0_f_res_127472 + i_127527;
                                int64_t slice_129044 = start_127291 + slice_129043;
                                int32_t tmp_129045 = ((int32_t *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127549 = tmp_129038;
                                loopres_127550 = tmp_129045;
                                loopres_127551 = tmp_129046;
                            } else {
                                bool x_127561 = sle64((int64_t) 0, j_127530);
                                bool y_127562 = slt64(j_127530, j_m_i_127483);
                                bool bounds_check_127563 = x_127561 && y_127562;
                                bool index_certs_127564;
                                
                                if (!bounds_check_127563) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127565 = merge_sequential_arg2_127481 + j_127530;
                                int64_t slice_127566 = start_127291 + slice_127565;
                                int32_t tmp_127567 = ((int32_t *) mem_param_133257.mem)[slice_127566];
                                int64_t tmp_127568 = ((int64_t *) mem_param_133260.mem)[slice_127566];
                                
                                loopres_127549 = i_127527;
                                loopres_127550 = tmp_127567;
                                loopres_127551 = tmp_127568;
                            }
                            ((int32_t *) mem_133293)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127550;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127551;
                            
                            int64_t i_tmp_133557 = loopres_127549;
                            
                            i_127527 = i_tmp_133557;
                        }
                        data_127523 = i_127527;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint32_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133295, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_133263, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127575 = next_stride_127219 * num_merges_127223;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint32_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            if (memblock_alloc(ctx, &mem_133373, bytes_133265, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            
            bool loop_cond_127578 = slt64(next_stride_127219, flat_dim_127100);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127575;
            bool loop_while_tmp_133534 = loop_cond_127578;
            int64_t stride_tmp_133537 = next_stride_127219;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127214 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127215 = loop_while_tmp_133534;
            stride_127218 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127209 = loop_dz2084Uz2082U_127214;
        data_127210 = loop_while_127215;
        data_127213 = stride_127218;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127579 = n_93070 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127580 = sle64((int64_t) 0, zs_lhs_127084);
        bool i_p_m_t_s_leq_w_127581 = slt64(zs_lhs_127084, data_127209);
        bool y_127582 = zzero_leq_i_p_m_t_s_127580 && i_p_m_t_s_leq_w_127581;
        bool ok_or_empty_127583 = empty_slice_127579 || y_127582;
        bool index_certs_127584;
        
        if (!ok_or_empty_127583) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_93070, "] out of bounds for array of shape [", (long long) data_127209, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:137:35-39\n   #6  ftRelational.fut:136:9-137:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_93070; i_133082++) {
        int64_t eta_p_127592 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127593 = sle64((int64_t) 0, eta_p_127592);
        bool y_127594 = slt64(eta_p_127592, n_93070);
        bool bounds_check_127595 = x_127593 && y_127594;
        bool index_certs_127596;
        
        if (!bounds_check_127595) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127592, "] out of bounds for array of shape [", (long long) n_93070, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_127597 = ((int64_t *) ext_mem_133176.mem)[eta_p_127592];
        int32_t lifted_lambda_res_127598 = ((int32_t *) xs_mem_133175.mem)[eta_p_127592];
        
        ((int64_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127597;
        ((int32_t *) mem_133387.mem)[i_133082] = lifted_lambda_res_127598;
    }
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133777, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133778, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_133789, struct memblock *mem_out_p_133790, struct memblock xs_mem_133175, int64_t n_95211, int64_t incr_95212)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133791 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133792 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133793 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133794 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133795 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133796 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133797 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133798 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133799 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133800 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_95211;
    bool cond_127083 = sle64(n_95211, (int64_t) 1);
    int64_t zs_lhs_127084 = sub64(n_95211, (int64_t) 1);
    int64_t zp_rhs_127085 = sdiv_safe64(zs_lhs_127084, (int64_t) 20);
    int64_t min_num_blocks_127086 = add64((int64_t) 1, zp_rhs_127085);
    bool loop_cond_127087 = slt64((int64_t) 1, min_num_blocks_127086);
    bool smallest_pow_2_geq_than_res_127088;
    int64_t smallest_pow_2_geq_than_res_127089;
    bool loop_while_127090;
    int64_t x_127091;
    
    loop_while_127090 = loop_cond_127087;
    x_127091 = (int64_t) 1;
    while (loop_while_127090) {
        int64_t loopres_127092 = mul64((int64_t) 2, x_127091);
        bool loop_cond_127093 = slt64(loopres_127092, min_num_blocks_127086);
        bool loop_while_tmp_133515 = loop_cond_127093;
        int64_t x_tmp_133516 = loopres_127092;
        
        loop_while_127090 = loop_while_tmp_133515;
        x_127091 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127088 = loop_while_127090;
    smallest_pow_2_geq_than_res_127089 = x_127091;
    
    bool zzero_127094 = smallest_pow_2_geq_than_res_127089 == (int64_t) 0;
    bool nonzzero_127095 = !zzero_127094;
    bool protect_assert_disj_127096 = cond_127083 || nonzzero_127095;
    bool nonzzero_cert_127097;
    
    if (!protect_assert_disj_127096) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127098 = sdiv_safe64(zs_lhs_127084, smallest_pow_2_geq_than_res_127089);
    int64_t block_sizze_127099 = add64((int64_t) 1, zp_rhs_127098);
    bool y_127105 = slt64((int64_t) 0, n_95211);
    bool protect_assert_disj_133419 = cond_127083 || y_127105;
    bool index_certs_127106;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_95211, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127120 = slt64(smallest_pow_2_geq_than_res_127089, (int64_t) 0);
    bool valid_127121 = !bounds_invalid_upwards_127120;
    bool protect_assert_disj_133427 = cond_127083 || valid_127121;
    bool range_valid_c_127122;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127089, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:139:35-39\n   #6  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127124 = slt64(block_sizze_127099, (int64_t) 0);
    bool valid_127125 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_133429 = cond_127083 || valid_127125;
    bool range_valid_c_127126;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127099, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127128 = sle64(block_sizze_127099, (int64_t) 1);
    int64_t tmp_127129 = sub64(block_sizze_127099, (int64_t) 2);
    bool bounds_invalid_upwards_127130 = slt64(tmp_127129, (int64_t) 0);
    bool valid_127132 = !bounds_invalid_upwards_127130;
    bool protect_assert_disj_127133 = cond_127128 || valid_127132;
    bool protect_assert_disj_133431 = cond_127083 || protect_assert_disj_127133;
    bool range_valid_c_127134;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127129, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_11416(ctx, &ext_mem_133176, xs_mem_133175, n_95211, incr_95212) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_95211; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127100 = smallest_pow_2_geq_than_res_127089 * block_sizze_127099;
    bool x_133414 = !cond_127083;
    int64_t greatest_divisor_leq_than_arg1_127103 = mul64((int64_t) 2, block_sizze_127099);
    int64_t merge_block_sizze_127104;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127103) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127104 = x_133416;
    } else {
        merge_block_sizze_127104 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_127107;
    
    if (x_133414) {
        int64_t x_133420 = ((int64_t *) xs_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127107 = x_133420;
    } else {
        reduce_arg1_127107 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        int64_t x_133422;
        int64_t x_133423;
        int64_t redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127107;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_95211; i_133042++) {
            int64_t x_127111 = ((int64_t *) xs_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127117 = sle64(redout_133040, x_127111);
            int64_t defunc_0_op_res_127118;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127118 = x_127111;
            } else {
                defunc_0_op_res_127118 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127119;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127119 = i_133042;
            } else {
                defunc_0_op_res_127119 = redout_133041;
            }
            
            int64_t redout_tmp_133519 = defunc_0_op_res_127118;
            int64_t redout_tmp_133520 = defunc_0_op_res_127119;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = (int64_t) 0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127131 = add64((int64_t) 1, tmp_127129);
    int64_t binop_x_133179 = (int64_t) 8 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133180 = block_sizze_127099 * binop_x_133179;
    int64_t bytes_133193 = (int64_t) 8 * block_sizze_127099;
    bool loop_cond_127206 = slt64(block_sizze_127099, flat_dim_127100);
    bool zzero_127207 = merge_block_sizze_127104 == (int64_t) 0;
    bool nonzzero_127208 = !zzero_127207;
    
    if (cond_127083) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133791 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133791, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133792 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133792, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133793 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133793, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133794 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133794, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127089; i_133054++) {
            int64_t zp_lhs_127138 = mul64(block_sizze_127099, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127099; i_133047++) {
                int64_t k_127142 = add64(zp_lhs_127138, i_133047);
                bool cond_127143 = slt64(k_127142, n_95211);
                int64_t lifted_lambda_res_127144;
                int64_t lifted_lambda_res_127145;
                
                if (cond_127143) {
                    bool x_128906 = sle64((int64_t) 0, k_127142);
                    bool bounds_check_128907 = cond_127143 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127142, "] out of bounds for array of shape [", (long long) n_95211, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_128909 = ((int64_t *) xs_mem_133175.mem)[k_127142];
                    
                    lifted_lambda_res_127144 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127145 = k_127142;
                } else {
                    lifted_lambda_res_127144 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127145 = defunc_0_reduce_res_129054;
                }
                ((int64_t *) mem_133194)[i_133047] = lifted_lambda_res_127144;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127145;
            }
            if (!cond_127128) {
                for (int64_t i_127155 = 0; i_127155 < distance_127131; i_127155++) {
                    int64_t gt_arg1_127158 = add64((int64_t) 1, i_127155);
                    bool x_127159 = sle64((int64_t) 0, gt_arg1_127158);
                    bool y_127160 = slt64(gt_arg1_127158, block_sizze_127099);
                    bool bounds_check_127161 = x_127159 && y_127160;
                    bool index_certs_127162;
                    
                    if (!bounds_check_127161) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127158, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127164 = slt64(i_127155, block_sizze_127099);
                    bool index_certs_127165;
                    
                    if (!y_127164) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127155, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_127163 = ((int64_t *) mem_133194)[gt_arg1_127158];
                    int64_t gt_arg0_127166 = ((int64_t *) mem_133194)[i_127155];
                    bool defunc_0_leq_res_127167 = sle64(gt_arg0_127166, gt_arg1_127163);
                    bool defunc_0_lifted_gt_res_127168 = !defunc_0_leq_res_127167;
                    bool s_127169;
                    int64_t s_127172;
                    bool loop_while_127173;
                    int64_t j_127176;
                    
                    loop_while_127173 = defunc_0_lifted_gt_res_127168;
                    j_127176 = i_127155;
                    while (loop_while_127173) {
                        bool x_127177 = sle64((int64_t) 0, j_127176);
                        bool y_127178 = slt64(j_127176, block_sizze_127099);
                        bool bounds_check_127179 = x_127177 && y_127178;
                        bool index_certs_127180;
                        
                        if (!bounds_check_127179) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127176, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127183 = add64((int64_t) 1, j_127176);
                        bool x_127184 = sle64((int64_t) 0, copy_arg0_127183);
                        bool y_127185 = slt64(copy_arg0_127183, block_sizze_127099);
                        bool bounds_check_127186 = x_127184 && y_127185;
                        bool index_certs_127187;
                        
                        if (!bounds_check_127186) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127183, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127181 = ((int64_t *) mem_133194)[j_127176];
                        int64_t copy_arg0_127182 = ((int64_t *) mem_133196)[j_127176];
                        int64_t copy_arg0_127188 = ((int64_t *) mem_133194)[copy_arg0_127183];
                        int64_t copy_arg0_127189 = ((int64_t *) mem_133196)[copy_arg0_127183];
                        
                        ((int64_t *) mem_133194)[j_127176] = copy_arg0_127188;
                        ((int64_t *) mem_133196)[j_127176] = copy_arg0_127189;
                        ((int64_t *) mem_133194)[copy_arg0_127183] = copy_arg0_127181;
                        ((int64_t *) mem_133196)[copy_arg0_127183] = copy_arg0_127182;
                        
                        int64_t tmp_127194 = sub64(j_127176, (int64_t) 1);
                        bool cond_127195 = sle64((int64_t) 0, tmp_127194);
                        bool loop_cond_127196;
                        
                        if (cond_127195) {
                            bool y_128911 = slt64(tmp_127194, block_sizze_127099);
                            bool bounds_check_128912 = cond_127195 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127194, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_128910 = ((int64_t *) mem_133194)[j_127176];
                            int64_t gt_arg0_128914 = ((int64_t *) mem_133194)[tmp_127194];
                            bool defunc_0_leq_res_128915 = sle64(gt_arg0_128914, gt_arg1_128910);
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127196 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127196 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127196;
                        int64_t j_tmp_133530 = tmp_127194;
                        
                        loop_while_127173 = loop_while_tmp_133527;
                        j_127176 = j_tmp_133530;
                    }
                    s_127169 = loop_while_127173;
                    s_127172 = j_127176;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133181, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        if (memblock_alloc(ctx, &mem_133253, bytes_133180, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        
        int64_t data_127209;
        bool data_127210;
        int64_t data_127213;
        int64_t loop_dz2084Uz2082U_127214;
        bool loop_while_127215;
        int64_t stride_127218;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127214 = flat_dim_127100;
        loop_while_127215 = loop_cond_127206;
        stride_127218 = block_sizze_127099;
        while (loop_while_127215) {
            int64_t next_stride_127219 = mul64((int64_t) 2, stride_127218);
            bool zzero_127220 = next_stride_127219 == (int64_t) 0;
            bool nonzzero_127221 = !zzero_127220;
            bool nonzzero_cert_127222;
            
            if (!nonzzero_127221) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127223 = sdiv64(flat_dim_127100, next_stride_127219);
            bool bounds_invalid_upwards_127224 = slt64(num_merges_127223, (int64_t) 0);
            bool valid_127225 = !bounds_invalid_upwards_127224;
            bool range_valid_c_127226;
            
            if (!valid_127225) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127223, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:139:35-39\n   #6  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127228 = sub64(next_stride_127219, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127229 = sle64((int64_t) 0, m_127228);
            bool cond_127231 = slt64(next_stride_127219, (int64_t) 10);
            bool protect_assert_disj_127232 = nonzzero_127208 || cond_127231;
            bool nonzzero_cert_127233;
            
            if (!protect_assert_disj_127232) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127234 = smod_safe64(next_stride_127219, merge_block_sizze_127104);
            bool num_blocks_127235 = zeze_lhs_127234 == (int64_t) 0;
            bool protect_assert_disj_127236 = cond_127231 || num_blocks_127235;
            bool assert_c_127237;
            
            if (!protect_assert_disj_127236) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127239 = sdiv_safe64(next_stride_127219, merge_block_sizze_127104);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240 = add64((int64_t) 1, num_blocks_127239);
            int64_t j_m_i_127241 = sub64(next_stride_127219, stride_127218);
            int64_t flat_dim_127242 = merge_block_sizze_127104 * num_blocks_127239;
            bool bounds_invalid_upwards_127243 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, (int64_t) 0);
            bool empty_slice_127244 = j_m_i_127241 == (int64_t) 0;
            int64_t m_127245 = sub64(j_m_i_127241, (int64_t) 1);
            bool zzero_lte_i_127246 = sle64((int64_t) 0, stride_127218);
            bool i_lte_j_127247 = sle64(stride_127218, next_stride_127219);
            bool empty_slice_127248 = stride_127218 == (int64_t) 0;
            int64_t m_127249 = sub64(stride_127218, (int64_t) 1);
            bool bounds_invalid_upwards_127250 = slt64(num_blocks_127239, (int64_t) 0);
            bool cond_127251 = slt64((int64_t) 0, stride_127218);
            bool valid_127252 = !bounds_invalid_upwards_127243;
            int64_t i_p_m_t_s_127253 = add64(stride_127218, m_127245);
            bool zzero_leq_i_p_m_t_s_127254 = sle64((int64_t) 0, m_127249);
            bool i_p_m_t_s_leq_w_127255 = slt64(m_127249, next_stride_127219);
            bool valid_127256 = !bounds_invalid_upwards_127250;
            bool i_p_m_t_s_leq_w_127257 = slt64(m_127228, flat_dim_127242);
            bool y_127258 = slt64((int64_t) 0, j_m_i_127241);
            bool protect_assert_disj_127259 = cond_127231 || valid_127252;
            bool range_valid_c_127260;
            
            if (!protect_assert_disj_127259) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127261 = sle64((int64_t) 0, i_p_m_t_s_127253);
            bool i_p_m_t_s_leq_w_127262 = slt64(i_p_m_t_s_127253, next_stride_127219);
            bool y_127263 = zzero_leq_i_p_m_t_s_127254 && i_p_m_t_s_leq_w_127255;
            bool protect_assert_disj_127264 = cond_127231 || valid_127256;
            bool range_valid_c_127265;
            
            if (!protect_assert_disj_127264) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127266 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127257;
            bool y_127267 = zzero_lte_i_127246 && i_p_m_t_s_leq_w_127262;
            bool forwards_ok_127268 = zzero_lte_i_127246 && y_127263;
            bool ok_or_empty_127269 = zzero_127220 || y_127266;
            bool protect_assert_disj_127270 = cond_127251 || y_127258;
            bool y_127271 = zzero_leq_i_p_m_t_s_127261 && y_127267;
            bool ok_or_empty_127272 = empty_slice_127248 || forwards_ok_127268;
            bool protect_assert_disj_127273 = cond_127231 || ok_or_empty_127269;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) flat_dim_127242, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127275 = !cond_127231;
            bool protect_assert_disj_127276 = protect_assert_disj_127270 || loop_not_taken_127275;
            bool index_certs_127277;
            
            if (!protect_assert_disj_127276) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127278 = i_lte_j_127247 && y_127271;
            bool protect_assert_disj_127279 = cond_127231 || ok_or_empty_127272;
            bool index_certs_127280;
            
            if (!protect_assert_disj_127279) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127281 = ok_or_empty_127272 || loop_not_taken_127275;
            bool index_certs_127282;
            
            if (!protect_assert_disj_127281) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127283 = empty_slice_127244 || forwards_ok_127278;
            bool protect_assert_disj_127284 = cond_127231 || ok_or_empty_127283;
            bool index_certs_127285;
            
            if (!protect_assert_disj_127284) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127286 = loop_not_taken_127275 || ok_or_empty_127283;
            bool index_certs_127287;
            
            if (!protect_assert_disj_127286) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 8 * num_merges_127223;
            int64_t bytes_133262 = next_stride_127219 * binop_x_133261;
            bool i_lte_j_127230 = sle64((int64_t) 0, next_stride_127219);
            
            if (mem_133263_cached_sizze_133795 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133795, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133796 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133796, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240;
            int64_t binop_x_133291 = (int64_t) 8 * num_blocks_127239;
            int64_t bytes_133292 = merge_block_sizze_127104 * binop_x_133291;
            int64_t bytes_133337 = (int64_t) 16 * stride_127218;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127223; i_133075++) {
                int64_t start_127291 = mul64(next_stride_127219, i_133075);
                int64_t j_m_i_127292 = sub64(loop_dz2084Uz2082U_127214, start_127291);
                bool empty_slice_127293 = j_m_i_127292 == (int64_t) 0;
                int64_t m_127294 = sub64(j_m_i_127292, (int64_t) 1);
                int64_t i_p_m_t_s_127295 = add64(start_127291, m_127294);
                bool zzero_leq_i_p_m_t_s_127296 = sle64((int64_t) 0, i_p_m_t_s_127295);
                bool i_p_m_t_s_leq_w_127297 = slt64(i_p_m_t_s_127295, loop_dz2084Uz2082U_127214);
                bool zzero_lte_i_127298 = sle64((int64_t) 0, start_127291);
                bool i_lte_j_127299 = sle64(start_127291, loop_dz2084Uz2082U_127214);
                bool y_127300 = i_p_m_t_s_leq_w_127297 && zzero_lte_i_127298;
                bool y_127301 = zzero_leq_i_p_m_t_s_127296 && y_127300;
                bool forwards_ok_127302 = i_lte_j_127299 && y_127301;
                bool ok_or_empty_127303 = empty_slice_127293 || forwards_ok_127302;
                bool index_certs_127304;
                
                if (!ok_or_empty_127303) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127291, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127214, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127305 = slt64(m_127228, j_m_i_127292);
                bool y_127306 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127305;
                bool forwards_ok_127307 = i_lte_j_127230 && y_127306;
                bool ok_or_empty_127308 = zzero_127220 || forwards_ok_127307;
                bool index_certs_127309;
                
                if (!ok_or_empty_127308) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) j_m_i_127292, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127231) {
                    int64_t dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127251) {
                        int64_t head_res_128944 = ((int64_t *) mem_param_133257.mem)[start_127291];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127291];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127218 + start_127291;
                        int64_t head_res_128947 = ((int64_t *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127219; nest_i_133540++) {
                        ((int64_t *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133337, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127219; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127219; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127241;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127218);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127241);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127218 + j_128958;
                                int64_t slice_128968 = start_127291 + slice_128967;
                                int64_t leq_arg1_128969 = ((int64_t *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127291 + i_128955;
                                int64_t leq_arg0_128974 = ((int64_t *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = sle64(leq_arg0_128974, leq_arg1_128969);
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        int64_t loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127218);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127291 + i_128955;
                            int64_t tmp_128985 = ((int64_t *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127241);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127218 + j_128958;
                            int64_t slice_128992 = start_127291 + slice_128991;
                            int64_t tmp_128993 = ((int64_t *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((int64_t *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133797 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133797, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133798 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133798, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240; i_133061++) {
                        int64_t split_count_arg3_127371 = mul64(merge_block_sizze_127104, i_133061);
                        int64_t defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127372, &defunc_0_split_count_res_127373, &defunc_0_split_count_res_127374, &defunc_0_split_count_res_127375, &defunc_0_split_count_res_127376, (int64_t) 0, stride_127218, (int64_t) 0, j_m_i_127241, split_count_arg3_127371) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127377 = slt64((int64_t) 0, defunc_0_split_count_res_127376);
                        bool defunc_0_split_count_res_127378;
                        int64_t defunc_0_split_count_res_127379;
                        int64_t defunc_0_split_count_res_127380;
                        int64_t defunc_0_split_count_res_127381;
                        int64_t defunc_0_split_count_res_127382;
                        int64_t defunc_0_split_count_res_127383;
                        bool loop_while_127384;
                        int64_t ss_127385;
                        int64_t ss_127386;
                        int64_t tt_127387;
                        int64_t tt_127388;
                        int64_t count_127389;
                        
                        loop_while_127384 = loop_cond_127377;
                        ss_127385 = defunc_0_split_count_res_127372;
                        ss_127386 = defunc_0_split_count_res_127373;
                        tt_127387 = defunc_0_split_count_res_127374;
                        tt_127388 = defunc_0_split_count_res_127375;
                        count_127389 = defunc_0_split_count_res_127376;
                        while (loop_while_127384) {
                            int64_t zlze_lhs_127390 = sub64(ss_127386, ss_127385);
                            bool cond_127391 = sle64(zlze_lhs_127390, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127392;
                            int64_t defunc_0_lifted_step_res_127393;
                            int64_t defunc_0_lifted_step_res_127394;
                            int64_t defunc_0_lifted_step_res_127395;
                            
                            if (cond_127391) {
                                int64_t tmp_128997 = add64(tt_127387, count_127389);
                                
                                defunc_0_lifted_step_res_127392 = ss_127385;
                                defunc_0_lifted_step_res_127393 = tmp_128997;
                                defunc_0_lifted_step_res_127394 = tt_127388;
                                defunc_0_lifted_step_res_127395 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127397 = sub64(tt_127388, tt_127387);
                                bool cond_127398 = sle64(zlze_lhs_127397, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127399;
                                int64_t defunc_0_lifted_step_res_f_res_127400;
                                int64_t defunc_0_lifted_step_res_f_res_127401;
                                int64_t defunc_0_lifted_step_res_f_res_127402;
                                
                                if (cond_127398) {
                                    int64_t tmp_128998 = add64(ss_127385, count_127389);
                                    
                                    defunc_0_lifted_step_res_f_res_127399 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127400 = tt_127387;
                                    defunc_0_lifted_step_res_f_res_127401 = tt_127388;
                                    defunc_0_lifted_step_res_f_res_127402 = (int64_t) 0;
                                } else {
                                    bool cond_127404 = count_127389 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127405;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127406;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127407;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127408;
                                    
                                    if (cond_127404) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127385);
                                        bool y_129001 = slt64(ss_127385, stride_127218);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127385, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127387);
                                        bool y_129007 = slt64(tt_127387, j_m_i_127241);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127387, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127291 + ss_127385;
                                        int64_t leq_arg1_129005 = ((int64_t *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127218 + tt_127387;
                                        int64_t slice_129011 = start_127291 + slice_129010;
                                        int64_t leq_arg0_129012 = ((int64_t *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = sle64(leq_arg0_129012, leq_arg1_129005);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127387);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127385;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127385);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127387;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = tt_127388;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = (int64_t) 0;
                                    } else {
                                        int64_t m_127427 = sdiv64(count_127389, (int64_t) 2);
                                        int64_t n_127428 = sub64(count_127389, m_127427);
                                        bool cond_127429 = n_127428 == (int64_t) 0;
                                        int64_t zgze_lhs_127430 = add64(ss_127385, m_127427);
                                        bool cond_f_res_127431 = sle64(ss_127386, zgze_lhs_127430);
                                        bool x_127432 = !cond_127429;
                                        bool y_127433 = cond_f_res_127431 && x_127432;
                                        bool cond_127434 = cond_127429 || y_127433;
                                        bool leq_y_x_127435;
                                        
                                        if (cond_127434) {
                                            leq_y_x_127435 = 1;
                                        } else {
                                            bool x_127436 = sle64((int64_t) 0, zgze_lhs_127430);
                                            bool y_127437 = slt64(zgze_lhs_127430, stride_127218);
                                            bool bounds_check_127438 = x_127436 && y_127437;
                                            bool index_certs_127439;
                                            
                                            if (!bounds_check_127438) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127430, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127442 = add64(tt_127387, n_127428);
                                            int64_t leq_arg0_127443 = sub64(zm_lhs_127442, (int64_t) 1);
                                            bool x_127444 = sle64((int64_t) 0, leq_arg0_127443);
                                            bool y_127445 = slt64(leq_arg0_127443, j_m_i_127241);
                                            bool bounds_check_127446 = x_127444 && y_127445;
                                            bool index_certs_127447;
                                            
                                            if (!bounds_check_127446) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127443, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127440 = start_127291 + zgze_lhs_127430;
                                            int64_t leq_arg1_127441 = ((int64_t *) mem_param_133257.mem)[slice_127440];
                                            int64_t slice_127448 = stride_127218 + leq_arg0_127443;
                                            int64_t slice_127449 = start_127291 + slice_127448;
                                            int64_t leq_arg0_127450 = ((int64_t *) mem_param_133257.mem)[slice_127449];
                                            bool defunc_0_leq_res_127451 = sle64(leq_arg0_127450, leq_arg1_127441);
                                            
                                            leq_y_x_127435 = defunc_0_leq_res_127451;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                        
                                        if (leq_y_x_127435) {
                                            int64_t tmp_129018 = add64(tt_127387, n_127428);
                                            int64_t tmp_129019 = sub64(count_127389, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tt_127388;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = tmp_129019;
                                        } else {
                                            int64_t tmp_127457 = add64(tt_127387, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tt_127387;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tmp_127457;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = count_127389;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = ss_127385;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                    }
                                    defunc_0_lifted_step_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_127405;
                                    defunc_0_lifted_step_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_127406;
                                    defunc_0_lifted_step_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_127407;
                                    defunc_0_lifted_step_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_127408;
                                }
                                defunc_0_lifted_step_res_127392 = defunc_0_lifted_step_res_f_res_127399;
                                defunc_0_lifted_step_res_127393 = defunc_0_lifted_step_res_f_res_127400;
                                defunc_0_lifted_step_res_127394 = defunc_0_lifted_step_res_f_res_127401;
                                defunc_0_lifted_step_res_127395 = defunc_0_lifted_step_res_f_res_127402;
                            }
                            
                            int64_t loopres_127458;
                            int64_t loopres_127459;
                            int64_t loopres_127460;
                            int64_t loopres_127461;
                            int64_t loopres_127462;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127458, &loopres_127459, &loopres_127460, &loopres_127461, &loopres_127462, defunc_0_lifted_step_res_127392, ss_127386, defunc_0_lifted_step_res_127393, defunc_0_lifted_step_res_127394, defunc_0_lifted_step_res_127395) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127463 = slt64((int64_t) 0, loopres_127462);
                            bool loop_while_tmp_133547 = loop_cond_127463;
                            int64_t ss_tmp_133548 = loopres_127458;
                            int64_t ss_tmp_133549 = loopres_127459;
                            int64_t tt_tmp_133550 = loopres_127460;
                            int64_t tt_tmp_133551 = loopres_127461;
                            int64_t count_tmp_133552 = loopres_127462;
                            
                            loop_while_127384 = loop_while_tmp_133547;
                            ss_127385 = ss_tmp_133548;
                            ss_127386 = ss_tmp_133549;
                            tt_127387 = tt_tmp_133550;
                            tt_127388 = tt_tmp_133551;
                            count_127389 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127378 = loop_while_127384;
                        defunc_0_split_count_res_127379 = ss_127385;
                        defunc_0_split_count_res_127380 = ss_127386;
                        defunc_0_split_count_res_127381 = tt_127387;
                        defunc_0_split_count_res_127382 = tt_127388;
                        defunc_0_split_count_res_127383 = count_127389;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127379;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127381;
                    }
                    if (mem_133293_cached_sizze_133799 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133799, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133800 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133800, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127239; i_133068++) {
                        bool y_127469 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool index_certs_127471;
                        
                        if (!y_127469) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127472 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127474 = add64((int64_t) 1, i_133068);
                        bool x_127475 = sle64((int64_t) 0, tmp_127474);
                        bool y_127476 = slt64(tmp_127474, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool bounds_check_127477 = x_127475 && y_127476;
                        bool index_certs_127478;
                        
                        if (!bounds_check_127477) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127474, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127479 = ((int64_t *) mem_133276)[tmp_127474];
                        int64_t defunc_0_f_res_127480 = ((int64_t *) mem_133278)[tmp_127474];
                        int64_t merge_sequential_arg2_127481 = add64(stride_127218, defunc_0_f_res_127473);
                        int64_t merge_sequential_arg2_127482 = add64(stride_127218, defunc_0_f_res_127480);
                        int64_t j_m_i_127483 = sub64(merge_sequential_arg2_127482, merge_sequential_arg2_127481);
                        bool empty_slice_127484 = j_m_i_127483 == (int64_t) 0;
                        int64_t m_127485 = sub64(j_m_i_127483, (int64_t) 1);
                        int64_t i_p_m_t_s_127486 = add64(merge_sequential_arg2_127481, m_127485);
                        bool zzero_leq_i_p_m_t_s_127487 = sle64((int64_t) 0, i_p_m_t_s_127486);
                        bool i_p_m_t_s_leq_w_127488 = slt64(i_p_m_t_s_127486, next_stride_127219);
                        bool zzero_lte_i_127489 = sle64((int64_t) 0, merge_sequential_arg2_127481);
                        bool i_lte_j_127490 = sle64(merge_sequential_arg2_127481, merge_sequential_arg2_127482);
                        bool y_127491 = i_p_m_t_s_leq_w_127488 && zzero_lte_i_127489;
                        bool y_127492 = zzero_leq_i_p_m_t_s_127487 && y_127491;
                        bool forwards_ok_127493 = i_lte_j_127490 && y_127492;
                        bool ok_or_empty_127494 = empty_slice_127484 || forwards_ok_127493;
                        bool index_certs_127495;
                        
                        if (!ok_or_empty_127494) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127481, ":", (long long) merge_sequential_arg2_127482, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127496 = sub64(defunc_0_f_res_127479, defunc_0_f_res_127472);
                        bool empty_slice_127497 = j_m_i_127496 == (int64_t) 0;
                        int64_t m_127498 = sub64(j_m_i_127496, (int64_t) 1);
                        int64_t i_p_m_t_s_127499 = add64(defunc_0_f_res_127472, m_127498);
                        bool zzero_leq_i_p_m_t_s_127500 = sle64((int64_t) 0, i_p_m_t_s_127499);
                        bool i_p_m_t_s_leq_w_127501 = slt64(i_p_m_t_s_127499, next_stride_127219);
                        bool zzero_lte_i_127502 = sle64((int64_t) 0, defunc_0_f_res_127472);
                        bool i_lte_j_127503 = sle64(defunc_0_f_res_127472, defunc_0_f_res_127479);
                        bool y_127504 = i_p_m_t_s_leq_w_127501 && zzero_lte_i_127502;
                        bool y_127505 = zzero_leq_i_p_m_t_s_127500 && y_127504;
                        bool forwards_ok_127506 = i_lte_j_127503 && y_127505;
                        bool ok_or_empty_127507 = empty_slice_127497 || forwards_ok_127506;
                        bool index_certs_127508;
                        
                        if (!ok_or_empty_127507) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127472, ":", (long long) defunc_0_f_res_127479, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127509 = slt64((int64_t) 0, j_m_i_127496);
                        int64_t dummy_127510;
                        int64_t dummy_127511;
                        
                        if (cond_127509) {
                            bool index_certs_129020;
                            
                            if (!cond_127509) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:139:35-39\n   #12 ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127291 + defunc_0_f_res_127472;
                            int64_t head_res_129022 = ((int64_t *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127510 = head_res_129022;
                            dummy_127511 = head_res_129023;
                        } else {
                            bool y_127516 = slt64((int64_t) 0, j_m_i_127483);
                            bool index_certs_127517;
                            
                            if (!y_127516) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:139:35-39\n   #12 ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127518 = start_127291 + merge_sequential_arg2_127481;
                            int64_t head_res_127519 = ((int64_t *) mem_param_133257.mem)[slice_127518];
                            int64_t head_res_127520 = ((int64_t *) mem_param_133260.mem)[slice_127518];
                            
                            dummy_127510 = head_res_127519;
                            dummy_127511 = head_res_127520;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127104; nest_i_133555++) {
                            ((int64_t *) mem_133293)[i_133068 * merge_block_sizze_127104 + nest_i_133555] = dummy_127510;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127104; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + nest_i_133556] = dummy_127511;
                        }
                        
                        int64_t data_127523;
                        int64_t i_127527 = (int64_t) 0;
                        
                        for (int64_t k_127526 = 0; k_127526 < merge_block_sizze_127104; k_127526++) {
                            int64_t j_127530 = sub64(k_127526, i_127527);
                            bool cond_127531 = j_127530 == j_m_i_127483;
                            bool cond_127532;
                            
                            if (cond_127531) {
                                cond_127532 = 1;
                            } else {
                                bool cond_127533 = slt64(i_127527, j_m_i_127496);
                                bool cond_f_res_127534;
                                
                                if (cond_127533) {
                                    bool x_129024 = sle64((int64_t) 0, j_127530);
                                    bool y_129025 = slt64(j_127530, j_m_i_127483);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127527);
                                    bool bounds_check_129032 = cond_127533 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127481 + j_127530;
                                    int64_t slice_129029 = start_127291 + slice_129028;
                                    int64_t leq_arg1_129030 = ((int64_t *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127472 + i_127527;
                                    int64_t slice_129035 = start_127291 + slice_129034;
                                    int64_t leq_arg0_129036 = ((int64_t *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = sle64(leq_arg0_129036, leq_arg1_129030);
                                    
                                    cond_f_res_127534 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127534 = 0;
                                }
                                cond_127532 = cond_f_res_127534;
                            }
                            
                            int64_t loopres_127549;
                            int64_t loopres_127550;
                            int64_t loopres_127551;
                            
                            if (cond_127532) {
                                bool x_129039 = sle64((int64_t) 0, i_127527);
                                bool y_129040 = slt64(i_127527, j_m_i_127496);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127527);
                                int64_t slice_129043 = defunc_0_f_res_127472 + i_127527;
                                int64_t slice_129044 = start_127291 + slice_129043;
                                int64_t tmp_129045 = ((int64_t *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127549 = tmp_129038;
                                loopres_127550 = tmp_129045;
                                loopres_127551 = tmp_129046;
                            } else {
                                bool x_127561 = sle64((int64_t) 0, j_127530);
                                bool y_127562 = slt64(j_127530, j_m_i_127483);
                                bool bounds_check_127563 = x_127561 && y_127562;
                                bool index_certs_127564;
                                
                                if (!bounds_check_127563) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127565 = merge_sequential_arg2_127481 + j_127530;
                                int64_t slice_127566 = start_127291 + slice_127565;
                                int64_t tmp_127567 = ((int64_t *) mem_param_133257.mem)[slice_127566];
                                int64_t tmp_127568 = ((int64_t *) mem_param_133260.mem)[slice_127566];
                                
                                loopres_127549 = i_127527;
                                loopres_127550 = tmp_127567;
                                loopres_127551 = tmp_127568;
                            }
                            ((int64_t *) mem_133293)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127550;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127551;
                            
                            int64_t i_tmp_133557 = loopres_127549;
                            
                            i_127527 = i_tmp_133557;
                        }
                        data_127523 = i_127527;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133292, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133263, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127575 = next_stride_127219 * num_merges_127223;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            if (memblock_alloc(ctx, &mem_133373, bytes_133262, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            
            bool loop_cond_127578 = slt64(next_stride_127219, flat_dim_127100);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127575;
            bool loop_while_tmp_133534 = loop_cond_127578;
            int64_t stride_tmp_133537 = next_stride_127219;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127214 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127215 = loop_while_tmp_133534;
            stride_127218 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127209 = loop_dz2084Uz2082U_127214;
        data_127210 = loop_while_127215;
        data_127213 = stride_127218;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127579 = n_95211 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127580 = sle64((int64_t) 0, zs_lhs_127084);
        bool i_p_m_t_s_leq_w_127581 = slt64(zs_lhs_127084, data_127209);
        bool y_127582 = zzero_leq_i_p_m_t_s_127580 && i_p_m_t_s_leq_w_127581;
        bool ok_or_empty_127583 = empty_slice_127579 || y_127582;
        bool index_certs_127584;
        
        if (!ok_or_empty_127583) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_95211, "] out of bounds for array of shape [", (long long) data_127209, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:139:35-39\n   #6  ftRelational.fut:138:9-139:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133177, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_95211; i_133082++) {
        int64_t eta_p_127592 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127593 = sle64((int64_t) 0, eta_p_127592);
        bool y_127594 = slt64(eta_p_127592, n_95211);
        bool bounds_check_127595 = x_127593 && y_127594;
        bool index_certs_127596;
        
        if (!bounds_check_127595) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127592, "] out of bounds for array of shape [", (long long) n_95211, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_127597 = ((int64_t *) ext_mem_133176.mem)[eta_p_127592];
        int64_t lifted_lambda_res_127598 = ((int64_t *) xs_mem_133175.mem)[eta_p_127592];
        
        ((int64_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127597;
        ((int64_t *) mem_133387.mem)[i_133082] = lifted_lambda_res_127598;
    }
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133789, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133790, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_133801, struct memblock *mem_out_p_133802, struct memblock xs_mem_133175, int64_t n_90925, int64_t incr_90926)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133803 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133804 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133805 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133806 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133807 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133808 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133809 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133810 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133811 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133812 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_90925;
    bool cond_127083 = sle64(n_90925, (int64_t) 1);
    int64_t zs_lhs_127084 = sub64(n_90925, (int64_t) 1);
    int64_t zp_rhs_127085 = sdiv_safe64(zs_lhs_127084, (int64_t) 20);
    int64_t min_num_blocks_127086 = add64((int64_t) 1, zp_rhs_127085);
    bool loop_cond_127087 = slt64((int64_t) 1, min_num_blocks_127086);
    bool smallest_pow_2_geq_than_res_127088;
    int64_t smallest_pow_2_geq_than_res_127089;
    bool loop_while_127090;
    int64_t x_127091;
    
    loop_while_127090 = loop_cond_127087;
    x_127091 = (int64_t) 1;
    while (loop_while_127090) {
        int64_t loopres_127092 = mul64((int64_t) 2, x_127091);
        bool loop_cond_127093 = slt64(loopres_127092, min_num_blocks_127086);
        bool loop_while_tmp_133515 = loop_cond_127093;
        int64_t x_tmp_133516 = loopres_127092;
        
        loop_while_127090 = loop_while_tmp_133515;
        x_127091 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127088 = loop_while_127090;
    smallest_pow_2_geq_than_res_127089 = x_127091;
    
    bool zzero_127094 = smallest_pow_2_geq_than_res_127089 == (int64_t) 0;
    bool nonzzero_127095 = !zzero_127094;
    bool protect_assert_disj_127096 = cond_127083 || nonzzero_127095;
    bool nonzzero_cert_127097;
    
    if (!protect_assert_disj_127096) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127098 = sdiv_safe64(zs_lhs_127084, smallest_pow_2_geq_than_res_127089);
    int64_t block_sizze_127099 = add64((int64_t) 1, zp_rhs_127098);
    bool y_127105 = slt64((int64_t) 0, n_90925);
    bool protect_assert_disj_133419 = cond_127083 || y_127105;
    bool index_certs_127106;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_90925, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127120 = slt64(smallest_pow_2_geq_than_res_127089, (int64_t) 0);
    bool valid_127121 = !bounds_invalid_upwards_127120;
    bool protect_assert_disj_133427 = cond_127083 || valid_127121;
    bool range_valid_c_127122;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127089, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:135:35-39\n   #6  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127124 = slt64(block_sizze_127099, (int64_t) 0);
    bool valid_127125 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_133429 = cond_127083 || valid_127125;
    bool range_valid_c_127126;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127099, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127128 = sle64(block_sizze_127099, (int64_t) 1);
    int64_t tmp_127129 = sub64(block_sizze_127099, (int64_t) 2);
    bool bounds_invalid_upwards_127130 = slt64(tmp_127129, (int64_t) 0);
    bool valid_127132 = !bounds_invalid_upwards_127130;
    bool protect_assert_disj_127133 = cond_127128 || valid_127132;
    bool protect_assert_disj_133431 = cond_127083 || protect_assert_disj_127133;
    bool range_valid_c_127134;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127129, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133386 = (int64_t) 2 * n_90925;
    
    if (futrts_indicesWithIncrement_11373(ctx, &ext_mem_133176, xs_mem_133175, n_90925, incr_90926) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_90925; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127100 = smallest_pow_2_geq_than_res_127089 * block_sizze_127099;
    bool x_133414 = !cond_127083;
    int64_t greatest_divisor_leq_than_arg1_127103 = mul64((int64_t) 2, block_sizze_127099);
    int64_t merge_block_sizze_127104;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127103) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127104 = x_133416;
    } else {
        merge_block_sizze_127104 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_127107;
    
    if (x_133414) {
        int16_t x_133420 = ((int16_t *) xs_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127107 = x_133420;
    } else {
        reduce_arg1_127107 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        int16_t x_133422;
        int64_t x_133423;
        int16_t redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127107;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_90925; i_133042++) {
            int16_t x_127111 = ((int16_t *) xs_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127117 = sle16(redout_133040, x_127111);
            int16_t defunc_0_op_res_127118;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127118 = x_127111;
            } else {
                defunc_0_op_res_127118 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127119;
            
            if (defunc_0_leq_res_127117) {
                defunc_0_op_res_127119 = i_133042;
            } else {
                defunc_0_op_res_127119 = redout_133041;
            }
            
            int16_t redout_tmp_133519 = defunc_0_op_res_127118;
            int64_t redout_tmp_133520 = defunc_0_op_res_127119;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = (int16_t) 0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127131 = add64((int64_t) 1, tmp_127129);
    int64_t binop_x_133179 = (int64_t) 2 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133180 = block_sizze_127099 * binop_x_133179;
    int64_t binop_x_133182 = (int64_t) 8 * smallest_pow_2_geq_than_res_127089;
    int64_t bytes_133183 = block_sizze_127099 * binop_x_133182;
    int64_t bytes_133195 = (int64_t) 8 * block_sizze_127099;
    bool loop_cond_127206 = slt64(block_sizze_127099, flat_dim_127100);
    bool zzero_127207 = merge_block_sizze_127104 == (int64_t) 0;
    bool nonzzero_127208 = !zzero_127207;
    
    if (cond_127083) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133803 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133803, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133804 < bytes_133183) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133804, bytes_133183);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133805 < greatest_divisor_leq_than_arg1_127103) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133805, greatest_divisor_leq_than_arg1_127103);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133806 < bytes_133195) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133806, bytes_133195);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127089; i_133054++) {
            int64_t zp_lhs_127138 = mul64(block_sizze_127099, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127099; i_133047++) {
                int64_t k_127142 = add64(zp_lhs_127138, i_133047);
                bool cond_127143 = slt64(k_127142, n_90925);
                int16_t lifted_lambda_res_127144;
                int64_t lifted_lambda_res_127145;
                
                if (cond_127143) {
                    bool x_128906 = sle64((int64_t) 0, k_127142);
                    bool bounds_check_128907 = cond_127143 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127142, "] out of bounds for array of shape [", (long long) n_90925, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_128909 = ((int16_t *) xs_mem_133175.mem)[k_127142];
                    
                    lifted_lambda_res_127144 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127145 = k_127142;
                } else {
                    lifted_lambda_res_127144 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127145 = defunc_0_reduce_res_129054;
                }
                ((int16_t *) mem_133194)[i_133047] = lifted_lambda_res_127144;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127145;
            }
            if (!cond_127128) {
                for (int64_t i_127155 = 0; i_127155 < distance_127131; i_127155++) {
                    int64_t gt_arg1_127158 = add64((int64_t) 1, i_127155);
                    bool x_127159 = sle64((int64_t) 0, gt_arg1_127158);
                    bool y_127160 = slt64(gt_arg1_127158, block_sizze_127099);
                    bool bounds_check_127161 = x_127159 && y_127160;
                    bool index_certs_127162;
                    
                    if (!bounds_check_127161) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127158, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127164 = slt64(i_127155, block_sizze_127099);
                    bool index_certs_127165;
                    
                    if (!y_127164) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127155, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_127163 = ((int16_t *) mem_133194)[gt_arg1_127158];
                    int16_t gt_arg0_127166 = ((int16_t *) mem_133194)[i_127155];
                    bool defunc_0_leq_res_127167 = sle16(gt_arg0_127166, gt_arg1_127163);
                    bool defunc_0_lifted_gt_res_127168 = !defunc_0_leq_res_127167;
                    bool s_127169;
                    int64_t s_127172;
                    bool loop_while_127173;
                    int64_t j_127176;
                    
                    loop_while_127173 = defunc_0_lifted_gt_res_127168;
                    j_127176 = i_127155;
                    while (loop_while_127173) {
                        bool x_127177 = sle64((int64_t) 0, j_127176);
                        bool y_127178 = slt64(j_127176, block_sizze_127099);
                        bool bounds_check_127179 = x_127177 && y_127178;
                        bool index_certs_127180;
                        
                        if (!bounds_check_127179) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127176, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127183 = add64((int64_t) 1, j_127176);
                        bool x_127184 = sle64((int64_t) 0, copy_arg0_127183);
                        bool y_127185 = slt64(copy_arg0_127183, block_sizze_127099);
                        bool bounds_check_127186 = x_127184 && y_127185;
                        bool index_certs_127187;
                        
                        if (!bounds_check_127186) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127183, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_127181 = ((int16_t *) mem_133194)[j_127176];
                        int64_t copy_arg0_127182 = ((int64_t *) mem_133196)[j_127176];
                        int16_t copy_arg0_127188 = ((int16_t *) mem_133194)[copy_arg0_127183];
                        int64_t copy_arg0_127189 = ((int64_t *) mem_133196)[copy_arg0_127183];
                        
                        ((int16_t *) mem_133194)[j_127176] = copy_arg0_127188;
                        ((int64_t *) mem_133196)[j_127176] = copy_arg0_127189;
                        ((int16_t *) mem_133194)[copy_arg0_127183] = copy_arg0_127181;
                        ((int64_t *) mem_133196)[copy_arg0_127183] = copy_arg0_127182;
                        
                        int64_t tmp_127194 = sub64(j_127176, (int64_t) 1);
                        bool cond_127195 = sle64((int64_t) 0, tmp_127194);
                        bool loop_cond_127196;
                        
                        if (cond_127195) {
                            bool y_128911 = slt64(tmp_127194, block_sizze_127099);
                            bool bounds_check_128912 = cond_127195 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127194, "] out of bounds for array of shape [", (long long) block_sizze_127099, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_128910 = ((int16_t *) mem_133194)[j_127176];
                            int16_t gt_arg0_128914 = ((int16_t *) mem_133194)[tmp_127194];
                            bool defunc_0_leq_res_128915 = sle16(gt_arg0_128914, gt_arg1_128910);
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127196 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127196 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127196;
                        int64_t j_tmp_133530 = tmp_127194;
                        
                        loop_while_127173 = loop_while_tmp_133527;
                        j_127176 = j_tmp_133530;
                    }
                    s_127169 = loop_while_127173;
                    s_127172 = j_127176;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_133181, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127099, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127099});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint16_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        if (memblock_alloc(ctx, &mem_133253, bytes_133183, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127099, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127089, block_sizze_127099});
        
        int64_t data_127209;
        bool data_127210;
        int64_t data_127213;
        int64_t loop_dz2084Uz2082U_127214;
        bool loop_while_127215;
        int64_t stride_127218;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127214 = flat_dim_127100;
        loop_while_127215 = loop_cond_127206;
        stride_127218 = block_sizze_127099;
        while (loop_while_127215) {
            int64_t next_stride_127219 = mul64((int64_t) 2, stride_127218);
            bool zzero_127220 = next_stride_127219 == (int64_t) 0;
            bool nonzzero_127221 = !zzero_127220;
            bool nonzzero_cert_127222;
            
            if (!nonzzero_127221) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127223 = sdiv64(flat_dim_127100, next_stride_127219);
            bool bounds_invalid_upwards_127224 = slt64(num_merges_127223, (int64_t) 0);
            bool valid_127225 = !bounds_invalid_upwards_127224;
            bool range_valid_c_127226;
            
            if (!valid_127225) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127223, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:135:35-39\n   #6  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127228 = sub64(next_stride_127219, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127229 = sle64((int64_t) 0, m_127228);
            bool cond_127231 = slt64(next_stride_127219, (int64_t) 10);
            bool protect_assert_disj_127232 = nonzzero_127208 || cond_127231;
            bool nonzzero_cert_127233;
            
            if (!protect_assert_disj_127232) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127234 = smod_safe64(next_stride_127219, merge_block_sizze_127104);
            bool num_blocks_127235 = zeze_lhs_127234 == (int64_t) 0;
            bool protect_assert_disj_127236 = cond_127231 || num_blocks_127235;
            bool assert_c_127237;
            
            if (!protect_assert_disj_127236) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127239 = sdiv_safe64(next_stride_127219, merge_block_sizze_127104);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240 = add64((int64_t) 1, num_blocks_127239);
            int64_t j_m_i_127241 = sub64(next_stride_127219, stride_127218);
            int64_t flat_dim_127242 = merge_block_sizze_127104 * num_blocks_127239;
            bool bounds_invalid_upwards_127243 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, (int64_t) 0);
            bool empty_slice_127244 = j_m_i_127241 == (int64_t) 0;
            int64_t m_127245 = sub64(j_m_i_127241, (int64_t) 1);
            bool zzero_lte_i_127246 = sle64((int64_t) 0, stride_127218);
            bool i_lte_j_127247 = sle64(stride_127218, next_stride_127219);
            bool empty_slice_127248 = stride_127218 == (int64_t) 0;
            int64_t m_127249 = sub64(stride_127218, (int64_t) 1);
            bool bounds_invalid_upwards_127250 = slt64(num_blocks_127239, (int64_t) 0);
            bool cond_127251 = slt64((int64_t) 0, stride_127218);
            bool valid_127252 = !bounds_invalid_upwards_127243;
            int64_t i_p_m_t_s_127253 = add64(stride_127218, m_127245);
            bool zzero_leq_i_p_m_t_s_127254 = sle64((int64_t) 0, m_127249);
            bool i_p_m_t_s_leq_w_127255 = slt64(m_127249, next_stride_127219);
            bool valid_127256 = !bounds_invalid_upwards_127250;
            bool i_p_m_t_s_leq_w_127257 = slt64(m_127228, flat_dim_127242);
            bool y_127258 = slt64((int64_t) 0, j_m_i_127241);
            bool protect_assert_disj_127259 = cond_127231 || valid_127252;
            bool range_valid_c_127260;
            
            if (!protect_assert_disj_127259) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127261 = sle64((int64_t) 0, i_p_m_t_s_127253);
            bool i_p_m_t_s_leq_w_127262 = slt64(i_p_m_t_s_127253, next_stride_127219);
            bool y_127263 = zzero_leq_i_p_m_t_s_127254 && i_p_m_t_s_leq_w_127255;
            bool protect_assert_disj_127264 = cond_127231 || valid_127256;
            bool range_valid_c_127265;
            
            if (!protect_assert_disj_127264) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127266 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127257;
            bool y_127267 = zzero_lte_i_127246 && i_p_m_t_s_leq_w_127262;
            bool forwards_ok_127268 = zzero_lte_i_127246 && y_127263;
            bool ok_or_empty_127269 = zzero_127220 || y_127266;
            bool protect_assert_disj_127270 = cond_127251 || y_127258;
            bool y_127271 = zzero_leq_i_p_m_t_s_127261 && y_127267;
            bool ok_or_empty_127272 = empty_slice_127248 || forwards_ok_127268;
            bool protect_assert_disj_127273 = cond_127231 || ok_or_empty_127269;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) flat_dim_127242, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127275 = !cond_127231;
            bool protect_assert_disj_127276 = protect_assert_disj_127270 || loop_not_taken_127275;
            bool index_certs_127277;
            
            if (!protect_assert_disj_127276) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127278 = i_lte_j_127247 && y_127271;
            bool protect_assert_disj_127279 = cond_127231 || ok_or_empty_127272;
            bool index_certs_127280;
            
            if (!protect_assert_disj_127279) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127281 = ok_or_empty_127272 || loop_not_taken_127275;
            bool index_certs_127282;
            
            if (!protect_assert_disj_127281) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127218, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127283 = empty_slice_127244 || forwards_ok_127278;
            bool protect_assert_disj_127284 = cond_127231 || ok_or_empty_127283;
            bool index_certs_127285;
            
            if (!protect_assert_disj_127284) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127286 = loop_not_taken_127275 || ok_or_empty_127283;
            bool index_certs_127287;
            
            if (!protect_assert_disj_127286) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127218, ":] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 2 * num_merges_127223;
            int64_t bytes_133262 = next_stride_127219 * binop_x_133261;
            int64_t binop_x_133264 = (int64_t) 8 * num_merges_127223;
            int64_t bytes_133265 = next_stride_127219 * binop_x_133264;
            bool i_lte_j_127230 = sle64((int64_t) 0, next_stride_127219);
            
            if (mem_133263_cached_sizze_133807 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133807, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133808 < bytes_133265) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133808, bytes_133265);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240;
            int64_t binop_x_133291 = (int64_t) 2 * num_blocks_127239;
            int64_t bytes_133292 = merge_block_sizze_127104 * binop_x_133291;
            int64_t binop_x_133294 = (int64_t) 8 * num_blocks_127239;
            int64_t bytes_133295 = merge_block_sizze_127104 * binop_x_133294;
            int64_t bytes_133337 = (int64_t) 4 * stride_127218;
            int64_t bytes_133339 = (int64_t) 16 * stride_127218;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127223; i_133075++) {
                int64_t start_127291 = mul64(next_stride_127219, i_133075);
                int64_t j_m_i_127292 = sub64(loop_dz2084Uz2082U_127214, start_127291);
                bool empty_slice_127293 = j_m_i_127292 == (int64_t) 0;
                int64_t m_127294 = sub64(j_m_i_127292, (int64_t) 1);
                int64_t i_p_m_t_s_127295 = add64(start_127291, m_127294);
                bool zzero_leq_i_p_m_t_s_127296 = sle64((int64_t) 0, i_p_m_t_s_127295);
                bool i_p_m_t_s_leq_w_127297 = slt64(i_p_m_t_s_127295, loop_dz2084Uz2082U_127214);
                bool zzero_lte_i_127298 = sle64((int64_t) 0, start_127291);
                bool i_lte_j_127299 = sle64(start_127291, loop_dz2084Uz2082U_127214);
                bool y_127300 = i_p_m_t_s_leq_w_127297 && zzero_lte_i_127298;
                bool y_127301 = zzero_leq_i_p_m_t_s_127296 && y_127300;
                bool forwards_ok_127302 = i_lte_j_127299 && y_127301;
                bool ok_or_empty_127303 = empty_slice_127293 || forwards_ok_127302;
                bool index_certs_127304;
                
                if (!ok_or_empty_127303) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127291, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127214, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127305 = slt64(m_127228, j_m_i_127292);
                bool y_127306 = zzero_leq_i_p_m_t_s_127229 && i_p_m_t_s_leq_w_127305;
                bool forwards_ok_127307 = i_lte_j_127230 && y_127306;
                bool ok_or_empty_127308 = zzero_127220 || forwards_ok_127307;
                bool index_certs_127309;
                
                if (!ok_or_empty_127308) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127219, "] out of bounds for array of shape [", (long long) j_m_i_127292, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127231) {
                    int16_t dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127251) {
                        int16_t head_res_128944 = ((int16_t *) mem_param_133257.mem)[start_127291];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127291];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127218 + start_127291;
                        int16_t head_res_128947 = ((int16_t *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127219; nest_i_133540++) {
                        ((int16_t *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133339, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127219; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127219; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127241;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127218);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127241);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127218 + j_128958;
                                int64_t slice_128968 = start_127291 + slice_128967;
                                int16_t leq_arg1_128969 = ((int16_t *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127291 + i_128955;
                                int16_t leq_arg0_128974 = ((int16_t *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = sle16(leq_arg0_128974, leq_arg1_128969);
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        int16_t loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127218);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127291 + i_128955;
                            int16_t tmp_128985 = ((int16_t *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127241);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127218 + j_128958;
                            int64_t slice_128992 = start_127291 + slice_128991;
                            int16_t tmp_128993 = ((int16_t *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((int16_t *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133809 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133809, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133810 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133810, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240; i_133061++) {
                        int64_t split_count_arg3_127371 = mul64(merge_block_sizze_127104, i_133061);
                        int64_t defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127372, &defunc_0_split_count_res_127373, &defunc_0_split_count_res_127374, &defunc_0_split_count_res_127375, &defunc_0_split_count_res_127376, (int64_t) 0, stride_127218, (int64_t) 0, j_m_i_127241, split_count_arg3_127371) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127377 = slt64((int64_t) 0, defunc_0_split_count_res_127376);
                        bool defunc_0_split_count_res_127378;
                        int64_t defunc_0_split_count_res_127379;
                        int64_t defunc_0_split_count_res_127380;
                        int64_t defunc_0_split_count_res_127381;
                        int64_t defunc_0_split_count_res_127382;
                        int64_t defunc_0_split_count_res_127383;
                        bool loop_while_127384;
                        int64_t ss_127385;
                        int64_t ss_127386;
                        int64_t tt_127387;
                        int64_t tt_127388;
                        int64_t count_127389;
                        
                        loop_while_127384 = loop_cond_127377;
                        ss_127385 = defunc_0_split_count_res_127372;
                        ss_127386 = defunc_0_split_count_res_127373;
                        tt_127387 = defunc_0_split_count_res_127374;
                        tt_127388 = defunc_0_split_count_res_127375;
                        count_127389 = defunc_0_split_count_res_127376;
                        while (loop_while_127384) {
                            int64_t zlze_lhs_127390 = sub64(ss_127386, ss_127385);
                            bool cond_127391 = sle64(zlze_lhs_127390, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127392;
                            int64_t defunc_0_lifted_step_res_127393;
                            int64_t defunc_0_lifted_step_res_127394;
                            int64_t defunc_0_lifted_step_res_127395;
                            
                            if (cond_127391) {
                                int64_t tmp_128997 = add64(tt_127387, count_127389);
                                
                                defunc_0_lifted_step_res_127392 = ss_127385;
                                defunc_0_lifted_step_res_127393 = tmp_128997;
                                defunc_0_lifted_step_res_127394 = tt_127388;
                                defunc_0_lifted_step_res_127395 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127397 = sub64(tt_127388, tt_127387);
                                bool cond_127398 = sle64(zlze_lhs_127397, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127399;
                                int64_t defunc_0_lifted_step_res_f_res_127400;
                                int64_t defunc_0_lifted_step_res_f_res_127401;
                                int64_t defunc_0_lifted_step_res_f_res_127402;
                                
                                if (cond_127398) {
                                    int64_t tmp_128998 = add64(ss_127385, count_127389);
                                    
                                    defunc_0_lifted_step_res_f_res_127399 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127400 = tt_127387;
                                    defunc_0_lifted_step_res_f_res_127401 = tt_127388;
                                    defunc_0_lifted_step_res_f_res_127402 = (int64_t) 0;
                                } else {
                                    bool cond_127404 = count_127389 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127405;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127406;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127407;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127408;
                                    
                                    if (cond_127404) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127385);
                                        bool y_129001 = slt64(ss_127385, stride_127218);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127385, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127387);
                                        bool y_129007 = slt64(tt_127387, j_m_i_127241);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127387, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127291 + ss_127385;
                                        int16_t leq_arg1_129005 = ((int16_t *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127218 + tt_127387;
                                        int64_t slice_129011 = start_127291 + slice_129010;
                                        int16_t leq_arg0_129012 = ((int16_t *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = sle16(leq_arg0_129012, leq_arg1_129005);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127387);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127385;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127385);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127387;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = tt_127388;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = (int64_t) 0;
                                    } else {
                                        int64_t m_127427 = sdiv64(count_127389, (int64_t) 2);
                                        int64_t n_127428 = sub64(count_127389, m_127427);
                                        bool cond_127429 = n_127428 == (int64_t) 0;
                                        int64_t zgze_lhs_127430 = add64(ss_127385, m_127427);
                                        bool cond_f_res_127431 = sle64(ss_127386, zgze_lhs_127430);
                                        bool x_127432 = !cond_127429;
                                        bool y_127433 = cond_f_res_127431 && x_127432;
                                        bool cond_127434 = cond_127429 || y_127433;
                                        bool leq_y_x_127435;
                                        
                                        if (cond_127434) {
                                            leq_y_x_127435 = 1;
                                        } else {
                                            bool x_127436 = sle64((int64_t) 0, zgze_lhs_127430);
                                            bool y_127437 = slt64(zgze_lhs_127430, stride_127218);
                                            bool bounds_check_127438 = x_127436 && y_127437;
                                            bool index_certs_127439;
                                            
                                            if (!bounds_check_127438) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127430, "] out of bounds for array of shape [", (long long) stride_127218, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127442 = add64(tt_127387, n_127428);
                                            int64_t leq_arg0_127443 = sub64(zm_lhs_127442, (int64_t) 1);
                                            bool x_127444 = sle64((int64_t) 0, leq_arg0_127443);
                                            bool y_127445 = slt64(leq_arg0_127443, j_m_i_127241);
                                            bool bounds_check_127446 = x_127444 && y_127445;
                                            bool index_certs_127447;
                                            
                                            if (!bounds_check_127446) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127443, "] out of bounds for array of shape [", (long long) j_m_i_127241, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127440 = start_127291 + zgze_lhs_127430;
                                            int16_t leq_arg1_127441 = ((int16_t *) mem_param_133257.mem)[slice_127440];
                                            int64_t slice_127448 = stride_127218 + leq_arg0_127443;
                                            int64_t slice_127449 = start_127291 + slice_127448;
                                            int16_t leq_arg0_127450 = ((int16_t *) mem_param_133257.mem)[slice_127449];
                                            bool defunc_0_leq_res_127451 = sle16(leq_arg0_127450, leq_arg1_127441);
                                            
                                            leq_y_x_127435 = defunc_0_leq_res_127451;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                        
                                        if (leq_y_x_127435) {
                                            int64_t tmp_129018 = add64(tt_127387, n_127428);
                                            int64_t tmp_129019 = sub64(count_127389, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tt_127388;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = tmp_129019;
                                        } else {
                                            int64_t tmp_127457 = add64(tt_127387, n_127428);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127452 = tt_127387;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127453 = tmp_127457;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127454 = count_127389;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127405 = ss_127385;
                                        defunc_0_lifted_step_res_f_res_f_res_127406 = defunc_0_lifted_step_res_f_res_f_res_f_res_127452;
                                        defunc_0_lifted_step_res_f_res_f_res_127407 = defunc_0_lifted_step_res_f_res_f_res_f_res_127453;
                                        defunc_0_lifted_step_res_f_res_f_res_127408 = defunc_0_lifted_step_res_f_res_f_res_f_res_127454;
                                    }
                                    defunc_0_lifted_step_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_127405;
                                    defunc_0_lifted_step_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_127406;
                                    defunc_0_lifted_step_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_127407;
                                    defunc_0_lifted_step_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_127408;
                                }
                                defunc_0_lifted_step_res_127392 = defunc_0_lifted_step_res_f_res_127399;
                                defunc_0_lifted_step_res_127393 = defunc_0_lifted_step_res_f_res_127400;
                                defunc_0_lifted_step_res_127394 = defunc_0_lifted_step_res_f_res_127401;
                                defunc_0_lifted_step_res_127395 = defunc_0_lifted_step_res_f_res_127402;
                            }
                            
                            int64_t loopres_127458;
                            int64_t loopres_127459;
                            int64_t loopres_127460;
                            int64_t loopres_127461;
                            int64_t loopres_127462;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127458, &loopres_127459, &loopres_127460, &loopres_127461, &loopres_127462, defunc_0_lifted_step_res_127392, ss_127386, defunc_0_lifted_step_res_127393, defunc_0_lifted_step_res_127394, defunc_0_lifted_step_res_127395) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127463 = slt64((int64_t) 0, loopres_127462);
                            bool loop_while_tmp_133547 = loop_cond_127463;
                            int64_t ss_tmp_133548 = loopres_127458;
                            int64_t ss_tmp_133549 = loopres_127459;
                            int64_t tt_tmp_133550 = loopres_127460;
                            int64_t tt_tmp_133551 = loopres_127461;
                            int64_t count_tmp_133552 = loopres_127462;
                            
                            loop_while_127384 = loop_while_tmp_133547;
                            ss_127385 = ss_tmp_133548;
                            ss_127386 = ss_tmp_133549;
                            tt_127387 = tt_tmp_133550;
                            tt_127388 = tt_tmp_133551;
                            count_127389 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127378 = loop_while_127384;
                        defunc_0_split_count_res_127379 = ss_127385;
                        defunc_0_split_count_res_127380 = ss_127386;
                        defunc_0_split_count_res_127381 = tt_127387;
                        defunc_0_split_count_res_127382 = tt_127388;
                        defunc_0_split_count_res_127383 = count_127389;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127379;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127381;
                    }
                    if (mem_133293_cached_sizze_133811 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133811, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133812 < bytes_133295) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133812, bytes_133295);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127239; i_133068++) {
                        bool y_127469 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool index_certs_127471;
                        
                        if (!y_127469) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127472 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127474 = add64((int64_t) 1, i_133068);
                        bool x_127475 = sle64((int64_t) 0, tmp_127474);
                        bool y_127476 = slt64(tmp_127474, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240);
                        bool bounds_check_127477 = x_127475 && y_127476;
                        bool index_certs_127478;
                        
                        if (!bounds_check_127477) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127474, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127240, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127479 = ((int64_t *) mem_133276)[tmp_127474];
                        int64_t defunc_0_f_res_127480 = ((int64_t *) mem_133278)[tmp_127474];
                        int64_t merge_sequential_arg2_127481 = add64(stride_127218, defunc_0_f_res_127473);
                        int64_t merge_sequential_arg2_127482 = add64(stride_127218, defunc_0_f_res_127480);
                        int64_t j_m_i_127483 = sub64(merge_sequential_arg2_127482, merge_sequential_arg2_127481);
                        bool empty_slice_127484 = j_m_i_127483 == (int64_t) 0;
                        int64_t m_127485 = sub64(j_m_i_127483, (int64_t) 1);
                        int64_t i_p_m_t_s_127486 = add64(merge_sequential_arg2_127481, m_127485);
                        bool zzero_leq_i_p_m_t_s_127487 = sle64((int64_t) 0, i_p_m_t_s_127486);
                        bool i_p_m_t_s_leq_w_127488 = slt64(i_p_m_t_s_127486, next_stride_127219);
                        bool zzero_lte_i_127489 = sle64((int64_t) 0, merge_sequential_arg2_127481);
                        bool i_lte_j_127490 = sle64(merge_sequential_arg2_127481, merge_sequential_arg2_127482);
                        bool y_127491 = i_p_m_t_s_leq_w_127488 && zzero_lte_i_127489;
                        bool y_127492 = zzero_leq_i_p_m_t_s_127487 && y_127491;
                        bool forwards_ok_127493 = i_lte_j_127490 && y_127492;
                        bool ok_or_empty_127494 = empty_slice_127484 || forwards_ok_127493;
                        bool index_certs_127495;
                        
                        if (!ok_or_empty_127494) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127481, ":", (long long) merge_sequential_arg2_127482, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127496 = sub64(defunc_0_f_res_127479, defunc_0_f_res_127472);
                        bool empty_slice_127497 = j_m_i_127496 == (int64_t) 0;
                        int64_t m_127498 = sub64(j_m_i_127496, (int64_t) 1);
                        int64_t i_p_m_t_s_127499 = add64(defunc_0_f_res_127472, m_127498);
                        bool zzero_leq_i_p_m_t_s_127500 = sle64((int64_t) 0, i_p_m_t_s_127499);
                        bool i_p_m_t_s_leq_w_127501 = slt64(i_p_m_t_s_127499, next_stride_127219);
                        bool zzero_lte_i_127502 = sle64((int64_t) 0, defunc_0_f_res_127472);
                        bool i_lte_j_127503 = sle64(defunc_0_f_res_127472, defunc_0_f_res_127479);
                        bool y_127504 = i_p_m_t_s_leq_w_127501 && zzero_lte_i_127502;
                        bool y_127505 = zzero_leq_i_p_m_t_s_127500 && y_127504;
                        bool forwards_ok_127506 = i_lte_j_127503 && y_127505;
                        bool ok_or_empty_127507 = empty_slice_127497 || forwards_ok_127506;
                        bool index_certs_127508;
                        
                        if (!ok_or_empty_127507) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127472, ":", (long long) defunc_0_f_res_127479, "] out of bounds for array of shape [", (long long) next_stride_127219, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127509 = slt64((int64_t) 0, j_m_i_127496);
                        int16_t dummy_127510;
                        int64_t dummy_127511;
                        
                        if (cond_127509) {
                            bool index_certs_129020;
                            
                            if (!cond_127509) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:135:35-39\n   #12 ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127291 + defunc_0_f_res_127472;
                            int16_t head_res_129022 = ((int16_t *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127510 = head_res_129022;
                            dummy_127511 = head_res_129023;
                        } else {
                            bool y_127516 = slt64((int64_t) 0, j_m_i_127483);
                            bool index_certs_127517;
                            
                            if (!y_127516) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:60-63\n   #11 ftRelational.fut:135:35-39\n   #12 ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127518 = start_127291 + merge_sequential_arg2_127481;
                            int16_t head_res_127519 = ((int16_t *) mem_param_133257.mem)[slice_127518];
                            int64_t head_res_127520 = ((int64_t *) mem_param_133260.mem)[slice_127518];
                            
                            dummy_127510 = head_res_127519;
                            dummy_127511 = head_res_127520;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127104; nest_i_133555++) {
                            ((int16_t *) mem_133293)[i_133068 * merge_block_sizze_127104 + nest_i_133555] = dummy_127510;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127104; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + nest_i_133556] = dummy_127511;
                        }
                        
                        int64_t data_127523;
                        int64_t i_127527 = (int64_t) 0;
                        
                        for (int64_t k_127526 = 0; k_127526 < merge_block_sizze_127104; k_127526++) {
                            int64_t j_127530 = sub64(k_127526, i_127527);
                            bool cond_127531 = j_127530 == j_m_i_127483;
                            bool cond_127532;
                            
                            if (cond_127531) {
                                cond_127532 = 1;
                            } else {
                                bool cond_127533 = slt64(i_127527, j_m_i_127496);
                                bool cond_f_res_127534;
                                
                                if (cond_127533) {
                                    bool x_129024 = sle64((int64_t) 0, j_127530);
                                    bool y_129025 = slt64(j_127530, j_m_i_127483);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127527);
                                    bool bounds_check_129032 = cond_127533 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127481 + j_127530;
                                    int64_t slice_129029 = start_127291 + slice_129028;
                                    int16_t leq_arg1_129030 = ((int16_t *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127472 + i_127527;
                                    int64_t slice_129035 = start_127291 + slice_129034;
                                    int16_t leq_arg0_129036 = ((int16_t *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = sle16(leq_arg0_129036, leq_arg1_129030);
                                    
                                    cond_f_res_127534 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127534 = 0;
                                }
                                cond_127532 = cond_f_res_127534;
                            }
                            
                            int64_t loopres_127549;
                            int16_t loopres_127550;
                            int64_t loopres_127551;
                            
                            if (cond_127532) {
                                bool x_129039 = sle64((int64_t) 0, i_127527);
                                bool y_129040 = slt64(i_127527, j_m_i_127496);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127527, "] out of bounds for array of shape [", (long long) j_m_i_127496, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127527);
                                int64_t slice_129043 = defunc_0_f_res_127472 + i_127527;
                                int64_t slice_129044 = start_127291 + slice_129043;
                                int16_t tmp_129045 = ((int16_t *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127549 = tmp_129038;
                                loopres_127550 = tmp_129045;
                                loopres_127551 = tmp_129046;
                            } else {
                                bool x_127561 = sle64((int64_t) 0, j_127530);
                                bool y_127562 = slt64(j_127530, j_m_i_127483);
                                bool bounds_check_127563 = x_127561 && y_127562;
                                bool index_certs_127564;
                                
                                if (!bounds_check_127563) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127530, "] out of bounds for array of shape [", (long long) j_m_i_127483, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127565 = merge_sequential_arg2_127481 + j_127530;
                                int64_t slice_127566 = start_127291 + slice_127565;
                                int16_t tmp_127567 = ((int16_t *) mem_param_133257.mem)[slice_127566];
                                int64_t tmp_127568 = ((int64_t *) mem_param_133260.mem)[slice_127566];
                                
                                loopres_127549 = i_127527;
                                loopres_127550 = tmp_127567;
                                loopres_127551 = tmp_127568;
                            }
                            ((int16_t *) mem_133293)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127550;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127104 + k_127526] = loopres_127551;
                            
                            int64_t i_tmp_133557 = loopres_127549;
                            
                            i_127527 = i_tmp_133557;
                        }
                        data_127523 = i_127527;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint16_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133295, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127104, (int64_t) 1}, (int64_t []) {num_blocks_127239, merge_block_sizze_127104});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_133263, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127219, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127219});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127575 = next_stride_127219 * num_merges_127223;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint16_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            if (memblock_alloc(ctx, &mem_133373, bytes_133265, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127219, (int64_t) 1}, (int64_t []) {num_merges_127223, next_stride_127219});
            
            bool loop_cond_127578 = slt64(next_stride_127219, flat_dim_127100);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127575;
            bool loop_while_tmp_133534 = loop_cond_127578;
            int64_t stride_tmp_133537 = next_stride_127219;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127214 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127215 = loop_while_tmp_133534;
            stride_127218 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127209 = loop_dz2084Uz2082U_127214;
        data_127210 = loop_while_127215;
        data_127213 = stride_127218;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127579 = n_90925 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127580 = sle64((int64_t) 0, zs_lhs_127084);
        bool i_p_m_t_s_leq_w_127581 = slt64(zs_lhs_127084, data_127209);
        bool y_127582 = zzero_leq_i_p_m_t_s_127580 && i_p_m_t_s_leq_w_127581;
        bool ok_or_empty_127583 = empty_slice_127579 || y_127582;
        bool index_certs_127584;
        
        if (!ok_or_empty_127583) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_90925, "] out of bounds for array of shape [", (long long) data_127209, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:60-63\n   #5  ftRelational.fut:135:35-39\n   #6  ftRelational.fut:134:9-135:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_90925; i_133082++) {
        int64_t eta_p_127592 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127593 = sle64((int64_t) 0, eta_p_127592);
        bool y_127594 = slt64(eta_p_127592, n_90925);
        bool bounds_check_127595 = x_127593 && y_127594;
        bool index_certs_127596;
        
        if (!bounds_check_127595) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127592, "] out of bounds for array of shape [", (long long) n_90925, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_127597 = ((int64_t *) ext_mem_133176.mem)[eta_p_127592];
        int16_t lifted_lambda_res_127598 = ((int16_t *) xs_mem_133175.mem)[eta_p_127592];
        
        ((int64_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127597;
        ((int16_t *) mem_133387.mem)[i_133082] = lifted_lambda_res_127598;
    }
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133801, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133802, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_133813, struct memblock *mem_out_p_133814, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_84397, int64_t b_84398)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133815 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133816 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133817 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133818 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133819 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133820 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133821 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133822 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133823 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133824 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_84397;
    bool cond_127077 = sle64(n_84397, (int64_t) 1);
    int64_t zs_lhs_127078 = sub64(n_84397, (int64_t) 1);
    int64_t zp_rhs_127079 = sdiv_safe64(zs_lhs_127078, (int64_t) 20);
    int64_t min_num_blocks_127080 = add64((int64_t) 1, zp_rhs_127079);
    bool loop_cond_127081 = slt64((int64_t) 1, min_num_blocks_127080);
    bool smallest_pow_2_geq_than_res_127082;
    int64_t smallest_pow_2_geq_than_res_127083;
    bool loop_while_127084;
    int64_t x_127085;
    
    loop_while_127084 = loop_cond_127081;
    x_127085 = (int64_t) 1;
    while (loop_while_127084) {
        int64_t loopres_127086 = mul64((int64_t) 2, x_127085);
        bool loop_cond_127087 = slt64(loopres_127086, min_num_blocks_127080);
        bool loop_while_tmp_133515 = loop_cond_127087;
        int64_t x_tmp_133516 = loopres_127086;
        
        loop_while_127084 = loop_while_tmp_133515;
        x_127085 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127082 = loop_while_127084;
    smallest_pow_2_geq_than_res_127083 = x_127085;
    
    bool zzero_127088 = smallest_pow_2_geq_than_res_127083 == (int64_t) 0;
    bool nonzzero_127089 = !zzero_127088;
    bool protect_assert_disj_127090 = cond_127077 || nonzzero_127089;
    bool nonzzero_cert_127091;
    
    if (!protect_assert_disj_127090) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127092 = sdiv_safe64(zs_lhs_127078, smallest_pow_2_geq_than_res_127083);
    int64_t block_sizze_127093 = add64((int64_t) 1, zp_rhs_127092);
    bool y_127099 = slt64((int64_t) 0, n_84397);
    bool protect_assert_disj_133419 = cond_127077 || y_127099;
    bool index_certs_127100;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_84397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127114 = slt64(smallest_pow_2_geq_than_res_127083, (int64_t) 0);
    bool valid_127115 = !bounds_invalid_upwards_127114;
    bool protect_assert_disj_133427 = cond_127077 || valid_127115;
    bool range_valid_c_127116;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:117:36-40\n   #6  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127118 = slt64(block_sizze_127093, (int64_t) 0);
    bool valid_127119 = !bounds_invalid_upwards_127118;
    bool protect_assert_disj_133429 = cond_127077 || valid_127119;
    bool range_valid_c_127120;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127093, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127122 = sle64(block_sizze_127093, (int64_t) 1);
    int64_t tmp_127123 = sub64(block_sizze_127093, (int64_t) 2);
    bool bounds_invalid_upwards_127124 = slt64(tmp_127123, (int64_t) 0);
    bool valid_127126 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_127127 = cond_127122 || valid_127126;
    bool protect_assert_disj_133431 = cond_127077 || protect_assert_disj_127127;
    bool range_valid_c_127128;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127123, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133386 = n_84397 * b_84398;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_84397; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127094 = smallest_pow_2_geq_than_res_127083 * block_sizze_127093;
    bool x_133414 = !cond_127077;
    int64_t greatest_divisor_leq_than_arg1_127097 = mul64((int64_t) 2, block_sizze_127093);
    int64_t merge_block_sizze_127098;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127097) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127098 = x_133416;
    } else {
        merge_block_sizze_127098 = (int64_t) 0;
    }
    
    double reduce_arg1_127101;
    
    if (x_133414) {
        double x_133420 = ((double *) k_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127101 = x_133420;
    } else {
        reduce_arg1_127101 = 0.0;
    }
    
    double defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        double x_133422;
        int64_t x_133423;
        double redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127101;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_84397; i_133042++) {
            double x_127105 = ((double *) k_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127111 = redout_133040 <= x_127105;
            double defunc_0_op_res_127112;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127112 = x_127105;
            } else {
                defunc_0_op_res_127112 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127113;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127113 = i_133042;
            } else {
                defunc_0_op_res_127113 = redout_133041;
            }
            
            double redout_tmp_133519 = defunc_0_op_res_127112;
            int64_t redout_tmp_133520 = defunc_0_op_res_127113;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = 0.0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127125 = add64((int64_t) 1, tmp_127123);
    int64_t binop_x_133179 = (int64_t) 8 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133180 = block_sizze_127093 * binop_x_133179;
    int64_t bytes_133193 = (int64_t) 8 * block_sizze_127093;
    bool loop_cond_127200 = slt64(block_sizze_127093, flat_dim_127094);
    bool zzero_127201 = merge_block_sizze_127098 == (int64_t) 0;
    bool nonzzero_127202 = !zzero_127201;
    
    if (cond_127077) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133815 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133815, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133816 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133816, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133817 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133817, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133818 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133818, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127083; i_133054++) {
            int64_t zp_lhs_127132 = mul64(block_sizze_127093, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127093; i_133047++) {
                int64_t k_127136 = add64(zp_lhs_127132, i_133047);
                bool cond_127137 = slt64(k_127136, n_84397);
                double lifted_lambda_res_127138;
                int64_t lifted_lambda_res_127139;
                
                if (cond_127137) {
                    bool x_128906 = sle64((int64_t) 0, k_127136);
                    bool bounds_check_128907 = cond_127137 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127136, "] out of bounds for array of shape [", (long long) n_84397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_128909 = ((double *) k_mem_133175.mem)[k_127136];
                    
                    lifted_lambda_res_127138 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127139 = k_127136;
                } else {
                    lifted_lambda_res_127138 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127139 = defunc_0_reduce_res_129054;
                }
                ((double *) mem_133194)[i_133047] = lifted_lambda_res_127138;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127139;
            }
            if (!cond_127122) {
                for (int64_t i_127149 = 0; i_127149 < distance_127125; i_127149++) {
                    int64_t gt_arg1_127152 = add64((int64_t) 1, i_127149);
                    bool x_127153 = sle64((int64_t) 0, gt_arg1_127152);
                    bool y_127154 = slt64(gt_arg1_127152, block_sizze_127093);
                    bool bounds_check_127155 = x_127153 && y_127154;
                    bool index_certs_127156;
                    
                    if (!bounds_check_127155) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127152, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127158 = slt64(i_127149, block_sizze_127093);
                    bool index_certs_127159;
                    
                    if (!y_127158) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127149, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_127157 = ((double *) mem_133194)[gt_arg1_127152];
                    double gt_arg0_127160 = ((double *) mem_133194)[i_127149];
                    bool defunc_0_leq_res_127161 = gt_arg0_127160 <= gt_arg1_127157;
                    bool defunc_0_lifted_gt_res_127162 = !defunc_0_leq_res_127161;
                    bool s_127163;
                    int64_t s_127166;
                    bool loop_while_127167;
                    int64_t j_127170;
                    
                    loop_while_127167 = defunc_0_lifted_gt_res_127162;
                    j_127170 = i_127149;
                    while (loop_while_127167) {
                        bool x_127171 = sle64((int64_t) 0, j_127170);
                        bool y_127172 = slt64(j_127170, block_sizze_127093);
                        bool bounds_check_127173 = x_127171 && y_127172;
                        bool index_certs_127174;
                        
                        if (!bounds_check_127173) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127170, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127177 = add64((int64_t) 1, j_127170);
                        bool x_127178 = sle64((int64_t) 0, copy_arg0_127177);
                        bool y_127179 = slt64(copy_arg0_127177, block_sizze_127093);
                        bool bounds_check_127180 = x_127178 && y_127179;
                        bool index_certs_127181;
                        
                        if (!bounds_check_127180) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127177, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_127175 = ((double *) mem_133194)[j_127170];
                        int64_t copy_arg0_127176 = ((int64_t *) mem_133196)[j_127170];
                        double copy_arg0_127182 = ((double *) mem_133194)[copy_arg0_127177];
                        int64_t copy_arg0_127183 = ((int64_t *) mem_133196)[copy_arg0_127177];
                        
                        ((double *) mem_133194)[j_127170] = copy_arg0_127182;
                        ((int64_t *) mem_133196)[j_127170] = copy_arg0_127183;
                        ((double *) mem_133194)[copy_arg0_127177] = copy_arg0_127175;
                        ((int64_t *) mem_133196)[copy_arg0_127177] = copy_arg0_127176;
                        
                        int64_t tmp_127188 = sub64(j_127170, (int64_t) 1);
                        bool cond_127189 = sle64((int64_t) 0, tmp_127188);
                        bool loop_cond_127190;
                        
                        if (cond_127189) {
                            bool y_128911 = slt64(tmp_127188, block_sizze_127093);
                            bool bounds_check_128912 = cond_127189 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127188, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_128910 = ((double *) mem_133194)[j_127170];
                            double gt_arg0_128914 = ((double *) mem_133194)[tmp_127188];
                            bool defunc_0_leq_res_128915 = gt_arg0_128914 <= gt_arg1_128910;
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127190 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127190 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127190;
                        int64_t j_tmp_133530 = tmp_127188;
                        
                        loop_while_127167 = loop_while_tmp_133527;
                        j_127170 = j_tmp_133530;
                    }
                    s_127163 = loop_while_127167;
                    s_127166 = j_127170;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133181, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        if (memblock_alloc(ctx, &mem_133253, bytes_133180, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        
        int64_t data_127203;
        bool data_127204;
        int64_t data_127207;
        int64_t loop_dz2084Uz2082U_127208;
        bool loop_while_127209;
        int64_t stride_127212;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127208 = flat_dim_127094;
        loop_while_127209 = loop_cond_127200;
        stride_127212 = block_sizze_127093;
        while (loop_while_127209) {
            int64_t next_stride_127213 = mul64((int64_t) 2, stride_127212);
            bool zzero_127214 = next_stride_127213 == (int64_t) 0;
            bool nonzzero_127215 = !zzero_127214;
            bool nonzzero_cert_127216;
            
            if (!nonzzero_127215) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127217 = sdiv64(flat_dim_127094, next_stride_127213);
            bool bounds_invalid_upwards_127218 = slt64(num_merges_127217, (int64_t) 0);
            bool valid_127219 = !bounds_invalid_upwards_127218;
            bool range_valid_c_127220;
            
            if (!valid_127219) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127217, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:117:36-40\n   #6  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127222 = sub64(next_stride_127213, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127223 = sle64((int64_t) 0, m_127222);
            bool cond_127225 = slt64(next_stride_127213, (int64_t) 10);
            bool protect_assert_disj_127226 = nonzzero_127202 || cond_127225;
            bool nonzzero_cert_127227;
            
            if (!protect_assert_disj_127226) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127228 = smod_safe64(next_stride_127213, merge_block_sizze_127098);
            bool num_blocks_127229 = zeze_lhs_127228 == (int64_t) 0;
            bool protect_assert_disj_127230 = cond_127225 || num_blocks_127229;
            bool assert_c_127231;
            
            if (!protect_assert_disj_127230) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127233 = sdiv_safe64(next_stride_127213, merge_block_sizze_127098);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234 = add64((int64_t) 1, num_blocks_127233);
            int64_t j_m_i_127235 = sub64(next_stride_127213, stride_127212);
            int64_t flat_dim_127236 = merge_block_sizze_127098 * num_blocks_127233;
            bool bounds_invalid_upwards_127237 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, (int64_t) 0);
            bool empty_slice_127238 = j_m_i_127235 == (int64_t) 0;
            int64_t m_127239 = sub64(j_m_i_127235, (int64_t) 1);
            bool zzero_lte_i_127240 = sle64((int64_t) 0, stride_127212);
            bool i_lte_j_127241 = sle64(stride_127212, next_stride_127213);
            bool empty_slice_127242 = stride_127212 == (int64_t) 0;
            int64_t m_127243 = sub64(stride_127212, (int64_t) 1);
            bool bounds_invalid_upwards_127244 = slt64(num_blocks_127233, (int64_t) 0);
            bool cond_127245 = slt64((int64_t) 0, stride_127212);
            bool valid_127246 = !bounds_invalid_upwards_127237;
            int64_t i_p_m_t_s_127247 = add64(stride_127212, m_127239);
            bool zzero_leq_i_p_m_t_s_127248 = sle64((int64_t) 0, m_127243);
            bool i_p_m_t_s_leq_w_127249 = slt64(m_127243, next_stride_127213);
            bool valid_127250 = !bounds_invalid_upwards_127244;
            bool i_p_m_t_s_leq_w_127251 = slt64(m_127222, flat_dim_127236);
            bool y_127252 = slt64((int64_t) 0, j_m_i_127235);
            bool protect_assert_disj_127253 = cond_127225 || valid_127246;
            bool range_valid_c_127254;
            
            if (!protect_assert_disj_127253) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127255 = sle64((int64_t) 0, i_p_m_t_s_127247);
            bool i_p_m_t_s_leq_w_127256 = slt64(i_p_m_t_s_127247, next_stride_127213);
            bool y_127257 = zzero_leq_i_p_m_t_s_127248 && i_p_m_t_s_leq_w_127249;
            bool protect_assert_disj_127258 = cond_127225 || valid_127250;
            bool range_valid_c_127259;
            
            if (!protect_assert_disj_127258) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127233, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127260 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127251;
            bool y_127261 = zzero_lte_i_127240 && i_p_m_t_s_leq_w_127256;
            bool forwards_ok_127262 = zzero_lte_i_127240 && y_127257;
            bool ok_or_empty_127263 = zzero_127214 || y_127260;
            bool protect_assert_disj_127264 = cond_127245 || y_127252;
            bool y_127265 = zzero_leq_i_p_m_t_s_127255 && y_127261;
            bool ok_or_empty_127266 = empty_slice_127242 || forwards_ok_127262;
            bool protect_assert_disj_127267 = cond_127225 || ok_or_empty_127263;
            bool index_certs_127268;
            
            if (!protect_assert_disj_127267) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) flat_dim_127236, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127269 = !cond_127225;
            bool protect_assert_disj_127270 = protect_assert_disj_127264 || loop_not_taken_127269;
            bool index_certs_127271;
            
            if (!protect_assert_disj_127270) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127272 = i_lte_j_127241 && y_127265;
            bool protect_assert_disj_127273 = cond_127225 || ok_or_empty_127266;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127275 = ok_or_empty_127266 || loop_not_taken_127269;
            bool index_certs_127276;
            
            if (!protect_assert_disj_127275) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127277 = empty_slice_127238 || forwards_ok_127272;
            bool protect_assert_disj_127278 = cond_127225 || ok_or_empty_127277;
            bool index_certs_127279;
            
            if (!protect_assert_disj_127278) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127280 = loop_not_taken_127269 || ok_or_empty_127277;
            bool index_certs_127281;
            
            if (!protect_assert_disj_127280) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 8 * num_merges_127217;
            int64_t bytes_133262 = next_stride_127213 * binop_x_133261;
            bool i_lte_j_127224 = sle64((int64_t) 0, next_stride_127213);
            
            if (mem_133263_cached_sizze_133819 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133819, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133820 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133820, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234;
            int64_t binop_x_133291 = (int64_t) 8 * num_blocks_127233;
            int64_t bytes_133292 = merge_block_sizze_127098 * binop_x_133291;
            int64_t bytes_133337 = (int64_t) 16 * stride_127212;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127217; i_133075++) {
                int64_t start_127285 = mul64(next_stride_127213, i_133075);
                int64_t j_m_i_127286 = sub64(loop_dz2084Uz2082U_127208, start_127285);
                bool empty_slice_127287 = j_m_i_127286 == (int64_t) 0;
                int64_t m_127288 = sub64(j_m_i_127286, (int64_t) 1);
                int64_t i_p_m_t_s_127289 = add64(start_127285, m_127288);
                bool zzero_leq_i_p_m_t_s_127290 = sle64((int64_t) 0, i_p_m_t_s_127289);
                bool i_p_m_t_s_leq_w_127291 = slt64(i_p_m_t_s_127289, loop_dz2084Uz2082U_127208);
                bool zzero_lte_i_127292 = sle64((int64_t) 0, start_127285);
                bool i_lte_j_127293 = sle64(start_127285, loop_dz2084Uz2082U_127208);
                bool y_127294 = i_p_m_t_s_leq_w_127291 && zzero_lte_i_127292;
                bool y_127295 = zzero_leq_i_p_m_t_s_127290 && y_127294;
                bool forwards_ok_127296 = i_lte_j_127293 && y_127295;
                bool ok_or_empty_127297 = empty_slice_127287 || forwards_ok_127296;
                bool index_certs_127298;
                
                if (!ok_or_empty_127297) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127285, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127208, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127299 = slt64(m_127222, j_m_i_127286);
                bool y_127300 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127299;
                bool forwards_ok_127301 = i_lte_j_127224 && y_127300;
                bool ok_or_empty_127302 = zzero_127214 || forwards_ok_127301;
                bool index_certs_127303;
                
                if (!ok_or_empty_127302) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) j_m_i_127286, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127225) {
                    double dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127245) {
                        double head_res_128944 = ((double *) mem_param_133257.mem)[start_127285];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127285];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127212 + start_127285;
                        double head_res_128947 = ((double *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127213; nest_i_133540++) {
                        ((double *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133337, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127213; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127213; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127235;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127212);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127235);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127212 + j_128958;
                                int64_t slice_128968 = start_127285 + slice_128967;
                                double leq_arg1_128969 = ((double *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127285 + i_128955;
                                double leq_arg0_128974 = ((double *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = leq_arg0_128974 <= leq_arg1_128969;
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        double loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127212);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127285 + i_128955;
                            double tmp_128985 = ((double *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127235);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127212 + j_128958;
                            int64_t slice_128992 = start_127285 + slice_128991;
                            double tmp_128993 = ((double *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((double *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133821 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133821, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133822 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133822, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234; i_133061++) {
                        int64_t split_count_arg3_127365 = mul64(merge_block_sizze_127098, i_133061);
                        int64_t defunc_0_split_count_res_127366;
                        int64_t defunc_0_split_count_res_127367;
                        int64_t defunc_0_split_count_res_127368;
                        int64_t defunc_0_split_count_res_127369;
                        int64_t defunc_0_split_count_res_127370;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127366, &defunc_0_split_count_res_127367, &defunc_0_split_count_res_127368, &defunc_0_split_count_res_127369, &defunc_0_split_count_res_127370, (int64_t) 0, stride_127212, (int64_t) 0, j_m_i_127235, split_count_arg3_127365) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127371 = slt64((int64_t) 0, defunc_0_split_count_res_127370);
                        bool defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        int64_t defunc_0_split_count_res_127377;
                        bool loop_while_127378;
                        int64_t ss_127379;
                        int64_t ss_127380;
                        int64_t tt_127381;
                        int64_t tt_127382;
                        int64_t count_127383;
                        
                        loop_while_127378 = loop_cond_127371;
                        ss_127379 = defunc_0_split_count_res_127366;
                        ss_127380 = defunc_0_split_count_res_127367;
                        tt_127381 = defunc_0_split_count_res_127368;
                        tt_127382 = defunc_0_split_count_res_127369;
                        count_127383 = defunc_0_split_count_res_127370;
                        while (loop_while_127378) {
                            int64_t zlze_lhs_127384 = sub64(ss_127380, ss_127379);
                            bool cond_127385 = sle64(zlze_lhs_127384, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127386;
                            int64_t defunc_0_lifted_step_res_127387;
                            int64_t defunc_0_lifted_step_res_127388;
                            int64_t defunc_0_lifted_step_res_127389;
                            
                            if (cond_127385) {
                                int64_t tmp_128997 = add64(tt_127381, count_127383);
                                
                                defunc_0_lifted_step_res_127386 = ss_127379;
                                defunc_0_lifted_step_res_127387 = tmp_128997;
                                defunc_0_lifted_step_res_127388 = tt_127382;
                                defunc_0_lifted_step_res_127389 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127391 = sub64(tt_127382, tt_127381);
                                bool cond_127392 = sle64(zlze_lhs_127391, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127393;
                                int64_t defunc_0_lifted_step_res_f_res_127394;
                                int64_t defunc_0_lifted_step_res_f_res_127395;
                                int64_t defunc_0_lifted_step_res_f_res_127396;
                                
                                if (cond_127392) {
                                    int64_t tmp_128998 = add64(ss_127379, count_127383);
                                    
                                    defunc_0_lifted_step_res_f_res_127393 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127394 = tt_127381;
                                    defunc_0_lifted_step_res_f_res_127395 = tt_127382;
                                    defunc_0_lifted_step_res_f_res_127396 = (int64_t) 0;
                                } else {
                                    bool cond_127398 = count_127383 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127399;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127400;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127401;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127402;
                                    
                                    if (cond_127398) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127379);
                                        bool y_129001 = slt64(ss_127379, stride_127212);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127379, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127381);
                                        bool y_129007 = slt64(tt_127381, j_m_i_127235);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127381, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127285 + ss_127379;
                                        double leq_arg1_129005 = ((double *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127212 + tt_127381;
                                        int64_t slice_129011 = start_127285 + slice_129010;
                                        double leq_arg0_129012 = ((double *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = leq_arg0_129012 <= leq_arg1_129005;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127381);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127379;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127379);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127381;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = tt_127382;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = (int64_t) 0;
                                    } else {
                                        int64_t m_127421 = sdiv64(count_127383, (int64_t) 2);
                                        int64_t n_127422 = sub64(count_127383, m_127421);
                                        bool cond_127423 = n_127422 == (int64_t) 0;
                                        int64_t zgze_lhs_127424 = add64(ss_127379, m_127421);
                                        bool cond_f_res_127425 = sle64(ss_127380, zgze_lhs_127424);
                                        bool x_127426 = !cond_127423;
                                        bool y_127427 = cond_f_res_127425 && x_127426;
                                        bool cond_127428 = cond_127423 || y_127427;
                                        bool leq_y_x_127429;
                                        
                                        if (cond_127428) {
                                            leq_y_x_127429 = 1;
                                        } else {
                                            bool x_127430 = sle64((int64_t) 0, zgze_lhs_127424);
                                            bool y_127431 = slt64(zgze_lhs_127424, stride_127212);
                                            bool bounds_check_127432 = x_127430 && y_127431;
                                            bool index_certs_127433;
                                            
                                            if (!bounds_check_127432) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127424, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127436 = add64(tt_127381, n_127422);
                                            int64_t leq_arg0_127437 = sub64(zm_lhs_127436, (int64_t) 1);
                                            bool x_127438 = sle64((int64_t) 0, leq_arg0_127437);
                                            bool y_127439 = slt64(leq_arg0_127437, j_m_i_127235);
                                            bool bounds_check_127440 = x_127438 && y_127439;
                                            bool index_certs_127441;
                                            
                                            if (!bounds_check_127440) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127437, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127434 = start_127285 + zgze_lhs_127424;
                                            double leq_arg1_127435 = ((double *) mem_param_133257.mem)[slice_127434];
                                            int64_t slice_127442 = stride_127212 + leq_arg0_127437;
                                            int64_t slice_127443 = start_127285 + slice_127442;
                                            double leq_arg0_127444 = ((double *) mem_param_133257.mem)[slice_127443];
                                            bool defunc_0_leq_res_127445 = leq_arg0_127444 <= leq_arg1_127435;
                                            
                                            leq_y_x_127429 = defunc_0_leq_res_127445;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                        
                                        if (leq_y_x_127429) {
                                            int64_t tmp_129018 = add64(tt_127381, n_127422);
                                            int64_t tmp_129019 = sub64(count_127383, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tt_127382;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = tmp_129019;
                                        } else {
                                            int64_t tmp_127451 = add64(tt_127381, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tt_127381;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tmp_127451;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = count_127383;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = ss_127379;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                    }
                                    defunc_0_lifted_step_res_f_res_127393 = defunc_0_lifted_step_res_f_res_f_res_127399;
                                    defunc_0_lifted_step_res_f_res_127394 = defunc_0_lifted_step_res_f_res_f_res_127400;
                                    defunc_0_lifted_step_res_f_res_127395 = defunc_0_lifted_step_res_f_res_f_res_127401;
                                    defunc_0_lifted_step_res_f_res_127396 = defunc_0_lifted_step_res_f_res_f_res_127402;
                                }
                                defunc_0_lifted_step_res_127386 = defunc_0_lifted_step_res_f_res_127393;
                                defunc_0_lifted_step_res_127387 = defunc_0_lifted_step_res_f_res_127394;
                                defunc_0_lifted_step_res_127388 = defunc_0_lifted_step_res_f_res_127395;
                                defunc_0_lifted_step_res_127389 = defunc_0_lifted_step_res_f_res_127396;
                            }
                            
                            int64_t loopres_127452;
                            int64_t loopres_127453;
                            int64_t loopres_127454;
                            int64_t loopres_127455;
                            int64_t loopres_127456;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127452, &loopres_127453, &loopres_127454, &loopres_127455, &loopres_127456, defunc_0_lifted_step_res_127386, ss_127380, defunc_0_lifted_step_res_127387, defunc_0_lifted_step_res_127388, defunc_0_lifted_step_res_127389) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127457 = slt64((int64_t) 0, loopres_127456);
                            bool loop_while_tmp_133547 = loop_cond_127457;
                            int64_t ss_tmp_133548 = loopres_127452;
                            int64_t ss_tmp_133549 = loopres_127453;
                            int64_t tt_tmp_133550 = loopres_127454;
                            int64_t tt_tmp_133551 = loopres_127455;
                            int64_t count_tmp_133552 = loopres_127456;
                            
                            loop_while_127378 = loop_while_tmp_133547;
                            ss_127379 = ss_tmp_133548;
                            ss_127380 = ss_tmp_133549;
                            tt_127381 = tt_tmp_133550;
                            tt_127382 = tt_tmp_133551;
                            count_127383 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127372 = loop_while_127378;
                        defunc_0_split_count_res_127373 = ss_127379;
                        defunc_0_split_count_res_127374 = ss_127380;
                        defunc_0_split_count_res_127375 = tt_127381;
                        defunc_0_split_count_res_127376 = tt_127382;
                        defunc_0_split_count_res_127377 = count_127383;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127373;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127375;
                    }
                    if (mem_133293_cached_sizze_133823 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133823, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133824 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133824, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127233; i_133068++) {
                        bool y_127463 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool index_certs_127465;
                        
                        if (!y_127463) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127466 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127467 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127468 = add64((int64_t) 1, i_133068);
                        bool x_127469 = sle64((int64_t) 0, tmp_127468);
                        bool y_127470 = slt64(tmp_127468, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool bounds_check_127471 = x_127469 && y_127470;
                        bool index_certs_127472;
                        
                        if (!bounds_check_127471) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127468, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133276)[tmp_127468];
                        int64_t defunc_0_f_res_127474 = ((int64_t *) mem_133278)[tmp_127468];
                        int64_t merge_sequential_arg2_127475 = add64(stride_127212, defunc_0_f_res_127467);
                        int64_t merge_sequential_arg2_127476 = add64(stride_127212, defunc_0_f_res_127474);
                        int64_t j_m_i_127477 = sub64(merge_sequential_arg2_127476, merge_sequential_arg2_127475);
                        bool empty_slice_127478 = j_m_i_127477 == (int64_t) 0;
                        int64_t m_127479 = sub64(j_m_i_127477, (int64_t) 1);
                        int64_t i_p_m_t_s_127480 = add64(merge_sequential_arg2_127475, m_127479);
                        bool zzero_leq_i_p_m_t_s_127481 = sle64((int64_t) 0, i_p_m_t_s_127480);
                        bool i_p_m_t_s_leq_w_127482 = slt64(i_p_m_t_s_127480, next_stride_127213);
                        bool zzero_lte_i_127483 = sle64((int64_t) 0, merge_sequential_arg2_127475);
                        bool i_lte_j_127484 = sle64(merge_sequential_arg2_127475, merge_sequential_arg2_127476);
                        bool y_127485 = i_p_m_t_s_leq_w_127482 && zzero_lte_i_127483;
                        bool y_127486 = zzero_leq_i_p_m_t_s_127481 && y_127485;
                        bool forwards_ok_127487 = i_lte_j_127484 && y_127486;
                        bool ok_or_empty_127488 = empty_slice_127478 || forwards_ok_127487;
                        bool index_certs_127489;
                        
                        if (!ok_or_empty_127488) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127475, ":", (long long) merge_sequential_arg2_127476, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127490 = sub64(defunc_0_f_res_127473, defunc_0_f_res_127466);
                        bool empty_slice_127491 = j_m_i_127490 == (int64_t) 0;
                        int64_t m_127492 = sub64(j_m_i_127490, (int64_t) 1);
                        int64_t i_p_m_t_s_127493 = add64(defunc_0_f_res_127466, m_127492);
                        bool zzero_leq_i_p_m_t_s_127494 = sle64((int64_t) 0, i_p_m_t_s_127493);
                        bool i_p_m_t_s_leq_w_127495 = slt64(i_p_m_t_s_127493, next_stride_127213);
                        bool zzero_lte_i_127496 = sle64((int64_t) 0, defunc_0_f_res_127466);
                        bool i_lte_j_127497 = sle64(defunc_0_f_res_127466, defunc_0_f_res_127473);
                        bool y_127498 = i_p_m_t_s_leq_w_127495 && zzero_lte_i_127496;
                        bool y_127499 = zzero_leq_i_p_m_t_s_127494 && y_127498;
                        bool forwards_ok_127500 = i_lte_j_127497 && y_127499;
                        bool ok_or_empty_127501 = empty_slice_127491 || forwards_ok_127500;
                        bool index_certs_127502;
                        
                        if (!ok_or_empty_127501) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127466, ":", (long long) defunc_0_f_res_127473, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127503 = slt64((int64_t) 0, j_m_i_127490);
                        double dummy_127504;
                        int64_t dummy_127505;
                        
                        if (cond_127503) {
                            bool index_certs_129020;
                            
                            if (!cond_127503) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:117:36-40\n   #12 ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127285 + defunc_0_f_res_127466;
                            double head_res_129022 = ((double *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127504 = head_res_129022;
                            dummy_127505 = head_res_129023;
                        } else {
                            bool y_127510 = slt64((int64_t) 0, j_m_i_127477);
                            bool index_certs_127511;
                            
                            if (!y_127510) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:117:36-40\n   #12 ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127512 = start_127285 + merge_sequential_arg2_127475;
                            double head_res_127513 = ((double *) mem_param_133257.mem)[slice_127512];
                            int64_t head_res_127514 = ((int64_t *) mem_param_133260.mem)[slice_127512];
                            
                            dummy_127504 = head_res_127513;
                            dummy_127505 = head_res_127514;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127098; nest_i_133555++) {
                            ((double *) mem_133293)[i_133068 * merge_block_sizze_127098 + nest_i_133555] = dummy_127504;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127098; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + nest_i_133556] = dummy_127505;
                        }
                        
                        int64_t data_127517;
                        int64_t i_127521 = (int64_t) 0;
                        
                        for (int64_t k_127520 = 0; k_127520 < merge_block_sizze_127098; k_127520++) {
                            int64_t j_127524 = sub64(k_127520, i_127521);
                            bool cond_127525 = j_127524 == j_m_i_127477;
                            bool cond_127526;
                            
                            if (cond_127525) {
                                cond_127526 = 1;
                            } else {
                                bool cond_127527 = slt64(i_127521, j_m_i_127490);
                                bool cond_f_res_127528;
                                
                                if (cond_127527) {
                                    bool x_129024 = sle64((int64_t) 0, j_127524);
                                    bool y_129025 = slt64(j_127524, j_m_i_127477);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127521);
                                    bool bounds_check_129032 = cond_127527 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127475 + j_127524;
                                    int64_t slice_129029 = start_127285 + slice_129028;
                                    double leq_arg1_129030 = ((double *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127466 + i_127521;
                                    int64_t slice_129035 = start_127285 + slice_129034;
                                    double leq_arg0_129036 = ((double *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = leq_arg0_129036 <= leq_arg1_129030;
                                    
                                    cond_f_res_127528 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127528 = 0;
                                }
                                cond_127526 = cond_f_res_127528;
                            }
                            
                            int64_t loopres_127543;
                            double loopres_127544;
                            int64_t loopres_127545;
                            
                            if (cond_127526) {
                                bool x_129039 = sle64((int64_t) 0, i_127521);
                                bool y_129040 = slt64(i_127521, j_m_i_127490);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127521);
                                int64_t slice_129043 = defunc_0_f_res_127466 + i_127521;
                                int64_t slice_129044 = start_127285 + slice_129043;
                                double tmp_129045 = ((double *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127543 = tmp_129038;
                                loopres_127544 = tmp_129045;
                                loopres_127545 = tmp_129046;
                            } else {
                                bool x_127555 = sle64((int64_t) 0, j_127524);
                                bool y_127556 = slt64(j_127524, j_m_i_127477);
                                bool bounds_check_127557 = x_127555 && y_127556;
                                bool index_certs_127558;
                                
                                if (!bounds_check_127557) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127559 = merge_sequential_arg2_127475 + j_127524;
                                int64_t slice_127560 = start_127285 + slice_127559;
                                double tmp_127561 = ((double *) mem_param_133257.mem)[slice_127560];
                                int64_t tmp_127562 = ((int64_t *) mem_param_133260.mem)[slice_127560];
                                
                                loopres_127543 = i_127521;
                                loopres_127544 = tmp_127561;
                                loopres_127545 = tmp_127562;
                            }
                            ((double *) mem_133293)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127544;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127545;
                            
                            int64_t i_tmp_133557 = loopres_127543;
                            
                            i_127521 = i_tmp_133557;
                        }
                        data_127517 = i_127521;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133292, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133263, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127569 = next_stride_127213 * num_merges_127217;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            if (memblock_alloc(ctx, &mem_133373, bytes_133262, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            
            bool loop_cond_127572 = slt64(next_stride_127213, flat_dim_127094);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127569;
            bool loop_while_tmp_133534 = loop_cond_127572;
            int64_t stride_tmp_133537 = next_stride_127213;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127208 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127209 = loop_while_tmp_133534;
            stride_127212 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127203 = loop_dz2084Uz2082U_127208;
        data_127204 = loop_while_127209;
        data_127207 = stride_127212;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127573 = n_84397 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127574 = sle64((int64_t) 0, zs_lhs_127078);
        bool i_p_m_t_s_leq_w_127575 = slt64(zs_lhs_127078, data_127203);
        bool y_127576 = zzero_leq_i_p_m_t_s_127574 && i_p_m_t_s_leq_w_127575;
        bool ok_or_empty_127577 = empty_slice_127573 || y_127576;
        bool index_certs_127578;
        
        if (!ok_or_empty_127577) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_84397, "] out of bounds for array of shape [", (long long) data_127203, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:117:36-40\n   #6  ftRelational.fut:114:9-117:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_84397; i_133082++) {
        int64_t eta_p_127586 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127587 = sle64((int64_t) 0, eta_p_127586);
        bool y_127588 = slt64(eta_p_127586, n_84397);
        bool bounds_check_127589 = x_127587 && y_127588;
        bool index_certs_127590;
        
        if (!bounds_check_127589) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127586, "] out of bounds for array of shape [", (long long) n_84397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double lifted_lambda_res_127591 = ((double *) k_mem_133175.mem)[eta_p_127586];
        
        ((double *) mem_133385.mem)[i_133082] = lifted_lambda_res_127591;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133387.mem, i_133082 * b_84398, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_133176.mem, eta_p_127586 * b_84398, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84398});
    }
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133813, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133814, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_133825, struct memblock *mem_out_p_133826, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_82032, int64_t b_82033)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133827 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133828 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133829 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133830 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133831 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133832 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133833 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133834 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133835 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133836 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_82032;
    bool cond_127077 = sle64(n_82032, (int64_t) 1);
    int64_t zs_lhs_127078 = sub64(n_82032, (int64_t) 1);
    int64_t zp_rhs_127079 = sdiv_safe64(zs_lhs_127078, (int64_t) 20);
    int64_t min_num_blocks_127080 = add64((int64_t) 1, zp_rhs_127079);
    bool loop_cond_127081 = slt64((int64_t) 1, min_num_blocks_127080);
    bool smallest_pow_2_geq_than_res_127082;
    int64_t smallest_pow_2_geq_than_res_127083;
    bool loop_while_127084;
    int64_t x_127085;
    
    loop_while_127084 = loop_cond_127081;
    x_127085 = (int64_t) 1;
    while (loop_while_127084) {
        int64_t loopres_127086 = mul64((int64_t) 2, x_127085);
        bool loop_cond_127087 = slt64(loopres_127086, min_num_blocks_127080);
        bool loop_while_tmp_133515 = loop_cond_127087;
        int64_t x_tmp_133516 = loopres_127086;
        
        loop_while_127084 = loop_while_tmp_133515;
        x_127085 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127082 = loop_while_127084;
    smallest_pow_2_geq_than_res_127083 = x_127085;
    
    bool zzero_127088 = smallest_pow_2_geq_than_res_127083 == (int64_t) 0;
    bool nonzzero_127089 = !zzero_127088;
    bool protect_assert_disj_127090 = cond_127077 || nonzzero_127089;
    bool nonzzero_cert_127091;
    
    if (!protect_assert_disj_127090) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127092 = sdiv_safe64(zs_lhs_127078, smallest_pow_2_geq_than_res_127083);
    int64_t block_sizze_127093 = add64((int64_t) 1, zp_rhs_127092);
    bool y_127099 = slt64((int64_t) 0, n_82032);
    bool protect_assert_disj_133419 = cond_127077 || y_127099;
    bool index_certs_127100;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_82032, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127114 = slt64(smallest_pow_2_geq_than_res_127083, (int64_t) 0);
    bool valid_127115 = !bounds_invalid_upwards_127114;
    bool protect_assert_disj_133427 = cond_127077 || valid_127115;
    bool range_valid_c_127116;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:113:36-40\n   #6  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127118 = slt64(block_sizze_127093, (int64_t) 0);
    bool valid_127119 = !bounds_invalid_upwards_127118;
    bool protect_assert_disj_133429 = cond_127077 || valid_127119;
    bool range_valid_c_127120;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127093, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127122 = sle64(block_sizze_127093, (int64_t) 1);
    int64_t tmp_127123 = sub64(block_sizze_127093, (int64_t) 2);
    bool bounds_invalid_upwards_127124 = slt64(tmp_127123, (int64_t) 0);
    bool valid_127126 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_127127 = cond_127122 || valid_127126;
    bool protect_assert_disj_133431 = cond_127077 || protect_assert_disj_127127;
    bool range_valid_c_127128;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127123, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133384 = (int64_t) 4 * n_82032;
    int64_t bytes_133386 = n_82032 * b_82033;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_82032; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127094 = smallest_pow_2_geq_than_res_127083 * block_sizze_127093;
    bool x_133414 = !cond_127077;
    int64_t greatest_divisor_leq_than_arg1_127097 = mul64((int64_t) 2, block_sizze_127093);
    int64_t merge_block_sizze_127098;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127097) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127098 = x_133416;
    } else {
        merge_block_sizze_127098 = (int64_t) 0;
    }
    
    float reduce_arg1_127101;
    
    if (x_133414) {
        float x_133420 = ((float *) k_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127101 = x_133420;
    } else {
        reduce_arg1_127101 = 0.0F;
    }
    
    float defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        float x_133422;
        int64_t x_133423;
        float redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127101;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_82032; i_133042++) {
            float x_127105 = ((float *) k_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127111 = redout_133040 <= x_127105;
            float defunc_0_op_res_127112;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127112 = x_127105;
            } else {
                defunc_0_op_res_127112 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127113;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127113 = i_133042;
            } else {
                defunc_0_op_res_127113 = redout_133041;
            }
            
            float redout_tmp_133519 = defunc_0_op_res_127112;
            int64_t redout_tmp_133520 = defunc_0_op_res_127113;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = 0.0F;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127125 = add64((int64_t) 1, tmp_127123);
    int64_t binop_x_133179 = (int64_t) 4 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133180 = block_sizze_127093 * binop_x_133179;
    int64_t binop_x_133182 = (int64_t) 8 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133183 = block_sizze_127093 * binop_x_133182;
    int64_t bytes_133193 = (int64_t) 4 * block_sizze_127093;
    int64_t bytes_133195 = (int64_t) 8 * block_sizze_127093;
    bool loop_cond_127200 = slt64(block_sizze_127093, flat_dim_127094);
    bool zzero_127201 = merge_block_sizze_127098 == (int64_t) 0;
    bool nonzzero_127202 = !zzero_127201;
    
    if (cond_127077) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133827 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133827, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133828 < bytes_133183) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133828, bytes_133183);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133829 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133829, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133830 < bytes_133195) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133830, bytes_133195);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127083; i_133054++) {
            int64_t zp_lhs_127132 = mul64(block_sizze_127093, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127093; i_133047++) {
                int64_t k_127136 = add64(zp_lhs_127132, i_133047);
                bool cond_127137 = slt64(k_127136, n_82032);
                float lifted_lambda_res_127138;
                int64_t lifted_lambda_res_127139;
                
                if (cond_127137) {
                    bool x_128906 = sle64((int64_t) 0, k_127136);
                    bool bounds_check_128907 = cond_127137 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127136, "] out of bounds for array of shape [", (long long) n_82032, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_128909 = ((float *) k_mem_133175.mem)[k_127136];
                    
                    lifted_lambda_res_127138 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127139 = k_127136;
                } else {
                    lifted_lambda_res_127138 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127139 = defunc_0_reduce_res_129054;
                }
                ((float *) mem_133194)[i_133047] = lifted_lambda_res_127138;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127139;
            }
            if (!cond_127122) {
                for (int64_t i_127149 = 0; i_127149 < distance_127125; i_127149++) {
                    int64_t gt_arg1_127152 = add64((int64_t) 1, i_127149);
                    bool x_127153 = sle64((int64_t) 0, gt_arg1_127152);
                    bool y_127154 = slt64(gt_arg1_127152, block_sizze_127093);
                    bool bounds_check_127155 = x_127153 && y_127154;
                    bool index_certs_127156;
                    
                    if (!bounds_check_127155) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127152, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127158 = slt64(i_127149, block_sizze_127093);
                    bool index_certs_127159;
                    
                    if (!y_127158) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127149, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_127157 = ((float *) mem_133194)[gt_arg1_127152];
                    float gt_arg0_127160 = ((float *) mem_133194)[i_127149];
                    bool defunc_0_leq_res_127161 = gt_arg0_127160 <= gt_arg1_127157;
                    bool defunc_0_lifted_gt_res_127162 = !defunc_0_leq_res_127161;
                    bool s_127163;
                    int64_t s_127166;
                    bool loop_while_127167;
                    int64_t j_127170;
                    
                    loop_while_127167 = defunc_0_lifted_gt_res_127162;
                    j_127170 = i_127149;
                    while (loop_while_127167) {
                        bool x_127171 = sle64((int64_t) 0, j_127170);
                        bool y_127172 = slt64(j_127170, block_sizze_127093);
                        bool bounds_check_127173 = x_127171 && y_127172;
                        bool index_certs_127174;
                        
                        if (!bounds_check_127173) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127170, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127177 = add64((int64_t) 1, j_127170);
                        bool x_127178 = sle64((int64_t) 0, copy_arg0_127177);
                        bool y_127179 = slt64(copy_arg0_127177, block_sizze_127093);
                        bool bounds_check_127180 = x_127178 && y_127179;
                        bool index_certs_127181;
                        
                        if (!bounds_check_127180) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127177, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_127175 = ((float *) mem_133194)[j_127170];
                        int64_t copy_arg0_127176 = ((int64_t *) mem_133196)[j_127170];
                        float copy_arg0_127182 = ((float *) mem_133194)[copy_arg0_127177];
                        int64_t copy_arg0_127183 = ((int64_t *) mem_133196)[copy_arg0_127177];
                        
                        ((float *) mem_133194)[j_127170] = copy_arg0_127182;
                        ((int64_t *) mem_133196)[j_127170] = copy_arg0_127183;
                        ((float *) mem_133194)[copy_arg0_127177] = copy_arg0_127175;
                        ((int64_t *) mem_133196)[copy_arg0_127177] = copy_arg0_127176;
                        
                        int64_t tmp_127188 = sub64(j_127170, (int64_t) 1);
                        bool cond_127189 = sle64((int64_t) 0, tmp_127188);
                        bool loop_cond_127190;
                        
                        if (cond_127189) {
                            bool y_128911 = slt64(tmp_127188, block_sizze_127093);
                            bool bounds_check_128912 = cond_127189 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127188, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_128910 = ((float *) mem_133194)[j_127170];
                            float gt_arg0_128914 = ((float *) mem_133194)[tmp_127188];
                            bool defunc_0_leq_res_128915 = gt_arg0_128914 <= gt_arg1_128910;
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127190 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127190 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127190;
                        int64_t j_tmp_133530 = tmp_127188;
                        
                        loop_while_127167 = loop_while_tmp_133527;
                        j_127170 = j_tmp_133530;
                    }
                    s_127163 = loop_while_127167;
                    s_127166 = j_127170;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133181, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint32_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        if (memblock_alloc(ctx, &mem_133253, bytes_133183, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        
        int64_t data_127203;
        bool data_127204;
        int64_t data_127207;
        int64_t loop_dz2084Uz2082U_127208;
        bool loop_while_127209;
        int64_t stride_127212;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127208 = flat_dim_127094;
        loop_while_127209 = loop_cond_127200;
        stride_127212 = block_sizze_127093;
        while (loop_while_127209) {
            int64_t next_stride_127213 = mul64((int64_t) 2, stride_127212);
            bool zzero_127214 = next_stride_127213 == (int64_t) 0;
            bool nonzzero_127215 = !zzero_127214;
            bool nonzzero_cert_127216;
            
            if (!nonzzero_127215) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127217 = sdiv64(flat_dim_127094, next_stride_127213);
            bool bounds_invalid_upwards_127218 = slt64(num_merges_127217, (int64_t) 0);
            bool valid_127219 = !bounds_invalid_upwards_127218;
            bool range_valid_c_127220;
            
            if (!valid_127219) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127217, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:113:36-40\n   #6  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127222 = sub64(next_stride_127213, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127223 = sle64((int64_t) 0, m_127222);
            bool cond_127225 = slt64(next_stride_127213, (int64_t) 10);
            bool protect_assert_disj_127226 = nonzzero_127202 || cond_127225;
            bool nonzzero_cert_127227;
            
            if (!protect_assert_disj_127226) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127228 = smod_safe64(next_stride_127213, merge_block_sizze_127098);
            bool num_blocks_127229 = zeze_lhs_127228 == (int64_t) 0;
            bool protect_assert_disj_127230 = cond_127225 || num_blocks_127229;
            bool assert_c_127231;
            
            if (!protect_assert_disj_127230) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127233 = sdiv_safe64(next_stride_127213, merge_block_sizze_127098);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234 = add64((int64_t) 1, num_blocks_127233);
            int64_t j_m_i_127235 = sub64(next_stride_127213, stride_127212);
            int64_t flat_dim_127236 = merge_block_sizze_127098 * num_blocks_127233;
            bool bounds_invalid_upwards_127237 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, (int64_t) 0);
            bool empty_slice_127238 = j_m_i_127235 == (int64_t) 0;
            int64_t m_127239 = sub64(j_m_i_127235, (int64_t) 1);
            bool zzero_lte_i_127240 = sle64((int64_t) 0, stride_127212);
            bool i_lte_j_127241 = sle64(stride_127212, next_stride_127213);
            bool empty_slice_127242 = stride_127212 == (int64_t) 0;
            int64_t m_127243 = sub64(stride_127212, (int64_t) 1);
            bool bounds_invalid_upwards_127244 = slt64(num_blocks_127233, (int64_t) 0);
            bool cond_127245 = slt64((int64_t) 0, stride_127212);
            bool valid_127246 = !bounds_invalid_upwards_127237;
            int64_t i_p_m_t_s_127247 = add64(stride_127212, m_127239);
            bool zzero_leq_i_p_m_t_s_127248 = sle64((int64_t) 0, m_127243);
            bool i_p_m_t_s_leq_w_127249 = slt64(m_127243, next_stride_127213);
            bool valid_127250 = !bounds_invalid_upwards_127244;
            bool i_p_m_t_s_leq_w_127251 = slt64(m_127222, flat_dim_127236);
            bool y_127252 = slt64((int64_t) 0, j_m_i_127235);
            bool protect_assert_disj_127253 = cond_127225 || valid_127246;
            bool range_valid_c_127254;
            
            if (!protect_assert_disj_127253) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127255 = sle64((int64_t) 0, i_p_m_t_s_127247);
            bool i_p_m_t_s_leq_w_127256 = slt64(i_p_m_t_s_127247, next_stride_127213);
            bool y_127257 = zzero_leq_i_p_m_t_s_127248 && i_p_m_t_s_leq_w_127249;
            bool protect_assert_disj_127258 = cond_127225 || valid_127250;
            bool range_valid_c_127259;
            
            if (!protect_assert_disj_127258) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127233, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127260 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127251;
            bool y_127261 = zzero_lte_i_127240 && i_p_m_t_s_leq_w_127256;
            bool forwards_ok_127262 = zzero_lte_i_127240 && y_127257;
            bool ok_or_empty_127263 = zzero_127214 || y_127260;
            bool protect_assert_disj_127264 = cond_127245 || y_127252;
            bool y_127265 = zzero_leq_i_p_m_t_s_127255 && y_127261;
            bool ok_or_empty_127266 = empty_slice_127242 || forwards_ok_127262;
            bool protect_assert_disj_127267 = cond_127225 || ok_or_empty_127263;
            bool index_certs_127268;
            
            if (!protect_assert_disj_127267) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) flat_dim_127236, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127269 = !cond_127225;
            bool protect_assert_disj_127270 = protect_assert_disj_127264 || loop_not_taken_127269;
            bool index_certs_127271;
            
            if (!protect_assert_disj_127270) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127272 = i_lte_j_127241 && y_127265;
            bool protect_assert_disj_127273 = cond_127225 || ok_or_empty_127266;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127275 = ok_or_empty_127266 || loop_not_taken_127269;
            bool index_certs_127276;
            
            if (!protect_assert_disj_127275) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127277 = empty_slice_127238 || forwards_ok_127272;
            bool protect_assert_disj_127278 = cond_127225 || ok_or_empty_127277;
            bool index_certs_127279;
            
            if (!protect_assert_disj_127278) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127280 = loop_not_taken_127269 || ok_or_empty_127277;
            bool index_certs_127281;
            
            if (!protect_assert_disj_127280) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 4 * num_merges_127217;
            int64_t bytes_133262 = next_stride_127213 * binop_x_133261;
            int64_t binop_x_133264 = (int64_t) 8 * num_merges_127217;
            int64_t bytes_133265 = next_stride_127213 * binop_x_133264;
            bool i_lte_j_127224 = sle64((int64_t) 0, next_stride_127213);
            
            if (mem_133263_cached_sizze_133831 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133831, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133832 < bytes_133265) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133832, bytes_133265);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234;
            int64_t binop_x_133291 = (int64_t) 4 * num_blocks_127233;
            int64_t bytes_133292 = merge_block_sizze_127098 * binop_x_133291;
            int64_t binop_x_133294 = (int64_t) 8 * num_blocks_127233;
            int64_t bytes_133295 = merge_block_sizze_127098 * binop_x_133294;
            int64_t bytes_133337 = (int64_t) 8 * stride_127212;
            int64_t bytes_133339 = (int64_t) 16 * stride_127212;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127217; i_133075++) {
                int64_t start_127285 = mul64(next_stride_127213, i_133075);
                int64_t j_m_i_127286 = sub64(loop_dz2084Uz2082U_127208, start_127285);
                bool empty_slice_127287 = j_m_i_127286 == (int64_t) 0;
                int64_t m_127288 = sub64(j_m_i_127286, (int64_t) 1);
                int64_t i_p_m_t_s_127289 = add64(start_127285, m_127288);
                bool zzero_leq_i_p_m_t_s_127290 = sle64((int64_t) 0, i_p_m_t_s_127289);
                bool i_p_m_t_s_leq_w_127291 = slt64(i_p_m_t_s_127289, loop_dz2084Uz2082U_127208);
                bool zzero_lte_i_127292 = sle64((int64_t) 0, start_127285);
                bool i_lte_j_127293 = sle64(start_127285, loop_dz2084Uz2082U_127208);
                bool y_127294 = i_p_m_t_s_leq_w_127291 && zzero_lte_i_127292;
                bool y_127295 = zzero_leq_i_p_m_t_s_127290 && y_127294;
                bool forwards_ok_127296 = i_lte_j_127293 && y_127295;
                bool ok_or_empty_127297 = empty_slice_127287 || forwards_ok_127296;
                bool index_certs_127298;
                
                if (!ok_or_empty_127297) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127285, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127208, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127299 = slt64(m_127222, j_m_i_127286);
                bool y_127300 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127299;
                bool forwards_ok_127301 = i_lte_j_127224 && y_127300;
                bool ok_or_empty_127302 = zzero_127214 || forwards_ok_127301;
                bool index_certs_127303;
                
                if (!ok_or_empty_127302) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) j_m_i_127286, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127225) {
                    float dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127245) {
                        float head_res_128944 = ((float *) mem_param_133257.mem)[start_127285];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127285];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127212 + start_127285;
                        float head_res_128947 = ((float *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127213; nest_i_133540++) {
                        ((float *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133339, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127213; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127213; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127235;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127212);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127235);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127212 + j_128958;
                                int64_t slice_128968 = start_127285 + slice_128967;
                                float leq_arg1_128969 = ((float *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127285 + i_128955;
                                float leq_arg0_128974 = ((float *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = leq_arg0_128974 <= leq_arg1_128969;
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        float loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127212);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127285 + i_128955;
                            float tmp_128985 = ((float *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127235);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127212 + j_128958;
                            int64_t slice_128992 = start_127285 + slice_128991;
                            float tmp_128993 = ((float *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((float *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133833 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133833, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133834 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133834, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234; i_133061++) {
                        int64_t split_count_arg3_127365 = mul64(merge_block_sizze_127098, i_133061);
                        int64_t defunc_0_split_count_res_127366;
                        int64_t defunc_0_split_count_res_127367;
                        int64_t defunc_0_split_count_res_127368;
                        int64_t defunc_0_split_count_res_127369;
                        int64_t defunc_0_split_count_res_127370;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127366, &defunc_0_split_count_res_127367, &defunc_0_split_count_res_127368, &defunc_0_split_count_res_127369, &defunc_0_split_count_res_127370, (int64_t) 0, stride_127212, (int64_t) 0, j_m_i_127235, split_count_arg3_127365) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127371 = slt64((int64_t) 0, defunc_0_split_count_res_127370);
                        bool defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        int64_t defunc_0_split_count_res_127377;
                        bool loop_while_127378;
                        int64_t ss_127379;
                        int64_t ss_127380;
                        int64_t tt_127381;
                        int64_t tt_127382;
                        int64_t count_127383;
                        
                        loop_while_127378 = loop_cond_127371;
                        ss_127379 = defunc_0_split_count_res_127366;
                        ss_127380 = defunc_0_split_count_res_127367;
                        tt_127381 = defunc_0_split_count_res_127368;
                        tt_127382 = defunc_0_split_count_res_127369;
                        count_127383 = defunc_0_split_count_res_127370;
                        while (loop_while_127378) {
                            int64_t zlze_lhs_127384 = sub64(ss_127380, ss_127379);
                            bool cond_127385 = sle64(zlze_lhs_127384, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127386;
                            int64_t defunc_0_lifted_step_res_127387;
                            int64_t defunc_0_lifted_step_res_127388;
                            int64_t defunc_0_lifted_step_res_127389;
                            
                            if (cond_127385) {
                                int64_t tmp_128997 = add64(tt_127381, count_127383);
                                
                                defunc_0_lifted_step_res_127386 = ss_127379;
                                defunc_0_lifted_step_res_127387 = tmp_128997;
                                defunc_0_lifted_step_res_127388 = tt_127382;
                                defunc_0_lifted_step_res_127389 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127391 = sub64(tt_127382, tt_127381);
                                bool cond_127392 = sle64(zlze_lhs_127391, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127393;
                                int64_t defunc_0_lifted_step_res_f_res_127394;
                                int64_t defunc_0_lifted_step_res_f_res_127395;
                                int64_t defunc_0_lifted_step_res_f_res_127396;
                                
                                if (cond_127392) {
                                    int64_t tmp_128998 = add64(ss_127379, count_127383);
                                    
                                    defunc_0_lifted_step_res_f_res_127393 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127394 = tt_127381;
                                    defunc_0_lifted_step_res_f_res_127395 = tt_127382;
                                    defunc_0_lifted_step_res_f_res_127396 = (int64_t) 0;
                                } else {
                                    bool cond_127398 = count_127383 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127399;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127400;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127401;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127402;
                                    
                                    if (cond_127398) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127379);
                                        bool y_129001 = slt64(ss_127379, stride_127212);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127379, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127381);
                                        bool y_129007 = slt64(tt_127381, j_m_i_127235);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127381, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127285 + ss_127379;
                                        float leq_arg1_129005 = ((float *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127212 + tt_127381;
                                        int64_t slice_129011 = start_127285 + slice_129010;
                                        float leq_arg0_129012 = ((float *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = leq_arg0_129012 <= leq_arg1_129005;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127381);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127379;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127379);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127381;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = tt_127382;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = (int64_t) 0;
                                    } else {
                                        int64_t m_127421 = sdiv64(count_127383, (int64_t) 2);
                                        int64_t n_127422 = sub64(count_127383, m_127421);
                                        bool cond_127423 = n_127422 == (int64_t) 0;
                                        int64_t zgze_lhs_127424 = add64(ss_127379, m_127421);
                                        bool cond_f_res_127425 = sle64(ss_127380, zgze_lhs_127424);
                                        bool x_127426 = !cond_127423;
                                        bool y_127427 = cond_f_res_127425 && x_127426;
                                        bool cond_127428 = cond_127423 || y_127427;
                                        bool leq_y_x_127429;
                                        
                                        if (cond_127428) {
                                            leq_y_x_127429 = 1;
                                        } else {
                                            bool x_127430 = sle64((int64_t) 0, zgze_lhs_127424);
                                            bool y_127431 = slt64(zgze_lhs_127424, stride_127212);
                                            bool bounds_check_127432 = x_127430 && y_127431;
                                            bool index_certs_127433;
                                            
                                            if (!bounds_check_127432) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127424, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127436 = add64(tt_127381, n_127422);
                                            int64_t leq_arg0_127437 = sub64(zm_lhs_127436, (int64_t) 1);
                                            bool x_127438 = sle64((int64_t) 0, leq_arg0_127437);
                                            bool y_127439 = slt64(leq_arg0_127437, j_m_i_127235);
                                            bool bounds_check_127440 = x_127438 && y_127439;
                                            bool index_certs_127441;
                                            
                                            if (!bounds_check_127440) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127437, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127434 = start_127285 + zgze_lhs_127424;
                                            float leq_arg1_127435 = ((float *) mem_param_133257.mem)[slice_127434];
                                            int64_t slice_127442 = stride_127212 + leq_arg0_127437;
                                            int64_t slice_127443 = start_127285 + slice_127442;
                                            float leq_arg0_127444 = ((float *) mem_param_133257.mem)[slice_127443];
                                            bool defunc_0_leq_res_127445 = leq_arg0_127444 <= leq_arg1_127435;
                                            
                                            leq_y_x_127429 = defunc_0_leq_res_127445;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                        
                                        if (leq_y_x_127429) {
                                            int64_t tmp_129018 = add64(tt_127381, n_127422);
                                            int64_t tmp_129019 = sub64(count_127383, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tt_127382;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = tmp_129019;
                                        } else {
                                            int64_t tmp_127451 = add64(tt_127381, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tt_127381;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tmp_127451;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = count_127383;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = ss_127379;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                    }
                                    defunc_0_lifted_step_res_f_res_127393 = defunc_0_lifted_step_res_f_res_f_res_127399;
                                    defunc_0_lifted_step_res_f_res_127394 = defunc_0_lifted_step_res_f_res_f_res_127400;
                                    defunc_0_lifted_step_res_f_res_127395 = defunc_0_lifted_step_res_f_res_f_res_127401;
                                    defunc_0_lifted_step_res_f_res_127396 = defunc_0_lifted_step_res_f_res_f_res_127402;
                                }
                                defunc_0_lifted_step_res_127386 = defunc_0_lifted_step_res_f_res_127393;
                                defunc_0_lifted_step_res_127387 = defunc_0_lifted_step_res_f_res_127394;
                                defunc_0_lifted_step_res_127388 = defunc_0_lifted_step_res_f_res_127395;
                                defunc_0_lifted_step_res_127389 = defunc_0_lifted_step_res_f_res_127396;
                            }
                            
                            int64_t loopres_127452;
                            int64_t loopres_127453;
                            int64_t loopres_127454;
                            int64_t loopres_127455;
                            int64_t loopres_127456;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127452, &loopres_127453, &loopres_127454, &loopres_127455, &loopres_127456, defunc_0_lifted_step_res_127386, ss_127380, defunc_0_lifted_step_res_127387, defunc_0_lifted_step_res_127388, defunc_0_lifted_step_res_127389) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127457 = slt64((int64_t) 0, loopres_127456);
                            bool loop_while_tmp_133547 = loop_cond_127457;
                            int64_t ss_tmp_133548 = loopres_127452;
                            int64_t ss_tmp_133549 = loopres_127453;
                            int64_t tt_tmp_133550 = loopres_127454;
                            int64_t tt_tmp_133551 = loopres_127455;
                            int64_t count_tmp_133552 = loopres_127456;
                            
                            loop_while_127378 = loop_while_tmp_133547;
                            ss_127379 = ss_tmp_133548;
                            ss_127380 = ss_tmp_133549;
                            tt_127381 = tt_tmp_133550;
                            tt_127382 = tt_tmp_133551;
                            count_127383 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127372 = loop_while_127378;
                        defunc_0_split_count_res_127373 = ss_127379;
                        defunc_0_split_count_res_127374 = ss_127380;
                        defunc_0_split_count_res_127375 = tt_127381;
                        defunc_0_split_count_res_127376 = tt_127382;
                        defunc_0_split_count_res_127377 = count_127383;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127373;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127375;
                    }
                    if (mem_133293_cached_sizze_133835 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133835, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133836 < bytes_133295) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133836, bytes_133295);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127233; i_133068++) {
                        bool y_127463 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool index_certs_127465;
                        
                        if (!y_127463) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127466 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127467 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127468 = add64((int64_t) 1, i_133068);
                        bool x_127469 = sle64((int64_t) 0, tmp_127468);
                        bool y_127470 = slt64(tmp_127468, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool bounds_check_127471 = x_127469 && y_127470;
                        bool index_certs_127472;
                        
                        if (!bounds_check_127471) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127468, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133276)[tmp_127468];
                        int64_t defunc_0_f_res_127474 = ((int64_t *) mem_133278)[tmp_127468];
                        int64_t merge_sequential_arg2_127475 = add64(stride_127212, defunc_0_f_res_127467);
                        int64_t merge_sequential_arg2_127476 = add64(stride_127212, defunc_0_f_res_127474);
                        int64_t j_m_i_127477 = sub64(merge_sequential_arg2_127476, merge_sequential_arg2_127475);
                        bool empty_slice_127478 = j_m_i_127477 == (int64_t) 0;
                        int64_t m_127479 = sub64(j_m_i_127477, (int64_t) 1);
                        int64_t i_p_m_t_s_127480 = add64(merge_sequential_arg2_127475, m_127479);
                        bool zzero_leq_i_p_m_t_s_127481 = sle64((int64_t) 0, i_p_m_t_s_127480);
                        bool i_p_m_t_s_leq_w_127482 = slt64(i_p_m_t_s_127480, next_stride_127213);
                        bool zzero_lte_i_127483 = sle64((int64_t) 0, merge_sequential_arg2_127475);
                        bool i_lte_j_127484 = sle64(merge_sequential_arg2_127475, merge_sequential_arg2_127476);
                        bool y_127485 = i_p_m_t_s_leq_w_127482 && zzero_lte_i_127483;
                        bool y_127486 = zzero_leq_i_p_m_t_s_127481 && y_127485;
                        bool forwards_ok_127487 = i_lte_j_127484 && y_127486;
                        bool ok_or_empty_127488 = empty_slice_127478 || forwards_ok_127487;
                        bool index_certs_127489;
                        
                        if (!ok_or_empty_127488) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127475, ":", (long long) merge_sequential_arg2_127476, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127490 = sub64(defunc_0_f_res_127473, defunc_0_f_res_127466);
                        bool empty_slice_127491 = j_m_i_127490 == (int64_t) 0;
                        int64_t m_127492 = sub64(j_m_i_127490, (int64_t) 1);
                        int64_t i_p_m_t_s_127493 = add64(defunc_0_f_res_127466, m_127492);
                        bool zzero_leq_i_p_m_t_s_127494 = sle64((int64_t) 0, i_p_m_t_s_127493);
                        bool i_p_m_t_s_leq_w_127495 = slt64(i_p_m_t_s_127493, next_stride_127213);
                        bool zzero_lte_i_127496 = sle64((int64_t) 0, defunc_0_f_res_127466);
                        bool i_lte_j_127497 = sle64(defunc_0_f_res_127466, defunc_0_f_res_127473);
                        bool y_127498 = i_p_m_t_s_leq_w_127495 && zzero_lte_i_127496;
                        bool y_127499 = zzero_leq_i_p_m_t_s_127494 && y_127498;
                        bool forwards_ok_127500 = i_lte_j_127497 && y_127499;
                        bool ok_or_empty_127501 = empty_slice_127491 || forwards_ok_127500;
                        bool index_certs_127502;
                        
                        if (!ok_or_empty_127501) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127466, ":", (long long) defunc_0_f_res_127473, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127503 = slt64((int64_t) 0, j_m_i_127490);
                        float dummy_127504;
                        int64_t dummy_127505;
                        
                        if (cond_127503) {
                            bool index_certs_129020;
                            
                            if (!cond_127503) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:113:36-40\n   #12 ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127285 + defunc_0_f_res_127466;
                            float head_res_129022 = ((float *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127504 = head_res_129022;
                            dummy_127505 = head_res_129023;
                        } else {
                            bool y_127510 = slt64((int64_t) 0, j_m_i_127477);
                            bool index_certs_127511;
                            
                            if (!y_127510) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:113:36-40\n   #12 ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127512 = start_127285 + merge_sequential_arg2_127475;
                            float head_res_127513 = ((float *) mem_param_133257.mem)[slice_127512];
                            int64_t head_res_127514 = ((int64_t *) mem_param_133260.mem)[slice_127512];
                            
                            dummy_127504 = head_res_127513;
                            dummy_127505 = head_res_127514;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127098; nest_i_133555++) {
                            ((float *) mem_133293)[i_133068 * merge_block_sizze_127098 + nest_i_133555] = dummy_127504;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127098; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + nest_i_133556] = dummy_127505;
                        }
                        
                        int64_t data_127517;
                        int64_t i_127521 = (int64_t) 0;
                        
                        for (int64_t k_127520 = 0; k_127520 < merge_block_sizze_127098; k_127520++) {
                            int64_t j_127524 = sub64(k_127520, i_127521);
                            bool cond_127525 = j_127524 == j_m_i_127477;
                            bool cond_127526;
                            
                            if (cond_127525) {
                                cond_127526 = 1;
                            } else {
                                bool cond_127527 = slt64(i_127521, j_m_i_127490);
                                bool cond_f_res_127528;
                                
                                if (cond_127527) {
                                    bool x_129024 = sle64((int64_t) 0, j_127524);
                                    bool y_129025 = slt64(j_127524, j_m_i_127477);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127521);
                                    bool bounds_check_129032 = cond_127527 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127475 + j_127524;
                                    int64_t slice_129029 = start_127285 + slice_129028;
                                    float leq_arg1_129030 = ((float *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127466 + i_127521;
                                    int64_t slice_129035 = start_127285 + slice_129034;
                                    float leq_arg0_129036 = ((float *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = leq_arg0_129036 <= leq_arg1_129030;
                                    
                                    cond_f_res_127528 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127528 = 0;
                                }
                                cond_127526 = cond_f_res_127528;
                            }
                            
                            int64_t loopres_127543;
                            float loopres_127544;
                            int64_t loopres_127545;
                            
                            if (cond_127526) {
                                bool x_129039 = sle64((int64_t) 0, i_127521);
                                bool y_129040 = slt64(i_127521, j_m_i_127490);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127521);
                                int64_t slice_129043 = defunc_0_f_res_127466 + i_127521;
                                int64_t slice_129044 = start_127285 + slice_129043;
                                float tmp_129045 = ((float *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127543 = tmp_129038;
                                loopres_127544 = tmp_129045;
                                loopres_127545 = tmp_129046;
                            } else {
                                bool x_127555 = sle64((int64_t) 0, j_127524);
                                bool y_127556 = slt64(j_127524, j_m_i_127477);
                                bool bounds_check_127557 = x_127555 && y_127556;
                                bool index_certs_127558;
                                
                                if (!bounds_check_127557) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127559 = merge_sequential_arg2_127475 + j_127524;
                                int64_t slice_127560 = start_127285 + slice_127559;
                                float tmp_127561 = ((float *) mem_param_133257.mem)[slice_127560];
                                int64_t tmp_127562 = ((int64_t *) mem_param_133260.mem)[slice_127560];
                                
                                loopres_127543 = i_127521;
                                loopres_127544 = tmp_127561;
                                loopres_127545 = tmp_127562;
                            }
                            ((float *) mem_133293)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127544;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127545;
                            
                            int64_t i_tmp_133557 = loopres_127543;
                            
                            i_127521 = i_tmp_133557;
                        }
                        data_127517 = i_127521;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint32_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133295, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_133263, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127569 = next_stride_127213 * num_merges_127217;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint32_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            if (memblock_alloc(ctx, &mem_133373, bytes_133265, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            
            bool loop_cond_127572 = slt64(next_stride_127213, flat_dim_127094);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127569;
            bool loop_while_tmp_133534 = loop_cond_127572;
            int64_t stride_tmp_133537 = next_stride_127213;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127208 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127209 = loop_while_tmp_133534;
            stride_127212 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127203 = loop_dz2084Uz2082U_127208;
        data_127204 = loop_while_127209;
        data_127207 = stride_127212;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127573 = n_82032 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127574 = sle64((int64_t) 0, zs_lhs_127078);
        bool i_p_m_t_s_leq_w_127575 = slt64(zs_lhs_127078, data_127203);
        bool y_127576 = zzero_leq_i_p_m_t_s_127574 && i_p_m_t_s_leq_w_127575;
        bool ok_or_empty_127577 = empty_slice_127573 || y_127576;
        bool index_certs_127578;
        
        if (!ok_or_empty_127577) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_82032, "] out of bounds for array of shape [", (long long) data_127203, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:113:36-40\n   #6  ftRelational.fut:110:9-113:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133384, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_82032; i_133082++) {
        int64_t eta_p_127586 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127587 = sle64((int64_t) 0, eta_p_127586);
        bool y_127588 = slt64(eta_p_127586, n_82032);
        bool bounds_check_127589 = x_127587 && y_127588;
        bool index_certs_127590;
        
        if (!bounds_check_127589) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127586, "] out of bounds for array of shape [", (long long) n_82032, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float lifted_lambda_res_127591 = ((float *) k_mem_133175.mem)[eta_p_127586];
        
        ((float *) mem_133385.mem)[i_133082] = lifted_lambda_res_127591;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133387.mem, i_133082 * b_82033, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_133176.mem, eta_p_127586 * b_82033, (int64_t []) {(int64_t) 1}, (int64_t []) {b_82033});
    }
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133825, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133826, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_133837, struct memblock *mem_out_p_133838, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_77312, int64_t b_77313)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133839 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133840 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133841 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133842 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133843 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133844 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133845 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133846 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133847 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133848 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_77312;
    bool cond_127077 = sle64(n_77312, (int64_t) 1);
    int64_t zs_lhs_127078 = sub64(n_77312, (int64_t) 1);
    int64_t zp_rhs_127079 = sdiv_safe64(zs_lhs_127078, (int64_t) 20);
    int64_t min_num_blocks_127080 = add64((int64_t) 1, zp_rhs_127079);
    bool loop_cond_127081 = slt64((int64_t) 1, min_num_blocks_127080);
    bool smallest_pow_2_geq_than_res_127082;
    int64_t smallest_pow_2_geq_than_res_127083;
    bool loop_while_127084;
    int64_t x_127085;
    
    loop_while_127084 = loop_cond_127081;
    x_127085 = (int64_t) 1;
    while (loop_while_127084) {
        int64_t loopres_127086 = mul64((int64_t) 2, x_127085);
        bool loop_cond_127087 = slt64(loopres_127086, min_num_blocks_127080);
        bool loop_while_tmp_133515 = loop_cond_127087;
        int64_t x_tmp_133516 = loopres_127086;
        
        loop_while_127084 = loop_while_tmp_133515;
        x_127085 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127082 = loop_while_127084;
    smallest_pow_2_geq_than_res_127083 = x_127085;
    
    bool zzero_127088 = smallest_pow_2_geq_than_res_127083 == (int64_t) 0;
    bool nonzzero_127089 = !zzero_127088;
    bool protect_assert_disj_127090 = cond_127077 || nonzzero_127089;
    bool nonzzero_cert_127091;
    
    if (!protect_assert_disj_127090) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127092 = sdiv_safe64(zs_lhs_127078, smallest_pow_2_geq_than_res_127083);
    int64_t block_sizze_127093 = add64((int64_t) 1, zp_rhs_127092);
    bool y_127099 = slt64((int64_t) 0, n_77312);
    bool protect_assert_disj_133419 = cond_127077 || y_127099;
    bool index_certs_127100;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_77312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127114 = slt64(smallest_pow_2_geq_than_res_127083, (int64_t) 0);
    bool valid_127115 = !bounds_invalid_upwards_127114;
    bool protect_assert_disj_133427 = cond_127077 || valid_127115;
    bool range_valid_c_127116;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:105:36-40\n   #6  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127118 = slt64(block_sizze_127093, (int64_t) 0);
    bool valid_127119 = !bounds_invalid_upwards_127118;
    bool protect_assert_disj_133429 = cond_127077 || valid_127119;
    bool range_valid_c_127120;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127093, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127122 = sle64(block_sizze_127093, (int64_t) 1);
    int64_t tmp_127123 = sub64(block_sizze_127093, (int64_t) 2);
    bool bounds_invalid_upwards_127124 = slt64(tmp_127123, (int64_t) 0);
    bool valid_127126 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_127127 = cond_127122 || valid_127126;
    bool protect_assert_disj_133431 = cond_127077 || protect_assert_disj_127127;
    bool range_valid_c_127128;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127123, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133384 = (int64_t) 4 * n_77312;
    int64_t bytes_133386 = n_77312 * b_77313;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_77312; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127094 = smallest_pow_2_geq_than_res_127083 * block_sizze_127093;
    bool x_133414 = !cond_127077;
    int64_t greatest_divisor_leq_than_arg1_127097 = mul64((int64_t) 2, block_sizze_127093);
    int64_t merge_block_sizze_127098;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127097) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127098 = x_133416;
    } else {
        merge_block_sizze_127098 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_127101;
    
    if (x_133414) {
        int32_t x_133420 = ((int32_t *) k_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127101 = x_133420;
    } else {
        reduce_arg1_127101 = 0;
    }
    
    int32_t defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        int32_t x_133422;
        int64_t x_133423;
        int32_t redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127101;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_77312; i_133042++) {
            int32_t x_127105 = ((int32_t *) k_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127111 = sle32(redout_133040, x_127105);
            int32_t defunc_0_op_res_127112;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127112 = x_127105;
            } else {
                defunc_0_op_res_127112 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127113;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127113 = i_133042;
            } else {
                defunc_0_op_res_127113 = redout_133041;
            }
            
            int32_t redout_tmp_133519 = defunc_0_op_res_127112;
            int64_t redout_tmp_133520 = defunc_0_op_res_127113;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = 0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127125 = add64((int64_t) 1, tmp_127123);
    int64_t binop_x_133179 = (int64_t) 4 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133180 = block_sizze_127093 * binop_x_133179;
    int64_t binop_x_133182 = (int64_t) 8 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133183 = block_sizze_127093 * binop_x_133182;
    int64_t bytes_133193 = (int64_t) 4 * block_sizze_127093;
    int64_t bytes_133195 = (int64_t) 8 * block_sizze_127093;
    bool loop_cond_127200 = slt64(block_sizze_127093, flat_dim_127094);
    bool zzero_127201 = merge_block_sizze_127098 == (int64_t) 0;
    bool nonzzero_127202 = !zzero_127201;
    
    if (cond_127077) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133839 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133839, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133840 < bytes_133183) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133840, bytes_133183);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133841 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133841, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133842 < bytes_133195) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133842, bytes_133195);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127083; i_133054++) {
            int64_t zp_lhs_127132 = mul64(block_sizze_127093, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127093; i_133047++) {
                int64_t k_127136 = add64(zp_lhs_127132, i_133047);
                bool cond_127137 = slt64(k_127136, n_77312);
                int32_t lifted_lambda_res_127138;
                int64_t lifted_lambda_res_127139;
                
                if (cond_127137) {
                    bool x_128906 = sle64((int64_t) 0, k_127136);
                    bool bounds_check_128907 = cond_127137 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127136, "] out of bounds for array of shape [", (long long) n_77312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_128909 = ((int32_t *) k_mem_133175.mem)[k_127136];
                    
                    lifted_lambda_res_127138 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127139 = k_127136;
                } else {
                    lifted_lambda_res_127138 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127139 = defunc_0_reduce_res_129054;
                }
                ((int32_t *) mem_133194)[i_133047] = lifted_lambda_res_127138;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127139;
            }
            if (!cond_127122) {
                for (int64_t i_127149 = 0; i_127149 < distance_127125; i_127149++) {
                    int64_t gt_arg1_127152 = add64((int64_t) 1, i_127149);
                    bool x_127153 = sle64((int64_t) 0, gt_arg1_127152);
                    bool y_127154 = slt64(gt_arg1_127152, block_sizze_127093);
                    bool bounds_check_127155 = x_127153 && y_127154;
                    bool index_certs_127156;
                    
                    if (!bounds_check_127155) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127152, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127158 = slt64(i_127149, block_sizze_127093);
                    bool index_certs_127159;
                    
                    if (!y_127158) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127149, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_127157 = ((int32_t *) mem_133194)[gt_arg1_127152];
                    int32_t gt_arg0_127160 = ((int32_t *) mem_133194)[i_127149];
                    bool defunc_0_leq_res_127161 = sle32(gt_arg0_127160, gt_arg1_127157);
                    bool defunc_0_lifted_gt_res_127162 = !defunc_0_leq_res_127161;
                    bool s_127163;
                    int64_t s_127166;
                    bool loop_while_127167;
                    int64_t j_127170;
                    
                    loop_while_127167 = defunc_0_lifted_gt_res_127162;
                    j_127170 = i_127149;
                    while (loop_while_127167) {
                        bool x_127171 = sle64((int64_t) 0, j_127170);
                        bool y_127172 = slt64(j_127170, block_sizze_127093);
                        bool bounds_check_127173 = x_127171 && y_127172;
                        bool index_certs_127174;
                        
                        if (!bounds_check_127173) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127170, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127177 = add64((int64_t) 1, j_127170);
                        bool x_127178 = sle64((int64_t) 0, copy_arg0_127177);
                        bool y_127179 = slt64(copy_arg0_127177, block_sizze_127093);
                        bool bounds_check_127180 = x_127178 && y_127179;
                        bool index_certs_127181;
                        
                        if (!bounds_check_127180) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127177, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_127175 = ((int32_t *) mem_133194)[j_127170];
                        int64_t copy_arg0_127176 = ((int64_t *) mem_133196)[j_127170];
                        int32_t copy_arg0_127182 = ((int32_t *) mem_133194)[copy_arg0_127177];
                        int64_t copy_arg0_127183 = ((int64_t *) mem_133196)[copy_arg0_127177];
                        
                        ((int32_t *) mem_133194)[j_127170] = copy_arg0_127182;
                        ((int64_t *) mem_133196)[j_127170] = copy_arg0_127183;
                        ((int32_t *) mem_133194)[copy_arg0_127177] = copy_arg0_127175;
                        ((int64_t *) mem_133196)[copy_arg0_127177] = copy_arg0_127176;
                        
                        int64_t tmp_127188 = sub64(j_127170, (int64_t) 1);
                        bool cond_127189 = sle64((int64_t) 0, tmp_127188);
                        bool loop_cond_127190;
                        
                        if (cond_127189) {
                            bool y_128911 = slt64(tmp_127188, block_sizze_127093);
                            bool bounds_check_128912 = cond_127189 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127188, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_128910 = ((int32_t *) mem_133194)[j_127170];
                            int32_t gt_arg0_128914 = ((int32_t *) mem_133194)[tmp_127188];
                            bool defunc_0_leq_res_128915 = sle32(gt_arg0_128914, gt_arg1_128910);
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127190 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127190 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127190;
                        int64_t j_tmp_133530 = tmp_127188;
                        
                        loop_while_127167 = loop_while_tmp_133527;
                        j_127170 = j_tmp_133530;
                    }
                    s_127163 = loop_while_127167;
                    s_127166 = j_127170;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133181, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint32_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        if (memblock_alloc(ctx, &mem_133253, bytes_133183, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        
        int64_t data_127203;
        bool data_127204;
        int64_t data_127207;
        int64_t loop_dz2084Uz2082U_127208;
        bool loop_while_127209;
        int64_t stride_127212;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127208 = flat_dim_127094;
        loop_while_127209 = loop_cond_127200;
        stride_127212 = block_sizze_127093;
        while (loop_while_127209) {
            int64_t next_stride_127213 = mul64((int64_t) 2, stride_127212);
            bool zzero_127214 = next_stride_127213 == (int64_t) 0;
            bool nonzzero_127215 = !zzero_127214;
            bool nonzzero_cert_127216;
            
            if (!nonzzero_127215) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127217 = sdiv64(flat_dim_127094, next_stride_127213);
            bool bounds_invalid_upwards_127218 = slt64(num_merges_127217, (int64_t) 0);
            bool valid_127219 = !bounds_invalid_upwards_127218;
            bool range_valid_c_127220;
            
            if (!valid_127219) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127217, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:105:36-40\n   #6  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127222 = sub64(next_stride_127213, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127223 = sle64((int64_t) 0, m_127222);
            bool cond_127225 = slt64(next_stride_127213, (int64_t) 10);
            bool protect_assert_disj_127226 = nonzzero_127202 || cond_127225;
            bool nonzzero_cert_127227;
            
            if (!protect_assert_disj_127226) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127228 = smod_safe64(next_stride_127213, merge_block_sizze_127098);
            bool num_blocks_127229 = zeze_lhs_127228 == (int64_t) 0;
            bool protect_assert_disj_127230 = cond_127225 || num_blocks_127229;
            bool assert_c_127231;
            
            if (!protect_assert_disj_127230) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127233 = sdiv_safe64(next_stride_127213, merge_block_sizze_127098);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234 = add64((int64_t) 1, num_blocks_127233);
            int64_t j_m_i_127235 = sub64(next_stride_127213, stride_127212);
            int64_t flat_dim_127236 = merge_block_sizze_127098 * num_blocks_127233;
            bool bounds_invalid_upwards_127237 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, (int64_t) 0);
            bool empty_slice_127238 = j_m_i_127235 == (int64_t) 0;
            int64_t m_127239 = sub64(j_m_i_127235, (int64_t) 1);
            bool zzero_lte_i_127240 = sle64((int64_t) 0, stride_127212);
            bool i_lte_j_127241 = sle64(stride_127212, next_stride_127213);
            bool empty_slice_127242 = stride_127212 == (int64_t) 0;
            int64_t m_127243 = sub64(stride_127212, (int64_t) 1);
            bool bounds_invalid_upwards_127244 = slt64(num_blocks_127233, (int64_t) 0);
            bool cond_127245 = slt64((int64_t) 0, stride_127212);
            bool valid_127246 = !bounds_invalid_upwards_127237;
            int64_t i_p_m_t_s_127247 = add64(stride_127212, m_127239);
            bool zzero_leq_i_p_m_t_s_127248 = sle64((int64_t) 0, m_127243);
            bool i_p_m_t_s_leq_w_127249 = slt64(m_127243, next_stride_127213);
            bool valid_127250 = !bounds_invalid_upwards_127244;
            bool i_p_m_t_s_leq_w_127251 = slt64(m_127222, flat_dim_127236);
            bool y_127252 = slt64((int64_t) 0, j_m_i_127235);
            bool protect_assert_disj_127253 = cond_127225 || valid_127246;
            bool range_valid_c_127254;
            
            if (!protect_assert_disj_127253) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127255 = sle64((int64_t) 0, i_p_m_t_s_127247);
            bool i_p_m_t_s_leq_w_127256 = slt64(i_p_m_t_s_127247, next_stride_127213);
            bool y_127257 = zzero_leq_i_p_m_t_s_127248 && i_p_m_t_s_leq_w_127249;
            bool protect_assert_disj_127258 = cond_127225 || valid_127250;
            bool range_valid_c_127259;
            
            if (!protect_assert_disj_127258) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127233, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127260 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127251;
            bool y_127261 = zzero_lte_i_127240 && i_p_m_t_s_leq_w_127256;
            bool forwards_ok_127262 = zzero_lte_i_127240 && y_127257;
            bool ok_or_empty_127263 = zzero_127214 || y_127260;
            bool protect_assert_disj_127264 = cond_127245 || y_127252;
            bool y_127265 = zzero_leq_i_p_m_t_s_127255 && y_127261;
            bool ok_or_empty_127266 = empty_slice_127242 || forwards_ok_127262;
            bool protect_assert_disj_127267 = cond_127225 || ok_or_empty_127263;
            bool index_certs_127268;
            
            if (!protect_assert_disj_127267) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) flat_dim_127236, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127269 = !cond_127225;
            bool protect_assert_disj_127270 = protect_assert_disj_127264 || loop_not_taken_127269;
            bool index_certs_127271;
            
            if (!protect_assert_disj_127270) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127272 = i_lte_j_127241 && y_127265;
            bool protect_assert_disj_127273 = cond_127225 || ok_or_empty_127266;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127275 = ok_or_empty_127266 || loop_not_taken_127269;
            bool index_certs_127276;
            
            if (!protect_assert_disj_127275) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127277 = empty_slice_127238 || forwards_ok_127272;
            bool protect_assert_disj_127278 = cond_127225 || ok_or_empty_127277;
            bool index_certs_127279;
            
            if (!protect_assert_disj_127278) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127280 = loop_not_taken_127269 || ok_or_empty_127277;
            bool index_certs_127281;
            
            if (!protect_assert_disj_127280) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 4 * num_merges_127217;
            int64_t bytes_133262 = next_stride_127213 * binop_x_133261;
            int64_t binop_x_133264 = (int64_t) 8 * num_merges_127217;
            int64_t bytes_133265 = next_stride_127213 * binop_x_133264;
            bool i_lte_j_127224 = sle64((int64_t) 0, next_stride_127213);
            
            if (mem_133263_cached_sizze_133843 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133843, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133844 < bytes_133265) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133844, bytes_133265);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234;
            int64_t binop_x_133291 = (int64_t) 4 * num_blocks_127233;
            int64_t bytes_133292 = merge_block_sizze_127098 * binop_x_133291;
            int64_t binop_x_133294 = (int64_t) 8 * num_blocks_127233;
            int64_t bytes_133295 = merge_block_sizze_127098 * binop_x_133294;
            int64_t bytes_133337 = (int64_t) 8 * stride_127212;
            int64_t bytes_133339 = (int64_t) 16 * stride_127212;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127217; i_133075++) {
                int64_t start_127285 = mul64(next_stride_127213, i_133075);
                int64_t j_m_i_127286 = sub64(loop_dz2084Uz2082U_127208, start_127285);
                bool empty_slice_127287 = j_m_i_127286 == (int64_t) 0;
                int64_t m_127288 = sub64(j_m_i_127286, (int64_t) 1);
                int64_t i_p_m_t_s_127289 = add64(start_127285, m_127288);
                bool zzero_leq_i_p_m_t_s_127290 = sle64((int64_t) 0, i_p_m_t_s_127289);
                bool i_p_m_t_s_leq_w_127291 = slt64(i_p_m_t_s_127289, loop_dz2084Uz2082U_127208);
                bool zzero_lte_i_127292 = sle64((int64_t) 0, start_127285);
                bool i_lte_j_127293 = sle64(start_127285, loop_dz2084Uz2082U_127208);
                bool y_127294 = i_p_m_t_s_leq_w_127291 && zzero_lte_i_127292;
                bool y_127295 = zzero_leq_i_p_m_t_s_127290 && y_127294;
                bool forwards_ok_127296 = i_lte_j_127293 && y_127295;
                bool ok_or_empty_127297 = empty_slice_127287 || forwards_ok_127296;
                bool index_certs_127298;
                
                if (!ok_or_empty_127297) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127285, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127208, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127299 = slt64(m_127222, j_m_i_127286);
                bool y_127300 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127299;
                bool forwards_ok_127301 = i_lte_j_127224 && y_127300;
                bool ok_or_empty_127302 = zzero_127214 || forwards_ok_127301;
                bool index_certs_127303;
                
                if (!ok_or_empty_127302) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) j_m_i_127286, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127225) {
                    int32_t dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127245) {
                        int32_t head_res_128944 = ((int32_t *) mem_param_133257.mem)[start_127285];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127285];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127212 + start_127285;
                        int32_t head_res_128947 = ((int32_t *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127213; nest_i_133540++) {
                        ((int32_t *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133339, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127213; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127213; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127235;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127212);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127235);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127212 + j_128958;
                                int64_t slice_128968 = start_127285 + slice_128967;
                                int32_t leq_arg1_128969 = ((int32_t *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127285 + i_128955;
                                int32_t leq_arg0_128974 = ((int32_t *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = sle32(leq_arg0_128974, leq_arg1_128969);
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        int32_t loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127212);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127285 + i_128955;
                            int32_t tmp_128985 = ((int32_t *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127235);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127212 + j_128958;
                            int64_t slice_128992 = start_127285 + slice_128991;
                            int32_t tmp_128993 = ((int32_t *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((int32_t *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133845 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133845, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133846 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133846, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234; i_133061++) {
                        int64_t split_count_arg3_127365 = mul64(merge_block_sizze_127098, i_133061);
                        int64_t defunc_0_split_count_res_127366;
                        int64_t defunc_0_split_count_res_127367;
                        int64_t defunc_0_split_count_res_127368;
                        int64_t defunc_0_split_count_res_127369;
                        int64_t defunc_0_split_count_res_127370;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127366, &defunc_0_split_count_res_127367, &defunc_0_split_count_res_127368, &defunc_0_split_count_res_127369, &defunc_0_split_count_res_127370, (int64_t) 0, stride_127212, (int64_t) 0, j_m_i_127235, split_count_arg3_127365) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127371 = slt64((int64_t) 0, defunc_0_split_count_res_127370);
                        bool defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        int64_t defunc_0_split_count_res_127377;
                        bool loop_while_127378;
                        int64_t ss_127379;
                        int64_t ss_127380;
                        int64_t tt_127381;
                        int64_t tt_127382;
                        int64_t count_127383;
                        
                        loop_while_127378 = loop_cond_127371;
                        ss_127379 = defunc_0_split_count_res_127366;
                        ss_127380 = defunc_0_split_count_res_127367;
                        tt_127381 = defunc_0_split_count_res_127368;
                        tt_127382 = defunc_0_split_count_res_127369;
                        count_127383 = defunc_0_split_count_res_127370;
                        while (loop_while_127378) {
                            int64_t zlze_lhs_127384 = sub64(ss_127380, ss_127379);
                            bool cond_127385 = sle64(zlze_lhs_127384, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127386;
                            int64_t defunc_0_lifted_step_res_127387;
                            int64_t defunc_0_lifted_step_res_127388;
                            int64_t defunc_0_lifted_step_res_127389;
                            
                            if (cond_127385) {
                                int64_t tmp_128997 = add64(tt_127381, count_127383);
                                
                                defunc_0_lifted_step_res_127386 = ss_127379;
                                defunc_0_lifted_step_res_127387 = tmp_128997;
                                defunc_0_lifted_step_res_127388 = tt_127382;
                                defunc_0_lifted_step_res_127389 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127391 = sub64(tt_127382, tt_127381);
                                bool cond_127392 = sle64(zlze_lhs_127391, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127393;
                                int64_t defunc_0_lifted_step_res_f_res_127394;
                                int64_t defunc_0_lifted_step_res_f_res_127395;
                                int64_t defunc_0_lifted_step_res_f_res_127396;
                                
                                if (cond_127392) {
                                    int64_t tmp_128998 = add64(ss_127379, count_127383);
                                    
                                    defunc_0_lifted_step_res_f_res_127393 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127394 = tt_127381;
                                    defunc_0_lifted_step_res_f_res_127395 = tt_127382;
                                    defunc_0_lifted_step_res_f_res_127396 = (int64_t) 0;
                                } else {
                                    bool cond_127398 = count_127383 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127399;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127400;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127401;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127402;
                                    
                                    if (cond_127398) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127379);
                                        bool y_129001 = slt64(ss_127379, stride_127212);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127379, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127381);
                                        bool y_129007 = slt64(tt_127381, j_m_i_127235);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127381, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127285 + ss_127379;
                                        int32_t leq_arg1_129005 = ((int32_t *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127212 + tt_127381;
                                        int64_t slice_129011 = start_127285 + slice_129010;
                                        int32_t leq_arg0_129012 = ((int32_t *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = sle32(leq_arg0_129012, leq_arg1_129005);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127381);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127379;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127379);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127381;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = tt_127382;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = (int64_t) 0;
                                    } else {
                                        int64_t m_127421 = sdiv64(count_127383, (int64_t) 2);
                                        int64_t n_127422 = sub64(count_127383, m_127421);
                                        bool cond_127423 = n_127422 == (int64_t) 0;
                                        int64_t zgze_lhs_127424 = add64(ss_127379, m_127421);
                                        bool cond_f_res_127425 = sle64(ss_127380, zgze_lhs_127424);
                                        bool x_127426 = !cond_127423;
                                        bool y_127427 = cond_f_res_127425 && x_127426;
                                        bool cond_127428 = cond_127423 || y_127427;
                                        bool leq_y_x_127429;
                                        
                                        if (cond_127428) {
                                            leq_y_x_127429 = 1;
                                        } else {
                                            bool x_127430 = sle64((int64_t) 0, zgze_lhs_127424);
                                            bool y_127431 = slt64(zgze_lhs_127424, stride_127212);
                                            bool bounds_check_127432 = x_127430 && y_127431;
                                            bool index_certs_127433;
                                            
                                            if (!bounds_check_127432) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127424, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127436 = add64(tt_127381, n_127422);
                                            int64_t leq_arg0_127437 = sub64(zm_lhs_127436, (int64_t) 1);
                                            bool x_127438 = sle64((int64_t) 0, leq_arg0_127437);
                                            bool y_127439 = slt64(leq_arg0_127437, j_m_i_127235);
                                            bool bounds_check_127440 = x_127438 && y_127439;
                                            bool index_certs_127441;
                                            
                                            if (!bounds_check_127440) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127437, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127434 = start_127285 + zgze_lhs_127424;
                                            int32_t leq_arg1_127435 = ((int32_t *) mem_param_133257.mem)[slice_127434];
                                            int64_t slice_127442 = stride_127212 + leq_arg0_127437;
                                            int64_t slice_127443 = start_127285 + slice_127442;
                                            int32_t leq_arg0_127444 = ((int32_t *) mem_param_133257.mem)[slice_127443];
                                            bool defunc_0_leq_res_127445 = sle32(leq_arg0_127444, leq_arg1_127435);
                                            
                                            leq_y_x_127429 = defunc_0_leq_res_127445;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                        
                                        if (leq_y_x_127429) {
                                            int64_t tmp_129018 = add64(tt_127381, n_127422);
                                            int64_t tmp_129019 = sub64(count_127383, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tt_127382;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = tmp_129019;
                                        } else {
                                            int64_t tmp_127451 = add64(tt_127381, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tt_127381;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tmp_127451;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = count_127383;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = ss_127379;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                    }
                                    defunc_0_lifted_step_res_f_res_127393 = defunc_0_lifted_step_res_f_res_f_res_127399;
                                    defunc_0_lifted_step_res_f_res_127394 = defunc_0_lifted_step_res_f_res_f_res_127400;
                                    defunc_0_lifted_step_res_f_res_127395 = defunc_0_lifted_step_res_f_res_f_res_127401;
                                    defunc_0_lifted_step_res_f_res_127396 = defunc_0_lifted_step_res_f_res_f_res_127402;
                                }
                                defunc_0_lifted_step_res_127386 = defunc_0_lifted_step_res_f_res_127393;
                                defunc_0_lifted_step_res_127387 = defunc_0_lifted_step_res_f_res_127394;
                                defunc_0_lifted_step_res_127388 = defunc_0_lifted_step_res_f_res_127395;
                                defunc_0_lifted_step_res_127389 = defunc_0_lifted_step_res_f_res_127396;
                            }
                            
                            int64_t loopres_127452;
                            int64_t loopres_127453;
                            int64_t loopres_127454;
                            int64_t loopres_127455;
                            int64_t loopres_127456;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127452, &loopres_127453, &loopres_127454, &loopres_127455, &loopres_127456, defunc_0_lifted_step_res_127386, ss_127380, defunc_0_lifted_step_res_127387, defunc_0_lifted_step_res_127388, defunc_0_lifted_step_res_127389) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127457 = slt64((int64_t) 0, loopres_127456);
                            bool loop_while_tmp_133547 = loop_cond_127457;
                            int64_t ss_tmp_133548 = loopres_127452;
                            int64_t ss_tmp_133549 = loopres_127453;
                            int64_t tt_tmp_133550 = loopres_127454;
                            int64_t tt_tmp_133551 = loopres_127455;
                            int64_t count_tmp_133552 = loopres_127456;
                            
                            loop_while_127378 = loop_while_tmp_133547;
                            ss_127379 = ss_tmp_133548;
                            ss_127380 = ss_tmp_133549;
                            tt_127381 = tt_tmp_133550;
                            tt_127382 = tt_tmp_133551;
                            count_127383 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127372 = loop_while_127378;
                        defunc_0_split_count_res_127373 = ss_127379;
                        defunc_0_split_count_res_127374 = ss_127380;
                        defunc_0_split_count_res_127375 = tt_127381;
                        defunc_0_split_count_res_127376 = tt_127382;
                        defunc_0_split_count_res_127377 = count_127383;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127373;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127375;
                    }
                    if (mem_133293_cached_sizze_133847 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133847, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133848 < bytes_133295) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133848, bytes_133295);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127233; i_133068++) {
                        bool y_127463 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool index_certs_127465;
                        
                        if (!y_127463) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127466 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127467 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127468 = add64((int64_t) 1, i_133068);
                        bool x_127469 = sle64((int64_t) 0, tmp_127468);
                        bool y_127470 = slt64(tmp_127468, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool bounds_check_127471 = x_127469 && y_127470;
                        bool index_certs_127472;
                        
                        if (!bounds_check_127471) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127468, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133276)[tmp_127468];
                        int64_t defunc_0_f_res_127474 = ((int64_t *) mem_133278)[tmp_127468];
                        int64_t merge_sequential_arg2_127475 = add64(stride_127212, defunc_0_f_res_127467);
                        int64_t merge_sequential_arg2_127476 = add64(stride_127212, defunc_0_f_res_127474);
                        int64_t j_m_i_127477 = sub64(merge_sequential_arg2_127476, merge_sequential_arg2_127475);
                        bool empty_slice_127478 = j_m_i_127477 == (int64_t) 0;
                        int64_t m_127479 = sub64(j_m_i_127477, (int64_t) 1);
                        int64_t i_p_m_t_s_127480 = add64(merge_sequential_arg2_127475, m_127479);
                        bool zzero_leq_i_p_m_t_s_127481 = sle64((int64_t) 0, i_p_m_t_s_127480);
                        bool i_p_m_t_s_leq_w_127482 = slt64(i_p_m_t_s_127480, next_stride_127213);
                        bool zzero_lte_i_127483 = sle64((int64_t) 0, merge_sequential_arg2_127475);
                        bool i_lte_j_127484 = sle64(merge_sequential_arg2_127475, merge_sequential_arg2_127476);
                        bool y_127485 = i_p_m_t_s_leq_w_127482 && zzero_lte_i_127483;
                        bool y_127486 = zzero_leq_i_p_m_t_s_127481 && y_127485;
                        bool forwards_ok_127487 = i_lte_j_127484 && y_127486;
                        bool ok_or_empty_127488 = empty_slice_127478 || forwards_ok_127487;
                        bool index_certs_127489;
                        
                        if (!ok_or_empty_127488) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127475, ":", (long long) merge_sequential_arg2_127476, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127490 = sub64(defunc_0_f_res_127473, defunc_0_f_res_127466);
                        bool empty_slice_127491 = j_m_i_127490 == (int64_t) 0;
                        int64_t m_127492 = sub64(j_m_i_127490, (int64_t) 1);
                        int64_t i_p_m_t_s_127493 = add64(defunc_0_f_res_127466, m_127492);
                        bool zzero_leq_i_p_m_t_s_127494 = sle64((int64_t) 0, i_p_m_t_s_127493);
                        bool i_p_m_t_s_leq_w_127495 = slt64(i_p_m_t_s_127493, next_stride_127213);
                        bool zzero_lte_i_127496 = sle64((int64_t) 0, defunc_0_f_res_127466);
                        bool i_lte_j_127497 = sle64(defunc_0_f_res_127466, defunc_0_f_res_127473);
                        bool y_127498 = i_p_m_t_s_leq_w_127495 && zzero_lte_i_127496;
                        bool y_127499 = zzero_leq_i_p_m_t_s_127494 && y_127498;
                        bool forwards_ok_127500 = i_lte_j_127497 && y_127499;
                        bool ok_or_empty_127501 = empty_slice_127491 || forwards_ok_127500;
                        bool index_certs_127502;
                        
                        if (!ok_or_empty_127501) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127466, ":", (long long) defunc_0_f_res_127473, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127503 = slt64((int64_t) 0, j_m_i_127490);
                        int32_t dummy_127504;
                        int64_t dummy_127505;
                        
                        if (cond_127503) {
                            bool index_certs_129020;
                            
                            if (!cond_127503) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:105:36-40\n   #12 ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127285 + defunc_0_f_res_127466;
                            int32_t head_res_129022 = ((int32_t *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127504 = head_res_129022;
                            dummy_127505 = head_res_129023;
                        } else {
                            bool y_127510 = slt64((int64_t) 0, j_m_i_127477);
                            bool index_certs_127511;
                            
                            if (!y_127510) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:105:36-40\n   #12 ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127512 = start_127285 + merge_sequential_arg2_127475;
                            int32_t head_res_127513 = ((int32_t *) mem_param_133257.mem)[slice_127512];
                            int64_t head_res_127514 = ((int64_t *) mem_param_133260.mem)[slice_127512];
                            
                            dummy_127504 = head_res_127513;
                            dummy_127505 = head_res_127514;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127098; nest_i_133555++) {
                            ((int32_t *) mem_133293)[i_133068 * merge_block_sizze_127098 + nest_i_133555] = dummy_127504;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127098; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + nest_i_133556] = dummy_127505;
                        }
                        
                        int64_t data_127517;
                        int64_t i_127521 = (int64_t) 0;
                        
                        for (int64_t k_127520 = 0; k_127520 < merge_block_sizze_127098; k_127520++) {
                            int64_t j_127524 = sub64(k_127520, i_127521);
                            bool cond_127525 = j_127524 == j_m_i_127477;
                            bool cond_127526;
                            
                            if (cond_127525) {
                                cond_127526 = 1;
                            } else {
                                bool cond_127527 = slt64(i_127521, j_m_i_127490);
                                bool cond_f_res_127528;
                                
                                if (cond_127527) {
                                    bool x_129024 = sle64((int64_t) 0, j_127524);
                                    bool y_129025 = slt64(j_127524, j_m_i_127477);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127521);
                                    bool bounds_check_129032 = cond_127527 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127475 + j_127524;
                                    int64_t slice_129029 = start_127285 + slice_129028;
                                    int32_t leq_arg1_129030 = ((int32_t *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127466 + i_127521;
                                    int64_t slice_129035 = start_127285 + slice_129034;
                                    int32_t leq_arg0_129036 = ((int32_t *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = sle32(leq_arg0_129036, leq_arg1_129030);
                                    
                                    cond_f_res_127528 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127528 = 0;
                                }
                                cond_127526 = cond_f_res_127528;
                            }
                            
                            int64_t loopres_127543;
                            int32_t loopres_127544;
                            int64_t loopres_127545;
                            
                            if (cond_127526) {
                                bool x_129039 = sle64((int64_t) 0, i_127521);
                                bool y_129040 = slt64(i_127521, j_m_i_127490);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127521);
                                int64_t slice_129043 = defunc_0_f_res_127466 + i_127521;
                                int64_t slice_129044 = start_127285 + slice_129043;
                                int32_t tmp_129045 = ((int32_t *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127543 = tmp_129038;
                                loopres_127544 = tmp_129045;
                                loopres_127545 = tmp_129046;
                            } else {
                                bool x_127555 = sle64((int64_t) 0, j_127524);
                                bool y_127556 = slt64(j_127524, j_m_i_127477);
                                bool bounds_check_127557 = x_127555 && y_127556;
                                bool index_certs_127558;
                                
                                if (!bounds_check_127557) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127559 = merge_sequential_arg2_127475 + j_127524;
                                int64_t slice_127560 = start_127285 + slice_127559;
                                int32_t tmp_127561 = ((int32_t *) mem_param_133257.mem)[slice_127560];
                                int64_t tmp_127562 = ((int64_t *) mem_param_133260.mem)[slice_127560];
                                
                                loopres_127543 = i_127521;
                                loopres_127544 = tmp_127561;
                                loopres_127545 = tmp_127562;
                            }
                            ((int32_t *) mem_133293)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127544;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127545;
                            
                            int64_t i_tmp_133557 = loopres_127543;
                            
                            i_127521 = i_tmp_133557;
                        }
                        data_127517 = i_127521;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint32_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133295, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_133263, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127569 = next_stride_127213 * num_merges_127217;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint32_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            if (memblock_alloc(ctx, &mem_133373, bytes_133265, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            
            bool loop_cond_127572 = slt64(next_stride_127213, flat_dim_127094);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127569;
            bool loop_while_tmp_133534 = loop_cond_127572;
            int64_t stride_tmp_133537 = next_stride_127213;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127208 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127209 = loop_while_tmp_133534;
            stride_127212 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127203 = loop_dz2084Uz2082U_127208;
        data_127204 = loop_while_127209;
        data_127207 = stride_127212;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127573 = n_77312 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127574 = sle64((int64_t) 0, zs_lhs_127078);
        bool i_p_m_t_s_leq_w_127575 = slt64(zs_lhs_127078, data_127203);
        bool y_127576 = zzero_leq_i_p_m_t_s_127574 && i_p_m_t_s_leq_w_127575;
        bool ok_or_empty_127577 = empty_slice_127573 || y_127576;
        bool index_certs_127578;
        
        if (!ok_or_empty_127577) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_77312, "] out of bounds for array of shape [", (long long) data_127203, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:105:36-40\n   #6  ftRelational.fut:102:9-105:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133384, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_77312; i_133082++) {
        int64_t eta_p_127586 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127587 = sle64((int64_t) 0, eta_p_127586);
        bool y_127588 = slt64(eta_p_127586, n_77312);
        bool bounds_check_127589 = x_127587 && y_127588;
        bool index_certs_127590;
        
        if (!bounds_check_127589) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127586, "] out of bounds for array of shape [", (long long) n_77312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t lifted_lambda_res_127591 = ((int32_t *) k_mem_133175.mem)[eta_p_127586];
        
        ((int32_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127591;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133387.mem, i_133082 * b_77313, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_133176.mem, eta_p_127586 * b_77313, (int64_t []) {(int64_t) 1}, (int64_t []) {b_77313});
    }
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133837, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133838, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_133849, struct memblock *mem_out_p_133850, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_79667, int64_t b_79668)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133851 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133852 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133853 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133854 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133855 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133856 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133857 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133858 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133859 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133860 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_79667;
    bool cond_127077 = sle64(n_79667, (int64_t) 1);
    int64_t zs_lhs_127078 = sub64(n_79667, (int64_t) 1);
    int64_t zp_rhs_127079 = sdiv_safe64(zs_lhs_127078, (int64_t) 20);
    int64_t min_num_blocks_127080 = add64((int64_t) 1, zp_rhs_127079);
    bool loop_cond_127081 = slt64((int64_t) 1, min_num_blocks_127080);
    bool smallest_pow_2_geq_than_res_127082;
    int64_t smallest_pow_2_geq_than_res_127083;
    bool loop_while_127084;
    int64_t x_127085;
    
    loop_while_127084 = loop_cond_127081;
    x_127085 = (int64_t) 1;
    while (loop_while_127084) {
        int64_t loopres_127086 = mul64((int64_t) 2, x_127085);
        bool loop_cond_127087 = slt64(loopres_127086, min_num_blocks_127080);
        bool loop_while_tmp_133515 = loop_cond_127087;
        int64_t x_tmp_133516 = loopres_127086;
        
        loop_while_127084 = loop_while_tmp_133515;
        x_127085 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127082 = loop_while_127084;
    smallest_pow_2_geq_than_res_127083 = x_127085;
    
    bool zzero_127088 = smallest_pow_2_geq_than_res_127083 == (int64_t) 0;
    bool nonzzero_127089 = !zzero_127088;
    bool protect_assert_disj_127090 = cond_127077 || nonzzero_127089;
    bool nonzzero_cert_127091;
    
    if (!protect_assert_disj_127090) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127092 = sdiv_safe64(zs_lhs_127078, smallest_pow_2_geq_than_res_127083);
    int64_t block_sizze_127093 = add64((int64_t) 1, zp_rhs_127092);
    bool y_127099 = slt64((int64_t) 0, n_79667);
    bool protect_assert_disj_133419 = cond_127077 || y_127099;
    bool index_certs_127100;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_79667, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127114 = slt64(smallest_pow_2_geq_than_res_127083, (int64_t) 0);
    bool valid_127115 = !bounds_invalid_upwards_127114;
    bool protect_assert_disj_133427 = cond_127077 || valid_127115;
    bool range_valid_c_127116;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:109:36-40\n   #6  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127118 = slt64(block_sizze_127093, (int64_t) 0);
    bool valid_127119 = !bounds_invalid_upwards_127118;
    bool protect_assert_disj_133429 = cond_127077 || valid_127119;
    bool range_valid_c_127120;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127093, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127122 = sle64(block_sizze_127093, (int64_t) 1);
    int64_t tmp_127123 = sub64(block_sizze_127093, (int64_t) 2);
    bool bounds_invalid_upwards_127124 = slt64(tmp_127123, (int64_t) 0);
    bool valid_127126 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_127127 = cond_127122 || valid_127126;
    bool protect_assert_disj_133431 = cond_127077 || protect_assert_disj_127127;
    bool range_valid_c_127128;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127123, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133386 = n_79667 * b_79668;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_79667; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127094 = smallest_pow_2_geq_than_res_127083 * block_sizze_127093;
    bool x_133414 = !cond_127077;
    int64_t greatest_divisor_leq_than_arg1_127097 = mul64((int64_t) 2, block_sizze_127093);
    int64_t merge_block_sizze_127098;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127097) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127098 = x_133416;
    } else {
        merge_block_sizze_127098 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_127101;
    
    if (x_133414) {
        int64_t x_133420 = ((int64_t *) k_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127101 = x_133420;
    } else {
        reduce_arg1_127101 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        int64_t x_133422;
        int64_t x_133423;
        int64_t redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127101;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_79667; i_133042++) {
            int64_t x_127105 = ((int64_t *) k_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127111 = sle64(redout_133040, x_127105);
            int64_t defunc_0_op_res_127112;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127112 = x_127105;
            } else {
                defunc_0_op_res_127112 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127113;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127113 = i_133042;
            } else {
                defunc_0_op_res_127113 = redout_133041;
            }
            
            int64_t redout_tmp_133519 = defunc_0_op_res_127112;
            int64_t redout_tmp_133520 = defunc_0_op_res_127113;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = (int64_t) 0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127125 = add64((int64_t) 1, tmp_127123);
    int64_t binop_x_133179 = (int64_t) 8 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133180 = block_sizze_127093 * binop_x_133179;
    int64_t bytes_133193 = (int64_t) 8 * block_sizze_127093;
    bool loop_cond_127200 = slt64(block_sizze_127093, flat_dim_127094);
    bool zzero_127201 = merge_block_sizze_127098 == (int64_t) 0;
    bool nonzzero_127202 = !zzero_127201;
    
    if (cond_127077) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133851 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133851, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133852 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133852, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133853 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133853, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133854 < bytes_133193) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133854, bytes_133193);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127083; i_133054++) {
            int64_t zp_lhs_127132 = mul64(block_sizze_127093, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127093; i_133047++) {
                int64_t k_127136 = add64(zp_lhs_127132, i_133047);
                bool cond_127137 = slt64(k_127136, n_79667);
                int64_t lifted_lambda_res_127138;
                int64_t lifted_lambda_res_127139;
                
                if (cond_127137) {
                    bool x_128906 = sle64((int64_t) 0, k_127136);
                    bool bounds_check_128907 = cond_127137 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127136, "] out of bounds for array of shape [", (long long) n_79667, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_128909 = ((int64_t *) k_mem_133175.mem)[k_127136];
                    
                    lifted_lambda_res_127138 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127139 = k_127136;
                } else {
                    lifted_lambda_res_127138 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127139 = defunc_0_reduce_res_129054;
                }
                ((int64_t *) mem_133194)[i_133047] = lifted_lambda_res_127138;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127139;
            }
            if (!cond_127122) {
                for (int64_t i_127149 = 0; i_127149 < distance_127125; i_127149++) {
                    int64_t gt_arg1_127152 = add64((int64_t) 1, i_127149);
                    bool x_127153 = sle64((int64_t) 0, gt_arg1_127152);
                    bool y_127154 = slt64(gt_arg1_127152, block_sizze_127093);
                    bool bounds_check_127155 = x_127153 && y_127154;
                    bool index_certs_127156;
                    
                    if (!bounds_check_127155) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127152, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127158 = slt64(i_127149, block_sizze_127093);
                    bool index_certs_127159;
                    
                    if (!y_127158) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127149, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_127157 = ((int64_t *) mem_133194)[gt_arg1_127152];
                    int64_t gt_arg0_127160 = ((int64_t *) mem_133194)[i_127149];
                    bool defunc_0_leq_res_127161 = sle64(gt_arg0_127160, gt_arg1_127157);
                    bool defunc_0_lifted_gt_res_127162 = !defunc_0_leq_res_127161;
                    bool s_127163;
                    int64_t s_127166;
                    bool loop_while_127167;
                    int64_t j_127170;
                    
                    loop_while_127167 = defunc_0_lifted_gt_res_127162;
                    j_127170 = i_127149;
                    while (loop_while_127167) {
                        bool x_127171 = sle64((int64_t) 0, j_127170);
                        bool y_127172 = slt64(j_127170, block_sizze_127093);
                        bool bounds_check_127173 = x_127171 && y_127172;
                        bool index_certs_127174;
                        
                        if (!bounds_check_127173) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127170, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127177 = add64((int64_t) 1, j_127170);
                        bool x_127178 = sle64((int64_t) 0, copy_arg0_127177);
                        bool y_127179 = slt64(copy_arg0_127177, block_sizze_127093);
                        bool bounds_check_127180 = x_127178 && y_127179;
                        bool index_certs_127181;
                        
                        if (!bounds_check_127180) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127177, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127175 = ((int64_t *) mem_133194)[j_127170];
                        int64_t copy_arg0_127176 = ((int64_t *) mem_133196)[j_127170];
                        int64_t copy_arg0_127182 = ((int64_t *) mem_133194)[copy_arg0_127177];
                        int64_t copy_arg0_127183 = ((int64_t *) mem_133196)[copy_arg0_127177];
                        
                        ((int64_t *) mem_133194)[j_127170] = copy_arg0_127182;
                        ((int64_t *) mem_133196)[j_127170] = copy_arg0_127183;
                        ((int64_t *) mem_133194)[copy_arg0_127177] = copy_arg0_127175;
                        ((int64_t *) mem_133196)[copy_arg0_127177] = copy_arg0_127176;
                        
                        int64_t tmp_127188 = sub64(j_127170, (int64_t) 1);
                        bool cond_127189 = sle64((int64_t) 0, tmp_127188);
                        bool loop_cond_127190;
                        
                        if (cond_127189) {
                            bool y_128911 = slt64(tmp_127188, block_sizze_127093);
                            bool bounds_check_128912 = cond_127189 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127188, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_128910 = ((int64_t *) mem_133194)[j_127170];
                            int64_t gt_arg0_128914 = ((int64_t *) mem_133194)[tmp_127188];
                            bool defunc_0_leq_res_128915 = sle64(gt_arg0_128914, gt_arg1_128910);
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127190 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127190 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127190;
                        int64_t j_tmp_133530 = tmp_127188;
                        
                        loop_while_127167 = loop_while_tmp_133527;
                        j_127170 = j_tmp_133530;
                    }
                    s_127163 = loop_while_127167;
                    s_127166 = j_127170;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133181, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        if (memblock_alloc(ctx, &mem_133253, bytes_133180, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        
        int64_t data_127203;
        bool data_127204;
        int64_t data_127207;
        int64_t loop_dz2084Uz2082U_127208;
        bool loop_while_127209;
        int64_t stride_127212;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127208 = flat_dim_127094;
        loop_while_127209 = loop_cond_127200;
        stride_127212 = block_sizze_127093;
        while (loop_while_127209) {
            int64_t next_stride_127213 = mul64((int64_t) 2, stride_127212);
            bool zzero_127214 = next_stride_127213 == (int64_t) 0;
            bool nonzzero_127215 = !zzero_127214;
            bool nonzzero_cert_127216;
            
            if (!nonzzero_127215) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127217 = sdiv64(flat_dim_127094, next_stride_127213);
            bool bounds_invalid_upwards_127218 = slt64(num_merges_127217, (int64_t) 0);
            bool valid_127219 = !bounds_invalid_upwards_127218;
            bool range_valid_c_127220;
            
            if (!valid_127219) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127217, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:109:36-40\n   #6  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127222 = sub64(next_stride_127213, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127223 = sle64((int64_t) 0, m_127222);
            bool cond_127225 = slt64(next_stride_127213, (int64_t) 10);
            bool protect_assert_disj_127226 = nonzzero_127202 || cond_127225;
            bool nonzzero_cert_127227;
            
            if (!protect_assert_disj_127226) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127228 = smod_safe64(next_stride_127213, merge_block_sizze_127098);
            bool num_blocks_127229 = zeze_lhs_127228 == (int64_t) 0;
            bool protect_assert_disj_127230 = cond_127225 || num_blocks_127229;
            bool assert_c_127231;
            
            if (!protect_assert_disj_127230) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127233 = sdiv_safe64(next_stride_127213, merge_block_sizze_127098);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234 = add64((int64_t) 1, num_blocks_127233);
            int64_t j_m_i_127235 = sub64(next_stride_127213, stride_127212);
            int64_t flat_dim_127236 = merge_block_sizze_127098 * num_blocks_127233;
            bool bounds_invalid_upwards_127237 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, (int64_t) 0);
            bool empty_slice_127238 = j_m_i_127235 == (int64_t) 0;
            int64_t m_127239 = sub64(j_m_i_127235, (int64_t) 1);
            bool zzero_lte_i_127240 = sle64((int64_t) 0, stride_127212);
            bool i_lte_j_127241 = sle64(stride_127212, next_stride_127213);
            bool empty_slice_127242 = stride_127212 == (int64_t) 0;
            int64_t m_127243 = sub64(stride_127212, (int64_t) 1);
            bool bounds_invalid_upwards_127244 = slt64(num_blocks_127233, (int64_t) 0);
            bool cond_127245 = slt64((int64_t) 0, stride_127212);
            bool valid_127246 = !bounds_invalid_upwards_127237;
            int64_t i_p_m_t_s_127247 = add64(stride_127212, m_127239);
            bool zzero_leq_i_p_m_t_s_127248 = sle64((int64_t) 0, m_127243);
            bool i_p_m_t_s_leq_w_127249 = slt64(m_127243, next_stride_127213);
            bool valid_127250 = !bounds_invalid_upwards_127244;
            bool i_p_m_t_s_leq_w_127251 = slt64(m_127222, flat_dim_127236);
            bool y_127252 = slt64((int64_t) 0, j_m_i_127235);
            bool protect_assert_disj_127253 = cond_127225 || valid_127246;
            bool range_valid_c_127254;
            
            if (!protect_assert_disj_127253) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127255 = sle64((int64_t) 0, i_p_m_t_s_127247);
            bool i_p_m_t_s_leq_w_127256 = slt64(i_p_m_t_s_127247, next_stride_127213);
            bool y_127257 = zzero_leq_i_p_m_t_s_127248 && i_p_m_t_s_leq_w_127249;
            bool protect_assert_disj_127258 = cond_127225 || valid_127250;
            bool range_valid_c_127259;
            
            if (!protect_assert_disj_127258) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127233, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127260 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127251;
            bool y_127261 = zzero_lte_i_127240 && i_p_m_t_s_leq_w_127256;
            bool forwards_ok_127262 = zzero_lte_i_127240 && y_127257;
            bool ok_or_empty_127263 = zzero_127214 || y_127260;
            bool protect_assert_disj_127264 = cond_127245 || y_127252;
            bool y_127265 = zzero_leq_i_p_m_t_s_127255 && y_127261;
            bool ok_or_empty_127266 = empty_slice_127242 || forwards_ok_127262;
            bool protect_assert_disj_127267 = cond_127225 || ok_or_empty_127263;
            bool index_certs_127268;
            
            if (!protect_assert_disj_127267) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) flat_dim_127236, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127269 = !cond_127225;
            bool protect_assert_disj_127270 = protect_assert_disj_127264 || loop_not_taken_127269;
            bool index_certs_127271;
            
            if (!protect_assert_disj_127270) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127272 = i_lte_j_127241 && y_127265;
            bool protect_assert_disj_127273 = cond_127225 || ok_or_empty_127266;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127275 = ok_or_empty_127266 || loop_not_taken_127269;
            bool index_certs_127276;
            
            if (!protect_assert_disj_127275) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127277 = empty_slice_127238 || forwards_ok_127272;
            bool protect_assert_disj_127278 = cond_127225 || ok_or_empty_127277;
            bool index_certs_127279;
            
            if (!protect_assert_disj_127278) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127280 = loop_not_taken_127269 || ok_or_empty_127277;
            bool index_certs_127281;
            
            if (!protect_assert_disj_127280) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 8 * num_merges_127217;
            int64_t bytes_133262 = next_stride_127213 * binop_x_133261;
            bool i_lte_j_127224 = sle64((int64_t) 0, next_stride_127213);
            
            if (mem_133263_cached_sizze_133855 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133855, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133856 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133856, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234;
            int64_t binop_x_133291 = (int64_t) 8 * num_blocks_127233;
            int64_t bytes_133292 = merge_block_sizze_127098 * binop_x_133291;
            int64_t bytes_133337 = (int64_t) 16 * stride_127212;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127217; i_133075++) {
                int64_t start_127285 = mul64(next_stride_127213, i_133075);
                int64_t j_m_i_127286 = sub64(loop_dz2084Uz2082U_127208, start_127285);
                bool empty_slice_127287 = j_m_i_127286 == (int64_t) 0;
                int64_t m_127288 = sub64(j_m_i_127286, (int64_t) 1);
                int64_t i_p_m_t_s_127289 = add64(start_127285, m_127288);
                bool zzero_leq_i_p_m_t_s_127290 = sle64((int64_t) 0, i_p_m_t_s_127289);
                bool i_p_m_t_s_leq_w_127291 = slt64(i_p_m_t_s_127289, loop_dz2084Uz2082U_127208);
                bool zzero_lte_i_127292 = sle64((int64_t) 0, start_127285);
                bool i_lte_j_127293 = sle64(start_127285, loop_dz2084Uz2082U_127208);
                bool y_127294 = i_p_m_t_s_leq_w_127291 && zzero_lte_i_127292;
                bool y_127295 = zzero_leq_i_p_m_t_s_127290 && y_127294;
                bool forwards_ok_127296 = i_lte_j_127293 && y_127295;
                bool ok_or_empty_127297 = empty_slice_127287 || forwards_ok_127296;
                bool index_certs_127298;
                
                if (!ok_or_empty_127297) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127285, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127208, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127299 = slt64(m_127222, j_m_i_127286);
                bool y_127300 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127299;
                bool forwards_ok_127301 = i_lte_j_127224 && y_127300;
                bool ok_or_empty_127302 = zzero_127214 || forwards_ok_127301;
                bool index_certs_127303;
                
                if (!ok_or_empty_127302) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) j_m_i_127286, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127225) {
                    int64_t dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127245) {
                        int64_t head_res_128944 = ((int64_t *) mem_param_133257.mem)[start_127285];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127285];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127212 + start_127285;
                        int64_t head_res_128947 = ((int64_t *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127213; nest_i_133540++) {
                        ((int64_t *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133337, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127213; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127213; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127235;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127212);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127235);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127212 + j_128958;
                                int64_t slice_128968 = start_127285 + slice_128967;
                                int64_t leq_arg1_128969 = ((int64_t *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127285 + i_128955;
                                int64_t leq_arg0_128974 = ((int64_t *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = sle64(leq_arg0_128974, leq_arg1_128969);
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        int64_t loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127212);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127285 + i_128955;
                            int64_t tmp_128985 = ((int64_t *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127235);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127212 + j_128958;
                            int64_t slice_128992 = start_127285 + slice_128991;
                            int64_t tmp_128993 = ((int64_t *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((int64_t *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133857 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133857, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133858 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133858, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234; i_133061++) {
                        int64_t split_count_arg3_127365 = mul64(merge_block_sizze_127098, i_133061);
                        int64_t defunc_0_split_count_res_127366;
                        int64_t defunc_0_split_count_res_127367;
                        int64_t defunc_0_split_count_res_127368;
                        int64_t defunc_0_split_count_res_127369;
                        int64_t defunc_0_split_count_res_127370;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127366, &defunc_0_split_count_res_127367, &defunc_0_split_count_res_127368, &defunc_0_split_count_res_127369, &defunc_0_split_count_res_127370, (int64_t) 0, stride_127212, (int64_t) 0, j_m_i_127235, split_count_arg3_127365) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127371 = slt64((int64_t) 0, defunc_0_split_count_res_127370);
                        bool defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        int64_t defunc_0_split_count_res_127377;
                        bool loop_while_127378;
                        int64_t ss_127379;
                        int64_t ss_127380;
                        int64_t tt_127381;
                        int64_t tt_127382;
                        int64_t count_127383;
                        
                        loop_while_127378 = loop_cond_127371;
                        ss_127379 = defunc_0_split_count_res_127366;
                        ss_127380 = defunc_0_split_count_res_127367;
                        tt_127381 = defunc_0_split_count_res_127368;
                        tt_127382 = defunc_0_split_count_res_127369;
                        count_127383 = defunc_0_split_count_res_127370;
                        while (loop_while_127378) {
                            int64_t zlze_lhs_127384 = sub64(ss_127380, ss_127379);
                            bool cond_127385 = sle64(zlze_lhs_127384, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127386;
                            int64_t defunc_0_lifted_step_res_127387;
                            int64_t defunc_0_lifted_step_res_127388;
                            int64_t defunc_0_lifted_step_res_127389;
                            
                            if (cond_127385) {
                                int64_t tmp_128997 = add64(tt_127381, count_127383);
                                
                                defunc_0_lifted_step_res_127386 = ss_127379;
                                defunc_0_lifted_step_res_127387 = tmp_128997;
                                defunc_0_lifted_step_res_127388 = tt_127382;
                                defunc_0_lifted_step_res_127389 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127391 = sub64(tt_127382, tt_127381);
                                bool cond_127392 = sle64(zlze_lhs_127391, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127393;
                                int64_t defunc_0_lifted_step_res_f_res_127394;
                                int64_t defunc_0_lifted_step_res_f_res_127395;
                                int64_t defunc_0_lifted_step_res_f_res_127396;
                                
                                if (cond_127392) {
                                    int64_t tmp_128998 = add64(ss_127379, count_127383);
                                    
                                    defunc_0_lifted_step_res_f_res_127393 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127394 = tt_127381;
                                    defunc_0_lifted_step_res_f_res_127395 = tt_127382;
                                    defunc_0_lifted_step_res_f_res_127396 = (int64_t) 0;
                                } else {
                                    bool cond_127398 = count_127383 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127399;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127400;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127401;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127402;
                                    
                                    if (cond_127398) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127379);
                                        bool y_129001 = slt64(ss_127379, stride_127212);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127379, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127381);
                                        bool y_129007 = slt64(tt_127381, j_m_i_127235);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127381, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127285 + ss_127379;
                                        int64_t leq_arg1_129005 = ((int64_t *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127212 + tt_127381;
                                        int64_t slice_129011 = start_127285 + slice_129010;
                                        int64_t leq_arg0_129012 = ((int64_t *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = sle64(leq_arg0_129012, leq_arg1_129005);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127381);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127379;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127379);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127381;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = tt_127382;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = (int64_t) 0;
                                    } else {
                                        int64_t m_127421 = sdiv64(count_127383, (int64_t) 2);
                                        int64_t n_127422 = sub64(count_127383, m_127421);
                                        bool cond_127423 = n_127422 == (int64_t) 0;
                                        int64_t zgze_lhs_127424 = add64(ss_127379, m_127421);
                                        bool cond_f_res_127425 = sle64(ss_127380, zgze_lhs_127424);
                                        bool x_127426 = !cond_127423;
                                        bool y_127427 = cond_f_res_127425 && x_127426;
                                        bool cond_127428 = cond_127423 || y_127427;
                                        bool leq_y_x_127429;
                                        
                                        if (cond_127428) {
                                            leq_y_x_127429 = 1;
                                        } else {
                                            bool x_127430 = sle64((int64_t) 0, zgze_lhs_127424);
                                            bool y_127431 = slt64(zgze_lhs_127424, stride_127212);
                                            bool bounds_check_127432 = x_127430 && y_127431;
                                            bool index_certs_127433;
                                            
                                            if (!bounds_check_127432) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127424, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127436 = add64(tt_127381, n_127422);
                                            int64_t leq_arg0_127437 = sub64(zm_lhs_127436, (int64_t) 1);
                                            bool x_127438 = sle64((int64_t) 0, leq_arg0_127437);
                                            bool y_127439 = slt64(leq_arg0_127437, j_m_i_127235);
                                            bool bounds_check_127440 = x_127438 && y_127439;
                                            bool index_certs_127441;
                                            
                                            if (!bounds_check_127440) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127437, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127434 = start_127285 + zgze_lhs_127424;
                                            int64_t leq_arg1_127435 = ((int64_t *) mem_param_133257.mem)[slice_127434];
                                            int64_t slice_127442 = stride_127212 + leq_arg0_127437;
                                            int64_t slice_127443 = start_127285 + slice_127442;
                                            int64_t leq_arg0_127444 = ((int64_t *) mem_param_133257.mem)[slice_127443];
                                            bool defunc_0_leq_res_127445 = sle64(leq_arg0_127444, leq_arg1_127435);
                                            
                                            leq_y_x_127429 = defunc_0_leq_res_127445;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                        
                                        if (leq_y_x_127429) {
                                            int64_t tmp_129018 = add64(tt_127381, n_127422);
                                            int64_t tmp_129019 = sub64(count_127383, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tt_127382;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = tmp_129019;
                                        } else {
                                            int64_t tmp_127451 = add64(tt_127381, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tt_127381;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tmp_127451;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = count_127383;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = ss_127379;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                    }
                                    defunc_0_lifted_step_res_f_res_127393 = defunc_0_lifted_step_res_f_res_f_res_127399;
                                    defunc_0_lifted_step_res_f_res_127394 = defunc_0_lifted_step_res_f_res_f_res_127400;
                                    defunc_0_lifted_step_res_f_res_127395 = defunc_0_lifted_step_res_f_res_f_res_127401;
                                    defunc_0_lifted_step_res_f_res_127396 = defunc_0_lifted_step_res_f_res_f_res_127402;
                                }
                                defunc_0_lifted_step_res_127386 = defunc_0_lifted_step_res_f_res_127393;
                                defunc_0_lifted_step_res_127387 = defunc_0_lifted_step_res_f_res_127394;
                                defunc_0_lifted_step_res_127388 = defunc_0_lifted_step_res_f_res_127395;
                                defunc_0_lifted_step_res_127389 = defunc_0_lifted_step_res_f_res_127396;
                            }
                            
                            int64_t loopres_127452;
                            int64_t loopres_127453;
                            int64_t loopres_127454;
                            int64_t loopres_127455;
                            int64_t loopres_127456;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127452, &loopres_127453, &loopres_127454, &loopres_127455, &loopres_127456, defunc_0_lifted_step_res_127386, ss_127380, defunc_0_lifted_step_res_127387, defunc_0_lifted_step_res_127388, defunc_0_lifted_step_res_127389) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127457 = slt64((int64_t) 0, loopres_127456);
                            bool loop_while_tmp_133547 = loop_cond_127457;
                            int64_t ss_tmp_133548 = loopres_127452;
                            int64_t ss_tmp_133549 = loopres_127453;
                            int64_t tt_tmp_133550 = loopres_127454;
                            int64_t tt_tmp_133551 = loopres_127455;
                            int64_t count_tmp_133552 = loopres_127456;
                            
                            loop_while_127378 = loop_while_tmp_133547;
                            ss_127379 = ss_tmp_133548;
                            ss_127380 = ss_tmp_133549;
                            tt_127381 = tt_tmp_133550;
                            tt_127382 = tt_tmp_133551;
                            count_127383 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127372 = loop_while_127378;
                        defunc_0_split_count_res_127373 = ss_127379;
                        defunc_0_split_count_res_127374 = ss_127380;
                        defunc_0_split_count_res_127375 = tt_127381;
                        defunc_0_split_count_res_127376 = tt_127382;
                        defunc_0_split_count_res_127377 = count_127383;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127373;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127375;
                    }
                    if (mem_133293_cached_sizze_133859 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133859, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133860 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133860, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127233; i_133068++) {
                        bool y_127463 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool index_certs_127465;
                        
                        if (!y_127463) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127466 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127467 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127468 = add64((int64_t) 1, i_133068);
                        bool x_127469 = sle64((int64_t) 0, tmp_127468);
                        bool y_127470 = slt64(tmp_127468, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool bounds_check_127471 = x_127469 && y_127470;
                        bool index_certs_127472;
                        
                        if (!bounds_check_127471) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127468, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133276)[tmp_127468];
                        int64_t defunc_0_f_res_127474 = ((int64_t *) mem_133278)[tmp_127468];
                        int64_t merge_sequential_arg2_127475 = add64(stride_127212, defunc_0_f_res_127467);
                        int64_t merge_sequential_arg2_127476 = add64(stride_127212, defunc_0_f_res_127474);
                        int64_t j_m_i_127477 = sub64(merge_sequential_arg2_127476, merge_sequential_arg2_127475);
                        bool empty_slice_127478 = j_m_i_127477 == (int64_t) 0;
                        int64_t m_127479 = sub64(j_m_i_127477, (int64_t) 1);
                        int64_t i_p_m_t_s_127480 = add64(merge_sequential_arg2_127475, m_127479);
                        bool zzero_leq_i_p_m_t_s_127481 = sle64((int64_t) 0, i_p_m_t_s_127480);
                        bool i_p_m_t_s_leq_w_127482 = slt64(i_p_m_t_s_127480, next_stride_127213);
                        bool zzero_lte_i_127483 = sle64((int64_t) 0, merge_sequential_arg2_127475);
                        bool i_lte_j_127484 = sle64(merge_sequential_arg2_127475, merge_sequential_arg2_127476);
                        bool y_127485 = i_p_m_t_s_leq_w_127482 && zzero_lte_i_127483;
                        bool y_127486 = zzero_leq_i_p_m_t_s_127481 && y_127485;
                        bool forwards_ok_127487 = i_lte_j_127484 && y_127486;
                        bool ok_or_empty_127488 = empty_slice_127478 || forwards_ok_127487;
                        bool index_certs_127489;
                        
                        if (!ok_or_empty_127488) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127475, ":", (long long) merge_sequential_arg2_127476, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127490 = sub64(defunc_0_f_res_127473, defunc_0_f_res_127466);
                        bool empty_slice_127491 = j_m_i_127490 == (int64_t) 0;
                        int64_t m_127492 = sub64(j_m_i_127490, (int64_t) 1);
                        int64_t i_p_m_t_s_127493 = add64(defunc_0_f_res_127466, m_127492);
                        bool zzero_leq_i_p_m_t_s_127494 = sle64((int64_t) 0, i_p_m_t_s_127493);
                        bool i_p_m_t_s_leq_w_127495 = slt64(i_p_m_t_s_127493, next_stride_127213);
                        bool zzero_lte_i_127496 = sle64((int64_t) 0, defunc_0_f_res_127466);
                        bool i_lte_j_127497 = sle64(defunc_0_f_res_127466, defunc_0_f_res_127473);
                        bool y_127498 = i_p_m_t_s_leq_w_127495 && zzero_lte_i_127496;
                        bool y_127499 = zzero_leq_i_p_m_t_s_127494 && y_127498;
                        bool forwards_ok_127500 = i_lte_j_127497 && y_127499;
                        bool ok_or_empty_127501 = empty_slice_127491 || forwards_ok_127500;
                        bool index_certs_127502;
                        
                        if (!ok_or_empty_127501) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127466, ":", (long long) defunc_0_f_res_127473, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127503 = slt64((int64_t) 0, j_m_i_127490);
                        int64_t dummy_127504;
                        int64_t dummy_127505;
                        
                        if (cond_127503) {
                            bool index_certs_129020;
                            
                            if (!cond_127503) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:109:36-40\n   #12 ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127285 + defunc_0_f_res_127466;
                            int64_t head_res_129022 = ((int64_t *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127504 = head_res_129022;
                            dummy_127505 = head_res_129023;
                        } else {
                            bool y_127510 = slt64((int64_t) 0, j_m_i_127477);
                            bool index_certs_127511;
                            
                            if (!y_127510) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:109:36-40\n   #12 ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127512 = start_127285 + merge_sequential_arg2_127475;
                            int64_t head_res_127513 = ((int64_t *) mem_param_133257.mem)[slice_127512];
                            int64_t head_res_127514 = ((int64_t *) mem_param_133260.mem)[slice_127512];
                            
                            dummy_127504 = head_res_127513;
                            dummy_127505 = head_res_127514;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127098; nest_i_133555++) {
                            ((int64_t *) mem_133293)[i_133068 * merge_block_sizze_127098 + nest_i_133555] = dummy_127504;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127098; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + nest_i_133556] = dummy_127505;
                        }
                        
                        int64_t data_127517;
                        int64_t i_127521 = (int64_t) 0;
                        
                        for (int64_t k_127520 = 0; k_127520 < merge_block_sizze_127098; k_127520++) {
                            int64_t j_127524 = sub64(k_127520, i_127521);
                            bool cond_127525 = j_127524 == j_m_i_127477;
                            bool cond_127526;
                            
                            if (cond_127525) {
                                cond_127526 = 1;
                            } else {
                                bool cond_127527 = slt64(i_127521, j_m_i_127490);
                                bool cond_f_res_127528;
                                
                                if (cond_127527) {
                                    bool x_129024 = sle64((int64_t) 0, j_127524);
                                    bool y_129025 = slt64(j_127524, j_m_i_127477);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127521);
                                    bool bounds_check_129032 = cond_127527 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127475 + j_127524;
                                    int64_t slice_129029 = start_127285 + slice_129028;
                                    int64_t leq_arg1_129030 = ((int64_t *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127466 + i_127521;
                                    int64_t slice_129035 = start_127285 + slice_129034;
                                    int64_t leq_arg0_129036 = ((int64_t *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = sle64(leq_arg0_129036, leq_arg1_129030);
                                    
                                    cond_f_res_127528 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127528 = 0;
                                }
                                cond_127526 = cond_f_res_127528;
                            }
                            
                            int64_t loopres_127543;
                            int64_t loopres_127544;
                            int64_t loopres_127545;
                            
                            if (cond_127526) {
                                bool x_129039 = sle64((int64_t) 0, i_127521);
                                bool y_129040 = slt64(i_127521, j_m_i_127490);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127521);
                                int64_t slice_129043 = defunc_0_f_res_127466 + i_127521;
                                int64_t slice_129044 = start_127285 + slice_129043;
                                int64_t tmp_129045 = ((int64_t *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127543 = tmp_129038;
                                loopres_127544 = tmp_129045;
                                loopres_127545 = tmp_129046;
                            } else {
                                bool x_127555 = sle64((int64_t) 0, j_127524);
                                bool y_127556 = slt64(j_127524, j_m_i_127477);
                                bool bounds_check_127557 = x_127555 && y_127556;
                                bool index_certs_127558;
                                
                                if (!bounds_check_127557) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127559 = merge_sequential_arg2_127475 + j_127524;
                                int64_t slice_127560 = start_127285 + slice_127559;
                                int64_t tmp_127561 = ((int64_t *) mem_param_133257.mem)[slice_127560];
                                int64_t tmp_127562 = ((int64_t *) mem_param_133260.mem)[slice_127560];
                                
                                loopres_127543 = i_127521;
                                loopres_127544 = tmp_127561;
                                loopres_127545 = tmp_127562;
                            }
                            ((int64_t *) mem_133293)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127544;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127545;
                            
                            int64_t i_tmp_133557 = loopres_127543;
                            
                            i_127521 = i_tmp_133557;
                        }
                        data_127517 = i_127521;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133292, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133263, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127569 = next_stride_127213 * num_merges_127217;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            if (memblock_alloc(ctx, &mem_133373, bytes_133262, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            
            bool loop_cond_127572 = slt64(next_stride_127213, flat_dim_127094);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127569;
            bool loop_while_tmp_133534 = loop_cond_127572;
            int64_t stride_tmp_133537 = next_stride_127213;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127208 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127209 = loop_while_tmp_133534;
            stride_127212 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127203 = loop_dz2084Uz2082U_127208;
        data_127204 = loop_while_127209;
        data_127207 = stride_127212;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127573 = n_79667 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127574 = sle64((int64_t) 0, zs_lhs_127078);
        bool i_p_m_t_s_leq_w_127575 = slt64(zs_lhs_127078, data_127203);
        bool y_127576 = zzero_leq_i_p_m_t_s_127574 && i_p_m_t_s_leq_w_127575;
        bool ok_or_empty_127577 = empty_slice_127573 || y_127576;
        bool index_certs_127578;
        
        if (!ok_or_empty_127577) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_79667, "] out of bounds for array of shape [", (long long) data_127203, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:109:36-40\n   #6  ftRelational.fut:106:9-109:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133177, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_79667; i_133082++) {
        int64_t eta_p_127586 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127587 = sle64((int64_t) 0, eta_p_127586);
        bool y_127588 = slt64(eta_p_127586, n_79667);
        bool bounds_check_127589 = x_127587 && y_127588;
        bool index_certs_127590;
        
        if (!bounds_check_127589) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127586, "] out of bounds for array of shape [", (long long) n_79667, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_127591 = ((int64_t *) k_mem_133175.mem)[eta_p_127586];
        
        ((int64_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127591;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133387.mem, i_133082 * b_79668, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_133176.mem, eta_p_127586 * b_79668, (int64_t []) {(int64_t) 1}, (int64_t []) {b_79668});
    }
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133849, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133850, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_133861, struct memblock *mem_out_p_133862, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_74947, int64_t b_74948)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133181_cached_sizze_133863 = 0;
    unsigned char *mem_133181 = NULL;
    int64_t mem_133184_cached_sizze_133864 = 0;
    unsigned char *mem_133184 = NULL;
    int64_t mem_133194_cached_sizze_133865 = 0;
    unsigned char *mem_133194 = NULL;
    int64_t mem_133196_cached_sizze_133866 = 0;
    unsigned char *mem_133196 = NULL;
    int64_t mem_133263_cached_sizze_133867 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133266_cached_sizze_133868 = 0;
    unsigned char *mem_133266 = NULL;
    int64_t mem_133276_cached_sizze_133869 = 0;
    unsigned char *mem_133276 = NULL;
    int64_t mem_133278_cached_sizze_133870 = 0;
    unsigned char *mem_133278 = NULL;
    int64_t mem_133293_cached_sizze_133871 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133296_cached_sizze_133872 = 0;
    unsigned char *mem_133296 = NULL;
    struct memblock mem_133387;
    
    mem_133387.references = NULL;
    
    struct memblock mem_133385;
    
    mem_133385.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_133373;
    
    mem_133373.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133335;
    
    mem_133335.references = NULL;
    
    struct memblock mem_133331;
    
    mem_133331.references = NULL;
    
    struct memblock mem_133340;
    
    mem_133340.references = NULL;
    
    struct memblock mem_133338;
    
    mem_133338.references = NULL;
    
    struct memblock ext_mem_133355;
    
    ext_mem_133355.references = NULL;
    
    struct memblock ext_mem_133358;
    
    ext_mem_133358.references = NULL;
    
    struct memblock mem_param_133260;
    
    mem_param_133260.references = NULL;
    
    struct memblock mem_param_133257;
    
    mem_param_133257.references = NULL;
    
    struct memblock ext_mem_133379;
    
    ext_mem_133379.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock mem_133253;
    
    mem_133253.references = NULL;
    
    struct memblock mem_133249;
    
    mem_133249.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_74947;
    bool cond_127077 = sle64(n_74947, (int64_t) 1);
    int64_t zs_lhs_127078 = sub64(n_74947, (int64_t) 1);
    int64_t zp_rhs_127079 = sdiv_safe64(zs_lhs_127078, (int64_t) 20);
    int64_t min_num_blocks_127080 = add64((int64_t) 1, zp_rhs_127079);
    bool loop_cond_127081 = slt64((int64_t) 1, min_num_blocks_127080);
    bool smallest_pow_2_geq_than_res_127082;
    int64_t smallest_pow_2_geq_than_res_127083;
    bool loop_while_127084;
    int64_t x_127085;
    
    loop_while_127084 = loop_cond_127081;
    x_127085 = (int64_t) 1;
    while (loop_while_127084) {
        int64_t loopres_127086 = mul64((int64_t) 2, x_127085);
        bool loop_cond_127087 = slt64(loopres_127086, min_num_blocks_127080);
        bool loop_while_tmp_133515 = loop_cond_127087;
        int64_t x_tmp_133516 = loopres_127086;
        
        loop_while_127084 = loop_while_tmp_133515;
        x_127085 = x_tmp_133516;
    }
    smallest_pow_2_geq_than_res_127082 = loop_while_127084;
    smallest_pow_2_geq_than_res_127083 = x_127085;
    
    bool zzero_127088 = smallest_pow_2_geq_than_res_127083 == (int64_t) 0;
    bool nonzzero_127089 = !zzero_127088;
    bool protect_assert_disj_127090 = cond_127077 || nonzzero_127089;
    bool nonzzero_cert_127091;
    
    if (!protect_assert_disj_127090) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_127092 = sdiv_safe64(zs_lhs_127078, smallest_pow_2_geq_than_res_127083);
    int64_t block_sizze_127093 = add64((int64_t) 1, zp_rhs_127092);
    bool y_127099 = slt64((int64_t) 0, n_74947);
    bool protect_assert_disj_133419 = cond_127077 || y_127099;
    bool index_certs_127100;
    
    if (!protect_assert_disj_133419) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_74947, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127114 = slt64(smallest_pow_2_geq_than_res_127083, (int64_t) 0);
    bool valid_127115 = !bounds_invalid_upwards_127114;
    bool protect_assert_disj_133427 = cond_127077 || valid_127115;
    bool range_valid_c_127116;
    
    if (!protect_assert_disj_133427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_127083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:101:36-40\n   #6  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_127118 = slt64(block_sizze_127093, (int64_t) 0);
    bool valid_127119 = !bounds_invalid_upwards_127118;
    bool protect_assert_disj_133429 = cond_127077 || valid_127119;
    bool range_valid_c_127120;
    
    if (!protect_assert_disj_133429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_127093, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_127122 = sle64(block_sizze_127093, (int64_t) 1);
    int64_t tmp_127123 = sub64(block_sizze_127093, (int64_t) 2);
    bool bounds_invalid_upwards_127124 = slt64(tmp_127123, (int64_t) 0);
    bool valid_127126 = !bounds_invalid_upwards_127124;
    bool protect_assert_disj_127127 = cond_127122 || valid_127126;
    bool protect_assert_disj_133431 = cond_127077 || protect_assert_disj_127127;
    bool range_valid_c_127128;
    
    if (!protect_assert_disj_133431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_127123, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133384 = (int64_t) 2 * n_74947;
    int64_t bytes_133386 = n_74947 * b_74948;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133517 = 0; i_133517 < n_74947; i_133517++) {
        int64_t x_133518 = (int64_t) 0 + i_133517 * (int64_t) 1;
        
        ((int64_t *) mem_133178.mem)[i_133517] = x_133518;
    }
    
    int64_t flat_dim_127094 = smallest_pow_2_geq_than_res_127083 * block_sizze_127093;
    bool x_133414 = !cond_127077;
    int64_t greatest_divisor_leq_than_arg1_127097 = mul64((int64_t) 2, block_sizze_127093);
    int64_t merge_block_sizze_127098;
    
    if (x_133414) {
        int64_t x_133416;
        
        if (futrts_greatest_divisor_leq_than_5357(ctx, &x_133416, (int64_t) 8, greatest_divisor_leq_than_arg1_127097) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_127098 = x_133416;
    } else {
        merge_block_sizze_127098 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_127101;
    
    if (x_133414) {
        int16_t x_133420 = ((int16_t *) k_mem_133175.mem)[(int64_t) 0];
        
        reduce_arg1_127101 = x_133420;
    } else {
        reduce_arg1_127101 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_129053;
    int64_t defunc_0_reduce_res_129054;
    
    if (x_133414) {
        int16_t x_133422;
        int64_t x_133423;
        int16_t redout_133040;
        int64_t redout_133041;
        
        redout_133040 = reduce_arg1_127101;
        redout_133041 = (int64_t) 0;
        for (int64_t i_133042 = 0; i_133042 < n_74947; i_133042++) {
            int16_t x_127105 = ((int16_t *) k_mem_133175.mem)[i_133042];
            bool defunc_0_leq_res_127111 = sle16(redout_133040, x_127105);
            int16_t defunc_0_op_res_127112;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127112 = x_127105;
            } else {
                defunc_0_op_res_127112 = redout_133040;
            }
            
            int64_t defunc_0_op_res_127113;
            
            if (defunc_0_leq_res_127111) {
                defunc_0_op_res_127113 = i_133042;
            } else {
                defunc_0_op_res_127113 = redout_133041;
            }
            
            int16_t redout_tmp_133519 = defunc_0_op_res_127112;
            int64_t redout_tmp_133520 = defunc_0_op_res_127113;
            
            redout_133040 = redout_tmp_133519;
            redout_133041 = redout_tmp_133520;
        }
        x_133422 = redout_133040;
        x_133423 = redout_133041;
        defunc_0_reduce_res_129053 = x_133422;
        defunc_0_reduce_res_129054 = x_133423;
    } else {
        defunc_0_reduce_res_129053 = (int16_t) 0;
        defunc_0_reduce_res_129054 = (int64_t) 0;
    }
    
    int64_t distance_127125 = add64((int64_t) 1, tmp_127123);
    int64_t binop_x_133179 = (int64_t) 2 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133180 = block_sizze_127093 * binop_x_133179;
    int64_t binop_x_133182 = (int64_t) 8 * smallest_pow_2_geq_than_res_127083;
    int64_t bytes_133183 = block_sizze_127093 * binop_x_133182;
    int64_t bytes_133195 = (int64_t) 8 * block_sizze_127093;
    bool loop_cond_127200 = slt64(block_sizze_127093, flat_dim_127094);
    bool zzero_127201 = merge_block_sizze_127098 == (int64_t) 0;
    bool nonzzero_127202 = !zzero_127201;
    
    if (cond_127077) {
        if (memblock_set(ctx, &ext_mem_133383, &mem_133178, "mem_133178") != 0)
            return 1;
    } else {
        if (mem_133181_cached_sizze_133863 < bytes_133180) {
            err = lexical_realloc(ctx, &mem_133181, &mem_133181_cached_sizze_133863, bytes_133180);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133184_cached_sizze_133864 < bytes_133183) {
            err = lexical_realloc(ctx, &mem_133184, &mem_133184_cached_sizze_133864, bytes_133183);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133194_cached_sizze_133865 < greatest_divisor_leq_than_arg1_127097) {
            err = lexical_realloc(ctx, &mem_133194, &mem_133194_cached_sizze_133865, greatest_divisor_leq_than_arg1_127097);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_133196_cached_sizze_133866 < bytes_133195) {
            err = lexical_realloc(ctx, &mem_133196, &mem_133196_cached_sizze_133866, bytes_133195);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_133054 = 0; i_133054 < smallest_pow_2_geq_than_res_127083; i_133054++) {
            int64_t zp_lhs_127132 = mul64(block_sizze_127093, i_133054);
            
            for (int64_t i_133047 = 0; i_133047 < block_sizze_127093; i_133047++) {
                int64_t k_127136 = add64(zp_lhs_127132, i_133047);
                bool cond_127137 = slt64(k_127136, n_74947);
                int16_t lifted_lambda_res_127138;
                int64_t lifted_lambda_res_127139;
                
                if (cond_127137) {
                    bool x_128906 = sle64((int64_t) 0, k_127136);
                    bool bounds_check_128907 = cond_127137 && x_128906;
                    bool index_certs_128908;
                    
                    if (!bounds_check_128907) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_127136, "] out of bounds for array of shape [", (long long) n_74947, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_128909 = ((int16_t *) k_mem_133175.mem)[k_127136];
                    
                    lifted_lambda_res_127138 = lifted_lambda_res_t_res_128909;
                    lifted_lambda_res_127139 = k_127136;
                } else {
                    lifted_lambda_res_127138 = defunc_0_reduce_res_129053;
                    lifted_lambda_res_127139 = defunc_0_reduce_res_129054;
                }
                ((int16_t *) mem_133194)[i_133047] = lifted_lambda_res_127138;
                ((int64_t *) mem_133196)[i_133047] = lifted_lambda_res_127139;
            }
            if (!cond_127122) {
                for (int64_t i_127149 = 0; i_127149 < distance_127125; i_127149++) {
                    int64_t gt_arg1_127152 = add64((int64_t) 1, i_127149);
                    bool x_127153 = sle64((int64_t) 0, gt_arg1_127152);
                    bool y_127154 = slt64(gt_arg1_127152, block_sizze_127093);
                    bool bounds_check_127155 = x_127153 && y_127154;
                    bool index_certs_127156;
                    
                    if (!bounds_check_127155) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_127152, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_127158 = slt64(i_127149, block_sizze_127093);
                    bool index_certs_127159;
                    
                    if (!y_127158) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127149, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_127157 = ((int16_t *) mem_133194)[gt_arg1_127152];
                    int16_t gt_arg0_127160 = ((int16_t *) mem_133194)[i_127149];
                    bool defunc_0_leq_res_127161 = sle16(gt_arg0_127160, gt_arg1_127157);
                    bool defunc_0_lifted_gt_res_127162 = !defunc_0_leq_res_127161;
                    bool s_127163;
                    int64_t s_127166;
                    bool loop_while_127167;
                    int64_t j_127170;
                    
                    loop_while_127167 = defunc_0_lifted_gt_res_127162;
                    j_127170 = i_127149;
                    while (loop_while_127167) {
                        bool x_127171 = sle64((int64_t) 0, j_127170);
                        bool y_127172 = slt64(j_127170, block_sizze_127093);
                        bool bounds_check_127173 = x_127171 && y_127172;
                        bool index_certs_127174;
                        
                        if (!bounds_check_127173) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127170, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_127177 = add64((int64_t) 1, j_127170);
                        bool x_127178 = sle64((int64_t) 0, copy_arg0_127177);
                        bool y_127179 = slt64(copy_arg0_127177, block_sizze_127093);
                        bool bounds_check_127180 = x_127178 && y_127179;
                        bool index_certs_127181;
                        
                        if (!bounds_check_127180) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_127177, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_127175 = ((int16_t *) mem_133194)[j_127170];
                        int64_t copy_arg0_127176 = ((int64_t *) mem_133196)[j_127170];
                        int16_t copy_arg0_127182 = ((int16_t *) mem_133194)[copy_arg0_127177];
                        int64_t copy_arg0_127183 = ((int64_t *) mem_133196)[copy_arg0_127177];
                        
                        ((int16_t *) mem_133194)[j_127170] = copy_arg0_127182;
                        ((int64_t *) mem_133196)[j_127170] = copy_arg0_127183;
                        ((int16_t *) mem_133194)[copy_arg0_127177] = copy_arg0_127175;
                        ((int64_t *) mem_133196)[copy_arg0_127177] = copy_arg0_127176;
                        
                        int64_t tmp_127188 = sub64(j_127170, (int64_t) 1);
                        bool cond_127189 = sle64((int64_t) 0, tmp_127188);
                        bool loop_cond_127190;
                        
                        if (cond_127189) {
                            bool y_128911 = slt64(tmp_127188, block_sizze_127093);
                            bool bounds_check_128912 = cond_127189 && y_128911;
                            bool index_certs_128913;
                            
                            if (!bounds_check_128912) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127188, "] out of bounds for array of shape [", (long long) block_sizze_127093, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_128910 = ((int16_t *) mem_133194)[j_127170];
                            int16_t gt_arg0_128914 = ((int16_t *) mem_133194)[tmp_127188];
                            bool defunc_0_leq_res_128915 = sle16(gt_arg0_128914, gt_arg1_128910);
                            bool defunc_0_lifted_gt_res_128916 = !defunc_0_leq_res_128915;
                            
                            loop_cond_127190 = defunc_0_lifted_gt_res_128916;
                        } else {
                            loop_cond_127190 = 0;
                        }
                        
                        bool loop_while_tmp_133527 = loop_cond_127190;
                        int64_t j_tmp_133530 = tmp_127188;
                        
                        loop_while_127167 = loop_while_tmp_133527;
                        j_127170 = j_tmp_133530;
                    }
                    s_127163 = loop_while_127167;
                    s_127166 = j_127170;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_133181, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_133194, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133184, i_133054 * block_sizze_127093, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133196, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_127093});
        }
        if (memblock_alloc(ctx, &mem_133249, bytes_133180, "mem_133249")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_133249.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint16_t *) mem_133181, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        if (memblock_alloc(ctx, &mem_133253, bytes_133183, "mem_133253")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_133253.mem, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (uint64_t *) mem_133184, (int64_t) 0, (int64_t []) {block_sizze_127093, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_127083, block_sizze_127093});
        
        int64_t data_127203;
        bool data_127204;
        int64_t data_127207;
        int64_t loop_dz2084Uz2082U_127208;
        bool loop_while_127209;
        int64_t stride_127212;
        
        if (memblock_set(ctx, &mem_param_133257, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133260, &mem_133253, "mem_133253") != 0)
            return 1;
        loop_dz2084Uz2082U_127208 = flat_dim_127094;
        loop_while_127209 = loop_cond_127200;
        stride_127212 = block_sizze_127093;
        while (loop_while_127209) {
            int64_t next_stride_127213 = mul64((int64_t) 2, stride_127212);
            bool zzero_127214 = next_stride_127213 == (int64_t) 0;
            bool nonzzero_127215 = !zzero_127214;
            bool nonzzero_cert_127216;
            
            if (!nonzzero_127215) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_127217 = sdiv64(flat_dim_127094, next_stride_127213);
            bool bounds_invalid_upwards_127218 = slt64(num_merges_127217, (int64_t) 0);
            bool valid_127219 = !bounds_invalid_upwards_127218;
            bool range_valid_c_127220;
            
            if (!valid_127219) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_127217, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:101:36-40\n   #6  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_127222 = sub64(next_stride_127213, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_127223 = sle64((int64_t) 0, m_127222);
            bool cond_127225 = slt64(next_stride_127213, (int64_t) 10);
            bool protect_assert_disj_127226 = nonzzero_127202 || cond_127225;
            bool nonzzero_cert_127227;
            
            if (!protect_assert_disj_127226) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_127228 = smod_safe64(next_stride_127213, merge_block_sizze_127098);
            bool num_blocks_127229 = zeze_lhs_127228 == (int64_t) 0;
            bool protect_assert_disj_127230 = cond_127225 || num_blocks_127229;
            bool assert_c_127231;
            
            if (!protect_assert_disj_127230) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_127233 = sdiv_safe64(next_stride_127213, merge_block_sizze_127098);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234 = add64((int64_t) 1, num_blocks_127233);
            int64_t j_m_i_127235 = sub64(next_stride_127213, stride_127212);
            int64_t flat_dim_127236 = merge_block_sizze_127098 * num_blocks_127233;
            bool bounds_invalid_upwards_127237 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, (int64_t) 0);
            bool empty_slice_127238 = j_m_i_127235 == (int64_t) 0;
            int64_t m_127239 = sub64(j_m_i_127235, (int64_t) 1);
            bool zzero_lte_i_127240 = sle64((int64_t) 0, stride_127212);
            bool i_lte_j_127241 = sle64(stride_127212, next_stride_127213);
            bool empty_slice_127242 = stride_127212 == (int64_t) 0;
            int64_t m_127243 = sub64(stride_127212, (int64_t) 1);
            bool bounds_invalid_upwards_127244 = slt64(num_blocks_127233, (int64_t) 0);
            bool cond_127245 = slt64((int64_t) 0, stride_127212);
            bool valid_127246 = !bounds_invalid_upwards_127237;
            int64_t i_p_m_t_s_127247 = add64(stride_127212, m_127239);
            bool zzero_leq_i_p_m_t_s_127248 = sle64((int64_t) 0, m_127243);
            bool i_p_m_t_s_leq_w_127249 = slt64(m_127243, next_stride_127213);
            bool valid_127250 = !bounds_invalid_upwards_127244;
            bool i_p_m_t_s_leq_w_127251 = slt64(m_127222, flat_dim_127236);
            bool y_127252 = slt64((int64_t) 0, j_m_i_127235);
            bool protect_assert_disj_127253 = cond_127225 || valid_127246;
            bool range_valid_c_127254;
            
            if (!protect_assert_disj_127253) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_127255 = sle64((int64_t) 0, i_p_m_t_s_127247);
            bool i_p_m_t_s_leq_w_127256 = slt64(i_p_m_t_s_127247, next_stride_127213);
            bool y_127257 = zzero_leq_i_p_m_t_s_127248 && i_p_m_t_s_leq_w_127249;
            bool protect_assert_disj_127258 = cond_127225 || valid_127250;
            bool range_valid_c_127259;
            
            if (!protect_assert_disj_127258) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_127233, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_127260 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127251;
            bool y_127261 = zzero_lte_i_127240 && i_p_m_t_s_leq_w_127256;
            bool forwards_ok_127262 = zzero_lte_i_127240 && y_127257;
            bool ok_or_empty_127263 = zzero_127214 || y_127260;
            bool protect_assert_disj_127264 = cond_127245 || y_127252;
            bool y_127265 = zzero_leq_i_p_m_t_s_127255 && y_127261;
            bool ok_or_empty_127266 = empty_slice_127242 || forwards_ok_127262;
            bool protect_assert_disj_127267 = cond_127225 || ok_or_empty_127263;
            bool index_certs_127268;
            
            if (!protect_assert_disj_127267) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) flat_dim_127236, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_127269 = !cond_127225;
            bool protect_assert_disj_127270 = protect_assert_disj_127264 || loop_not_taken_127269;
            bool index_certs_127271;
            
            if (!protect_assert_disj_127270) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_127272 = i_lte_j_127241 && y_127265;
            bool protect_assert_disj_127273 = cond_127225 || ok_or_empty_127266;
            bool index_certs_127274;
            
            if (!protect_assert_disj_127273) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127275 = ok_or_empty_127266 || loop_not_taken_127269;
            bool index_certs_127276;
            
            if (!protect_assert_disj_127275) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_127212, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_127277 = empty_slice_127238 || forwards_ok_127272;
            bool protect_assert_disj_127278 = cond_127225 || ok_or_empty_127277;
            bool index_certs_127279;
            
            if (!protect_assert_disj_127278) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_127280 = loop_not_taken_127269 || ok_or_empty_127277;
            bool index_certs_127281;
            
            if (!protect_assert_disj_127280) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_127212, ":] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_133261 = (int64_t) 2 * num_merges_127217;
            int64_t bytes_133262 = next_stride_127213 * binop_x_133261;
            int64_t binop_x_133264 = (int64_t) 8 * num_merges_127217;
            int64_t bytes_133265 = next_stride_127213 * binop_x_133264;
            bool i_lte_j_127224 = sle64((int64_t) 0, next_stride_127213);
            
            if (mem_133263_cached_sizze_133867 < bytes_133262) {
                err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133867, bytes_133262);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133266_cached_sizze_133868 < bytes_133265) {
                err = lexical_realloc(ctx, &mem_133266, &mem_133266_cached_sizze_133868, bytes_133265);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_133275 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234;
            int64_t binop_x_133291 = (int64_t) 2 * num_blocks_127233;
            int64_t bytes_133292 = merge_block_sizze_127098 * binop_x_133291;
            int64_t binop_x_133294 = (int64_t) 8 * num_blocks_127233;
            int64_t bytes_133295 = merge_block_sizze_127098 * binop_x_133294;
            int64_t bytes_133337 = (int64_t) 4 * stride_127212;
            int64_t bytes_133339 = (int64_t) 16 * stride_127212;
            
            for (int64_t i_133075 = 0; i_133075 < num_merges_127217; i_133075++) {
                int64_t start_127285 = mul64(next_stride_127213, i_133075);
                int64_t j_m_i_127286 = sub64(loop_dz2084Uz2082U_127208, start_127285);
                bool empty_slice_127287 = j_m_i_127286 == (int64_t) 0;
                int64_t m_127288 = sub64(j_m_i_127286, (int64_t) 1);
                int64_t i_p_m_t_s_127289 = add64(start_127285, m_127288);
                bool zzero_leq_i_p_m_t_s_127290 = sle64((int64_t) 0, i_p_m_t_s_127289);
                bool i_p_m_t_s_leq_w_127291 = slt64(i_p_m_t_s_127289, loop_dz2084Uz2082U_127208);
                bool zzero_lte_i_127292 = sle64((int64_t) 0, start_127285);
                bool i_lte_j_127293 = sle64(start_127285, loop_dz2084Uz2082U_127208);
                bool y_127294 = i_p_m_t_s_leq_w_127291 && zzero_lte_i_127292;
                bool y_127295 = zzero_leq_i_p_m_t_s_127290 && y_127294;
                bool forwards_ok_127296 = i_lte_j_127293 && y_127295;
                bool ok_or_empty_127297 = empty_slice_127287 || forwards_ok_127296;
                bool index_certs_127298;
                
                if (!ok_or_empty_127297) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_127285, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_127208, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_127299 = slt64(m_127222, j_m_i_127286);
                bool y_127300 = zzero_leq_i_p_m_t_s_127223 && i_p_m_t_s_leq_w_127299;
                bool forwards_ok_127301 = i_lte_j_127224 && y_127300;
                bool ok_or_empty_127302 = zzero_127214 || forwards_ok_127301;
                bool index_certs_127303;
                
                if (!ok_or_empty_127302) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_127213, "] out of bounds for array of shape [", (long long) j_m_i_127286, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_127225) {
                    int16_t dummy_128942;
                    int64_t dummy_128943;
                    
                    if (cond_127245) {
                        int16_t head_res_128944 = ((int16_t *) mem_param_133257.mem)[start_127285];
                        int64_t head_res_128945 = ((int64_t *) mem_param_133260.mem)[start_127285];
                        
                        dummy_128942 = head_res_128944;
                        dummy_128943 = head_res_128945;
                    } else {
                        int64_t slice_128946 = stride_127212 + start_127285;
                        int16_t head_res_128947 = ((int16_t *) mem_param_133257.mem)[slice_128946];
                        int64_t head_res_128948 = ((int64_t *) mem_param_133260.mem)[slice_128946];
                        
                        dummy_128942 = head_res_128947;
                        dummy_128943 = head_res_128948;
                    }
                    if (memblock_alloc(ctx, &mem_133338, bytes_133337, "mem_133338")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133540 = 0; nest_i_133540 < next_stride_127213; nest_i_133540++) {
                        ((int16_t *) mem_133338.mem)[nest_i_133540] = dummy_128942;
                    }
                    if (memblock_alloc(ctx, &mem_133340, bytes_133339, "mem_133340")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_133541 = 0; nest_i_133541 < next_stride_127213; nest_i_133541++) {
                        ((int64_t *) mem_133340.mem)[nest_i_133541] = dummy_128943;
                    }
                    
                    int64_t data_128951;
                    int64_t i_128955 = (int64_t) 0;
                    
                    for (int64_t k_128954 = 0; k_128954 < next_stride_127213; k_128954++) {
                        int64_t j_128958 = sub64(k_128954, i_128955);
                        bool cond_128959 = j_128958 == j_m_i_127235;
                        bool cond_128960;
                        
                        if (cond_128959) {
                            cond_128960 = 1;
                        } else {
                            bool cond_128961 = slt64(i_128955, stride_127212);
                            bool cond_f_res_128962;
                            
                            if (cond_128961) {
                                bool x_128963 = sle64((int64_t) 0, j_128958);
                                bool y_128964 = slt64(j_128958, j_m_i_127235);
                                bool bounds_check_128965 = x_128963 && y_128964;
                                bool index_certs_128966;
                                
                                if (!bounds_check_128965) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_128970 = sle64((int64_t) 0, i_128955);
                                bool bounds_check_128971 = cond_128961 && x_128970;
                                bool index_certs_128972;
                                
                                if (!bounds_check_128971) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_128967 = stride_127212 + j_128958;
                                int64_t slice_128968 = start_127285 + slice_128967;
                                int16_t leq_arg1_128969 = ((int16_t *) mem_param_133257.mem)[slice_128968];
                                int64_t slice_128973 = start_127285 + i_128955;
                                int16_t leq_arg0_128974 = ((int16_t *) mem_param_133257.mem)[slice_128973];
                                bool defunc_0_leq_res_128975 = sle16(leq_arg0_128974, leq_arg1_128969);
                                
                                cond_f_res_128962 = defunc_0_leq_res_128975;
                            } else {
                                cond_f_res_128962 = 0;
                            }
                            cond_128960 = cond_f_res_128962;
                        }
                        
                        int64_t loopres_128976;
                        int16_t loopres_128977;
                        int64_t loopres_128978;
                        
                        if (cond_128960) {
                            bool x_128980 = sle64((int64_t) 0, i_128955);
                            bool y_128981 = slt64(i_128955, stride_127212);
                            bool bounds_check_128982 = x_128980 && y_128981;
                            bool index_certs_128983;
                            
                            if (!bounds_check_128982) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_128955, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_128979 = add64((int64_t) 1, i_128955);
                            int64_t slice_128984 = start_127285 + i_128955;
                            int16_t tmp_128985 = ((int16_t *) mem_param_133257.mem)[slice_128984];
                            int64_t tmp_128986 = ((int64_t *) mem_param_133260.mem)[slice_128984];
                            
                            loopres_128976 = tmp_128979;
                            loopres_128977 = tmp_128985;
                            loopres_128978 = tmp_128986;
                        } else {
                            bool x_128987 = sle64((int64_t) 0, j_128958);
                            bool y_128988 = slt64(j_128958, j_m_i_127235);
                            bool bounds_check_128989 = x_128987 && y_128988;
                            bool index_certs_128990;
                            
                            if (!bounds_check_128989) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_128958, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_128991 = stride_127212 + j_128958;
                            int64_t slice_128992 = start_127285 + slice_128991;
                            int16_t tmp_128993 = ((int16_t *) mem_param_133257.mem)[slice_128992];
                            int64_t tmp_128994 = ((int64_t *) mem_param_133260.mem)[slice_128992];
                            
                            loopres_128976 = i_128955;
                            loopres_128977 = tmp_128993;
                            loopres_128978 = tmp_128994;
                        }
                        ((int16_t *) mem_133338.mem)[k_128954] = loopres_128977;
                        ((int64_t *) mem_133340.mem)[k_128954] = loopres_128978;
                        
                        int64_t i_tmp_133542 = loopres_128976;
                        
                        i_128955 = i_tmp_133542;
                    }
                    data_128951 = i_128955;
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133338, "mem_133338") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133340, "mem_133340") != 0)
                        return 1;
                } else {
                    if (mem_133276_cached_sizze_133869 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133276, &mem_133276_cached_sizze_133869, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133278_cached_sizze_133870 < bytes_133275) {
                        err = lexical_realloc(ctx, &mem_133278, &mem_133278_cached_sizze_133870, bytes_133275);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133061 = 0; i_133061 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234; i_133061++) {
                        int64_t split_count_arg3_127365 = mul64(merge_block_sizze_127098, i_133061);
                        int64_t defunc_0_split_count_res_127366;
                        int64_t defunc_0_split_count_res_127367;
                        int64_t defunc_0_split_count_res_127368;
                        int64_t defunc_0_split_count_res_127369;
                        int64_t defunc_0_split_count_res_127370;
                        
                        if (futrts_lifted_normalizze_10477(ctx, &defunc_0_split_count_res_127366, &defunc_0_split_count_res_127367, &defunc_0_split_count_res_127368, &defunc_0_split_count_res_127369, &defunc_0_split_count_res_127370, (int64_t) 0, stride_127212, (int64_t) 0, j_m_i_127235, split_count_arg3_127365) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_127371 = slt64((int64_t) 0, defunc_0_split_count_res_127370);
                        bool defunc_0_split_count_res_127372;
                        int64_t defunc_0_split_count_res_127373;
                        int64_t defunc_0_split_count_res_127374;
                        int64_t defunc_0_split_count_res_127375;
                        int64_t defunc_0_split_count_res_127376;
                        int64_t defunc_0_split_count_res_127377;
                        bool loop_while_127378;
                        int64_t ss_127379;
                        int64_t ss_127380;
                        int64_t tt_127381;
                        int64_t tt_127382;
                        int64_t count_127383;
                        
                        loop_while_127378 = loop_cond_127371;
                        ss_127379 = defunc_0_split_count_res_127366;
                        ss_127380 = defunc_0_split_count_res_127367;
                        tt_127381 = defunc_0_split_count_res_127368;
                        tt_127382 = defunc_0_split_count_res_127369;
                        count_127383 = defunc_0_split_count_res_127370;
                        while (loop_while_127378) {
                            int64_t zlze_lhs_127384 = sub64(ss_127380, ss_127379);
                            bool cond_127385 = sle64(zlze_lhs_127384, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_127386;
                            int64_t defunc_0_lifted_step_res_127387;
                            int64_t defunc_0_lifted_step_res_127388;
                            int64_t defunc_0_lifted_step_res_127389;
                            
                            if (cond_127385) {
                                int64_t tmp_128997 = add64(tt_127381, count_127383);
                                
                                defunc_0_lifted_step_res_127386 = ss_127379;
                                defunc_0_lifted_step_res_127387 = tmp_128997;
                                defunc_0_lifted_step_res_127388 = tt_127382;
                                defunc_0_lifted_step_res_127389 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_127391 = sub64(tt_127382, tt_127381);
                                bool cond_127392 = sle64(zlze_lhs_127391, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_127393;
                                int64_t defunc_0_lifted_step_res_f_res_127394;
                                int64_t defunc_0_lifted_step_res_f_res_127395;
                                int64_t defunc_0_lifted_step_res_f_res_127396;
                                
                                if (cond_127392) {
                                    int64_t tmp_128998 = add64(ss_127379, count_127383);
                                    
                                    defunc_0_lifted_step_res_f_res_127393 = tmp_128998;
                                    defunc_0_lifted_step_res_f_res_127394 = tt_127381;
                                    defunc_0_lifted_step_res_f_res_127395 = tt_127382;
                                    defunc_0_lifted_step_res_f_res_127396 = (int64_t) 0;
                                } else {
                                    bool cond_127398 = count_127383 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127399;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127400;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127401;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_127402;
                                    
                                    if (cond_127398) {
                                        bool x_129000 = sle64((int64_t) 0, ss_127379);
                                        bool y_129001 = slt64(ss_127379, stride_127212);
                                        bool bounds_check_129002 = x_129000 && y_129001;
                                        bool index_certs_129003;
                                        
                                        if (!bounds_check_129002) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_127379, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_129006 = sle64((int64_t) 0, tt_127381);
                                        bool y_129007 = slt64(tt_127381, j_m_i_127235);
                                        bool bounds_check_129008 = x_129006 && y_129007;
                                        bool index_certs_129009;
                                        
                                        if (!bounds_check_129008) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_127381, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_129004 = start_127285 + ss_127379;
                                        int16_t leq_arg1_129005 = ((int16_t *) mem_param_133257.mem)[slice_129004];
                                        int64_t slice_129010 = stride_127212 + tt_127381;
                                        int64_t slice_129011 = start_127285 + slice_129010;
                                        int16_t leq_arg0_129012 = ((int16_t *) mem_param_133257.mem)[slice_129011];
                                        bool defunc_0_leq_res_129013 = sle16(leq_arg0_129012, leq_arg1_129005);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        
                                        if (defunc_0_leq_res_129013) {
                                            int64_t tmp_129016 = add64((int64_t) 1, tt_127381);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = ss_127379;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tmp_129016;
                                        } else {
                                            int64_t tmp_129017 = add64((int64_t) 1, ss_127379);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129014 = tmp_129017;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_129015 = tt_127381;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = defunc_0_lifted_step_res_f_res_f_res_t_res_129014;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_t_res_129015;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = tt_127382;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = (int64_t) 0;
                                    } else {
                                        int64_t m_127421 = sdiv64(count_127383, (int64_t) 2);
                                        int64_t n_127422 = sub64(count_127383, m_127421);
                                        bool cond_127423 = n_127422 == (int64_t) 0;
                                        int64_t zgze_lhs_127424 = add64(ss_127379, m_127421);
                                        bool cond_f_res_127425 = sle64(ss_127380, zgze_lhs_127424);
                                        bool x_127426 = !cond_127423;
                                        bool y_127427 = cond_f_res_127425 && x_127426;
                                        bool cond_127428 = cond_127423 || y_127427;
                                        bool leq_y_x_127429;
                                        
                                        if (cond_127428) {
                                            leq_y_x_127429 = 1;
                                        } else {
                                            bool x_127430 = sle64((int64_t) 0, zgze_lhs_127424);
                                            bool y_127431 = slt64(zgze_lhs_127424, stride_127212);
                                            bool bounds_check_127432 = x_127430 && y_127431;
                                            bool index_certs_127433;
                                            
                                            if (!bounds_check_127432) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_127424, "] out of bounds for array of shape [", (long long) stride_127212, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_127436 = add64(tt_127381, n_127422);
                                            int64_t leq_arg0_127437 = sub64(zm_lhs_127436, (int64_t) 1);
                                            bool x_127438 = sle64((int64_t) 0, leq_arg0_127437);
                                            bool y_127439 = slt64(leq_arg0_127437, j_m_i_127235);
                                            bool bounds_check_127440 = x_127438 && y_127439;
                                            bool index_certs_127441;
                                            
                                            if (!bounds_check_127440) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_127437, "] out of bounds for array of shape [", (long long) j_m_i_127235, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_127434 = start_127285 + zgze_lhs_127424;
                                            int16_t leq_arg1_127435 = ((int16_t *) mem_param_133257.mem)[slice_127434];
                                            int64_t slice_127442 = stride_127212 + leq_arg0_127437;
                                            int64_t slice_127443 = start_127285 + slice_127442;
                                            int16_t leq_arg0_127444 = ((int16_t *) mem_param_133257.mem)[slice_127443];
                                            bool defunc_0_leq_res_127445 = sle16(leq_arg0_127444, leq_arg1_127435);
                                            
                                            leq_y_x_127429 = defunc_0_leq_res_127445;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                        
                                        if (leq_y_x_127429) {
                                            int64_t tmp_129018 = add64(tt_127381, n_127422);
                                            int64_t tmp_129019 = sub64(count_127383, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tmp_129018;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tt_127382;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = tmp_129019;
                                        } else {
                                            int64_t tmp_127451 = add64(tt_127381, n_127422);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127446 = tt_127381;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127447 = tmp_127451;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_127448 = count_127383;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_127399 = ss_127379;
                                        defunc_0_lifted_step_res_f_res_f_res_127400 = defunc_0_lifted_step_res_f_res_f_res_f_res_127446;
                                        defunc_0_lifted_step_res_f_res_f_res_127401 = defunc_0_lifted_step_res_f_res_f_res_f_res_127447;
                                        defunc_0_lifted_step_res_f_res_f_res_127402 = defunc_0_lifted_step_res_f_res_f_res_f_res_127448;
                                    }
                                    defunc_0_lifted_step_res_f_res_127393 = defunc_0_lifted_step_res_f_res_f_res_127399;
                                    defunc_0_lifted_step_res_f_res_127394 = defunc_0_lifted_step_res_f_res_f_res_127400;
                                    defunc_0_lifted_step_res_f_res_127395 = defunc_0_lifted_step_res_f_res_f_res_127401;
                                    defunc_0_lifted_step_res_f_res_127396 = defunc_0_lifted_step_res_f_res_f_res_127402;
                                }
                                defunc_0_lifted_step_res_127386 = defunc_0_lifted_step_res_f_res_127393;
                                defunc_0_lifted_step_res_127387 = defunc_0_lifted_step_res_f_res_127394;
                                defunc_0_lifted_step_res_127388 = defunc_0_lifted_step_res_f_res_127395;
                                defunc_0_lifted_step_res_127389 = defunc_0_lifted_step_res_f_res_127396;
                            }
                            
                            int64_t loopres_127452;
                            int64_t loopres_127453;
                            int64_t loopres_127454;
                            int64_t loopres_127455;
                            int64_t loopres_127456;
                            
                            if (futrts_lifted_normalizze_10477(ctx, &loopres_127452, &loopres_127453, &loopres_127454, &loopres_127455, &loopres_127456, defunc_0_lifted_step_res_127386, ss_127380, defunc_0_lifted_step_res_127387, defunc_0_lifted_step_res_127388, defunc_0_lifted_step_res_127389) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_127457 = slt64((int64_t) 0, loopres_127456);
                            bool loop_while_tmp_133547 = loop_cond_127457;
                            int64_t ss_tmp_133548 = loopres_127452;
                            int64_t ss_tmp_133549 = loopres_127453;
                            int64_t tt_tmp_133550 = loopres_127454;
                            int64_t tt_tmp_133551 = loopres_127455;
                            int64_t count_tmp_133552 = loopres_127456;
                            
                            loop_while_127378 = loop_while_tmp_133547;
                            ss_127379 = ss_tmp_133548;
                            ss_127380 = ss_tmp_133549;
                            tt_127381 = tt_tmp_133550;
                            tt_127382 = tt_tmp_133551;
                            count_127383 = count_tmp_133552;
                        }
                        defunc_0_split_count_res_127372 = loop_while_127378;
                        defunc_0_split_count_res_127373 = ss_127379;
                        defunc_0_split_count_res_127374 = ss_127380;
                        defunc_0_split_count_res_127375 = tt_127381;
                        defunc_0_split_count_res_127376 = tt_127382;
                        defunc_0_split_count_res_127377 = count_127383;
                        ((int64_t *) mem_133276)[i_133061] = defunc_0_split_count_res_127373;
                        ((int64_t *) mem_133278)[i_133061] = defunc_0_split_count_res_127375;
                    }
                    if (mem_133293_cached_sizze_133871 < bytes_133292) {
                        err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133871, bytes_133292);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_133296_cached_sizze_133872 < bytes_133295) {
                        err = lexical_realloc(ctx, &mem_133296, &mem_133296_cached_sizze_133872, bytes_133295);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_133068 = 0; i_133068 < num_blocks_127233; i_133068++) {
                        bool y_127463 = slt64(i_133068, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool index_certs_127465;
                        
                        if (!y_127463) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133068, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127466 = ((int64_t *) mem_133276)[i_133068];
                        int64_t defunc_0_f_res_127467 = ((int64_t *) mem_133278)[i_133068];
                        int64_t tmp_127468 = add64((int64_t) 1, i_133068);
                        bool x_127469 = sle64((int64_t) 0, tmp_127468);
                        bool y_127470 = slt64(tmp_127468, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234);
                        bool bounds_check_127471 = x_127469 && y_127470;
                        bool index_certs_127472;
                        
                        if (!bounds_check_127471) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_127468, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_127234, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_127473 = ((int64_t *) mem_133276)[tmp_127468];
                        int64_t defunc_0_f_res_127474 = ((int64_t *) mem_133278)[tmp_127468];
                        int64_t merge_sequential_arg2_127475 = add64(stride_127212, defunc_0_f_res_127467);
                        int64_t merge_sequential_arg2_127476 = add64(stride_127212, defunc_0_f_res_127474);
                        int64_t j_m_i_127477 = sub64(merge_sequential_arg2_127476, merge_sequential_arg2_127475);
                        bool empty_slice_127478 = j_m_i_127477 == (int64_t) 0;
                        int64_t m_127479 = sub64(j_m_i_127477, (int64_t) 1);
                        int64_t i_p_m_t_s_127480 = add64(merge_sequential_arg2_127475, m_127479);
                        bool zzero_leq_i_p_m_t_s_127481 = sle64((int64_t) 0, i_p_m_t_s_127480);
                        bool i_p_m_t_s_leq_w_127482 = slt64(i_p_m_t_s_127480, next_stride_127213);
                        bool zzero_lte_i_127483 = sle64((int64_t) 0, merge_sequential_arg2_127475);
                        bool i_lte_j_127484 = sle64(merge_sequential_arg2_127475, merge_sequential_arg2_127476);
                        bool y_127485 = i_p_m_t_s_leq_w_127482 && zzero_lte_i_127483;
                        bool y_127486 = zzero_leq_i_p_m_t_s_127481 && y_127485;
                        bool forwards_ok_127487 = i_lte_j_127484 && y_127486;
                        bool ok_or_empty_127488 = empty_slice_127478 || forwards_ok_127487;
                        bool index_certs_127489;
                        
                        if (!ok_or_empty_127488) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_127475, ":", (long long) merge_sequential_arg2_127476, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_127490 = sub64(defunc_0_f_res_127473, defunc_0_f_res_127466);
                        bool empty_slice_127491 = j_m_i_127490 == (int64_t) 0;
                        int64_t m_127492 = sub64(j_m_i_127490, (int64_t) 1);
                        int64_t i_p_m_t_s_127493 = add64(defunc_0_f_res_127466, m_127492);
                        bool zzero_leq_i_p_m_t_s_127494 = sle64((int64_t) 0, i_p_m_t_s_127493);
                        bool i_p_m_t_s_leq_w_127495 = slt64(i_p_m_t_s_127493, next_stride_127213);
                        bool zzero_lte_i_127496 = sle64((int64_t) 0, defunc_0_f_res_127466);
                        bool i_lte_j_127497 = sle64(defunc_0_f_res_127466, defunc_0_f_res_127473);
                        bool y_127498 = i_p_m_t_s_leq_w_127495 && zzero_lte_i_127496;
                        bool y_127499 = zzero_leq_i_p_m_t_s_127494 && y_127498;
                        bool forwards_ok_127500 = i_lte_j_127497 && y_127499;
                        bool ok_or_empty_127501 = empty_slice_127491 || forwards_ok_127500;
                        bool index_certs_127502;
                        
                        if (!ok_or_empty_127501) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_127466, ":", (long long) defunc_0_f_res_127473, "] out of bounds for array of shape [", (long long) next_stride_127213, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_127503 = slt64((int64_t) 0, j_m_i_127490);
                        int16_t dummy_127504;
                        int64_t dummy_127505;
                        
                        if (cond_127503) {
                            bool index_certs_129020;
                            
                            if (!cond_127503) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:101:36-40\n   #12 ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_129021 = start_127285 + defunc_0_f_res_127466;
                            int16_t head_res_129022 = ((int16_t *) mem_param_133257.mem)[slice_129021];
                            int64_t head_res_129023 = ((int64_t *) mem_param_133260.mem)[slice_129021];
                            
                            dummy_127504 = head_res_129022;
                            dummy_127505 = head_res_129023;
                        } else {
                            bool y_127510 = slt64((int64_t) 0, j_m_i_127477);
                            bool index_certs_127511;
                            
                            if (!y_127510) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:58-61\n   #11 ftRelational.fut:101:36-40\n   #12 ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_127512 = start_127285 + merge_sequential_arg2_127475;
                            int16_t head_res_127513 = ((int16_t *) mem_param_133257.mem)[slice_127512];
                            int64_t head_res_127514 = ((int64_t *) mem_param_133260.mem)[slice_127512];
                            
                            dummy_127504 = head_res_127513;
                            dummy_127505 = head_res_127514;
                        }
                        for (int64_t nest_i_133555 = 0; nest_i_133555 < merge_block_sizze_127098; nest_i_133555++) {
                            ((int16_t *) mem_133293)[i_133068 * merge_block_sizze_127098 + nest_i_133555] = dummy_127504;
                        }
                        for (int64_t nest_i_133556 = 0; nest_i_133556 < merge_block_sizze_127098; nest_i_133556++) {
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + nest_i_133556] = dummy_127505;
                        }
                        
                        int64_t data_127517;
                        int64_t i_127521 = (int64_t) 0;
                        
                        for (int64_t k_127520 = 0; k_127520 < merge_block_sizze_127098; k_127520++) {
                            int64_t j_127524 = sub64(k_127520, i_127521);
                            bool cond_127525 = j_127524 == j_m_i_127477;
                            bool cond_127526;
                            
                            if (cond_127525) {
                                cond_127526 = 1;
                            } else {
                                bool cond_127527 = slt64(i_127521, j_m_i_127490);
                                bool cond_f_res_127528;
                                
                                if (cond_127527) {
                                    bool x_129024 = sle64((int64_t) 0, j_127524);
                                    bool y_129025 = slt64(j_127524, j_m_i_127477);
                                    bool bounds_check_129026 = x_129024 && y_129025;
                                    bool index_certs_129027;
                                    
                                    if (!bounds_check_129026) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_129031 = sle64((int64_t) 0, i_127521);
                                    bool bounds_check_129032 = cond_127527 && x_129031;
                                    bool index_certs_129033;
                                    
                                    if (!bounds_check_129032) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_129028 = merge_sequential_arg2_127475 + j_127524;
                                    int64_t slice_129029 = start_127285 + slice_129028;
                                    int16_t leq_arg1_129030 = ((int16_t *) mem_param_133257.mem)[slice_129029];
                                    int64_t slice_129034 = defunc_0_f_res_127466 + i_127521;
                                    int64_t slice_129035 = start_127285 + slice_129034;
                                    int16_t leq_arg0_129036 = ((int16_t *) mem_param_133257.mem)[slice_129035];
                                    bool defunc_0_leq_res_129037 = sle16(leq_arg0_129036, leq_arg1_129030);
                                    
                                    cond_f_res_127528 = defunc_0_leq_res_129037;
                                } else {
                                    cond_f_res_127528 = 0;
                                }
                                cond_127526 = cond_f_res_127528;
                            }
                            
                            int64_t loopres_127543;
                            int16_t loopres_127544;
                            int64_t loopres_127545;
                            
                            if (cond_127526) {
                                bool x_129039 = sle64((int64_t) 0, i_127521);
                                bool y_129040 = slt64(i_127521, j_m_i_127490);
                                bool bounds_check_129041 = x_129039 && y_129040;
                                bool index_certs_129042;
                                
                                if (!bounds_check_129041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_127521, "] out of bounds for array of shape [", (long long) j_m_i_127490, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_129038 = add64((int64_t) 1, i_127521);
                                int64_t slice_129043 = defunc_0_f_res_127466 + i_127521;
                                int64_t slice_129044 = start_127285 + slice_129043;
                                int16_t tmp_129045 = ((int16_t *) mem_param_133257.mem)[slice_129044];
                                int64_t tmp_129046 = ((int64_t *) mem_param_133260.mem)[slice_129044];
                                
                                loopres_127543 = tmp_129038;
                                loopres_127544 = tmp_129045;
                                loopres_127545 = tmp_129046;
                            } else {
                                bool x_127555 = sle64((int64_t) 0, j_127524);
                                bool y_127556 = slt64(j_127524, j_m_i_127477);
                                bool bounds_check_127557 = x_127555 && y_127556;
                                bool index_certs_127558;
                                
                                if (!bounds_check_127557) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_127524, "] out of bounds for array of shape [", (long long) j_m_i_127477, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_127559 = merge_sequential_arg2_127475 + j_127524;
                                int64_t slice_127560 = start_127285 + slice_127559;
                                int16_t tmp_127561 = ((int16_t *) mem_param_133257.mem)[slice_127560];
                                int64_t tmp_127562 = ((int64_t *) mem_param_133260.mem)[slice_127560];
                                
                                loopres_127543 = i_127521;
                                loopres_127544 = tmp_127561;
                                loopres_127545 = tmp_127562;
                            }
                            ((int16_t *) mem_133293)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127544;
                            ((int64_t *) mem_133296)[i_133068 * merge_block_sizze_127098 + k_127520] = loopres_127545;
                            
                            int64_t i_tmp_133557 = loopres_127543;
                            
                            i_127521 = i_tmp_133557;
                        }
                        data_127517 = i_127521;
                    }
                    if (memblock_alloc(ctx, &mem_133331, bytes_133292, "mem_133331")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_133331.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint16_t *) mem_133293, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_alloc(ctx, &mem_133335, bytes_133295, "mem_133335")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_133335.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (uint64_t *) mem_133296, (int64_t) 0, (int64_t []) {merge_block_sizze_127098, (int64_t) 1}, (int64_t []) {num_blocks_127233, merge_block_sizze_127098});
                    if (memblock_set(ctx, &ext_mem_133358, &mem_133331, "mem_133331") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_133355, &mem_133335, "mem_133335") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_133263, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133266, i_133075 * next_stride_127213, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_127213});
                if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
                    return 1;
            }
            
            int64_t flat_dim_127569 = next_stride_127213 * num_merges_127217;
            
            if (memblock_alloc(ctx, &mem_133369, bytes_133262, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_133369.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint16_t *) mem_133263, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            if (memblock_alloc(ctx, &mem_133373, bytes_133265, "mem_133373")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_133373.mem, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (uint64_t *) mem_133266, (int64_t) 0, (int64_t []) {next_stride_127213, (int64_t) 1}, (int64_t []) {num_merges_127217, next_stride_127213});
            
            bool loop_cond_127572 = slt64(next_stride_127213, flat_dim_127094);
            
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133373, "mem_133373") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_133533 = flat_dim_127569;
            bool loop_while_tmp_133534 = loop_cond_127572;
            int64_t stride_tmp_133537 = next_stride_127213;
            
            if (memblock_set(ctx, &mem_param_133257, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133260, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            loop_dz2084Uz2082U_127208 = loop_dz2084Uz2082U_tmp_133533;
            loop_while_127209 = loop_while_tmp_133534;
            stride_127212 = stride_tmp_133537;
        }
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133379, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        data_127203 = loop_dz2084Uz2082U_127208;
        data_127204 = loop_while_127209;
        data_127207 = stride_127212;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        
        bool empty_slice_127573 = n_74947 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_127574 = sle64((int64_t) 0, zs_lhs_127078);
        bool i_p_m_t_s_leq_w_127575 = slt64(zs_lhs_127078, data_127203);
        bool y_127576 = zzero_leq_i_p_m_t_s_127574 && i_p_m_t_s_leq_w_127575;
        bool ok_or_empty_127577 = empty_slice_127573 || y_127576;
        bool index_certs_127578;
        
        if (!ok_or_empty_127577) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_74947, "] out of bounds for array of shape [", (long long) data_127203, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:58-61\n   #5  ftRelational.fut:101:36-40\n   #6  ftRelational.fut:98:9-101:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_133383, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133385, bytes_133384, "mem_133385")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133387, bytes_133386, "mem_133387")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133082 = 0; i_133082 < n_74947; i_133082++) {
        int64_t eta_p_127586 = ((int64_t *) ext_mem_133383.mem)[i_133082];
        bool x_127587 = sle64((int64_t) 0, eta_p_127586);
        bool y_127588 = slt64(eta_p_127586, n_74947);
        bool bounds_check_127589 = x_127587 && y_127588;
        bool index_certs_127590;
        
        if (!bounds_check_127589) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_127586, "] out of bounds for array of shape [", (long long) n_74947, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t lifted_lambda_res_127591 = ((int16_t *) k_mem_133175.mem)[eta_p_127586];
        
        ((int16_t *) mem_133385.mem)[i_133082] = lifted_lambda_res_127591;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133387.mem, i_133082 * b_74948, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_133176.mem, eta_p_127586 * b_74948, (int64_t []) {(int64_t) 1}, (int64_t []) {b_74948});
    }
    if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133385, "mem_133385") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133387, "mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133861, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133862, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133181);
        free(mem_133184);
        free(mem_133194);
        free(mem_133196);
        free(mem_133263);
        free(mem_133266);
        free(mem_133276);
        free(mem_133278);
        free(mem_133293);
        free(mem_133296);
        if (memblock_unref(ctx, &mem_133387, "mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133385, "mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133373, "mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133335, "mem_133335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133331, "mem_133331") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133340, "mem_133340") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133338, "mem_133338") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133355, "ext_mem_133355") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133358, "ext_mem_133358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133260, "mem_param_133260") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133257, "mem_param_133257") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133379, "ext_mem_133379") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133253, "mem_133253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133249, "mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_133873, struct memblock eta_p_mem_133175, int64_t nz2080U_62746)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t defunc_0_reduce_res_128906;
    int64_t redout_133040 = (int64_t) 9223372036854775807;
    
    for (int64_t i_133041 = 0; i_133041 < nz2080U_62746; i_133041++) {
        int64_t x_121034 = ((int64_t *) eta_p_mem_133175.mem)[i_133041];
        int64_t min_res_121037 = smin64(x_121034, redout_133040);
        int64_t redout_tmp_133514 = min_res_121037;
        
        redout_133040 = redout_tmp_133514;
    }
    defunc_0_reduce_res_128906 = redout_133040;
    prim_out_133513 = defunc_0_reduce_res_128906;
    *out_prim_out_133873 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_133874, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_64456, int64_t incr_64457, int64_t block_sizze_64458)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_64456;
    bool zzero_121181 = block_sizze_64458 == (int64_t) 0;
    bool nonzzero_121182 = !zzero_121181;
    bool nonzzero_cert_121183;
    
    if (!nonzzero_121182) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:37:1-39:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < n_64456; i_133042++) {
        int64_t eta_p_121177 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121178 = sub64(eta_p_121177, incr_64457);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121178;
    }
    
    int64_t zm_lhs_121179 = add64(n_64456, block_sizze_64458);
    int64_t zs_lhs_121180 = sub64(zm_lhs_121179, (int64_t) 1);
    int64_t m_121184 = sdiv64(zs_lhs_121180, block_sizze_64458);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133177, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_64456; nest_i_133515++) {
        ((double *) mem_133186.mem)[nest_i_133515] = 0.0;
    }
    
    bool loop_cond_121186 = slt64((int64_t) 0, m_121184);
    bool partitioned_gather_res_121187;
    int64_t partitioned_gather_res_121190;
    bool loop_while_121191;
    int64_t p_121194;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121191 = loop_cond_121186;
    p_121194 = (int64_t) 0;
    while (loop_while_121191) {
        int64_t lower_bound_121195 = mul64(block_sizze_64458, p_121194);
        int64_t min_arg1_121196 = add64(block_sizze_64458, lower_bound_121195);
        int64_t min_res_121197 = smin64(n_64456, min_arg1_121196);
        int64_t j_m_i_121198 = sub64(min_res_121197, lower_bound_121195);
        bool empty_slice_121199 = j_m_i_121198 == (int64_t) 0;
        int64_t m_121200 = sub64(j_m_i_121198, (int64_t) 1);
        int64_t i_p_m_t_s_121201 = add64(lower_bound_121195, m_121200);
        bool zzero_leq_i_p_m_t_s_121202 = sle64((int64_t) 0, i_p_m_t_s_121201);
        bool i_p_m_t_s_leq_w_121203 = slt64(i_p_m_t_s_121201, n_64456);
        bool zzero_lte_i_121204 = sle64((int64_t) 0, lower_bound_121195);
        bool i_lte_j_121205 = sle64(lower_bound_121195, min_res_121197);
        bool y_121206 = i_p_m_t_s_leq_w_121203 && zzero_lte_i_121204;
        bool y_121207 = zzero_leq_i_p_m_t_s_121202 && y_121206;
        bool forwards_ok_121208 = i_lte_j_121205 && y_121207;
        bool ok_or_empty_121209 = empty_slice_121199 || forwards_ok_121208;
        bool index_certs_121210;
        
        if (!ok_or_empty_121209) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121195, ":", (long long) min_res_121197, "] out of bounds for array of shape [", (long long) n_64456, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:37:1-39:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_64456});
        if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < n_64456; i_133046++) {
            int64_t eta_p_121213 = ((int64_t *) mem_param_133189.mem)[i_133046];
            double eta_p_121214 = ((double *) mem_param_133192.mem)[i_133046];
            bool cond_121215 = sle64(lower_bound_121195, eta_p_121213);
            bool cond_t_res_121216 = slt64(eta_p_121213, min_res_121197);
            bool x_121217 = cond_121215 && cond_t_res_121216;
            double lifted_lambda_res_121218;
            
            if (x_121217) {
                int64_t tmp_128906 = sub64(eta_p_121213, lower_bound_121195);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121198);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121198, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:157:3-49\n   #4  ftRelational.fut:37:1-39:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double tmp_128911 = ((double *) ys_mem_133176.mem)[eta_p_121213];
                
                lifted_lambda_res_121218 = tmp_128911;
            } else {
                lifted_lambda_res_121218 = eta_p_121214;
            }
            ((double *) mem_133196.mem)[i_133046] = lifted_lambda_res_121218;
        }
        
        int64_t tmp_121225 = add64((int64_t) 1, p_121194);
        bool loop_cond_121226 = slt64(tmp_121225, m_121184);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121226;
        int64_t p_tmp_133521 = tmp_121225;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121191 = loop_while_tmp_133518;
        p_121194 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121187 = loop_while_121191;
    partitioned_gather_res_121190 = p_121194;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133177, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_64456});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133874, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_133875, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_64122, int64_t incr_64123, int64_t block_sizze_64124)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_64122;
    bool zzero_121181 = block_sizze_64124 == (int64_t) 0;
    bool nonzzero_121182 = !zzero_121181;
    bool nonzzero_cert_121183;
    
    if (!nonzzero_121182) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:34:1-36:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = (int64_t) 4 * n_64122;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < n_64122; i_133042++) {
        int64_t eta_p_121177 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121178 = sub64(eta_p_121177, incr_64123);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121178;
    }
    
    int64_t zm_lhs_121179 = add64(n_64122, block_sizze_64124);
    int64_t zs_lhs_121180 = sub64(zm_lhs_121179, (int64_t) 1);
    int64_t m_121184 = sdiv64(zs_lhs_121180, block_sizze_64124);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_64122; nest_i_133515++) {
        ((float *) mem_133186.mem)[nest_i_133515] = 0.0F;
    }
    
    bool loop_cond_121186 = slt64((int64_t) 0, m_121184);
    bool partitioned_gather_res_121187;
    int64_t partitioned_gather_res_121190;
    bool loop_while_121191;
    int64_t p_121194;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121191 = loop_cond_121186;
    p_121194 = (int64_t) 0;
    while (loop_while_121191) {
        int64_t lower_bound_121195 = mul64(block_sizze_64124, p_121194);
        int64_t min_arg1_121196 = add64(block_sizze_64124, lower_bound_121195);
        int64_t min_res_121197 = smin64(n_64122, min_arg1_121196);
        int64_t j_m_i_121198 = sub64(min_res_121197, lower_bound_121195);
        bool empty_slice_121199 = j_m_i_121198 == (int64_t) 0;
        int64_t m_121200 = sub64(j_m_i_121198, (int64_t) 1);
        int64_t i_p_m_t_s_121201 = add64(lower_bound_121195, m_121200);
        bool zzero_leq_i_p_m_t_s_121202 = sle64((int64_t) 0, i_p_m_t_s_121201);
        bool i_p_m_t_s_leq_w_121203 = slt64(i_p_m_t_s_121201, n_64122);
        bool zzero_lte_i_121204 = sle64((int64_t) 0, lower_bound_121195);
        bool i_lte_j_121205 = sle64(lower_bound_121195, min_res_121197);
        bool y_121206 = i_p_m_t_s_leq_w_121203 && zzero_lte_i_121204;
        bool y_121207 = zzero_leq_i_p_m_t_s_121202 && y_121206;
        bool forwards_ok_121208 = i_lte_j_121205 && y_121207;
        bool ok_or_empty_121209 = empty_slice_121199 || forwards_ok_121208;
        bool index_certs_121210;
        
        if (!ok_or_empty_121209) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121195, ":", (long long) min_res_121197, "] out of bounds for array of shape [", (long long) n_64122, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:34:1-36:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_64122});
        if (memblock_alloc(ctx, &mem_133196, bytes_133185, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < n_64122; i_133046++) {
            int64_t eta_p_121213 = ((int64_t *) mem_param_133189.mem)[i_133046];
            float eta_p_121214 = ((float *) mem_param_133192.mem)[i_133046];
            bool cond_121215 = sle64(lower_bound_121195, eta_p_121213);
            bool cond_t_res_121216 = slt64(eta_p_121213, min_res_121197);
            bool x_121217 = cond_121215 && cond_t_res_121216;
            float lifted_lambda_res_121218;
            
            if (x_121217) {
                int64_t tmp_128906 = sub64(eta_p_121213, lower_bound_121195);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121198);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121198, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:157:3-49\n   #4  ftRelational.fut:34:1-36:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float tmp_128911 = ((float *) ys_mem_133176.mem)[eta_p_121213];
                
                lifted_lambda_res_121218 = tmp_128911;
            } else {
                lifted_lambda_res_121218 = eta_p_121214;
            }
            ((float *) mem_133196.mem)[i_133046] = lifted_lambda_res_121218;
        }
        
        int64_t tmp_121225 = add64((int64_t) 1, p_121194);
        bool loop_cond_121226 = slt64(tmp_121225, m_121184);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121226;
        int64_t p_tmp_133521 = tmp_121225;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121191 = loop_while_tmp_133518;
        p_121194 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121187 = loop_while_121191;
    partitioned_gather_res_121190 = p_121194;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133185, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_64122});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133875, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_133876, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_63454, int64_t incr_63455, int64_t block_sizze_63456)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_63454;
    bool zzero_121181 = block_sizze_63456 == (int64_t) 0;
    bool nonzzero_121182 = !zzero_121181;
    bool nonzzero_cert_121183;
    
    if (!nonzzero_121182) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:28:1-30:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = (int64_t) 4 * n_63454;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < n_63454; i_133042++) {
        int64_t eta_p_121177 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121178 = sub64(eta_p_121177, incr_63455);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121178;
    }
    
    int64_t zm_lhs_121179 = add64(n_63454, block_sizze_63456);
    int64_t zs_lhs_121180 = sub64(zm_lhs_121179, (int64_t) 1);
    int64_t m_121184 = sdiv64(zs_lhs_121180, block_sizze_63456);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_63454; nest_i_133515++) {
        ((int32_t *) mem_133186.mem)[nest_i_133515] = 0;
    }
    
    bool loop_cond_121186 = slt64((int64_t) 0, m_121184);
    bool partitioned_gather_res_121187;
    int64_t partitioned_gather_res_121190;
    bool loop_while_121191;
    int64_t p_121194;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121191 = loop_cond_121186;
    p_121194 = (int64_t) 0;
    while (loop_while_121191) {
        int64_t lower_bound_121195 = mul64(block_sizze_63456, p_121194);
        int64_t min_arg1_121196 = add64(block_sizze_63456, lower_bound_121195);
        int64_t min_res_121197 = smin64(n_63454, min_arg1_121196);
        int64_t j_m_i_121198 = sub64(min_res_121197, lower_bound_121195);
        bool empty_slice_121199 = j_m_i_121198 == (int64_t) 0;
        int64_t m_121200 = sub64(j_m_i_121198, (int64_t) 1);
        int64_t i_p_m_t_s_121201 = add64(lower_bound_121195, m_121200);
        bool zzero_leq_i_p_m_t_s_121202 = sle64((int64_t) 0, i_p_m_t_s_121201);
        bool i_p_m_t_s_leq_w_121203 = slt64(i_p_m_t_s_121201, n_63454);
        bool zzero_lte_i_121204 = sle64((int64_t) 0, lower_bound_121195);
        bool i_lte_j_121205 = sle64(lower_bound_121195, min_res_121197);
        bool y_121206 = i_p_m_t_s_leq_w_121203 && zzero_lte_i_121204;
        bool y_121207 = zzero_leq_i_p_m_t_s_121202 && y_121206;
        bool forwards_ok_121208 = i_lte_j_121205 && y_121207;
        bool ok_or_empty_121209 = empty_slice_121199 || forwards_ok_121208;
        bool index_certs_121210;
        
        if (!ok_or_empty_121209) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121195, ":", (long long) min_res_121197, "] out of bounds for array of shape [", (long long) n_63454, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:28:1-30:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_63454});
        if (memblock_alloc(ctx, &mem_133196, bytes_133185, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < n_63454; i_133046++) {
            int64_t eta_p_121213 = ((int64_t *) mem_param_133189.mem)[i_133046];
            int32_t eta_p_121214 = ((int32_t *) mem_param_133192.mem)[i_133046];
            bool cond_121215 = sle64(lower_bound_121195, eta_p_121213);
            bool cond_t_res_121216 = slt64(eta_p_121213, min_res_121197);
            bool x_121217 = cond_121215 && cond_t_res_121216;
            int32_t lifted_lambda_res_121218;
            
            if (x_121217) {
                int64_t tmp_128906 = sub64(eta_p_121213, lower_bound_121195);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121198);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121198, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:157:3-49\n   #4  ftRelational.fut:28:1-30:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t tmp_128911 = ((int32_t *) ys_mem_133176.mem)[eta_p_121213];
                
                lifted_lambda_res_121218 = tmp_128911;
            } else {
                lifted_lambda_res_121218 = eta_p_121214;
            }
            ((int32_t *) mem_133196.mem)[i_133046] = lifted_lambda_res_121218;
        }
        
        int64_t tmp_121225 = add64((int64_t) 1, p_121194);
        bool loop_cond_121226 = slt64(tmp_121225, m_121184);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121226;
        int64_t p_tmp_133521 = tmp_121225;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121191 = loop_while_tmp_133518;
        p_121194 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121187 = loop_while_121191;
    partitioned_gather_res_121190 = p_121194;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133185, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_63454});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133876, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_133877, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_63788, int64_t incr_63789, int64_t block_sizze_63790)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_63788;
    bool zzero_121181 = block_sizze_63790 == (int64_t) 0;
    bool nonzzero_121182 = !zzero_121181;
    bool nonzzero_cert_121183;
    
    if (!nonzzero_121182) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:31:1-33:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < n_63788; i_133042++) {
        int64_t eta_p_121177 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121178 = sub64(eta_p_121177, incr_63789);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121178;
    }
    
    int64_t zm_lhs_121179 = add64(n_63788, block_sizze_63790);
    int64_t zs_lhs_121180 = sub64(zm_lhs_121179, (int64_t) 1);
    int64_t m_121184 = sdiv64(zs_lhs_121180, block_sizze_63790);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133177, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_63788; nest_i_133515++) {
        ((int64_t *) mem_133186.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    bool loop_cond_121186 = slt64((int64_t) 0, m_121184);
    bool partitioned_gather_res_121187;
    int64_t partitioned_gather_res_121190;
    bool loop_while_121191;
    int64_t p_121194;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121191 = loop_cond_121186;
    p_121194 = (int64_t) 0;
    while (loop_while_121191) {
        int64_t lower_bound_121195 = mul64(block_sizze_63790, p_121194);
        int64_t min_arg1_121196 = add64(block_sizze_63790, lower_bound_121195);
        int64_t min_res_121197 = smin64(n_63788, min_arg1_121196);
        int64_t j_m_i_121198 = sub64(min_res_121197, lower_bound_121195);
        bool empty_slice_121199 = j_m_i_121198 == (int64_t) 0;
        int64_t m_121200 = sub64(j_m_i_121198, (int64_t) 1);
        int64_t i_p_m_t_s_121201 = add64(lower_bound_121195, m_121200);
        bool zzero_leq_i_p_m_t_s_121202 = sle64((int64_t) 0, i_p_m_t_s_121201);
        bool i_p_m_t_s_leq_w_121203 = slt64(i_p_m_t_s_121201, n_63788);
        bool zzero_lte_i_121204 = sle64((int64_t) 0, lower_bound_121195);
        bool i_lte_j_121205 = sle64(lower_bound_121195, min_res_121197);
        bool y_121206 = i_p_m_t_s_leq_w_121203 && zzero_lte_i_121204;
        bool y_121207 = zzero_leq_i_p_m_t_s_121202 && y_121206;
        bool forwards_ok_121208 = i_lte_j_121205 && y_121207;
        bool ok_or_empty_121209 = empty_slice_121199 || forwards_ok_121208;
        bool index_certs_121210;
        
        if (!ok_or_empty_121209) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121195, ":", (long long) min_res_121197, "] out of bounds for array of shape [", (long long) n_63788, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:31:1-33:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_63788});
        if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < n_63788; i_133046++) {
            int64_t eta_p_121213 = ((int64_t *) mem_param_133189.mem)[i_133046];
            int64_t eta_p_121214 = ((int64_t *) mem_param_133192.mem)[i_133046];
            bool cond_121215 = sle64(lower_bound_121195, eta_p_121213);
            bool cond_t_res_121216 = slt64(eta_p_121213, min_res_121197);
            bool x_121217 = cond_121215 && cond_t_res_121216;
            int64_t lifted_lambda_res_121218;
            
            if (x_121217) {
                int64_t tmp_128906 = sub64(eta_p_121213, lower_bound_121195);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121198);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121198, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:157:3-49\n   #4  ftRelational.fut:31:1-33:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_128911 = ((int64_t *) ys_mem_133176.mem)[eta_p_121213];
                
                lifted_lambda_res_121218 = tmp_128911;
            } else {
                lifted_lambda_res_121218 = eta_p_121214;
            }
            ((int64_t *) mem_133196.mem)[i_133046] = lifted_lambda_res_121218;
        }
        
        int64_t tmp_121225 = add64((int64_t) 1, p_121194);
        bool loop_cond_121226 = slt64(tmp_121225, m_121184);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121226;
        int64_t p_tmp_133521 = tmp_121225;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121191 = loop_while_tmp_133518;
        p_121194 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121187 = loop_while_121191;
    partitioned_gather_res_121190 = p_121194;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133177, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_63788});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133877, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_133878, struct memblock is_mem_133175, struct memblock ys_mem_133176, int64_t n_63120, int64_t incr_63121, int64_t block_sizze_63122)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_133194;
    
    mem_133194.references = NULL;
    
    struct memblock mem_param_133192;
    
    mem_param_133192.references = NULL;
    
    struct memblock mem_param_133189;
    
    mem_param_133189.references = NULL;
    
    struct memblock ext_mem_133207;
    
    ext_mem_133207.references = NULL;
    
    struct memblock ext_mem_133208;
    
    ext_mem_133208.references = NULL;
    
    struct memblock mem_133186;
    
    mem_133186.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t bytes_133177 = (int64_t) 8 * n_63120;
    bool zzero_121181 = block_sizze_63122 == (int64_t) 0;
    bool nonzzero_121182 = !zzero_121181;
    bool nonzzero_cert_121183;
    
    if (!nonzzero_121182) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:25:1-27:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133185 = (int64_t) 2 * n_63120;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133042 = 0; i_133042 < n_63120; i_133042++) {
        int64_t eta_p_121177 = ((int64_t *) is_mem_133175.mem)[i_133042];
        int64_t lifted_lambda_res_121178 = sub64(eta_p_121177, incr_63121);
        
        ((int64_t *) mem_133178.mem)[i_133042] = lifted_lambda_res_121178;
    }
    
    int64_t zm_lhs_121179 = add64(n_63120, block_sizze_63122);
    int64_t zs_lhs_121180 = sub64(zm_lhs_121179, (int64_t) 1);
    int64_t m_121184 = sdiv64(zs_lhs_121180, block_sizze_63122);
    
    if (memblock_alloc(ctx, &mem_133186, bytes_133185, "mem_133186")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_63120; nest_i_133515++) {
        ((int16_t *) mem_133186.mem)[nest_i_133515] = (int16_t) 0;
    }
    
    bool loop_cond_121186 = slt64((int64_t) 0, m_121184);
    bool partitioned_gather_res_121187;
    int64_t partitioned_gather_res_121190;
    bool loop_while_121191;
    int64_t p_121194;
    
    if (memblock_set(ctx, &mem_param_133189, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133192, &mem_133186, "mem_133186") != 0)
        return 1;
    loop_while_121191 = loop_cond_121186;
    p_121194 = (int64_t) 0;
    while (loop_while_121191) {
        int64_t lower_bound_121195 = mul64(block_sizze_63122, p_121194);
        int64_t min_arg1_121196 = add64(block_sizze_63122, lower_bound_121195);
        int64_t min_res_121197 = smin64(n_63120, min_arg1_121196);
        int64_t j_m_i_121198 = sub64(min_res_121197, lower_bound_121195);
        bool empty_slice_121199 = j_m_i_121198 == (int64_t) 0;
        int64_t m_121200 = sub64(j_m_i_121198, (int64_t) 1);
        int64_t i_p_m_t_s_121201 = add64(lower_bound_121195, m_121200);
        bool zzero_leq_i_p_m_t_s_121202 = sle64((int64_t) 0, i_p_m_t_s_121201);
        bool i_p_m_t_s_leq_w_121203 = slt64(i_p_m_t_s_121201, n_63120);
        bool zzero_lte_i_121204 = sle64((int64_t) 0, lower_bound_121195);
        bool i_lte_j_121205 = sle64(lower_bound_121195, min_res_121197);
        bool y_121206 = i_p_m_t_s_leq_w_121203 && zzero_lte_i_121204;
        bool y_121207 = zzero_leq_i_p_m_t_s_121202 && y_121206;
        bool forwards_ok_121208 = i_lte_j_121205 && y_121207;
        bool ok_or_empty_121209 = empty_slice_121199 || forwards_ok_121208;
        bool index_certs_121210;
        
        if (!ok_or_empty_121209) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_121195, ":", (long long) min_res_121197, "] out of bounds for array of shape [", (long long) n_63120, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:157:3-49\n   #2  ftRelational.fut:25:1-27:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_133194, bytes_133177, "mem_133194")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133194.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133189.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_63120});
        if (memblock_alloc(ctx, &mem_133196, bytes_133185, "mem_133196")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_133046 = 0; i_133046 < n_63120; i_133046++) {
            int64_t eta_p_121213 = ((int64_t *) mem_param_133189.mem)[i_133046];
            int16_t eta_p_121214 = ((int16_t *) mem_param_133192.mem)[i_133046];
            bool cond_121215 = sle64(lower_bound_121195, eta_p_121213);
            bool cond_t_res_121216 = slt64(eta_p_121213, min_res_121197);
            bool x_121217 = cond_121215 && cond_t_res_121216;
            int16_t lifted_lambda_res_121218;
            
            if (x_121217) {
                int64_t tmp_128906 = sub64(eta_p_121213, lower_bound_121195);
                bool x_128907 = sle64((int64_t) 0, tmp_128906);
                bool y_128908 = slt64(tmp_128906, j_m_i_121198);
                bool bounds_check_128909 = x_128907 && y_128908;
                bool index_certs_128910;
                
                if (!bounds_check_128909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_128906, "] out of bounds for array of shape [", (long long) j_m_i_121198, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:157:3-49\n   #4  ftRelational.fut:25:1-27:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t tmp_128911 = ((int16_t *) ys_mem_133176.mem)[eta_p_121213];
                
                lifted_lambda_res_121218 = tmp_128911;
            } else {
                lifted_lambda_res_121218 = eta_p_121214;
            }
            ((int16_t *) mem_133196.mem)[i_133046] = lifted_lambda_res_121218;
        }
        
        int64_t tmp_121225 = add64((int64_t) 1, p_121194);
        bool loop_cond_121226 = slt64(tmp_121225, m_121184);
        
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133196, "mem_133196") != 0)
            return 1;
        
        bool loop_while_tmp_133518 = loop_cond_121226;
        int64_t p_tmp_133521 = tmp_121225;
        
        if (memblock_set(ctx, &mem_param_133189, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133192, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        loop_while_121191 = loop_while_tmp_133518;
        p_121194 = p_tmp_133521;
    }
    if (memblock_set(ctx, &ext_mem_133208, &mem_param_133189, "mem_param_133189") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133207, &mem_param_133192, "mem_param_133192") != 0)
        return 1;
    partitioned_gather_res_121187 = loop_while_121191;
    partitioned_gather_res_121190 = p_121194;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133210, bytes_133185, "mem_133210")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_63120});
    if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133210, "mem_133210") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133878, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133194, "mem_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133192, "mem_param_133192") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133189, "mem_param_133189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133207, "ext_mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133208, "ext_mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133186, "mem_133186") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_133879, struct memblock *mem_out_p_133880, struct memblock xs_mem_133175, struct memblock pL_mem_133176, int64_t n_113463, int64_t b_113464, int64_t pL_b_113465, int16_t block_sizze_113466, int64_t gather_psizze_113467, int32_t radix_sizze_113468, int64_t sizze_thresh_113471, int32_t max_depth_113472, int32_t bit_step_113473)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133222_cached_sizze_133881 = 0;
    unsigned char *mem_133222 = NULL;
    int64_t mem_133256_cached_sizze_133882 = 0;
    unsigned char *mem_133256 = NULL;
    int64_t mem_133258_cached_sizze_133883 = 0;
    unsigned char *mem_133258 = NULL;
    int64_t mem_133267_cached_sizze_133884 = 0;
    unsigned char *mem_133267 = NULL;
    int64_t mem_133268_cached_sizze_133885 = 0;
    unsigned char *mem_133268 = NULL;
    int64_t mem_133299_cached_sizze_133886 = 0;
    unsigned char *mem_133299 = NULL;
    int64_t mem_133301_cached_sizze_133887 = 0;
    unsigned char *mem_133301 = NULL;
    int64_t mem_133303_cached_sizze_133888 = 0;
    unsigned char *mem_133303 = NULL;
    int64_t mem_133305_cached_sizze_133889 = 0;
    unsigned char *mem_133305 = NULL;
    int64_t mem_133331_cached_sizze_133890 = 0;
    unsigned char *mem_133331 = NULL;
    int64_t mem_133333_cached_sizze_133891 = 0;
    unsigned char *mem_133333 = NULL;
    int64_t mem_133351_cached_sizze_133892 = 0;
    unsigned char *mem_133351 = NULL;
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_param_tmp_133518;
    
    mem_param_tmp_133518.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_param_tmp_133530;
    
    mem_param_tmp_133530.references = NULL;
    
    struct memblock mem_param_tmp_133529;
    
    mem_param_tmp_133529.references = NULL;
    
    struct memblock mem_param_tmp_133528;
    
    mem_param_tmp_133528.references = NULL;
    
    struct memblock mem_133367;
    
    mem_133367.references = NULL;
    
    struct memblock mem_133369;
    
    mem_133369.references = NULL;
    
    struct memblock mem_133349;
    
    mem_133349.references = NULL;
    
    struct memblock mem_133347;
    
    mem_133347.references = NULL;
    
    struct memblock ext_mem_133296;
    
    ext_mem_133296.references = NULL;
    
    struct memblock ext_mem_133297;
    
    ext_mem_133297.references = NULL;
    
    struct memblock mem_133294;
    
    mem_133294.references = NULL;
    
    struct memblock mem_param_tmp_133539;
    
    mem_param_tmp_133539.references = NULL;
    
    struct memblock mem_param_tmp_133538;
    
    mem_param_tmp_133538.references = NULL;
    
    struct memblock mem_133246;
    
    mem_133246.references = NULL;
    
    struct memblock mem_133244;
    
    mem_133244.references = NULL;
    
    struct memblock mem_param_tmp_133546;
    
    mem_param_tmp_133546.references = NULL;
    
    struct memblock mem_133233;
    
    mem_133233.references = NULL;
    
    struct memblock mem_param_133231;
    
    mem_param_133231.references = NULL;
    
    struct memblock ext_mem_133242;
    
    ext_mem_133242.references = NULL;
    
    struct memblock mem_param_133217;
    
    mem_param_133217.references = NULL;
    
    struct memblock mem_param_133213;
    
    mem_param_133213.references = NULL;
    
    struct memblock ext_mem_133291;
    
    ext_mem_133291.references = NULL;
    
    struct memblock ext_mem_133292;
    
    ext_mem_133292.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_param_133207;
    
    mem_param_133207.references = NULL;
    
    struct memblock mem_param_133203;
    
    mem_param_133203.references = NULL;
    
    struct memblock mem_param_133199;
    
    mem_param_133199.references = NULL;
    
    struct memblock mem_param_133196;
    
    mem_param_133196.references = NULL;
    
    struct memblock ext_mem_133380;
    
    ext_mem_133380.references = NULL;
    
    struct memblock ext_mem_133381;
    
    ext_mem_133381.references = NULL;
    
    struct memblock ext_mem_133382;
    
    ext_mem_133382.references = NULL;
    
    struct memblock ext_mem_133383;
    
    ext_mem_133383.references = NULL;
    
    struct memblock mem_param_133193;
    
    mem_param_133193.references = NULL;
    
    struct memblock mem_param_133190;
    
    mem_param_133190.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133183;
    
    mem_param_133183.references = NULL;
    
    struct memblock ext_mem_133394;
    
    ext_mem_133394.references = NULL;
    
    struct memblock ext_mem_133395;
    
    ext_mem_133395.references = NULL;
    
    struct memblock ext_mem_133396;
    
    ext_mem_133396.references = NULL;
    
    struct memblock ext_mem_133397;
    
    ext_mem_133397.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    if (memblock_alloc(ctx, &mem_133177, (int64_t) 8, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < (int64_t) 1; nest_i_133515++) {
        ((int64_t *) mem_133177.mem)[nest_i_133515] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_133178, (int64_t) 8, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133516 = 0; nest_i_133516 < (int64_t) 1; nest_i_133516++) {
        ((int64_t *) mem_133178.mem)[nest_i_133516] = n_113463;
    }
    
    bool loop_cond_t_res_122626 = slt32(0, max_depth_113472);
    
    if (memblock_alloc(ctx, &mem_133179, (int64_t) 0, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_122677 = sext_i64_i32(b_113464);
    int32_t zm_lhs_122678 = mul32(8, i64_res_122677);
    int32_t min_arg1_122679 = sub32(zm_lhs_122678, 1);
    int32_t s_sign_122686 = (bit_step_113473 > 0 ? 1 : 0) - (bit_step_113473 < 0 ? 1 : 0);
    int64_t s_sign_122687 = sext_i32_i64(s_sign_122686);
    bool downwards_122690 = s_sign_122686 == -1;
    bool x_122694 = !downwards_122690;
    int64_t subtracted_step_122703 = sext_i32_i64(bit_step_113473);
    int64_t pos_step_122704 = mul64(s_sign_122687, subtracted_step_122703);
    bool zzero_122710 = gather_psizze_113467 == (int64_t) 0;
    bool nonzzero_122711 = !zzero_122710;
    int64_t bytes_133346 = n_113463 * b_113464;
    int64_t bytes_133348 = n_113463 * pL_b_113465;
    
    if (mem_133267_cached_sizze_133884 < b_113464) {
        err = lexical_realloc(ctx, &mem_133267, &mem_133267_cached_sizze_133884, b_113464);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133268_cached_sizze_133885 < pL_b_113465) {
        err = lexical_realloc(ctx, &mem_133268, &mem_133268_cached_sizze_133885, pL_b_113465);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_122628;
    bool partition_and_deepen_res_122629;
    int32_t partition_and_deepen_res_122630;
    int64_t loop_dz2087U_122635;
    bool loop_while_122636;
    int32_t p_122637;
    
    if (memblock_set(ctx, &mem_param_133183, &pL_mem_133176, "pL_mem_133176") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133190, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133193, &mem_133178, "mem_133178") != 0)
        return 1;
    loop_dz2087U_122635 = (int64_t) 1;
    loop_while_122636 = loop_cond_t_res_122626;
    p_122637 = 0;
    while (loop_while_122636) {
        bool loop_nonempty_127611 = slt64((int64_t) 0, loop_dz2087U_122635);
        int32_t newDepth_122673 = add32(1, p_122637);
        int32_t new_i_122674 = mul32(radix_sizze_113468, p_122637);
        int32_t zm_lhs_122675 = mul32(radix_sizze_113468, newDepth_122673);
        int32_t new_j_122676 = sub32(zm_lhs_122675, 1);
        int32_t min_res_122680 = smin32(new_j_122676, min_arg1_122679);
        int32_t tmp_122681 = add32(bit_step_113473, new_i_122674);
        int64_t i_122682 = sext_i32_i64(new_i_122674);
        int64_t j__122683 = sext_i32_i64(min_res_122680);
        int64_t tmp_122684 = sext_i32_i64(tmp_122681);
        bool step_zzero_122685 = new_i_122674 == tmp_122681;
        bool bounds_invalid_downwards_122688 = slt32(new_i_122674, min_res_122680);
        bool bounds_invalid_upwards_122689 = slt32(min_res_122680, new_i_122674);
        int32_t distance_downwards_exclusive_122691 = sub32(new_i_122674, min_res_122680);
        int32_t distance_upwards_exclusive_122692 = sub32(min_res_122680, new_i_122674);
        bool x_122693 = bounds_invalid_downwards_122688 && downwards_122690;
        bool y_122695 = bounds_invalid_upwards_122689 && x_122694;
        bool bounds_invalid_122696 = x_122693 || y_122695;
        int32_t distance_exclusive_122697;
        
        if (downwards_122690) {
            distance_exclusive_122697 = distance_downwards_exclusive_122691;
        } else {
            distance_exclusive_122697 = distance_upwards_exclusive_122692;
        }
        
        int64_t distance_exclusive_122698 = sext_i32_i64(distance_exclusive_122697);
        int64_t distance_122699 = add64((int64_t) 1, distance_exclusive_122698);
        bool range_invalid_122700 = step_zzero_122685 || bounds_invalid_122696;
        bool valid_122701 = !range_invalid_122700;
        bool loop_not_taken_127612 = !loop_nonempty_127611;
        bool protect_assert_disj_127613 = valid_122701 || loop_not_taken_127612;
        bool range_valid_c_122702;
        
        if (!protect_assert_disj_127613) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_122682, "..", (long long) tmp_122684, "...", (long long) j__122683, " is invalid.", "-> #0  ftHashJoin.fut:222:15-37\n   #1  ftHashJoin.fut:265:20-271:13\n   #2  ftRelational.fut:216:5-97\n   #3  ftRelational.fut:205:1-217:30\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_122705 = sdiv_up_safe64(distance_122699, pos_step_122704);
        bool loop_nonempty_122706 = slt64((int64_t) 0, num_elems_122705);
        bool loop_not_taken_122712 = !loop_nonempty_122706;
        bool protect_assert_disj_122713 = nonzzero_122711 || loop_not_taken_122712;
        bool protect_assert_disj_127615 = protect_assert_disj_122713 || loop_not_taken_127612;
        bool nonzzero_cert_122714;
        
        if (!protect_assert_disj_127615) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftHashJoin.fut:209:87-90\n   #2  ftHashJoin.fut:223:6-71\n   #3  ftHashJoin.fut:265:20-271:13\n   #4  ftRelational.fut:216:5-97\n   #5  ftRelational.fut:205:1-217:30\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_122642;
        int64_t loop_dz2081Uz2089U_122648;
        
        if (memblock_set(ctx, &mem_param_133196, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133199, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133203, &mem_param_133183, "mem_param_133183") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133207, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        loop_dz2081Uz2089U_122648 = (int64_t) 0;
        for (int64_t i_122647 = 0; i_122647 < loop_dz2087U_122635; i_122647++) {
            int64_t bounds_122653 = ((int64_t *) mem_param_133190.mem)[i_122647];
            int64_t bounds_122654 = ((int64_t *) mem_param_133193.mem)[i_122647];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655 = sub64(bounds_122654, bounds_122653);
            bool empty_slice_122656 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655 == (int64_t) 0;
            int64_t m_122657 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, (int64_t) 1);
            int64_t i_p_m_t_s_122658 = add64(bounds_122653, m_122657);
            bool zzero_leq_i_p_m_t_s_122659 = sle64((int64_t) 0, i_p_m_t_s_122658);
            bool i_p_m_t_s_leq_w_122660 = slt64(i_p_m_t_s_122658, n_113463);
            bool zzero_lte_i_122661 = sle64((int64_t) 0, bounds_122653);
            bool i_lte_j_122662 = sle64(bounds_122653, bounds_122654);
            bool y_122663 = i_p_m_t_s_leq_w_122660 && zzero_lte_i_122661;
            bool y_122664 = zzero_leq_i_p_m_t_s_122659 && y_122663;
            bool forwards_ok_122665 = i_lte_j_122662 && y_122664;
            bool ok_or_empty_122666 = empty_slice_122656 || forwards_ok_122665;
            bool index_certs_122667;
            
            if (!ok_or_empty_122666) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_122653, ":", (long long) bounds_122654, "] out of bounds for array of shape [", (long long) n_113463, "].", "-> #0  ftHashJoin.fut:299:21-47\n   #1  ftRelational.fut:216:5-97\n   #2  ftRelational.fut:205:1-217:30\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133208 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655;
            
            if (memblock_alloc(ctx, &mem_133209, bytes_133208, "mem_133209")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_133537 = 0; nest_i_133537 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655; nest_i_133537++) {
                ((int64_t *) mem_133209.mem)[nest_i_133537] = (int64_t) 0;
            }
            
            int64_t zm_lhs_122708 = add64(gather_psizze_113467, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655);
            int64_t zs_lhs_122709 = sub64(zm_lhs_122708, (int64_t) 1);
            int64_t m_122715 = sdiv_safe64(zs_lhs_122709, gather_psizze_113467);
            bool loop_cond_122716 = slt64((int64_t) 0, m_122715);
            int64_t binop_y_133218 = b_113464 * bounds_122653;
            int64_t binop_y_133220 = pL_b_113465 * bounds_122653;
            int64_t bytes_133243 = b_113464 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655;
            int64_t bytes_133245 = pL_b_113465 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655;
            
            if (mem_133222_cached_sizze_133881 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655) {
                err = lexical_realloc(ctx, &mem_133222, &mem_133222_cached_sizze_133881, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_133290;
            int64_t ext_133287;
            int64_t ctx_param_ext_133210;
            int64_t ctx_param_ext_133214;
            
            if (memblock_set(ctx, &mem_param_133213, &mem_param_133207, "mem_param_133207") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133217, &mem_param_133203, "mem_param_133203") != 0)
                return 1;
            ctx_param_ext_133210 = binop_y_133218;
            ctx_param_ext_133214 = binop_y_133220;
            for (int64_t i_122719 = 0; i_122719 < num_elems_122705; i_122719++) {
                int32_t binop_x_122722 = sext_i64_i32(i_122719);
                int32_t binop_x_122723 = mul32(bit_step_113473, binop_x_122722);
                int32_t index_primexp_122724 = add32(new_i_122674, binop_x_122723);
                int32_t zm_lhs_122725 = add32(bit_step_113473, index_primexp_122724);
                int32_t min_arg1_122726 = sub32(zm_lhs_122725, 1);
                int32_t min_res_122727 = smin32(min_res_122680, min_arg1_122726);
                int32_t zp_lhs_122728 = sub32(min_res_122727, index_primexp_122724);
                int32_t ij_bits_122729 = add32(1, zp_lhs_122728);
                int32_t up_to_122730 = shl32(1, ij_bits_122729);
                int64_t tmp_122731 = sext_i32_i64(zp_lhs_122728);
                bool bounds_invalid_upwards_122732 = slt32(zp_lhs_122728, 0);
                bool valid_122734 = !bounds_invalid_upwards_122732;
                bool range_valid_c_122735;
                
                if (!valid_122734) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122731, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:209:87-90\n   #3  ftHashJoin.fut:223:6-71\n   #4  ftHashJoin.fut:265:20-271:13\n   #5  ftRelational.fut:216:5-97\n   #6  ftRelational.fut:205:1-217:30\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_122745 = sext_i32_i64(up_to_122730);
                bool bounds_invalid_upwards_122746 = slt32(up_to_122730, 0);
                bool valid_122747 = !bounds_invalid_upwards_122746;
                bool range_valid_c_122748;
                
                if (!valid_122747) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122745, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftHashJoin.fut:209:87-90\n   #2  ftHashJoin.fut:223:6-71\n   #3  ftHashJoin.fut:265:20-271:13\n   #4  ftRelational.fut:216:5-97\n   #5  ftRelational.fut:205:1-217:30\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_122733 = add64((int64_t) 1, tmp_122731);
                
                for (int64_t i_133042 = 0; i_133042 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655; i_133042++) {
                    int8_t defunc_0_f_res_122738;
                    int8_t y_122740 = (int8_t) 0;
                    
                    for (int64_t i_122739 = 0; i_122739 < distance_122733; i_122739++) {
                        int32_t binop_x_122741 = sext_i64_i32(i_122739);
                        int32_t get_bit_arg0_122742 = add32(index_primexp_122724, binop_x_122741);
                        int32_t zm_rhs_127856 = sdiv32(get_bit_arg0_122742, 8);
                        int32_t zm_lhs_127857 = sub32(i64_res_122677, zm_rhs_127856);
                        int32_t whichByte_127858 = sub32(zm_lhs_127857, 1);
                        int64_t whichByte_127860 = sext_i32_i64(whichByte_127858);
                        bool x_127861 = sle64((int64_t) 0, whichByte_127860);
                        bool y_127862 = slt64(whichByte_127860, b_113464);
                        bool bounds_check_127863 = x_127861 && y_127862;
                        bool index_certs_127864;
                        
                        if (!bounds_check_127863) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_127860, "] out of bounds for array of shape [", (long long) b_113464, "].", "-> #0  ftHashJoin.fut:18:6-18\n   #1  ftRelational.fut:216:5-97\n   #2  ftRelational.fut:205:1-217:30\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_127859 = smod32(get_bit_arg0_122742, 8);
                        int8_t zbzg_lhs_127865 = ((int8_t *) mem_param_133213.mem)[ctx_param_ext_133210 + (i_133042 * b_113464 + whichByte_127860)];
                        int8_t unsign_arg0_127866 = zext_i32_i8(whichBit_127859);
                        int8_t unsign_arg0_127867 = ashr8(zbzg_lhs_127865, unsign_arg0_127866);
                        int8_t unsign_arg0_127868 = (int8_t) 1 & unsign_arg0_127867;
                        int32_t to_i32_res_127869 = zext_i8_i32(unsign_arg0_127868);
                        int8_t loopres_122744;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_122744, binop_x_122741, y_122740, to_i32_res_127869) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_133545 = loopres_122744;
                        
                        y_122740 = y_tmp_133545;
                    }
                    defunc_0_f_res_122738 = y_122740;
                    ((int8_t *) mem_133222)[i_133042] = defunc_0_f_res_122738;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_122749;
                int64_t offs_122752;
                
                if (memblock_set(ctx, &mem_param_133231, &mem_133209, "mem_133209") != 0)
                    return 1;
                offs_122752 = (int64_t) 0;
                for (int64_t i_122751 = 0; i_122751 < up_to_122745; i_122751++) {
                    int32_t binop_x_122754 = sext_i64_i32(i_122751);
                    int8_t index_primexp_122755 = zext_i32_i8(binop_x_122754);
                    
                    if (memblock_alloc(ctx, &mem_133233, bytes_133208, "mem_133233")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_129319;
                    int64_t defunc_0_reduce_res_129320;
                    int64_t inpacc_129140;
                    int64_t inpacc_129141;
                    
                    inpacc_129140 = (int64_t) 0;
                    inpacc_129141 = (int64_t) 0;
                    for (int64_t i_133060 = 0; i_133060 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655; i_133060++) {
                        int8_t eta_p_133153 = ((int8_t *) mem_133222)[i_133060];
                        bool lifted_lambda_res_133154 = eta_p_133153 == index_primexp_122755;
                        int64_t bool_res_133155 = btoi_bool_i64(lifted_lambda_res_133154);
                        int64_t eta_p_133168 = ((int64_t *) mem_param_133231.mem)[i_133060];
                        int64_t defunc_0_op_res_133169 = add64(inpacc_129140, bool_res_133155);
                        int64_t zm_lhs_133170 = add64(offs_122752, defunc_0_op_res_133169);
                        int64_t lifted_lambda_res_133171 = sub64(zm_lhs_133170, (int64_t) 1);
                        int64_t defunc_0_f_res_133172 = mul64(bool_res_133155, lifted_lambda_res_133171);
                        int64_t defunc_0_f_res_133173 = add64(eta_p_133168, defunc_0_f_res_133172);
                        int64_t defunc_0_op_res_129189 = add64(inpacc_129141, bool_res_133155);
                        
                        ((int64_t *) mem_133233.mem)[i_133060] = defunc_0_f_res_133173;
                        
                        int64_t inpacc_tmp_133549 = defunc_0_op_res_133169;
                        int64_t inpacc_tmp_133550 = defunc_0_op_res_129189;
                        
                        inpacc_129140 = inpacc_tmp_133549;
                        inpacc_129141 = inpacc_tmp_133550;
                    }
                    inpacc_129319 = inpacc_129140;
                    defunc_0_reduce_res_129320 = inpacc_129141;
                    
                    int64_t tmp_122780 = add64(offs_122752, defunc_0_reduce_res_129320);
                    
                    if (memblock_set(ctx, &mem_param_tmp_133546, &mem_133233, "mem_133233") != 0)
                        return 1;
                    
                    int64_t offs_tmp_133547 = tmp_122780;
                    
                    if (memblock_set(ctx, &mem_param_133231, &mem_param_tmp_133546, "mem_param_tmp_133546") != 0)
                        return 1;
                    offs_122752 = offs_tmp_133547;
                }
                if (memblock_set(ctx, &ext_mem_133242, &mem_param_133231, "mem_param_133231") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_122749 = offs_122752;
                if (memblock_alloc(ctx, &mem_133244, bytes_133243, "mem_133244")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_133244.mem, (int64_t) 0, (int64_t []) {b_113464, (int64_t) 1}, (uint8_t *) mem_param_133213.mem, ctx_param_ext_133210, (int64_t []) {b_113464, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, b_113464});
                if (memblock_alloc(ctx, &mem_133246, bytes_133245, "mem_133246")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_133246.mem, (int64_t) 0, (int64_t []) {pL_b_113465, (int64_t) 1}, (uint8_t *) mem_param_133217.mem, ctx_param_ext_133214, (int64_t []) {pL_b_113465, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, pL_b_113465});
                
                bool partitioned_scatter_res_122787;
                int64_t partitioned_scatter_res_122790;
                bool loop_while_122791;
                int64_t p_122794;
                
                loop_while_122791 = loop_cond_122716;
                p_122794 = (int64_t) 0;
                while (loop_while_122791) {
                    int64_t lower_bound_122795 = mul64(gather_psizze_113467, p_122794);
                    int64_t min_arg1_122796 = add64(gather_psizze_113467, lower_bound_122795);
                    int64_t min_res_122797 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, min_arg1_122796);
                    int64_t j_m_i_122798 = sub64(min_res_122797, lower_bound_122795);
                    bool empty_slice_122799 = j_m_i_122798 == (int64_t) 0;
                    int64_t m_122800 = sub64(j_m_i_122798, (int64_t) 1);
                    int64_t i_p_m_t_s_122801 = add64(lower_bound_122795, m_122800);
                    bool zzero_leq_i_p_m_t_s_122802 = sle64((int64_t) 0, i_p_m_t_s_122801);
                    bool i_p_m_t_s_leq_w_122803 = slt64(i_p_m_t_s_122801, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655);
                    bool zzero_lte_i_122804 = sle64((int64_t) 0, lower_bound_122795);
                    bool i_lte_j_122805 = sle64(lower_bound_122795, min_res_122797);
                    bool y_122806 = i_p_m_t_s_leq_w_122803 && zzero_lte_i_122804;
                    bool y_122807 = zzero_leq_i_p_m_t_s_122802 && y_122806;
                    bool forwards_ok_122808 = i_lte_j_122805 && y_122807;
                    bool ok_or_empty_122809 = empty_slice_122799 || forwards_ok_122808;
                    bool index_certs_122810;
                    
                    if (!ok_or_empty_122809) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122795, ":", (long long) min_res_122797, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftHashJoin.fut:209:87-90\n   #2  ftHashJoin.fut:223:6-71\n   #3  ftHashJoin.fut:265:20-271:13\n   #4  ftRelational.fut:216:5-97\n   #5  ftRelational.fut:205:1-217:30\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_133255 = b_113464 * j_m_i_122798;
                    int64_t bytes_133257 = pL_b_113465 * j_m_i_122798;
                    
                    if (mem_133256_cached_sizze_133882 < bytes_133255) {
                        err = lexical_realloc(ctx, &mem_133256, &mem_133256_cached_sizze_133882, bytes_133255);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133256, (int64_t) 0, (int64_t []) {b_113464, (int64_t) 1}, (uint8_t *) mem_133244.mem, (int64_t) 0 + b_113464 * lower_bound_122795, (int64_t []) {b_113464, (int64_t) 1}, (int64_t []) {j_m_i_122798, b_113464});
                    if (mem_133258_cached_sizze_133883 < bytes_133257) {
                        err = lexical_realloc(ctx, &mem_133258, &mem_133258_cached_sizze_133883, bytes_133257);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133258, (int64_t) 0, (int64_t []) {pL_b_113465, (int64_t) 1}, (uint8_t *) mem_133246.mem, (int64_t) 0 + pL_b_113465 * lower_bound_122795, (int64_t []) {pL_b_113465, (int64_t) 1}, (int64_t []) {j_m_i_122798, pL_b_113465});
                    for (int64_t write_iter_133062 = 0; write_iter_133062 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655; write_iter_133062++) {
                        int64_t write_iv_133065 = ((int64_t *) ext_mem_133242.mem)[write_iter_133062];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133267, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133213.mem, ctx_param_ext_133210 + write_iter_133062 * b_113464, (int64_t []) {(int64_t) 1}, (int64_t []) {b_113464});
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133268, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133217.mem, ctx_param_ext_133214 + write_iter_133062 * pL_b_113465, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_113465});
                        
                        bool cond_129232 = sle64(lower_bound_122795, write_iv_133065);
                        bool cond_t_res_129233 = slt64(write_iv_133065, min_res_122797);
                        bool x_129234 = cond_129232 && cond_t_res_129233;
                        int64_t lifted_lambda_res_129235;
                        
                        if (x_129234) {
                            int64_t lifted_lambda_res_t_res_129322 = sub64(write_iv_133065, lower_bound_122795);
                            
                            lifted_lambda_res_129235 = lifted_lambda_res_t_res_129322;
                        } else {
                            lifted_lambda_res_129235 = (int64_t) -1;
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_129235) && slt64(lifted_lambda_res_129235, j_m_i_122798)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_113464 - (int64_t) 1, b_113464))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_133256, lifted_lambda_res_129235 * b_113464, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133267, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_113464});
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_129235) && slt64(lifted_lambda_res_129235, j_m_i_122798)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(pL_b_113465 - (int64_t) 1, pL_b_113465))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_133258, lifted_lambda_res_129235 * pL_b_113465, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133268, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_113465});
                        }
                    }
                    
                    int64_t tmp_122822 = add64((int64_t) 1, p_122794);
                    
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133244.mem, b_113464 * lower_bound_122795, (int64_t []) {b_113464, (int64_t) 1}, (uint8_t *) mem_133256, (int64_t) 0, (int64_t []) {b_113464, (int64_t) 1}, (int64_t []) {j_m_i_122798, b_113464});
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133246.mem, pL_b_113465 * lower_bound_122795, (int64_t []) {pL_b_113465, (int64_t) 1}, (uint8_t *) mem_133258, (int64_t) 0, (int64_t []) {pL_b_113465, (int64_t) 1}, (int64_t []) {j_m_i_122798, pL_b_113465});
                    
                    bool loop_cond_122830 = slt64(tmp_122822, m_122715);
                    bool loop_while_tmp_133552 = loop_cond_122830;
                    int64_t p_tmp_133555 = tmp_122822;
                    
                    loop_while_122791 = loop_while_tmp_133552;
                    p_122794 = p_tmp_133555;
                }
                partitioned_scatter_res_122787 = loop_while_122791;
                partitioned_scatter_res_122790 = p_122794;
                if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_133538, &mem_133244, "mem_133244") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_133539, &mem_133246, "mem_133246") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_133540 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_133541 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_133213, &mem_param_tmp_133538, "mem_param_tmp_133538") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_133217, &mem_param_tmp_133539, "mem_param_tmp_133539") != 0)
                    return 1;
                ctx_param_ext_133210 = ctx_param_ext_tmp_133540;
                ctx_param_ext_133214 = ctx_param_ext_tmp_133541;
            }
            if (memblock_set(ctx, &ext_mem_133292, &mem_param_133213, "mem_param_133213") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_133291, &mem_param_133217, "mem_param_133217") != 0)
                return 1;
            ext_133290 = ctx_param_ext_133210;
            ext_133287 = ctx_param_ext_133214;
            if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_133294, bytes_133243, "mem_133294")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133294.mem, (int64_t) 0, (int64_t []) {b_113464, (int64_t) 1}, (uint8_t *) ext_mem_133292.mem, ext_133290, (int64_t []) {b_113464, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, b_113464});
            
            int64_t deepen_step_res_122831;
            int64_t deepen_step_res_122832;
            int32_t deepen_step_res_122835;
            
            if (futrts_getPartitionBounds_11872(ctx, &ext_mem_133297, &ext_mem_133296, &deepen_step_res_122831, &deepen_step_res_122832, &deepen_step_res_122835, mem_133294, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, b_113464, newDepth_122673, new_i_122674, new_j_122676) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_133294, "mem_133294") != 0)
                return 1;
            
            int64_t zl_rhs_127625 = sub64(deepen_step_res_122831, (int64_t) 1);
            int64_t bytes_133298 = (int64_t) 8 * deepen_step_res_122831;
            
            if (mem_133299_cached_sizze_133886 < bytes_133298) {
                err = lexical_realloc(ctx, &mem_133299, &mem_133299_cached_sizze_133886, bytes_133298);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133301_cached_sizze_133887 < bytes_133298) {
                err = lexical_realloc(ctx, &mem_133301, &mem_133301_cached_sizze_133887, bytes_133298);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133303_cached_sizze_133888 < bytes_133298) {
                err = lexical_realloc(ctx, &mem_133303, &mem_133303_cached_sizze_133888, bytes_133298);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133305_cached_sizze_133889 < bytes_133298) {
                err = lexical_realloc(ctx, &mem_133305, &mem_133305_cached_sizze_133889, bytes_133298);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_133084;
            int64_t scanacc_133074 = (int64_t) 0;
            
            for (int64_t i_133079 = 0; i_133079 < deepen_step_res_122831; i_133079++) {
                int64_t tmp_128929 = ((int64_t *) ext_mem_133297.mem)[i_133079];
                bool cond_128930 = slt64(i_133079, zl_rhs_127625);
                int64_t tmp_128931;
                
                if (cond_128930) {
                    int64_t tmp_129326 = add64((int64_t) 1, i_133079);
                    bool x_129327 = sle64((int64_t) 0, tmp_129326);
                    bool y_129328 = slt64(tmp_129326, deepen_step_res_122831);
                    bool bounds_check_129329 = x_129327 && y_129328;
                    bool index_certs_129330;
                    
                    if (!bounds_check_129329) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129326, "] out of bounds for array of shape [", (long long) deepen_step_res_122831, "].", "-> #0  ftHashJoin.fut:275:67-81\n   #1  ftRelational.fut:216:5-97\n   #2  ftRelational.fut:205:1-217:30\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_129331 = ((int64_t *) ext_mem_133297.mem)[tmp_129326];
                    
                    tmp_128931 = tmp_t_res_129331;
                } else {
                    tmp_128931 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655;
                }
                
                int64_t zg_lhs_128940 = sub64(tmp_128931, tmp_128929);
                bool lifted_lambda_res_128941 = slt64(sizze_thresh_113471, zg_lhs_128940);
                int64_t defunc_0_f_res_128942 = btoi_bool_i64(lifted_lambda_res_128941);
                int64_t defunc_0_op_res_122852 = add64(defunc_0_f_res_128942, scanacc_133074);
                
                ((int64_t *) mem_133299)[i_133079] = defunc_0_op_res_122852;
                ((int64_t *) mem_133301)[i_133079] = defunc_0_f_res_128942;
                ((int64_t *) mem_133303)[i_133079] = tmp_128929;
                ((int64_t *) mem_133305)[i_133079] = tmp_128931;
                
                int64_t scanacc_tmp_133558 = defunc_0_op_res_122852;
                
                scanacc_133074 = scanacc_tmp_133558;
            }
            discard_133084 = scanacc_133074;
            if (memblock_unref(ctx, &ext_mem_133297, "ext_mem_133297") != 0)
                return 1;
            
            bool cond_122853 = deepen_step_res_122831 == (int64_t) 0;
            bool x_122854 = !cond_122853;
            bool x_122856 = sle64((int64_t) 0, zl_rhs_127625);
            bool y_122857 = slt64(zl_rhs_127625, deepen_step_res_122831);
            bool bounds_check_122858 = x_122856 && y_122857;
            bool protect_assert_disj_122859 = cond_122853 || bounds_check_122858;
            bool index_certs_122860;
            
            if (!protect_assert_disj_122859) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_127625, "] out of bounds for array of shape [", (long long) deepen_step_res_122831, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:276:8-49\n   #3  ftRelational.fut:216:5-97\n   #4  ftRelational.fut:205:1-217:30\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_122861;
            
            if (x_122854) {
                int64_t x_129332 = ((int64_t *) mem_133299)[zl_rhs_127625];
                
                m_f_res_122861 = x_129332;
            } else {
                m_f_res_122861 = (int64_t) 0;
            }
            
            int64_t m_122863;
            
            if (cond_122853) {
                m_122863 = (int64_t) 0;
            } else {
                m_122863 = m_f_res_122861;
            }
            
            int64_t m_122873 = sub64(m_122863, (int64_t) 1);
            bool i_p_m_t_s_leq_w_122875 = slt64(m_122873, deepen_step_res_122831);
            bool zzero_leq_i_p_m_t_s_122874 = sle64((int64_t) 0, m_122873);
            bool y_122877 = zzero_leq_i_p_m_t_s_122874 && i_p_m_t_s_leq_w_122875;
            bool i_lte_j_122876 = sle64((int64_t) 0, m_122863);
            bool forwards_ok_122878 = i_lte_j_122876 && y_122877;
            bool eq_x_zz_122870 = (int64_t) 0 == m_f_res_122861;
            bool p_and_eq_x_y_122871 = x_122854 && eq_x_zz_122870;
            bool empty_slice_122872 = cond_122853 || p_and_eq_x_y_122871;
            bool ok_or_empty_122879 = empty_slice_122872 || forwards_ok_122878;
            bool index_certs_122880;
            
            if (!ok_or_empty_122879) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122863, "] out of bounds for array of shape [", (long long) deepen_step_res_122831, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:276:8-49\n   #3  ftRelational.fut:216:5-97\n   #4  ftRelational.fut:205:1-217:30\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133330 = (int64_t) 8 * m_122863;
            int64_t conc_tmp_122902 = loop_dz2081Uz2089U_122648 + m_122863;
            int64_t bytes_133366 = (int64_t) 8 * conc_tmp_122902;
            
            if (mem_133331_cached_sizze_133890 < bytes_133330) {
                err = lexical_realloc(ctx, &mem_133331, &mem_133331_cached_sizze_133890, bytes_133330);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133331, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133305, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122863});
            if (mem_133333_cached_sizze_133891 < bytes_133330) {
                err = lexical_realloc(ctx, &mem_133333, &mem_133333_cached_sizze_133891, bytes_133330);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133333, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133303, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122863});
            for (int64_t write_iter_133085 = 0; write_iter_133085 < deepen_step_res_122831; write_iter_133085++) {
                int64_t write_iv_133088 = ((int64_t *) mem_133301)[write_iter_133085];
                int64_t write_iv_133089 = ((int64_t *) mem_133299)[write_iter_133085];
                int64_t write_iv_133090 = ((int64_t *) mem_133303)[write_iter_133085];
                int64_t write_iv_133091 = ((int64_t *) mem_133305)[write_iter_133085];
                bool cond_128911 = write_iv_133088 == (int64_t) 1;
                int64_t lifted_lambda_res_128912;
                
                if (cond_128911) {
                    int64_t lifted_lambda_res_t_res_129333 = sub64(write_iv_133089, (int64_t) 1);
                    
                    lifted_lambda_res_128912 = lifted_lambda_res_t_res_129333;
                } else {
                    lifted_lambda_res_128912 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_128912) && slt64(lifted_lambda_res_128912, m_122863)) {
                    ((int64_t *) mem_133333)[lifted_lambda_res_128912] = write_iv_133090;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_128912) && slt64(lifted_lambda_res_128912, m_122863)) {
                    ((int64_t *) mem_133331)[lifted_lambda_res_128912] = write_iv_133091;
                }
            }
            if (memblock_alloc(ctx, &mem_133347, bytes_133346, "mem_133347")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133347.mem, (int64_t) 0, (int64_t []) {b_113464, (int64_t) 1}, (uint8_t *) mem_param_133207.mem, (int64_t) 0, (int64_t []) {b_113464, (int64_t) 1}, (int64_t []) {n_113463, b_113464});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133347.mem, b_113464 * bounds_122653, (int64_t []) {b_113464, (int64_t) 1}, (uint8_t *) ext_mem_133292.mem, ext_133290, (int64_t []) {b_113464, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, b_113464});
            if (memblock_unref(ctx, &ext_mem_133292, "ext_mem_133292") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_133349, bytes_133348, "mem_133349")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133349.mem, (int64_t) 0, (int64_t []) {pL_b_113465, (int64_t) 1}, (uint8_t *) mem_param_133203.mem, (int64_t) 0, (int64_t []) {pL_b_113465, (int64_t) 1}, (int64_t []) {n_113463, pL_b_113465});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133349.mem, pL_b_113465 * bounds_122653, (int64_t []) {pL_b_113465, (int64_t) 1}, (uint8_t *) ext_mem_133291.mem, ext_133287, (int64_t []) {pL_b_113465, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122655, pL_b_113465});
            if (memblock_unref(ctx, &ext_mem_133291, "ext_mem_133291") != 0)
                return 1;
            if (mem_133351_cached_sizze_133892 < bytes_133330) {
                err = lexical_realloc(ctx, &mem_133351, &mem_133351_cached_sizze_133892, bytes_133330);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_133369, bytes_133366, "mem_133369")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_133098 = 0; i_133098 < m_122863; i_133098++) {
                int64_t eta_p_122898 = ((int64_t *) mem_133333)[i_133098];
                int64_t eta_p_122899 = ((int64_t *) mem_133331)[i_133098];
                int64_t tmp_122900 = add64(bounds_122653, eta_p_122898);
                int64_t tmp_122901 = add64(bounds_122653, eta_p_122899);
                
                ((int64_t *) mem_133351)[i_133098] = tmp_122900;
                ((int64_t *) mem_133369.mem)[loop_dz2081Uz2089U_122648 + i_133098] = tmp_122901;
            }
            if (memblock_alloc(ctx, &mem_133367, bytes_133366, "mem_133367")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_133567 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133367.mem, tmp_offs_133567, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_122648});
            tmp_offs_133567 += loop_dz2081Uz2089U_122648;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133367.mem, tmp_offs_133567, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133351, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122863});
            tmp_offs_133567 += m_122863;
            
            int64_t tmp_offs_133568 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133369.mem, tmp_offs_133568, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_122648});
            tmp_offs_133568 += loop_dz2081Uz2089U_122648;
            if (!(tmp_offs_133568 == loop_dz2081Uz2089U_122648)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133369.mem, tmp_offs_133568, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133369.mem, loop_dz2081Uz2089U_122648, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122863});
            }
            tmp_offs_133568 += m_122863;
            if (memblock_set(ctx, &mem_param_tmp_133528, &mem_133367, "mem_133367") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133529, &mem_133369, "mem_133369") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133530, &mem_133349, "mem_133349") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133347, "mem_133347") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_133532 = conc_tmp_122902;
            
            if (memblock_set(ctx, &mem_param_133196, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133199, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133203, &mem_param_tmp_133530, "mem_param_tmp_133530") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133207, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            loop_dz2081Uz2089U_122648 = loop_dz2081Uz2089U_tmp_133532;
        }
        if (memblock_set(ctx, &ext_mem_133383, &mem_param_133196, "mem_param_133196") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133382, &mem_param_133199, "mem_param_133199") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133381, &mem_param_133203, "mem_param_133203") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133380, &mem_param_133207, "mem_param_133207") != 0)
            return 1;
        loopres_122642 = loop_dz2081Uz2089U_122648;
        
        bool cond_122906 = slt64((int64_t) 0, loopres_122642);
        bool loop_cond_t_res_122907 = slt32(newDepth_122673, max_depth_113472);
        bool x_122908 = cond_122906 && loop_cond_t_res_122907;
        
        if (memblock_set(ctx, &mem_param_tmp_133517, &ext_mem_133381, "ext_mem_133381") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133518, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133519, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &ext_mem_133382, "ext_mem_133382") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_133521 = loopres_122642;
        bool loop_while_tmp_133522 = x_122908;
        int32_t p_tmp_133523 = newDepth_122673;
        
        if (memblock_set(ctx, &mem_param_133183, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133518, "mem_param_tmp_133518") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133190, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133193, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        loop_dz2087U_122635 = loop_dz2087U_tmp_133521;
        loop_while_122636 = loop_while_tmp_133522;
        p_122637 = p_tmp_133523;
    }
    if (memblock_set(ctx, &ext_mem_133397, &mem_param_133183, "mem_param_133183") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133396, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133395, &mem_param_133190, "mem_param_133190") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133394, &mem_param_133193, "mem_param_133193") != 0)
        return 1;
    partition_and_deepen_res_122628 = loop_dz2087U_122635;
    partition_and_deepen_res_122629 = loop_while_122636;
    partition_and_deepen_res_122630 = p_122637;
    if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &ext_mem_133396, "ext_mem_133396") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &ext_mem_133397, "ext_mem_133397") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133879, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133880, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133222);
        free(mem_133256);
        free(mem_133258);
        free(mem_133267);
        free(mem_133268);
        free(mem_133299);
        free(mem_133301);
        free(mem_133303);
        free(mem_133305);
        free(mem_133331);
        free(mem_133333);
        free(mem_133351);
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133518, "mem_param_tmp_133518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133530, "mem_param_tmp_133530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133529, "mem_param_tmp_133529") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133528, "mem_param_tmp_133528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133367, "mem_133367") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133369, "mem_133369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133349, "mem_133349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133347, "mem_133347") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133296, "ext_mem_133296") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133297, "ext_mem_133297") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133294, "mem_133294") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133539, "mem_param_tmp_133539") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133538, "mem_param_tmp_133538") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133246, "mem_133246") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133244, "mem_133244") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133546, "mem_param_tmp_133546") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133233, "mem_133233") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133231, "mem_param_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133217, "mem_param_133217") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133213, "mem_param_133213") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133291, "ext_mem_133291") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133292, "ext_mem_133292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133207, "mem_param_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133203, "mem_param_133203") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133199, "mem_param_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133196, "mem_param_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133380, "ext_mem_133380") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133381, "ext_mem_133381") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133382, "ext_mem_133382") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133383, "ext_mem_133383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133193, "mem_param_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133190, "mem_param_133190") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133183, "mem_param_133183") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133394, "ext_mem_133394") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133395, "ext_mem_133395") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133396, "ext_mem_133396") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133397, "ext_mem_133397") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_133893, struct memblock *mem_out_p_133894, struct memblock xs_mem_133175, int64_t n_114834, int64_t b_114835, int16_t block_sizze_114836, int64_t gather_psizze_114837, int32_t radix_sizze_114838, int64_t offset_114840, int64_t sizze_thresh_114841, int32_t max_depth_114842, int32_t bit_step_114843)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133220_cached_sizze_133895 = 0;
    unsigned char *mem_133220 = NULL;
    int64_t mem_133253_cached_sizze_133896 = 0;
    unsigned char *mem_133253 = NULL;
    int64_t mem_133255_cached_sizze_133897 = 0;
    unsigned char *mem_133255 = NULL;
    int64_t mem_133263_cached_sizze_133898 = 0;
    unsigned char *mem_133263 = NULL;
    int64_t mem_133291_cached_sizze_133899 = 0;
    unsigned char *mem_133291 = NULL;
    int64_t mem_133293_cached_sizze_133900 = 0;
    unsigned char *mem_133293 = NULL;
    int64_t mem_133295_cached_sizze_133901 = 0;
    unsigned char *mem_133295 = NULL;
    int64_t mem_133297_cached_sizze_133902 = 0;
    unsigned char *mem_133297 = NULL;
    int64_t mem_133323_cached_sizze_133903 = 0;
    unsigned char *mem_133323 = NULL;
    int64_t mem_133325_cached_sizze_133904 = 0;
    unsigned char *mem_133325 = NULL;
    int64_t mem_133343_cached_sizze_133905 = 0;
    unsigned char *mem_133343 = NULL;
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_param_tmp_133521;
    
    mem_param_tmp_133521.references = NULL;
    
    struct memblock mem_param_tmp_133520;
    
    mem_param_tmp_133520.references = NULL;
    
    struct memblock mem_param_tmp_133519;
    
    mem_param_tmp_133519.references = NULL;
    
    struct memblock mem_param_tmp_133533;
    
    mem_param_tmp_133533.references = NULL;
    
    struct memblock mem_param_tmp_133532;
    
    mem_param_tmp_133532.references = NULL;
    
    struct memblock mem_param_tmp_133531;
    
    mem_param_tmp_133531.references = NULL;
    
    struct memblock mem_param_tmp_133530;
    
    mem_param_tmp_133530.references = NULL;
    
    struct memblock mem_133359;
    
    mem_133359.references = NULL;
    
    struct memblock mem_133361;
    
    mem_133361.references = NULL;
    
    struct memblock mem_133341;
    
    mem_133341.references = NULL;
    
    struct memblock mem_133339;
    
    mem_133339.references = NULL;
    
    struct memblock ext_mem_133288;
    
    ext_mem_133288.references = NULL;
    
    struct memblock ext_mem_133289;
    
    ext_mem_133289.references = NULL;
    
    struct memblock mem_133286;
    
    mem_133286.references = NULL;
    
    struct memblock mem_param_tmp_133541;
    
    mem_param_tmp_133541.references = NULL;
    
    struct memblock mem_param_tmp_133540;
    
    mem_param_tmp_133540.references = NULL;
    
    struct memblock mem_133244;
    
    mem_133244.references = NULL;
    
    struct memblock mem_133242;
    
    mem_133242.references = NULL;
    
    struct memblock mem_param_tmp_133548;
    
    mem_param_tmp_133548.references = NULL;
    
    struct memblock mem_133231;
    
    mem_133231.references = NULL;
    
    struct memblock mem_param_133229;
    
    mem_param_133229.references = NULL;
    
    struct memblock ext_mem_133240;
    
    ext_mem_133240.references = NULL;
    
    struct memblock mem_param_133215;
    
    mem_param_133215.references = NULL;
    
    struct memblock mem_param_133212;
    
    mem_param_133212.references = NULL;
    
    struct memblock ext_mem_133283;
    
    ext_mem_133283.references = NULL;
    
    struct memblock ext_mem_133284;
    
    ext_mem_133284.references = NULL;
    
    struct memblock mem_133208;
    
    mem_133208.references = NULL;
    
    struct memblock mem_param_133206;
    
    mem_param_133206.references = NULL;
    
    struct memblock mem_param_133202;
    
    mem_param_133202.references = NULL;
    
    struct memblock mem_param_133199;
    
    mem_param_133199.references = NULL;
    
    struct memblock mem_param_133196;
    
    mem_param_133196.references = NULL;
    
    struct memblock ext_mem_133371;
    
    ext_mem_133371.references = NULL;
    
    struct memblock ext_mem_133372;
    
    ext_mem_133372.references = NULL;
    
    struct memblock ext_mem_133373;
    
    ext_mem_133373.references = NULL;
    
    struct memblock ext_mem_133374;
    
    ext_mem_133374.references = NULL;
    
    struct memblock mem_param_133193;
    
    mem_param_133193.references = NULL;
    
    struct memblock mem_param_133190;
    
    mem_param_133190.references = NULL;
    
    struct memblock mem_param_133187;
    
    mem_param_133187.references = NULL;
    
    struct memblock mem_param_133183;
    
    mem_param_133183.references = NULL;
    
    struct memblock ext_mem_133384;
    
    ext_mem_133384.references = NULL;
    
    struct memblock ext_mem_133385;
    
    ext_mem_133385.references = NULL;
    
    struct memblock ext_mem_133386;
    
    ext_mem_133386.references = NULL;
    
    struct memblock ext_mem_133387;
    
    ext_mem_133387.references = NULL;
    
    struct memblock mem_133180;
    
    mem_133180.references = NULL;
    
    struct memblock mem_133179;
    
    mem_133179.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t is_122623 = add64(n_114834, offset_114840);
    bool bounds_invalid_upwards_122624 = slt64(is_122623, offset_114840);
    bool valid_122625 = !bounds_invalid_upwards_122624;
    bool range_valid_c_122626;
    
    if (!valid_122625) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) offset_114840, "..<", (long long) is_122623, " is invalid.", "-> #0  ftRelational.fut:229:13-32\n   #1  ftRelational.fut:219:1-232:31\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133176 = (int64_t) 8 * n_114834;
    
    if (memblock_alloc(ctx, &mem_133177, bytes_133176, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133515 = 0; i_133515 < n_114834; i_133515++) {
        int64_t x_133516 = offset_114840 + i_133515 * (int64_t) 1;
        
        ((int64_t *) mem_133177.mem)[i_133515] = x_133516;
    }
    if (memblock_alloc(ctx, &mem_133178, (int64_t) 8, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133517 = 0; nest_i_133517 < (int64_t) 1; nest_i_133517++) {
        ((int64_t *) mem_133178.mem)[nest_i_133517] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_133179, (int64_t) 8, "mem_133179")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133518 = 0; nest_i_133518 < (int64_t) 1; nest_i_133518++) {
        ((int64_t *) mem_133179.mem)[nest_i_133518] = n_114834;
    }
    
    bool loop_cond_t_res_122630 = slt32(0, max_depth_114842);
    
    if (memblock_alloc(ctx, &mem_133180, (int64_t) 0, "mem_133180")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_122681 = sext_i64_i32(b_114835);
    int32_t zm_lhs_122682 = mul32(8, i64_res_122681);
    int32_t min_arg1_122683 = sub32(zm_lhs_122682, 1);
    int32_t s_sign_122690 = (bit_step_114843 > 0 ? 1 : 0) - (bit_step_114843 < 0 ? 1 : 0);
    int64_t s_sign_122691 = sext_i32_i64(s_sign_122690);
    bool downwards_122694 = s_sign_122690 == -1;
    bool x_122698 = !downwards_122694;
    int64_t subtracted_step_122707 = sext_i32_i64(bit_step_114843);
    int64_t pos_step_122708 = mul64(s_sign_122691, subtracted_step_122707);
    bool zzero_122714 = gather_psizze_114837 == (int64_t) 0;
    bool nonzzero_122715 = !zzero_122714;
    int64_t bytes_133338 = n_114834 * b_114835;
    
    if (mem_133263_cached_sizze_133898 < b_114835) {
        err = lexical_realloc(ctx, &mem_133263, &mem_133263_cached_sizze_133898, b_114835);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_122632;
    bool partition_and_deepen_res_122633;
    int32_t partition_and_deepen_res_122634;
    int64_t loop_dz2087U_122639;
    bool loop_while_122640;
    int32_t p_122641;
    
    if (memblock_set(ctx, &mem_param_133183, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133187, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133190, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133193, &mem_133179, "mem_133179") != 0)
        return 1;
    loop_dz2087U_122639 = (int64_t) 1;
    loop_while_122640 = loop_cond_t_res_122630;
    p_122641 = 0;
    while (loop_while_122640) {
        bool loop_nonempty_127611 = slt64((int64_t) 0, loop_dz2087U_122639);
        int32_t newDepth_122677 = add32(1, p_122641);
        int32_t new_i_122678 = mul32(radix_sizze_114838, p_122641);
        int32_t zm_lhs_122679 = mul32(radix_sizze_114838, newDepth_122677);
        int32_t new_j_122680 = sub32(zm_lhs_122679, 1);
        int32_t min_res_122684 = smin32(new_j_122680, min_arg1_122683);
        int32_t tmp_122685 = add32(bit_step_114843, new_i_122678);
        int64_t i_122686 = sext_i32_i64(new_i_122678);
        int64_t j__122687 = sext_i32_i64(min_res_122684);
        int64_t tmp_122688 = sext_i32_i64(tmp_122685);
        bool step_zzero_122689 = new_i_122678 == tmp_122685;
        bool bounds_invalid_downwards_122692 = slt32(new_i_122678, min_res_122684);
        bool bounds_invalid_upwards_122693 = slt32(min_res_122684, new_i_122678);
        int32_t distance_downwards_exclusive_122695 = sub32(new_i_122678, min_res_122684);
        int32_t distance_upwards_exclusive_122696 = sub32(min_res_122684, new_i_122678);
        bool x_122697 = bounds_invalid_downwards_122692 && downwards_122694;
        bool y_122699 = bounds_invalid_upwards_122693 && x_122698;
        bool bounds_invalid_122700 = x_122697 || y_122699;
        int32_t distance_exclusive_122701;
        
        if (downwards_122694) {
            distance_exclusive_122701 = distance_downwards_exclusive_122695;
        } else {
            distance_exclusive_122701 = distance_upwards_exclusive_122696;
        }
        
        int64_t distance_exclusive_122702 = sext_i32_i64(distance_exclusive_122701);
        int64_t distance_122703 = add64((int64_t) 1, distance_exclusive_122702);
        bool range_invalid_122704 = step_zzero_122689 || bounds_invalid_122700;
        bool valid_122705 = !range_invalid_122704;
        bool loop_not_taken_127612 = !loop_nonempty_127611;
        bool protect_assert_disj_127613 = valid_122705 || loop_not_taken_127612;
        bool range_valid_c_122706;
        
        if (!protect_assert_disj_127613) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_122686, "..", (long long) tmp_122688, "...", (long long) j__122687, " is invalid.", "-> #0  ftHashJoin.fut:222:15-37\n   #1  ftHashJoin.fut:265:20-271:13\n   #2  ftRelational.fut:231:5-97\n   #3  ftRelational.fut:219:1-232:31\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_122709 = sdiv_up_safe64(distance_122703, pos_step_122708);
        bool loop_nonempty_122710 = slt64((int64_t) 0, num_elems_122709);
        bool loop_not_taken_122716 = !loop_nonempty_122710;
        bool protect_assert_disj_122717 = nonzzero_122715 || loop_not_taken_122716;
        bool protect_assert_disj_127615 = protect_assert_disj_122717 || loop_not_taken_127612;
        bool nonzzero_cert_122718;
        
        if (!protect_assert_disj_127615) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftHashJoin.fut:209:87-90\n   #2  ftHashJoin.fut:223:6-71\n   #3  ftHashJoin.fut:265:20-271:13\n   #4  ftRelational.fut:231:5-97\n   #5  ftRelational.fut:219:1-232:31\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_122646;
        int64_t loop_dz2081Uz2089U_122652;
        
        if (memblock_set(ctx, &mem_param_133196, &mem_133180, "mem_133180") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133199, &mem_133180, "mem_133180") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133202, &mem_param_133183, "mem_param_133183") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133206, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        loop_dz2081Uz2089U_122652 = (int64_t) 0;
        for (int64_t i_122651 = 0; i_122651 < loop_dz2087U_122639; i_122651++) {
            int64_t bounds_122657 = ((int64_t *) mem_param_133190.mem)[i_122651];
            int64_t bounds_122658 = ((int64_t *) mem_param_133193.mem)[i_122651];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659 = sub64(bounds_122658, bounds_122657);
            bool empty_slice_122660 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659 == (int64_t) 0;
            int64_t m_122661 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, (int64_t) 1);
            int64_t i_p_m_t_s_122662 = add64(bounds_122657, m_122661);
            bool zzero_leq_i_p_m_t_s_122663 = sle64((int64_t) 0, i_p_m_t_s_122662);
            bool i_p_m_t_s_leq_w_122664 = slt64(i_p_m_t_s_122662, n_114834);
            bool zzero_lte_i_122665 = sle64((int64_t) 0, bounds_122657);
            bool i_lte_j_122666 = sle64(bounds_122657, bounds_122658);
            bool y_122667 = i_p_m_t_s_leq_w_122664 && zzero_lte_i_122665;
            bool y_122668 = zzero_leq_i_p_m_t_s_122663 && y_122667;
            bool forwards_ok_122669 = i_lte_j_122666 && y_122668;
            bool ok_or_empty_122670 = empty_slice_122660 || forwards_ok_122669;
            bool index_certs_122671;
            
            if (!ok_or_empty_122670) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_122657, ":", (long long) bounds_122658, "] out of bounds for array of shape [", (long long) n_114834, "].", "-> #0  ftHashJoin.fut:299:21-47\n   #1  ftRelational.fut:231:5-97\n   #2  ftRelational.fut:219:1-232:31\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133207 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659;
            
            if (memblock_alloc(ctx, &mem_133208, bytes_133207, "mem_133208")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_133539 = 0; nest_i_133539 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659; nest_i_133539++) {
                ((int64_t *) mem_133208.mem)[nest_i_133539] = (int64_t) 0;
            }
            
            int64_t zm_lhs_122712 = add64(gather_psizze_114837, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659);
            int64_t zs_lhs_122713 = sub64(zm_lhs_122712, (int64_t) 1);
            int64_t m_122719 = sdiv_safe64(zs_lhs_122713, gather_psizze_114837);
            bool loop_cond_122720 = slt64((int64_t) 0, m_122719);
            int64_t binop_y_133216 = b_114835 * bounds_122657;
            int64_t bytes_133241 = b_114835 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659;
            
            if (mem_133220_cached_sizze_133895 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659) {
                err = lexical_realloc(ctx, &mem_133220, &mem_133220_cached_sizze_133895, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_133282;
            int64_t ext_133279;
            int64_t ctx_param_ext_133209;
            int64_t ctx_param_ext_133213;
            
            if (memblock_set(ctx, &mem_param_133212, &mem_param_133206, "mem_param_133206") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133215, &mem_param_133202, "mem_param_133202") != 0)
                return 1;
            ctx_param_ext_133209 = binop_y_133216;
            ctx_param_ext_133213 = bounds_122657;
            for (int64_t i_122723 = 0; i_122723 < num_elems_122709; i_122723++) {
                int32_t binop_x_122726 = sext_i64_i32(i_122723);
                int32_t binop_x_122727 = mul32(bit_step_114843, binop_x_122726);
                int32_t index_primexp_122728 = add32(new_i_122678, binop_x_122727);
                int32_t zm_lhs_122729 = add32(bit_step_114843, index_primexp_122728);
                int32_t min_arg1_122730 = sub32(zm_lhs_122729, 1);
                int32_t min_res_122731 = smin32(min_res_122684, min_arg1_122730);
                int32_t zp_lhs_122732 = sub32(min_res_122731, index_primexp_122728);
                int32_t ij_bits_122733 = add32(1, zp_lhs_122732);
                int32_t up_to_122734 = shl32(1, ij_bits_122733);
                int64_t tmp_122735 = sext_i32_i64(zp_lhs_122732);
                bool bounds_invalid_upwards_122736 = slt32(zp_lhs_122732, 0);
                bool valid_122738 = !bounds_invalid_upwards_122736;
                bool range_valid_c_122739;
                
                if (!valid_122738) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122735, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:209:87-90\n   #3  ftHashJoin.fut:223:6-71\n   #4  ftHashJoin.fut:265:20-271:13\n   #5  ftRelational.fut:231:5-97\n   #6  ftRelational.fut:219:1-232:31\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_122749 = sext_i32_i64(up_to_122734);
                bool bounds_invalid_upwards_122750 = slt32(up_to_122734, 0);
                bool valid_122751 = !bounds_invalid_upwards_122750;
                bool range_valid_c_122752;
                
                if (!valid_122751) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122749, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftHashJoin.fut:209:87-90\n   #2  ftHashJoin.fut:223:6-71\n   #3  ftHashJoin.fut:265:20-271:13\n   #4  ftRelational.fut:231:5-97\n   #5  ftRelational.fut:219:1-232:31\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_122737 = add64((int64_t) 1, tmp_122735);
                
                for (int64_t i_133042 = 0; i_133042 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659; i_133042++) {
                    int8_t defunc_0_f_res_122742;
                    int8_t y_122744 = (int8_t) 0;
                    
                    for (int64_t i_122743 = 0; i_122743 < distance_122737; i_122743++) {
                        int32_t binop_x_122745 = sext_i64_i32(i_122743);
                        int32_t get_bit_arg0_122746 = add32(index_primexp_122728, binop_x_122745);
                        int32_t zm_rhs_127856 = sdiv32(get_bit_arg0_122746, 8);
                        int32_t zm_lhs_127857 = sub32(i64_res_122681, zm_rhs_127856);
                        int32_t whichByte_127858 = sub32(zm_lhs_127857, 1);
                        int64_t whichByte_127860 = sext_i32_i64(whichByte_127858);
                        bool x_127861 = sle64((int64_t) 0, whichByte_127860);
                        bool y_127862 = slt64(whichByte_127860, b_114835);
                        bool bounds_check_127863 = x_127861 && y_127862;
                        bool index_certs_127864;
                        
                        if (!bounds_check_127863) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_127860, "] out of bounds for array of shape [", (long long) b_114835, "].", "-> #0  ftHashJoin.fut:18:6-18\n   #1  ftRelational.fut:231:5-97\n   #2  ftRelational.fut:219:1-232:31\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_127859 = smod32(get_bit_arg0_122746, 8);
                        int8_t zbzg_lhs_127865 = ((int8_t *) mem_param_133212.mem)[ctx_param_ext_133209 + (i_133042 * b_114835 + whichByte_127860)];
                        int8_t unsign_arg0_127866 = zext_i32_i8(whichBit_127859);
                        int8_t unsign_arg0_127867 = ashr8(zbzg_lhs_127865, unsign_arg0_127866);
                        int8_t unsign_arg0_127868 = (int8_t) 1 & unsign_arg0_127867;
                        int32_t to_i32_res_127869 = zext_i8_i32(unsign_arg0_127868);
                        int8_t loopres_122748;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_122748, binop_x_122745, y_122744, to_i32_res_127869) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_133547 = loopres_122748;
                        
                        y_122744 = y_tmp_133547;
                    }
                    defunc_0_f_res_122742 = y_122744;
                    ((int8_t *) mem_133220)[i_133042] = defunc_0_f_res_122742;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_122753;
                int64_t offs_122756;
                
                if (memblock_set(ctx, &mem_param_133229, &mem_133208, "mem_133208") != 0)
                    return 1;
                offs_122756 = (int64_t) 0;
                for (int64_t i_122755 = 0; i_122755 < up_to_122749; i_122755++) {
                    int32_t binop_x_122758 = sext_i64_i32(i_122755);
                    int8_t index_primexp_122759 = zext_i32_i8(binop_x_122758);
                    
                    if (memblock_alloc(ctx, &mem_133231, bytes_133207, "mem_133231")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_129319;
                    int64_t defunc_0_reduce_res_129320;
                    int64_t inpacc_129140;
                    int64_t inpacc_129141;
                    
                    inpacc_129140 = (int64_t) 0;
                    inpacc_129141 = (int64_t) 0;
                    for (int64_t i_133060 = 0; i_133060 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659; i_133060++) {
                        int8_t eta_p_133153 = ((int8_t *) mem_133220)[i_133060];
                        bool lifted_lambda_res_133154 = eta_p_133153 == index_primexp_122759;
                        int64_t bool_res_133155 = btoi_bool_i64(lifted_lambda_res_133154);
                        int64_t eta_p_133168 = ((int64_t *) mem_param_133229.mem)[i_133060];
                        int64_t defunc_0_op_res_133169 = add64(inpacc_129140, bool_res_133155);
                        int64_t zm_lhs_133170 = add64(offs_122756, defunc_0_op_res_133169);
                        int64_t lifted_lambda_res_133171 = sub64(zm_lhs_133170, (int64_t) 1);
                        int64_t defunc_0_f_res_133172 = mul64(bool_res_133155, lifted_lambda_res_133171);
                        int64_t defunc_0_f_res_133173 = add64(eta_p_133168, defunc_0_f_res_133172);
                        int64_t defunc_0_op_res_129189 = add64(inpacc_129141, bool_res_133155);
                        
                        ((int64_t *) mem_133231.mem)[i_133060] = defunc_0_f_res_133173;
                        
                        int64_t inpacc_tmp_133551 = defunc_0_op_res_133169;
                        int64_t inpacc_tmp_133552 = defunc_0_op_res_129189;
                        
                        inpacc_129140 = inpacc_tmp_133551;
                        inpacc_129141 = inpacc_tmp_133552;
                    }
                    inpacc_129319 = inpacc_129140;
                    defunc_0_reduce_res_129320 = inpacc_129141;
                    
                    int64_t tmp_122784 = add64(offs_122756, defunc_0_reduce_res_129320);
                    
                    if (memblock_set(ctx, &mem_param_tmp_133548, &mem_133231, "mem_133231") != 0)
                        return 1;
                    
                    int64_t offs_tmp_133549 = tmp_122784;
                    
                    if (memblock_set(ctx, &mem_param_133229, &mem_param_tmp_133548, "mem_param_tmp_133548") != 0)
                        return 1;
                    offs_122756 = offs_tmp_133549;
                }
                if (memblock_set(ctx, &ext_mem_133240, &mem_param_133229, "mem_param_133229") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_122753 = offs_122756;
                if (memblock_alloc(ctx, &mem_133242, bytes_133241, "mem_133242")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_133242.mem, (int64_t) 0, (int64_t []) {b_114835, (int64_t) 1}, (uint8_t *) mem_param_133212.mem, ctx_param_ext_133209, (int64_t []) {b_114835, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, b_114835});
                if (memblock_alloc(ctx, &mem_133244, bytes_133207, "mem_133244")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133244.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133215.mem, ctx_param_ext_133213, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659});
                
                bool partitioned_scatter_res_122791;
                int64_t partitioned_scatter_res_122794;
                bool loop_while_122795;
                int64_t p_122798;
                
                loop_while_122795 = loop_cond_122720;
                p_122798 = (int64_t) 0;
                while (loop_while_122795) {
                    int64_t lower_bound_122799 = mul64(gather_psizze_114837, p_122798);
                    int64_t min_arg1_122800 = add64(gather_psizze_114837, lower_bound_122799);
                    int64_t min_res_122801 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, min_arg1_122800);
                    int64_t j_m_i_122802 = sub64(min_res_122801, lower_bound_122799);
                    bool empty_slice_122803 = j_m_i_122802 == (int64_t) 0;
                    int64_t m_122804 = sub64(j_m_i_122802, (int64_t) 1);
                    int64_t i_p_m_t_s_122805 = add64(lower_bound_122799, m_122804);
                    bool zzero_leq_i_p_m_t_s_122806 = sle64((int64_t) 0, i_p_m_t_s_122805);
                    bool i_p_m_t_s_leq_w_122807 = slt64(i_p_m_t_s_122805, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659);
                    bool zzero_lte_i_122808 = sle64((int64_t) 0, lower_bound_122799);
                    bool i_lte_j_122809 = sle64(lower_bound_122799, min_res_122801);
                    bool y_122810 = i_p_m_t_s_leq_w_122807 && zzero_lte_i_122808;
                    bool y_122811 = zzero_leq_i_p_m_t_s_122806 && y_122810;
                    bool forwards_ok_122812 = i_lte_j_122809 && y_122811;
                    bool ok_or_empty_122813 = empty_slice_122803 || forwards_ok_122812;
                    bool index_certs_122814;
                    
                    if (!ok_or_empty_122813) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122799, ":", (long long) min_res_122801, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftHashJoin.fut:209:87-90\n   #2  ftHashJoin.fut:223:6-71\n   #3  ftHashJoin.fut:265:20-271:13\n   #4  ftRelational.fut:231:5-97\n   #5  ftRelational.fut:219:1-232:31\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_133252 = b_114835 * j_m_i_122802;
                    int64_t bytes_133254 = (int64_t) 8 * j_m_i_122802;
                    
                    if (mem_133253_cached_sizze_133896 < bytes_133252) {
                        err = lexical_realloc(ctx, &mem_133253, &mem_133253_cached_sizze_133896, bytes_133252);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133253, (int64_t) 0, (int64_t []) {b_114835, (int64_t) 1}, (uint8_t *) mem_133242.mem, (int64_t) 0 + b_114835 * lower_bound_122799, (int64_t []) {b_114835, (int64_t) 1}, (int64_t []) {j_m_i_122802, b_114835});
                    if (mem_133255_cached_sizze_133897 < bytes_133254) {
                        err = lexical_realloc(ctx, &mem_133255, &mem_133255_cached_sizze_133897, bytes_133254);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133244.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122799, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122802});
                    for (int64_t write_iter_133062 = 0; write_iter_133062 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659; write_iter_133062++) {
                        int64_t write_iv_133065 = ((int64_t *) ext_mem_133240.mem)[write_iter_133062];
                        int64_t write_iv_133067 = ((int64_t *) mem_param_133215.mem)[ctx_param_ext_133213 + write_iter_133062];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_133263, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133212.mem, ctx_param_ext_133209 + write_iter_133062 * b_114835, (int64_t []) {(int64_t) 1}, (int64_t []) {b_114835});
                        
                        bool cond_129232 = sle64(lower_bound_122799, write_iv_133065);
                        bool cond_t_res_129233 = slt64(write_iv_133065, min_res_122801);
                        bool x_129234 = cond_129232 && cond_t_res_129233;
                        int64_t lifted_lambda_res_129235;
                        
                        if (x_129234) {
                            int64_t lifted_lambda_res_t_res_129322 = sub64(write_iv_133065, lower_bound_122799);
                            
                            lifted_lambda_res_129235 = lifted_lambda_res_t_res_129322;
                        } else {
                            lifted_lambda_res_129235 = (int64_t) -1;
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_129235) && slt64(lifted_lambda_res_129235, j_m_i_122802)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_114835 - (int64_t) 1, b_114835))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_133253, lifted_lambda_res_129235 * b_114835, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133263, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_114835});
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_129235) && slt64(lifted_lambda_res_129235, j_m_i_122802)) {
                            ((int64_t *) mem_133255)[lifted_lambda_res_129235] = write_iv_133067;
                        }
                    }
                    
                    int64_t tmp_122826 = add64((int64_t) 1, p_122798);
                    
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133242.mem, b_114835 * lower_bound_122799, (int64_t []) {b_114835, (int64_t) 1}, (uint8_t *) mem_133253, (int64_t) 0, (int64_t []) {b_114835, (int64_t) 1}, (int64_t []) {j_m_i_122802, b_114835});
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133244.mem, lower_bound_122799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133255, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122802});
                    
                    bool loop_cond_122834 = slt64(tmp_122826, m_122719);
                    bool loop_while_tmp_133554 = loop_cond_122834;
                    int64_t p_tmp_133557 = tmp_122826;
                    
                    loop_while_122795 = loop_while_tmp_133554;
                    p_122798 = p_tmp_133557;
                }
                partitioned_scatter_res_122791 = loop_while_122795;
                partitioned_scatter_res_122794 = p_122798;
                if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_133540, &mem_133242, "mem_133242") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_133541, &mem_133244, "mem_133244") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_133542 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_133543 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_133212, &mem_param_tmp_133540, "mem_param_tmp_133540") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_133215, &mem_param_tmp_133541, "mem_param_tmp_133541") != 0)
                    return 1;
                ctx_param_ext_133209 = ctx_param_ext_tmp_133542;
                ctx_param_ext_133213 = ctx_param_ext_tmp_133543;
            }
            if (memblock_set(ctx, &ext_mem_133284, &mem_param_133212, "mem_param_133212") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_133283, &mem_param_133215, "mem_param_133215") != 0)
                return 1;
            ext_133282 = ctx_param_ext_133209;
            ext_133279 = ctx_param_ext_133213;
            if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_133286, bytes_133241, "mem_133286")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133286.mem, (int64_t) 0, (int64_t []) {b_114835, (int64_t) 1}, (uint8_t *) ext_mem_133284.mem, ext_133282, (int64_t []) {b_114835, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, b_114835});
            
            int64_t deepen_step_res_122835;
            int64_t deepen_step_res_122836;
            int32_t deepen_step_res_122839;
            
            if (futrts_getPartitionBounds_11872(ctx, &ext_mem_133289, &ext_mem_133288, &deepen_step_res_122835, &deepen_step_res_122836, &deepen_step_res_122839, mem_133286, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, b_114835, newDepth_122677, new_i_122678, new_j_122680) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_133286, "mem_133286") != 0)
                return 1;
            
            int64_t zl_rhs_127625 = sub64(deepen_step_res_122835, (int64_t) 1);
            int64_t bytes_133290 = (int64_t) 8 * deepen_step_res_122835;
            
            if (mem_133291_cached_sizze_133899 < bytes_133290) {
                err = lexical_realloc(ctx, &mem_133291, &mem_133291_cached_sizze_133899, bytes_133290);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133293_cached_sizze_133900 < bytes_133290) {
                err = lexical_realloc(ctx, &mem_133293, &mem_133293_cached_sizze_133900, bytes_133290);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133295_cached_sizze_133901 < bytes_133290) {
                err = lexical_realloc(ctx, &mem_133295, &mem_133295_cached_sizze_133901, bytes_133290);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_133297_cached_sizze_133902 < bytes_133290) {
                err = lexical_realloc(ctx, &mem_133297, &mem_133297_cached_sizze_133902, bytes_133290);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_133084;
            int64_t scanacc_133074 = (int64_t) 0;
            
            for (int64_t i_133079 = 0; i_133079 < deepen_step_res_122835; i_133079++) {
                int64_t tmp_128929 = ((int64_t *) ext_mem_133289.mem)[i_133079];
                bool cond_128930 = slt64(i_133079, zl_rhs_127625);
                int64_t tmp_128931;
                
                if (cond_128930) {
                    int64_t tmp_129326 = add64((int64_t) 1, i_133079);
                    bool x_129327 = sle64((int64_t) 0, tmp_129326);
                    bool y_129328 = slt64(tmp_129326, deepen_step_res_122835);
                    bool bounds_check_129329 = x_129327 && y_129328;
                    bool index_certs_129330;
                    
                    if (!bounds_check_129329) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_129326, "] out of bounds for array of shape [", (long long) deepen_step_res_122835, "].", "-> #0  ftHashJoin.fut:275:67-81\n   #1  ftRelational.fut:231:5-97\n   #2  ftRelational.fut:219:1-232:31\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_129331 = ((int64_t *) ext_mem_133289.mem)[tmp_129326];
                    
                    tmp_128931 = tmp_t_res_129331;
                } else {
                    tmp_128931 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659;
                }
                
                int64_t zg_lhs_128940 = sub64(tmp_128931, tmp_128929);
                bool lifted_lambda_res_128941 = slt64(sizze_thresh_114841, zg_lhs_128940);
                int64_t defunc_0_f_res_128942 = btoi_bool_i64(lifted_lambda_res_128941);
                int64_t defunc_0_op_res_122856 = add64(defunc_0_f_res_128942, scanacc_133074);
                
                ((int64_t *) mem_133291)[i_133079] = defunc_0_op_res_122856;
                ((int64_t *) mem_133293)[i_133079] = defunc_0_f_res_128942;
                ((int64_t *) mem_133295)[i_133079] = tmp_128929;
                ((int64_t *) mem_133297)[i_133079] = tmp_128931;
                
                int64_t scanacc_tmp_133560 = defunc_0_op_res_122856;
                
                scanacc_133074 = scanacc_tmp_133560;
            }
            discard_133084 = scanacc_133074;
            if (memblock_unref(ctx, &ext_mem_133289, "ext_mem_133289") != 0)
                return 1;
            
            bool cond_122857 = deepen_step_res_122835 == (int64_t) 0;
            bool x_122858 = !cond_122857;
            bool x_122860 = sle64((int64_t) 0, zl_rhs_127625);
            bool y_122861 = slt64(zl_rhs_127625, deepen_step_res_122835);
            bool bounds_check_122862 = x_122860 && y_122861;
            bool protect_assert_disj_122863 = cond_122857 || bounds_check_122862;
            bool index_certs_122864;
            
            if (!protect_assert_disj_122863) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_127625, "] out of bounds for array of shape [", (long long) deepen_step_res_122835, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:276:8-49\n   #3  ftRelational.fut:231:5-97\n   #4  ftRelational.fut:219:1-232:31\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_122865;
            
            if (x_122858) {
                int64_t x_129332 = ((int64_t *) mem_133291)[zl_rhs_127625];
                
                m_f_res_122865 = x_129332;
            } else {
                m_f_res_122865 = (int64_t) 0;
            }
            
            int64_t m_122867;
            
            if (cond_122857) {
                m_122867 = (int64_t) 0;
            } else {
                m_122867 = m_f_res_122865;
            }
            
            int64_t m_122877 = sub64(m_122867, (int64_t) 1);
            bool i_p_m_t_s_leq_w_122879 = slt64(m_122877, deepen_step_res_122835);
            bool zzero_leq_i_p_m_t_s_122878 = sle64((int64_t) 0, m_122877);
            bool y_122881 = zzero_leq_i_p_m_t_s_122878 && i_p_m_t_s_leq_w_122879;
            bool i_lte_j_122880 = sle64((int64_t) 0, m_122867);
            bool forwards_ok_122882 = i_lte_j_122880 && y_122881;
            bool eq_x_zz_122874 = (int64_t) 0 == m_f_res_122865;
            bool p_and_eq_x_y_122875 = x_122858 && eq_x_zz_122874;
            bool empty_slice_122876 = cond_122857 || p_and_eq_x_y_122875;
            bool ok_or_empty_122883 = empty_slice_122876 || forwards_ok_122882;
            bool index_certs_122884;
            
            if (!ok_or_empty_122883) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122867, "] out of bounds for array of shape [", (long long) deepen_step_res_122835, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:276:8-49\n   #3  ftRelational.fut:231:5-97\n   #4  ftRelational.fut:219:1-232:31\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133322 = (int64_t) 8 * m_122867;
            int64_t conc_tmp_122906 = loop_dz2081Uz2089U_122652 + m_122867;
            int64_t bytes_133358 = (int64_t) 8 * conc_tmp_122906;
            
            if (mem_133323_cached_sizze_133903 < bytes_133322) {
                err = lexical_realloc(ctx, &mem_133323, &mem_133323_cached_sizze_133903, bytes_133322);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133323, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133297, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122867});
            if (mem_133325_cached_sizze_133904 < bytes_133322) {
                err = lexical_realloc(ctx, &mem_133325, &mem_133325_cached_sizze_133904, bytes_133322);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133325, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122867});
            for (int64_t write_iter_133085 = 0; write_iter_133085 < deepen_step_res_122835; write_iter_133085++) {
                int64_t write_iv_133088 = ((int64_t *) mem_133293)[write_iter_133085];
                int64_t write_iv_133089 = ((int64_t *) mem_133291)[write_iter_133085];
                int64_t write_iv_133090 = ((int64_t *) mem_133295)[write_iter_133085];
                int64_t write_iv_133091 = ((int64_t *) mem_133297)[write_iter_133085];
                bool cond_128911 = write_iv_133088 == (int64_t) 1;
                int64_t lifted_lambda_res_128912;
                
                if (cond_128911) {
                    int64_t lifted_lambda_res_t_res_129333 = sub64(write_iv_133089, (int64_t) 1);
                    
                    lifted_lambda_res_128912 = lifted_lambda_res_t_res_129333;
                } else {
                    lifted_lambda_res_128912 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_128912) && slt64(lifted_lambda_res_128912, m_122867)) {
                    ((int64_t *) mem_133325)[lifted_lambda_res_128912] = write_iv_133090;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_128912) && slt64(lifted_lambda_res_128912, m_122867)) {
                    ((int64_t *) mem_133323)[lifted_lambda_res_128912] = write_iv_133091;
                }
            }
            if (memblock_alloc(ctx, &mem_133339, bytes_133338, "mem_133339")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133339.mem, (int64_t) 0, (int64_t []) {b_114835, (int64_t) 1}, (uint8_t *) mem_param_133206.mem, (int64_t) 0, (int64_t []) {b_114835, (int64_t) 1}, (int64_t []) {n_114834, b_114835});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133339.mem, b_114835 * bounds_122657, (int64_t []) {b_114835, (int64_t) 1}, (uint8_t *) ext_mem_133284.mem, ext_133282, (int64_t []) {b_114835, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659, b_114835});
            if (memblock_unref(ctx, &ext_mem_133284, "ext_mem_133284") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_133341, bytes_133176, "mem_133341")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133202.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_114834});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133341.mem, bounds_122657, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133283.mem, ext_133279, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_122659});
            if (memblock_unref(ctx, &ext_mem_133283, "ext_mem_133283") != 0)
                return 1;
            if (mem_133343_cached_sizze_133905 < bytes_133322) {
                err = lexical_realloc(ctx, &mem_133343, &mem_133343_cached_sizze_133905, bytes_133322);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_133361, bytes_133358, "mem_133361")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_133098 = 0; i_133098 < m_122867; i_133098++) {
                int64_t eta_p_122902 = ((int64_t *) mem_133325)[i_133098];
                int64_t eta_p_122903 = ((int64_t *) mem_133323)[i_133098];
                int64_t tmp_122904 = add64(bounds_122657, eta_p_122902);
                int64_t tmp_122905 = add64(bounds_122657, eta_p_122903);
                
                ((int64_t *) mem_133343)[i_133098] = tmp_122904;
                ((int64_t *) mem_133361.mem)[loop_dz2081Uz2089U_122652 + i_133098] = tmp_122905;
            }
            if (memblock_alloc(ctx, &mem_133359, bytes_133358, "mem_133359")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_133569 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133359.mem, tmp_offs_133569, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_122652});
            tmp_offs_133569 += loop_dz2081Uz2089U_122652;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133359.mem, tmp_offs_133569, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133343, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122867});
            tmp_offs_133569 += m_122867;
            
            int64_t tmp_offs_133570 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133361.mem, tmp_offs_133570, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_122652});
            tmp_offs_133570 += loop_dz2081Uz2089U_122652;
            if (!(tmp_offs_133570 == loop_dz2081Uz2089U_122652)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_133361.mem, tmp_offs_133570, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133361.mem, loop_dz2081Uz2089U_122652, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122867});
            }
            tmp_offs_133570 += m_122867;
            if (memblock_set(ctx, &mem_param_tmp_133530, &mem_133359, "mem_133359") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133531, &mem_133361, "mem_133361") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133532, &mem_133341, "mem_133341") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_133533, &mem_133339, "mem_133339") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_133534 = conc_tmp_122906;
            
            if (memblock_set(ctx, &mem_param_133196, &mem_param_tmp_133530, "mem_param_tmp_133530") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133199, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133202, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_133206, &mem_param_tmp_133533, "mem_param_tmp_133533") != 0)
                return 1;
            loop_dz2081Uz2089U_122652 = loop_dz2081Uz2089U_tmp_133534;
        }
        if (memblock_set(ctx, &ext_mem_133374, &mem_param_133196, "mem_param_133196") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133373, &mem_param_133199, "mem_param_133199") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133372, &mem_param_133202, "mem_param_133202") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_133371, &mem_param_133206, "mem_param_133206") != 0)
            return 1;
        loopres_122646 = loop_dz2081Uz2089U_122652;
        
        bool cond_122910 = slt64((int64_t) 0, loopres_122646);
        bool loop_cond_t_res_122911 = slt32(newDepth_122677, max_depth_114842);
        bool x_122912 = cond_122910 && loop_cond_t_res_122911;
        
        if (memblock_set(ctx, &mem_param_tmp_133519, &ext_mem_133372, "ext_mem_133372") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133520, &ext_mem_133371, "ext_mem_133371") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133521, &ext_mem_133374, "ext_mem_133374") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133522, &ext_mem_133373, "ext_mem_133373") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_133523 = loopres_122646;
        bool loop_while_tmp_133524 = x_122912;
        int32_t p_tmp_133525 = newDepth_122677;
        
        if (memblock_set(ctx, &mem_param_133183, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133187, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133190, &mem_param_tmp_133521, "mem_param_tmp_133521") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133193, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        loop_dz2087U_122639 = loop_dz2087U_tmp_133523;
        loop_while_122640 = loop_while_tmp_133524;
        p_122641 = p_tmp_133525;
    }
    if (memblock_set(ctx, &ext_mem_133387, &mem_param_133183, "mem_param_133183") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133386, &mem_param_133187, "mem_param_133187") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133385, &mem_param_133190, "mem_param_133190") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133384, &mem_param_133193, "mem_param_133193") != 0)
        return 1;
    partition_and_deepen_res_122632 = loop_dz2087U_122639;
    partition_and_deepen_res_122633 = loop_while_122640;
    partition_and_deepen_res_122634 = p_122641;
    if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133180, "mem_133180") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &ext_mem_133387, "ext_mem_133387") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &ext_mem_133386, "ext_mem_133386") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133893, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133894, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133220);
        free(mem_133253);
        free(mem_133255);
        free(mem_133263);
        free(mem_133291);
        free(mem_133293);
        free(mem_133295);
        free(mem_133297);
        free(mem_133323);
        free(mem_133325);
        free(mem_133343);
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133521, "mem_param_tmp_133521") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133520, "mem_param_tmp_133520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133519, "mem_param_tmp_133519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133533, "mem_param_tmp_133533") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133532, "mem_param_tmp_133532") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133531, "mem_param_tmp_133531") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133530, "mem_param_tmp_133530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133359, "mem_133359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133361, "mem_133361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133341, "mem_133341") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133339, "mem_133339") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133288, "ext_mem_133288") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133289, "ext_mem_133289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133286, "mem_133286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133541, "mem_param_tmp_133541") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133540, "mem_param_tmp_133540") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133244, "mem_133244") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133242, "mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133548, "mem_param_tmp_133548") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133231, "mem_133231") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133229, "mem_param_133229") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133240, "ext_mem_133240") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133215, "mem_param_133215") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133212, "mem_param_133212") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133283, "ext_mem_133283") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133284, "ext_mem_133284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133206, "mem_param_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133202, "mem_param_133202") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133199, "mem_param_133199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133196, "mem_param_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133371, "ext_mem_133371") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133372, "ext_mem_133372") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133373, "ext_mem_133373") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133374, "ext_mem_133374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133193, "mem_param_133193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133190, "mem_param_133190") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133187, "mem_param_133187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133183, "mem_param_133183") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133384, "ext_mem_133384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133385, "ext_mem_133385") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133386, "ext_mem_133386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133387, "ext_mem_133387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133180, "mem_133180") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133179, "mem_133179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_133906, struct memblock *mem_out_p_133907, struct memblock xs_mem_133175, int64_t n_88779, int64_t incr_88780, int16_t block_sizze_88781)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133185_cached_sizze_133908 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133217_cached_sizze_133909 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133910 = 0;
    unsigned char *mem_133219 = NULL;
    struct memblock mem_133247;
    
    mem_133247.references = NULL;
    
    struct memblock mem_133245;
    
    mem_133245.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_133207;
    
    mem_133207.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133205;
    
    ext_mem_133205.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133242;
    
    ext_mem_133242.references = NULL;
    
    struct memblock ext_mem_133243;
    
    ext_mem_133243.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_124439 = sext_i16_i64(block_sizze_88781);
    int64_t bytes_133177 = (int64_t) 8 * n_88779;
    bool zzero_124459 = i16_res_124439 == (int64_t) 0;
    bool nonzzero_124460 = !zzero_124459;
    bool nonzzero_cert_124463;
    
    if (!nonzzero_124460) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:142:98-101\n   #4  ftRelational.fut:132:75-86\n   #5  ftRelational.fut:131:9-132:87\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_11459(ctx, &ext_mem_133176, xs_mem_133175, n_88779, incr_88780) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_88779; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_124457 = add64(n_88779, i16_res_124439);
    int64_t zs_lhs_124458 = sub64(zm_lhs_124457, (int64_t) 1);
    int64_t m_124464 = sdiv_safe64(zs_lhs_124458, i16_res_124439);
    bool loop_cond_124465 = slt64((int64_t) 0, m_124464);
    
    if (mem_133185_cached_sizze_133908 < n_88779) {
        err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133908, n_88779);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133184, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    for (int64_t i_124468 = 0; i_124468 < (int64_t) 32; i_124468++) {
        int32_t binop_x_124471 = sext_i64_i32(i_124468);
        int32_t binop_x_124472 = mul32(2, binop_x_124471);
        int32_t zm_lhs_124473 = add32(2, binop_x_124472);
        int32_t min_arg1_124474 = sub32(zm_lhs_124473, 1);
        int32_t min_res_124475 = smin32(64, min_arg1_124474);
        int32_t zp_lhs_124476 = sub32(min_res_124475, binop_x_124472);
        int32_t ij_bits_124477 = add32(1, zp_lhs_124476);
        int32_t up_to_124478 = shl32(1, ij_bits_124477);
        int64_t tmp_124479 = sext_i32_i64(zp_lhs_124476);
        bool bounds_invalid_upwards_124480 = slt32(zp_lhs_124476, 0);
        bool valid_124482 = !bounds_invalid_upwards_124480;
        bool range_valid_c_124483;
        
        if (!valid_124482) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_124479, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:142:98-101\n   #5  ftRelational.fut:132:75-86\n   #6  ftRelational.fut:131:9-132:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_124507 = sext_i32_i64(up_to_124478);
        bool bounds_invalid_upwards_124508 = slt32(up_to_124478, 0);
        bool valid_124509 = !bounds_invalid_upwards_124508;
        bool range_valid_c_124510;
        
        if (!valid_124509) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_124507, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:142:98-101\n   #4  ftRelational.fut:132:75-86\n   #5  ftRelational.fut:131:9-132:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_124481 = add64((int64_t) 1, tmp_124479);
        
        for (int64_t i_133042 = 0; i_133042 < n_88779; i_133042++) {
            double eta_p_124485 = ((double *) mem_param_133184.mem)[i_133042];
            int64_t i64_arg0_124486 = futrts_to_bits64(eta_p_124485);
            int64_t unsign_arg0_124487 = ashr64(i64_arg0_124486, (int64_t) 63);
            int64_t unsign_arg0_124488 = (int64_t) 1 & unsign_arg0_124487;
            int32_t to_i32_res_124489 = zext_i64_i32(unsign_arg0_124488);
            bool cond_124490 = to_i32_res_124489 == 1;
            bool x_124491 = !cond_124490;
            int8_t defunc_0_f_res_124492;
            int8_t y_124494 = (int8_t) 0;
            
            for (int64_t i_124493 = 0; i_124493 < distance_124481; i_124493++) {
                int32_t binop_x_124495 = sext_i64_i32(i_124493);
                int32_t get_bit_arg0_124496 = add32(binop_x_124472, binop_x_124495);
                int64_t unsign_arg0_124497 = zext_i32_i64(get_bit_arg0_124496);
                int64_t unsign_arg0_124498 = ashr64(i64_arg0_124486, unsign_arg0_124497);
                int64_t unsign_arg0_124499 = (int64_t) 1 & unsign_arg0_124498;
                int32_t to_i32_res_124500 = zext_i64_i32(unsign_arg0_124499);
                bool cond_f_res_124501 = get_bit_arg0_124496 == 63;
                bool y_124502 = x_124491 && cond_f_res_124501;
                bool cond_124503 = cond_124490 || y_124502;
                int32_t defunc_0_get_bit_res_124504;
                
                if (cond_124503) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ to_i32_res_124500;
                    
                    defunc_0_get_bit_res_124504 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_124504 = to_i32_res_124500;
                }
                
                int8_t loopres_124506;
                
                if (futrts_set_bit_2464(ctx, &loopres_124506, binop_x_124495, y_124494, defunc_0_get_bit_res_124504) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_124506;
                
                y_124494 = y_tmp_133521;
            }
            defunc_0_f_res_124492 = y_124494;
            ((int8_t *) mem_133185)[i_133042] = defunc_0_f_res_124492;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_124511;
        int64_t offs_124514;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_124514 = (int64_t) 0;
        for (int64_t i_124513 = 0; i_124513 < up_to_124507; i_124513++) {
            int32_t binop_x_124516 = sext_i64_i32(i_124513);
            int8_t index_primexp_124517 = zext_i32_i8(binop_x_124516);
            
            if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_88779; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133185)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_124517;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133194.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_124514, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133196.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_124542 = add64(offs_124514, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133196, "mem_133196") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_124542;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_124514 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133205, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_124511 = offs_124514;
        if (memblock_alloc(ctx, &mem_133207, bytes_133177, "mem_133207")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_88779});
        if (memblock_alloc(ctx, &mem_133209, bytes_133177, "mem_133209")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_88779});
        
        bool partitioned_scatter_res_124549;
        int64_t partitioned_scatter_res_124552;
        bool loop_while_124553;
        int64_t p_124556;
        
        loop_while_124553 = loop_cond_124465;
        p_124556 = (int64_t) 0;
        while (loop_while_124553) {
            int64_t lower_bound_124557 = mul64(i16_res_124439, p_124556);
            int64_t min_arg1_124558 = add64(i16_res_124439, lower_bound_124557);
            int64_t min_res_124559 = smin64(n_88779, min_arg1_124558);
            int64_t j_m_i_124560 = sub64(min_res_124559, lower_bound_124557);
            bool empty_slice_124561 = j_m_i_124560 == (int64_t) 0;
            int64_t m_124562 = sub64(j_m_i_124560, (int64_t) 1);
            int64_t i_p_m_t_s_124563 = add64(lower_bound_124557, m_124562);
            bool zzero_leq_i_p_m_t_s_124564 = sle64((int64_t) 0, i_p_m_t_s_124563);
            bool i_p_m_t_s_leq_w_124565 = slt64(i_p_m_t_s_124563, n_88779);
            bool zzero_lte_i_124566 = sle64((int64_t) 0, lower_bound_124557);
            bool i_lte_j_124567 = sle64(lower_bound_124557, min_res_124559);
            bool y_124568 = i_p_m_t_s_leq_w_124565 && zzero_lte_i_124566;
            bool y_124569 = zzero_leq_i_p_m_t_s_124564 && y_124568;
            bool forwards_ok_124570 = i_lte_j_124567 && y_124569;
            bool ok_or_empty_124571 = empty_slice_124561 || forwards_ok_124570;
            bool index_certs_124572;
            
            if (!ok_or_empty_124571) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_124557, ":", (long long) min_res_124559, "] out of bounds for array of shape [", (long long) n_88779, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:142:98-101\n   #4  ftRelational.fut:132:75-86\n   #5  ftRelational.fut:131:9-132:87\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133216 = (int64_t) 8 * j_m_i_124560;
            
            if (mem_133217_cached_sizze_133909 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133909, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133207.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_124557, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124560});
            if (mem_133219_cached_sizze_133910 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133910, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133209.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_124557, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124560});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_88779; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133205.mem)[write_iter_133062];
                int64_t write_iv_133066 = ((int64_t *) mem_param_133181.mem)[write_iter_133062];
                double write_iv_133067 = ((double *) mem_param_133184.mem)[write_iter_133062];
                bool cond_129195 = sle64(lower_bound_124557, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_124559);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_124557);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124560)) {
                    ((int64_t *) mem_133217)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124560)) {
                    ((double *) mem_133219)[lifted_lambda_res_129198] = write_iv_133067;
                }
            }
            
            int64_t tmp_124584 = add64((int64_t) 1, p_124556);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, lower_bound_124557, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124560});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133209.mem, lower_bound_124557, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124560});
            
            bool loop_cond_124592 = slt64(tmp_124584, m_124464);
            bool loop_while_tmp_133528 = loop_cond_124592;
            int64_t p_tmp_133531 = tmp_124584;
            
            loop_while_124553 = loop_while_tmp_133528;
            p_124556 = p_tmp_133531;
        }
        partitioned_scatter_res_124549 = loop_while_124553;
        partitioned_scatter_res_124552 = p_124556;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133243, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133242, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133245, bytes_133177, "mem_133245")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133243.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_88779});
    if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133247, bytes_133177, "mem_133247")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133247.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133242.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_88779});
    if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133245, "mem_133245") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133247, "mem_133247") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133906, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133907, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133185);
        free(mem_133217);
        free(mem_133219);
        if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133245, "mem_133245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_133911, struct memblock *mem_out_p_133912, struct memblock xs_mem_133175, int64_t n_87890, int64_t incr_87891, int16_t block_sizze_87892)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133185_cached_sizze_133913 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133217_cached_sizze_133914 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133915 = 0;
    unsigned char *mem_133219 = NULL;
    struct memblock mem_133247;
    
    mem_133247.references = NULL;
    
    struct memblock mem_133245;
    
    mem_133245.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_133207;
    
    mem_133207.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133205;
    
    ext_mem_133205.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133242;
    
    ext_mem_133242.references = NULL;
    
    struct memblock ext_mem_133243;
    
    ext_mem_133243.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_124439 = sext_i16_i64(block_sizze_87892);
    int64_t bytes_133177 = (int64_t) 8 * n_87890;
    bool zzero_124458 = i16_res_124439 == (int64_t) 0;
    bool nonzzero_124459 = !zzero_124458;
    bool nonzzero_cert_124462;
    
    if (!nonzzero_124459) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:142:98-101\n   #4  ftRelational.fut:130:75-86\n   #5  ftRelational.fut:129:9-130:87\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133246 = (int64_t) 4 * n_87890;
    
    if (futrts_indicesWithIncrement_11438(ctx, &ext_mem_133176, xs_mem_133175, n_87890, incr_87891) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_87890; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_124456 = add64(n_87890, i16_res_124439);
    int64_t zs_lhs_124457 = sub64(zm_lhs_124456, (int64_t) 1);
    int64_t m_124463 = sdiv_safe64(zs_lhs_124457, i16_res_124439);
    bool loop_cond_124464 = slt64((int64_t) 0, m_124463);
    
    if (mem_133185_cached_sizze_133913 < n_87890) {
        err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133913, n_87890);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133184, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    for (int64_t i_124467 = 0; i_124467 < (int64_t) 16; i_124467++) {
        int32_t binop_x_124470 = sext_i64_i32(i_124467);
        int32_t binop_x_124471 = mul32(2, binop_x_124470);
        int32_t zm_lhs_124472 = add32(2, binop_x_124471);
        int32_t min_arg1_124473 = sub32(zm_lhs_124472, 1);
        int32_t min_res_124474 = smin32(32, min_arg1_124473);
        int32_t zp_lhs_124475 = sub32(min_res_124474, binop_x_124471);
        int32_t ij_bits_124476 = add32(1, zp_lhs_124475);
        int32_t up_to_124477 = shl32(1, ij_bits_124476);
        int64_t tmp_124478 = sext_i32_i64(zp_lhs_124475);
        bool bounds_invalid_upwards_124479 = slt32(zp_lhs_124475, 0);
        bool valid_124481 = !bounds_invalid_upwards_124479;
        bool range_valid_c_124482;
        
        if (!valid_124481) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_124478, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:142:98-101\n   #5  ftRelational.fut:130:75-86\n   #6  ftRelational.fut:129:9-130:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_124503 = sext_i32_i64(up_to_124477);
        bool bounds_invalid_upwards_124504 = slt32(up_to_124477, 0);
        bool valid_124505 = !bounds_invalid_upwards_124504;
        bool range_valid_c_124506;
        
        if (!valid_124505) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_124503, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:142:98-101\n   #4  ftRelational.fut:130:75-86\n   #5  ftRelational.fut:129:9-130:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_124480 = add64((int64_t) 1, tmp_124478);
        
        for (int64_t i_133042 = 0; i_133042 < n_87890; i_133042++) {
            float eta_p_124484 = ((float *) mem_param_133184.mem)[i_133042];
            int32_t i32_arg0_124485 = futrts_to_bits32(eta_p_124484);
            int32_t unsign_arg0_124486 = ashr32(i32_arg0_124485, 31);
            int32_t unsign_arg0_124487 = 1 & unsign_arg0_124486;
            bool cond_124488 = unsign_arg0_124487 == 1;
            bool x_124489 = !cond_124488;
            int8_t defunc_0_f_res_124490;
            int8_t y_124492 = (int8_t) 0;
            
            for (int64_t i_124491 = 0; i_124491 < distance_124480; i_124491++) {
                int32_t binop_x_124493 = sext_i64_i32(i_124491);
                int32_t get_bit_arg0_124494 = add32(binop_x_124471, binop_x_124493);
                int32_t unsign_arg0_124495 = ashr32(i32_arg0_124485, get_bit_arg0_124494);
                int32_t unsign_arg0_124496 = 1 & unsign_arg0_124495;
                bool cond_f_res_124497 = get_bit_arg0_124494 == 31;
                bool y_124498 = x_124489 && cond_f_res_124497;
                bool cond_124499 = cond_124488 || y_124498;
                int32_t defunc_0_get_bit_res_124500;
                
                if (cond_124499) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ unsign_arg0_124496;
                    
                    defunc_0_get_bit_res_124500 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_124500 = unsign_arg0_124496;
                }
                
                int8_t loopres_124502;
                
                if (futrts_set_bit_2464(ctx, &loopres_124502, binop_x_124493, y_124492, defunc_0_get_bit_res_124500) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_124502;
                
                y_124492 = y_tmp_133521;
            }
            defunc_0_f_res_124490 = y_124492;
            ((int8_t *) mem_133185)[i_133042] = defunc_0_f_res_124490;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_124507;
        int64_t offs_124510;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_124510 = (int64_t) 0;
        for (int64_t i_124509 = 0; i_124509 < up_to_124503; i_124509++) {
            int32_t binop_x_124512 = sext_i64_i32(i_124509);
            int8_t index_primexp_124513 = zext_i32_i8(binop_x_124512);
            
            if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_87890; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133185)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_124513;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133194.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_124510, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133196.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_124538 = add64(offs_124510, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133196, "mem_133196") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_124538;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_124510 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133205, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_124507 = offs_124510;
        if (memblock_alloc(ctx, &mem_133207, bytes_133177, "mem_133207")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87890});
        if (memblock_alloc(ctx, &mem_133209, bytes_133246, "mem_133209")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87890});
        
        bool partitioned_scatter_res_124545;
        int64_t partitioned_scatter_res_124548;
        bool loop_while_124549;
        int64_t p_124552;
        
        loop_while_124549 = loop_cond_124464;
        p_124552 = (int64_t) 0;
        while (loop_while_124549) {
            int64_t lower_bound_124553 = mul64(i16_res_124439, p_124552);
            int64_t min_arg1_124554 = add64(i16_res_124439, lower_bound_124553);
            int64_t min_res_124555 = smin64(n_87890, min_arg1_124554);
            int64_t j_m_i_124556 = sub64(min_res_124555, lower_bound_124553);
            bool empty_slice_124557 = j_m_i_124556 == (int64_t) 0;
            int64_t m_124558 = sub64(j_m_i_124556, (int64_t) 1);
            int64_t i_p_m_t_s_124559 = add64(lower_bound_124553, m_124558);
            bool zzero_leq_i_p_m_t_s_124560 = sle64((int64_t) 0, i_p_m_t_s_124559);
            bool i_p_m_t_s_leq_w_124561 = slt64(i_p_m_t_s_124559, n_87890);
            bool zzero_lte_i_124562 = sle64((int64_t) 0, lower_bound_124553);
            bool i_lte_j_124563 = sle64(lower_bound_124553, min_res_124555);
            bool y_124564 = i_p_m_t_s_leq_w_124561 && zzero_lte_i_124562;
            bool y_124565 = zzero_leq_i_p_m_t_s_124560 && y_124564;
            bool forwards_ok_124566 = i_lte_j_124563 && y_124565;
            bool ok_or_empty_124567 = empty_slice_124557 || forwards_ok_124566;
            bool index_certs_124568;
            
            if (!ok_or_empty_124567) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_124553, ":", (long long) min_res_124555, "] out of bounds for array of shape [", (long long) n_87890, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:142:98-101\n   #4  ftRelational.fut:130:75-86\n   #5  ftRelational.fut:129:9-130:87\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133216 = (int64_t) 8 * j_m_i_124556;
            int64_t bytes_133218 = (int64_t) 4 * j_m_i_124556;
            
            if (mem_133217_cached_sizze_133914 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133914, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133207.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_124553, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124556});
            if (mem_133219_cached_sizze_133915 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133915, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133209.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_124553, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124556});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_87890; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133205.mem)[write_iter_133062];
                int64_t write_iv_133066 = ((int64_t *) mem_param_133181.mem)[write_iter_133062];
                float write_iv_133067 = ((float *) mem_param_133184.mem)[write_iter_133062];
                bool cond_129195 = sle64(lower_bound_124553, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_124555);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_124553);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124556)) {
                    ((int64_t *) mem_133217)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124556)) {
                    ((float *) mem_133219)[lifted_lambda_res_129198] = write_iv_133067;
                }
            }
            
            int64_t tmp_124580 = add64((int64_t) 1, p_124552);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, lower_bound_124553, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124556});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133209.mem, lower_bound_124553, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124556});
            
            bool loop_cond_124588 = slt64(tmp_124580, m_124463);
            bool loop_while_tmp_133528 = loop_cond_124588;
            int64_t p_tmp_133531 = tmp_124580;
            
            loop_while_124549 = loop_while_tmp_133528;
            p_124552 = p_tmp_133531;
        }
        partitioned_scatter_res_124545 = loop_while_124549;
        partitioned_scatter_res_124548 = p_124552;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133243, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133242, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133245, bytes_133177, "mem_133245")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133243.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87890});
    if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133247, bytes_133246, "mem_133247")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133247.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133242.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87890});
    if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133245, "mem_133245") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133247, "mem_133247") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133911, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133912, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133185);
        free(mem_133217);
        free(mem_133219);
        if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133245, "mem_133245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_133916, struct memblock *mem_out_p_133917, struct memblock xs_mem_133175, int64_t n_86133, int64_t incr_86134, int16_t block_sizze_86135)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133185_cached_sizze_133918 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133217_cached_sizze_133919 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133920 = 0;
    unsigned char *mem_133219 = NULL;
    struct memblock mem_133247;
    
    mem_133247.references = NULL;
    
    struct memblock mem_133245;
    
    mem_133245.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_133207;
    
    mem_133207.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133205;
    
    ext_mem_133205.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133242;
    
    ext_mem_133242.references = NULL;
    
    struct memblock ext_mem_133243;
    
    ext_mem_133243.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_122626 = sext_i16_i64(block_sizze_86135);
    int64_t bytes_133177 = (int64_t) 8 * n_86133;
    bool zzero_122645 = i16_res_122626 == (int64_t) 0;
    bool nonzzero_122646 = !zzero_122645;
    bool nonzzero_cert_122649;
    
    if (!nonzzero_122646) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:126:78-89\n   #5  ftRelational.fut:125:9-126:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133246 = (int64_t) 4 * n_86133;
    
    if (futrts_indicesWithIncrement_11394(ctx, &ext_mem_133176, xs_mem_133175, n_86133, incr_86134) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_86133; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_122643 = add64(n_86133, i16_res_122626);
    int64_t zs_lhs_122644 = sub64(zm_lhs_122643, (int64_t) 1);
    int64_t m_122650 = sdiv_safe64(zs_lhs_122644, i16_res_122626);
    bool loop_cond_122651 = slt64((int64_t) 0, m_122650);
    
    if (mem_133185_cached_sizze_133918 < n_86133) {
        err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133918, n_86133);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133184, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    for (int64_t i_122654 = 0; i_122654 < (int64_t) 16; i_122654++) {
        int32_t binop_x_122657 = sext_i64_i32(i_122654);
        int32_t binop_x_122658 = mul32(2, binop_x_122657);
        int32_t zm_lhs_122659 = add32(2, binop_x_122658);
        int32_t min_arg1_122660 = sub32(zm_lhs_122659, 1);
        int32_t min_res_122661 = smin32(32, min_arg1_122660);
        int32_t zp_lhs_122662 = sub32(min_res_122661, binop_x_122658);
        int32_t ij_bits_122663 = add32(1, zp_lhs_122662);
        int32_t up_to_122664 = shl32(1, ij_bits_122663);
        int64_t tmp_122665 = sext_i32_i64(zp_lhs_122662);
        bool bounds_invalid_upwards_122666 = slt32(zp_lhs_122662, 0);
        bool valid_122668 = !bounds_invalid_upwards_122666;
        bool range_valid_c_122669;
        
        if (!valid_122668) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122665, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:131:96-99\n   #5  ftRelational.fut:126:78-89\n   #6  ftRelational.fut:125:9-126:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_122682 = sext_i32_i64(up_to_122664);
        bool bounds_invalid_upwards_122683 = slt32(up_to_122664, 0);
        bool valid_122684 = !bounds_invalid_upwards_122683;
        bool range_valid_c_122685;
        
        if (!valid_122684) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122682, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:126:78-89\n   #5  ftRelational.fut:125:9-126:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_122667 = add64((int64_t) 1, tmp_122665);
        
        for (int64_t i_133042 = 0; i_133042 < n_86133; i_133042++) {
            int32_t eta_p_122671 = ((int32_t *) mem_param_133184.mem)[i_133042];
            int8_t defunc_0_f_res_122672;
            int8_t y_122674 = (int8_t) 0;
            
            for (int64_t i_122673 = 0; i_122673 < distance_122667; i_122673++) {
                int32_t binop_x_122675 = sext_i64_i32(i_122673);
                int32_t get_bit_arg0_122676 = add32(binop_x_122658, binop_x_122675);
                int32_t zgzg_res_127618 = ashr32(eta_p_122671, get_bit_arg0_122676);
                int32_t za_res_127619 = 1 & zgzg_res_127618;
                bool cond_122678 = get_bit_arg0_122676 == 31;
                int32_t defunc_0_get_bit_res_122679;
                
                if (cond_122678) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ za_res_127619;
                    
                    defunc_0_get_bit_res_122679 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_122679 = za_res_127619;
                }
                
                int8_t loopres_122681;
                
                if (futrts_set_bit_2464(ctx, &loopres_122681, binop_x_122675, y_122674, defunc_0_get_bit_res_122679) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_122681;
                
                y_122674 = y_tmp_133521;
            }
            defunc_0_f_res_122672 = y_122674;
            ((int8_t *) mem_133185)[i_133042] = defunc_0_f_res_122672;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_122686;
        int64_t offs_122689;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_122689 = (int64_t) 0;
        for (int64_t i_122688 = 0; i_122688 < up_to_122682; i_122688++) {
            int32_t binop_x_122691 = sext_i64_i32(i_122688);
            int8_t index_primexp_122692 = zext_i32_i8(binop_x_122691);
            
            if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_86133; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133185)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_122692;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133194.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_122689, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133196.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_122717 = add64(offs_122689, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133196, "mem_133196") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_122717;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_122689 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133205, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_122686 = offs_122689;
        if (memblock_alloc(ctx, &mem_133207, bytes_133177, "mem_133207")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86133});
        if (memblock_alloc(ctx, &mem_133209, bytes_133246, "mem_133209")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86133});
        
        bool partitioned_scatter_res_122724;
        int64_t partitioned_scatter_res_122727;
        bool loop_while_122728;
        int64_t p_122731;
        
        loop_while_122728 = loop_cond_122651;
        p_122731 = (int64_t) 0;
        while (loop_while_122728) {
            int64_t lower_bound_122732 = mul64(i16_res_122626, p_122731);
            int64_t min_arg1_122733 = add64(i16_res_122626, lower_bound_122732);
            int64_t min_res_122734 = smin64(n_86133, min_arg1_122733);
            int64_t j_m_i_122735 = sub64(min_res_122734, lower_bound_122732);
            bool empty_slice_122736 = j_m_i_122735 == (int64_t) 0;
            int64_t m_122737 = sub64(j_m_i_122735, (int64_t) 1);
            int64_t i_p_m_t_s_122738 = add64(lower_bound_122732, m_122737);
            bool zzero_leq_i_p_m_t_s_122739 = sle64((int64_t) 0, i_p_m_t_s_122738);
            bool i_p_m_t_s_leq_w_122740 = slt64(i_p_m_t_s_122738, n_86133);
            bool zzero_lte_i_122741 = sle64((int64_t) 0, lower_bound_122732);
            bool i_lte_j_122742 = sle64(lower_bound_122732, min_res_122734);
            bool y_122743 = i_p_m_t_s_leq_w_122740 && zzero_lte_i_122741;
            bool y_122744 = zzero_leq_i_p_m_t_s_122739 && y_122743;
            bool forwards_ok_122745 = i_lte_j_122742 && y_122744;
            bool ok_or_empty_122746 = empty_slice_122736 || forwards_ok_122745;
            bool index_certs_122747;
            
            if (!ok_or_empty_122746) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122732, ":", (long long) min_res_122734, "] out of bounds for array of shape [", (long long) n_86133, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:126:78-89\n   #5  ftRelational.fut:125:9-126:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133216 = (int64_t) 8 * j_m_i_122735;
            int64_t bytes_133218 = (int64_t) 4 * j_m_i_122735;
            
            if (mem_133217_cached_sizze_133919 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133919, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133207.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122732, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            if (mem_133219_cached_sizze_133920 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133920, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133209.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122732, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_86133; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133205.mem)[write_iter_133062];
                int64_t write_iv_133066 = ((int64_t *) mem_param_133181.mem)[write_iter_133062];
                int32_t write_iv_133067 = ((int32_t *) mem_param_133184.mem)[write_iter_133062];
                bool cond_129195 = sle64(lower_bound_122732, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_122734);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_122732);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122735)) {
                    ((int64_t *) mem_133217)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122735)) {
                    ((int32_t *) mem_133219)[lifted_lambda_res_129198] = write_iv_133067;
                }
            }
            
            int64_t tmp_122759 = add64((int64_t) 1, p_122731);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, lower_bound_122732, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133209.mem, lower_bound_122732, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            
            bool loop_cond_122767 = slt64(tmp_122759, m_122650);
            bool loop_while_tmp_133528 = loop_cond_122767;
            int64_t p_tmp_133531 = tmp_122759;
            
            loop_while_122728 = loop_while_tmp_133528;
            p_122731 = p_tmp_133531;
        }
        partitioned_scatter_res_122724 = loop_while_122728;
        partitioned_scatter_res_122727 = p_122731;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133243, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133242, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133245, bytes_133177, "mem_133245")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133243.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86133});
    if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133247, bytes_133246, "mem_133247")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133247.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133242.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86133});
    if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133245, "mem_133245") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133247, "mem_133247") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133916, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133917, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133185);
        free(mem_133217);
        free(mem_133219);
        if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133245, "mem_133245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_133921, struct memblock *mem_out_p_133922, struct memblock xs_mem_133175, int64_t n_87001, int64_t incr_87002, int16_t block_sizze_87003)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133185_cached_sizze_133923 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133217_cached_sizze_133924 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133925 = 0;
    unsigned char *mem_133219 = NULL;
    struct memblock mem_133247;
    
    mem_133247.references = NULL;
    
    struct memblock mem_133245;
    
    mem_133245.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_133207;
    
    mem_133207.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133205;
    
    ext_mem_133205.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133242;
    
    ext_mem_133242.references = NULL;
    
    struct memblock ext_mem_133243;
    
    ext_mem_133243.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_122626 = sext_i16_i64(block_sizze_87003);
    int64_t bytes_133177 = (int64_t) 8 * n_87001;
    bool zzero_122645 = i16_res_122626 == (int64_t) 0;
    bool nonzzero_122646 = !zzero_122645;
    bool nonzzero_cert_122649;
    
    if (!nonzzero_122646) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:128:78-89\n   #5  ftRelational.fut:127:9-128:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_11416(ctx, &ext_mem_133176, xs_mem_133175, n_87001, incr_87002) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_87001; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_122643 = add64(n_87001, i16_res_122626);
    int64_t zs_lhs_122644 = sub64(zm_lhs_122643, (int64_t) 1);
    int64_t m_122650 = sdiv_safe64(zs_lhs_122644, i16_res_122626);
    bool loop_cond_122651 = slt64((int64_t) 0, m_122650);
    
    if (mem_133185_cached_sizze_133923 < n_87001) {
        err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133923, n_87001);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133184, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    for (int64_t i_122654 = 0; i_122654 < (int64_t) 32; i_122654++) {
        int32_t binop_x_122657 = sext_i64_i32(i_122654);
        int32_t binop_x_122658 = mul32(2, binop_x_122657);
        int32_t zm_lhs_122659 = add32(2, binop_x_122658);
        int32_t min_arg1_122660 = sub32(zm_lhs_122659, 1);
        int32_t min_res_122661 = smin32(64, min_arg1_122660);
        int32_t zp_lhs_122662 = sub32(min_res_122661, binop_x_122658);
        int32_t ij_bits_122663 = add32(1, zp_lhs_122662);
        int32_t up_to_122664 = shl32(1, ij_bits_122663);
        int64_t tmp_122665 = sext_i32_i64(zp_lhs_122662);
        bool bounds_invalid_upwards_122666 = slt32(zp_lhs_122662, 0);
        bool valid_122668 = !bounds_invalid_upwards_122666;
        bool range_valid_c_122669;
        
        if (!valid_122668) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122665, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:131:96-99\n   #5  ftRelational.fut:128:78-89\n   #6  ftRelational.fut:127:9-128:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_122682 = sext_i32_i64(up_to_122664);
        bool bounds_invalid_upwards_122683 = slt32(up_to_122664, 0);
        bool valid_122684 = !bounds_invalid_upwards_122683;
        bool range_valid_c_122685;
        
        if (!valid_122684) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122682, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:128:78-89\n   #5  ftRelational.fut:127:9-128:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_122667 = add64((int64_t) 1, tmp_122665);
        
        for (int64_t i_133042 = 0; i_133042 < n_87001; i_133042++) {
            int64_t eta_p_122671 = ((int64_t *) mem_param_133184.mem)[i_133042];
            int8_t defunc_0_f_res_122672;
            int8_t y_122674 = (int8_t) 0;
            
            for (int64_t i_122673 = 0; i_122673 < distance_122667; i_122673++) {
                int32_t binop_x_122675 = sext_i64_i32(i_122673);
                int32_t get_bit_arg0_122676 = add32(binop_x_122658, binop_x_122675);
                int32_t defunc_0_get_bit_res_122677;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_122677, get_bit_arg0_122676, eta_p_122671) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_122678 = get_bit_arg0_122676 == 63;
                int32_t defunc_0_get_bit_res_122679;
                
                if (cond_122678) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ defunc_0_get_bit_res_122677;
                    
                    defunc_0_get_bit_res_122679 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_122679 = defunc_0_get_bit_res_122677;
                }
                
                int8_t loopres_122681;
                
                if (futrts_set_bit_2464(ctx, &loopres_122681, binop_x_122675, y_122674, defunc_0_get_bit_res_122679) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_122681;
                
                y_122674 = y_tmp_133521;
            }
            defunc_0_f_res_122672 = y_122674;
            ((int8_t *) mem_133185)[i_133042] = defunc_0_f_res_122672;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_122686;
        int64_t offs_122689;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_122689 = (int64_t) 0;
        for (int64_t i_122688 = 0; i_122688 < up_to_122682; i_122688++) {
            int32_t binop_x_122691 = sext_i64_i32(i_122688);
            int8_t index_primexp_122692 = zext_i32_i8(binop_x_122691);
            
            if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_87001; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133185)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_122692;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133194.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_122689, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133196.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_122717 = add64(offs_122689, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133196, "mem_133196") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_122717;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_122689 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133205, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_122686 = offs_122689;
        if (memblock_alloc(ctx, &mem_133207, bytes_133177, "mem_133207")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87001});
        if (memblock_alloc(ctx, &mem_133209, bytes_133177, "mem_133209")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87001});
        
        bool partitioned_scatter_res_122724;
        int64_t partitioned_scatter_res_122727;
        bool loop_while_122728;
        int64_t p_122731;
        
        loop_while_122728 = loop_cond_122651;
        p_122731 = (int64_t) 0;
        while (loop_while_122728) {
            int64_t lower_bound_122732 = mul64(i16_res_122626, p_122731);
            int64_t min_arg1_122733 = add64(i16_res_122626, lower_bound_122732);
            int64_t min_res_122734 = smin64(n_87001, min_arg1_122733);
            int64_t j_m_i_122735 = sub64(min_res_122734, lower_bound_122732);
            bool empty_slice_122736 = j_m_i_122735 == (int64_t) 0;
            int64_t m_122737 = sub64(j_m_i_122735, (int64_t) 1);
            int64_t i_p_m_t_s_122738 = add64(lower_bound_122732, m_122737);
            bool zzero_leq_i_p_m_t_s_122739 = sle64((int64_t) 0, i_p_m_t_s_122738);
            bool i_p_m_t_s_leq_w_122740 = slt64(i_p_m_t_s_122738, n_87001);
            bool zzero_lte_i_122741 = sle64((int64_t) 0, lower_bound_122732);
            bool i_lte_j_122742 = sle64(lower_bound_122732, min_res_122734);
            bool y_122743 = i_p_m_t_s_leq_w_122740 && zzero_lte_i_122741;
            bool y_122744 = zzero_leq_i_p_m_t_s_122739 && y_122743;
            bool forwards_ok_122745 = i_lte_j_122742 && y_122744;
            bool ok_or_empty_122746 = empty_slice_122736 || forwards_ok_122745;
            bool index_certs_122747;
            
            if (!ok_or_empty_122746) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122732, ":", (long long) min_res_122734, "] out of bounds for array of shape [", (long long) n_87001, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:128:78-89\n   #5  ftRelational.fut:127:9-128:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133216 = (int64_t) 8 * j_m_i_122735;
            
            if (mem_133217_cached_sizze_133924 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133924, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133207.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122732, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            if (mem_133219_cached_sizze_133925 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133925, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133209.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122732, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_87001; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133205.mem)[write_iter_133062];
                int64_t write_iv_133066 = ((int64_t *) mem_param_133181.mem)[write_iter_133062];
                int64_t write_iv_133067 = ((int64_t *) mem_param_133184.mem)[write_iter_133062];
                bool cond_129195 = sle64(lower_bound_122732, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_122734);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_122732);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122735)) {
                    ((int64_t *) mem_133217)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122735)) {
                    ((int64_t *) mem_133219)[lifted_lambda_res_129198] = write_iv_133067;
                }
            }
            
            int64_t tmp_122759 = add64((int64_t) 1, p_122731);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, lower_bound_122732, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133209.mem, lower_bound_122732, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            
            bool loop_cond_122767 = slt64(tmp_122759, m_122650);
            bool loop_while_tmp_133528 = loop_cond_122767;
            int64_t p_tmp_133531 = tmp_122759;
            
            loop_while_122728 = loop_while_tmp_133528;
            p_122731 = p_tmp_133531;
        }
        partitioned_scatter_res_122724 = loop_while_122728;
        partitioned_scatter_res_122727 = p_122731;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133243, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133242, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133245, bytes_133177, "mem_133245")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133243.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87001});
    if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133247, bytes_133177, "mem_133247")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133247.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133242.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_87001});
    if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133245, "mem_133245") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133247, "mem_133247") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133921, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133922, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133185);
        free(mem_133217);
        free(mem_133219);
        if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133245, "mem_133245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_133926, struct memblock *mem_out_p_133927, struct memblock xs_mem_133175, int64_t n_85265, int64_t incr_85266, int16_t block_sizze_85267)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133185_cached_sizze_133928 = 0;
    unsigned char *mem_133185 = NULL;
    int64_t mem_133217_cached_sizze_133929 = 0;
    unsigned char *mem_133217 = NULL;
    int64_t mem_133219_cached_sizze_133930 = 0;
    unsigned char *mem_133219 = NULL;
    struct memblock mem_133247;
    
    mem_133247.references = NULL;
    
    struct memblock mem_133245;
    
    mem_133245.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133209;
    
    mem_133209.references = NULL;
    
    struct memblock mem_133207;
    
    mem_133207.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133196;
    
    mem_133196.references = NULL;
    
    struct memblock mem_param_133194;
    
    mem_param_133194.references = NULL;
    
    struct memblock ext_mem_133205;
    
    ext_mem_133205.references = NULL;
    
    struct memblock mem_param_133184;
    
    mem_param_133184.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133242;
    
    ext_mem_133242.references = NULL;
    
    struct memblock ext_mem_133243;
    
    ext_mem_133243.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock ext_mem_133176;
    
    ext_mem_133176.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_122626 = sext_i16_i64(block_sizze_85267);
    int64_t bytes_133177 = (int64_t) 8 * n_85265;
    bool zzero_122645 = i16_res_122626 == (int64_t) 0;
    bool nonzzero_122646 = !zzero_122645;
    bool nonzzero_cert_122649;
    
    if (!nonzzero_122646) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:124:78-89\n   #5  ftRelational.fut:123:9-124:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133246 = (int64_t) 2 * n_85265;
    
    if (futrts_indicesWithIncrement_11373(ctx, &ext_mem_133176, xs_mem_133175, n_85265, incr_85266) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_85265; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_122643 = add64(n_85265, i16_res_122626);
    int64_t zs_lhs_122644 = sub64(zm_lhs_122643, (int64_t) 1);
    int64_t m_122650 = sdiv_safe64(zs_lhs_122644, i16_res_122626);
    bool loop_cond_122651 = slt64((int64_t) 0, m_122650);
    
    if (mem_133185_cached_sizze_133928 < n_85265) {
        err = lexical_realloc(ctx, &mem_133185, &mem_133185_cached_sizze_133928, n_85265);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133184, &xs_mem_133175, "xs_mem_133175") != 0)
        return 1;
    for (int64_t i_122654 = 0; i_122654 < (int64_t) 8; i_122654++) {
        int32_t binop_x_122657 = sext_i64_i32(i_122654);
        int32_t binop_x_122658 = mul32(2, binop_x_122657);
        int32_t zm_lhs_122659 = add32(2, binop_x_122658);
        int32_t min_arg1_122660 = sub32(zm_lhs_122659, 1);
        int32_t min_res_122661 = smin32(16, min_arg1_122660);
        int32_t zp_lhs_122662 = sub32(min_res_122661, binop_x_122658);
        int32_t ij_bits_122663 = add32(1, zp_lhs_122662);
        int32_t up_to_122664 = shl32(1, ij_bits_122663);
        int64_t tmp_122665 = sext_i32_i64(zp_lhs_122662);
        bool bounds_invalid_upwards_122666 = slt32(zp_lhs_122662, 0);
        bool valid_122668 = !bounds_invalid_upwards_122666;
        bool range_valid_c_122669;
        
        if (!valid_122668) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122665, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:131:96-99\n   #5  ftRelational.fut:124:78-89\n   #6  ftRelational.fut:123:9-124:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_122682 = sext_i32_i64(up_to_122664);
        bool bounds_invalid_upwards_122683 = slt32(up_to_122664, 0);
        bool valid_122684 = !bounds_invalid_upwards_122683;
        bool range_valid_c_122685;
        
        if (!valid_122684) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122682, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:124:78-89\n   #5  ftRelational.fut:123:9-124:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_122667 = add64((int64_t) 1, tmp_122665);
        
        for (int64_t i_133042 = 0; i_133042 < n_85265; i_133042++) {
            int16_t eta_p_122671 = ((int16_t *) mem_param_133184.mem)[i_133042];
            int8_t defunc_0_f_res_122672;
            int8_t y_122674 = (int8_t) 0;
            
            for (int64_t i_122673 = 0; i_122673 < distance_122667; i_122673++) {
                int32_t binop_x_122675 = sext_i64_i32(i_122673);
                int32_t get_bit_arg0_122676 = add32(binop_x_122658, binop_x_122675);
                int32_t defunc_0_get_bit_res_122677;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_122677, get_bit_arg0_122676, eta_p_122671) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_122678 = get_bit_arg0_122676 == 15;
                int32_t defunc_0_get_bit_res_122679;
                
                if (cond_122678) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ defunc_0_get_bit_res_122677;
                    
                    defunc_0_get_bit_res_122679 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_122679 = defunc_0_get_bit_res_122677;
                }
                
                int8_t loopres_122681;
                
                if (futrts_set_bit_2464(ctx, &loopres_122681, binop_x_122675, y_122674, defunc_0_get_bit_res_122679) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_122681;
                
                y_122674 = y_tmp_133521;
            }
            defunc_0_f_res_122672 = y_122674;
            ((int8_t *) mem_133185)[i_133042] = defunc_0_f_res_122672;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_122686;
        int64_t offs_122689;
        
        if (memblock_set(ctx, &mem_param_133194, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_122689 = (int64_t) 0;
        for (int64_t i_122688 = 0; i_122688 < up_to_122682; i_122688++) {
            int32_t binop_x_122691 = sext_i64_i32(i_122688);
            int8_t index_primexp_122692 = zext_i32_i8(binop_x_122691);
            
            if (memblock_alloc(ctx, &mem_133196, bytes_133177, "mem_133196")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_85265; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133185)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_122692;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133194.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_122689, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133196.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_122717 = add64(offs_122689, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133196, "mem_133196") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_122717;
            
            if (memblock_set(ctx, &mem_param_133194, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_122689 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133205, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_122686 = offs_122689;
        if (memblock_alloc(ctx, &mem_133207, bytes_133177, "mem_133207")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85265});
        if (memblock_alloc(ctx, &mem_133209, bytes_133246, "mem_133209")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_133209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_133184.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85265});
        
        bool partitioned_scatter_res_122724;
        int64_t partitioned_scatter_res_122727;
        bool loop_while_122728;
        int64_t p_122731;
        
        loop_while_122728 = loop_cond_122651;
        p_122731 = (int64_t) 0;
        while (loop_while_122728) {
            int64_t lower_bound_122732 = mul64(i16_res_122626, p_122731);
            int64_t min_arg1_122733 = add64(i16_res_122626, lower_bound_122732);
            int64_t min_res_122734 = smin64(n_85265, min_arg1_122733);
            int64_t j_m_i_122735 = sub64(min_res_122734, lower_bound_122732);
            bool empty_slice_122736 = j_m_i_122735 == (int64_t) 0;
            int64_t m_122737 = sub64(j_m_i_122735, (int64_t) 1);
            int64_t i_p_m_t_s_122738 = add64(lower_bound_122732, m_122737);
            bool zzero_leq_i_p_m_t_s_122739 = sle64((int64_t) 0, i_p_m_t_s_122738);
            bool i_p_m_t_s_leq_w_122740 = slt64(i_p_m_t_s_122738, n_85265);
            bool zzero_lte_i_122741 = sle64((int64_t) 0, lower_bound_122732);
            bool i_lte_j_122742 = sle64(lower_bound_122732, min_res_122734);
            bool y_122743 = i_p_m_t_s_leq_w_122740 && zzero_lte_i_122741;
            bool y_122744 = zzero_leq_i_p_m_t_s_122739 && y_122743;
            bool forwards_ok_122745 = i_lte_j_122742 && y_122744;
            bool ok_or_empty_122746 = empty_slice_122736 || forwards_ok_122745;
            bool index_certs_122747;
            
            if (!ok_or_empty_122746) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122732, ":", (long long) min_res_122734, "] out of bounds for array of shape [", (long long) n_85265, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:131:96-99\n   #4  ftRelational.fut:124:78-89\n   #5  ftRelational.fut:123:9-124:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133216 = (int64_t) 8 * j_m_i_122735;
            int64_t bytes_133218 = (int64_t) 2 * j_m_i_122735;
            
            if (mem_133217_cached_sizze_133929 < bytes_133216) {
                err = lexical_realloc(ctx, &mem_133217, &mem_133217_cached_sizze_133929, bytes_133216);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133207.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122732, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            if (mem_133219_cached_sizze_133930 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133930, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_133209.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122732, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_85265; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133205.mem)[write_iter_133062];
                int64_t write_iv_133066 = ((int64_t *) mem_param_133181.mem)[write_iter_133062];
                int16_t write_iv_133067 = ((int16_t *) mem_param_133184.mem)[write_iter_133062];
                bool cond_129195 = sle64(lower_bound_122732, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_122734);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_122732);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122735)) {
                    ((int64_t *) mem_133217)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122735)) {
                    ((int16_t *) mem_133219)[lifted_lambda_res_129198] = write_iv_133067;
                }
            }
            
            int64_t tmp_122759 = add64((int64_t) 1, p_122731);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133207.mem, lower_bound_122732, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133217, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_133209.mem, lower_bound_122732, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122735});
            
            bool loop_cond_122767 = slt64(tmp_122759, m_122650);
            bool loop_while_tmp_133528 = loop_cond_122767;
            int64_t p_tmp_133531 = tmp_122759;
            
            loop_while_122728 = loop_while_tmp_133528;
            p_122731 = p_tmp_133531;
        }
        partitioned_scatter_res_122724 = loop_while_122728;
        partitioned_scatter_res_122727 = p_122731;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133184, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133243, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133242, &mem_param_133184, "mem_param_133184") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133245, bytes_133177, "mem_133245")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133243.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85265});
    if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133247, bytes_133246, "mem_133247")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_133247.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133242.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85265});
    if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133245, "mem_133245") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133247, "mem_133247") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133926, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133927, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133185);
        free(mem_133217);
        free(mem_133219);
        if (memblock_unref(ctx, &mem_133247, "mem_133247") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133245, "mem_133245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133209, "mem_133209") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133207, "mem_133207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133196, "mem_133196") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133194, "mem_param_133194") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133205, "ext_mem_133205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133184, "mem_param_133184") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133242, "ext_mem_133242") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133243, "ext_mem_133243") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133176, "ext_mem_133176") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_133931, struct memblock *mem_out_p_133932, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_72476, int64_t b_72477, int16_t block_sizze_72478)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133186_cached_sizze_133933 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133219_cached_sizze_133934 = 0;
    unsigned char *mem_133219 = NULL;
    int64_t mem_133221_cached_sizze_133935 = 0;
    unsigned char *mem_133221 = NULL;
    int64_t mem_133229_cached_sizze_133936 = 0;
    unsigned char *mem_133229 = NULL;
    struct memblock mem_133254;
    
    mem_133254.references = NULL;
    
    struct memblock mem_133252;
    
    mem_133252.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_133208;
    
    mem_133208.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133197;
    
    mem_133197.references = NULL;
    
    struct memblock mem_param_133195;
    
    mem_param_133195.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock mem_param_133185;
    
    mem_param_133185.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133249;
    
    ext_mem_133249.references = NULL;
    
    struct memblock ext_mem_133250;
    
    ext_mem_133250.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_124433 = sext_i16_i64(block_sizze_72478);
    int64_t bytes_133177 = (int64_t) 8 * n_72476;
    bool zzero_124453 = i16_res_124433 == (int64_t) 0;
    bool nonzzero_124454 = !zzero_124453;
    bool nonzzero_cert_124457;
    
    if (!nonzzero_124454) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:96:98-101\n   #4  ftRelational.fut:96:78-89\n   #5  ftRelational.fut:92:9-96:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133253 = n_72476 * b_72477;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_72476; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_124451 = add64(n_72476, i16_res_124433);
    int64_t zs_lhs_124452 = sub64(zm_lhs_124451, (int64_t) 1);
    int64_t m_124458 = sdiv_safe64(zs_lhs_124452, i16_res_124433);
    bool loop_cond_124459 = slt64((int64_t) 0, m_124458);
    
    if (mem_133186_cached_sizze_133933 < n_72476) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133933, n_72476);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133229_cached_sizze_133936 < b_72477) {
        err = lexical_realloc(ctx, &mem_133229, &mem_133229_cached_sizze_133936, b_72477);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &k_mem_133175, "k_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133185, &pL_mem_133176, "pL_mem_133176") != 0)
        return 1;
    for (int64_t i_124462 = 0; i_124462 < (int64_t) 32; i_124462++) {
        int32_t binop_x_124465 = sext_i64_i32(i_124462);
        int32_t binop_x_124466 = mul32(2, binop_x_124465);
        int32_t zm_lhs_124467 = add32(2, binop_x_124466);
        int32_t min_arg1_124468 = sub32(zm_lhs_124467, 1);
        int32_t min_res_124469 = smin32(64, min_arg1_124468);
        int32_t zp_lhs_124470 = sub32(min_res_124469, binop_x_124466);
        int32_t ij_bits_124471 = add32(1, zp_lhs_124470);
        int32_t up_to_124472 = shl32(1, ij_bits_124471);
        int64_t tmp_124473 = sext_i32_i64(zp_lhs_124470);
        bool bounds_invalid_upwards_124474 = slt32(zp_lhs_124470, 0);
        bool valid_124476 = !bounds_invalid_upwards_124474;
        bool range_valid_c_124477;
        
        if (!valid_124476) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_124473, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:96:98-101\n   #5  ftRelational.fut:96:78-89\n   #6  ftRelational.fut:92:9-96:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_124501 = sext_i32_i64(up_to_124472);
        bool bounds_invalid_upwards_124502 = slt32(up_to_124472, 0);
        bool valid_124503 = !bounds_invalid_upwards_124502;
        bool range_valid_c_124504;
        
        if (!valid_124503) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_124501, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:96:98-101\n   #4  ftRelational.fut:96:78-89\n   #5  ftRelational.fut:92:9-96:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_124475 = add64((int64_t) 1, tmp_124473);
        
        for (int64_t i_133042 = 0; i_133042 < n_72476; i_133042++) {
            double eta_p_124479 = ((double *) mem_param_133181.mem)[i_133042];
            int64_t i64_arg0_124480 = futrts_to_bits64(eta_p_124479);
            int64_t unsign_arg0_124481 = ashr64(i64_arg0_124480, (int64_t) 63);
            int64_t unsign_arg0_124482 = (int64_t) 1 & unsign_arg0_124481;
            int32_t to_i32_res_124483 = zext_i64_i32(unsign_arg0_124482);
            bool cond_124484 = to_i32_res_124483 == 1;
            bool x_124485 = !cond_124484;
            int8_t defunc_0_f_res_124486;
            int8_t y_124488 = (int8_t) 0;
            
            for (int64_t i_124487 = 0; i_124487 < distance_124475; i_124487++) {
                int32_t binop_x_124489 = sext_i64_i32(i_124487);
                int32_t get_bit_arg0_124490 = add32(binop_x_124466, binop_x_124489);
                int64_t unsign_arg0_124491 = zext_i32_i64(get_bit_arg0_124490);
                int64_t unsign_arg0_124492 = ashr64(i64_arg0_124480, unsign_arg0_124491);
                int64_t unsign_arg0_124493 = (int64_t) 1 & unsign_arg0_124492;
                int32_t to_i32_res_124494 = zext_i64_i32(unsign_arg0_124493);
                bool cond_f_res_124495 = get_bit_arg0_124490 == 63;
                bool y_124496 = x_124485 && cond_f_res_124495;
                bool cond_124497 = cond_124484 || y_124496;
                int32_t defunc_0_get_bit_res_124498;
                
                if (cond_124497) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ to_i32_res_124494;
                    
                    defunc_0_get_bit_res_124498 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_124498 = to_i32_res_124494;
                }
                
                int8_t loopres_124500;
                
                if (futrts_set_bit_2464(ctx, &loopres_124500, binop_x_124489, y_124488, defunc_0_get_bit_res_124498) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_124500;
                
                y_124488 = y_tmp_133521;
            }
            defunc_0_f_res_124486 = y_124488;
            ((int8_t *) mem_133186)[i_133042] = defunc_0_f_res_124486;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_124505;
        int64_t offs_124508;
        
        if (memblock_set(ctx, &mem_param_133195, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_124508 = (int64_t) 0;
        for (int64_t i_124507 = 0; i_124507 < up_to_124501; i_124507++) {
            int32_t binop_x_124510 = sext_i64_i32(i_124507);
            int8_t index_primexp_124511 = zext_i32_i8(binop_x_124510);
            
            if (memblock_alloc(ctx, &mem_133197, bytes_133177, "mem_133197")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_72476; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133186)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_124511;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133195.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_124508, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133197.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_124536 = add64(offs_124508, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133197, "mem_133197") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_124536;
            
            if (memblock_set(ctx, &mem_param_133195, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_124508 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133206, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_124505 = offs_124508;
        if (memblock_alloc(ctx, &mem_133208, bytes_133177, "mem_133208")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133208.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_72476});
        if (memblock_alloc(ctx, &mem_133210, bytes_133253, "mem_133210")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {b_72477, (int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0, (int64_t []) {b_72477, (int64_t) 1}, (int64_t []) {n_72476, b_72477});
        
        bool partitioned_scatter_res_124543;
        int64_t partitioned_scatter_res_124546;
        bool loop_while_124547;
        int64_t p_124550;
        
        loop_while_124547 = loop_cond_124459;
        p_124550 = (int64_t) 0;
        while (loop_while_124547) {
            int64_t lower_bound_124551 = mul64(i16_res_124433, p_124550);
            int64_t min_arg1_124552 = add64(i16_res_124433, lower_bound_124551);
            int64_t min_res_124553 = smin64(n_72476, min_arg1_124552);
            int64_t j_m_i_124554 = sub64(min_res_124553, lower_bound_124551);
            bool empty_slice_124555 = j_m_i_124554 == (int64_t) 0;
            int64_t m_124556 = sub64(j_m_i_124554, (int64_t) 1);
            int64_t i_p_m_t_s_124557 = add64(lower_bound_124551, m_124556);
            bool zzero_leq_i_p_m_t_s_124558 = sle64((int64_t) 0, i_p_m_t_s_124557);
            bool i_p_m_t_s_leq_w_124559 = slt64(i_p_m_t_s_124557, n_72476);
            bool zzero_lte_i_124560 = sle64((int64_t) 0, lower_bound_124551);
            bool i_lte_j_124561 = sle64(lower_bound_124551, min_res_124553);
            bool y_124562 = i_p_m_t_s_leq_w_124559 && zzero_lte_i_124560;
            bool y_124563 = zzero_leq_i_p_m_t_s_124558 && y_124562;
            bool forwards_ok_124564 = i_lte_j_124561 && y_124563;
            bool ok_or_empty_124565 = empty_slice_124555 || forwards_ok_124564;
            bool index_certs_124566;
            
            if (!ok_or_empty_124565) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_124551, ":", (long long) min_res_124553, "] out of bounds for array of shape [", (long long) n_72476, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:96:98-101\n   #4  ftRelational.fut:96:78-89\n   #5  ftRelational.fut:92:9-96:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133218 = (int64_t) 8 * j_m_i_124554;
            int64_t bytes_133220 = b_72477 * j_m_i_124554;
            
            if (mem_133219_cached_sizze_133934 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133934, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133208.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_124551, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124554});
            if (mem_133221_cached_sizze_133935 < bytes_133220) {
                err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133935, bytes_133220);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_72477, (int64_t) 1}, (uint8_t *) mem_133210.mem, (int64_t) 0 + b_72477 * lower_bound_124551, (int64_t []) {b_72477, (int64_t) 1}, (int64_t []) {j_m_i_124554, b_72477});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_72476; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133206.mem)[write_iter_133062];
                double write_iv_133066 = ((double *) mem_param_133181.mem)[write_iter_133062];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0 + write_iter_133062 * b_72477, (int64_t []) {(int64_t) 1}, (int64_t []) {b_72477});
                
                bool cond_129195 = sle64(lower_bound_124551, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_124553);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_124551);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124554)) {
                    ((double *) mem_133219)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124554)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_72477 - (int64_t) 1, b_72477))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_133221, lifted_lambda_res_129198 * b_72477, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_72477});
                }
            }
            
            int64_t tmp_124578 = add64((int64_t) 1, p_124550);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133208.mem, lower_bound_124551, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124554});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, b_72477 * lower_bound_124551, (int64_t []) {b_72477, (int64_t) 1}, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_72477, (int64_t) 1}, (int64_t []) {j_m_i_124554, b_72477});
            
            bool loop_cond_124586 = slt64(tmp_124578, m_124458);
            bool loop_while_tmp_133528 = loop_cond_124586;
            int64_t p_tmp_133531 = tmp_124578;
            
            loop_while_124547 = loop_while_tmp_133528;
            p_124550 = p_tmp_133531;
        }
        partitioned_scatter_res_124543 = loop_while_124547;
        partitioned_scatter_res_124546 = p_124550;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133185, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133250, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133249, &mem_param_133185, "mem_param_133185") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133252, bytes_133177, "mem_133252")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133252.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133250.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_72476});
    if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133254, bytes_133253, "mem_133254")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133254.mem, (int64_t) 0, (int64_t []) {b_72477, (int64_t) 1}, (uint8_t *) ext_mem_133249.mem, (int64_t) 0, (int64_t []) {b_72477, (int64_t) 1}, (int64_t []) {n_72476, b_72477});
    if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133252, "mem_133252") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133254, "mem_133254") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133931, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133932, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133186);
        free(mem_133219);
        free(mem_133221);
        free(mem_133229);
        if (memblock_unref(ctx, &mem_133254, "mem_133254") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133252, "mem_133252") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133197, "mem_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133185, "mem_param_133185") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_133937, struct memblock *mem_out_p_133938, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_71526, int64_t b_71527, int16_t block_sizze_71528)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133186_cached_sizze_133939 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133219_cached_sizze_133940 = 0;
    unsigned char *mem_133219 = NULL;
    int64_t mem_133221_cached_sizze_133941 = 0;
    unsigned char *mem_133221 = NULL;
    int64_t mem_133229_cached_sizze_133942 = 0;
    unsigned char *mem_133229 = NULL;
    struct memblock mem_133254;
    
    mem_133254.references = NULL;
    
    struct memblock mem_133252;
    
    mem_133252.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_133208;
    
    mem_133208.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133197;
    
    mem_133197.references = NULL;
    
    struct memblock mem_param_133195;
    
    mem_param_133195.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock mem_param_133185;
    
    mem_param_133185.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133249;
    
    ext_mem_133249.references = NULL;
    
    struct memblock ext_mem_133250;
    
    ext_mem_133250.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_124433 = sext_i16_i64(block_sizze_71528);
    int64_t bytes_133177 = (int64_t) 8 * n_71526;
    bool zzero_124452 = i16_res_124433 == (int64_t) 0;
    bool nonzzero_124453 = !zzero_124452;
    bool nonzzero_cert_124456;
    
    if (!nonzzero_124453) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:96:98-101\n   #4  ftRelational.fut:91:78-89\n   #5  ftRelational.fut:87:9-91:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133251 = (int64_t) 4 * n_71526;
    int64_t bytes_133253 = n_71526 * b_71527;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_71526; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_124450 = add64(n_71526, i16_res_124433);
    int64_t zs_lhs_124451 = sub64(zm_lhs_124450, (int64_t) 1);
    int64_t m_124457 = sdiv_safe64(zs_lhs_124451, i16_res_124433);
    bool loop_cond_124458 = slt64((int64_t) 0, m_124457);
    
    if (mem_133186_cached_sizze_133939 < n_71526) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133939, n_71526);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133229_cached_sizze_133942 < b_71527) {
        err = lexical_realloc(ctx, &mem_133229, &mem_133229_cached_sizze_133942, b_71527);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &k_mem_133175, "k_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133185, &pL_mem_133176, "pL_mem_133176") != 0)
        return 1;
    for (int64_t i_124461 = 0; i_124461 < (int64_t) 16; i_124461++) {
        int32_t binop_x_124464 = sext_i64_i32(i_124461);
        int32_t binop_x_124465 = mul32(2, binop_x_124464);
        int32_t zm_lhs_124466 = add32(2, binop_x_124465);
        int32_t min_arg1_124467 = sub32(zm_lhs_124466, 1);
        int32_t min_res_124468 = smin32(32, min_arg1_124467);
        int32_t zp_lhs_124469 = sub32(min_res_124468, binop_x_124465);
        int32_t ij_bits_124470 = add32(1, zp_lhs_124469);
        int32_t up_to_124471 = shl32(1, ij_bits_124470);
        int64_t tmp_124472 = sext_i32_i64(zp_lhs_124469);
        bool bounds_invalid_upwards_124473 = slt32(zp_lhs_124469, 0);
        bool valid_124475 = !bounds_invalid_upwards_124473;
        bool range_valid_c_124476;
        
        if (!valid_124475) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_124472, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:96:98-101\n   #5  ftRelational.fut:91:78-89\n   #6  ftRelational.fut:87:9-91:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_124497 = sext_i32_i64(up_to_124471);
        bool bounds_invalid_upwards_124498 = slt32(up_to_124471, 0);
        bool valid_124499 = !bounds_invalid_upwards_124498;
        bool range_valid_c_124500;
        
        if (!valid_124499) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_124497, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:96:98-101\n   #4  ftRelational.fut:91:78-89\n   #5  ftRelational.fut:87:9-91:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_124474 = add64((int64_t) 1, tmp_124472);
        
        for (int64_t i_133042 = 0; i_133042 < n_71526; i_133042++) {
            float eta_p_124478 = ((float *) mem_param_133181.mem)[i_133042];
            int32_t i32_arg0_124479 = futrts_to_bits32(eta_p_124478);
            int32_t unsign_arg0_124480 = ashr32(i32_arg0_124479, 31);
            int32_t unsign_arg0_124481 = 1 & unsign_arg0_124480;
            bool cond_124482 = unsign_arg0_124481 == 1;
            bool x_124483 = !cond_124482;
            int8_t defunc_0_f_res_124484;
            int8_t y_124486 = (int8_t) 0;
            
            for (int64_t i_124485 = 0; i_124485 < distance_124474; i_124485++) {
                int32_t binop_x_124487 = sext_i64_i32(i_124485);
                int32_t get_bit_arg0_124488 = add32(binop_x_124465, binop_x_124487);
                int32_t unsign_arg0_124489 = ashr32(i32_arg0_124479, get_bit_arg0_124488);
                int32_t unsign_arg0_124490 = 1 & unsign_arg0_124489;
                bool cond_f_res_124491 = get_bit_arg0_124488 == 31;
                bool y_124492 = x_124483 && cond_f_res_124491;
                bool cond_124493 = cond_124482 || y_124492;
                int32_t defunc_0_get_bit_res_124494;
                
                if (cond_124493) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ unsign_arg0_124490;
                    
                    defunc_0_get_bit_res_124494 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_124494 = unsign_arg0_124490;
                }
                
                int8_t loopres_124496;
                
                if (futrts_set_bit_2464(ctx, &loopres_124496, binop_x_124487, y_124486, defunc_0_get_bit_res_124494) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_124496;
                
                y_124486 = y_tmp_133521;
            }
            defunc_0_f_res_124484 = y_124486;
            ((int8_t *) mem_133186)[i_133042] = defunc_0_f_res_124484;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_124501;
        int64_t offs_124504;
        
        if (memblock_set(ctx, &mem_param_133195, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_124504 = (int64_t) 0;
        for (int64_t i_124503 = 0; i_124503 < up_to_124497; i_124503++) {
            int32_t binop_x_124506 = sext_i64_i32(i_124503);
            int8_t index_primexp_124507 = zext_i32_i8(binop_x_124506);
            
            if (memblock_alloc(ctx, &mem_133197, bytes_133177, "mem_133197")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_71526; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133186)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_124507;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133195.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_124504, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133197.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_124532 = add64(offs_124504, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133197, "mem_133197") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_124532;
            
            if (memblock_set(ctx, &mem_param_133195, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_124504 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133206, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_124501 = offs_124504;
        if (memblock_alloc(ctx, &mem_133208, bytes_133251, "mem_133208")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_133208.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_71526});
        if (memblock_alloc(ctx, &mem_133210, bytes_133253, "mem_133210")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {b_71527, (int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0, (int64_t []) {b_71527, (int64_t) 1}, (int64_t []) {n_71526, b_71527});
        
        bool partitioned_scatter_res_124539;
        int64_t partitioned_scatter_res_124542;
        bool loop_while_124543;
        int64_t p_124546;
        
        loop_while_124543 = loop_cond_124458;
        p_124546 = (int64_t) 0;
        while (loop_while_124543) {
            int64_t lower_bound_124547 = mul64(i16_res_124433, p_124546);
            int64_t min_arg1_124548 = add64(i16_res_124433, lower_bound_124547);
            int64_t min_res_124549 = smin64(n_71526, min_arg1_124548);
            int64_t j_m_i_124550 = sub64(min_res_124549, lower_bound_124547);
            bool empty_slice_124551 = j_m_i_124550 == (int64_t) 0;
            int64_t m_124552 = sub64(j_m_i_124550, (int64_t) 1);
            int64_t i_p_m_t_s_124553 = add64(lower_bound_124547, m_124552);
            bool zzero_leq_i_p_m_t_s_124554 = sle64((int64_t) 0, i_p_m_t_s_124553);
            bool i_p_m_t_s_leq_w_124555 = slt64(i_p_m_t_s_124553, n_71526);
            bool zzero_lte_i_124556 = sle64((int64_t) 0, lower_bound_124547);
            bool i_lte_j_124557 = sle64(lower_bound_124547, min_res_124549);
            bool y_124558 = i_p_m_t_s_leq_w_124555 && zzero_lte_i_124556;
            bool y_124559 = zzero_leq_i_p_m_t_s_124554 && y_124558;
            bool forwards_ok_124560 = i_lte_j_124557 && y_124559;
            bool ok_or_empty_124561 = empty_slice_124551 || forwards_ok_124560;
            bool index_certs_124562;
            
            if (!ok_or_empty_124561) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_124547, ":", (long long) min_res_124549, "] out of bounds for array of shape [", (long long) n_71526, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:96:98-101\n   #4  ftRelational.fut:91:78-89\n   #5  ftRelational.fut:87:9-91:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133218 = (int64_t) 4 * j_m_i_124550;
            int64_t bytes_133220 = b_71527 * j_m_i_124550;
            
            if (mem_133219_cached_sizze_133940 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133940, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133208.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_124547, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124550});
            if (mem_133221_cached_sizze_133941 < bytes_133220) {
                err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133941, bytes_133220);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_71527, (int64_t) 1}, (uint8_t *) mem_133210.mem, (int64_t) 0 + b_71527 * lower_bound_124547, (int64_t []) {b_71527, (int64_t) 1}, (int64_t []) {j_m_i_124550, b_71527});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_71526; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133206.mem)[write_iter_133062];
                float write_iv_133066 = ((float *) mem_param_133181.mem)[write_iter_133062];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0 + write_iter_133062 * b_71527, (int64_t []) {(int64_t) 1}, (int64_t []) {b_71527});
                
                bool cond_129195 = sle64(lower_bound_124547, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_124549);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_124547);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124550)) {
                    ((float *) mem_133219)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_124550)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_71527 - (int64_t) 1, b_71527))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_133221, lifted_lambda_res_129198 * b_71527, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_71527});
                }
            }
            
            int64_t tmp_124574 = add64((int64_t) 1, p_124546);
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133208.mem, lower_bound_124547, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_124550});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, b_71527 * lower_bound_124547, (int64_t []) {b_71527, (int64_t) 1}, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_71527, (int64_t) 1}, (int64_t []) {j_m_i_124550, b_71527});
            
            bool loop_cond_124582 = slt64(tmp_124574, m_124457);
            bool loop_while_tmp_133528 = loop_cond_124582;
            int64_t p_tmp_133531 = tmp_124574;
            
            loop_while_124543 = loop_while_tmp_133528;
            p_124546 = p_tmp_133531;
        }
        partitioned_scatter_res_124539 = loop_while_124543;
        partitioned_scatter_res_124542 = p_124546;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133185, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133250, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133249, &mem_param_133185, "mem_param_133185") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133252, bytes_133251, "mem_133252")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133252.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133250.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_71526});
    if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133254, bytes_133253, "mem_133254")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133254.mem, (int64_t) 0, (int64_t []) {b_71527, (int64_t) 1}, (uint8_t *) ext_mem_133249.mem, (int64_t) 0, (int64_t []) {b_71527, (int64_t) 1}, (int64_t []) {n_71526, b_71527});
    if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133252, "mem_133252") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133254, "mem_133254") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133937, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133938, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133186);
        free(mem_133219);
        free(mem_133221);
        free(mem_133229);
        if (memblock_unref(ctx, &mem_133254, "mem_133254") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133252, "mem_133252") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133197, "mem_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133185, "mem_param_133185") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_133943, struct memblock *mem_out_p_133944, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_69692, int64_t b_69693, int16_t block_sizze_69694)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133186_cached_sizze_133945 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133219_cached_sizze_133946 = 0;
    unsigned char *mem_133219 = NULL;
    int64_t mem_133221_cached_sizze_133947 = 0;
    unsigned char *mem_133221 = NULL;
    int64_t mem_133229_cached_sizze_133948 = 0;
    unsigned char *mem_133229 = NULL;
    struct memblock mem_133254;
    
    mem_133254.references = NULL;
    
    struct memblock mem_133252;
    
    mem_133252.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_133208;
    
    mem_133208.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133197;
    
    mem_133197.references = NULL;
    
    struct memblock mem_param_133195;
    
    mem_param_133195.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock mem_param_133185;
    
    mem_param_133185.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133249;
    
    ext_mem_133249.references = NULL;
    
    struct memblock ext_mem_133250;
    
    ext_mem_133250.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_122620 = sext_i16_i64(block_sizze_69694);
    int64_t bytes_133177 = (int64_t) 8 * n_69692;
    bool zzero_122639 = i16_res_122620 == (int64_t) 0;
    bool nonzzero_122640 = !zzero_122639;
    bool nonzzero_cert_122643;
    
    if (!nonzzero_122640) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:81:81-92\n   #5  ftRelational.fut:77:9-81:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133251 = (int64_t) 4 * n_69692;
    int64_t bytes_133253 = n_69692 * b_69693;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_69692; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_122637 = add64(n_69692, i16_res_122620);
    int64_t zs_lhs_122638 = sub64(zm_lhs_122637, (int64_t) 1);
    int64_t m_122644 = sdiv_safe64(zs_lhs_122638, i16_res_122620);
    bool loop_cond_122645 = slt64((int64_t) 0, m_122644);
    
    if (mem_133186_cached_sizze_133945 < n_69692) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133945, n_69692);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133229_cached_sizze_133948 < b_69693) {
        err = lexical_realloc(ctx, &mem_133229, &mem_133229_cached_sizze_133948, b_69693);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &k_mem_133175, "k_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133185, &pL_mem_133176, "pL_mem_133176") != 0)
        return 1;
    for (int64_t i_122648 = 0; i_122648 < (int64_t) 16; i_122648++) {
        int32_t binop_x_122651 = sext_i64_i32(i_122648);
        int32_t binop_x_122652 = mul32(2, binop_x_122651);
        int32_t zm_lhs_122653 = add32(2, binop_x_122652);
        int32_t min_arg1_122654 = sub32(zm_lhs_122653, 1);
        int32_t min_res_122655 = smin32(32, min_arg1_122654);
        int32_t zp_lhs_122656 = sub32(min_res_122655, binop_x_122652);
        int32_t ij_bits_122657 = add32(1, zp_lhs_122656);
        int32_t up_to_122658 = shl32(1, ij_bits_122657);
        int64_t tmp_122659 = sext_i32_i64(zp_lhs_122656);
        bool bounds_invalid_upwards_122660 = slt32(zp_lhs_122656, 0);
        bool valid_122662 = !bounds_invalid_upwards_122660;
        bool range_valid_c_122663;
        
        if (!valid_122662) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122659, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:86:96-99\n   #5  ftRelational.fut:81:81-92\n   #6  ftRelational.fut:77:9-81:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_122676 = sext_i32_i64(up_to_122658);
        bool bounds_invalid_upwards_122677 = slt32(up_to_122658, 0);
        bool valid_122678 = !bounds_invalid_upwards_122677;
        bool range_valid_c_122679;
        
        if (!valid_122678) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122676, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:81:81-92\n   #5  ftRelational.fut:77:9-81:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_122661 = add64((int64_t) 1, tmp_122659);
        
        for (int64_t i_133042 = 0; i_133042 < n_69692; i_133042++) {
            int32_t eta_p_122665 = ((int32_t *) mem_param_133181.mem)[i_133042];
            int8_t defunc_0_f_res_122666;
            int8_t y_122668 = (int8_t) 0;
            
            for (int64_t i_122667 = 0; i_122667 < distance_122661; i_122667++) {
                int32_t binop_x_122669 = sext_i64_i32(i_122667);
                int32_t get_bit_arg0_122670 = add32(binop_x_122652, binop_x_122669);
                int32_t zgzg_res_127618 = ashr32(eta_p_122665, get_bit_arg0_122670);
                int32_t za_res_127619 = 1 & zgzg_res_127618;
                bool cond_122672 = get_bit_arg0_122670 == 31;
                int32_t defunc_0_get_bit_res_122673;
                
                if (cond_122672) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ za_res_127619;
                    
                    defunc_0_get_bit_res_122673 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_122673 = za_res_127619;
                }
                
                int8_t loopres_122675;
                
                if (futrts_set_bit_2464(ctx, &loopres_122675, binop_x_122669, y_122668, defunc_0_get_bit_res_122673) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_122675;
                
                y_122668 = y_tmp_133521;
            }
            defunc_0_f_res_122666 = y_122668;
            ((int8_t *) mem_133186)[i_133042] = defunc_0_f_res_122666;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_122680;
        int64_t offs_122683;
        
        if (memblock_set(ctx, &mem_param_133195, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_122683 = (int64_t) 0;
        for (int64_t i_122682 = 0; i_122682 < up_to_122676; i_122682++) {
            int32_t binop_x_122685 = sext_i64_i32(i_122682);
            int8_t index_primexp_122686 = zext_i32_i8(binop_x_122685);
            
            if (memblock_alloc(ctx, &mem_133197, bytes_133177, "mem_133197")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_69692; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133186)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_122686;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133195.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_122683, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133197.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_122711 = add64(offs_122683, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133197, "mem_133197") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_122711;
            
            if (memblock_set(ctx, &mem_param_133195, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_122683 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133206, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_122680 = offs_122683;
        if (memblock_alloc(ctx, &mem_133208, bytes_133251, "mem_133208")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_133208.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_69692});
        if (memblock_alloc(ctx, &mem_133210, bytes_133253, "mem_133210")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {b_69693, (int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0, (int64_t []) {b_69693, (int64_t) 1}, (int64_t []) {n_69692, b_69693});
        
        bool partitioned_scatter_res_122718;
        int64_t partitioned_scatter_res_122721;
        bool loop_while_122722;
        int64_t p_122725;
        
        loop_while_122722 = loop_cond_122645;
        p_122725 = (int64_t) 0;
        while (loop_while_122722) {
            int64_t lower_bound_122726 = mul64(i16_res_122620, p_122725);
            int64_t min_arg1_122727 = add64(i16_res_122620, lower_bound_122726);
            int64_t min_res_122728 = smin64(n_69692, min_arg1_122727);
            int64_t j_m_i_122729 = sub64(min_res_122728, lower_bound_122726);
            bool empty_slice_122730 = j_m_i_122729 == (int64_t) 0;
            int64_t m_122731 = sub64(j_m_i_122729, (int64_t) 1);
            int64_t i_p_m_t_s_122732 = add64(lower_bound_122726, m_122731);
            bool zzero_leq_i_p_m_t_s_122733 = sle64((int64_t) 0, i_p_m_t_s_122732);
            bool i_p_m_t_s_leq_w_122734 = slt64(i_p_m_t_s_122732, n_69692);
            bool zzero_lte_i_122735 = sle64((int64_t) 0, lower_bound_122726);
            bool i_lte_j_122736 = sle64(lower_bound_122726, min_res_122728);
            bool y_122737 = i_p_m_t_s_leq_w_122734 && zzero_lte_i_122735;
            bool y_122738 = zzero_leq_i_p_m_t_s_122733 && y_122737;
            bool forwards_ok_122739 = i_lte_j_122736 && y_122738;
            bool ok_or_empty_122740 = empty_slice_122730 || forwards_ok_122739;
            bool index_certs_122741;
            
            if (!ok_or_empty_122740) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122726, ":", (long long) min_res_122728, "] out of bounds for array of shape [", (long long) n_69692, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:81:81-92\n   #5  ftRelational.fut:77:9-81:93\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133218 = (int64_t) 4 * j_m_i_122729;
            int64_t bytes_133220 = b_69693 * j_m_i_122729;
            
            if (mem_133219_cached_sizze_133946 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133946, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133208.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122726, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122729});
            if (mem_133221_cached_sizze_133947 < bytes_133220) {
                err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133947, bytes_133220);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_69693, (int64_t) 1}, (uint8_t *) mem_133210.mem, (int64_t) 0 + b_69693 * lower_bound_122726, (int64_t []) {b_69693, (int64_t) 1}, (int64_t []) {j_m_i_122729, b_69693});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_69692; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133206.mem)[write_iter_133062];
                int32_t write_iv_133066 = ((int32_t *) mem_param_133181.mem)[write_iter_133062];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0 + write_iter_133062 * b_69693, (int64_t []) {(int64_t) 1}, (int64_t []) {b_69693});
                
                bool cond_129195 = sle64(lower_bound_122726, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_122728);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_122726);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122729)) {
                    ((int32_t *) mem_133219)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122729)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_69693 - (int64_t) 1, b_69693))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_133221, lifted_lambda_res_129198 * b_69693, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_69693});
                }
            }
            
            int64_t tmp_122753 = add64((int64_t) 1, p_122725);
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_133208.mem, lower_bound_122726, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122729});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, b_69693 * lower_bound_122726, (int64_t []) {b_69693, (int64_t) 1}, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_69693, (int64_t) 1}, (int64_t []) {j_m_i_122729, b_69693});
            
            bool loop_cond_122761 = slt64(tmp_122753, m_122644);
            bool loop_while_tmp_133528 = loop_cond_122761;
            int64_t p_tmp_133531 = tmp_122753;
            
            loop_while_122722 = loop_while_tmp_133528;
            p_122725 = p_tmp_133531;
        }
        partitioned_scatter_res_122718 = loop_while_122722;
        partitioned_scatter_res_122721 = p_122725;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133185, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133250, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133249, &mem_param_133185, "mem_param_133185") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133252, bytes_133251, "mem_133252")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_133252.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_133250.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_69692});
    if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133254, bytes_133253, "mem_133254")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133254.mem, (int64_t) 0, (int64_t []) {b_69693, (int64_t) 1}, (uint8_t *) ext_mem_133249.mem, (int64_t) 0, (int64_t []) {b_69693, (int64_t) 1}, (int64_t []) {n_69692, b_69693});
    if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133252, "mem_133252") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133254, "mem_133254") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133943, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133944, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133186);
        free(mem_133219);
        free(mem_133221);
        free(mem_133229);
        if (memblock_unref(ctx, &mem_133254, "mem_133254") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133252, "mem_133252") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133197, "mem_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133185, "mem_param_133185") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_133949, struct memblock *mem_out_p_133950, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_70580, int64_t b_70581, int16_t block_sizze_70582)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133186_cached_sizze_133951 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133219_cached_sizze_133952 = 0;
    unsigned char *mem_133219 = NULL;
    int64_t mem_133221_cached_sizze_133953 = 0;
    unsigned char *mem_133221 = NULL;
    int64_t mem_133229_cached_sizze_133954 = 0;
    unsigned char *mem_133229 = NULL;
    struct memblock mem_133254;
    
    mem_133254.references = NULL;
    
    struct memblock mem_133252;
    
    mem_133252.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_133208;
    
    mem_133208.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133197;
    
    mem_133197.references = NULL;
    
    struct memblock mem_param_133195;
    
    mem_param_133195.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock mem_param_133185;
    
    mem_param_133185.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133249;
    
    ext_mem_133249.references = NULL;
    
    struct memblock ext_mem_133250;
    
    ext_mem_133250.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_122620 = sext_i16_i64(block_sizze_70582);
    int64_t bytes_133177 = (int64_t) 8 * n_70580;
    bool zzero_122639 = i16_res_122620 == (int64_t) 0;
    bool nonzzero_122640 = !zzero_122639;
    bool nonzzero_cert_122643;
    
    if (!nonzzero_122640) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:86:81-92\n   #5  ftRelational.fut:82:9-86:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133253 = n_70580 * b_70581;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_70580; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_122637 = add64(n_70580, i16_res_122620);
    int64_t zs_lhs_122638 = sub64(zm_lhs_122637, (int64_t) 1);
    int64_t m_122644 = sdiv_safe64(zs_lhs_122638, i16_res_122620);
    bool loop_cond_122645 = slt64((int64_t) 0, m_122644);
    
    if (mem_133186_cached_sizze_133951 < n_70580) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133951, n_70580);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133229_cached_sizze_133954 < b_70581) {
        err = lexical_realloc(ctx, &mem_133229, &mem_133229_cached_sizze_133954, b_70581);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &k_mem_133175, "k_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133185, &pL_mem_133176, "pL_mem_133176") != 0)
        return 1;
    for (int64_t i_122648 = 0; i_122648 < (int64_t) 32; i_122648++) {
        int32_t binop_x_122651 = sext_i64_i32(i_122648);
        int32_t binop_x_122652 = mul32(2, binop_x_122651);
        int32_t zm_lhs_122653 = add32(2, binop_x_122652);
        int32_t min_arg1_122654 = sub32(zm_lhs_122653, 1);
        int32_t min_res_122655 = smin32(64, min_arg1_122654);
        int32_t zp_lhs_122656 = sub32(min_res_122655, binop_x_122652);
        int32_t ij_bits_122657 = add32(1, zp_lhs_122656);
        int32_t up_to_122658 = shl32(1, ij_bits_122657);
        int64_t tmp_122659 = sext_i32_i64(zp_lhs_122656);
        bool bounds_invalid_upwards_122660 = slt32(zp_lhs_122656, 0);
        bool valid_122662 = !bounds_invalid_upwards_122660;
        bool range_valid_c_122663;
        
        if (!valid_122662) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122659, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:86:96-99\n   #5  ftRelational.fut:86:81-92\n   #6  ftRelational.fut:82:9-86:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_122676 = sext_i32_i64(up_to_122658);
        bool bounds_invalid_upwards_122677 = slt32(up_to_122658, 0);
        bool valid_122678 = !bounds_invalid_upwards_122677;
        bool range_valid_c_122679;
        
        if (!valid_122678) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122676, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:86:81-92\n   #5  ftRelational.fut:82:9-86:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_122661 = add64((int64_t) 1, tmp_122659);
        
        for (int64_t i_133042 = 0; i_133042 < n_70580; i_133042++) {
            int64_t eta_p_122665 = ((int64_t *) mem_param_133181.mem)[i_133042];
            int8_t defunc_0_f_res_122666;
            int8_t y_122668 = (int8_t) 0;
            
            for (int64_t i_122667 = 0; i_122667 < distance_122661; i_122667++) {
                int32_t binop_x_122669 = sext_i64_i32(i_122667);
                int32_t get_bit_arg0_122670 = add32(binop_x_122652, binop_x_122669);
                int32_t defunc_0_get_bit_res_122671;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_122671, get_bit_arg0_122670, eta_p_122665) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_122672 = get_bit_arg0_122670 == 63;
                int32_t defunc_0_get_bit_res_122673;
                
                if (cond_122672) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ defunc_0_get_bit_res_122671;
                    
                    defunc_0_get_bit_res_122673 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_122673 = defunc_0_get_bit_res_122671;
                }
                
                int8_t loopres_122675;
                
                if (futrts_set_bit_2464(ctx, &loopres_122675, binop_x_122669, y_122668, defunc_0_get_bit_res_122673) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_122675;
                
                y_122668 = y_tmp_133521;
            }
            defunc_0_f_res_122666 = y_122668;
            ((int8_t *) mem_133186)[i_133042] = defunc_0_f_res_122666;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_122680;
        int64_t offs_122683;
        
        if (memblock_set(ctx, &mem_param_133195, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_122683 = (int64_t) 0;
        for (int64_t i_122682 = 0; i_122682 < up_to_122676; i_122682++) {
            int32_t binop_x_122685 = sext_i64_i32(i_122682);
            int8_t index_primexp_122686 = zext_i32_i8(binop_x_122685);
            
            if (memblock_alloc(ctx, &mem_133197, bytes_133177, "mem_133197")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_70580; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133186)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_122686;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133195.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_122683, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133197.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_122711 = add64(offs_122683, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133197, "mem_133197") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_122711;
            
            if (memblock_set(ctx, &mem_param_133195, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_122683 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133206, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_122680 = offs_122683;
        if (memblock_alloc(ctx, &mem_133208, bytes_133177, "mem_133208")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133208.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_70580});
        if (memblock_alloc(ctx, &mem_133210, bytes_133253, "mem_133210")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {b_70581, (int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0, (int64_t []) {b_70581, (int64_t) 1}, (int64_t []) {n_70580, b_70581});
        
        bool partitioned_scatter_res_122718;
        int64_t partitioned_scatter_res_122721;
        bool loop_while_122722;
        int64_t p_122725;
        
        loop_while_122722 = loop_cond_122645;
        p_122725 = (int64_t) 0;
        while (loop_while_122722) {
            int64_t lower_bound_122726 = mul64(i16_res_122620, p_122725);
            int64_t min_arg1_122727 = add64(i16_res_122620, lower_bound_122726);
            int64_t min_res_122728 = smin64(n_70580, min_arg1_122727);
            int64_t j_m_i_122729 = sub64(min_res_122728, lower_bound_122726);
            bool empty_slice_122730 = j_m_i_122729 == (int64_t) 0;
            int64_t m_122731 = sub64(j_m_i_122729, (int64_t) 1);
            int64_t i_p_m_t_s_122732 = add64(lower_bound_122726, m_122731);
            bool zzero_leq_i_p_m_t_s_122733 = sle64((int64_t) 0, i_p_m_t_s_122732);
            bool i_p_m_t_s_leq_w_122734 = slt64(i_p_m_t_s_122732, n_70580);
            bool zzero_lte_i_122735 = sle64((int64_t) 0, lower_bound_122726);
            bool i_lte_j_122736 = sle64(lower_bound_122726, min_res_122728);
            bool y_122737 = i_p_m_t_s_leq_w_122734 && zzero_lte_i_122735;
            bool y_122738 = zzero_leq_i_p_m_t_s_122733 && y_122737;
            bool forwards_ok_122739 = i_lte_j_122736 && y_122738;
            bool ok_or_empty_122740 = empty_slice_122730 || forwards_ok_122739;
            bool index_certs_122741;
            
            if (!ok_or_empty_122740) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122726, ":", (long long) min_res_122728, "] out of bounds for array of shape [", (long long) n_70580, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:86:81-92\n   #5  ftRelational.fut:82:9-86:93\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133218 = (int64_t) 8 * j_m_i_122729;
            int64_t bytes_133220 = b_70581 * j_m_i_122729;
            
            if (mem_133219_cached_sizze_133952 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133952, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133208.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122726, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122729});
            if (mem_133221_cached_sizze_133953 < bytes_133220) {
                err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133953, bytes_133220);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_70581, (int64_t) 1}, (uint8_t *) mem_133210.mem, (int64_t) 0 + b_70581 * lower_bound_122726, (int64_t []) {b_70581, (int64_t) 1}, (int64_t []) {j_m_i_122729, b_70581});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_70580; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133206.mem)[write_iter_133062];
                int64_t write_iv_133066 = ((int64_t *) mem_param_133181.mem)[write_iter_133062];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0 + write_iter_133062 * b_70581, (int64_t []) {(int64_t) 1}, (int64_t []) {b_70581});
                
                bool cond_129195 = sle64(lower_bound_122726, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_122728);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_122726);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122729)) {
                    ((int64_t *) mem_133219)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122729)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_70581 - (int64_t) 1, b_70581))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_133221, lifted_lambda_res_129198 * b_70581, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_70581});
                }
            }
            
            int64_t tmp_122753 = add64((int64_t) 1, p_122725);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_133208.mem, lower_bound_122726, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122729});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, b_70581 * lower_bound_122726, (int64_t []) {b_70581, (int64_t) 1}, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_70581, (int64_t) 1}, (int64_t []) {j_m_i_122729, b_70581});
            
            bool loop_cond_122761 = slt64(tmp_122753, m_122644);
            bool loop_while_tmp_133528 = loop_cond_122761;
            int64_t p_tmp_133531 = tmp_122753;
            
            loop_while_122722 = loop_while_tmp_133528;
            p_122725 = p_tmp_133531;
        }
        partitioned_scatter_res_122718 = loop_while_122722;
        partitioned_scatter_res_122721 = p_122725;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133185, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133250, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133249, &mem_param_133185, "mem_param_133185") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133252, bytes_133177, "mem_133252")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133252.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_133250.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_70580});
    if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133254, bytes_133253, "mem_133254")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133254.mem, (int64_t) 0, (int64_t []) {b_70581, (int64_t) 1}, (uint8_t *) ext_mem_133249.mem, (int64_t) 0, (int64_t []) {b_70581, (int64_t) 1}, (int64_t []) {n_70580, b_70581});
    if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133252, "mem_133252") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133254, "mem_133254") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133949, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133950, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133186);
        free(mem_133219);
        free(mem_133221);
        free(mem_133229);
        if (memblock_unref(ctx, &mem_133254, "mem_133254") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133252, "mem_133252") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133197, "mem_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133185, "mem_param_133185") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_133955, struct memblock *mem_out_p_133956, struct memblock k_mem_133175, struct memblock pL_mem_133176, int64_t n_68798, int64_t b_68799, int16_t block_sizze_68800)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133186_cached_sizze_133957 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133219_cached_sizze_133958 = 0;
    unsigned char *mem_133219 = NULL;
    int64_t mem_133221_cached_sizze_133959 = 0;
    unsigned char *mem_133221 = NULL;
    int64_t mem_133229_cached_sizze_133960 = 0;
    unsigned char *mem_133229 = NULL;
    struct memblock mem_133254;
    
    mem_133254.references = NULL;
    
    struct memblock mem_133252;
    
    mem_133252.references = NULL;
    
    struct memblock mem_param_tmp_133517;
    
    mem_param_tmp_133517.references = NULL;
    
    struct memblock mem_param_tmp_133516;
    
    mem_param_tmp_133516.references = NULL;
    
    struct memblock mem_133210;
    
    mem_133210.references = NULL;
    
    struct memblock mem_133208;
    
    mem_133208.references = NULL;
    
    struct memblock mem_param_tmp_133522;
    
    mem_param_tmp_133522.references = NULL;
    
    struct memblock mem_133197;
    
    mem_133197.references = NULL;
    
    struct memblock mem_param_133195;
    
    mem_param_133195.references = NULL;
    
    struct memblock ext_mem_133206;
    
    ext_mem_133206.references = NULL;
    
    struct memblock mem_param_133185;
    
    mem_param_133185.references = NULL;
    
    struct memblock mem_param_133181;
    
    mem_param_133181.references = NULL;
    
    struct memblock ext_mem_133249;
    
    ext_mem_133249.references = NULL;
    
    struct memblock ext_mem_133250;
    
    ext_mem_133250.references = NULL;
    
    struct memblock mem_133178;
    
    mem_133178.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t i16_res_122620 = sext_i16_i64(block_sizze_68800);
    int64_t bytes_133177 = (int64_t) 8 * n_68798;
    bool zzero_122639 = i16_res_122620 == (int64_t) 0;
    bool nonzzero_122640 = !zzero_122639;
    bool nonzzero_cert_122643;
    
    if (!nonzzero_122640) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:76:81-92\n   #5  ftRelational.fut:72:9-76:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133251 = (int64_t) 2 * n_68798;
    int64_t bytes_133253 = n_68798 * b_68799;
    
    if (memblock_alloc(ctx, &mem_133178, bytes_133177, "mem_133178")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133515 = 0; nest_i_133515 < n_68798; nest_i_133515++) {
        ((int64_t *) mem_133178.mem)[nest_i_133515] = (int64_t) 0;
    }
    
    int64_t zm_lhs_122637 = add64(n_68798, i16_res_122620);
    int64_t zs_lhs_122638 = sub64(zm_lhs_122637, (int64_t) 1);
    int64_t m_122644 = sdiv_safe64(zs_lhs_122638, i16_res_122620);
    bool loop_cond_122645 = slt64((int64_t) 0, m_122644);
    
    if (mem_133186_cached_sizze_133957 < n_68798) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133957, n_68798);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133229_cached_sizze_133960 < b_68799) {
        err = lexical_realloc(ctx, &mem_133229, &mem_133229_cached_sizze_133960, b_68799);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_133181, &k_mem_133175, "k_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_133185, &pL_mem_133176, "pL_mem_133176") != 0)
        return 1;
    for (int64_t i_122648 = 0; i_122648 < (int64_t) 8; i_122648++) {
        int32_t binop_x_122651 = sext_i64_i32(i_122648);
        int32_t binop_x_122652 = mul32(2, binop_x_122651);
        int32_t zm_lhs_122653 = add32(2, binop_x_122652);
        int32_t min_arg1_122654 = sub32(zm_lhs_122653, 1);
        int32_t min_res_122655 = smin32(16, min_arg1_122654);
        int32_t zp_lhs_122656 = sub32(min_res_122655, binop_x_122652);
        int32_t ij_bits_122657 = add32(1, zp_lhs_122656);
        int32_t up_to_122658 = shl32(1, ij_bits_122657);
        int64_t tmp_122659 = sext_i32_i64(zp_lhs_122656);
        bool bounds_invalid_upwards_122660 = slt32(zp_lhs_122656, 0);
        bool valid_122662 = !bounds_invalid_upwards_122660;
        bool range_valid_c_122663;
        
        if (!valid_122662) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_122659, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:86:96-99\n   #5  ftRelational.fut:76:81-92\n   #6  ftRelational.fut:72:9-76:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_122676 = sext_i32_i64(up_to_122658);
        bool bounds_invalid_upwards_122677 = slt32(up_to_122658, 0);
        bool valid_122678 = !bounds_invalid_upwards_122677;
        bool range_valid_c_122679;
        
        if (!valid_122678) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_122676, " is invalid.", "-> #0  ftbasics.fut:171:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:76:81-92\n   #5  ftRelational.fut:72:9-76:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_122661 = add64((int64_t) 1, tmp_122659);
        
        for (int64_t i_133042 = 0; i_133042 < n_68798; i_133042++) {
            int16_t eta_p_122665 = ((int16_t *) mem_param_133181.mem)[i_133042];
            int8_t defunc_0_f_res_122666;
            int8_t y_122668 = (int8_t) 0;
            
            for (int64_t i_122667 = 0; i_122667 < distance_122661; i_122667++) {
                int32_t binop_x_122669 = sext_i64_i32(i_122667);
                int32_t get_bit_arg0_122670 = add32(binop_x_122652, binop_x_122669);
                int32_t defunc_0_get_bit_res_122671;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_122671, get_bit_arg0_122670, eta_p_122665) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_122672 = get_bit_arg0_122670 == 15;
                int32_t defunc_0_get_bit_res_122673;
                
                if (cond_122672) {
                    int32_t defunc_0_get_bit_res_t_res_129217 = 1 ^ defunc_0_get_bit_res_122671;
                    
                    defunc_0_get_bit_res_122673 = defunc_0_get_bit_res_t_res_129217;
                } else {
                    defunc_0_get_bit_res_122673 = defunc_0_get_bit_res_122671;
                }
                
                int8_t loopres_122675;
                
                if (futrts_set_bit_2464(ctx, &loopres_122675, binop_x_122669, y_122668, defunc_0_get_bit_res_122673) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_133521 = loopres_122675;
                
                y_122668 = y_tmp_133521;
            }
            defunc_0_f_res_122666 = y_122668;
            ((int8_t *) mem_133186)[i_133042] = defunc_0_f_res_122666;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_122680;
        int64_t offs_122683;
        
        if (memblock_set(ctx, &mem_param_133195, &mem_133178, "mem_133178") != 0)
            return 1;
        offs_122683 = (int64_t) 0;
        for (int64_t i_122682 = 0; i_122682 < up_to_122676; i_122682++) {
            int32_t binop_x_122685 = sext_i64_i32(i_122682);
            int8_t index_primexp_122686 = zext_i32_i8(binop_x_122685);
            
            if (memblock_alloc(ctx, &mem_133197, bytes_133177, "mem_133197")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_129222;
            int64_t defunc_0_reduce_res_129223;
            int64_t inpacc_129103;
            int64_t inpacc_129104;
            
            inpacc_129103 = (int64_t) 0;
            inpacc_129104 = (int64_t) 0;
            for (int64_t i_133060 = 0; i_133060 < n_68798; i_133060++) {
                int8_t eta_p_133151 = ((int8_t *) mem_133186)[i_133060];
                bool lifted_lambda_res_133152 = eta_p_133151 == index_primexp_122686;
                int64_t bool_res_133153 = btoi_bool_i64(lifted_lambda_res_133152);
                int64_t eta_p_133166 = ((int64_t *) mem_param_133195.mem)[i_133060];
                int64_t defunc_0_op_res_133167 = add64(inpacc_129103, bool_res_133153);
                int64_t zm_lhs_133168 = add64(offs_122683, defunc_0_op_res_133167);
                int64_t lifted_lambda_res_133169 = sub64(zm_lhs_133168, (int64_t) 1);
                int64_t defunc_0_f_res_133170 = mul64(bool_res_133153, lifted_lambda_res_133169);
                int64_t defunc_0_f_res_133171 = add64(eta_p_133166, defunc_0_f_res_133170);
                int64_t defunc_0_op_res_129152 = add64(inpacc_129104, bool_res_133153);
                
                ((int64_t *) mem_133197.mem)[i_133060] = defunc_0_f_res_133171;
                
                int64_t inpacc_tmp_133525 = defunc_0_op_res_133167;
                int64_t inpacc_tmp_133526 = defunc_0_op_res_129152;
                
                inpacc_129103 = inpacc_tmp_133525;
                inpacc_129104 = inpacc_tmp_133526;
            }
            inpacc_129222 = inpacc_129103;
            defunc_0_reduce_res_129223 = inpacc_129104;
            
            int64_t tmp_122711 = add64(offs_122683, defunc_0_reduce_res_129223);
            
            if (memblock_set(ctx, &mem_param_tmp_133522, &mem_133197, "mem_133197") != 0)
                return 1;
            
            int64_t offs_tmp_133523 = tmp_122711;
            
            if (memblock_set(ctx, &mem_param_133195, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
                return 1;
            offs_122683 = offs_tmp_133523;
        }
        if (memblock_set(ctx, &ext_mem_133206, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_122680 = offs_122683;
        if (memblock_alloc(ctx, &mem_133208, bytes_133251, "mem_133208")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_133208.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_133181.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_68798});
        if (memblock_alloc(ctx, &mem_133210, bytes_133253, "mem_133210")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, (int64_t) 0, (int64_t []) {b_68799, (int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0, (int64_t []) {b_68799, (int64_t) 1}, (int64_t []) {n_68798, b_68799});
        
        bool partitioned_scatter_res_122718;
        int64_t partitioned_scatter_res_122721;
        bool loop_while_122722;
        int64_t p_122725;
        
        loop_while_122722 = loop_cond_122645;
        p_122725 = (int64_t) 0;
        while (loop_while_122722) {
            int64_t lower_bound_122726 = mul64(i16_res_122620, p_122725);
            int64_t min_arg1_122727 = add64(i16_res_122620, lower_bound_122726);
            int64_t min_res_122728 = smin64(n_68798, min_arg1_122727);
            int64_t j_m_i_122729 = sub64(min_res_122728, lower_bound_122726);
            bool empty_slice_122730 = j_m_i_122729 == (int64_t) 0;
            int64_t m_122731 = sub64(j_m_i_122729, (int64_t) 1);
            int64_t i_p_m_t_s_122732 = add64(lower_bound_122726, m_122731);
            bool zzero_leq_i_p_m_t_s_122733 = sle64((int64_t) 0, i_p_m_t_s_122732);
            bool i_p_m_t_s_leq_w_122734 = slt64(i_p_m_t_s_122732, n_68798);
            bool zzero_lte_i_122735 = sle64((int64_t) 0, lower_bound_122726);
            bool i_lte_j_122736 = sle64(lower_bound_122726, min_res_122728);
            bool y_122737 = i_p_m_t_s_leq_w_122734 && zzero_lte_i_122735;
            bool y_122738 = zzero_leq_i_p_m_t_s_122733 && y_122737;
            bool forwards_ok_122739 = i_lte_j_122736 && y_122738;
            bool ok_or_empty_122740 = empty_slice_122730 || forwards_ok_122739;
            bool index_certs_122741;
            
            if (!ok_or_empty_122740) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_122726, ":", (long long) min_res_122728, "] out of bounds for array of shape [", (long long) n_68798, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:86:96-99\n   #4  ftRelational.fut:76:81-92\n   #5  ftRelational.fut:72:9-76:93\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_133218 = (int64_t) 2 * j_m_i_122729;
            int64_t bytes_133220 = b_68799 * j_m_i_122729;
            
            if (mem_133219_cached_sizze_133958 < bytes_133218) {
                err = lexical_realloc(ctx, &mem_133219, &mem_133219_cached_sizze_133958, bytes_133218);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_133208.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_122726, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122729});
            if (mem_133221_cached_sizze_133959 < bytes_133220) {
                err = lexical_realloc(ctx, &mem_133221, &mem_133221_cached_sizze_133959, bytes_133220);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_68799, (int64_t) 1}, (uint8_t *) mem_133210.mem, (int64_t) 0 + b_68799 * lower_bound_122726, (int64_t []) {b_68799, (int64_t) 1}, (int64_t []) {j_m_i_122729, b_68799});
            for (int64_t write_iter_133062 = 0; write_iter_133062 < n_68798; write_iter_133062++) {
                int64_t write_iv_133065 = ((int64_t *) ext_mem_133206.mem)[write_iter_133062];
                int16_t write_iv_133066 = ((int16_t *) mem_param_133181.mem)[write_iter_133062];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_133185.mem, (int64_t) 0 + write_iter_133062 * b_68799, (int64_t []) {(int64_t) 1}, (int64_t []) {b_68799});
                
                bool cond_129195 = sle64(lower_bound_122726, write_iv_133065);
                bool cond_t_res_129196 = slt64(write_iv_133065, min_res_122728);
                bool x_129197 = cond_129195 && cond_t_res_129196;
                int64_t lifted_lambda_res_129198;
                
                if (x_129197) {
                    int64_t lifted_lambda_res_t_res_129225 = sub64(write_iv_133065, lower_bound_122726);
                    
                    lifted_lambda_res_129198 = lifted_lambda_res_t_res_129225;
                } else {
                    lifted_lambda_res_129198 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122729)) {
                    ((int16_t *) mem_133219)[lifted_lambda_res_129198] = write_iv_133066;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_129198) && slt64(lifted_lambda_res_129198, j_m_i_122729)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_68799 - (int64_t) 1, b_68799))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_133221, lifted_lambda_res_129198 * b_68799, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_133229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_68799});
                }
            }
            
            int64_t tmp_122753 = add64((int64_t) 1, p_122725);
            
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_133208.mem, lower_bound_122726, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_133219, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_122729});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_133210.mem, b_68799 * lower_bound_122726, (int64_t []) {b_68799, (int64_t) 1}, (uint8_t *) mem_133221, (int64_t) 0, (int64_t []) {b_68799, (int64_t) 1}, (int64_t []) {j_m_i_122729, b_68799});
            
            bool loop_cond_122761 = slt64(tmp_122753, m_122644);
            bool loop_while_tmp_133528 = loop_cond_122761;
            int64_t p_tmp_133531 = tmp_122753;
            
            loop_while_122722 = loop_while_tmp_133528;
            p_122725 = p_tmp_133531;
        }
        partitioned_scatter_res_122718 = loop_while_122722;
        partitioned_scatter_res_122721 = p_122725;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133516, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_133517, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133181, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_133185, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_133250, &mem_param_133181, "mem_param_133181") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_133249, &mem_param_133185, "mem_param_133185") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133252, bytes_133251, "mem_133252")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_133252.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_133250.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_68798});
    if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_133254, bytes_133253, "mem_133254")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_133254.mem, (int64_t) 0, (int64_t []) {b_68799, (int64_t) 1}, (uint8_t *) ext_mem_133249.mem, (int64_t) 0, (int64_t []) {b_68799, (int64_t) 1}, (int64_t []) {n_68798, b_68799});
    if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133513, &mem_133252, "mem_133252") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133254, "mem_133254") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133955, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133956, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133186);
        free(mem_133219);
        free(mem_133221);
        free(mem_133229);
        if (memblock_unref(ctx, &mem_133254, "mem_133254") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133252, "mem_133252") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133517, "mem_param_tmp_133517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133516, "mem_param_tmp_133516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133210, "mem_133210") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133208, "mem_133208") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_133522, "mem_param_tmp_133522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133197, "mem_133197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133195, "mem_param_133195") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133206, "ext_mem_133206") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133185, "mem_param_133185") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_133181, "mem_param_133181") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133249, "ext_mem_133249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_133250, "ext_mem_133250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133178, "mem_133178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_11872(struct futhark_context *ctx, struct memblock *mem_out_p_133961, struct memblock *mem_out_p_133962, int64_t *out_prim_out_133963, int64_t *out_prim_out_133964, int32_t *out_prim_out_133965, struct memblock pXs_mem_133175, int64_t n_112609, int64_t b_112610, int32_t curDepth_112611, int32_t i_112613, int32_t j_112614)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133177_cached_sizze_133966 = 0;
    unsigned char *mem_133177 = NULL;
    int64_t mem_133179_cached_sizze_133967 = 0;
    unsigned char *mem_133179 = NULL;
    int64_t mem_133186_cached_sizze_133968 = 0;
    unsigned char *mem_133186 = NULL;
    int64_t mem_133187_cached_sizze_133969 = 0;
    unsigned char *mem_133187 = NULL;
    int64_t mem_133207_cached_sizze_133970 = 0;
    unsigned char *mem_133207 = NULL;
    struct memblock mem_133218;
    
    mem_133218.references = NULL;
    
    struct memblock mem_133216;
    
    mem_133216.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t prim_out_133515;
    int64_t prim_out_133516;
    int32_t prim_out_133517;
    int64_t dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615 = sub64(n_112609, (int64_t) 1);
    bool bounds_invalid_upwards_112619 = slt64(n_112609, (int64_t) 1);
    bool valid_112624 = !bounds_invalid_upwards_112619;
    bool range_valid_c_112625;
    
    if (!valid_112624) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) n_112609, " is invalid.", "-> #0  ftHashJoin.fut:231:23-28\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_127634 = mul64((int64_t) 8, b_112610);
    int64_t min_arg1_127635 = sub64(zm_lhs_127634, (int64_t) 1);
    int32_t i64_res_127620 = sext_i64_i32(b_112610);
    int32_t zm_lhs_127621 = mul32(8, i64_res_127620);
    int32_t min_arg1_127622 = sub32(zm_lhs_127621, 1);
    int32_t min_res_127623 = smin32(j_112614, min_arg1_127622);
    int32_t zm_rhs_127630 = sdiv32(min_res_127623, 8);
    int32_t zm_lhs_127631 = sub32(i64_res_127620, zm_rhs_127630);
    int32_t i32_arg0_127632 = sub32(zm_lhs_127631, 1);
    int64_t i32_res_127633 = sext_i32_i64(i32_arg0_127632);
    int64_t min_res_127636 = smin64(i32_res_127633, min_arg1_127635);
    bool y_127665 = slt64(min_res_127636, b_112610);
    bool x_127664 = sle64((int64_t) 0, min_res_127636);
    bool bounds_check_127666 = x_127664 && y_127665;
    bool index_certs_127667;
    
    if (!bounds_check_127666) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_127636, "] out of bounds for array of shape [", (long long) b_112610, "].", "-> #0  ftHashJoin.fut:33:38-54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_rhs_127625 = sdiv32(i_112613, 8);
    int32_t zm_lhs_127626 = sub32(i64_res_127620, zm_rhs_127625);
    int32_t i32_arg0_127627 = sub32(zm_lhs_127626, 1);
    int64_t i32_res_127628 = sext_i32_i64(i32_arg0_127627);
    bool y_127654 = slt64(i32_res_127628, b_112610);
    bool x_127653 = sle64((int64_t) 0, i32_res_127628);
    bool bounds_check_127655 = x_127653 && y_127654;
    bool index_certs_127656;
    
    if (!bounds_check_127655) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_127628, "] out of bounds for array of shape [", (long long) b_112610, "].", "-> #0  ftHashJoin.fut:32:48-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t lastBit_127638 = smod32(min_res_127623, 8);
    int32_t zm_lhs_127641 = sub32(8, lastBit_127638);
    int32_t i32_arg0_127642 = sub32(zm_lhs_127641, 1);
    int8_t unsign_arg0_127643 = zext_i32_i8(i32_arg0_127642);
    int8_t unsign_arg0_127644 = lshr8((int8_t) -1, unsign_arg0_127643);
    int32_t firstBit_127637 = smod32(i_112613, 8);
    int8_t unsign_arg0_127639 = zext_i32_i8(firstBit_127637);
    int8_t first_bitMask_127640 = shl8((int8_t) -1, unsign_arg0_127639);
    int64_t bytes_133176 = (int64_t) 8 * dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615;
    
    if (mem_133177_cached_sizze_133966 < bytes_133176) {
        err = lexical_realloc(ctx, &mem_133177, &mem_133177_cached_sizze_133966, bytes_133176);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133179_cached_sizze_133967 < bytes_133176) {
        err = lexical_realloc(ctx, &mem_133179, &mem_133179_cached_sizze_133967, bytes_133176);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133186_cached_sizze_133968 < b_112610) {
        err = lexical_realloc(ctx, &mem_133186, &mem_133186_cached_sizze_133968, b_112610);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_133187_cached_sizze_133969 < b_112610) {
        err = lexical_realloc(ctx, &mem_133187, &mem_133187_cached_sizze_133969, b_112610);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_133057;
    int64_t scanacc_133051 = (int64_t) 0;
    
    for (int64_t i_133054 = 0; i_133054 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615; i_133054++) {
        int64_t index_primexp_133151 = add64((int64_t) 1, i_133054);
        bool x_128976 = sle64((int64_t) 0, index_primexp_133151);
        bool y_128977 = slt64(index_primexp_133151, n_112609);
        bool bounds_check_128978 = x_128976 && y_128977;
        bool index_certs_128979;
        
        if (!bounds_check_128978) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) index_primexp_133151, "] out of bounds for array of shape [", (long long) n_112609, "].", "-> #0  ftHashJoin.fut:232:22-30\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:232:8-44\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_128983 = slt64(i_133054, n_112609);
        bool index_certs_128985;
        
        if (!y_128983) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_133054, "] out of bounds for array of shape [", (long long) n_112609, "].", "-> #0  ftHashJoin.fut:232:32-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:232:8-44\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_133044 = 0; i_133044 < b_112610; i_133044++) {
            int8_t eta_p_129037 = ((int8_t *) pXs_mem_133175.mem)[index_primexp_133151 * b_112610 + i_133044];
            int8_t eta_p_129038 = ((int8_t *) pXs_mem_133175.mem)[i_133054 * b_112610 + i_133044];
            bool cond_129040 = sle64(i_133044, i32_res_127628);
            bool cond_t_res_129041 = sle64(min_res_127636, i_133044);
            bool x_129042 = cond_129040 && cond_t_res_129041;
            int8_t lifted_lambda_res_129043;
            
            if (x_129042) {
                lifted_lambda_res_129043 = eta_p_129037;
            } else {
                lifted_lambda_res_129043 = (int8_t) 0;
            }
            
            int8_t lifted_lambda_res_129048;
            
            if (x_129042) {
                lifted_lambda_res_129048 = eta_p_129038;
            } else {
                lifted_lambda_res_129048 = (int8_t) 0;
            }
            ((int8_t *) mem_133186)[i_133044] = lifted_lambda_res_129048;
            ((int8_t *) mem_133187)[i_133044] = lifted_lambda_res_129043;
        }
        
        int8_t za_lhs_128996 = ((int8_t *) mem_133187)[i32_res_127628];
        int8_t mod1_x_128997 = first_bitMask_127640 & za_lhs_128996;
        
        ((int8_t *) mem_133187)[i32_res_127628] = mod1_x_128997;
        
        int8_t za_lhs_128999 = ((int8_t *) mem_133187)[min_res_127636];
        int8_t tmp_129000 = unsign_arg0_127644 & za_lhs_128999;
        
        ((int8_t *) mem_133187)[min_res_127636] = tmp_129000;
        
        int8_t za_lhs_129009 = ((int8_t *) mem_133186)[i32_res_127628];
        int8_t mod1_x_129010 = first_bitMask_127640 & za_lhs_129009;
        
        ((int8_t *) mem_133186)[i32_res_127628] = mod1_x_129010;
        
        int8_t za_lhs_129012 = ((int8_t *) mem_133186)[min_res_127636];
        int8_t tmp_129013 = unsign_arg0_127644 & za_lhs_129012;
        
        ((int8_t *) mem_133186)[min_res_127636] = tmp_129013;
        
        bool defunc_0_reduce_res_129060;
        bool redout_133047 = 0;
        
        for (int64_t i_133048 = 0; i_133048 < b_112610; i_133048++) {
            int8_t eta_p_129030 = ((int8_t *) mem_133187)[i_133048];
            int8_t eta_p_129031 = ((int8_t *) mem_133186)[i_133048];
            bool lifted_lambda_res_129032 = eta_p_129030 == eta_p_129031;
            bool lifted_lambda_res_129033 = !lifted_lambda_res_129032;
            bool defunc_0_op_res_129026 = lifted_lambda_res_129033 || redout_133047;
            bool redout_tmp_133523 = defunc_0_op_res_129026;
            
            redout_133047 = redout_tmp_133523;
        }
        defunc_0_reduce_res_129060 = redout_133047;
        
        int64_t defunc_0_f_res_129027 = btoi_bool_i64(defunc_0_reduce_res_129060);
        int64_t defunc_0_op_res_122240 = add64(defunc_0_f_res_129027, scanacc_133051);
        
        ((int64_t *) mem_133177)[i_133054] = defunc_0_op_res_122240;
        ((int64_t *) mem_133179)[i_133054] = defunc_0_f_res_129027;
        
        int64_t scanacc_tmp_133518 = defunc_0_op_res_122240;
        
        scanacc_133051 = scanacc_tmp_133518;
    }
    discard_133057 = scanacc_133051;
    
    bool cond_122241 = dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615 == (int64_t) 0;
    bool x_122242 = !cond_122241;
    int64_t tmp_122243 = sub64(dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615, (int64_t) 1);
    bool x_122244 = sle64((int64_t) 0, tmp_122243);
    bool y_122245 = slt64(tmp_122243, dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615);
    bool bounds_check_122246 = x_122244 && y_122245;
    bool protect_assert_disj_122247 = cond_122241 || bounds_check_122246;
    bool index_certs_122248;
    
    if (!protect_assert_disj_122247) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_122243, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_122249;
    
    if (x_122242) {
        int64_t x_129061 = ((int64_t *) mem_133177)[tmp_122243];
        
        m_f_res_122249 = x_129061;
    } else {
        m_f_res_122249 = (int64_t) 0;
    }
    
    int64_t m_122251;
    
    if (cond_122241) {
        m_122251 = (int64_t) 0;
    } else {
        m_122251 = m_f_res_122249;
    }
    
    int64_t m_122261 = sub64(m_122251, (int64_t) 1);
    bool i_p_m_t_s_leq_w_122263 = slt64(m_122261, dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615);
    bool zzero_leq_i_p_m_t_s_122262 = sle64((int64_t) 0, m_122261);
    bool y_122265 = zzero_leq_i_p_m_t_s_122262 && i_p_m_t_s_leq_w_122263;
    bool i_lte_j_122264 = sle64((int64_t) 0, m_122251);
    bool forwards_ok_122266 = i_lte_j_122264 && y_122265;
    bool eq_x_zz_122258 = (int64_t) 0 == m_f_res_122249;
    bool p_and_eq_x_y_122259 = x_122242 && eq_x_zz_122258;
    bool empty_slice_122260 = cond_122241 || p_and_eq_x_y_122259;
    bool ok_or_empty_122267 = empty_slice_122260 || forwards_ok_122266;
    bool index_certs_122268;
    
    if (!ok_or_empty_122267) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_122251, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133206 = (int64_t) 8 * m_122251;
    int64_t conc_tmp_120299 = (int64_t) 1 + m_122251;
    int64_t bytes_133215 = (int64_t) 8 * conc_tmp_120299;
    int64_t bytes_133217 = (int64_t) 4 * conc_tmp_120299;
    
    if (mem_133207_cached_sizze_133970 < bytes_133206) {
        err = lexical_realloc(ctx, &mem_133207, &mem_133207_cached_sizze_133970, bytes_133206);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_133524 = 0; i_133524 < m_122251; i_133524++) {
        int64_t x_133525 = (int64_t) 1 + i_133524 * (int64_t) 1;
        
        ((int64_t *) mem_133207)[i_133524] = x_133525;
    }
    for (int64_t write_iter_133058 = 0; write_iter_133058 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_112615; write_iter_133058++) {
        int64_t write_iv_133060 = ((int64_t *) mem_133179)[write_iter_133058];
        int64_t write_iv_133061 = ((int64_t *) mem_133177)[write_iter_133058];
        int64_t index_primexp_133147 = add64((int64_t) 1, write_iter_133058);
        bool cond_128910 = write_iv_133060 == (int64_t) 1;
        int64_t lifted_lambda_res_128911;
        
        if (cond_128910) {
            int64_t lifted_lambda_res_t_res_129062 = sub64(write_iv_133061, (int64_t) 1);
            
            lifted_lambda_res_128911 = lifted_lambda_res_t_res_129062;
        } else {
            lifted_lambda_res_128911 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_128911) && slt64(lifted_lambda_res_128911, m_122251)) {
            ((int64_t *) mem_133207)[lifted_lambda_res_128911] = index_primexp_133147;
        }
    }
    if (memblock_alloc(ctx, &mem_133216, bytes_133215, "mem_133216")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133527 = 0; nest_i_133527 < (int64_t) 1; nest_i_133527++) {
        ((int64_t *) mem_133216.mem)[nest_i_133527] = (int64_t) 0;
    }
    
    int64_t tmp_offs_133528 = (int64_t) 0;
    
    if (!(tmp_offs_133528 == (int64_t) 0)) {
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133216.mem, tmp_offs_133528, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133216.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
    }
    tmp_offs_133528 += (int64_t) 1;
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_133216.mem, tmp_offs_133528, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133207, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_122251});
    tmp_offs_133528 += m_122251;
    if (memblock_alloc(ctx, &mem_133218, bytes_133217, "mem_133218")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_133529 = 0; nest_i_133529 < conc_tmp_120299; nest_i_133529++) {
        ((int32_t *) mem_133218.mem)[nest_i_133529] = curDepth_112611;
    }
    if (memblock_set(ctx, &mem_out_133513, &mem_133216, "mem_133216") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_133514, &mem_133218, "mem_133218") != 0)
        return 1;
    prim_out_133515 = conc_tmp_120299;
    prim_out_133516 = conc_tmp_120299;
    prim_out_133517 = curDepth_112611;
    if (memblock_set(ctx, &*mem_out_p_133961, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133962, &mem_out_133514, "mem_out_133514") != 0)
        return 1;
    *out_prim_out_133963 = prim_out_133515;
    *out_prim_out_133964 = prim_out_133516;
    *out_prim_out_133965 = prim_out_133517;
    
  cleanup:
    {
        free(mem_133177);
        free(mem_133179);
        free(mem_133186);
        free(mem_133187);
        free(mem_133207);
        if (memblock_unref(ctx, &mem_133218, "mem_133218") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_133216, "mem_133216") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133514, "mem_out_133514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_133971, int32_t bit_68176, int16_t x_68177)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_133513;
    int16_t i32_res_120216 = sext_i32_i16(bit_68176);
    int16_t zgzg_res_120219 = ashr16(x_68177, i32_res_120216);
    int16_t za_res_120224 = (int16_t) 1 & zgzg_res_120219;
    int32_t to_i32_res_120226 = sext_i16_i32(za_res_120224);
    
    prim_out_133513 = to_i32_res_120226;
    *out_prim_out_133971 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_133972, int32_t bit_69958, int64_t x_69959)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_133513;
    int64_t i32_res_120216 = sext_i32_i64(bit_69958);
    int64_t zgzg_res_120219 = ashr64(x_69959, i32_res_120216);
    int64_t za_res_120224 = (int64_t) 1 & zgzg_res_120219;
    int32_t to_i32_res_120226 = sext_i64_i32(za_res_120224);
    
    prim_out_133513 = to_i32_res_120226;
    *out_prim_out_133972 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5357(struct futhark_context *ctx, int64_t *out_prim_out_133973, int64_t upper_bound_72505, int64_t n_72506)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    bool upper_bound_72507 = sle64((int64_t) 1, upper_bound_72505);
    bool assert_c_72509;
    
    if (!upper_bound_72507) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (upper_bound >= 1)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:189:21-58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_72518 = slt64(upper_bound_72505, n_72506);
    bool d_72527;
    int64_t d_72528;
    bool loop_while_72529;
    int64_t d_72530;
    
    loop_while_72529 = cond_72518;
    d_72530 = (int64_t) 1;
    while (loop_while_72529) {
        int64_t loopres_72531 = add64((int64_t) 1, d_72530);
        bool zzero_72533 = loopres_72531 == (int64_t) 0;
        bool nonzzero_72534 = !zzero_72533;
        bool nonzzero_cert_72535;
        
        if (!nonzzero_72534) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:190:36-38\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t zg_lhs_72536 = sdiv64(n_72506, loopres_72531);
        bool cond_72538 = slt64(upper_bound_72505, zg_lhs_72536);
        bool loop_cond_72539;
        
        if (cond_72538) {
            loop_cond_72539 = 1;
        } else {
            int64_t znze_lhs_72543 = smod64(n_72506, loopres_72531);
            bool loop_cond_f_res_72545 = znze_lhs_72543 == (int64_t) 0;
            bool loop_cond_f_res_72546 = !loop_cond_f_res_72545;
            
            loop_cond_72539 = loop_cond_f_res_72546;
        }
        
        bool loop_while_tmp_133514 = loop_cond_72539;
        int64_t d_tmp_133515 = loopres_72531;
        
        loop_while_72529 = loop_while_tmp_133514;
        d_72530 = d_tmp_133515;
    }
    d_72527 = loop_while_72529;
    d_72528 = d_72530;
    
    bool zzero_72548 = d_72528 == (int64_t) 0;
    bool nonzzero_72549 = !zzero_72548;
    bool nonzzero_cert_72550;
    
    if (!nonzzero_72549) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:191:7-9\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t greatest_divisor_leq_than_res_72551 = sdiv64(n_72506, d_72528);
    
    prim_out_133513 = greatest_divisor_leq_than_res_72551;
    *out_prim_out_133973 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11373(struct futhark_context *ctx, struct memblock *mem_out_p_133974, struct memblock nameless_mem_133175, int64_t n_84422, int64_t incr_84423)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t rng_84428 = add64(n_84422, incr_84423);
    bool bounds_invalid_upwards_84432 = slt64(rng_84428, incr_84423);
    bool valid_84437 = !bounds_invalid_upwards_84432;
    bool range_valid_c_84438;
    
    if (!valid_84437) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_84423, "..<", (long long) rng_84428, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133176 = (int64_t) 8 * n_84422;
    
    if (memblock_alloc(ctx, &mem_133177, bytes_133176, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133514 = 0; i_133514 < n_84422; i_133514++) {
        int64_t x_133515 = incr_84423 + i_133514 * (int64_t) 1;
        
        ((int64_t *) mem_133177.mem)[i_133514] = x_133515;
    }
    if (memblock_set(ctx, &mem_out_133513, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133974, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11394(struct futhark_context *ctx, struct memblock *mem_out_p_133975, struct memblock nameless_mem_133175, int64_t n_85290, int64_t incr_85291)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t rng_85296 = add64(n_85290, incr_85291);
    bool bounds_invalid_upwards_85300 = slt64(rng_85296, incr_85291);
    bool valid_85305 = !bounds_invalid_upwards_85300;
    bool range_valid_c_85306;
    
    if (!valid_85305) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_85291, "..<", (long long) rng_85296, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133176 = (int64_t) 8 * n_85290;
    
    if (memblock_alloc(ctx, &mem_133177, bytes_133176, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133514 = 0; i_133514 < n_85290; i_133514++) {
        int64_t x_133515 = incr_85291 + i_133514 * (int64_t) 1;
        
        ((int64_t *) mem_133177.mem)[i_133514] = x_133515;
    }
    if (memblock_set(ctx, &mem_out_133513, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133975, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11416(struct futhark_context *ctx, struct memblock *mem_out_p_133976, struct memblock nameless_mem_133175, int64_t n_86158, int64_t incr_86159)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t rng_86164 = add64(n_86158, incr_86159);
    bool bounds_invalid_upwards_86168 = slt64(rng_86164, incr_86159);
    bool valid_86173 = !bounds_invalid_upwards_86168;
    bool range_valid_c_86174;
    
    if (!valid_86173) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_86159, "..<", (long long) rng_86164, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133176 = (int64_t) 8 * n_86158;
    
    if (memblock_alloc(ctx, &mem_133177, bytes_133176, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133514 = 0; i_133514 < n_86158; i_133514++) {
        int64_t x_133515 = incr_86159 + i_133514 * (int64_t) 1;
        
        ((int64_t *) mem_133177.mem)[i_133514] = x_133515;
    }
    if (memblock_set(ctx, &mem_out_133513, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133976, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11438(struct futhark_context *ctx, struct memblock *mem_out_p_133977, struct memblock nameless_mem_133175, int64_t n_87026, int64_t incr_87027)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t rng_87032 = add64(n_87026, incr_87027);
    bool bounds_invalid_upwards_87036 = slt64(rng_87032, incr_87027);
    bool valid_87041 = !bounds_invalid_upwards_87036;
    bool range_valid_c_87042;
    
    if (!valid_87041) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_87027, "..<", (long long) rng_87032, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133176 = (int64_t) 8 * n_87026;
    
    if (memblock_alloc(ctx, &mem_133177, bytes_133176, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133514 = 0; i_133514 < n_87026; i_133514++) {
        int64_t x_133515 = incr_87027 + i_133514 * (int64_t) 1;
        
        ((int64_t *) mem_133177.mem)[i_133514] = x_133515;
    }
    if (memblock_set(ctx, &mem_out_133513, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133977, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_11459(struct futhark_context *ctx, struct memblock *mem_out_p_133978, struct memblock nameless_mem_133175, int64_t n_87915, int64_t incr_87916)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_133177;
    
    mem_133177.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    int64_t rng_87921 = add64(n_87915, incr_87916);
    bool bounds_invalid_upwards_87925 = slt64(rng_87921, incr_87916);
    bool valid_87930 = !bounds_invalid_upwards_87925;
    bool range_valid_c_87931;
    
    if (!valid_87930) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_87916, "..<", (long long) rng_87921, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_133176 = (int64_t) 8 * n_87915;
    
    if (memblock_alloc(ctx, &mem_133177, bytes_133176, "mem_133177")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_133514 = 0; i_133514 < n_87915; i_133514++) {
        int64_t x_133515 = incr_87916 + i_133514 * (int64_t) 1;
        
        ((int64_t *) mem_133177.mem)[i_133514] = x_133515;
    }
    if (memblock_set(ctx, &mem_out_133513, &mem_133177, "mem_133177") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133978, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_133177, "mem_133177") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_10477(struct futhark_context *ctx, int64_t *out_prim_out_133979, int64_t *out_prim_out_133980, int64_t *out_prim_out_133981, int64_t *out_prim_out_133982, int64_t *out_prim_out_133983, int64_t slo_72735, int64_t shi_72736, int64_t tlo_72737, int64_t thi_72738, int64_t count_72739)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_133513;
    int64_t prim_out_133514;
    int64_t prim_out_133515;
    int64_t prim_out_133516;
    int64_t prim_out_133517;
    int64_t min_arg1_72742 = add64(slo_72735, count_72739);
    int64_t min_res_120217 = smin64(shi_72736, min_arg1_72742);
    int64_t min_arg1_72746 = add64(tlo_72737, count_72739);
    int64_t min_res_120220 = smin64(thi_72738, min_arg1_72746);
    int64_t zp_lhs_72750 = sub64(min_res_120217, slo_72735);
    int64_t zp_rhs_72752 = sub64(min_res_120220, tlo_72737);
    int64_t zm_lhs_72754 = add64(zp_lhs_72750, zp_rhs_72752);
    int64_t slack_72756 = sub64(zm_lhs_72754, count_72739);
    int64_t min_res_120223 = smin64(zp_lhs_72750, slack_72756);
    int64_t min_res_120226 = smin64(zp_rhs_72752, min_res_120223);
    int64_t max_arg1_72766 = sub64(min_res_120217, min_res_120226);
    int64_t max_res_120229 = smax64(slo_72735, max_arg1_72766);
    int64_t max_arg1_72770 = sub64(min_res_120220, min_res_120226);
    int64_t max_res_120232 = smax64(tlo_72737, max_arg1_72770);
    int64_t zm_rhs_72774 = sub64(max_res_120229, slo_72735);
    int64_t zm_lhs_72776 = sub64(count_72739, zm_rhs_72774);
    int64_t zm_rhs_72778 = sub64(max_res_120232, tlo_72737);
    int64_t count_72780 = sub64(zm_lhs_72776, zm_rhs_72778);
    
    prim_out_133513 = max_res_120229;
    prim_out_133514 = min_res_120217;
    prim_out_133515 = max_res_120232;
    prim_out_133516 = min_res_120220;
    prim_out_133517 = count_72780;
    *out_prim_out_133979 = prim_out_133513;
    *out_prim_out_133980 = prim_out_133514;
    *out_prim_out_133981 = prim_out_133515;
    *out_prim_out_133982 = prim_out_133516;
    *out_prim_out_133983 = prim_out_133517;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_scatter_11973(struct futhark_context *ctx, struct memblock *mem_out_p_133984, struct memblock dest_mem_133175, struct memblock is_mem_133176, struct memblock vs_mem_133177, int64_t nd_115892, int64_t n_115893, int64_t psizze_115894)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_133182_cached_sizze_133985 = 0;
    unsigned char *mem_133182 = NULL;
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    bool zzero_115902 = psizze_115894 == (int64_t) 0;
    bool nonzzero_115903 = !zzero_115902;
    bool nonzzero_cert_115904;
    
    if (!nonzzero_115903) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_115898 = add64(nd_115892, psizze_115894);
    int64_t zs_lhs_115900 = sub64(zm_lhs_115898, (int64_t) 1);
    int64_t m_115905 = sdiv64(zs_lhs_115900, psizze_115894);
    bool loop_cond_115909 = slt64((int64_t) 0, m_115905);
    bool partitioned_scatter_res_115910;
    int64_t partitioned_scatter_res_115912;
    bool loop_while_115913;
    int64_t p_115915;
    
    loop_while_115913 = loop_cond_115909;
    p_115915 = (int64_t) 0;
    while (loop_while_115913) {
        int64_t lower_bound_115916 = mul64(psizze_115894, p_115915);
        int64_t min_arg1_115918 = add64(psizze_115894, lower_bound_115916);
        int64_t min_res_120579 = smin64(nd_115892, min_arg1_115918);
        int64_t j_m_i_115927 = sub64(min_res_120579, lower_bound_115916);
        bool empty_slice_115934 = j_m_i_115927 == (int64_t) 0;
        int64_t m_115935 = sub64(j_m_i_115927, (int64_t) 1);
        int64_t i_p_m_t_s_115937 = add64(lower_bound_115916, m_115935);
        bool zzero_leq_i_p_m_t_s_115938 = sle64((int64_t) 0, i_p_m_t_s_115937);
        bool i_p_m_t_s_leq_w_115940 = slt64(i_p_m_t_s_115937, nd_115892);
        bool zzero_lte_i_115941 = sle64((int64_t) 0, lower_bound_115916);
        bool i_lte_j_115942 = sle64(lower_bound_115916, min_res_120579);
        bool y_115943 = i_p_m_t_s_leq_w_115940 && zzero_lte_i_115941;
        bool y_115944 = zzero_leq_i_p_m_t_s_115938 && y_115943;
        bool forwards_ok_115945 = i_lte_j_115942 && y_115944;
        bool ok_or_empty_115952 = empty_slice_115934 || forwards_ok_115945;
        bool index_certs_115954;
        
        if (!ok_or_empty_115952) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_115916, ":", (long long) min_res_120579, "] out of bounds for array of shape [", (long long) nd_115892, "].", "-> #0  ftbasics.fut:72:25-56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_133181 = (int64_t) 8 * j_m_i_115927;
        
        if (mem_133182_cached_sizze_133985 < bytes_133181) {
            err = lexical_realloc(ctx, &mem_133182, &mem_133182_cached_sizze_133985, bytes_133181);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_133182, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) dest_mem_133175.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_115916, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_115927});
        for (int64_t write_iter_133040 = 0; write_iter_133040 < n_115893; write_iter_133040++) {
            int64_t write_iv_133042 = ((int64_t *) vs_mem_133177.mem)[write_iter_133040];
            int64_t write_iv_133043 = ((int64_t *) is_mem_133176.mem)[write_iter_133040];
            bool cond_128909 = sle64(lower_bound_115916, write_iv_133043);
            bool cond_t_res_128910 = slt64(write_iv_133043, min_res_120579);
            bool x_128911 = cond_128909 && cond_t_res_128910;
            int64_t lifted_lambda_res_128912;
            
            if (x_128911) {
                int64_t lifted_lambda_res_t_res_128918 = sub64(write_iv_133043, lower_bound_115916);
                
                lifted_lambda_res_128912 = lifted_lambda_res_t_res_128918;
            } else {
                lifted_lambda_res_128912 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_128912) && slt64(lifted_lambda_res_128912, j_m_i_115927)) {
                ((int64_t *) mem_133182)[lifted_lambda_res_128912] = write_iv_133042;
            }
        }
        
        int64_t tmp_115972 = add64((int64_t) 1, p_115915);
        
        lmad_copy_8b(ctx, 1, (uint64_t *) dest_mem_133175.mem, lower_bound_115916, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_133182, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_115927});
        
        bool loop_cond_116017 = slt64(tmp_115972, m_115905);
        bool loop_while_tmp_133514 = loop_cond_116017;
        int64_t p_tmp_133516 = tmp_115972;
        
        loop_while_115913 = loop_while_tmp_133514;
        p_115915 = p_tmp_133516;
    }
    partitioned_scatter_res_115910 = loop_while_115913;
    partitioned_scatter_res_115912 = p_115915;
    if (memblock_set(ctx, &mem_out_133513, &dest_mem_133175, "dest_mem_133175") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_133984, &mem_out_133513, "mem_out_133513") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_133182);
        if (memblock_unref(ctx, &mem_out_133513, "mem_out_133513") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_133986, int32_t bit_67870, int8_t x_67871, int32_t b_67872)
{
    (void) ctx;
    
    int err = 0;
    int8_t prim_out_133513;
    int32_t i32_arg0_67873 = shl32(1, bit_67870);
    int32_t i32_arg_67875 = ~i32_arg0_67873;
    int8_t unsign_arg0_120578 = zext_i32_i8(i32_arg_67875);
    int8_t unsign_arg0_127618 = x_67871 & unsign_arg0_120578;
    int32_t i32_arg0_67880 = shl32(b_67872, bit_67870);
    int8_t unsign_arg0_120580 = zext_i32_i8(i32_arg0_67880);
    int8_t unsign_arg0_120583 = unsign_arg0_120580 | unsign_arg0_127618;
    
    prim_out_133513 = unsign_arg0_120583;
    *out_prim_out_133986 = prim_out_133513;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4)
{
    int64_t nR_119031 = (int64_t) 0;
    int64_t b_119032 = (int64_t) 0;
    int64_t nS_119033 = (int64_t) 0;
    int64_t dz2081U_119034 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035 = (int64_t) 0;
    int32_t radix_sizze_119036 = 0;
    int32_t maxDepth_119041 = 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock last_info_idx_mem_133180;
    
    last_info_idx_mem_133180.references = NULL;
    
    struct memblock first_info_idx_mem_133179;
    
    first_info_idx_mem_133179.references = NULL;
    
    struct memblock depths_mem_133178;
    
    depths_mem_133178.references = NULL;
    
    struct memblock bounds_mem_133177;
    
    bounds_mem_133177.references = NULL;
    
    struct memblock pS_mem_133176;
    
    pS_mem_133176.references = NULL;
    
    struct memblock pR_mem_133175;
    
    pR_mem_133175.references = NULL;
    radix_sizze_119036 = in0;
    pR_mem_133175 = in1->mem;
    nR_119031 = in1->shape[0];
    b_119032 = in1->shape[1];
    pS_mem_133176 = in2->mem;
    nS_119033 = in2->shape[0];
    b_119032 = in2->shape[1];
    bounds_mem_133177 = in3->v0->mem;
    dz2081U_119034 = in3->v0->shape[0];
    depths_mem_133178 = in3->v1->mem;
    dz2081U_119034 = in3->v1->shape[0];
    maxDepth_119041 = in3->v2;
    first_info_idx_mem_133179 = in4->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035 = in4->v0->shape[0];
    last_info_idx_mem_133180 = in4->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035 = in4->v1->shape[0];
    if (!((nR_119031 == in1->shape[0] && b_119032 == in1->shape[1]) && ((nS_119033 == in2->shape[0] && b_119032 == in2->shape[1]) && ((dz2081U_119034 == in3->v0->shape[0] && dz2081U_119034 == in3->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035 == in4->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035 == in4->v1->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, pR_mem_133175, pS_mem_133176, bounds_mem_133177, depths_mem_133178, first_info_idx_mem_133179, last_info_idx_mem_133180, nR_119031, b_119032, nS_119033, dz2081U_119034, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_119035, radix_sizze_119036, maxDepth_119041);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
            (*out0)->v2->shape[1] = b_119032;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4)
{
    int64_t nR_120163 = (int64_t) 0;
    int64_t b_120164 = (int64_t) 0;
    int64_t nS_120165 = (int64_t) 0;
    int64_t dz2081U_120166 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167 = (int64_t) 0;
    int32_t radix_sizze_120168 = 0;
    int32_t maxDepth_120173 = 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock last_info_idx_mem_133180;
    
    last_info_idx_mem_133180.references = NULL;
    
    struct memblock first_info_idx_mem_133179;
    
    first_info_idx_mem_133179.references = NULL;
    
    struct memblock depths_mem_133178;
    
    depths_mem_133178.references = NULL;
    
    struct memblock bounds_mem_133177;
    
    bounds_mem_133177.references = NULL;
    
    struct memblock pS_mem_133176;
    
    pS_mem_133176.references = NULL;
    
    struct memblock pR_mem_133175;
    
    pR_mem_133175.references = NULL;
    radix_sizze_120168 = in0;
    pR_mem_133175 = in1->mem;
    nR_120163 = in1->shape[0];
    b_120164 = in1->shape[1];
    pS_mem_133176 = in2->mem;
    nS_120165 = in2->shape[0];
    b_120164 = in2->shape[1];
    bounds_mem_133177 = in3->v0->mem;
    dz2081U_120166 = in3->v0->shape[0];
    depths_mem_133178 = in3->v1->mem;
    dz2081U_120166 = in3->v1->shape[0];
    maxDepth_120173 = in3->v2;
    first_info_idx_mem_133179 = in4->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167 = in4->v0->shape[0];
    last_info_idx_mem_133180 = in4->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167 = in4->v1->shape[0];
    if (!((nR_120163 == in1->shape[0] && b_120164 == in1->shape[1]) && ((nS_120165 == in2->shape[0] && b_120164 == in2->shape[1]) && ((dz2081U_120166 == in3->v0->shape[0] && dz2081U_120166 == in3->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167 == in4->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167 == in4->v1->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, pR_mem_133175, pS_mem_133176, bounds_mem_133177, depths_mem_133178, first_info_idx_mem_133179, last_info_idx_mem_133180, nR_120163, b_120164, nS_120165, dz2081U_120166, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_120167, radix_sizze_120168, maxDepth_120173);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
            (*out0)->v2->shape[1] = b_120164;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0)
{
    int64_t n_62709 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_133175;
    
    ks_mem_133175.references = NULL;
    ks_mem_133175 = in0->mem;
    n_62709 = in0->shape[0];
    if (!(n_62709 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_double(ctx, &prim_out_133513, ks_mem_133175, n_62709);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0)
{
    int64_t n_62532 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_133175;
    
    ks_mem_133175.references = NULL;
    ks_mem_133175 = in0->mem;
    n_62532 = in0->shape[0];
    if (!(n_62532 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_float(ctx, &prim_out_133513, ks_mem_133175, n_62532);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t n_62181 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_133175;
    
    ks_mem_133175.references = NULL;
    ks_mem_133175 = in0->mem;
    n_62181 = in0->shape[0];
    if (!(n_62181 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_int(ctx, &prim_out_133513, ks_mem_133175, n_62181);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t n_62355 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_133175;
    
    ks_mem_133175.references = NULL;
    ks_mem_133175 = in0->mem;
    n_62355 = in0->shape[0];
    if (!(n_62355 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_long(ctx, &prim_out_133513, ks_mem_133175, n_62355);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t n_62007 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_133175;
    
    ks_mem_133175.references = NULL;
    ks_mem_133175 = in0->mem;
    n_62007 = in0->shape[0];
    if (!(n_62007 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_short(ctx, &prim_out_133513, ks_mem_133175, n_62007);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4)
{
    int64_t n_115648 = (int64_t) 0;
    int64_t b_115649 = (int64_t) 0;
    int32_t radix_sizze_115650 = 0;
    int64_t offset_115652 = (int64_t) 0;
    int64_t sizze_thresh_115653 = (int64_t) 0;
    int32_t max_depth_115654 = 0;
    int64_t prim_out_133515 = (int64_t) 0;
    int32_t prim_out_133516 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pXs_mem_133175;
    
    pXs_mem_133175.references = NULL;
    radix_sizze_115650 = in0;
    pXs_mem_133175 = in1->mem;
    n_115648 = in1->shape[0];
    b_115649 = in1->shape[1];
    offset_115652 = in2;
    sizze_thresh_115653 = in3;
    max_depth_115654 = in4;
    if (!(n_115648 == in1->shape[0] && b_115649 == in1->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_partitions_from_partitioned_set(ctx, &mem_out_133513, &mem_out_133514, &prim_out_133515, &prim_out_133516, pXs_mem_133175, n_115648, b_115649, radix_sizze_115650, offset_115652, sizze_thresh_115653, max_depth_115654);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionInfo *) malloc(sizeof(struct futhark_opaque_partitionInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133515;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133515;
            (*out0)->v2 = prim_out_133516;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3)
{
    int64_t n_116366 = (int64_t) 0;
    int64_t b_116367 = (int64_t) 0;
    int64_t dz2080U_116368 = (int64_t) 0;
    int64_t dz2081U_116369 = (int64_t) 0;
    int32_t radix_sizze_116370 = 0;
    int32_t maxDepth_116374 = 0;
    int64_t scatter_psizze_116375 = (int64_t) 0;
    int64_t prim_out_133515 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock depths_mem_133177;
    
    depths_mem_133177.references = NULL;
    
    struct memblock bounds_mem_133176;
    
    bounds_mem_133176.references = NULL;
    
    struct memblock pXs_mem_133175;
    
    pXs_mem_133175.references = NULL;
    radix_sizze_116370 = in0;
    pXs_mem_133175 = in1->mem;
    n_116366 = in1->shape[0];
    b_116367 = in1->shape[1];
    bounds_mem_133176 = in2->v0->mem;
    dz2080U_116368 = in2->v0->shape[0];
    depths_mem_133177 = in2->v1->mem;
    dz2081U_116369 = in2->v1->shape[0];
    maxDepth_116374 = in2->v2;
    scatter_psizze_116375 = in3;
    if (!((n_116366 == in1->shape[0] && b_116367 == in1->shape[1]) && (dz2080U_116368 == in2->v0->shape[0] && dz2081U_116369 == in2->v1->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_create_hash_table_from_partitioned_set(ctx, &mem_out_133513, &mem_out_133514, &prim_out_133515, pXs_mem_133175, bounds_mem_133176, depths_mem_133177, n_116366, b_116367, dz2080U_116368, dz2081U_116369, radix_sizze_116370, maxDepth_116374, scatter_psizze_116375);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_radix_hashTable *) malloc(sizeof(struct futhark_opaque_radix_hashTable))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133515;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133515;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4)
{
    int64_t niz2084U_66322 = (int64_t) 0;
    int64_t dz2083U_66323 = (int64_t) 0;
    int64_t incr_66324 = (int64_t) 0;
    int64_t psizze_66325 = (int64_t) 0;
    int64_t pL_bytes_66327 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_66324 = in0;
    psizze_66325 = in1;
    is_mem_133175 = in2->mem;
    niz2084U_66322 = in2->shape[0];
    pL_bytes_66327 = in3;
    ys_mem_133176 = in4->mem;
    dz2083U_66323 = in4->shape[0];
    if (!(niz2084U_66322 == in2->shape[0] && (dz2083U_66323 == in4->shape[0] && pL_bytes_66327 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_GFTR(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, niz2084U_66322, dz2083U_66323, incr_66324, psizze_66325, pL_bytes_66327);
        if (ret == 0) {
            assert((*out0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = niz2084U_66322;
            (*out0)->shape[1] = pL_bytes_66327;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t niz2084U_65858 = (int64_t) 0;
    int64_t dz2083U_65859 = (int64_t) 0;
    int64_t incr_65860 = (int64_t) 0;
    int64_t psizze_65861 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_65860 = in0;
    psizze_65861 = in1;
    is_mem_133175 = in2->mem;
    niz2084U_65858 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    dz2083U_65859 = in3->shape[0];
    if (!(niz2084U_65858 == in2->shape[0] && dz2083U_65859 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, niz2084U_65858, dz2083U_65859, incr_65860, psizze_65861);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = niz2084U_65858;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4)
{
    int64_t ni_67830 = (int64_t) 0;
    int64_t n_67831 = (int64_t) 0;
    int64_t incr_67832 = (int64_t) 0;
    int64_t psizze_67833 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133177;
    
    ys_mem_133177.references = NULL;
    
    struct memblock is_mem_133176;
    
    is_mem_133176.references = NULL;
    
    struct memblock preVals_mem_133175;
    
    preVals_mem_133175.references = NULL;
    incr_67832 = in0;
    psizze_67833 = in1;
    preVals_mem_133175 = in2->mem;
    ni_67830 = in2->shape[0];
    is_mem_133176 = in3->mem;
    ni_67830 = in3->shape[0];
    ys_mem_133177 = in4->mem;
    n_67831 = in4->shape[0];
    if (!(ni_67830 == in2->shape[0] && (ni_67830 == in3->shape[0] && n_67831 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double_GFUR(ctx, &mem_out_133513, preVals_mem_133175, is_mem_133176, ys_mem_133177, ni_67830, n_67831, incr_67832, psizze_67833);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = ni_67830;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t niz2084U_65578 = (int64_t) 0;
    int64_t dz2083U_65579 = (int64_t) 0;
    int64_t incr_65580 = (int64_t) 0;
    int64_t psizze_65581 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_65580 = in0;
    psizze_65581 = in1;
    is_mem_133175 = in2->mem;
    niz2084U_65578 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    dz2083U_65579 = in3->shape[0];
    if (!(niz2084U_65578 == in2->shape[0] && dz2083U_65579 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, niz2084U_65578, dz2083U_65579, incr_65580, psizze_65581);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = niz2084U_65578;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4)
{
    int64_t ni_67529 = (int64_t) 0;
    int64_t n_67530 = (int64_t) 0;
    int64_t incr_67531 = (int64_t) 0;
    int64_t psizze_67532 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133177;
    
    ys_mem_133177.references = NULL;
    
    struct memblock is_mem_133176;
    
    is_mem_133176.references = NULL;
    
    struct memblock preVals_mem_133175;
    
    preVals_mem_133175.references = NULL;
    incr_67531 = in0;
    psizze_67532 = in1;
    preVals_mem_133175 = in2->mem;
    ni_67529 = in2->shape[0];
    is_mem_133176 = in3->mem;
    ni_67529 = in3->shape[0];
    ys_mem_133177 = in4->mem;
    n_67530 = in4->shape[0];
    if (!(ni_67529 == in2->shape[0] && (ni_67529 == in3->shape[0] && n_67530 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float_GFUR(ctx, &mem_out_133513, preVals_mem_133175, is_mem_133176, ys_mem_133177, ni_67529, n_67530, incr_67531, psizze_67532);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = ni_67529;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t niz2084U_65018 = (int64_t) 0;
    int64_t dz2083U_65019 = (int64_t) 0;
    int64_t incr_65020 = (int64_t) 0;
    int64_t psizze_65021 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_65020 = in0;
    psizze_65021 = in1;
    is_mem_133175 = in2->mem;
    niz2084U_65018 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    dz2083U_65019 = in3->shape[0];
    if (!(niz2084U_65018 == in2->shape[0] && dz2083U_65019 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, niz2084U_65018, dz2083U_65019, incr_65020, psizze_65021);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = niz2084U_65018;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4)
{
    int64_t ni_66927 = (int64_t) 0;
    int64_t n_66928 = (int64_t) 0;
    int64_t incr_66929 = (int64_t) 0;
    int64_t psizze_66930 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133177;
    
    ys_mem_133177.references = NULL;
    
    struct memblock is_mem_133176;
    
    is_mem_133176.references = NULL;
    
    struct memblock preVals_mem_133175;
    
    preVals_mem_133175.references = NULL;
    incr_66929 = in0;
    psizze_66930 = in1;
    preVals_mem_133175 = in2->mem;
    ni_66927 = in2->shape[0];
    is_mem_133176 = in3->mem;
    ni_66927 = in3->shape[0];
    ys_mem_133177 = in4->mem;
    n_66928 = in4->shape[0];
    if (!(ni_66927 == in2->shape[0] && (ni_66927 == in3->shape[0] && n_66928 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int_GFUR(ctx, &mem_out_133513, preVals_mem_133175, is_mem_133176, ys_mem_133177, ni_66927, n_66928, incr_66929, psizze_66930);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = ni_66927;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t niz2084U_65298 = (int64_t) 0;
    int64_t dz2083U_65299 = (int64_t) 0;
    int64_t incr_65300 = (int64_t) 0;
    int64_t psizze_65301 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_65300 = in0;
    psizze_65301 = in1;
    is_mem_133175 = in2->mem;
    niz2084U_65298 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    dz2083U_65299 = in3->shape[0];
    if (!(niz2084U_65298 == in2->shape[0] && dz2083U_65299 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, niz2084U_65298, dz2083U_65299, incr_65300, psizze_65301);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = niz2084U_65298;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4)
{
    int64_t ni_67228 = (int64_t) 0;
    int64_t n_67229 = (int64_t) 0;
    int64_t incr_67230 = (int64_t) 0;
    int64_t psizze_67231 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133177;
    
    ys_mem_133177.references = NULL;
    
    struct memblock is_mem_133176;
    
    is_mem_133176.references = NULL;
    
    struct memblock preVals_mem_133175;
    
    preVals_mem_133175.references = NULL;
    incr_67230 = in0;
    psizze_67231 = in1;
    preVals_mem_133175 = in2->mem;
    ni_67228 = in2->shape[0];
    is_mem_133176 = in3->mem;
    ni_67228 = in3->shape[0];
    ys_mem_133177 = in4->mem;
    n_67229 = in4->shape[0];
    if (!(ni_67228 == in2->shape[0] && (ni_67228 == in3->shape[0] && n_67229 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long_GFUR(ctx, &mem_out_133513, preVals_mem_133175, is_mem_133176, ys_mem_133177, ni_67228, n_67229, incr_67230, psizze_67231);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = ni_67228;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t niz2084U_64738 = (int64_t) 0;
    int64_t dz2083U_64739 = (int64_t) 0;
    int64_t incr_64740 = (int64_t) 0;
    int64_t psizze_64741 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_64740 = in0;
    psizze_64741 = in1;
    is_mem_133175 = in2->mem;
    niz2084U_64738 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    dz2083U_64739 = in3->shape[0];
    if (!(niz2084U_64738 == in2->shape[0] && dz2083U_64739 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, niz2084U_64738, dz2083U_64739, incr_64740, psizze_64741);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = niz2084U_64738;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4)
{
    int64_t ni_66626 = (int64_t) 0;
    int64_t n_66627 = (int64_t) 0;
    int64_t incr_66628 = (int64_t) 0;
    int64_t psizze_66629 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133177;
    
    ys_mem_133177.references = NULL;
    
    struct memblock is_mem_133176;
    
    is_mem_133176.references = NULL;
    
    struct memblock preVals_mem_133175;
    
    preVals_mem_133175.references = NULL;
    incr_66628 = in0;
    psizze_66629 = in1;
    preVals_mem_133175 = in2->mem;
    ni_66626 = in2->shape[0];
    is_mem_133176 = in3->mem;
    ni_66626 = in3->shape[0];
    ys_mem_133177 = in4->mem;
    n_66627 = in4->shape[0];
    if (!(ni_66626 == in2->shape[0] && (ni_66626 == in3->shape[0] && n_66627 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short_GFUR(ctx, &mem_out_133513, preVals_mem_133175, is_mem_133176, ys_mem_133177, ni_66626, n_66627, incr_66628, psizze_66629);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = ni_66626;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_110890 = (int64_t) 0;
    int64_t nS_110891 = (int64_t) 0;
    int64_t offset_R_110894 = (int64_t) 0;
    int64_t offset_S_110895 = (int64_t) 0;
    int64_t partitionSizze_110896 = (int64_t) 0;
    int64_t scatter_psizze_110897 = (int64_t) 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock tS_mem_133176;
    
    tS_mem_133176.references = NULL;
    
    struct memblock tR_mem_133175;
    
    tR_mem_133175.references = NULL;
    tR_mem_133175 = in0->mem;
    nR_110890 = in0->shape[0];
    tS_mem_133176 = in1->mem;
    nS_110891 = in1->shape[0];
    offset_R_110894 = in2;
    offset_S_110895 = in3;
    partitionSizze_110896 = in4;
    scatter_psizze_110897 = in5;
    if (!(nR_110890 == in0->shape[0] && nS_110891 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_double(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, tR_mem_133175, tS_mem_133176, nR_110890, nS_110891, offset_R_110894, offset_S_110895, partitionSizze_110896, scatter_psizze_110897);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_double *) malloc(sizeof(struct futhark_opaque_joinPairs_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_108656 = (int64_t) 0;
    int64_t nS_108657 = (int64_t) 0;
    int64_t offset_R_108660 = (int64_t) 0;
    int64_t offset_S_108661 = (int64_t) 0;
    int64_t partitionSizze_108662 = (int64_t) 0;
    int64_t scatter_psizze_108663 = (int64_t) 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock tS_mem_133176;
    
    tS_mem_133176.references = NULL;
    
    struct memblock tR_mem_133175;
    
    tR_mem_133175.references = NULL;
    tR_mem_133175 = in0->mem;
    nR_108656 = in0->shape[0];
    tS_mem_133176 = in1->mem;
    nS_108657 = in1->shape[0];
    offset_R_108660 = in2;
    offset_S_108661 = in3;
    partitionSizze_108662 = in4;
    scatter_psizze_108663 = in5;
    if (!(nR_108656 == in0->shape[0] && nS_108657 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_float(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, tR_mem_133175, tS_mem_133176, nR_108656, nS_108657, offset_R_108660, offset_S_108661, partitionSizze_108662, scatter_psizze_108663);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_float *) malloc(sizeof(struct futhark_opaque_joinPairs_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_104200 = (int64_t) 0;
    int64_t nS_104201 = (int64_t) 0;
    int64_t offset_R_104204 = (int64_t) 0;
    int64_t offset_S_104205 = (int64_t) 0;
    int64_t partitionSizze_104206 = (int64_t) 0;
    int64_t scatter_psizze_104207 = (int64_t) 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock tS_mem_133176;
    
    tS_mem_133176.references = NULL;
    
    struct memblock tR_mem_133175;
    
    tR_mem_133175.references = NULL;
    tR_mem_133175 = in0->mem;
    nR_104200 = in0->shape[0];
    tS_mem_133176 = in1->mem;
    nS_104201 = in1->shape[0];
    offset_R_104204 = in2;
    offset_S_104205 = in3;
    partitionSizze_104206 = in4;
    scatter_psizze_104207 = in5;
    if (!(nR_104200 == in0->shape[0] && nS_104201 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_int(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, tR_mem_133175, tS_mem_133176, nR_104200, nS_104201, offset_R_104204, offset_S_104205, partitionSizze_104206, scatter_psizze_104207);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_int *) malloc(sizeof(struct futhark_opaque_joinPairs_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_106422 = (int64_t) 0;
    int64_t nS_106423 = (int64_t) 0;
    int64_t offset_R_106426 = (int64_t) 0;
    int64_t offset_S_106427 = (int64_t) 0;
    int64_t partitionSizze_106428 = (int64_t) 0;
    int64_t scatter_psizze_106429 = (int64_t) 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock tS_mem_133176;
    
    tS_mem_133176.references = NULL;
    
    struct memblock tR_mem_133175;
    
    tR_mem_133175.references = NULL;
    tR_mem_133175 = in0->mem;
    nR_106422 = in0->shape[0];
    tS_mem_133176 = in1->mem;
    nS_106423 = in1->shape[0];
    offset_R_106426 = in2;
    offset_S_106427 = in3;
    partitionSizze_106428 = in4;
    scatter_psizze_106429 = in5;
    if (!(nR_106422 == in0->shape[0] && nS_106423 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_long(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, tR_mem_133175, tS_mem_133176, nR_106422, nS_106423, offset_R_106426, offset_S_106427, partitionSizze_106428, scatter_psizze_106429);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_long *) malloc(sizeof(struct futhark_opaque_joinPairs_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_101966 = (int64_t) 0;
    int64_t nS_101967 = (int64_t) 0;
    int64_t offset_R_101970 = (int64_t) 0;
    int64_t offset_S_101971 = (int64_t) 0;
    int64_t partitionSizze_101972 = (int64_t) 0;
    int64_t scatter_psizze_101973 = (int64_t) 0;
    int64_t prim_out_133516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133515;
    
    mem_out_133515.references = NULL;
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock tS_mem_133176;
    
    tS_mem_133176.references = NULL;
    
    struct memblock tR_mem_133175;
    
    tR_mem_133175.references = NULL;
    tR_mem_133175 = in0->mem;
    nR_101966 = in0->shape[0];
    tS_mem_133176 = in1->mem;
    nS_101967 = in1->shape[0];
    offset_R_101970 = in2;
    offset_S_101971 = in3;
    partitionSizze_101972 = in4;
    scatter_psizze_101973 = in5;
    if (!(nR_101966 == in0->shape[0] && nS_101967 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_short(ctx, &mem_out_133513, &mem_out_133514, &mem_out_133515, &prim_out_133516, tR_mem_133175, tS_mem_133176, nR_101966, nS_101967, offset_R_101970, offset_S_101971, partitionSizze_101972, scatter_psizze_101973);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_short *) malloc(sizeof(struct futhark_opaque_joinPairs_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = prim_out_133516;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = prim_out_133516;
            assert(((*out0)->v2 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v2->mem = mem_out_133515;
            (*out0)->v2->shape[0] = prim_out_133516;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_62786 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_133175;
    
    eta_p_mem_133175.references = NULL;
    eta_p_mem_133175 = in0->mem;
    nz2080U_62786 = in0->shape[0];
    if (!(nz2080U_62786 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_max_idx(ctx, &prim_out_133513, eta_p_mem_133175, nz2080U_62786);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1)
{
    int64_t n_99501 = (int64_t) 0;
    int64_t incr_99502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_99502 = in0;
    xs_mem_133175 = in1->mem;
    n_99501 = in1->shape[0];
    if (!(n_99501 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_double(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_99501, incr_99502);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_99501;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_99501;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1)
{
    int64_t n_97356 = (int64_t) 0;
    int64_t incr_97357 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_97357 = in0;
    xs_mem_133175 = in1->mem;
    n_97356 = in1->shape[0];
    if (!(n_97356 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_float(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_97356, incr_97357);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_97356;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_97356;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1)
{
    int64_t n_93070 = (int64_t) 0;
    int64_t incr_93071 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_93071 = in0;
    xs_mem_133175 = in1->mem;
    n_93070 = in1->shape[0];
    if (!(n_93070 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_int(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_93070, incr_93071);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_93070;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_93070;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1)
{
    int64_t n_95211 = (int64_t) 0;
    int64_t incr_95212 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_95212 = in0;
    xs_mem_133175 = in1->mem;
    n_95211 = in1->shape[0];
    if (!(n_95211 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_long(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_95211, incr_95212);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_95211;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_95211;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1)
{
    int64_t n_90925 = (int64_t) 0;
    int64_t incr_90926 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_90926 = in0;
    xs_mem_133175 = in1->mem;
    n_90925 = in1->shape[0];
    if (!(n_90925 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_short(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_90925, incr_90926);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_90925;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_90925;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0)
{
    int64_t n_84397 = (int64_t) 0;
    int64_t b_84398 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    k_mem_133175 = in0->v0->mem;
    n_84397 = in0->v0->shape[0];
    pL_mem_133176 = in0->v1->mem;
    n_84397 = in0->v1->shape[0];
    b_84398 = in0->v1->shape[1];
    if (!(n_84397 == in0->v0->shape[0] && (n_84397 == in0->v1->shape[0] && b_84398 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_double(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_84397, b_84398);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_84397;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_84397;
            (*out0)->v1->shape[1] = b_84398;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0)
{
    int64_t n_82032 = (int64_t) 0;
    int64_t b_82033 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    k_mem_133175 = in0->v0->mem;
    n_82032 = in0->v0->shape[0];
    pL_mem_133176 = in0->v1->mem;
    n_82032 = in0->v1->shape[0];
    b_82033 = in0->v1->shape[1];
    if (!(n_82032 == in0->v0->shape[0] && (n_82032 == in0->v1->shape[0] && b_82033 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_float(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_82032, b_82033);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_82032;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_82032;
            (*out0)->v1->shape[1] = b_82033;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0)
{
    int64_t n_77312 = (int64_t) 0;
    int64_t b_77313 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    k_mem_133175 = in0->v0->mem;
    n_77312 = in0->v0->shape[0];
    pL_mem_133176 = in0->v1->mem;
    n_77312 = in0->v1->shape[0];
    b_77313 = in0->v1->shape[1];
    if (!(n_77312 == in0->v0->shape[0] && (n_77312 == in0->v1->shape[0] && b_77313 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_int(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_77312, b_77313);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_77312;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_77312;
            (*out0)->v1->shape[1] = b_77313;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0)
{
    int64_t n_79667 = (int64_t) 0;
    int64_t b_79668 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    k_mem_133175 = in0->v0->mem;
    n_79667 = in0->v0->shape[0];
    pL_mem_133176 = in0->v1->mem;
    n_79667 = in0->v1->shape[0];
    b_79668 = in0->v1->shape[1];
    if (!(n_79667 == in0->v0->shape[0] && (n_79667 == in0->v1->shape[0] && b_79668 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_long(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_79667, b_79668);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_79667;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_79667;
            (*out0)->v1->shape[1] = b_79668;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0)
{
    int64_t n_74947 = (int64_t) 0;
    int64_t b_74948 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    k_mem_133175 = in0->v0->mem;
    n_74947 = in0->v0->shape[0];
    pL_mem_133176 = in0->v1->mem;
    n_74947 = in0->v1->shape[0];
    b_74948 = in0->v1->shape[1];
    if (!(n_74947 == in0->v0->shape[0] && (n_74947 == in0->v1->shape[0] && b_74948 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_short(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_74947, b_74948);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_74947;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_74947;
            (*out0)->v1->shape[1] = b_74948;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_62746 = (int64_t) 0;
    int64_t prim_out_133513 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_133175;
    
    eta_p_mem_133175.references = NULL;
    eta_p_mem_133175 = in0->mem;
    nz2080U_62746 = in0->shape[0];
    if (!(nz2080U_62746 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_min_idx(ctx, &prim_out_133513, eta_p_mem_133175, nz2080U_62746);
        if (ret == 0) {
            *out0 = prim_out_133513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t n_64456 = (int64_t) 0;
    int64_t incr_64457 = (int64_t) 0;
    int64_t block_sizze_64458 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_64457 = in0;
    block_sizze_64458 = in1;
    is_mem_133175 = in2->mem;
    n_64456 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    n_64456 = in3->shape[0];
    if (!(n_64456 == in2->shape[0] && n_64456 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_double(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, n_64456, incr_64457, block_sizze_64458);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = n_64456;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t n_64122 = (int64_t) 0;
    int64_t incr_64123 = (int64_t) 0;
    int64_t block_sizze_64124 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_64123 = in0;
    block_sizze_64124 = in1;
    is_mem_133175 = in2->mem;
    n_64122 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    n_64122 = in3->shape[0];
    if (!(n_64122 == in2->shape[0] && n_64122 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_float(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, n_64122, incr_64123, block_sizze_64124);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = n_64122;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t n_63454 = (int64_t) 0;
    int64_t incr_63455 = (int64_t) 0;
    int64_t block_sizze_63456 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_63455 = in0;
    block_sizze_63456 = in1;
    is_mem_133175 = in2->mem;
    n_63454 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    n_63454 = in3->shape[0];
    if (!(n_63454 == in2->shape[0] && n_63454 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_int(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, n_63454, incr_63455, block_sizze_63456);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = n_63454;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t n_63788 = (int64_t) 0;
    int64_t incr_63789 = (int64_t) 0;
    int64_t block_sizze_63790 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_63789 = in0;
    block_sizze_63790 = in1;
    is_mem_133175 = in2->mem;
    n_63788 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    n_63788 = in3->shape[0];
    if (!(n_63788 == in2->shape[0] && n_63788 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_long(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, n_63788, incr_63789, block_sizze_63790);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = n_63788;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t n_63120 = (int64_t) 0;
    int64_t incr_63121 = (int64_t) 0;
    int64_t block_sizze_63122 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock ys_mem_133176;
    
    ys_mem_133176.references = NULL;
    
    struct memblock is_mem_133175;
    
    is_mem_133175.references = NULL;
    incr_63121 = in0;
    block_sizze_63122 = in1;
    is_mem_133175 = in2->mem;
    n_63120 = in2->shape[0];
    ys_mem_133176 = in3->mem;
    n_63120 = in3->shape[0];
    if (!(n_63120 == in2->shape[0] && n_63120 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_short(ctx, &mem_out_133513, is_mem_133175, ys_mem_133176, n_63120, incr_63121, block_sizze_63122);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_133513;
            (*out0)->shape[0] = n_63120;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6, const int32_t in7)
{
    int64_t n_113463 = (int64_t) 0;
    int64_t b_113464 = (int64_t) 0;
    int64_t pL_b_113465 = (int64_t) 0;
    int16_t block_sizze_113466 = (int16_t) 0;
    int64_t gather_psizze_113467 = (int64_t) 0;
    int32_t radix_sizze_113468 = 0;
    int64_t sizze_thresh_113471 = (int64_t) 0;
    int32_t max_depth_113472 = 0;
    int32_t bit_step_113473 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    block_sizze_113466 = in0;
    gather_psizze_113467 = in1;
    radix_sizze_113468 = in2;
    xs_mem_133175 = in3->mem;
    n_113463 = in3->shape[0];
    b_113464 = in3->shape[1];
    pL_mem_133176 = in4->mem;
    n_113463 = in4->shape[0];
    pL_b_113465 = in4->shape[1];
    sizze_thresh_113471 = in5;
    max_depth_113472 = in6;
    bit_step_113473 = in7;
    if (!((n_113463 == in3->shape[0] && b_113464 == in3->shape[1]) && (n_113463 == in4->shape[0] && pL_b_113465 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFTR(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, pL_mem_133176, n_113463, b_113464, pL_b_113465, block_sizze_113466, gather_psizze_113467, radix_sizze_113468, sizze_thresh_113471, max_depth_113472, bit_step_113473);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFTR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_113463;
            (*out0)->v0->shape[1] = b_113464;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_113463;
            (*out0)->v1->shape[1] = pL_b_113465;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6, const int32_t in7)
{
    int64_t n_114834 = (int64_t) 0;
    int64_t b_114835 = (int64_t) 0;
    int16_t block_sizze_114836 = (int16_t) 0;
    int64_t gather_psizze_114837 = (int64_t) 0;
    int32_t radix_sizze_114838 = 0;
    int64_t offset_114840 = (int64_t) 0;
    int64_t sizze_thresh_114841 = (int64_t) 0;
    int32_t max_depth_114842 = 0;
    int32_t bit_step_114843 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    block_sizze_114836 = in0;
    gather_psizze_114837 = in1;
    radix_sizze_114838 = in2;
    xs_mem_133175 = in3->mem;
    n_114834 = in3->shape[0];
    b_114835 = in3->shape[1];
    offset_114840 = in4;
    sizze_thresh_114841 = in5;
    max_depth_114842 = in6;
    bit_step_114843 = in7;
    if (!(n_114834 == in3->shape[0] && b_114835 == in3->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFUR(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_114834, b_114835, block_sizze_114836, gather_psizze_114837, radix_sizze_114838, offset_114840, sizze_thresh_114841, max_depth_114842, bit_step_114843);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFUR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_114834;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_114834;
            (*out0)->v1->shape[1] = b_114835;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int16_t in1, const struct futhark_f64_1d *in2)
{
    int64_t n_88779 = (int64_t) 0;
    int64_t incr_88780 = (int64_t) 0;
    int16_t block_sizze_88781 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_88780 = in0;
    block_sizze_88781 = in1;
    xs_mem_133175 = in2->mem;
    n_88779 = in2->shape[0];
    if (!(n_88779 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_double(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_88779, incr_88780, block_sizze_88781);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_88779;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_88779;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int16_t in1, const struct futhark_f32_1d *in2)
{
    int64_t n_87890 = (int64_t) 0;
    int64_t incr_87891 = (int64_t) 0;
    int16_t block_sizze_87892 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_87891 = in0;
    block_sizze_87892 = in1;
    xs_mem_133175 = in2->mem;
    n_87890 = in2->shape[0];
    if (!(n_87890 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_float(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_87890, incr_87891, block_sizze_87892);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_87890;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_87890;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int16_t in1, const struct futhark_i32_1d *in2)
{
    int64_t n_86133 = (int64_t) 0;
    int64_t incr_86134 = (int64_t) 0;
    int16_t block_sizze_86135 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_86134 = in0;
    block_sizze_86135 = in1;
    xs_mem_133175 = in2->mem;
    n_86133 = in2->shape[0];
    if (!(n_86133 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_int(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_86133, incr_86134, block_sizze_86135);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_86133;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_86133;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int16_t in1, const struct futhark_i64_1d *in2)
{
    int64_t n_87001 = (int64_t) 0;
    int64_t incr_87002 = (int64_t) 0;
    int16_t block_sizze_87003 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_87002 = in0;
    block_sizze_87003 = in1;
    xs_mem_133175 = in2->mem;
    n_87001 = in2->shape[0];
    if (!(n_87001 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_long(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_87001, incr_87002, block_sizze_87003);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_87001;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_87001;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int16_t in1, const struct futhark_i16_1d *in2)
{
    int64_t n_85265 = (int64_t) 0;
    int64_t incr_85266 = (int64_t) 0;
    int16_t block_sizze_85267 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock xs_mem_133175;
    
    xs_mem_133175.references = NULL;
    incr_85266 = in0;
    block_sizze_85267 = in1;
    xs_mem_133175 = in2->mem;
    n_85265 = in2->shape[0];
    if (!(n_85265 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_short(ctx, &mem_out_133513, &mem_out_133514, xs_mem_133175, n_85265, incr_85266, block_sizze_85267);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_85265;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_85265;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int16_t in0, const struct futhark_opaque_sortStruct_double *in1)
{
    int64_t n_72476 = (int64_t) 0;
    int64_t b_72477 = (int64_t) 0;
    int16_t block_sizze_72478 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    block_sizze_72478 = in0;
    k_mem_133175 = in1->v0->mem;
    n_72476 = in1->v0->shape[0];
    pL_mem_133176 = in1->v1->mem;
    n_72476 = in1->v1->shape[0];
    b_72477 = in1->v1->shape[1];
    if (!(n_72476 == in1->v0->shape[0] && (n_72476 == in1->v1->shape[0] && b_72477 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_double(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_72476, b_72477, block_sizze_72478);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_72476;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_72476;
            (*out0)->v1->shape[1] = b_72477;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int16_t in0, const struct futhark_opaque_sortStruct_float *in1)
{
    int64_t n_71526 = (int64_t) 0;
    int64_t b_71527 = (int64_t) 0;
    int16_t block_sizze_71528 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    block_sizze_71528 = in0;
    k_mem_133175 = in1->v0->mem;
    n_71526 = in1->v0->shape[0];
    pL_mem_133176 = in1->v1->mem;
    n_71526 = in1->v1->shape[0];
    b_71527 = in1->v1->shape[1];
    if (!(n_71526 == in1->v0->shape[0] && (n_71526 == in1->v1->shape[0] && b_71527 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_float(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_71526, b_71527, block_sizze_71528);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_71526;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_71526;
            (*out0)->v1->shape[1] = b_71527;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int16_t in0, const struct futhark_opaque_sortStruct_int *in1)
{
    int64_t n_69692 = (int64_t) 0;
    int64_t b_69693 = (int64_t) 0;
    int16_t block_sizze_69694 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    block_sizze_69694 = in0;
    k_mem_133175 = in1->v0->mem;
    n_69692 = in1->v0->shape[0];
    pL_mem_133176 = in1->v1->mem;
    n_69692 = in1->v1->shape[0];
    b_69693 = in1->v1->shape[1];
    if (!(n_69692 == in1->v0->shape[0] && (n_69692 == in1->v1->shape[0] && b_69693 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_int(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_69692, b_69693, block_sizze_69694);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_69692;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_69692;
            (*out0)->v1->shape[1] = b_69693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int16_t in0, const struct futhark_opaque_sortStruct_long *in1)
{
    int64_t n_70580 = (int64_t) 0;
    int64_t b_70581 = (int64_t) 0;
    int16_t block_sizze_70582 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    block_sizze_70582 = in0;
    k_mem_133175 = in1->v0->mem;
    n_70580 = in1->v0->shape[0];
    pL_mem_133176 = in1->v1->mem;
    n_70580 = in1->v1->shape[0];
    b_70581 = in1->v1->shape[1];
    if (!(n_70580 == in1->v0->shape[0] && (n_70580 == in1->v1->shape[0] && b_70581 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_long(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_70580, b_70581, block_sizze_70582);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_70580;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_70580;
            (*out0)->v1->shape[1] = b_70581;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int16_t in0, const struct futhark_opaque_sortStruct_short *in1)
{
    int64_t n_68798 = (int64_t) 0;
    int64_t b_68799 = (int64_t) 0;
    int16_t block_sizze_68800 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_133514;
    
    mem_out_133514.references = NULL;
    
    struct memblock mem_out_133513;
    
    mem_out_133513.references = NULL;
    
    struct memblock pL_mem_133176;
    
    pL_mem_133176.references = NULL;
    
    struct memblock k_mem_133175;
    
    k_mem_133175.references = NULL;
    block_sizze_68800 = in0;
    k_mem_133175 = in1->v0->mem;
    n_68798 = in1->v0->shape[0];
    pL_mem_133176 = in1->v1->mem;
    n_68798 = in1->v1->shape[0];
    b_68799 = in1->v1->shape[1];
    if (!(n_68798 == in1->v0->shape[0] && (n_68798 == in1->v1->shape[0] && b_68799 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_short(ctx, &mem_out_133513, &mem_out_133514, k_mem_133175, pL_mem_133176, n_68798, b_68799, block_sizze_68800);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_133513;
            (*out0)->v0->shape[0] = n_68798;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_133514;
            (*out0)->v1->shape[0] = n_68798;
            (*out0)->v1->shape[1] = b_68799;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
