// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
struct futhark_u8_2d;
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1);
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1);
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data);
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1);
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);

// Opaque values
struct futhark_opaque_joinPairs_bsq;
struct futhark_opaque_joinPairs_double;
struct futhark_opaque_joinPairs_float;
struct futhark_opaque_joinPairs_int;
struct futhark_opaque_joinPairs_long;
struct futhark_opaque_joinPairs_short;
struct futhark_opaque_partitionInfo;
struct futhark_opaque_partitionedSet_GFTR;
struct futhark_opaque_partitionedSet_GFUR;
struct futhark_opaque_radix_hashTable;
struct futhark_opaque_sortInfo_double;
struct futhark_opaque_sortInfo_float;
struct futhark_opaque_sortInfo_int;
struct futhark_opaque_sortInfo_long;
struct futhark_opaque_sortInfo_short;
struct futhark_opaque_sortStruct_double;
struct futhark_opaque_sortStruct_float;
struct futhark_opaque_sortStruct_int;
struct futhark_opaque_sortStruct_long;
struct futhark_opaque_sortStruct_short;
struct futhark_opaque_sortgroupInfo;
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj);
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs);
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj);
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs);
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj);
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs);
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj);
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs);
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj);
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs);
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj);
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs);
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj);
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n);
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj);
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth);
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks);
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj);
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n);
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx);
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj);
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs);
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj);
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs);
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj);
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs);
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj);
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs);
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj);
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs);
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj);
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj);
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj);
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj);
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj);
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo *obj);
int futhark_store_opaque_sortgroupInfo(struct futhark_context *ctx, const struct futhark_opaque_sortgroupInfo *obj, void **p, size_t *n);
struct futhark_opaque_sortgroupInfo *futhark_restore_opaque_sortgroupInfo(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortgroupInfo_group_count(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj);
int futhark_project_opaque_sortgroupInfo_group_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj);
int futhark_new_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out, const struct futhark_i64_1d *f_group_count, const struct futhark_i64_1d *f_group_idx);

// Entry points
int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4);
int futhark_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4);
int futhark_entry_alt_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2);
int futhark_entry_alt_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_alt_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2);
int futhark_entry_alt_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_alt_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2);
int futhark_entry_alt_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_alt_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2);
int futhark_entry_alt_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_alt_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2);
int futhark_entry_alt_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0);
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0);
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4);
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3);
int futhark_entry_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2);
int futhark_entry_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1);
int futhark_entry_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2);
int futhark_entry_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4);
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4);
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4);
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4);
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4);
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4);
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2);
int futhark_entry_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2);
int futhark_entry_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1);
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1);
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1);
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1);
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1);
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0);
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0);
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0);
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0);
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0);
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6, const int32_t in7);
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6, const int32_t in7);
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2);
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2);
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2);
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2);
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2);
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int64_t in0, const struct futhark_opaque_sortStruct_double *in1);
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int64_t in0, const struct futhark_opaque_sortStruct_float *in1);
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int64_t in0, const struct futhark_opaque_sortStruct_int *in1);
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int64_t in0, const struct futhark_opaque_sortStruct_long *in1);
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int64_t in0, const struct futhark_opaque_sortStruct_short *in1);
int futhark_entry_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2);
int futhark_entry_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1);
int futhark_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_c
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
};
struct tuning_params {
    int dummy;
};
static const int num_tuning_params = 0;
static const char *tuning_param_names[] = {NULL};
static const char *tuning_param_vars[] = {NULL};
static const char *tuning_param_classes[] = {NULL};
static int64_t tuning_param_defaults[] = {0};
// Start of backends/c.h

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char *cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
};

static void backend_context_config_setup(struct futhark_context_config* cfg) {
  (void)cfg;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  (void)cfg;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config* cfg, const char *param_name, size_t param_value) {
  (void)cfg; (void)param_name; (void)param_value;
  return 1;
}

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
};

int backend_context_setup(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  (void)ctx;
}

int futhark_context_sync(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

// End of backends/c.h

struct program {
    int dummy;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_172144, struct memblock *mem_out_p_172145, struct memblock *mem_out_p_172146, int64_t *out_prim_out_172147, struct memblock pR_mem_171274, struct memblock pS_mem_171275, struct memblock bounds_mem_171276, struct memblock depths_mem_171277, struct memblock first_info_idx_mem_171278, struct memblock last_info_idx_mem_171279, int64_t nR_140576, int64_t b_140577, int64_t nS_140578, int64_t dz2081U_140579, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, int32_t radix_sizze_140581, int32_t maxDepth_140586);
FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct memblock *mem_out_p_172188, struct memblock *mem_out_p_172189, struct memblock *mem_out_p_172190, int64_t *out_prim_out_172191, struct memblock pR_mem_171274, struct memblock pS_mem_171275, struct memblock bounds_mem_171276, struct memblock depths_mem_171277, struct memblock first_info_idx_mem_171278, struct memblock last_info_idx_mem_171279, int64_t nR_143049, int64_t b_143050, int64_t nS_143051, int64_t dz2081U_143052, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, int32_t radix_sizze_143054, int32_t maxDepth_143059);
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172204, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_152052, int64_t nz2080U_152053);
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172205, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_152119, int64_t nz2080U_152120);
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172207, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_151611, int64_t nz2080U_151612);
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172208, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_151678, int64_t nz2080U_151679);
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172210, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_150738, int64_t nz2080U_150739);
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172211, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_150805, int64_t nz2080U_150806);
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172213, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_151170, int64_t nz2080U_151171);
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172214, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_151237, int64_t nz2080U_151238);
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172216, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_150306, int64_t nz2080U_150307);
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172217, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_150373, int64_t nz2080U_150374);
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_172219, struct memblock ks_mem_171274, int64_t n_79452);
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_172220, struct memblock ks_mem_171274, int64_t n_79275);
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_172221, struct memblock ks_mem_171274, int64_t n_78924);
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_172222, struct memblock ks_mem_171274, int64_t n_79098);
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_172223, struct memblock ks_mem_171274, int64_t n_78750);
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172224, struct memblock *mem_out_p_172225, int64_t *out_prim_out_172226, int32_t *out_prim_out_172227, struct memblock pXs_mem_171274, int64_t n_131688, int64_t b_131689, int32_t radix_sizze_131690, int64_t offset_131692, int64_t sizze_thresh_131693, int32_t max_depth_131694);
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172235, struct memblock *mem_out_p_172236, int64_t *out_prim_out_172237, struct memblock pXs_mem_171274, struct memblock bounds_mem_171275, struct memblock depths_mem_171276, int64_t n_132270, int64_t b_132271, int64_t dz2080U_132272, int64_t dz2081U_132273, int32_t radix_sizze_132274, int32_t maxDepth_132278, int64_t scatter_psizze_132279);
FUTHARK_FUN_ATTR int futrts_entry_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172240, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149856, int64_t group_no_149857);
FUTHARK_FUN_ATTR int futrts_entry_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172241, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149933, int64_t group_no_149934);
FUTHARK_FUN_ATTR int futrts_entry_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172242, struct memblock ks_mem_171274, int64_t nz2082U_143157, int64_t key_no_143158);
FUTHARK_FUN_ATTR int futrts_entry_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172243, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149645, int64_t group_no_149646);
FUTHARK_FUN_ATTR int futrts_entry_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172244, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149722, int64_t group_no_149723);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_172245, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_81485, int64_t dz2083U_81486, int64_t incr_81487, int64_t psizze_81488, int64_t pL_bytes_81490);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_172247, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_81118, int64_t dz2083U_81119, int64_t incr_81120, int64_t psizze_81121);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172249, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81773, int64_t n_81774, int64_t incr_81775, int64_t psizze_81776);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_172251, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_81053, int64_t dz2083U_81054, int64_t incr_81055, int64_t psizze_81056);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172253, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81716, int64_t n_81717, int64_t incr_81718, int64_t psizze_81719);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_172255, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_80923, int64_t dz2083U_80924, int64_t incr_80925, int64_t psizze_80926);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172257, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81602, int64_t n_81603, int64_t incr_81604, int64_t psizze_81605);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_172259, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_80988, int64_t dz2083U_80989, int64_t incr_80990, int64_t psizze_80991);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172261, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81659, int64_t n_81660, int64_t incr_81661, int64_t psizze_81662);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_172263, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_80858, int64_t dz2083U_80859, int64_t incr_80860, int64_t psizze_80861);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172265, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81545, int64_t n_81546, int64_t incr_81547, int64_t psizze_81548);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_172267, struct memblock *mem_out_p_172268, struct memblock *mem_out_p_172269, int64_t *out_prim_out_172270, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_126913, int64_t nS_126914, int64_t offset_R_126917, int64_t offset_S_126918, int64_t partitionSizze_126919, int64_t scatter_psizze_126920);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_172281, struct memblock *mem_out_p_172282, struct memblock *mem_out_p_172283, int64_t *out_prim_out_172284, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_124250, int64_t nS_124251, int64_t offset_R_124254, int64_t offset_S_124255, int64_t partitionSizze_124256, int64_t scatter_psizze_124257);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_172295, struct memblock *mem_out_p_172296, struct memblock *mem_out_p_172297, int64_t *out_prim_out_172298, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_118936, int64_t nS_118937, int64_t offset_R_118940, int64_t offset_S_118941, int64_t partitionSizze_118942, int64_t scatter_psizze_118943);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_172309, struct memblock *mem_out_p_172310, struct memblock *mem_out_p_172311, int64_t *out_prim_out_172312, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_121587, int64_t nS_121588, int64_t offset_R_121591, int64_t offset_S_121592, int64_t partitionSizze_121593, int64_t scatter_psizze_121594);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_172323, struct memblock *mem_out_p_172324, struct memblock *mem_out_p_172325, int64_t *out_prim_out_172326, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_116273, int64_t nS_116274, int64_t offset_R_116277, int64_t offset_S_116278, int64_t partitionSizze_116279, int64_t scatter_psizze_116280);
FUTHARK_FUN_ATTR int futrts_entry_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172337, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149236, int64_t group_no_149237);
FUTHARK_FUN_ATTR int futrts_entry_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172338, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149313, int64_t group_no_149314);
FUTHARK_FUN_ATTR int futrts_entry_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172339, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149442, int64_t group_no_149443);
FUTHARK_FUN_ATTR int futrts_entry_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172340, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149509, int64_t group_no_149510);
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_172341, struct memblock eta_p_mem_171274, int64_t nz2080U_79529);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_172342, struct memblock *mem_out_p_172343, struct memblock xs_mem_171274, int64_t n_113368, int64_t incr_113369);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_172354, struct memblock *mem_out_p_172355, struct memblock xs_mem_171274, int64_t n_111223, int64_t incr_111224);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_172366, struct memblock *mem_out_p_172367, struct memblock xs_mem_171274, int64_t n_106937, int64_t incr_106938);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_172378, struct memblock *mem_out_p_172379, struct memblock xs_mem_171274, int64_t n_109078, int64_t incr_109079);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_172390, struct memblock *mem_out_p_172391, struct memblock xs_mem_171274, int64_t n_104792, int64_t incr_104793);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_172402, struct memblock *mem_out_p_172403, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_98299, int64_t b_98300);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_172414, struct memblock *mem_out_p_172415, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_95934, int64_t b_95935);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_172426, struct memblock *mem_out_p_172427, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_91210, int64_t b_91211);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_172438, struct memblock *mem_out_p_172439, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_93569, int64_t b_93570);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_172450, struct memblock *mem_out_p_172451, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_88845, int64_t b_88846);
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_172462, struct memblock eta_p_mem_171274, int64_t nz2080U_79489);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_172463, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80791, int64_t incr_80792, int64_t block_sizze_80793);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_172465, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80539, int64_t incr_80540, int64_t block_sizze_80541);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_172467, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80035, int64_t incr_80036, int64_t block_sizze_80037);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_172469, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80287, int64_t incr_80288, int64_t block_sizze_80289);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_172471, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_79783, int64_t incr_79784, int64_t block_sizze_79785);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_172473, struct memblock *mem_out_p_172474, struct memblock xs_mem_171274, struct memblock pL_mem_171275, int64_t n_129492, int64_t b_129493, int64_t pL_b_129494, int16_t block_sizze_129495, int64_t gather_psizze_129496, int32_t radix_sizze_129497, int64_t sizze_thresh_129500, int32_t max_depth_129501, int32_t bit_step_129502);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172486, struct memblock *mem_out_p_172487, struct memblock xs_mem_171274, int64_t n_130862, int64_t b_130863, int16_t block_sizze_130864, int64_t gather_psizze_130865, int32_t radix_sizze_130866, int64_t offset_130868, int64_t sizze_thresh_130869, int32_t max_depth_130870, int32_t bit_step_130871);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_172498, struct memblock *mem_out_p_172499, struct memblock xs_mem_171274, int64_t n_102646, int64_t incr_102647, int64_t block_sizze_102648);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_172503, struct memblock *mem_out_p_172504, struct memblock xs_mem_171274, int64_t n_101764, int64_t incr_101765, int64_t block_sizze_101766);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_172508, struct memblock *mem_out_p_172509, struct memblock xs_mem_171274, int64_t n_100021, int64_t incr_100022, int64_t block_sizze_100023);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_172513, struct memblock *mem_out_p_172514, struct memblock xs_mem_171274, int64_t n_100882, int64_t incr_100883, int64_t block_sizze_100884);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_172518, struct memblock *mem_out_p_172519, struct memblock xs_mem_171274, int64_t n_99160, int64_t incr_99161, int64_t block_sizze_99162);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_172523, struct memblock *mem_out_p_172524, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_86374, int64_t b_86375, int64_t block_sizze_86376);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_172529, struct memblock *mem_out_p_172530, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_85431, int64_t b_85432, int64_t block_sizze_85433);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_172535, struct memblock *mem_out_p_172536, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_83613, int64_t b_83614, int64_t block_sizze_83615);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_172541, struct memblock *mem_out_p_172542, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_84492, int64_t b_84493, int64_t block_sizze_84494);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_172547, struct memblock *mem_out_p_172548, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_82726, int64_t b_82727, int64_t block_sizze_82728);
FUTHARK_FUN_ATTR int futrts_entry_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172553, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149025, int64_t group_no_149026);
FUTHARK_FUN_ATTR int futrts_entry_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172554, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149102, int64_t group_no_149103);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_172555, struct memblock *mem_out_p_172556, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_147112, int64_t dz2081U_147113);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_172557, struct memblock *mem_out_p_172558, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_146322, int64_t dz2081U_146323);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_172559, struct memblock *mem_out_p_172560, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_144742, int64_t dz2081U_144743);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172561, struct memblock *mem_out_p_172562, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_145532, int64_t dz2081U_145533);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_172563, struct memblock *mem_out_p_172564, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_143952, int64_t dz2081U_143953);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_172565, struct memblock *mem_out_p_172566, int64_t *out_prim_out_172567, struct memblock ks_mem_171274, int64_t dz2080U_148890);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_172570, struct memblock *mem_out_p_172571, int64_t *out_prim_out_172572, struct memblock ks_mem_171274, int64_t dz2080U_148542);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_172575, struct memblock *mem_out_p_172576, int64_t *out_prim_out_172577, struct memblock ks_mem_171274, int64_t dz2080U_147846);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172580, struct memblock *mem_out_p_172581, int64_t *out_prim_out_172582, struct memblock ks_mem_171274, int64_t dz2080U_148194);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_172585, struct memblock *mem_out_p_172586, int64_t *out_prim_out_172587, struct memblock ks_mem_171274, int64_t dz2080U_147498);
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_16843(struct futhark_context *ctx, struct memblock *mem_out_p_172590, struct memblock *mem_out_p_172591, int64_t *out_prim_out_172592, int64_t *out_prim_out_172593, int32_t *out_prim_out_172594, struct memblock pXs_mem_171274, int64_t n_128638, int64_t b_128639, int32_t curDepth_128640, int32_t i_128642, int32_t j_128643);
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_172601, int32_t bit_82102, int16_t x_82103);
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_172602, int32_t bit_83868, int64_t x_83869);
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5312(struct futhark_context *ctx, int64_t *out_prim_out_172603, int64_t upper_bound_86403, int64_t n_86404);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16256(struct futhark_context *ctx, struct memblock *mem_out_p_172604, struct memblock nameless_mem_171274, int64_t n_98324, int64_t incr_98325);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16277(struct futhark_context *ctx, struct memblock *mem_out_p_172605, struct memblock nameless_mem_171274, int64_t n_99185, int64_t incr_99186);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16299(struct futhark_context *ctx, struct memblock *mem_out_p_172606, struct memblock nameless_mem_171274, int64_t n_100046, int64_t incr_100047);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16321(struct futhark_context *ctx, struct memblock *mem_out_p_172607, struct memblock nameless_mem_171274, int64_t n_100907, int64_t incr_100908);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16342(struct futhark_context *ctx, struct memblock *mem_out_p_172608, struct memblock nameless_mem_171274, int64_t n_101789, int64_t incr_101790);
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_15223(struct futhark_context *ctx, int64_t *out_prim_out_172609, int64_t *out_prim_out_172610, int64_t *out_prim_out_172611, int64_t *out_prim_out_172612, int64_t *out_prim_out_172613, int64_t slo_86633, int64_t shi_86634, int64_t tlo_86635, int64_t thi_86636, int64_t count_86637);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15578(struct futhark_context *ctx, struct memblock *mem_out_p_172614, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_79649, int64_t n_79650, int32_t n_bits_79651, int64_t psizze_79652);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15590(struct futhark_context *ctx, struct memblock *mem_out_p_172615, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_79901, int64_t n_79902, int32_t n_bits_79903, int64_t psizze_79904);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15601(struct futhark_context *ctx, struct memblock *mem_out_p_172616, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_80153, int64_t n_80154, int32_t n_bits_80155, int64_t psizze_80156);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15613(struct futhark_context *ctx, struct memblock *mem_out_p_172617, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_80405, int64_t n_80406, int32_t n_bits_80407, int64_t psizze_80408);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15625(struct futhark_context *ctx, struct memblock *mem_out_p_172618, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_80657, int64_t n_80658, int32_t n_bits_80659, int64_t psizze_80660);
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_172619, int32_t bit_81811, int8_t x_81812, int32_t b_81813);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
struct futhark_u8_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 1 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) (dim0 * dim1) * 1);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 1 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] * arr->shape[1]) * 1);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        if (1 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 1 * (i0 * arr->shape[1] + i1 * 1), 1);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i16_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 2 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 2);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 2 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 2);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (2 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 2 * (i0 * 1), 2);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_sortStruct_short {
    struct futhark_i16_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_short *v = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i16_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_short *obj = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int16_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i16_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_int {
    struct futhark_i32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_int *v = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_int *obj = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int32_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_long {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_long *v = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_long *obj = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_float {
    struct futhark_f32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_float *v = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_float *obj = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(float);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_double {
    struct futhark_f64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_double *v = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_double *obj = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(double);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_short {
    struct futhark_i64_1d *v0;
    struct futhark_i16_1d *v1;
};
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs)
{
    struct futhark_opaque_sortInfo_short *v = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i16_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_short *obj = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i16_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_int {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
};
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_int *v = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_int *obj = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_long *v = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_long *obj = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_float {
    struct futhark_i64_1d *v0;
    struct futhark_f32_1d *v1;
};
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_float *v = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_float *obj = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_double {
    struct futhark_i64_1d *v0;
    struct futhark_f64_1d *v1;
};
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_double *v = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_double *obj = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_short {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i16_1d *v2;
};
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs)
{
    struct futhark_opaque_joinPairs_short *v = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i16_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_short *obj = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i16_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_int {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i32_1d *v2;
};
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_int *v = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_int *obj = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_long *v = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_long *obj = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_1d *v2;
};
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_float *v = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_float *obj = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
};
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_double *v = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_double *obj = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFTR {
    struct futhark_u8_2d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_partitionedSet_GFTR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_u8_2d));
        *v->v0 = *f_ks;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFTR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(int8_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_u8_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFUR {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks)
{
    struct futhark_opaque_partitionedSet_GFUR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_ks;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFUR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionInfo {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
    int32_t v2;
};
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int32_t v;
    
    v = obj->v2;
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth)
{
    struct futhark_opaque_partitionInfo *v = malloc(sizeof(struct futhark_opaque_partitionInfo));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_bounds;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_depths;
        (void) (*v->v1->mem.references)++;
    }
    v->v2 = f_maxDepth;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
    }
    return ret;
}
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionInfo *obj = malloc(sizeof(struct futhark_opaque_partitionInfo));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_radix_hashTable {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx)
{
    struct futhark_opaque_radix_hashTable *v = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_first_info_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_last_info_idx;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_radix_hashTable *obj = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_bsq {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_u8_2d *v2;
};
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v2, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs)
{
    struct futhark_opaque_joinPairs_bsq *v = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_u8_2d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_bsq *obj = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_u8_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortgroupInfo {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortgroupInfo_group_count(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortgroupInfo_group_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out, const struct futhark_i64_1d *f_group_count, const struct futhark_i64_1d *f_group_idx)
{
    struct futhark_opaque_sortgroupInfo *v = malloc(sizeof(struct futhark_opaque_sortgroupInfo));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_group_count;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_group_idx;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortgroupInfo(struct futhark_context *ctx, const struct futhark_opaque_sortgroupInfo *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortgroupInfo *futhark_restore_opaque_sortgroupInfo(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortgroupInfo *obj = malloc(sizeof(struct futhark_opaque_sortgroupInfo));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_172144, struct memblock *mem_out_p_172145, struct memblock *mem_out_p_172146, int64_t *out_prim_out_172147, struct memblock pR_mem_171274, struct memblock pS_mem_171275, struct memblock bounds_mem_171276, struct memblock depths_mem_171277, struct memblock first_info_idx_mem_171278, struct memblock last_info_idx_mem_171279, int64_t nR_140576, int64_t b_140577, int64_t nS_140578, int64_t dz2081U_140579, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, int32_t radix_sizze_140581, int32_t maxDepth_140586)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171281_cached_sizze_172148 = 0;
    unsigned char *mem_171281 = NULL;
    int64_t mem_171289_cached_sizze_172149 = 0;
    unsigned char *mem_171289 = NULL;
    int64_t mem_171291_cached_sizze_172150 = 0;
    unsigned char *mem_171291 = NULL;
    int64_t mem_171293_cached_sizze_172151 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172152 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171297_cached_sizze_172153 = 0;
    unsigned char *mem_171297 = NULL;
    int64_t mem_171299_cached_sizze_172154 = 0;
    unsigned char *mem_171299 = NULL;
    int64_t mem_171337_cached_sizze_172155 = 0;
    unsigned char *mem_171337 = NULL;
    int64_t mem_171345_cached_sizze_172156 = 0;
    unsigned char *mem_171345 = NULL;
    int64_t mem_171347_cached_sizze_172157 = 0;
    unsigned char *mem_171347 = NULL;
    int64_t mem_171419_cached_sizze_172158 = 0;
    unsigned char *mem_171419 = NULL;
    int64_t mem_171427_cached_sizze_172159 = 0;
    unsigned char *mem_171427 = NULL;
    int64_t mem_171429_cached_sizze_172160 = 0;
    unsigned char *mem_171429 = NULL;
    int64_t mem_171431_cached_sizze_172161 = 0;
    unsigned char *mem_171431 = NULL;
    int64_t mem_171433_cached_sizze_172162 = 0;
    unsigned char *mem_171433 = NULL;
    int64_t mem_171435_cached_sizze_172163 = 0;
    unsigned char *mem_171435 = NULL;
    int64_t mem_171437_cached_sizze_172164 = 0;
    unsigned char *mem_171437 = NULL;
    int64_t mem_171475_cached_sizze_172165 = 0;
    unsigned char *mem_171475 = NULL;
    int64_t mem_171483_cached_sizze_172166 = 0;
    unsigned char *mem_171483 = NULL;
    int64_t mem_171485_cached_sizze_172167 = 0;
    unsigned char *mem_171485 = NULL;
    int64_t mem_171565_cached_sizze_172168 = 0;
    unsigned char *mem_171565 = NULL;
    int64_t mem_171573_cached_sizze_172169 = 0;
    unsigned char *mem_171573 = NULL;
    int64_t mem_171575_cached_sizze_172170 = 0;
    unsigned char *mem_171575 = NULL;
    int64_t mem_171577_cached_sizze_172171 = 0;
    unsigned char *mem_171577 = NULL;
    int64_t mem_171579_cached_sizze_172172 = 0;
    unsigned char *mem_171579 = NULL;
    int64_t mem_171581_cached_sizze_172173 = 0;
    unsigned char *mem_171581 = NULL;
    int64_t mem_171583_cached_sizze_172174 = 0;
    unsigned char *mem_171583 = NULL;
    int64_t mem_171621_cached_sizze_172175 = 0;
    unsigned char *mem_171621 = NULL;
    int64_t mem_171629_cached_sizze_172176 = 0;
    unsigned char *mem_171629 = NULL;
    int64_t mem_171631_cached_sizze_172177 = 0;
    unsigned char *mem_171631 = NULL;
    int64_t mem_171710_cached_sizze_172178 = 0;
    unsigned char *mem_171710 = NULL;
    int64_t mem_171718_cached_sizze_172179 = 0;
    unsigned char *mem_171718 = NULL;
    int64_t mem_171720_cached_sizze_172180 = 0;
    unsigned char *mem_171720 = NULL;
    int64_t mem_171722_cached_sizze_172181 = 0;
    unsigned char *mem_171722 = NULL;
    int64_t mem_171724_cached_sizze_172182 = 0;
    unsigned char *mem_171724 = NULL;
    int64_t mem_171726_cached_sizze_172183 = 0;
    unsigned char *mem_171726 = NULL;
    int64_t mem_171727_cached_sizze_172184 = 0;
    unsigned char *mem_171727 = NULL;
    int64_t mem_171765_cached_sizze_172185 = 0;
    unsigned char *mem_171765 = NULL;
    int64_t mem_171773_cached_sizze_172186 = 0;
    unsigned char *mem_171773 = NULL;
    int64_t mem_171775_cached_sizze_172187 = 0;
    unsigned char *mem_171775 = NULL;
    struct memblock mem_171417;
    
    mem_171417.references = NULL;
    
    struct memblock mem_171401;
    
    mem_171401.references = NULL;
    
    struct memblock mem_171399;
    
    mem_171399.references = NULL;
    
    struct memblock mem_param_tmp_172134;
    
    mem_param_tmp_172134.references = NULL;
    
    struct memblock mem_param_tmp_172133;
    
    mem_param_tmp_172133.references = NULL;
    
    struct memblock mem_171379;
    
    mem_171379.references = NULL;
    
    struct memblock mem_171377;
    
    mem_171377.references = NULL;
    
    struct memblock mem_param_171375;
    
    mem_param_171375.references = NULL;
    
    struct memblock mem_param_171372;
    
    mem_param_171372.references = NULL;
    
    struct memblock ext_mem_171396;
    
    ext_mem_171396.references = NULL;
    
    struct memblock ext_mem_171397;
    
    ext_mem_171397.references = NULL;
    
    struct memblock mem_171369;
    
    mem_171369.references = NULL;
    
    struct memblock mem_171361;
    
    mem_171361.references = NULL;
    
    struct memblock mem_171555;
    
    mem_171555.references = NULL;
    
    struct memblock mem_171539;
    
    mem_171539.references = NULL;
    
    struct memblock mem_171537;
    
    mem_171537.references = NULL;
    
    struct memblock mem_param_tmp_172088;
    
    mem_param_tmp_172088.references = NULL;
    
    struct memblock mem_param_tmp_172087;
    
    mem_param_tmp_172087.references = NULL;
    
    struct memblock mem_171517;
    
    mem_171517.references = NULL;
    
    struct memblock mem_171515;
    
    mem_171515.references = NULL;
    
    struct memblock mem_param_171513;
    
    mem_param_171513.references = NULL;
    
    struct memblock mem_param_171510;
    
    mem_param_171510.references = NULL;
    
    struct memblock ext_mem_171534;
    
    ext_mem_171534.references = NULL;
    
    struct memblock ext_mem_171535;
    
    ext_mem_171535.references = NULL;
    
    struct memblock mem_171507;
    
    mem_171507.references = NULL;
    
    struct memblock mem_171499;
    
    mem_171499.references = NULL;
    
    struct memblock ext_mem_171559;
    
    ext_mem_171559.references = NULL;
    
    struct memblock ext_mem_171562;
    
    ext_mem_171562.references = NULL;
    
    struct memblock ext_mem_171563;
    
    ext_mem_171563.references = NULL;
    
    struct memblock mem_171701;
    
    mem_171701.references = NULL;
    
    struct memblock mem_171685;
    
    mem_171685.references = NULL;
    
    struct memblock mem_171683;
    
    mem_171683.references = NULL;
    
    struct memblock mem_param_tmp_172042;
    
    mem_param_tmp_172042.references = NULL;
    
    struct memblock mem_param_tmp_172041;
    
    mem_param_tmp_172041.references = NULL;
    
    struct memblock mem_171663;
    
    mem_171663.references = NULL;
    
    struct memblock mem_171661;
    
    mem_171661.references = NULL;
    
    struct memblock mem_param_171659;
    
    mem_param_171659.references = NULL;
    
    struct memblock mem_param_171656;
    
    mem_param_171656.references = NULL;
    
    struct memblock ext_mem_171680;
    
    ext_mem_171680.references = NULL;
    
    struct memblock ext_mem_171681;
    
    ext_mem_171681.references = NULL;
    
    struct memblock mem_171653;
    
    mem_171653.references = NULL;
    
    struct memblock mem_171645;
    
    mem_171645.references = NULL;
    
    struct memblock ext_mem_171705;
    
    ext_mem_171705.references = NULL;
    
    struct memblock ext_mem_171708;
    
    ext_mem_171708.references = NULL;
    
    struct memblock ext_mem_171709;
    
    ext_mem_171709.references = NULL;
    
    struct memblock mem_171845;
    
    mem_171845.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_171827;
    
    mem_171827.references = NULL;
    
    struct memblock mem_param_tmp_171996;
    
    mem_param_tmp_171996.references = NULL;
    
    struct memblock mem_param_tmp_171995;
    
    mem_param_tmp_171995.references = NULL;
    
    struct memblock mem_171807;
    
    mem_171807.references = NULL;
    
    struct memblock mem_171805;
    
    mem_171805.references = NULL;
    
    struct memblock mem_param_171803;
    
    mem_param_171803.references = NULL;
    
    struct memblock mem_param_171800;
    
    mem_param_171800.references = NULL;
    
    struct memblock ext_mem_171824;
    
    ext_mem_171824.references = NULL;
    
    struct memblock ext_mem_171825;
    
    ext_mem_171825.references = NULL;
    
    struct memblock mem_171797;
    
    mem_171797.references = NULL;
    
    struct memblock mem_171789;
    
    mem_171789.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock ext_mem_171852;
    
    ext_mem_171852.references = NULL;
    
    struct memblock ext_mem_171853;
    
    ext_mem_171853.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t i32_res_158696 = sext_i32_i64(radix_sizze_140581);
    bool nonnegative_158697 = sle64((int64_t) 0, i32_res_158696);
    bool nonzzero_cert_158698;
    
    if (!nonnegative_158697) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:8:47-259:55\n   #1  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_158699 = shl64((int64_t) 1, i32_res_158696);
    bool assert_cond_158700 = arg_158699 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580;
    bool assert_c_158701;
    
    if (!assert_cond_158700) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftRelational.fut:259:6-261:20\n   #1  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_158702 = b_140577 == (int64_t) 1;
    bool cond_158703 = b_140577 == (int64_t) 2;
    bool cond_158704 = sle64(b_140577, (int64_t) 4);
    int64_t unsign_arg0_158705 = zext_i32_i64(radix_sizze_140581);
    int64_t asPow_158706 = shl64((int64_t) 1, unsign_arg0_158705);
    int64_t u64_arg0_158707 = sub64(asPow_158706, (int64_t) 1);
    int64_t zeze_rhs_158708 = sub64(dz2081U_140579, (int64_t) 1);
    bool cond_158709 = nR_140576 == (int64_t) 0;
    bool x_158710 = !cond_158709;
    int64_t tmp_158711 = sub64(nR_140576, (int64_t) 1);
    bool x_158712 = sle64((int64_t) 0, tmp_158711);
    bool y_158713 = slt64(tmp_158711, nR_140576);
    bool bounds_check_158714 = x_158712 && y_158713;
    bool protect_assert_disj_158715 = cond_158709 || bounds_check_158714;
    bool protect_assert_disj_158716 = cond_158704 || protect_assert_disj_158715;
    bool protect_assert_disj_158717 = cond_158703 || protect_assert_disj_158716;
    bool protect_assert_disj_158718 = cond_158702 || protect_assert_disj_158717;
    bool index_certs_158719;
    
    if (!protect_assert_disj_158718) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_158711, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-856:44\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t u64_res_158720 = zext_i64_i32(asPow_158706);
    int32_t za_rhs_158721 = sub32(u64_res_158720, 1);
    bool loop_not_taken_158722 = !cond_158704;
    bool protect_assert_disj_158723 = protect_assert_disj_158715 || loop_not_taken_158722;
    bool protect_assert_disj_158724 = cond_158703 || protect_assert_disj_158723;
    bool protect_assert_disj_158725 = cond_158702 || protect_assert_disj_158724;
    bool index_certs_158726;
    
    if (!protect_assert_disj_158725) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_158711, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-855:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int16_t u64_res_158727 = zext_i64_i16(u64_arg0_158707);
    bool loop_not_taken_158728 = !cond_158703;
    bool protect_assert_disj_158729 = protect_assert_disj_158715 || loop_not_taken_158728;
    bool protect_assert_disj_158730 = cond_158702 || protect_assert_disj_158729;
    bool index_certs_158731;
    
    if (!protect_assert_disj_158730) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_158711, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-854:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int8_t u64_res_158732 = zext_i64_i8(u64_arg0_158707);
    bool loop_not_taken_158733 = !cond_158702;
    bool protect_assert_disj_158734 = protect_assert_disj_158715 || loop_not_taken_158733;
    bool index_certs_158735;
    
    if (!protect_assert_disj_158734) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_158711, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-853:51\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171280 = (int64_t) 8 * nS_140578;
    int64_t bytes_171288 = (int64_t) 8 * nR_140576;
    int64_t bytes_171418 = (int64_t) 4 * nS_140578;
    int64_t bytes_171436 = (int64_t) 4 * nR_140576;
    int64_t bytes_171564 = (int64_t) 2 * nS_140578;
    int64_t bytes_171582 = (int64_t) 2 * nR_140576;
    int64_t radix_hash_join_res_158736;
    int64_t radix_hash_join_res_158737;
    int64_t radix_hash_join_res_158738;
    
    if (cond_158702) {
        if (mem_171710_cached_sizze_172178 < nS_140578) {
            err = lexical_realloc(ctx, &mem_171710, &mem_171710_cached_sizze_172178, nS_140578);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < nS_140578; i_171003++) {
            int8_t defunc_0_byteSeq_to_prim_res_169418;
            int8_t y_169420 = (int8_t) 0;
            
            for (int64_t i_169419 = 0; i_169419 < b_140577; i_169419++) {
                int64_t zm_lhs_169421 = sub64(b_140577, i_169419);
                int64_t from_u8_arg0_169422 = sub64(zm_lhs_169421, (int64_t) 1);
                bool x_169423 = sle64((int64_t) 0, from_u8_arg0_169422);
                bool y_169424 = slt64(from_u8_arg0_169422, b_140577);
                bool bounds_check_169425 = x_169423 && y_169424;
                bool index_certs_169426;
                
                if (!bounds_check_169425) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_169422, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:423:70-76\n   #2  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_169427 = ((int8_t *) pS_mem_171275.mem)[i_171003 * b_140577 + from_u8_arg0_169422];
                int32_t i64_res_169428 = sext_i64_i32(i_169419);
                int32_t shift_left_rhs_169429 = mul32(8, i64_res_169428);
                int8_t unsign_arg0_169430 = zext_i32_i8(shift_left_rhs_169429);
                int8_t lifted_lambda_res_169431 = shl8(from_u8_arg0_169427, unsign_arg0_169430);
                int8_t unsign_arg0_169432 = y_169420 | lifted_lambda_res_169431;
                int8_t y_tmp_171961 = unsign_arg0_169432;
                
                y_169420 = y_tmp_171961;
            }
            defunc_0_byteSeq_to_prim_res_169418 = y_169420;
            ((int8_t *) mem_171710)[i_171003] = defunc_0_byteSeq_to_prim_res_169418;
        }
        if (mem_171718_cached_sizze_172179 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171718, &mem_171718_cached_sizze_172179, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171720_cached_sizze_172180 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171720, &mem_171720_cached_sizze_172180, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171722_cached_sizze_172181 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171722, &mem_171722_cached_sizze_172181, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171724_cached_sizze_172182 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171724, &mem_171724_cached_sizze_172182, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171726_cached_sizze_172183 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171726, &mem_171726_cached_sizze_172183, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171727_cached_sizze_172184 < nR_140576) {
            err = lexical_realloc(ctx, &mem_171727, &mem_171727_cached_sizze_172184, nR_140576);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_171027;
        int64_t discard_171028;
        int64_t defunc_res_169437;
        int64_t scanacc_171011;
        int64_t scanacc_171012;
        int64_t redout_171015;
        
        scanacc_171011 = (int64_t) 0;
        scanacc_171012 = (int64_t) 0;
        redout_171015 = (int64_t) 0;
        for (int64_t i_171020 = 0; i_171020 < nR_140576; i_171020++) {
            int8_t defunc_0_byteSeq_to_prim_res_169443;
            int8_t y_169445 = (int8_t) 0;
            
            for (int64_t i_169444 = 0; i_169444 < b_140577; i_169444++) {
                int64_t zm_lhs_169446 = sub64(b_140577, i_169444);
                int64_t from_u8_arg0_169447 = sub64(zm_lhs_169446, (int64_t) 1);
                bool x_169448 = sle64((int64_t) 0, from_u8_arg0_169447);
                bool y_169449 = slt64(from_u8_arg0_169447, b_140577);
                bool bounds_check_169450 = x_169448 && y_169449;
                bool index_certs_169451;
                
                if (!bounds_check_169450) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_169447, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:423:70-76\n   #2  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_169452 = ((int8_t *) pR_mem_171274.mem)[i_171020 * b_140577 + from_u8_arg0_169447];
                int32_t i64_res_169453 = sext_i64_i32(i_169444);
                int32_t shift_left_rhs_169454 = mul32(8, i64_res_169453);
                int8_t unsign_arg0_169455 = zext_i32_i8(shift_left_rhs_169454);
                int8_t lifted_lambda_res_169456 = shl8(from_u8_arg0_169452, unsign_arg0_169455);
                int8_t unsign_arg0_169457 = y_169445 | lifted_lambda_res_169456;
                int8_t y_tmp_171971 = unsign_arg0_169457;
                
                y_169445 = y_tmp_171971;
            }
            defunc_0_byteSeq_to_prim_res_169443 = y_169445;
            
            int8_t lifted_lambda_res_169458 = u64_res_158732 & defunc_0_byteSeq_to_prim_res_169443;
            int64_t u8_res_169459 = zext_i8_i64(lifted_lambda_res_169458);
            bool x_169460 = sle64((int64_t) 0, u8_res_169459);
            bool y_169461 = slt64(u8_res_169459, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580);
            bool bounds_check_169462 = x_169460 && y_169461;
            bool index_certs_169463;
            
            if (!bounds_check_169462) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_res_169459, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t spi_169464 = ((int64_t *) first_info_idx_mem_171278.mem)[u8_res_169459];
            bool cond_169465 = slt64(spi_169464, (int64_t) 0);
            int64_t defunc_res_169466;
            
            if (cond_169465) {
                defunc_res_169466 = (int64_t) -1;
            } else {
                int64_t zeze_rhs_169467 = ((int64_t *) last_info_idx_mem_171279.mem)[u8_res_169459];
                bool cond_169468 = spi_169464 == zeze_rhs_169467;
                int64_t defunc_res_f_res_169469;
                
                if (cond_169468) {
                    defunc_res_f_res_169469 = spi_169464;
                } else {
                    int64_t zs_lhs_169470 = sub64(zeze_rhs_169467, spi_169464);
                    int64_t max_arg1_169471 = sdiv64(zs_lhs_169470, (int64_t) 2);
                    int64_t max_res_169472 = smax64((int64_t) 1, max_arg1_169471);
                    bool loop_cond_169473 = slt64((int64_t) 0, max_res_169472);
                    bool bsearch_169474;
                    int64_t bsearch_169475;
                    int64_t bsearch_169476;
                    bool loop_while_169477;
                    int64_t heshi_169478;
                    int64_t step_169479;
                    
                    loop_while_169477 = loop_cond_169473;
                    heshi_169478 = spi_169464;
                    step_169479 = max_res_169472;
                    while (loop_while_169477) {
                        bool x_169480 = sle64((int64_t) 0, heshi_169478);
                        bool y_169481 = slt64(heshi_169478, dz2081U_140579);
                        bool bounds_check_169482 = x_169480 && y_169481;
                        bool index_certs_169483;
                        
                        if (!bounds_check_169482) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_169478, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t cur_S_169501 = ((int64_t *) bounds_mem_171276.mem)[heshi_169478];
                        bool x_169502 = sle64((int64_t) 0, cur_S_169501);
                        bool y_169503 = slt64(cur_S_169501, nS_140578);
                        bool bounds_check_169504 = x_169502 && y_169503;
                        bool index_certs_169505;
                        
                        if (!bounds_check_169504) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_169501, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t cur_depth_169484 = ((int32_t *) depths_mem_171277.mem)[heshi_169478];
                        bool cond_169485 = heshi_169478 == spi_169464;
                        int32_t prev_depth_169486;
                        
                        if (cond_169485) {
                            prev_depth_169486 = cur_depth_169484;
                        } else {
                            int64_t tmp_169487 = sub64(heshi_169478, (int64_t) 1);
                            bool x_169488 = sle64((int64_t) 0, tmp_169487);
                            bool y_169489 = slt64(tmp_169487, dz2081U_140579);
                            bool bounds_check_169490 = x_169488 && y_169489;
                            bool index_certs_169491;
                            
                            if (!bounds_check_169490) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169487, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t prev_depth_f_res_169492 = ((int32_t *) depths_mem_171277.mem)[tmp_169487];
                            
                            prev_depth_169486 = prev_depth_f_res_169492;
                        }
                        
                        bool cond_169493 = heshi_169478 == zeze_rhs_169467;
                        int32_t next_depth_169494;
                        
                        if (cond_169493) {
                            next_depth_169494 = cur_depth_169484;
                        } else {
                            int64_t tmp_169495 = add64((int64_t) 1, heshi_169478);
                            bool x_169496 = sle64((int64_t) 0, tmp_169495);
                            bool y_169497 = slt64(tmp_169495, dz2081U_140579);
                            bool bounds_check_169498 = x_169496 && y_169497;
                            bool index_certs_169499;
                            
                            if (!bounds_check_169498) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169495, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t next_depth_f_res_169500 = ((int32_t *) depths_mem_171277.mem)[tmp_169495];
                            
                            next_depth_169494 = next_depth_f_res_169500;
                        }
                        
                        int8_t cur_S_169506 = ((int8_t *) mem_171710)[cur_S_169501];
                        int8_t prev_S_169507;
                        
                        if (cond_169485) {
                            prev_S_169507 = cur_S_169506;
                        } else {
                            int64_t tmp_169508 = sub64(heshi_169478, (int64_t) 1);
                            bool x_169509 = sle64((int64_t) 0, tmp_169508);
                            bool y_169510 = slt64(tmp_169508, dz2081U_140579);
                            bool bounds_check_169511 = x_169509 && y_169510;
                            bool index_certs_169512;
                            
                            if (!bounds_check_169511) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169508, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_169513 = ((int64_t *) bounds_mem_171276.mem)[tmp_169508];
                            bool x_169514 = sle64((int64_t) 0, tmp_169513);
                            bool y_169515 = slt64(tmp_169513, nS_140578);
                            bool bounds_check_169516 = x_169514 && y_169515;
                            bool index_certs_169517;
                            
                            if (!bounds_check_169516) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169513, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t prev_S_f_res_169518 = ((int8_t *) mem_171710)[tmp_169513];
                            
                            prev_S_169507 = prev_S_f_res_169518;
                        }
                        
                        int8_t next_S_169519;
                        
                        if (cond_169493) {
                            next_S_169519 = cur_S_169506;
                        } else {
                            int64_t tmp_169520 = add64((int64_t) 1, heshi_169478);
                            bool x_169521 = sle64((int64_t) 0, tmp_169520);
                            bool y_169522 = slt64(tmp_169520, dz2081U_140579);
                            bool bounds_check_169523 = x_169521 && y_169522;
                            bool index_certs_169524;
                            
                            if (!bounds_check_169523) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169520, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_169525 = ((int64_t *) bounds_mem_171276.mem)[tmp_169520];
                            bool x_169526 = sle64((int64_t) 0, tmp_169525);
                            bool y_169527 = slt64(tmp_169525, nS_140578);
                            bool bounds_check_169528 = x_169526 && y_169527;
                            bool index_certs_169529;
                            
                            if (!bounds_check_169528) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169525, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:594:3-601:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t next_S_f_res_169530 = ((int8_t *) mem_171710)[tmp_169525];
                            
                            next_S_169519 = next_S_f_res_169530;
                        }
                        
                        int32_t prim_get_radix_arg0_169531 = mul32(radix_sizze_140581, cur_depth_169484);
                        int64_t unsign_arg0_169532 = zext_i32_i64(prim_get_radix_arg0_169531);
                        int64_t asPow_169533 = shl64((int64_t) 1, unsign_arg0_169532);
                        int64_t u64_arg0_169534 = sub64(asPow_169533, (int64_t) 1);
                        int8_t u64_res_169535 = zext_i64_i8(u64_arg0_169534);
                        int8_t lifted_lambda_res_169536 = defunc_0_byteSeq_to_prim_res_169443 & u64_res_169535;
                        int8_t lifted_lambda_res_169537 = cur_S_169506 & u64_res_169535;
                        bool defunc_0_eq_res_169538 = lifted_lambda_res_169536 == lifted_lambda_res_169537;
                        int64_t loopres_169539;
                        int64_t loopres_169540;
                        
                        if (defunc_0_eq_res_169538) {
                            loopres_169539 = heshi_169478;
                            loopres_169540 = (int64_t) 0;
                        } else {
                            bool loop_cond_t_res_169541 = slt32(0, cur_depth_169484);
                            bool is_lt_169542;
                            bool is_lt_169543;
                            int32_t is_lt_169544;
                            bool loop_while_169545;
                            bool def_lt_169546;
                            int32_t bi_169547;
                            
                            loop_while_169545 = loop_cond_t_res_169541;
                            def_lt_169546 = 0;
                            bi_169547 = 0;
                            while (loop_while_169545) {
                                int32_t zt_rhs_169548 = add32(1, bi_169547);
                                int32_t prim_get_radix_arg0_169549 = mul32(radix_sizze_140581, zt_rhs_169548);
                                int64_t unsign_arg0_169550 = zext_i32_i64(prim_get_radix_arg0_169549);
                                int64_t asPow_169551 = shl64((int64_t) 1, unsign_arg0_169550);
                                int64_t u64_arg0_169552 = sub64(asPow_169551, (int64_t) 1);
                                int8_t u64_res_169553 = zext_i64_i8(u64_arg0_169552);
                                int8_t lifted_lambda_res_169554 = defunc_0_byteSeq_to_prim_res_169443 & u64_res_169553;
                                int8_t lifted_lambda_res_169555 = cur_S_169506 & u64_res_169553;
                                bool defunc_0_lt_res_169556 = ult8(lifted_lambda_res_169554, lifted_lambda_res_169555);
                                bool defunc_0_lt_res_169557 = ult8(lifted_lambda_res_169555, lifted_lambda_res_169554);
                                bool cond_169558 = !defunc_0_lt_res_169557;
                                bool cond_t_res_169559 = !defunc_0_lt_res_169556;
                                bool x_169560 = cond_169558 && cond_t_res_169559;
                                bool loop_cond_t_res_169561 = slt32(zt_rhs_169548, cur_depth_169484);
                                bool x_169562 = x_169560 && loop_cond_t_res_169561;
                                bool loop_while_tmp_171975 = x_169562;
                                bool def_lt_tmp_171976 = defunc_0_lt_res_169556;
                                int32_t bi_tmp_171977 = zt_rhs_169548;
                                
                                loop_while_169545 = loop_while_tmp_171975;
                                def_lt_169546 = def_lt_tmp_171976;
                                bi_169547 = bi_tmp_171977;
                            }
                            is_lt_169542 = loop_while_169545;
                            is_lt_169543 = def_lt_169546;
                            is_lt_169544 = bi_169547;
                            
                            int64_t loopres_f_res_169563;
                            int64_t loopres_f_res_169564;
                            
                            if (is_lt_169543) {
                                bool loop_cond_t_res_169565 = slt32(0, prev_depth_169486);
                                bool is_gt_169566;
                                bool is_gt_169567;
                                int32_t is_gt_169568;
                                bool loop_while_169569;
                                bool def_gt_169570;
                                int32_t bi_169571;
                                
                                loop_while_169569 = loop_cond_t_res_169565;
                                def_gt_169570 = 0;
                                bi_169571 = 0;
                                while (loop_while_169569) {
                                    int32_t zt_rhs_169572 = add32(1, bi_169571);
                                    int32_t prim_get_radix_arg0_169573 = mul32(radix_sizze_140581, zt_rhs_169572);
                                    int64_t unsign_arg0_169574 = zext_i32_i64(prim_get_radix_arg0_169573);
                                    int64_t asPow_169575 = shl64((int64_t) 1, unsign_arg0_169574);
                                    int64_t u64_arg0_169576 = sub64(asPow_169575, (int64_t) 1);
                                    int8_t u64_res_169577 = zext_i64_i8(u64_arg0_169576);
                                    int8_t lifted_lambda_res_169578 = defunc_0_byteSeq_to_prim_res_169443 & u64_res_169577;
                                    int8_t lifted_lambda_res_169579 = prev_S_169507 & u64_res_169577;
                                    bool defunc_0_gt_res_169580 = ult8(lifted_lambda_res_169579, lifted_lambda_res_169578);
                                    bool defunc_0_gt_res_169581 = ult8(lifted_lambda_res_169578, lifted_lambda_res_169579);
                                    bool cond_169582 = !defunc_0_gt_res_169580;
                                    bool cond_t_res_169583 = !defunc_0_gt_res_169581;
                                    bool x_169584 = cond_169582 && cond_t_res_169583;
                                    bool loop_cond_t_res_169585 = slt32(zt_rhs_169572, prev_depth_169486);
                                    bool x_169586 = x_169584 && loop_cond_t_res_169585;
                                    bool loop_while_tmp_171978 = x_169586;
                                    bool def_gt_tmp_171979 = defunc_0_gt_res_169580;
                                    int32_t bi_tmp_171980 = zt_rhs_169572;
                                    
                                    loop_while_169569 = loop_while_tmp_171978;
                                    def_gt_169570 = def_gt_tmp_171979;
                                    bi_169571 = bi_tmp_171980;
                                }
                                is_gt_169566 = loop_while_169569;
                                is_gt_169567 = def_gt_169570;
                                is_gt_169568 = bi_169571;
                                
                                bool x_169587 = !cond_169485;
                                bool y_169588 = is_gt_169567 && x_169587;
                                bool cond_169589 = cond_169485 || y_169588;
                                int64_t loopres_f_res_t_res_169590;
                                int64_t loopres_f_res_t_res_169591;
                                
                                if (cond_169589) {
                                    loopres_f_res_t_res_169590 = (int64_t) -1;
                                    loopres_f_res_t_res_169591 = (int64_t) 0;
                                } else {
                                    int64_t tmp_169592 = sub64(heshi_169478, step_169479);
                                    int64_t max_arg1_169593 = sdiv64(step_169479, (int64_t) 2);
                                    int64_t max_res_169594 = smax64((int64_t) 1, max_arg1_169593);
                                    
                                    loopres_f_res_t_res_169590 = tmp_169592;
                                    loopres_f_res_t_res_169591 = max_res_169594;
                                }
                                loopres_f_res_169563 = loopres_f_res_t_res_169590;
                                loopres_f_res_169564 = loopres_f_res_t_res_169591;
                            } else {
                                bool loop_cond_t_res_169595 = slt32(0, next_depth_169494);
                                bool is_lt_169596;
                                bool is_lt_169597;
                                int32_t is_lt_169598;
                                bool loop_while_169599;
                                bool def_lt_169600;
                                int32_t bi_169601;
                                
                                loop_while_169599 = loop_cond_t_res_169595;
                                def_lt_169600 = 0;
                                bi_169601 = 0;
                                while (loop_while_169599) {
                                    int32_t zt_rhs_169602 = add32(1, bi_169601);
                                    int32_t prim_get_radix_arg0_169603 = mul32(radix_sizze_140581, zt_rhs_169602);
                                    int64_t unsign_arg0_169604 = zext_i32_i64(prim_get_radix_arg0_169603);
                                    int64_t asPow_169605 = shl64((int64_t) 1, unsign_arg0_169604);
                                    int64_t u64_arg0_169606 = sub64(asPow_169605, (int64_t) 1);
                                    int8_t u64_res_169607 = zext_i64_i8(u64_arg0_169606);
                                    int8_t lifted_lambda_res_169608 = defunc_0_byteSeq_to_prim_res_169443 & u64_res_169607;
                                    int8_t lifted_lambda_res_169609 = next_S_169519 & u64_res_169607;
                                    bool defunc_0_lt_res_169610 = ult8(lifted_lambda_res_169608, lifted_lambda_res_169609);
                                    bool defunc_0_lt_res_169611 = ult8(lifted_lambda_res_169609, lifted_lambda_res_169608);
                                    bool cond_169612 = !defunc_0_lt_res_169611;
                                    bool cond_t_res_169613 = !defunc_0_lt_res_169610;
                                    bool x_169614 = cond_169612 && cond_t_res_169613;
                                    bool loop_cond_t_res_169615 = slt32(zt_rhs_169602, next_depth_169494);
                                    bool x_169616 = x_169614 && loop_cond_t_res_169615;
                                    bool loop_while_tmp_171981 = x_169616;
                                    bool def_lt_tmp_171982 = defunc_0_lt_res_169610;
                                    int32_t bi_tmp_171983 = zt_rhs_169602;
                                    
                                    loop_while_169599 = loop_while_tmp_171981;
                                    def_lt_169600 = def_lt_tmp_171982;
                                    bi_169601 = bi_tmp_171983;
                                }
                                is_lt_169596 = loop_while_169599;
                                is_lt_169597 = def_lt_169600;
                                is_lt_169598 = bi_169601;
                                
                                bool x_169617 = !cond_169493;
                                bool y_169618 = is_lt_169597 && x_169617;
                                bool cond_169619 = cond_169493 || y_169618;
                                int64_t loopres_f_res_f_res_169620;
                                int64_t loopres_f_res_f_res_169621;
                                
                                if (cond_169619) {
                                    loopres_f_res_f_res_169620 = (int64_t) -1;
                                    loopres_f_res_f_res_169621 = (int64_t) 0;
                                } else {
                                    int64_t tmp_169622 = add64(heshi_169478, step_169479);
                                    int64_t max_arg1_169623 = sdiv64(step_169479, (int64_t) 2);
                                    int64_t max_res_169624 = smax64((int64_t) 1, max_arg1_169623);
                                    
                                    loopres_f_res_f_res_169620 = tmp_169622;
                                    loopres_f_res_f_res_169621 = max_res_169624;
                                }
                                loopres_f_res_169563 = loopres_f_res_f_res_169620;
                                loopres_f_res_169564 = loopres_f_res_f_res_169621;
                            }
                            loopres_169539 = loopres_f_res_169563;
                            loopres_169540 = loopres_f_res_169564;
                        }
                        
                        bool loop_cond_169625 = slt64((int64_t) 0, loopres_169540);
                        bool loop_while_tmp_171972 = loop_cond_169625;
                        int64_t heshi_tmp_171973 = loopres_169539;
                        int64_t step_tmp_171974 = loopres_169540;
                        
                        loop_while_169477 = loop_while_tmp_171972;
                        heshi_169478 = heshi_tmp_171973;
                        step_169479 = step_tmp_171974;
                    }
                    bsearch_169474 = loop_while_169477;
                    bsearch_169475 = heshi_169478;
                    bsearch_169476 = step_169479;
                    defunc_res_f_res_169469 = bsearch_169475;
                }
                defunc_res_169466 = defunc_res_f_res_169469;
            }
            
            bool cond_169626 = sle64(defunc_res_169466, (int64_t) 0);
            int64_t inf_169627;
            
            if (cond_169626) {
                inf_169627 = (int64_t) 0;
            } else {
                bool x_169628 = sle64((int64_t) 0, defunc_res_169466);
                bool y_169629 = slt64(defunc_res_169466, dz2081U_140579);
                bool bounds_check_169630 = x_169628 && y_169629;
                bool index_certs_169631;
                
                if (!bounds_check_169630) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_169466, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:602:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-853:51\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t inf_f_res_169632 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_169466];
                
                inf_169627 = inf_f_res_169632;
            }
            
            bool cond_169633 = defunc_res_169466 == zeze_rhs_158708;
            int64_t sup_169634;
            
            if (cond_169633) {
                sup_169634 = nS_140578;
            } else {
                int64_t tmp_169635 = add64((int64_t) 1, defunc_res_169466);
                bool x_169636 = sle64((int64_t) 0, tmp_169635);
                bool y_169637 = slt64(tmp_169635, dz2081U_140579);
                bool bounds_check_169638 = x_169636 && y_169637;
                bool index_certs_169639;
                
                if (!bounds_check_169638) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169635, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:603:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-853:51\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t sup_f_res_169640 = ((int64_t *) bounds_mem_171276.mem)[tmp_169635];
                
                sup_169634 = sup_f_res_169640;
            }
            
            bool loop_cond_169641 = slt64(inf_169627, sup_169634);
            bool lifted_lambda_res_169642;
            int64_t lifted_lambda_res_169643;
            int64_t lifted_lambda_res_169644;
            int64_t lifted_lambda_res_169645;
            bool loop_while_169646;
            int64_t j_169647;
            int64_t duome_169648;
            int64_t i_169649;
            
            loop_while_169646 = loop_cond_169641;
            j_169647 = inf_169627;
            duome_169648 = (int64_t) 0;
            i_169649 = inf_169627;
            while (loop_while_169646) {
                bool x_169650 = sle64((int64_t) 0, i_169649);
                bool y_169651 = slt64(i_169649, nS_140578);
                bool bounds_check_169652 = x_169650 && y_169651;
                bool index_certs_169653;
                
                if (!bounds_check_169652) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_169649, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:606:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-853:51\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t zeze_rhs_169654 = ((int8_t *) mem_171710)[i_169649];
                bool is_eq_169655 = defunc_0_byteSeq_to_prim_res_169443 == zeze_rhs_169654;
                bool cond_169656 = slt64((int64_t) 0, duome_169648);
                bool cond_169657 = is_eq_169655 || cond_169656;
                int64_t next_j_169658;
                
                if (cond_169657) {
                    next_j_169658 = j_169647;
                } else {
                    int64_t next_j_f_res_169659 = add64((int64_t) 1, j_169647);
                    
                    next_j_169658 = next_j_f_res_169659;
                }
                
                int64_t next_duome_169660;
                
                if (is_eq_169655) {
                    int64_t next_duome_t_res_169661 = add64((int64_t) 1, duome_169648);
                    
                    next_duome_169660 = next_duome_t_res_169661;
                } else {
                    next_duome_169660 = duome_169648;
                }
                
                int64_t tmp_169662 = add64((int64_t) 1, i_169649);
                bool loop_cond_169663 = slt64(tmp_169662, sup_169634);
                bool loop_while_tmp_171984 = loop_cond_169663;
                int64_t j_tmp_171985 = next_j_169658;
                int64_t duome_tmp_171986 = next_duome_169660;
                int64_t i_tmp_171987 = tmp_169662;
                
                loop_while_169646 = loop_while_tmp_171984;
                j_169647 = j_tmp_171985;
                duome_169648 = duome_tmp_171986;
                i_169649 = i_tmp_171987;
            }
            lifted_lambda_res_169642 = loop_while_169646;
            lifted_lambda_res_169643 = j_169647;
            lifted_lambda_res_169644 = duome_169648;
            lifted_lambda_res_169645 = i_169649;
            
            bool cond_169664 = slt64(lifted_lambda_res_169643, sup_169634);
            int64_t lifted_lambda_res_169665;
            
            if (cond_169664) {
                lifted_lambda_res_169665 = lifted_lambda_res_169644;
            } else {
                lifted_lambda_res_169665 = (int64_t) 0;
            }
            
            int64_t lifted_lambda_res_169666;
            
            if (cond_169664) {
                lifted_lambda_res_169666 = lifted_lambda_res_169643;
            } else {
                lifted_lambda_res_169666 = (int64_t) -1;
            }
            
            bool lifted_lambda_res_169667 = slt64((int64_t) 1, lifted_lambda_res_169665);
            int64_t defunc_0_f_res_169668 = btoi_bool_i64(lifted_lambda_res_169667);
            int64_t defunc_0_op_res_169671 = add64(defunc_0_f_res_169668, scanacc_171011);
            int64_t defunc_0_op_res_169674 = add64(lifted_lambda_res_169665, scanacc_171012);
            int64_t zp_res_169677 = add64(lifted_lambda_res_169665, redout_171015);
            
            ((int64_t *) mem_171718)[i_171020] = defunc_0_op_res_169671;
            ((int64_t *) mem_171720)[i_171020] = defunc_0_op_res_169674;
            ((int64_t *) mem_171722)[i_171020] = defunc_0_f_res_169668;
            ((int64_t *) mem_171724)[i_171020] = lifted_lambda_res_169666;
            ((int64_t *) mem_171726)[i_171020] = lifted_lambda_res_169665;
            ((int8_t *) mem_171727)[i_171020] = defunc_0_byteSeq_to_prim_res_169443;
            
            int64_t scanacc_tmp_171962 = defunc_0_op_res_169671;
            int64_t scanacc_tmp_171963 = defunc_0_op_res_169674;
            int64_t redout_tmp_171966 = zp_res_169677;
            
            scanacc_171011 = scanacc_tmp_171962;
            scanacc_171012 = scanacc_tmp_171963;
            redout_171015 = redout_tmp_171966;
        }
        discard_171027 = scanacc_171011;
        discard_171028 = scanacc_171012;
        defunc_res_169437 = redout_171015;
        
        int64_t m_f_res_169705;
        
        if (x_158710) {
            int64_t x_169706 = ((int64_t *) mem_171718)[tmp_158711];
            
            m_f_res_169705 = x_169706;
        } else {
            m_f_res_169705 = (int64_t) 0;
        }
        
        int64_t m_169707;
        
        if (cond_158709) {
            m_169707 = (int64_t) 0;
        } else {
            m_169707 = m_f_res_169705;
        }
        
        bool cond_169708 = slt64((int64_t) 0, m_169707);
        int64_t m_169709 = sub64(m_169707, (int64_t) 1);
        bool i_p_m_t_s_leq_w_169710 = slt64(m_169709, nR_140576);
        bool zzero_leq_i_p_m_t_s_169711 = sle64((int64_t) 0, m_169709);
        bool y_169712 = i_p_m_t_s_leq_w_169710 && zzero_leq_i_p_m_t_s_169711;
        bool i_lte_j_169713 = sle64((int64_t) 0, m_169707);
        bool forwards_ok_169714 = y_169712 && i_lte_j_169713;
        bool eq_x_zz_169715 = (int64_t) 0 == m_f_res_169705;
        bool p_and_eq_x_y_169716 = x_158710 && eq_x_zz_169715;
        bool empty_slice_169717 = cond_158709 || p_and_eq_x_y_169716;
        bool ok_or_empty_169718 = forwards_ok_169714 || empty_slice_169717;
        bool index_certs_169719;
        
        if (!ok_or_empty_169718) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_169707, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-853:51\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171772 = (int64_t) 8 * m_169707;
        
        if (mem_171773_cached_sizze_172186 < bytes_171772) {
            err = lexical_realloc(ctx, &mem_171773, &mem_171773_cached_sizze_172186, bytes_171772);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171773, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171726, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_169707});
        
        int64_t max_mult_169722;
        
        if (cond_169708) {
            if (mem_171775_cached_sizze_172187 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171775, &mem_171775_cached_sizze_172187, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171035 = 0; i_171035 < nR_140576; i_171035++) {
                int64_t eta_p_169724 = ((int64_t *) mem_171722)[i_171035];
                int64_t eta_p_169725 = ((int64_t *) mem_171718)[i_171035];
                bool cond_169726 = eta_p_169724 == (int64_t) 1;
                int64_t lifted_lambda_res_169727;
                
                if (cond_169726) {
                    int64_t lifted_lambda_res_t_res_169728 = sub64(eta_p_169725, (int64_t) 1);
                    
                    lifted_lambda_res_169727 = lifted_lambda_res_t_res_169728;
                } else {
                    lifted_lambda_res_169727 = (int64_t) -1;
                }
                ((int64_t *) mem_171775)[i_171035] = lifted_lambda_res_169727;
            }
            for (int64_t write_iter_171037 = 0; write_iter_171037 < nR_140576; write_iter_171037++) {
                int64_t write_iv_171039 = ((int64_t *) mem_171775)[write_iter_171037];
                int64_t write_iv_171040 = ((int64_t *) mem_171726)[write_iter_171037];
                
                if (sle64((int64_t) 0, write_iv_171039) && slt64(write_iv_171039, m_169707)) {
                    ((int64_t *) mem_171773)[write_iv_171039] = write_iv_171040;
                }
            }
            
            int64_t defunc_0_reduce_res_169740;
            int64_t redout_171042 = (int64_t) -9223372036854775808;
            
            for (int64_t i_171043 = 0; i_171043 < m_169707; i_171043++) {
                int64_t x_169741 = ((int64_t *) mem_171773)[i_171043];
                int64_t max_res_169744 = smax64(x_169741, redout_171042);
                int64_t redout_tmp_171990 = max_res_169744;
                
                redout_171042 = redout_tmp_171990;
            }
            defunc_0_reduce_res_169740 = redout_171042;
            max_mult_169722 = defunc_0_reduce_res_169740;
        } else {
            max_mult_169722 = (int64_t) 1;
        }
        
        int64_t bytes_171788 = (int64_t) 8 * defunc_res_169437;
        bool bounds_invalid_upwards_169772 = slt64(max_mult_169722, (int64_t) 1);
        bool valid_169774 = !bounds_invalid_upwards_169772;
        bool range_valid_c_169775;
        
        if (!valid_169774) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_169722, " is invalid.", "-> #0  ftHashJoin.fut:629:18-30\n   #1  ftHashJoin.fut:850:4-853:51\n   #2  ftRelational.fut:258:6-261:37\n   #3  ftRelational.fut:254:3-261:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171826 = b_140577 * defunc_res_169437;
        
        if (mem_171765_cached_sizze_172185 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171765, &mem_171765_cached_sizze_172185, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171031 = 0; i_171031 < nR_140576; i_171031++) {
            int64_t eta_p_169695 = ((int64_t *) mem_171726)[i_171031];
            int64_t zv_lhs_169696 = add64((int64_t) -1, i_171031);
            int64_t tmp_169697 = smod64(zv_lhs_169696, nR_140576);
            int64_t lifted_lambda_res_169698 = ((int64_t *) mem_171720)[tmp_169697];
            bool cond_169699 = i_171031 == (int64_t) 0;
            int64_t lifted_lambda_res_169700;
            
            if (cond_169699) {
                lifted_lambda_res_169700 = (int64_t) 0;
            } else {
                lifted_lambda_res_169700 = lifted_lambda_res_169698;
            }
            
            bool cond_169701 = slt64((int64_t) 0, eta_p_169695);
            int64_t lifted_lambda_res_169702;
            
            if (cond_169701) {
                lifted_lambda_res_169702 = lifted_lambda_res_169700;
            } else {
                lifted_lambda_res_169702 = (int64_t) -1;
            }
            ((int64_t *) mem_171765)[i_171031] = lifted_lambda_res_169702;
        }
        if (memblock_alloc(ctx, &mem_171789, bytes_171788, "mem_171789")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171992 = 0; nest_i_171992 < defunc_res_169437; nest_i_171992++) {
            ((int64_t *) mem_171789.mem)[nest_i_171992] = (int64_t) 0;
        }
        for (int64_t write_iter_171044 = 0; write_iter_171044 < nR_140576; write_iter_171044++) {
            int64_t write_iv_171046 = ((int64_t *) mem_171765)[write_iter_171044];
            
            if (sle64((int64_t) 0, write_iv_171046) && slt64(write_iv_171046, defunc_res_169437)) {
                ((int64_t *) mem_171789.mem)[write_iv_171046] = write_iter_171044;
            }
        }
        if (memblock_alloc(ctx, &mem_171797, bytes_171788, "mem_171797")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171994 = 0; nest_i_171994 < defunc_res_169437; nest_i_171994++) {
            ((int64_t *) mem_171797.mem)[nest_i_171994] = (int64_t) 1;
        }
        
        int64_t distance_169773 = sub64(max_mult_169722, (int64_t) 1);
        
        if (memblock_set(ctx, &mem_param_171800, &mem_171797, "mem_171797") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171803, &mem_171789, "mem_171789") != 0)
            return 1;
        for (int64_t i_169778 = 0; i_169778 < distance_169773; i_169778++) {
            int64_t index_primexp_169781 = add64((int64_t) 1, i_169778);
            
            if (memblock_alloc(ctx, &mem_171805, bytes_171788, "mem_171805")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171805.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171803.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169437});
            if (memblock_alloc(ctx, &mem_171807, bytes_171788, "mem_171807")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171807.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171800.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169437});
            
            int64_t replicate_arg1_169784 = add64((int64_t) 2, i_169778);
            
            for (int64_t write_iter_171049 = 0; write_iter_171049 < nR_140576; write_iter_171049++) {
                int64_t zlze_lhs_169792 = ((int64_t *) mem_171726)[write_iter_171049];
                bool cond_169793 = sle64(zlze_lhs_169792, index_primexp_169781);
                int64_t lifted_lambda_res_169794;
                
                if (cond_169793) {
                    lifted_lambda_res_169794 = (int64_t) -1;
                } else {
                    int64_t zp_lhs_169795 = ((int64_t *) mem_171765)[write_iter_171049];
                    int64_t lifted_lambda_res_f_res_169796 = add64(index_primexp_169781, zp_lhs_169795);
                    
                    lifted_lambda_res_169794 = lifted_lambda_res_f_res_169796;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_169794) && slt64(lifted_lambda_res_169794, defunc_res_169437)) {
                    ((int64_t *) mem_171807.mem)[lifted_lambda_res_169794] = replicate_arg1_169784;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_169794) && slt64(lifted_lambda_res_169794, defunc_res_169437)) {
                    ((int64_t *) mem_171805.mem)[lifted_lambda_res_169794] = write_iter_171049;
                }
            }
            if (memblock_set(ctx, &mem_param_tmp_171995, &mem_171807, "mem_171807") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171996, &mem_171805, "mem_171805") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171800, &mem_param_tmp_171995, "mem_param_tmp_171995") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171803, &mem_param_tmp_171996, "mem_param_tmp_171996") != 0)
                return 1;
        }
        if (memblock_set(ctx, &ext_mem_171825, &mem_param_171800, "mem_param_171800") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171824, &mem_param_171803, "mem_param_171803") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171789, "mem_171789") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171797, "mem_171797") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171827, bytes_171826, "mem_171827")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171829, bytes_171788, "mem_171829")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171059 = 0; i_171059 < defunc_res_169437; i_171059++) {
            int64_t eta_p_169806 = ((int64_t *) ext_mem_171824.mem)[i_171059];
            bool x_169807 = sle64((int64_t) 0, eta_p_169806);
            bool y_169808 = slt64(eta_p_169806, nR_140576);
            bool bounds_check_169809 = x_169807 && y_169808;
            bool index_certs_169810;
            
            if (!bounds_check_169809) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_169806, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  ftHashJoin.fut:639:16-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:638:8-646:6\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t eta_p_169805 = ((int64_t *) ext_mem_171825.mem)[i_171059];
            int8_t rv_169811 = ((int8_t *) mem_171727)[eta_p_169806];
            int64_t inf_s_idx_169812 = ((int64_t *) mem_171724)[eta_p_169806];
            int64_t tmp_169813 = sub64(inf_s_idx_169812, (int64_t) 1);
            bool loop_cond_169814 = slt64((int64_t) 0, eta_p_169805);
            bool kth_match_169815;
            int64_t kth_match_169816;
            int64_t kth_match_169817;
            bool loop_while_169818;
            int64_t j_169819;
            int64_t m_169820;
            
            loop_while_169818 = loop_cond_169814;
            j_169819 = tmp_169813;
            m_169820 = (int64_t) 0;
            while (loop_while_169818) {
                int64_t zeze_rhs_169821 = add64((int64_t) 1, j_169819);
                bool x_169822 = sle64((int64_t) 0, zeze_rhs_169821);
                bool y_169823 = slt64(zeze_rhs_169821, nS_140578);
                bool bounds_check_169824 = x_169822 && y_169823;
                bool index_certs_169825;
                
                if (!bounds_check_169824) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_169821, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:643:29-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:638:8-646:6\n   #3  ftHashJoin.fut:850:4-853:51\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t zeze_rhs_169826 = ((int8_t *) mem_171710)[zeze_rhs_169821];
                bool is_eq_169827 = rv_169811 == zeze_rhs_169826;
                int64_t loopres_169828;
                
                if (is_eq_169827) {
                    int64_t tmp_169829 = add64((int64_t) 1, m_169820);
                    
                    loopres_169828 = tmp_169829;
                } else {
                    loopres_169828 = m_169820;
                }
                
                bool loop_cond_169830 = slt64(loopres_169828, eta_p_169805);
                bool loop_while_tmp_172003 = loop_cond_169830;
                int64_t j_tmp_172004 = zeze_rhs_169821;
                int64_t m_tmp_172005 = loopres_169828;
                
                loop_while_169818 = loop_while_tmp_172003;
                j_169819 = j_tmp_172004;
                m_169820 = m_tmp_172005;
            }
            kth_match_169815 = loop_while_169818;
            kth_match_169816 = j_169819;
            kth_match_169817 = m_169820;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171827.mem, i_171059 * b_140577, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171274.mem, eta_p_169806 * b_140577, (int64_t []) {(int64_t) 1}, (int64_t []) {b_140577});
            ((int64_t *) mem_171829.mem)[i_171059] = kth_match_169816;
        }
        if (memblock_unref(ctx, &ext_mem_171825, "ext_mem_171825") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171845, bytes_171788, "mem_171845")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171845.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169437});
        if (memblock_unref(ctx, &ext_mem_171824, "ext_mem_171824") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171853, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171852, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171849, &mem_171827, "mem_171827") != 0)
            return 1;
        radix_hash_join_res_158736 = defunc_res_169437;
        radix_hash_join_res_158737 = defunc_res_169437;
        radix_hash_join_res_158738 = defunc_res_169437;
    } else {
        int64_t radix_hash_join_res_f_res_159095;
        int64_t radix_hash_join_res_f_res_159096;
        int64_t radix_hash_join_res_f_res_159097;
        
        if (cond_158703) {
            if (mem_171565_cached_sizze_172168 < bytes_171564) {
                err = lexical_realloc(ctx, &mem_171565, &mem_171565_cached_sizze_172168, bytes_171564);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171064 = 0; i_171064 < nS_140578; i_171064++) {
                int16_t defunc_0_byteSeq_to_prim_res_169925;
                int16_t y_169927 = (int16_t) 0;
                
                for (int64_t i_169926 = 0; i_169926 < b_140577; i_169926++) {
                    int64_t zm_lhs_169928 = sub64(b_140577, i_169926);
                    int64_t from_u8_arg0_169929 = sub64(zm_lhs_169928, (int64_t) 1);
                    bool x_169930 = sle64((int64_t) 0, from_u8_arg0_169929);
                    bool y_169931 = slt64(from_u8_arg0_169929, b_140577);
                    bool bounds_check_169932 = x_169930 && y_169931;
                    bool index_certs_169933;
                    
                    if (!bounds_check_169932) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_169929, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:425:75-82\n   #2  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_169934 = ((int8_t *) pS_mem_171275.mem)[i_171064 * b_140577 + from_u8_arg0_169929];
                    int16_t u8_res_169935 = zext_i8_i16(from_u8_arg0_169934);
                    int32_t i64_res_169936 = sext_i64_i32(i_169926);
                    int32_t shift_left_rhs_169937 = mul32(8, i64_res_169936);
                    int16_t unsign_arg0_169938 = zext_i32_i16(shift_left_rhs_169937);
                    int16_t lifted_lambda_res_169939 = shl16(u8_res_169935, unsign_arg0_169938);
                    int16_t unsign_arg0_169940 = y_169927 | lifted_lambda_res_169939;
                    int16_t y_tmp_172007 = unsign_arg0_169940;
                    
                    y_169927 = y_tmp_172007;
                }
                defunc_0_byteSeq_to_prim_res_169925 = y_169927;
                ((int16_t *) mem_171565)[i_171064] = defunc_0_byteSeq_to_prim_res_169925;
            }
            if (mem_171573_cached_sizze_172169 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171573, &mem_171573_cached_sizze_172169, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171575_cached_sizze_172170 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171575, &mem_171575_cached_sizze_172170, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171577_cached_sizze_172171 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171577, &mem_171577_cached_sizze_172171, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171579_cached_sizze_172172 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171579, &mem_171579_cached_sizze_172172, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171581_cached_sizze_172173 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171581, &mem_171581_cached_sizze_172173, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171583_cached_sizze_172174 < bytes_171582) {
                err = lexical_realloc(ctx, &mem_171583, &mem_171583_cached_sizze_172174, bytes_171582);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171088;
            int64_t discard_171089;
            int64_t defunc_res_169946;
            int64_t scanacc_171072;
            int64_t scanacc_171073;
            int64_t redout_171076;
            
            scanacc_171072 = (int64_t) 0;
            scanacc_171073 = (int64_t) 0;
            redout_171076 = (int64_t) 0;
            for (int64_t i_171081 = 0; i_171081 < nR_140576; i_171081++) {
                int16_t defunc_0_byteSeq_to_prim_res_169952;
                int16_t y_169954 = (int16_t) 0;
                
                for (int64_t i_169953 = 0; i_169953 < b_140577; i_169953++) {
                    int64_t zm_lhs_169955 = sub64(b_140577, i_169953);
                    int64_t from_u8_arg0_169956 = sub64(zm_lhs_169955, (int64_t) 1);
                    bool x_169957 = sle64((int64_t) 0, from_u8_arg0_169956);
                    bool y_169958 = slt64(from_u8_arg0_169956, b_140577);
                    bool bounds_check_169959 = x_169957 && y_169958;
                    bool index_certs_169960;
                    
                    if (!bounds_check_169959) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_169956, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:425:75-82\n   #2  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_169961 = ((int8_t *) pR_mem_171274.mem)[i_171081 * b_140577 + from_u8_arg0_169956];
                    int16_t u8_res_169962 = zext_i8_i16(from_u8_arg0_169961);
                    int32_t i64_res_169963 = sext_i64_i32(i_169953);
                    int32_t shift_left_rhs_169964 = mul32(8, i64_res_169963);
                    int16_t unsign_arg0_169965 = zext_i32_i16(shift_left_rhs_169964);
                    int16_t lifted_lambda_res_169966 = shl16(u8_res_169962, unsign_arg0_169965);
                    int16_t unsign_arg0_169967 = y_169954 | lifted_lambda_res_169966;
                    int16_t y_tmp_172017 = unsign_arg0_169967;
                    
                    y_169954 = y_tmp_172017;
                }
                defunc_0_byteSeq_to_prim_res_169952 = y_169954;
                
                int16_t lifted_lambda_res_169968 = u64_res_158727 & defunc_0_byteSeq_to_prim_res_169952;
                int64_t u16_res_169969 = zext_i16_i64(lifted_lambda_res_169968);
                bool x_169970 = sle64((int64_t) 0, u16_res_169969);
                bool y_169971 = slt64(u16_res_169969, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580);
                bool bounds_check_169972 = x_169970 && y_169971;
                bool index_certs_169973;
                
                if (!bounds_check_169972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u16_res_169969, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t spi_169974 = ((int64_t *) first_info_idx_mem_171278.mem)[u16_res_169969];
                bool cond_169975 = slt64(spi_169974, (int64_t) 0);
                int64_t defunc_res_169976;
                
                if (cond_169975) {
                    defunc_res_169976 = (int64_t) -1;
                } else {
                    int64_t zeze_rhs_169977 = ((int64_t *) last_info_idx_mem_171279.mem)[u16_res_169969];
                    bool cond_169978 = spi_169974 == zeze_rhs_169977;
                    int64_t defunc_res_f_res_169979;
                    
                    if (cond_169978) {
                        defunc_res_f_res_169979 = spi_169974;
                    } else {
                        int64_t zs_lhs_169980 = sub64(zeze_rhs_169977, spi_169974);
                        int64_t max_arg1_169981 = sdiv64(zs_lhs_169980, (int64_t) 2);
                        int64_t max_res_169982 = smax64((int64_t) 1, max_arg1_169981);
                        bool loop_cond_169983 = slt64((int64_t) 0, max_res_169982);
                        bool bsearch_169984;
                        int64_t bsearch_169985;
                        int64_t bsearch_169986;
                        bool loop_while_169987;
                        int64_t heshi_169988;
                        int64_t step_169989;
                        
                        loop_while_169987 = loop_cond_169983;
                        heshi_169988 = spi_169974;
                        step_169989 = max_res_169982;
                        while (loop_while_169987) {
                            bool x_169990 = sle64((int64_t) 0, heshi_169988);
                            bool y_169991 = slt64(heshi_169988, dz2081U_140579);
                            bool bounds_check_169992 = x_169990 && y_169991;
                            bool index_certs_169993;
                            
                            if (!bounds_check_169992) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_169988, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t cur_S_170011 = ((int64_t *) bounds_mem_171276.mem)[heshi_169988];
                            bool x_170012 = sle64((int64_t) 0, cur_S_170011);
                            bool y_170013 = slt64(cur_S_170011, nS_140578);
                            bool bounds_check_170014 = x_170012 && y_170013;
                            bool index_certs_170015;
                            
                            if (!bounds_check_170014) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_170011, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t cur_depth_169994 = ((int32_t *) depths_mem_171277.mem)[heshi_169988];
                            bool cond_169995 = heshi_169988 == spi_169974;
                            int32_t prev_depth_169996;
                            
                            if (cond_169995) {
                                prev_depth_169996 = cur_depth_169994;
                            } else {
                                int64_t tmp_169997 = sub64(heshi_169988, (int64_t) 1);
                                bool x_169998 = sle64((int64_t) 0, tmp_169997);
                                bool y_169999 = slt64(tmp_169997, dz2081U_140579);
                                bool bounds_check_170000 = x_169998 && y_169999;
                                bool index_certs_170001;
                                
                                if (!bounds_check_170000) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_169997, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t prev_depth_f_res_170002 = ((int32_t *) depths_mem_171277.mem)[tmp_169997];
                                
                                prev_depth_169996 = prev_depth_f_res_170002;
                            }
                            
                            bool cond_170003 = heshi_169988 == zeze_rhs_169977;
                            int32_t next_depth_170004;
                            
                            if (cond_170003) {
                                next_depth_170004 = cur_depth_169994;
                            } else {
                                int64_t tmp_170005 = add64((int64_t) 1, heshi_169988);
                                bool x_170006 = sle64((int64_t) 0, tmp_170005);
                                bool y_170007 = slt64(tmp_170005, dz2081U_140579);
                                bool bounds_check_170008 = x_170006 && y_170007;
                                bool index_certs_170009;
                                
                                if (!bounds_check_170008) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170005, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t next_depth_f_res_170010 = ((int32_t *) depths_mem_171277.mem)[tmp_170005];
                                
                                next_depth_170004 = next_depth_f_res_170010;
                            }
                            
                            int16_t cur_S_170016 = ((int16_t *) mem_171565)[cur_S_170011];
                            int16_t prev_S_170017;
                            
                            if (cond_169995) {
                                prev_S_170017 = cur_S_170016;
                            } else {
                                int64_t tmp_170018 = sub64(heshi_169988, (int64_t) 1);
                                bool x_170019 = sle64((int64_t) 0, tmp_170018);
                                bool y_170020 = slt64(tmp_170018, dz2081U_140579);
                                bool bounds_check_170021 = x_170019 && y_170020;
                                bool index_certs_170022;
                                
                                if (!bounds_check_170021) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170018, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_170023 = ((int64_t *) bounds_mem_171276.mem)[tmp_170018];
                                bool x_170024 = sle64((int64_t) 0, tmp_170023);
                                bool y_170025 = slt64(tmp_170023, nS_140578);
                                bool bounds_check_170026 = x_170024 && y_170025;
                                bool index_certs_170027;
                                
                                if (!bounds_check_170026) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170023, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t prev_S_f_res_170028 = ((int16_t *) mem_171565)[tmp_170023];
                                
                                prev_S_170017 = prev_S_f_res_170028;
                            }
                            
                            int16_t next_S_170029;
                            
                            if (cond_170003) {
                                next_S_170029 = cur_S_170016;
                            } else {
                                int64_t tmp_170030 = add64((int64_t) 1, heshi_169988);
                                bool x_170031 = sle64((int64_t) 0, tmp_170030);
                                bool y_170032 = slt64(tmp_170030, dz2081U_140579);
                                bool bounds_check_170033 = x_170031 && y_170032;
                                bool index_certs_170034;
                                
                                if (!bounds_check_170033) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170030, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_170035 = ((int64_t *) bounds_mem_171276.mem)[tmp_170030];
                                bool x_170036 = sle64((int64_t) 0, tmp_170035);
                                bool y_170037 = slt64(tmp_170035, nS_140578);
                                bool bounds_check_170038 = x_170036 && y_170037;
                                bool index_certs_170039;
                                
                                if (!bounds_check_170038) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170035, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:658:3-665:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t next_S_f_res_170040 = ((int16_t *) mem_171565)[tmp_170035];
                                
                                next_S_170029 = next_S_f_res_170040;
                            }
                            
                            int32_t prim_get_radix_arg0_170041 = mul32(radix_sizze_140581, cur_depth_169994);
                            int64_t unsign_arg0_170042 = zext_i32_i64(prim_get_radix_arg0_170041);
                            int64_t asPow_170043 = shl64((int64_t) 1, unsign_arg0_170042);
                            int64_t u64_arg0_170044 = sub64(asPow_170043, (int64_t) 1);
                            int16_t u64_res_170045 = zext_i64_i16(u64_arg0_170044);
                            int16_t lifted_lambda_res_170046 = defunc_0_byteSeq_to_prim_res_169952 & u64_res_170045;
                            int16_t lifted_lambda_res_170047 = cur_S_170016 & u64_res_170045;
                            bool defunc_0_eq_res_170048 = lifted_lambda_res_170046 == lifted_lambda_res_170047;
                            int64_t loopres_170049;
                            int64_t loopres_170050;
                            
                            if (defunc_0_eq_res_170048) {
                                loopres_170049 = heshi_169988;
                                loopres_170050 = (int64_t) 0;
                            } else {
                                bool loop_cond_t_res_170051 = slt32(0, cur_depth_169994);
                                bool is_lt_170052;
                                bool is_lt_170053;
                                int32_t is_lt_170054;
                                bool loop_while_170055;
                                bool def_lt_170056;
                                int32_t bi_170057;
                                
                                loop_while_170055 = loop_cond_t_res_170051;
                                def_lt_170056 = 0;
                                bi_170057 = 0;
                                while (loop_while_170055) {
                                    int32_t zt_rhs_170058 = add32(1, bi_170057);
                                    int32_t prim_get_radix_arg0_170059 = mul32(radix_sizze_140581, zt_rhs_170058);
                                    int64_t unsign_arg0_170060 = zext_i32_i64(prim_get_radix_arg0_170059);
                                    int64_t asPow_170061 = shl64((int64_t) 1, unsign_arg0_170060);
                                    int64_t u64_arg0_170062 = sub64(asPow_170061, (int64_t) 1);
                                    int16_t u64_res_170063 = zext_i64_i16(u64_arg0_170062);
                                    int16_t lifted_lambda_res_170064 = defunc_0_byteSeq_to_prim_res_169952 & u64_res_170063;
                                    int16_t lifted_lambda_res_170065 = cur_S_170016 & u64_res_170063;
                                    bool defunc_0_lt_res_170066 = ult16(lifted_lambda_res_170064, lifted_lambda_res_170065);
                                    bool defunc_0_lt_res_170067 = ult16(lifted_lambda_res_170065, lifted_lambda_res_170064);
                                    bool cond_170068 = !defunc_0_lt_res_170067;
                                    bool cond_t_res_170069 = !defunc_0_lt_res_170066;
                                    bool x_170070 = cond_170068 && cond_t_res_170069;
                                    bool loop_cond_t_res_170071 = slt32(zt_rhs_170058, cur_depth_169994);
                                    bool x_170072 = x_170070 && loop_cond_t_res_170071;
                                    bool loop_while_tmp_172021 = x_170072;
                                    bool def_lt_tmp_172022 = defunc_0_lt_res_170066;
                                    int32_t bi_tmp_172023 = zt_rhs_170058;
                                    
                                    loop_while_170055 = loop_while_tmp_172021;
                                    def_lt_170056 = def_lt_tmp_172022;
                                    bi_170057 = bi_tmp_172023;
                                }
                                is_lt_170052 = loop_while_170055;
                                is_lt_170053 = def_lt_170056;
                                is_lt_170054 = bi_170057;
                                
                                int64_t loopres_f_res_170073;
                                int64_t loopres_f_res_170074;
                                
                                if (is_lt_170053) {
                                    bool loop_cond_t_res_170075 = slt32(0, prev_depth_169996);
                                    bool is_gt_170076;
                                    bool is_gt_170077;
                                    int32_t is_gt_170078;
                                    bool loop_while_170079;
                                    bool def_gt_170080;
                                    int32_t bi_170081;
                                    
                                    loop_while_170079 = loop_cond_t_res_170075;
                                    def_gt_170080 = 0;
                                    bi_170081 = 0;
                                    while (loop_while_170079) {
                                        int32_t zt_rhs_170082 = add32(1, bi_170081);
                                        int32_t prim_get_radix_arg0_170083 = mul32(radix_sizze_140581, zt_rhs_170082);
                                        int64_t unsign_arg0_170084 = zext_i32_i64(prim_get_radix_arg0_170083);
                                        int64_t asPow_170085 = shl64((int64_t) 1, unsign_arg0_170084);
                                        int64_t u64_arg0_170086 = sub64(asPow_170085, (int64_t) 1);
                                        int16_t u64_res_170087 = zext_i64_i16(u64_arg0_170086);
                                        int16_t lifted_lambda_res_170088 = defunc_0_byteSeq_to_prim_res_169952 & u64_res_170087;
                                        int16_t lifted_lambda_res_170089 = prev_S_170017 & u64_res_170087;
                                        bool defunc_0_gt_res_170090 = ult16(lifted_lambda_res_170089, lifted_lambda_res_170088);
                                        bool defunc_0_gt_res_170091 = ult16(lifted_lambda_res_170088, lifted_lambda_res_170089);
                                        bool cond_170092 = !defunc_0_gt_res_170090;
                                        bool cond_t_res_170093 = !defunc_0_gt_res_170091;
                                        bool x_170094 = cond_170092 && cond_t_res_170093;
                                        bool loop_cond_t_res_170095 = slt32(zt_rhs_170082, prev_depth_169996);
                                        bool x_170096 = x_170094 && loop_cond_t_res_170095;
                                        bool loop_while_tmp_172024 = x_170096;
                                        bool def_gt_tmp_172025 = defunc_0_gt_res_170090;
                                        int32_t bi_tmp_172026 = zt_rhs_170082;
                                        
                                        loop_while_170079 = loop_while_tmp_172024;
                                        def_gt_170080 = def_gt_tmp_172025;
                                        bi_170081 = bi_tmp_172026;
                                    }
                                    is_gt_170076 = loop_while_170079;
                                    is_gt_170077 = def_gt_170080;
                                    is_gt_170078 = bi_170081;
                                    
                                    bool x_170097 = !cond_169995;
                                    bool y_170098 = is_gt_170077 && x_170097;
                                    bool cond_170099 = cond_169995 || y_170098;
                                    int64_t loopres_f_res_t_res_170100;
                                    int64_t loopres_f_res_t_res_170101;
                                    
                                    if (cond_170099) {
                                        loopres_f_res_t_res_170100 = (int64_t) -1;
                                        loopres_f_res_t_res_170101 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_170102 = sub64(heshi_169988, step_169989);
                                        int64_t max_arg1_170103 = sdiv64(step_169989, (int64_t) 2);
                                        int64_t max_res_170104 = smax64((int64_t) 1, max_arg1_170103);
                                        
                                        loopres_f_res_t_res_170100 = tmp_170102;
                                        loopres_f_res_t_res_170101 = max_res_170104;
                                    }
                                    loopres_f_res_170073 = loopres_f_res_t_res_170100;
                                    loopres_f_res_170074 = loopres_f_res_t_res_170101;
                                } else {
                                    bool loop_cond_t_res_170105 = slt32(0, next_depth_170004);
                                    bool is_lt_170106;
                                    bool is_lt_170107;
                                    int32_t is_lt_170108;
                                    bool loop_while_170109;
                                    bool def_lt_170110;
                                    int32_t bi_170111;
                                    
                                    loop_while_170109 = loop_cond_t_res_170105;
                                    def_lt_170110 = 0;
                                    bi_170111 = 0;
                                    while (loop_while_170109) {
                                        int32_t zt_rhs_170112 = add32(1, bi_170111);
                                        int32_t prim_get_radix_arg0_170113 = mul32(radix_sizze_140581, zt_rhs_170112);
                                        int64_t unsign_arg0_170114 = zext_i32_i64(prim_get_radix_arg0_170113);
                                        int64_t asPow_170115 = shl64((int64_t) 1, unsign_arg0_170114);
                                        int64_t u64_arg0_170116 = sub64(asPow_170115, (int64_t) 1);
                                        int16_t u64_res_170117 = zext_i64_i16(u64_arg0_170116);
                                        int16_t lifted_lambda_res_170118 = defunc_0_byteSeq_to_prim_res_169952 & u64_res_170117;
                                        int16_t lifted_lambda_res_170119 = next_S_170029 & u64_res_170117;
                                        bool defunc_0_lt_res_170120 = ult16(lifted_lambda_res_170118, lifted_lambda_res_170119);
                                        bool defunc_0_lt_res_170121 = ult16(lifted_lambda_res_170119, lifted_lambda_res_170118);
                                        bool cond_170122 = !defunc_0_lt_res_170121;
                                        bool cond_t_res_170123 = !defunc_0_lt_res_170120;
                                        bool x_170124 = cond_170122 && cond_t_res_170123;
                                        bool loop_cond_t_res_170125 = slt32(zt_rhs_170112, next_depth_170004);
                                        bool x_170126 = x_170124 && loop_cond_t_res_170125;
                                        bool loop_while_tmp_172027 = x_170126;
                                        bool def_lt_tmp_172028 = defunc_0_lt_res_170120;
                                        int32_t bi_tmp_172029 = zt_rhs_170112;
                                        
                                        loop_while_170109 = loop_while_tmp_172027;
                                        def_lt_170110 = def_lt_tmp_172028;
                                        bi_170111 = bi_tmp_172029;
                                    }
                                    is_lt_170106 = loop_while_170109;
                                    is_lt_170107 = def_lt_170110;
                                    is_lt_170108 = bi_170111;
                                    
                                    bool x_170127 = !cond_170003;
                                    bool y_170128 = is_lt_170107 && x_170127;
                                    bool cond_170129 = cond_170003 || y_170128;
                                    int64_t loopres_f_res_f_res_170130;
                                    int64_t loopres_f_res_f_res_170131;
                                    
                                    if (cond_170129) {
                                        loopres_f_res_f_res_170130 = (int64_t) -1;
                                        loopres_f_res_f_res_170131 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_170132 = add64(heshi_169988, step_169989);
                                        int64_t max_arg1_170133 = sdiv64(step_169989, (int64_t) 2);
                                        int64_t max_res_170134 = smax64((int64_t) 1, max_arg1_170133);
                                        
                                        loopres_f_res_f_res_170130 = tmp_170132;
                                        loopres_f_res_f_res_170131 = max_res_170134;
                                    }
                                    loopres_f_res_170073 = loopres_f_res_f_res_170130;
                                    loopres_f_res_170074 = loopres_f_res_f_res_170131;
                                }
                                loopres_170049 = loopres_f_res_170073;
                                loopres_170050 = loopres_f_res_170074;
                            }
                            
                            bool loop_cond_170135 = slt64((int64_t) 0, loopres_170050);
                            bool loop_while_tmp_172018 = loop_cond_170135;
                            int64_t heshi_tmp_172019 = loopres_170049;
                            int64_t step_tmp_172020 = loopres_170050;
                            
                            loop_while_169987 = loop_while_tmp_172018;
                            heshi_169988 = heshi_tmp_172019;
                            step_169989 = step_tmp_172020;
                        }
                        bsearch_169984 = loop_while_169987;
                        bsearch_169985 = heshi_169988;
                        bsearch_169986 = step_169989;
                        defunc_res_f_res_169979 = bsearch_169985;
                    }
                    defunc_res_169976 = defunc_res_f_res_169979;
                }
                
                bool cond_170136 = sle64(defunc_res_169976, (int64_t) 0);
                int64_t inf_170137;
                
                if (cond_170136) {
                    inf_170137 = (int64_t) 0;
                } else {
                    bool x_170138 = sle64((int64_t) 0, defunc_res_169976);
                    bool y_170139 = slt64(defunc_res_169976, dz2081U_140579);
                    bool bounds_check_170140 = x_170138 && y_170139;
                    bool index_certs_170141;
                    
                    if (!bounds_check_170140) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_169976, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:666:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-854:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t inf_f_res_170142 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_169976];
                    
                    inf_170137 = inf_f_res_170142;
                }
                
                bool cond_170143 = defunc_res_169976 == zeze_rhs_158708;
                int64_t sup_170144;
                
                if (cond_170143) {
                    sup_170144 = nS_140578;
                } else {
                    int64_t tmp_170145 = add64((int64_t) 1, defunc_res_169976);
                    bool x_170146 = sle64((int64_t) 0, tmp_170145);
                    bool y_170147 = slt64(tmp_170145, dz2081U_140579);
                    bool bounds_check_170148 = x_170146 && y_170147;
                    bool index_certs_170149;
                    
                    if (!bounds_check_170148) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170145, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:667:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-854:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t sup_f_res_170150 = ((int64_t *) bounds_mem_171276.mem)[tmp_170145];
                    
                    sup_170144 = sup_f_res_170150;
                }
                
                bool loop_cond_170151 = slt64(inf_170137, sup_170144);
                bool lifted_lambda_res_170152;
                int64_t lifted_lambda_res_170153;
                int64_t lifted_lambda_res_170154;
                int64_t lifted_lambda_res_170155;
                bool loop_while_170156;
                int64_t j_170157;
                int64_t duome_170158;
                int64_t i_170159;
                
                loop_while_170156 = loop_cond_170151;
                j_170157 = inf_170137;
                duome_170158 = (int64_t) 0;
                i_170159 = inf_170137;
                while (loop_while_170156) {
                    bool x_170160 = sle64((int64_t) 0, i_170159);
                    bool y_170161 = slt64(i_170159, nS_140578);
                    bool bounds_check_170162 = x_170160 && y_170161;
                    bool index_certs_170163;
                    
                    if (!bounds_check_170162) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_170159, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:670:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-854:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t zeze_rhs_170164 = ((int16_t *) mem_171565)[i_170159];
                    bool is_eq_170165 = defunc_0_byteSeq_to_prim_res_169952 == zeze_rhs_170164;
                    bool cond_170166 = slt64((int64_t) 0, duome_170158);
                    bool cond_170167 = is_eq_170165 || cond_170166;
                    int64_t next_j_170168;
                    
                    if (cond_170167) {
                        next_j_170168 = j_170157;
                    } else {
                        int64_t next_j_f_res_170169 = add64((int64_t) 1, j_170157);
                        
                        next_j_170168 = next_j_f_res_170169;
                    }
                    
                    int64_t next_duome_170170;
                    
                    if (is_eq_170165) {
                        int64_t next_duome_t_res_170171 = add64((int64_t) 1, duome_170158);
                        
                        next_duome_170170 = next_duome_t_res_170171;
                    } else {
                        next_duome_170170 = duome_170158;
                    }
                    
                    int64_t tmp_170172 = add64((int64_t) 1, i_170159);
                    bool loop_cond_170173 = slt64(tmp_170172, sup_170144);
                    bool loop_while_tmp_172030 = loop_cond_170173;
                    int64_t j_tmp_172031 = next_j_170168;
                    int64_t duome_tmp_172032 = next_duome_170170;
                    int64_t i_tmp_172033 = tmp_170172;
                    
                    loop_while_170156 = loop_while_tmp_172030;
                    j_170157 = j_tmp_172031;
                    duome_170158 = duome_tmp_172032;
                    i_170159 = i_tmp_172033;
                }
                lifted_lambda_res_170152 = loop_while_170156;
                lifted_lambda_res_170153 = j_170157;
                lifted_lambda_res_170154 = duome_170158;
                lifted_lambda_res_170155 = i_170159;
                
                bool cond_170174 = slt64(lifted_lambda_res_170153, sup_170144);
                int64_t lifted_lambda_res_170175;
                
                if (cond_170174) {
                    lifted_lambda_res_170175 = lifted_lambda_res_170154;
                } else {
                    lifted_lambda_res_170175 = (int64_t) 0;
                }
                
                int64_t lifted_lambda_res_170176;
                
                if (cond_170174) {
                    lifted_lambda_res_170176 = lifted_lambda_res_170153;
                } else {
                    lifted_lambda_res_170176 = (int64_t) -1;
                }
                
                bool lifted_lambda_res_170177 = slt64((int64_t) 1, lifted_lambda_res_170175);
                int64_t defunc_0_f_res_170178 = btoi_bool_i64(lifted_lambda_res_170177);
                int64_t defunc_0_op_res_170181 = add64(defunc_0_f_res_170178, scanacc_171072);
                int64_t defunc_0_op_res_170184 = add64(lifted_lambda_res_170175, scanacc_171073);
                int64_t zp_res_170187 = add64(lifted_lambda_res_170175, redout_171076);
                
                ((int64_t *) mem_171573)[i_171081] = defunc_0_op_res_170181;
                ((int64_t *) mem_171575)[i_171081] = defunc_0_op_res_170184;
                ((int64_t *) mem_171577)[i_171081] = defunc_0_f_res_170178;
                ((int64_t *) mem_171579)[i_171081] = lifted_lambda_res_170176;
                ((int64_t *) mem_171581)[i_171081] = lifted_lambda_res_170175;
                ((int16_t *) mem_171583)[i_171081] = defunc_0_byteSeq_to_prim_res_169952;
                
                int64_t scanacc_tmp_172008 = defunc_0_op_res_170181;
                int64_t scanacc_tmp_172009 = defunc_0_op_res_170184;
                int64_t redout_tmp_172012 = zp_res_170187;
                
                scanacc_171072 = scanacc_tmp_172008;
                scanacc_171073 = scanacc_tmp_172009;
                redout_171076 = redout_tmp_172012;
            }
            discard_171088 = scanacc_171072;
            discard_171089 = scanacc_171073;
            defunc_res_169946 = redout_171076;
            
            int64_t m_f_res_170223;
            
            if (x_158710) {
                int64_t x_170224 = ((int64_t *) mem_171573)[tmp_158711];
                
                m_f_res_170223 = x_170224;
            } else {
                m_f_res_170223 = (int64_t) 0;
            }
            
            int64_t m_170225;
            
            if (cond_158709) {
                m_170225 = (int64_t) 0;
            } else {
                m_170225 = m_f_res_170223;
            }
            
            bool cond_170226 = slt64((int64_t) 0, m_170225);
            int64_t m_170227 = sub64(m_170225, (int64_t) 1);
            bool i_p_m_t_s_leq_w_170228 = slt64(m_170227, nR_140576);
            bool zzero_leq_i_p_m_t_s_170229 = sle64((int64_t) 0, m_170227);
            bool y_170230 = i_p_m_t_s_leq_w_170228 && zzero_leq_i_p_m_t_s_170229;
            bool i_lte_j_170231 = sle64((int64_t) 0, m_170225);
            bool forwards_ok_170232 = y_170230 && i_lte_j_170231;
            bool eq_x_zz_170233 = (int64_t) 0 == m_f_res_170223;
            bool p_and_eq_x_y_170234 = x_158710 && eq_x_zz_170233;
            bool empty_slice_170235 = cond_158709 || p_and_eq_x_y_170234;
            bool ok_or_empty_170236 = forwards_ok_170232 || empty_slice_170235;
            bool index_certs_170237;
            
            if (!ok_or_empty_170236) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_170225, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-854:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171628 = (int64_t) 8 * m_170225;
            
            if (mem_171629_cached_sizze_172176 < bytes_171628) {
                err = lexical_realloc(ctx, &mem_171629, &mem_171629_cached_sizze_172176, bytes_171628);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171629, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171581, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_170225});
            
            int64_t max_mult_170240;
            
            if (cond_170226) {
                if (mem_171631_cached_sizze_172177 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171631, &mem_171631_cached_sizze_172177, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171096 = 0; i_171096 < nR_140576; i_171096++) {
                    int64_t eta_p_170242 = ((int64_t *) mem_171577)[i_171096];
                    int64_t eta_p_170243 = ((int64_t *) mem_171573)[i_171096];
                    bool cond_170244 = eta_p_170242 == (int64_t) 1;
                    int64_t lifted_lambda_res_170245;
                    
                    if (cond_170244) {
                        int64_t lifted_lambda_res_t_res_170246 = sub64(eta_p_170243, (int64_t) 1);
                        
                        lifted_lambda_res_170245 = lifted_lambda_res_t_res_170246;
                    } else {
                        lifted_lambda_res_170245 = (int64_t) -1;
                    }
                    ((int64_t *) mem_171631)[i_171096] = lifted_lambda_res_170245;
                }
                for (int64_t write_iter_171098 = 0; write_iter_171098 < nR_140576; write_iter_171098++) {
                    int64_t write_iv_171100 = ((int64_t *) mem_171631)[write_iter_171098];
                    int64_t write_iv_171101 = ((int64_t *) mem_171581)[write_iter_171098];
                    
                    if (sle64((int64_t) 0, write_iv_171100) && slt64(write_iv_171100, m_170225)) {
                        ((int64_t *) mem_171629)[write_iv_171100] = write_iv_171101;
                    }
                }
                
                int64_t defunc_0_reduce_res_170260;
                int64_t redout_171103 = (int64_t) -9223372036854775808;
                
                for (int64_t i_171104 = 0; i_171104 < m_170225; i_171104++) {
                    int64_t x_170261 = ((int64_t *) mem_171629)[i_171104];
                    int64_t max_res_170264 = smax64(x_170261, redout_171103);
                    int64_t redout_tmp_172036 = max_res_170264;
                    
                    redout_171103 = redout_tmp_172036;
                }
                defunc_0_reduce_res_170260 = redout_171103;
                max_mult_170240 = defunc_0_reduce_res_170260;
            } else {
                max_mult_170240 = (int64_t) 1;
            }
            
            int64_t bytes_171644 = (int64_t) 8 * defunc_res_169946;
            bool bounds_invalid_upwards_170296 = slt64(max_mult_170240, (int64_t) 1);
            bool valid_170298 = !bounds_invalid_upwards_170296;
            bool range_valid_c_170299;
            
            if (!valid_170298) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_170240, " is invalid.", "-> #0  ftHashJoin.fut:693:18-30\n   #1  ftHashJoin.fut:850:4-854:57\n   #2  ftRelational.fut:258:6-261:37\n   #3  ftRelational.fut:254:3-261:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171682 = b_140577 * defunc_res_169946;
            
            if (mem_171621_cached_sizze_172175 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171621, &mem_171621_cached_sizze_172175, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171092 = 0; i_171092 < nR_140576; i_171092++) {
                int64_t eta_p_170212 = ((int64_t *) mem_171581)[i_171092];
                int64_t zv_lhs_170213 = add64((int64_t) -1, i_171092);
                int64_t tmp_170214 = smod64(zv_lhs_170213, nR_140576);
                int64_t lifted_lambda_res_170215 = ((int64_t *) mem_171575)[tmp_170214];
                bool cond_170216 = i_171092 == (int64_t) 0;
                int64_t lifted_lambda_res_170217;
                
                if (cond_170216) {
                    lifted_lambda_res_170217 = (int64_t) 0;
                } else {
                    lifted_lambda_res_170217 = lifted_lambda_res_170215;
                }
                
                bool cond_170218 = slt64((int64_t) 0, eta_p_170212);
                int64_t lifted_lambda_res_170219;
                
                if (cond_170218) {
                    lifted_lambda_res_170219 = lifted_lambda_res_170217;
                } else {
                    lifted_lambda_res_170219 = (int64_t) -1;
                }
                ((int64_t *) mem_171621)[i_171092] = lifted_lambda_res_170219;
            }
            if (memblock_alloc(ctx, &mem_171645, bytes_171644, "mem_171645")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172038 = 0; nest_i_172038 < defunc_res_169946; nest_i_172038++) {
                ((int64_t *) mem_171645.mem)[nest_i_172038] = (int64_t) 0;
            }
            for (int64_t write_iter_171105 = 0; write_iter_171105 < nR_140576; write_iter_171105++) {
                int64_t write_iv_171107 = ((int64_t *) mem_171621)[write_iter_171105];
                
                if (sle64((int64_t) 0, write_iv_171107) && slt64(write_iv_171107, defunc_res_169946)) {
                    ((int64_t *) mem_171645.mem)[write_iv_171107] = write_iter_171105;
                }
            }
            if (memblock_alloc(ctx, &mem_171653, bytes_171644, "mem_171653")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172040 = 0; nest_i_172040 < defunc_res_169946; nest_i_172040++) {
                ((int64_t *) mem_171653.mem)[nest_i_172040] = (int64_t) 1;
            }
            
            int64_t distance_170297 = sub64(max_mult_170240, (int64_t) 1);
            
            if (memblock_set(ctx, &mem_param_171656, &mem_171653, "mem_171653") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171659, &mem_171645, "mem_171645") != 0)
                return 1;
            for (int64_t i_170302 = 0; i_170302 < distance_170297; i_170302++) {
                int64_t index_primexp_170305 = add64((int64_t) 1, i_170302);
                
                if (memblock_alloc(ctx, &mem_171661, bytes_171644, "mem_171661")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171661.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171659.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169946});
                if (memblock_alloc(ctx, &mem_171663, bytes_171644, "mem_171663")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171663.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171656.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169946});
                
                int64_t replicate_arg1_170308 = add64((int64_t) 2, i_170302);
                
                for (int64_t write_iter_171110 = 0; write_iter_171110 < nR_140576; write_iter_171110++) {
                    int64_t zlze_lhs_170316 = ((int64_t *) mem_171581)[write_iter_171110];
                    bool cond_170317 = sle64(zlze_lhs_170316, index_primexp_170305);
                    int64_t lifted_lambda_res_170318;
                    
                    if (cond_170317) {
                        lifted_lambda_res_170318 = (int64_t) -1;
                    } else {
                        int64_t zp_lhs_170319 = ((int64_t *) mem_171621)[write_iter_171110];
                        int64_t lifted_lambda_res_f_res_170320 = add64(index_primexp_170305, zp_lhs_170319);
                        
                        lifted_lambda_res_170318 = lifted_lambda_res_f_res_170320;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_170318) && slt64(lifted_lambda_res_170318, defunc_res_169946)) {
                        ((int64_t *) mem_171663.mem)[lifted_lambda_res_170318] = replicate_arg1_170308;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_170318) && slt64(lifted_lambda_res_170318, defunc_res_169946)) {
                        ((int64_t *) mem_171661.mem)[lifted_lambda_res_170318] = write_iter_171110;
                    }
                }
                if (memblock_set(ctx, &mem_param_tmp_172041, &mem_171663, "mem_171663") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_172042, &mem_171661, "mem_171661") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171656, &mem_param_tmp_172041, "mem_param_tmp_172041") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171659, &mem_param_tmp_172042, "mem_param_tmp_172042") != 0)
                    return 1;
            }
            if (memblock_set(ctx, &ext_mem_171681, &mem_param_171656, "mem_param_171656") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171680, &mem_param_171659, "mem_param_171659") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_171645, "mem_171645") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_171653, "mem_171653") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171683, bytes_171682, "mem_171683")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_171685, bytes_171644, "mem_171685")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171120 = 0; i_171120 < defunc_res_169946; i_171120++) {
                int64_t eta_p_170332 = ((int64_t *) ext_mem_171680.mem)[i_171120];
                bool x_170333 = sle64((int64_t) 0, eta_p_170332);
                bool y_170334 = slt64(eta_p_170332, nR_140576);
                bool bounds_check_170335 = x_170333 && y_170334;
                bool index_certs_170336;
                
                if (!bounds_check_170335) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_170332, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  ftHashJoin.fut:703:16-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:702:8-710:6\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t eta_p_170331 = ((int64_t *) ext_mem_171681.mem)[i_171120];
                int16_t rv_170337 = ((int16_t *) mem_171583)[eta_p_170332];
                int64_t inf_s_idx_170338 = ((int64_t *) mem_171579)[eta_p_170332];
                int64_t tmp_170339 = sub64(inf_s_idx_170338, (int64_t) 1);
                bool loop_cond_170340 = slt64((int64_t) 0, eta_p_170331);
                bool kth_match_170341;
                int64_t kth_match_170342;
                int64_t kth_match_170343;
                bool loop_while_170344;
                int64_t j_170345;
                int64_t m_170346;
                
                loop_while_170344 = loop_cond_170340;
                j_170345 = tmp_170339;
                m_170346 = (int64_t) 0;
                while (loop_while_170344) {
                    int64_t zeze_rhs_170347 = add64((int64_t) 1, j_170345);
                    bool x_170348 = sle64((int64_t) 0, zeze_rhs_170347);
                    bool y_170349 = slt64(zeze_rhs_170347, nS_140578);
                    bool bounds_check_170350 = x_170348 && y_170349;
                    bool index_certs_170351;
                    
                    if (!bounds_check_170350) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_170347, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:707:29-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:702:8-710:6\n   #3  ftHashJoin.fut:850:4-854:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t zeze_rhs_170352 = ((int16_t *) mem_171565)[zeze_rhs_170347];
                    bool is_eq_170353 = rv_170337 == zeze_rhs_170352;
                    int64_t loopres_170354;
                    
                    if (is_eq_170353) {
                        int64_t tmp_170355 = add64((int64_t) 1, m_170346);
                        
                        loopres_170354 = tmp_170355;
                    } else {
                        loopres_170354 = m_170346;
                    }
                    
                    bool loop_cond_170356 = slt64(loopres_170354, eta_p_170331);
                    bool loop_while_tmp_172049 = loop_cond_170356;
                    int64_t j_tmp_172050 = zeze_rhs_170347;
                    int64_t m_tmp_172051 = loopres_170354;
                    
                    loop_while_170344 = loop_while_tmp_172049;
                    j_170345 = j_tmp_172050;
                    m_170346 = m_tmp_172051;
                }
                kth_match_170341 = loop_while_170344;
                kth_match_170342 = j_170345;
                kth_match_170343 = m_170346;
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171683.mem, i_171120 * b_140577, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171274.mem, eta_p_170332 * b_140577, (int64_t []) {(int64_t) 1}, (int64_t []) {b_140577});
                ((int64_t *) mem_171685.mem)[i_171120] = kth_match_170342;
            }
            if (memblock_unref(ctx, &ext_mem_171681, "ext_mem_171681") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171701, bytes_171644, "mem_171701")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171701.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171680.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169946});
            if (memblock_unref(ctx, &ext_mem_171680, "ext_mem_171680") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171709, &mem_171701, "mem_171701") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171708, &mem_171685, "mem_171685") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171705, &mem_171683, "mem_171683") != 0)
                return 1;
            radix_hash_join_res_f_res_159095 = defunc_res_169946;
            radix_hash_join_res_f_res_159096 = defunc_res_169946;
            radix_hash_join_res_f_res_159097 = defunc_res_169946;
        } else {
            int64_t radix_hash_join_res_f_res_f_res_159454;
            
            if (cond_158704) {
                if (mem_171419_cached_sizze_172158 < bytes_171418) {
                    err = lexical_realloc(ctx, &mem_171419, &mem_171419_cached_sizze_172158, bytes_171418);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171125 = 0; i_171125 < nS_140578; i_171125++) {
                    int32_t defunc_0_byteSeq_to_prim_res_170456;
                    int32_t y_170458 = 0;
                    
                    for (int64_t i_170457 = 0; i_170457 < b_140577; i_170457++) {
                        int64_t zm_lhs_170459 = sub64(b_140577, i_170457);
                        int64_t from_u8_arg0_170460 = sub64(zm_lhs_170459, (int64_t) 1);
                        bool x_170461 = sle64((int64_t) 0, from_u8_arg0_170460);
                        bool y_170462 = slt64(from_u8_arg0_170460, b_140577);
                        bool bounds_check_170463 = x_170461 && y_170462;
                        bool index_certs_170464;
                        
                        if (!bounds_check_170463) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_170460, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:427:75-82\n   #2  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_170465 = ((int8_t *) pS_mem_171275.mem)[i_171125 * b_140577 + from_u8_arg0_170460];
                        int32_t u8_res_170466 = zext_i8_i32(from_u8_arg0_170465);
                        int32_t i64_res_170467 = sext_i64_i32(i_170457);
                        int32_t shift_left_rhs_170468 = mul32(8, i64_res_170467);
                        int32_t lifted_lambda_res_170469 = shl32(u8_res_170466, shift_left_rhs_170468);
                        int32_t unsign_arg0_170470 = y_170458 | lifted_lambda_res_170469;
                        int32_t y_tmp_172053 = unsign_arg0_170470;
                        
                        y_170458 = y_tmp_172053;
                    }
                    defunc_0_byteSeq_to_prim_res_170456 = y_170458;
                    ((int32_t *) mem_171419)[i_171125] = defunc_0_byteSeq_to_prim_res_170456;
                }
                if (mem_171427_cached_sizze_172159 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171427, &mem_171427_cached_sizze_172159, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171429_cached_sizze_172160 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171429, &mem_171429_cached_sizze_172160, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171431_cached_sizze_172161 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171431, &mem_171431_cached_sizze_172161, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171433_cached_sizze_172162 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171433, &mem_171433_cached_sizze_172162, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171435_cached_sizze_172163 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171435, &mem_171435_cached_sizze_172163, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171437_cached_sizze_172164 < bytes_171436) {
                    err = lexical_realloc(ctx, &mem_171437, &mem_171437_cached_sizze_172164, bytes_171436);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171149;
                int64_t discard_171150;
                int64_t defunc_res_170477;
                int64_t scanacc_171133;
                int64_t scanacc_171134;
                int64_t redout_171137;
                
                scanacc_171133 = (int64_t) 0;
                scanacc_171134 = (int64_t) 0;
                redout_171137 = (int64_t) 0;
                for (int64_t i_171142 = 0; i_171142 < nR_140576; i_171142++) {
                    int32_t defunc_0_byteSeq_to_prim_res_170483;
                    int32_t y_170485 = 0;
                    
                    for (int64_t i_170484 = 0; i_170484 < b_140577; i_170484++) {
                        int64_t zm_lhs_170486 = sub64(b_140577, i_170484);
                        int64_t from_u8_arg0_170487 = sub64(zm_lhs_170486, (int64_t) 1);
                        bool x_170488 = sle64((int64_t) 0, from_u8_arg0_170487);
                        bool y_170489 = slt64(from_u8_arg0_170487, b_140577);
                        bool bounds_check_170490 = x_170488 && y_170489;
                        bool index_certs_170491;
                        
                        if (!bounds_check_170490) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_170487, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:427:75-82\n   #2  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_170492 = ((int8_t *) pR_mem_171274.mem)[i_171142 * b_140577 + from_u8_arg0_170487];
                        int32_t u8_res_170493 = zext_i8_i32(from_u8_arg0_170492);
                        int32_t i64_res_170494 = sext_i64_i32(i_170484);
                        int32_t shift_left_rhs_170495 = mul32(8, i64_res_170494);
                        int32_t lifted_lambda_res_170496 = shl32(u8_res_170493, shift_left_rhs_170495);
                        int32_t unsign_arg0_170497 = y_170485 | lifted_lambda_res_170496;
                        int32_t y_tmp_172063 = unsign_arg0_170497;
                        
                        y_170485 = y_tmp_172063;
                    }
                    defunc_0_byteSeq_to_prim_res_170483 = y_170485;
                    
                    int32_t lifted_lambda_res_170498 = za_rhs_158721 & defunc_0_byteSeq_to_prim_res_170483;
                    int64_t u32_res_170499 = zext_i32_i64(lifted_lambda_res_170498);
                    bool x_170500 = sle64((int64_t) 0, u32_res_170499);
                    bool y_170501 = slt64(u32_res_170499, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580);
                    bool bounds_check_170502 = x_170500 && y_170501;
                    bool index_certs_170503;
                    
                    if (!bounds_check_170502) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u32_res_170499, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_170504 = ((int64_t *) first_info_idx_mem_171278.mem)[u32_res_170499];
                    bool cond_170505 = slt64(spi_170504, (int64_t) 0);
                    int64_t defunc_res_170506;
                    
                    if (cond_170505) {
                        defunc_res_170506 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_170507 = ((int64_t *) last_info_idx_mem_171279.mem)[u32_res_170499];
                        bool cond_170508 = spi_170504 == zeze_rhs_170507;
                        int64_t defunc_res_f_res_170509;
                        
                        if (cond_170508) {
                            defunc_res_f_res_170509 = spi_170504;
                        } else {
                            int64_t zs_lhs_170510 = sub64(zeze_rhs_170507, spi_170504);
                            int64_t max_arg1_170511 = sdiv64(zs_lhs_170510, (int64_t) 2);
                            int64_t max_res_170512 = smax64((int64_t) 1, max_arg1_170511);
                            bool loop_cond_170513 = slt64((int64_t) 0, max_res_170512);
                            bool bsearch_170514;
                            int64_t bsearch_170515;
                            int64_t bsearch_170516;
                            bool loop_while_170517;
                            int64_t heshi_170518;
                            int64_t step_170519;
                            
                            loop_while_170517 = loop_cond_170513;
                            heshi_170518 = spi_170504;
                            step_170519 = max_res_170512;
                            while (loop_while_170517) {
                                bool x_170520 = sle64((int64_t) 0, heshi_170518);
                                bool y_170521 = slt64(heshi_170518, dz2081U_140579);
                                bool bounds_check_170522 = x_170520 && y_170521;
                                bool index_certs_170523;
                                
                                if (!bounds_check_170522) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_170518, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_170541 = ((int64_t *) bounds_mem_171276.mem)[heshi_170518];
                                bool x_170542 = sle64((int64_t) 0, cur_S_170541);
                                bool y_170543 = slt64(cur_S_170541, nS_140578);
                                bool bounds_check_170544 = x_170542 && y_170543;
                                bool index_certs_170545;
                                
                                if (!bounds_check_170544) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_170541, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_170524 = ((int32_t *) depths_mem_171277.mem)[heshi_170518];
                                bool cond_170525 = heshi_170518 == spi_170504;
                                int32_t prev_depth_170526;
                                
                                if (cond_170525) {
                                    prev_depth_170526 = cur_depth_170524;
                                } else {
                                    int64_t tmp_170527 = sub64(heshi_170518, (int64_t) 1);
                                    bool x_170528 = sle64((int64_t) 0, tmp_170527);
                                    bool y_170529 = slt64(tmp_170527, dz2081U_140579);
                                    bool bounds_check_170530 = x_170528 && y_170529;
                                    bool index_certs_170531;
                                    
                                    if (!bounds_check_170530) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170527, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_170532 = ((int32_t *) depths_mem_171277.mem)[tmp_170527];
                                    
                                    prev_depth_170526 = prev_depth_f_res_170532;
                                }
                                
                                bool cond_170533 = heshi_170518 == zeze_rhs_170507;
                                int32_t next_depth_170534;
                                
                                if (cond_170533) {
                                    next_depth_170534 = cur_depth_170524;
                                } else {
                                    int64_t tmp_170535 = add64((int64_t) 1, heshi_170518);
                                    bool x_170536 = sle64((int64_t) 0, tmp_170535);
                                    bool y_170537 = slt64(tmp_170535, dz2081U_140579);
                                    bool bounds_check_170538 = x_170536 && y_170537;
                                    bool index_certs_170539;
                                    
                                    if (!bounds_check_170538) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170535, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_170540 = ((int32_t *) depths_mem_171277.mem)[tmp_170535];
                                    
                                    next_depth_170534 = next_depth_f_res_170540;
                                }
                                
                                int32_t cur_S_170546 = ((int32_t *) mem_171419)[cur_S_170541];
                                int32_t prev_S_170547;
                                
                                if (cond_170525) {
                                    prev_S_170547 = cur_S_170546;
                                } else {
                                    int64_t tmp_170548 = sub64(heshi_170518, (int64_t) 1);
                                    bool x_170549 = sle64((int64_t) 0, tmp_170548);
                                    bool y_170550 = slt64(tmp_170548, dz2081U_140579);
                                    bool bounds_check_170551 = x_170549 && y_170550;
                                    bool index_certs_170552;
                                    
                                    if (!bounds_check_170551) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170548, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_170553 = ((int64_t *) bounds_mem_171276.mem)[tmp_170548];
                                    bool x_170554 = sle64((int64_t) 0, tmp_170553);
                                    bool y_170555 = slt64(tmp_170553, nS_140578);
                                    bool bounds_check_170556 = x_170554 && y_170555;
                                    bool index_certs_170557;
                                    
                                    if (!bounds_check_170556) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170553, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_S_f_res_170558 = ((int32_t *) mem_171419)[tmp_170553];
                                    
                                    prev_S_170547 = prev_S_f_res_170558;
                                }
                                
                                int32_t next_S_170559;
                                
                                if (cond_170533) {
                                    next_S_170559 = cur_S_170546;
                                } else {
                                    int64_t tmp_170560 = add64((int64_t) 1, heshi_170518);
                                    bool x_170561 = sle64((int64_t) 0, tmp_170560);
                                    bool y_170562 = slt64(tmp_170560, dz2081U_140579);
                                    bool bounds_check_170563 = x_170561 && y_170562;
                                    bool index_certs_170564;
                                    
                                    if (!bounds_check_170563) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170560, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_170565 = ((int64_t *) bounds_mem_171276.mem)[tmp_170560];
                                    bool x_170566 = sle64((int64_t) 0, tmp_170565);
                                    bool y_170567 = slt64(tmp_170565, nS_140578);
                                    bool bounds_check_170568 = x_170566 && y_170567;
                                    bool index_certs_170569;
                                    
                                    if (!bounds_check_170568) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170565, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:722:3-729:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_S_f_res_170570 = ((int32_t *) mem_171419)[tmp_170565];
                                    
                                    next_S_170559 = next_S_f_res_170570;
                                }
                                
                                int32_t prim_get_radix_arg0_170571 = mul32(radix_sizze_140581, cur_depth_170524);
                                int64_t unsign_arg0_170572 = zext_i32_i64(prim_get_radix_arg0_170571);
                                int64_t asPow_170573 = shl64((int64_t) 1, unsign_arg0_170572);
                                int64_t u64_arg0_170574 = sub64(asPow_170573, (int64_t) 1);
                                int32_t u64_res_170575 = zext_i64_i32(u64_arg0_170574);
                                int32_t lifted_lambda_res_170576 = defunc_0_byteSeq_to_prim_res_170483 & u64_res_170575;
                                int32_t lifted_lambda_res_170577 = cur_S_170546 & u64_res_170575;
                                bool defunc_0_eq_res_170578 = lifted_lambda_res_170576 == lifted_lambda_res_170577;
                                int64_t loopres_170579;
                                int64_t loopres_170580;
                                
                                if (defunc_0_eq_res_170578) {
                                    loopres_170579 = heshi_170518;
                                    loopres_170580 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_170581 = slt32(0, cur_depth_170524);
                                    bool is_lt_170582;
                                    bool is_lt_170583;
                                    int32_t is_lt_170584;
                                    bool loop_while_170585;
                                    bool def_lt_170586;
                                    int32_t bi_170587;
                                    
                                    loop_while_170585 = loop_cond_t_res_170581;
                                    def_lt_170586 = 0;
                                    bi_170587 = 0;
                                    while (loop_while_170585) {
                                        int32_t zt_rhs_170588 = add32(1, bi_170587);
                                        int32_t prim_get_radix_arg0_170589 = mul32(radix_sizze_140581, zt_rhs_170588);
                                        int64_t unsign_arg0_170590 = zext_i32_i64(prim_get_radix_arg0_170589);
                                        int64_t asPow_170591 = shl64((int64_t) 1, unsign_arg0_170590);
                                        int64_t u64_arg0_170592 = sub64(asPow_170591, (int64_t) 1);
                                        int32_t u64_res_170593 = zext_i64_i32(u64_arg0_170592);
                                        int32_t lifted_lambda_res_170594 = defunc_0_byteSeq_to_prim_res_170483 & u64_res_170593;
                                        int32_t lifted_lambda_res_170595 = cur_S_170546 & u64_res_170593;
                                        bool defunc_0_lt_res_170596 = ult32(lifted_lambda_res_170594, lifted_lambda_res_170595);
                                        bool defunc_0_lt_res_170597 = ult32(lifted_lambda_res_170595, lifted_lambda_res_170594);
                                        bool cond_170598 = !defunc_0_lt_res_170597;
                                        bool cond_t_res_170599 = !defunc_0_lt_res_170596;
                                        bool x_170600 = cond_170598 && cond_t_res_170599;
                                        bool loop_cond_t_res_170601 = slt32(zt_rhs_170588, cur_depth_170524);
                                        bool x_170602 = x_170600 && loop_cond_t_res_170601;
                                        bool loop_while_tmp_172067 = x_170602;
                                        bool def_lt_tmp_172068 = defunc_0_lt_res_170596;
                                        int32_t bi_tmp_172069 = zt_rhs_170588;
                                        
                                        loop_while_170585 = loop_while_tmp_172067;
                                        def_lt_170586 = def_lt_tmp_172068;
                                        bi_170587 = bi_tmp_172069;
                                    }
                                    is_lt_170582 = loop_while_170585;
                                    is_lt_170583 = def_lt_170586;
                                    is_lt_170584 = bi_170587;
                                    
                                    int64_t loopres_f_res_170603;
                                    int64_t loopres_f_res_170604;
                                    
                                    if (is_lt_170583) {
                                        bool loop_cond_t_res_170605 = slt32(0, prev_depth_170526);
                                        bool is_gt_170606;
                                        bool is_gt_170607;
                                        int32_t is_gt_170608;
                                        bool loop_while_170609;
                                        bool def_gt_170610;
                                        int32_t bi_170611;
                                        
                                        loop_while_170609 = loop_cond_t_res_170605;
                                        def_gt_170610 = 0;
                                        bi_170611 = 0;
                                        while (loop_while_170609) {
                                            int32_t zt_rhs_170612 = add32(1, bi_170611);
                                            int32_t prim_get_radix_arg0_170613 = mul32(radix_sizze_140581, zt_rhs_170612);
                                            int64_t unsign_arg0_170614 = zext_i32_i64(prim_get_radix_arg0_170613);
                                            int64_t asPow_170615 = shl64((int64_t) 1, unsign_arg0_170614);
                                            int64_t u64_arg0_170616 = sub64(asPow_170615, (int64_t) 1);
                                            int32_t u64_res_170617 = zext_i64_i32(u64_arg0_170616);
                                            int32_t lifted_lambda_res_170618 = defunc_0_byteSeq_to_prim_res_170483 & u64_res_170617;
                                            int32_t lifted_lambda_res_170619 = prev_S_170547 & u64_res_170617;
                                            bool defunc_0_gt_res_170620 = ult32(lifted_lambda_res_170619, lifted_lambda_res_170618);
                                            bool defunc_0_gt_res_170621 = ult32(lifted_lambda_res_170618, lifted_lambda_res_170619);
                                            bool cond_170622 = !defunc_0_gt_res_170620;
                                            bool cond_t_res_170623 = !defunc_0_gt_res_170621;
                                            bool x_170624 = cond_170622 && cond_t_res_170623;
                                            bool loop_cond_t_res_170625 = slt32(zt_rhs_170612, prev_depth_170526);
                                            bool x_170626 = x_170624 && loop_cond_t_res_170625;
                                            bool loop_while_tmp_172070 = x_170626;
                                            bool def_gt_tmp_172071 = defunc_0_gt_res_170620;
                                            int32_t bi_tmp_172072 = zt_rhs_170612;
                                            
                                            loop_while_170609 = loop_while_tmp_172070;
                                            def_gt_170610 = def_gt_tmp_172071;
                                            bi_170611 = bi_tmp_172072;
                                        }
                                        is_gt_170606 = loop_while_170609;
                                        is_gt_170607 = def_gt_170610;
                                        is_gt_170608 = bi_170611;
                                        
                                        bool x_170627 = !cond_170525;
                                        bool y_170628 = is_gt_170607 && x_170627;
                                        bool cond_170629 = cond_170525 || y_170628;
                                        int64_t loopres_f_res_t_res_170630;
                                        int64_t loopres_f_res_t_res_170631;
                                        
                                        if (cond_170629) {
                                            loopres_f_res_t_res_170630 = (int64_t) -1;
                                            loopres_f_res_t_res_170631 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_170632 = sub64(heshi_170518, step_170519);
                                            int64_t max_arg1_170633 = sdiv64(step_170519, (int64_t) 2);
                                            int64_t max_res_170634 = smax64((int64_t) 1, max_arg1_170633);
                                            
                                            loopres_f_res_t_res_170630 = tmp_170632;
                                            loopres_f_res_t_res_170631 = max_res_170634;
                                        }
                                        loopres_f_res_170603 = loopres_f_res_t_res_170630;
                                        loopres_f_res_170604 = loopres_f_res_t_res_170631;
                                    } else {
                                        bool loop_cond_t_res_170635 = slt32(0, next_depth_170534);
                                        bool is_lt_170636;
                                        bool is_lt_170637;
                                        int32_t is_lt_170638;
                                        bool loop_while_170639;
                                        bool def_lt_170640;
                                        int32_t bi_170641;
                                        
                                        loop_while_170639 = loop_cond_t_res_170635;
                                        def_lt_170640 = 0;
                                        bi_170641 = 0;
                                        while (loop_while_170639) {
                                            int32_t zt_rhs_170642 = add32(1, bi_170641);
                                            int32_t prim_get_radix_arg0_170643 = mul32(radix_sizze_140581, zt_rhs_170642);
                                            int64_t unsign_arg0_170644 = zext_i32_i64(prim_get_radix_arg0_170643);
                                            int64_t asPow_170645 = shl64((int64_t) 1, unsign_arg0_170644);
                                            int64_t u64_arg0_170646 = sub64(asPow_170645, (int64_t) 1);
                                            int32_t u64_res_170647 = zext_i64_i32(u64_arg0_170646);
                                            int32_t lifted_lambda_res_170648 = defunc_0_byteSeq_to_prim_res_170483 & u64_res_170647;
                                            int32_t lifted_lambda_res_170649 = next_S_170559 & u64_res_170647;
                                            bool defunc_0_lt_res_170650 = ult32(lifted_lambda_res_170648, lifted_lambda_res_170649);
                                            bool defunc_0_lt_res_170651 = ult32(lifted_lambda_res_170649, lifted_lambda_res_170648);
                                            bool cond_170652 = !defunc_0_lt_res_170651;
                                            bool cond_t_res_170653 = !defunc_0_lt_res_170650;
                                            bool x_170654 = cond_170652 && cond_t_res_170653;
                                            bool loop_cond_t_res_170655 = slt32(zt_rhs_170642, next_depth_170534);
                                            bool x_170656 = x_170654 && loop_cond_t_res_170655;
                                            bool loop_while_tmp_172073 = x_170656;
                                            bool def_lt_tmp_172074 = defunc_0_lt_res_170650;
                                            int32_t bi_tmp_172075 = zt_rhs_170642;
                                            
                                            loop_while_170639 = loop_while_tmp_172073;
                                            def_lt_170640 = def_lt_tmp_172074;
                                            bi_170641 = bi_tmp_172075;
                                        }
                                        is_lt_170636 = loop_while_170639;
                                        is_lt_170637 = def_lt_170640;
                                        is_lt_170638 = bi_170641;
                                        
                                        bool x_170657 = !cond_170533;
                                        bool y_170658 = is_lt_170637 && x_170657;
                                        bool cond_170659 = cond_170533 || y_170658;
                                        int64_t loopres_f_res_f_res_170660;
                                        int64_t loopres_f_res_f_res_170661;
                                        
                                        if (cond_170659) {
                                            loopres_f_res_f_res_170660 = (int64_t) -1;
                                            loopres_f_res_f_res_170661 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_170662 = add64(heshi_170518, step_170519);
                                            int64_t max_arg1_170663 = sdiv64(step_170519, (int64_t) 2);
                                            int64_t max_res_170664 = smax64((int64_t) 1, max_arg1_170663);
                                            
                                            loopres_f_res_f_res_170660 = tmp_170662;
                                            loopres_f_res_f_res_170661 = max_res_170664;
                                        }
                                        loopres_f_res_170603 = loopres_f_res_f_res_170660;
                                        loopres_f_res_170604 = loopres_f_res_f_res_170661;
                                    }
                                    loopres_170579 = loopres_f_res_170603;
                                    loopres_170580 = loopres_f_res_170604;
                                }
                                
                                bool loop_cond_170665 = slt64((int64_t) 0, loopres_170580);
                                bool loop_while_tmp_172064 = loop_cond_170665;
                                int64_t heshi_tmp_172065 = loopres_170579;
                                int64_t step_tmp_172066 = loopres_170580;
                                
                                loop_while_170517 = loop_while_tmp_172064;
                                heshi_170518 = heshi_tmp_172065;
                                step_170519 = step_tmp_172066;
                            }
                            bsearch_170514 = loop_while_170517;
                            bsearch_170515 = heshi_170518;
                            bsearch_170516 = step_170519;
                            defunc_res_f_res_170509 = bsearch_170515;
                        }
                        defunc_res_170506 = defunc_res_f_res_170509;
                    }
                    
                    bool cond_170666 = sle64(defunc_res_170506, (int64_t) 0);
                    int64_t inf_170667;
                    
                    if (cond_170666) {
                        inf_170667 = (int64_t) 0;
                    } else {
                        bool x_170668 = sle64((int64_t) 0, defunc_res_170506);
                        bool y_170669 = slt64(defunc_res_170506, dz2081U_140579);
                        bool bounds_check_170670 = x_170668 && y_170669;
                        bool index_certs_170671;
                        
                        if (!bounds_check_170670) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_170506, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:730:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-855:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_170672 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_170506];
                        
                        inf_170667 = inf_f_res_170672;
                    }
                    
                    bool cond_170673 = defunc_res_170506 == zeze_rhs_158708;
                    int64_t sup_170674;
                    
                    if (cond_170673) {
                        sup_170674 = nS_140578;
                    } else {
                        int64_t tmp_170675 = add64((int64_t) 1, defunc_res_170506);
                        bool x_170676 = sle64((int64_t) 0, tmp_170675);
                        bool y_170677 = slt64(tmp_170675, dz2081U_140579);
                        bool bounds_check_170678 = x_170676 && y_170677;
                        bool index_certs_170679;
                        
                        if (!bounds_check_170678) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170675, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:731:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-855:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_170680 = ((int64_t *) bounds_mem_171276.mem)[tmp_170675];
                        
                        sup_170674 = sup_f_res_170680;
                    }
                    
                    bool loop_cond_170681 = slt64(inf_170667, sup_170674);
                    bool lifted_lambda_res_170682;
                    int64_t lifted_lambda_res_170683;
                    int64_t lifted_lambda_res_170684;
                    int64_t lifted_lambda_res_170685;
                    bool loop_while_170686;
                    int64_t j_170687;
                    int64_t duome_170688;
                    int64_t i_170689;
                    
                    loop_while_170686 = loop_cond_170681;
                    j_170687 = inf_170667;
                    duome_170688 = (int64_t) 0;
                    i_170689 = inf_170667;
                    while (loop_while_170686) {
                        bool x_170690 = sle64((int64_t) 0, i_170689);
                        bool y_170691 = slt64(i_170689, nS_140578);
                        bool bounds_check_170692 = x_170690 && y_170691;
                        bool index_certs_170693;
                        
                        if (!bounds_check_170692) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_170689, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:734:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-855:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_rhs_170694 = ((int32_t *) mem_171419)[i_170689];
                        bool is_eq_170695 = defunc_0_byteSeq_to_prim_res_170483 == zeze_rhs_170694;
                        bool cond_170696 = slt64((int64_t) 0, duome_170688);
                        bool cond_170697 = is_eq_170695 || cond_170696;
                        int64_t next_j_170698;
                        
                        if (cond_170697) {
                            next_j_170698 = j_170687;
                        } else {
                            int64_t next_j_f_res_170699 = add64((int64_t) 1, j_170687);
                            
                            next_j_170698 = next_j_f_res_170699;
                        }
                        
                        int64_t next_duome_170700;
                        
                        if (is_eq_170695) {
                            int64_t next_duome_t_res_170701 = add64((int64_t) 1, duome_170688);
                            
                            next_duome_170700 = next_duome_t_res_170701;
                        } else {
                            next_duome_170700 = duome_170688;
                        }
                        
                        int64_t tmp_170702 = add64((int64_t) 1, i_170689);
                        bool loop_cond_170703 = slt64(tmp_170702, sup_170674);
                        bool loop_while_tmp_172076 = loop_cond_170703;
                        int64_t j_tmp_172077 = next_j_170698;
                        int64_t duome_tmp_172078 = next_duome_170700;
                        int64_t i_tmp_172079 = tmp_170702;
                        
                        loop_while_170686 = loop_while_tmp_172076;
                        j_170687 = j_tmp_172077;
                        duome_170688 = duome_tmp_172078;
                        i_170689 = i_tmp_172079;
                    }
                    lifted_lambda_res_170682 = loop_while_170686;
                    lifted_lambda_res_170683 = j_170687;
                    lifted_lambda_res_170684 = duome_170688;
                    lifted_lambda_res_170685 = i_170689;
                    
                    bool cond_170704 = slt64(lifted_lambda_res_170683, sup_170674);
                    int64_t lifted_lambda_res_170705;
                    
                    if (cond_170704) {
                        lifted_lambda_res_170705 = lifted_lambda_res_170684;
                    } else {
                        lifted_lambda_res_170705 = (int64_t) 0;
                    }
                    
                    int64_t lifted_lambda_res_170706;
                    
                    if (cond_170704) {
                        lifted_lambda_res_170706 = lifted_lambda_res_170683;
                    } else {
                        lifted_lambda_res_170706 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_170707 = slt64((int64_t) 1, lifted_lambda_res_170705);
                    int64_t defunc_0_f_res_170708 = btoi_bool_i64(lifted_lambda_res_170707);
                    int64_t defunc_0_op_res_170711 = add64(defunc_0_f_res_170708, scanacc_171133);
                    int64_t defunc_0_op_res_170714 = add64(lifted_lambda_res_170705, scanacc_171134);
                    int64_t zp_res_170717 = add64(lifted_lambda_res_170705, redout_171137);
                    
                    ((int64_t *) mem_171427)[i_171142] = defunc_0_op_res_170711;
                    ((int64_t *) mem_171429)[i_171142] = defunc_0_op_res_170714;
                    ((int64_t *) mem_171431)[i_171142] = defunc_0_f_res_170708;
                    ((int64_t *) mem_171433)[i_171142] = lifted_lambda_res_170706;
                    ((int64_t *) mem_171435)[i_171142] = lifted_lambda_res_170705;
                    ((int32_t *) mem_171437)[i_171142] = defunc_0_byteSeq_to_prim_res_170483;
                    
                    int64_t scanacc_tmp_172054 = defunc_0_op_res_170711;
                    int64_t scanacc_tmp_172055 = defunc_0_op_res_170714;
                    int64_t redout_tmp_172058 = zp_res_170717;
                    
                    scanacc_171133 = scanacc_tmp_172054;
                    scanacc_171134 = scanacc_tmp_172055;
                    redout_171137 = redout_tmp_172058;
                }
                discard_171149 = scanacc_171133;
                discard_171150 = scanacc_171134;
                defunc_res_170477 = redout_171137;
                
                int64_t m_f_res_170761;
                
                if (x_158710) {
                    int64_t x_170762 = ((int64_t *) mem_171427)[tmp_158711];
                    
                    m_f_res_170761 = x_170762;
                } else {
                    m_f_res_170761 = (int64_t) 0;
                }
                
                int64_t m_170763;
                
                if (cond_158709) {
                    m_170763 = (int64_t) 0;
                } else {
                    m_170763 = m_f_res_170761;
                }
                
                bool cond_170764 = slt64((int64_t) 0, m_170763);
                int64_t m_170765 = sub64(m_170763, (int64_t) 1);
                bool i_p_m_t_s_leq_w_170766 = slt64(m_170765, nR_140576);
                bool zzero_leq_i_p_m_t_s_170767 = sle64((int64_t) 0, m_170765);
                bool y_170768 = i_p_m_t_s_leq_w_170766 && zzero_leq_i_p_m_t_s_170767;
                bool i_lte_j_170769 = sle64((int64_t) 0, m_170763);
                bool forwards_ok_170770 = y_170768 && i_lte_j_170769;
                bool eq_x_zz_170771 = (int64_t) 0 == m_f_res_170761;
                bool p_and_eq_x_y_170772 = x_158710 && eq_x_zz_170771;
                bool empty_slice_170773 = cond_158709 || p_and_eq_x_y_170772;
                bool ok_or_empty_170774 = forwards_ok_170770 || empty_slice_170773;
                bool index_certs_170775;
                
                if (!ok_or_empty_170774) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_170763, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-855:57\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_171482 = (int64_t) 8 * m_170763;
                
                if (mem_171483_cached_sizze_172166 < bytes_171482) {
                    err = lexical_realloc(ctx, &mem_171483, &mem_171483_cached_sizze_172166, bytes_171482);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171483, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171435, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_170763});
                
                int64_t max_mult_170778;
                
                if (cond_170764) {
                    if (mem_171485_cached_sizze_172167 < bytes_171288) {
                        err = lexical_realloc(ctx, &mem_171485, &mem_171485_cached_sizze_172167, bytes_171288);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171157 = 0; i_171157 < nR_140576; i_171157++) {
                        int64_t eta_p_170780 = ((int64_t *) mem_171431)[i_171157];
                        int64_t eta_p_170781 = ((int64_t *) mem_171427)[i_171157];
                        bool cond_170782 = eta_p_170780 == (int64_t) 1;
                        int64_t lifted_lambda_res_170783;
                        
                        if (cond_170782) {
                            int64_t lifted_lambda_res_t_res_170784 = sub64(eta_p_170781, (int64_t) 1);
                            
                            lifted_lambda_res_170783 = lifted_lambda_res_t_res_170784;
                        } else {
                            lifted_lambda_res_170783 = (int64_t) -1;
                        }
                        ((int64_t *) mem_171485)[i_171157] = lifted_lambda_res_170783;
                    }
                    for (int64_t write_iter_171159 = 0; write_iter_171159 < nR_140576; write_iter_171159++) {
                        int64_t write_iv_171161 = ((int64_t *) mem_171485)[write_iter_171159];
                        int64_t write_iv_171162 = ((int64_t *) mem_171435)[write_iter_171159];
                        
                        if (sle64((int64_t) 0, write_iv_171161) && slt64(write_iv_171161, m_170763)) {
                            ((int64_t *) mem_171483)[write_iv_171161] = write_iv_171162;
                        }
                    }
                    
                    int64_t defunc_0_reduce_res_170800;
                    int64_t redout_171164 = (int64_t) -9223372036854775808;
                    
                    for (int64_t i_171165 = 0; i_171165 < m_170763; i_171165++) {
                        int64_t x_170801 = ((int64_t *) mem_171483)[i_171165];
                        int64_t max_res_170804 = smax64(x_170801, redout_171164);
                        int64_t redout_tmp_172082 = max_res_170804;
                        
                        redout_171164 = redout_tmp_172082;
                    }
                    defunc_0_reduce_res_170800 = redout_171164;
                    max_mult_170778 = defunc_0_reduce_res_170800;
                } else {
                    max_mult_170778 = (int64_t) 1;
                }
                
                int64_t bytes_171498 = (int64_t) 8 * defunc_res_170477;
                bool bounds_invalid_upwards_170840 = slt64(max_mult_170778, (int64_t) 1);
                bool valid_170842 = !bounds_invalid_upwards_170840;
                bool range_valid_c_170843;
                
                if (!valid_170842) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_170778, " is invalid.", "-> #0  ftHashJoin.fut:757:18-30\n   #1  ftHashJoin.fut:850:4-855:57\n   #2  ftRelational.fut:258:6-261:37\n   #3  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_171536 = b_140577 * defunc_res_170477;
                
                if (mem_171475_cached_sizze_172165 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171475, &mem_171475_cached_sizze_172165, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171153 = 0; i_171153 < nR_140576; i_171153++) {
                    int64_t eta_p_170749 = ((int64_t *) mem_171435)[i_171153];
                    int64_t zv_lhs_170750 = add64((int64_t) -1, i_171153);
                    int64_t tmp_170751 = smod64(zv_lhs_170750, nR_140576);
                    int64_t lifted_lambda_res_170752 = ((int64_t *) mem_171429)[tmp_170751];
                    bool cond_170753 = i_171153 == (int64_t) 0;
                    int64_t lifted_lambda_res_170754;
                    
                    if (cond_170753) {
                        lifted_lambda_res_170754 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_170754 = lifted_lambda_res_170752;
                    }
                    
                    bool cond_170755 = slt64((int64_t) 0, eta_p_170749);
                    int64_t lifted_lambda_res_170756;
                    
                    if (cond_170755) {
                        lifted_lambda_res_170756 = lifted_lambda_res_170754;
                    } else {
                        lifted_lambda_res_170756 = (int64_t) -1;
                    }
                    ((int64_t *) mem_171475)[i_171153] = lifted_lambda_res_170756;
                }
                if (memblock_alloc(ctx, &mem_171499, bytes_171498, "mem_171499")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172084 = 0; nest_i_172084 < defunc_res_170477; nest_i_172084++) {
                    ((int64_t *) mem_171499.mem)[nest_i_172084] = (int64_t) 0;
                }
                for (int64_t write_iter_171166 = 0; write_iter_171166 < nR_140576; write_iter_171166++) {
                    int64_t write_iv_171168 = ((int64_t *) mem_171475)[write_iter_171166];
                    
                    if (sle64((int64_t) 0, write_iv_171168) && slt64(write_iv_171168, defunc_res_170477)) {
                        ((int64_t *) mem_171499.mem)[write_iv_171168] = write_iter_171166;
                    }
                }
                if (memblock_alloc(ctx, &mem_171507, bytes_171498, "mem_171507")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172086 = 0; nest_i_172086 < defunc_res_170477; nest_i_172086++) {
                    ((int64_t *) mem_171507.mem)[nest_i_172086] = (int64_t) 1;
                }
                
                int64_t distance_170841 = sub64(max_mult_170778, (int64_t) 1);
                
                if (memblock_set(ctx, &mem_param_171510, &mem_171507, "mem_171507") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171513, &mem_171499, "mem_171499") != 0)
                    return 1;
                for (int64_t i_170846 = 0; i_170846 < distance_170841; i_170846++) {
                    int64_t index_primexp_170849 = add64((int64_t) 1, i_170846);
                    
                    if (memblock_alloc(ctx, &mem_171515, bytes_171498, "mem_171515")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171515.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170477});
                    if (memblock_alloc(ctx, &mem_171517, bytes_171498, "mem_171517")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171517.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171510.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170477});
                    
                    int64_t replicate_arg1_170852 = add64((int64_t) 2, i_170846);
                    
                    for (int64_t write_iter_171171 = 0; write_iter_171171 < nR_140576; write_iter_171171++) {
                        int64_t zlze_lhs_170860 = ((int64_t *) mem_171435)[write_iter_171171];
                        bool cond_170861 = sle64(zlze_lhs_170860, index_primexp_170849);
                        int64_t lifted_lambda_res_170862;
                        
                        if (cond_170861) {
                            lifted_lambda_res_170862 = (int64_t) -1;
                        } else {
                            int64_t zp_lhs_170863 = ((int64_t *) mem_171475)[write_iter_171171];
                            int64_t lifted_lambda_res_f_res_170864 = add64(index_primexp_170849, zp_lhs_170863);
                            
                            lifted_lambda_res_170862 = lifted_lambda_res_f_res_170864;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_170862) && slt64(lifted_lambda_res_170862, defunc_res_170477)) {
                            ((int64_t *) mem_171517.mem)[lifted_lambda_res_170862] = replicate_arg1_170852;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_170862) && slt64(lifted_lambda_res_170862, defunc_res_170477)) {
                            ((int64_t *) mem_171515.mem)[lifted_lambda_res_170862] = write_iter_171171;
                        }
                    }
                    if (memblock_set(ctx, &mem_param_tmp_172087, &mem_171517, "mem_171517") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_172088, &mem_171515, "mem_171515") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_171510, &mem_param_tmp_172087, "mem_param_tmp_172087") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_171513, &mem_param_tmp_172088, "mem_param_tmp_172088") != 0)
                        return 1;
                }
                if (memblock_set(ctx, &ext_mem_171535, &mem_param_171510, "mem_param_171510") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171534, &mem_param_171513, "mem_param_171513") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_171499, "mem_171499") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_171507, "mem_171507") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_171537, bytes_171536, "mem_171537")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc(ctx, &mem_171539, bytes_171498, "mem_171539")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171181 = 0; i_171181 < defunc_res_170477; i_171181++) {
                    int64_t eta_p_170878 = ((int64_t *) ext_mem_171534.mem)[i_171181];
                    bool x_170879 = sle64((int64_t) 0, eta_p_170878);
                    bool y_170880 = slt64(eta_p_170878, nR_140576);
                    bool bounds_check_170881 = x_170879 && y_170880;
                    bool index_certs_170882;
                    
                    if (!bounds_check_170881) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_170878, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  ftHashJoin.fut:767:16-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:766:8-774:6\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t eta_p_170877 = ((int64_t *) ext_mem_171535.mem)[i_171181];
                    int32_t rv_170883 = ((int32_t *) mem_171437)[eta_p_170878];
                    int64_t inf_s_idx_170884 = ((int64_t *) mem_171433)[eta_p_170878];
                    int64_t tmp_170885 = sub64(inf_s_idx_170884, (int64_t) 1);
                    bool loop_cond_170886 = slt64((int64_t) 0, eta_p_170877);
                    bool kth_match_170887;
                    int64_t kth_match_170888;
                    int64_t kth_match_170889;
                    bool loop_while_170890;
                    int64_t j_170891;
                    int64_t m_170892;
                    
                    loop_while_170890 = loop_cond_170886;
                    j_170891 = tmp_170885;
                    m_170892 = (int64_t) 0;
                    while (loop_while_170890) {
                        int64_t zeze_rhs_170893 = add64((int64_t) 1, j_170891);
                        bool x_170894 = sle64((int64_t) 0, zeze_rhs_170893);
                        bool y_170895 = slt64(zeze_rhs_170893, nS_140578);
                        bool bounds_check_170896 = x_170894 && y_170895;
                        bool index_certs_170897;
                        
                        if (!bounds_check_170896) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_170893, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:771:29-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:766:8-774:6\n   #3  ftHashJoin.fut:850:4-855:57\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_rhs_170898 = ((int32_t *) mem_171419)[zeze_rhs_170893];
                        bool is_eq_170899 = rv_170883 == zeze_rhs_170898;
                        int64_t loopres_170900;
                        
                        if (is_eq_170899) {
                            int64_t tmp_170901 = add64((int64_t) 1, m_170892);
                            
                            loopres_170900 = tmp_170901;
                        } else {
                            loopres_170900 = m_170892;
                        }
                        
                        bool loop_cond_170902 = slt64(loopres_170900, eta_p_170877);
                        bool loop_while_tmp_172095 = loop_cond_170902;
                        int64_t j_tmp_172096 = zeze_rhs_170893;
                        int64_t m_tmp_172097 = loopres_170900;
                        
                        loop_while_170890 = loop_while_tmp_172095;
                        j_170891 = j_tmp_172096;
                        m_170892 = m_tmp_172097;
                    }
                    kth_match_170887 = loop_while_170890;
                    kth_match_170888 = j_170891;
                    kth_match_170889 = m_170892;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171537.mem, i_171181 * b_140577, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171274.mem, eta_p_170878 * b_140577, (int64_t []) {(int64_t) 1}, (int64_t []) {b_140577});
                    ((int64_t *) mem_171539.mem)[i_171181] = kth_match_170888;
                }
                if (memblock_unref(ctx, &ext_mem_171535, "ext_mem_171535") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_171555, bytes_171498, "mem_171555")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171555.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171534.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170477});
                if (memblock_unref(ctx, &ext_mem_171534, "ext_mem_171534") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171563, &mem_171555, "mem_171555") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171562, &mem_171539, "mem_171539") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171559, &mem_171537, "mem_171537") != 0)
                    return 1;
                radix_hash_join_res_f_res_f_res_159454 = defunc_res_170477;
            } else {
                if (mem_171281_cached_sizze_172148 < bytes_171280) {
                    err = lexical_realloc(ctx, &mem_171281, &mem_171281_cached_sizze_172148, bytes_171280);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171186 = 0; i_171186 < nS_140578; i_171186++) {
                    int64_t defunc_0_byteSeq_to_prim_res_161864;
                    int64_t y_161866 = (int64_t) 0;
                    
                    for (int64_t i_161865 = 0; i_161865 < b_140577; i_161865++) {
                        int64_t zm_lhs_161867 = sub64(b_140577, i_161865);
                        int64_t from_u8_arg0_161868 = sub64(zm_lhs_161867, (int64_t) 1);
                        bool x_161869 = sle64((int64_t) 0, from_u8_arg0_161868);
                        bool y_161870 = slt64(from_u8_arg0_161868, b_140577);
                        bool bounds_check_161871 = x_161869 && y_161870;
                        bool index_certs_161872;
                        
                        if (!bounds_check_161871) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_161868, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:429:75-82\n   #2  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_161873 = ((int8_t *) pS_mem_171275.mem)[i_171186 * b_140577 + from_u8_arg0_161868];
                        int64_t u8_res_161874 = zext_i8_i64(from_u8_arg0_161873);
                        int32_t i64_res_161875 = sext_i64_i32(i_161865);
                        int32_t shift_left_rhs_161876 = mul32(8, i64_res_161875);
                        int64_t unsign_arg0_161877 = zext_i32_i64(shift_left_rhs_161876);
                        int64_t lifted_lambda_res_161878 = shl64(u8_res_161874, unsign_arg0_161877);
                        int64_t unsign_arg0_161879 = y_161866 | lifted_lambda_res_161878;
                        int64_t y_tmp_172099 = unsign_arg0_161879;
                        
                        y_161866 = y_tmp_172099;
                    }
                    defunc_0_byteSeq_to_prim_res_161864 = y_161866;
                    ((int64_t *) mem_171281)[i_171186] = defunc_0_byteSeq_to_prim_res_161864;
                }
                if (mem_171289_cached_sizze_172149 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171289, &mem_171289_cached_sizze_172149, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171291_cached_sizze_172150 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171291, &mem_171291_cached_sizze_172150, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171293_cached_sizze_172151 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172151, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171295_cached_sizze_172152 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172152, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171297_cached_sizze_172153 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171297, &mem_171297_cached_sizze_172153, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171299_cached_sizze_172154 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171299, &mem_171299_cached_sizze_172154, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171210;
                int64_t discard_171211;
                int64_t defunc_res_170992;
                int64_t scanacc_171194;
                int64_t scanacc_171195;
                int64_t redout_171198;
                
                scanacc_171194 = (int64_t) 0;
                scanacc_171195 = (int64_t) 0;
                redout_171198 = (int64_t) 0;
                for (int64_t i_171203 = 0; i_171203 < nR_140576; i_171203++) {
                    int64_t defunc_0_byteSeq_to_prim_res_167224;
                    int64_t y_167226 = (int64_t) 0;
                    
                    for (int64_t i_167225 = 0; i_167225 < b_140577; i_167225++) {
                        int64_t zm_lhs_167227 = sub64(b_140577, i_167225);
                        int64_t from_u8_arg0_167228 = sub64(zm_lhs_167227, (int64_t) 1);
                        bool x_167229 = sle64((int64_t) 0, from_u8_arg0_167228);
                        bool y_167230 = slt64(from_u8_arg0_167228, b_140577);
                        bool bounds_check_167231 = x_167229 && y_167230;
                        bool index_certs_167232;
                        
                        if (!bounds_check_167231) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167228, "] out of bounds for array of shape [", (long long) b_140577, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:429:75-82\n   #2  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_167233 = ((int8_t *) pR_mem_171274.mem)[i_171203 * b_140577 + from_u8_arg0_167228];
                        int64_t u8_res_167234 = zext_i8_i64(from_u8_arg0_167233);
                        int32_t i64_res_167235 = sext_i64_i32(i_167225);
                        int32_t shift_left_rhs_167236 = mul32(8, i64_res_167235);
                        int64_t unsign_arg0_167237 = zext_i32_i64(shift_left_rhs_167236);
                        int64_t lifted_lambda_res_167238 = shl64(u8_res_167234, unsign_arg0_167237);
                        int64_t unsign_arg0_167239 = y_167226 | lifted_lambda_res_167238;
                        int64_t y_tmp_172109 = unsign_arg0_167239;
                        
                        y_167226 = y_tmp_172109;
                    }
                    defunc_0_byteSeq_to_prim_res_167224 = y_167226;
                    
                    int64_t lifted_lambda_res_167241 = u64_arg0_158707 & defunc_0_byteSeq_to_prim_res_167224;
                    bool x_167242 = sle64((int64_t) 0, lifted_lambda_res_167241);
                    bool y_167243 = slt64(lifted_lambda_res_167241, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580);
                    bool bounds_check_167244 = x_167242 && y_167243;
                    bool index_certs_167245;
                    
                    if (!bounds_check_167244) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_167241, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_167246 = ((int64_t *) first_info_idx_mem_171278.mem)[lifted_lambda_res_167241];
                    bool cond_167247 = slt64(spi_167246, (int64_t) 0);
                    int64_t defunc_res_167248;
                    
                    if (cond_167247) {
                        defunc_res_167248 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_167249 = ((int64_t *) last_info_idx_mem_171279.mem)[lifted_lambda_res_167241];
                        bool cond_167250 = spi_167246 == zeze_rhs_167249;
                        int64_t defunc_res_f_res_167251;
                        
                        if (cond_167250) {
                            defunc_res_f_res_167251 = spi_167246;
                        } else {
                            int64_t zs_lhs_167252 = sub64(zeze_rhs_167249, spi_167246);
                            int64_t max_arg1_167253 = sdiv64(zs_lhs_167252, (int64_t) 2);
                            int64_t max_res_167254 = smax64((int64_t) 1, max_arg1_167253);
                            bool loop_cond_167255 = slt64((int64_t) 0, max_res_167254);
                            bool bsearch_167256;
                            int64_t bsearch_167257;
                            int64_t bsearch_167258;
                            bool loop_while_167259;
                            int64_t heshi_167260;
                            int64_t step_167261;
                            
                            loop_while_167259 = loop_cond_167255;
                            heshi_167260 = spi_167246;
                            step_167261 = max_res_167254;
                            while (loop_while_167259) {
                                bool x_167262 = sle64((int64_t) 0, heshi_167260);
                                bool y_167263 = slt64(heshi_167260, dz2081U_140579);
                                bool bounds_check_167264 = x_167262 && y_167263;
                                bool index_certs_167265;
                                
                                if (!bounds_check_167264) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_167260, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_167283 = ((int64_t *) bounds_mem_171276.mem)[heshi_167260];
                                bool x_167284 = sle64((int64_t) 0, cur_S_167283);
                                bool y_167285 = slt64(cur_S_167283, nS_140578);
                                bool bounds_check_167286 = x_167284 && y_167285;
                                bool index_certs_167287;
                                
                                if (!bounds_check_167286) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_167283, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_167266 = ((int32_t *) depths_mem_171277.mem)[heshi_167260];
                                bool cond_167267 = heshi_167260 == spi_167246;
                                int32_t prev_depth_167268;
                                
                                if (cond_167267) {
                                    prev_depth_167268 = cur_depth_167266;
                                } else {
                                    int64_t tmp_167269 = sub64(heshi_167260, (int64_t) 1);
                                    bool x_167270 = sle64((int64_t) 0, tmp_167269);
                                    bool y_167271 = slt64(tmp_167269, dz2081U_140579);
                                    bool bounds_check_167272 = x_167270 && y_167271;
                                    bool index_certs_167273;
                                    
                                    if (!bounds_check_167272) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167269, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_167274 = ((int32_t *) depths_mem_171277.mem)[tmp_167269];
                                    
                                    prev_depth_167268 = prev_depth_f_res_167274;
                                }
                                
                                bool cond_167275 = heshi_167260 == zeze_rhs_167249;
                                int32_t next_depth_167276;
                                
                                if (cond_167275) {
                                    next_depth_167276 = cur_depth_167266;
                                } else {
                                    int64_t tmp_167277 = add64((int64_t) 1, heshi_167260);
                                    bool x_167278 = sle64((int64_t) 0, tmp_167277);
                                    bool y_167279 = slt64(tmp_167277, dz2081U_140579);
                                    bool bounds_check_167280 = x_167278 && y_167279;
                                    bool index_certs_167281;
                                    
                                    if (!bounds_check_167280) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167277, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_167282 = ((int32_t *) depths_mem_171277.mem)[tmp_167277];
                                    
                                    next_depth_167276 = next_depth_f_res_167282;
                                }
                                
                                int64_t cur_S_167288 = ((int64_t *) mem_171281)[cur_S_167283];
                                int64_t prev_S_167289;
                                
                                if (cond_167267) {
                                    prev_S_167289 = cur_S_167288;
                                } else {
                                    int64_t tmp_167290 = sub64(heshi_167260, (int64_t) 1);
                                    bool x_167291 = sle64((int64_t) 0, tmp_167290);
                                    bool y_167292 = slt64(tmp_167290, dz2081U_140579);
                                    bool bounds_check_167293 = x_167291 && y_167292;
                                    bool index_certs_167294;
                                    
                                    if (!bounds_check_167293) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167290, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_167295 = ((int64_t *) bounds_mem_171276.mem)[tmp_167290];
                                    bool x_167296 = sle64((int64_t) 0, tmp_167295);
                                    bool y_167297 = slt64(tmp_167295, nS_140578);
                                    bool bounds_check_167298 = x_167296 && y_167297;
                                    bool index_certs_167299;
                                    
                                    if (!bounds_check_167298) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167295, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t prev_S_f_res_167300 = ((int64_t *) mem_171281)[tmp_167295];
                                    
                                    prev_S_167289 = prev_S_f_res_167300;
                                }
                                
                                int64_t next_S_167301;
                                
                                if (cond_167275) {
                                    next_S_167301 = cur_S_167288;
                                } else {
                                    int64_t tmp_167302 = add64((int64_t) 1, heshi_167260);
                                    bool x_167303 = sle64((int64_t) 0, tmp_167302);
                                    bool y_167304 = slt64(tmp_167302, dz2081U_140579);
                                    bool bounds_check_167305 = x_167303 && y_167304;
                                    bool index_certs_167306;
                                    
                                    if (!bounds_check_167305) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167302, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_167307 = ((int64_t *) bounds_mem_171276.mem)[tmp_167302];
                                    bool x_167308 = sle64((int64_t) 0, tmp_167307);
                                    bool y_167309 = slt64(tmp_167307, nS_140578);
                                    bool bounds_check_167310 = x_167308 && y_167309;
                                    bool index_certs_167311;
                                    
                                    if (!bounds_check_167310) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167307, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:786:3-793:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t next_S_f_res_167312 = ((int64_t *) mem_171281)[tmp_167307];
                                    
                                    next_S_167301 = next_S_f_res_167312;
                                }
                                
                                int32_t prim_get_radix_arg0_167313 = mul32(radix_sizze_140581, cur_depth_167266);
                                int64_t unsign_arg0_167314 = zext_i32_i64(prim_get_radix_arg0_167313);
                                int64_t asPow_167315 = shl64((int64_t) 1, unsign_arg0_167314);
                                int64_t za_rhs_167316 = sub64(asPow_167315, (int64_t) 1);
                                int64_t lifted_lambda_res_167317 = defunc_0_byteSeq_to_prim_res_167224 & za_rhs_167316;
                                int64_t lifted_lambda_res_167318 = cur_S_167288 & za_rhs_167316;
                                bool defunc_0_eq_res_167319 = lifted_lambda_res_167317 == lifted_lambda_res_167318;
                                int64_t loopres_167320;
                                int64_t loopres_167321;
                                
                                if (defunc_0_eq_res_167319) {
                                    loopres_167320 = heshi_167260;
                                    loopres_167321 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_167322 = slt32(0, cur_depth_167266);
                                    bool is_lt_167323;
                                    bool is_lt_167324;
                                    int32_t is_lt_167325;
                                    bool loop_while_167326;
                                    bool def_lt_167327;
                                    int32_t bi_167328;
                                    
                                    loop_while_167326 = loop_cond_t_res_167322;
                                    def_lt_167327 = 0;
                                    bi_167328 = 0;
                                    while (loop_while_167326) {
                                        int32_t zt_rhs_167329 = add32(1, bi_167328);
                                        int32_t prim_get_radix_arg0_167330 = mul32(radix_sizze_140581, zt_rhs_167329);
                                        int64_t unsign_arg0_167331 = zext_i32_i64(prim_get_radix_arg0_167330);
                                        int64_t asPow_167332 = shl64((int64_t) 1, unsign_arg0_167331);
                                        int64_t za_rhs_167333 = sub64(asPow_167332, (int64_t) 1);
                                        int64_t lifted_lambda_res_167334 = defunc_0_byteSeq_to_prim_res_167224 & za_rhs_167333;
                                        int64_t lifted_lambda_res_167335 = cur_S_167288 & za_rhs_167333;
                                        bool defunc_0_lt_res_167336 = ult64(lifted_lambda_res_167334, lifted_lambda_res_167335);
                                        bool defunc_0_lt_res_167337 = ult64(lifted_lambda_res_167335, lifted_lambda_res_167334);
                                        bool cond_167338 = !defunc_0_lt_res_167337;
                                        bool cond_t_res_167339 = !defunc_0_lt_res_167336;
                                        bool x_167340 = cond_167338 && cond_t_res_167339;
                                        bool loop_cond_t_res_167341 = slt32(zt_rhs_167329, cur_depth_167266);
                                        bool x_167342 = x_167340 && loop_cond_t_res_167341;
                                        bool loop_while_tmp_172113 = x_167342;
                                        bool def_lt_tmp_172114 = defunc_0_lt_res_167336;
                                        int32_t bi_tmp_172115 = zt_rhs_167329;
                                        
                                        loop_while_167326 = loop_while_tmp_172113;
                                        def_lt_167327 = def_lt_tmp_172114;
                                        bi_167328 = bi_tmp_172115;
                                    }
                                    is_lt_167323 = loop_while_167326;
                                    is_lt_167324 = def_lt_167327;
                                    is_lt_167325 = bi_167328;
                                    
                                    int64_t loopres_f_res_167343;
                                    int64_t loopres_f_res_167344;
                                    
                                    if (is_lt_167324) {
                                        bool loop_cond_t_res_170917 = slt32(0, prev_depth_167268);
                                        bool is_gt_170918;
                                        bool is_gt_170919;
                                        int32_t is_gt_170920;
                                        bool loop_while_170921;
                                        bool def_gt_170922;
                                        int32_t bi_170923;
                                        
                                        loop_while_170921 = loop_cond_t_res_170917;
                                        def_gt_170922 = 0;
                                        bi_170923 = 0;
                                        while (loop_while_170921) {
                                            int32_t zt_rhs_170924 = add32(1, bi_170923);
                                            int32_t prim_get_radix_arg0_170925 = mul32(radix_sizze_140581, zt_rhs_170924);
                                            int64_t unsign_arg0_170926 = zext_i32_i64(prim_get_radix_arg0_170925);
                                            int64_t asPow_170927 = shl64((int64_t) 1, unsign_arg0_170926);
                                            int64_t za_rhs_170928 = sub64(asPow_170927, (int64_t) 1);
                                            int64_t lifted_lambda_res_170929 = defunc_0_byteSeq_to_prim_res_167224 & za_rhs_170928;
                                            int64_t lifted_lambda_res_170930 = prev_S_167289 & za_rhs_170928;
                                            bool defunc_0_gt_res_170931 = ult64(lifted_lambda_res_170930, lifted_lambda_res_170929);
                                            bool defunc_0_gt_res_170932 = ult64(lifted_lambda_res_170929, lifted_lambda_res_170930);
                                            bool cond_170933 = !defunc_0_gt_res_170931;
                                            bool cond_t_res_170934 = !defunc_0_gt_res_170932;
                                            bool x_170935 = cond_170933 && cond_t_res_170934;
                                            bool loop_cond_t_res_170936 = slt32(zt_rhs_170924, prev_depth_167268);
                                            bool x_170937 = x_170935 && loop_cond_t_res_170936;
                                            bool loop_while_tmp_172116 = x_170937;
                                            bool def_gt_tmp_172117 = defunc_0_gt_res_170931;
                                            int32_t bi_tmp_172118 = zt_rhs_170924;
                                            
                                            loop_while_170921 = loop_while_tmp_172116;
                                            def_gt_170922 = def_gt_tmp_172117;
                                            bi_170923 = bi_tmp_172118;
                                        }
                                        is_gt_170918 = loop_while_170921;
                                        is_gt_170919 = def_gt_170922;
                                        is_gt_170920 = bi_170923;
                                        
                                        bool x_170938 = !cond_167267;
                                        bool y_170939 = is_gt_170919 && x_170938;
                                        bool cond_170940 = cond_167267 || y_170939;
                                        int64_t loopres_f_res_t_res_170941;
                                        int64_t loopres_f_res_t_res_170942;
                                        
                                        if (cond_170940) {
                                            loopres_f_res_t_res_170941 = (int64_t) -1;
                                            loopres_f_res_t_res_170942 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_170943 = sub64(heshi_167260, step_167261);
                                            int64_t max_arg1_170944 = sdiv64(step_167261, (int64_t) 2);
                                            int64_t max_res_170945 = smax64((int64_t) 1, max_arg1_170944);
                                            
                                            loopres_f_res_t_res_170941 = tmp_170943;
                                            loopres_f_res_t_res_170942 = max_res_170945;
                                        }
                                        loopres_f_res_167343 = loopres_f_res_t_res_170941;
                                        loopres_f_res_167344 = loopres_f_res_t_res_170942;
                                    } else {
                                        bool loop_cond_t_res_167374 = slt32(0, next_depth_167276);
                                        bool is_lt_167375;
                                        bool is_lt_167376;
                                        int32_t is_lt_167377;
                                        bool loop_while_167378;
                                        bool def_lt_167379;
                                        int32_t bi_167380;
                                        
                                        loop_while_167378 = loop_cond_t_res_167374;
                                        def_lt_167379 = 0;
                                        bi_167380 = 0;
                                        while (loop_while_167378) {
                                            int32_t zt_rhs_167381 = add32(1, bi_167380);
                                            int32_t prim_get_radix_arg0_167382 = mul32(radix_sizze_140581, zt_rhs_167381);
                                            int64_t unsign_arg0_167383 = zext_i32_i64(prim_get_radix_arg0_167382);
                                            int64_t asPow_167384 = shl64((int64_t) 1, unsign_arg0_167383);
                                            int64_t za_rhs_167385 = sub64(asPow_167384, (int64_t) 1);
                                            int64_t lifted_lambda_res_167386 = defunc_0_byteSeq_to_prim_res_167224 & za_rhs_167385;
                                            int64_t lifted_lambda_res_167387 = next_S_167301 & za_rhs_167385;
                                            bool defunc_0_lt_res_167388 = ult64(lifted_lambda_res_167386, lifted_lambda_res_167387);
                                            bool defunc_0_lt_res_167389 = ult64(lifted_lambda_res_167387, lifted_lambda_res_167386);
                                            bool cond_167390 = !defunc_0_lt_res_167389;
                                            bool cond_t_res_167391 = !defunc_0_lt_res_167388;
                                            bool x_167392 = cond_167390 && cond_t_res_167391;
                                            bool loop_cond_t_res_167393 = slt32(zt_rhs_167381, next_depth_167276);
                                            bool x_167394 = x_167392 && loop_cond_t_res_167393;
                                            bool loop_while_tmp_172119 = x_167394;
                                            bool def_lt_tmp_172120 = defunc_0_lt_res_167388;
                                            int32_t bi_tmp_172121 = zt_rhs_167381;
                                            
                                            loop_while_167378 = loop_while_tmp_172119;
                                            def_lt_167379 = def_lt_tmp_172120;
                                            bi_167380 = bi_tmp_172121;
                                        }
                                        is_lt_167375 = loop_while_167378;
                                        is_lt_167376 = def_lt_167379;
                                        is_lt_167377 = bi_167380;
                                        
                                        bool x_167395 = !cond_167275;
                                        bool y_167396 = is_lt_167376 && x_167395;
                                        bool cond_167397 = cond_167275 || y_167396;
                                        int64_t loopres_f_res_f_res_167398;
                                        int64_t loopres_f_res_f_res_167399;
                                        
                                        if (cond_167397) {
                                            loopres_f_res_f_res_167398 = (int64_t) -1;
                                            loopres_f_res_f_res_167399 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_167400 = add64(heshi_167260, step_167261);
                                            int64_t max_arg1_167401 = sdiv64(step_167261, (int64_t) 2);
                                            int64_t max_res_167402 = smax64((int64_t) 1, max_arg1_167401);
                                            
                                            loopres_f_res_f_res_167398 = tmp_167400;
                                            loopres_f_res_f_res_167399 = max_res_167402;
                                        }
                                        loopres_f_res_167343 = loopres_f_res_f_res_167398;
                                        loopres_f_res_167344 = loopres_f_res_f_res_167399;
                                    }
                                    loopres_167320 = loopres_f_res_167343;
                                    loopres_167321 = loopres_f_res_167344;
                                }
                                
                                bool loop_cond_167403 = slt64((int64_t) 0, loopres_167321);
                                bool loop_while_tmp_172110 = loop_cond_167403;
                                int64_t heshi_tmp_172111 = loopres_167320;
                                int64_t step_tmp_172112 = loopres_167321;
                                
                                loop_while_167259 = loop_while_tmp_172110;
                                heshi_167260 = heshi_tmp_172111;
                                step_167261 = step_tmp_172112;
                            }
                            bsearch_167256 = loop_while_167259;
                            bsearch_167257 = heshi_167260;
                            bsearch_167258 = step_167261;
                            defunc_res_f_res_167251 = bsearch_167257;
                        }
                        defunc_res_167248 = defunc_res_f_res_167251;
                    }
                    
                    bool cond_167404 = sle64(defunc_res_167248, (int64_t) 0);
                    int64_t inf_167405;
                    
                    if (cond_167404) {
                        inf_167405 = (int64_t) 0;
                    } else {
                        bool x_167406 = sle64((int64_t) 0, defunc_res_167248);
                        bool y_167407 = slt64(defunc_res_167248, dz2081U_140579);
                        bool bounds_check_167408 = x_167406 && y_167407;
                        bool index_certs_167409;
                        
                        if (!bounds_check_167408) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167248, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:794:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-856:44\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_167410 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_167248];
                        
                        inf_167405 = inf_f_res_167410;
                    }
                    
                    bool cond_167411 = defunc_res_167248 == zeze_rhs_158708;
                    int64_t sup_167412;
                    
                    if (cond_167411) {
                        sup_167412 = nS_140578;
                    } else {
                        int64_t tmp_167413 = add64((int64_t) 1, defunc_res_167248);
                        bool x_167414 = sle64((int64_t) 0, tmp_167413);
                        bool y_167415 = slt64(tmp_167413, dz2081U_140579);
                        bool bounds_check_167416 = x_167414 && y_167415;
                        bool index_certs_167417;
                        
                        if (!bounds_check_167416) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167413, "] out of bounds for array of shape [", (long long) dz2081U_140579, "].", "-> #0  ftHashJoin.fut:795:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-856:44\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_167418 = ((int64_t *) bounds_mem_171276.mem)[tmp_167413];
                        
                        sup_167412 = sup_f_res_167418;
                    }
                    
                    bool loop_cond_167419 = slt64(inf_167405, sup_167412);
                    bool lifted_lambda_res_167420;
                    int64_t lifted_lambda_res_167421;
                    int64_t lifted_lambda_res_167422;
                    int64_t lifted_lambda_res_167423;
                    bool loop_while_167424;
                    int64_t j_167425;
                    int64_t duome_167426;
                    int64_t i_167427;
                    
                    loop_while_167424 = loop_cond_167419;
                    j_167425 = inf_167405;
                    duome_167426 = (int64_t) 0;
                    i_167427 = inf_167405;
                    while (loop_while_167424) {
                        bool x_167428 = sle64((int64_t) 0, i_167427);
                        bool y_167429 = slt64(i_167427, nS_140578);
                        bool bounds_check_167430 = x_167428 && y_167429;
                        bool index_certs_167431;
                        
                        if (!bounds_check_167430) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_167427, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:798:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-856:44\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t zeze_rhs_167432 = ((int64_t *) mem_171281)[i_167427];
                        bool is_eq_167433 = defunc_0_byteSeq_to_prim_res_167224 == zeze_rhs_167432;
                        bool cond_167434 = slt64((int64_t) 0, duome_167426);
                        bool cond_167435 = is_eq_167433 || cond_167434;
                        int64_t next_j_167436;
                        
                        if (cond_167435) {
                            next_j_167436 = j_167425;
                        } else {
                            int64_t next_j_f_res_167437 = add64((int64_t) 1, j_167425);
                            
                            next_j_167436 = next_j_f_res_167437;
                        }
                        
                        int64_t next_duome_167438;
                        
                        if (is_eq_167433) {
                            int64_t next_duome_t_res_170946 = add64((int64_t) 1, duome_167426);
                            
                            next_duome_167438 = next_duome_t_res_170946;
                        } else {
                            next_duome_167438 = duome_167426;
                        }
                        
                        int64_t tmp_167440 = add64((int64_t) 1, i_167427);
                        bool loop_cond_167441 = slt64(tmp_167440, sup_167412);
                        bool loop_while_tmp_172122 = loop_cond_167441;
                        int64_t j_tmp_172123 = next_j_167436;
                        int64_t duome_tmp_172124 = next_duome_167438;
                        int64_t i_tmp_172125 = tmp_167440;
                        
                        loop_while_167424 = loop_while_tmp_172122;
                        j_167425 = j_tmp_172123;
                        duome_167426 = duome_tmp_172124;
                        i_167427 = i_tmp_172125;
                    }
                    lifted_lambda_res_167420 = loop_while_167424;
                    lifted_lambda_res_167421 = j_167425;
                    lifted_lambda_res_167422 = duome_167426;
                    lifted_lambda_res_167423 = i_167427;
                    
                    bool cond_167442 = slt64(lifted_lambda_res_167421, sup_167412);
                    int64_t lifted_lambda_res_167443;
                    
                    if (cond_167442) {
                        lifted_lambda_res_167443 = lifted_lambda_res_167422;
                    } else {
                        lifted_lambda_res_167443 = (int64_t) 0;
                    }
                    
                    int64_t lifted_lambda_res_167444;
                    
                    if (cond_167442) {
                        lifted_lambda_res_167444 = lifted_lambda_res_167421;
                    } else {
                        lifted_lambda_res_167444 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_167447 = slt64((int64_t) 1, lifted_lambda_res_167443);
                    int64_t defunc_0_f_res_167448 = btoi_bool_i64(lifted_lambda_res_167447);
                    int64_t defunc_0_op_res_160058 = add64(defunc_0_f_res_167448, scanacc_171194);
                    int64_t defunc_0_op_res_160028 = add64(lifted_lambda_res_167443, scanacc_171195);
                    int64_t zp_res_160049 = add64(lifted_lambda_res_167443, redout_171198);
                    
                    ((int64_t *) mem_171289)[i_171203] = defunc_0_op_res_160058;
                    ((int64_t *) mem_171291)[i_171203] = defunc_0_op_res_160028;
                    ((int64_t *) mem_171293)[i_171203] = defunc_0_f_res_167448;
                    ((int64_t *) mem_171295)[i_171203] = lifted_lambda_res_167444;
                    ((int64_t *) mem_171297)[i_171203] = lifted_lambda_res_167443;
                    ((int64_t *) mem_171299)[i_171203] = defunc_0_byteSeq_to_prim_res_167224;
                    
                    int64_t scanacc_tmp_172100 = defunc_0_op_res_160058;
                    int64_t scanacc_tmp_172101 = defunc_0_op_res_160028;
                    int64_t redout_tmp_172104 = zp_res_160049;
                    
                    scanacc_171194 = scanacc_tmp_172100;
                    scanacc_171195 = scanacc_tmp_172101;
                    redout_171198 = redout_tmp_172104;
                }
                discard_171210 = scanacc_171194;
                discard_171211 = scanacc_171195;
                defunc_res_170992 = redout_171198;
                
                int64_t m_f_res_160059;
                
                if (x_158710) {
                    int64_t x_170947 = ((int64_t *) mem_171289)[tmp_158711];
                    
                    m_f_res_160059 = x_170947;
                } else {
                    m_f_res_160059 = (int64_t) 0;
                }
                
                int64_t m_160061;
                
                if (cond_158709) {
                    m_160061 = (int64_t) 0;
                } else {
                    m_160061 = m_f_res_160059;
                }
                
                bool cond_160084 = slt64((int64_t) 0, m_160061);
                int64_t m_160071 = sub64(m_160061, (int64_t) 1);
                bool i_p_m_t_s_leq_w_160073 = slt64(m_160071, nR_140576);
                bool zzero_leq_i_p_m_t_s_160072 = sle64((int64_t) 0, m_160071);
                bool y_160075 = zzero_leq_i_p_m_t_s_160072 && i_p_m_t_s_leq_w_160073;
                bool i_lte_j_160074 = sle64((int64_t) 0, m_160061);
                bool forwards_ok_160076 = i_lte_j_160074 && y_160075;
                bool eq_x_zz_160068 = (int64_t) 0 == m_f_res_160059;
                bool p_and_eq_x_y_160069 = x_158710 && eq_x_zz_160068;
                bool empty_slice_160070 = cond_158709 || p_and_eq_x_y_160069;
                bool ok_or_empty_160077 = empty_slice_160070 || forwards_ok_160076;
                bool index_certs_160078;
                
                if (!ok_or_empty_160077) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_160061, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:4-856:44\n   #3  ftRelational.fut:258:6-261:37\n   #4  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_171344 = (int64_t) 8 * m_160061;
                
                if (mem_171345_cached_sizze_172156 < bytes_171344) {
                    err = lexical_realloc(ctx, &mem_171345, &mem_171345_cached_sizze_172156, bytes_171344);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171345, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171297, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_160061});
                
                int64_t max_mult_160085;
                
                if (cond_160084) {
                    if (mem_171347_cached_sizze_172157 < bytes_171288) {
                        err = lexical_realloc(ctx, &mem_171347, &mem_171347_cached_sizze_172157, bytes_171288);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171218 = 0; i_171218 < nR_140576; i_171218++) {
                        int64_t eta_p_170953 = ((int64_t *) mem_171293)[i_171218];
                        int64_t eta_p_170954 = ((int64_t *) mem_171289)[i_171218];
                        bool cond_170955 = eta_p_170953 == (int64_t) 1;
                        int64_t lifted_lambda_res_170956;
                        
                        if (cond_170955) {
                            int64_t lifted_lambda_res_t_res_170957 = sub64(eta_p_170954, (int64_t) 1);
                            
                            lifted_lambda_res_170956 = lifted_lambda_res_t_res_170957;
                        } else {
                            lifted_lambda_res_170956 = (int64_t) -1;
                        }
                        ((int64_t *) mem_171347)[i_171218] = lifted_lambda_res_170956;
                    }
                    for (int64_t write_iter_171220 = 0; write_iter_171220 < nR_140576; write_iter_171220++) {
                        int64_t write_iv_171222 = ((int64_t *) mem_171347)[write_iter_171220];
                        int64_t write_iv_171223 = ((int64_t *) mem_171297)[write_iter_171220];
                        
                        if (sle64((int64_t) 0, write_iv_171222) && slt64(write_iv_171222, m_160061)) {
                            ((int64_t *) mem_171345)[write_iv_171222] = write_iv_171223;
                        }
                    }
                    
                    int64_t defunc_0_reduce_res_170973;
                    int64_t redout_171225 = (int64_t) -9223372036854775808;
                    
                    for (int64_t i_171226 = 0; i_171226 < m_160061; i_171226++) {
                        int64_t x_170974 = ((int64_t *) mem_171345)[i_171226];
                        int64_t max_res_170977 = smax64(x_170974, redout_171225);
                        int64_t redout_tmp_172128 = max_res_170977;
                        
                        redout_171225 = redout_tmp_172128;
                    }
                    defunc_0_reduce_res_170973 = redout_171225;
                    max_mult_160085 = defunc_0_reduce_res_170973;
                } else {
                    max_mult_160085 = (int64_t) 1;
                }
                
                int64_t bytes_171360 = (int64_t) 8 * defunc_res_170992;
                bool bounds_invalid_upwards_160096 = slt64(max_mult_160085, (int64_t) 1);
                bool valid_160098 = !bounds_invalid_upwards_160096;
                bool range_valid_c_160099;
                
                if (!valid_160098) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_160085, " is invalid.", "-> #0  ftHashJoin.fut:821:18-30\n   #1  ftHashJoin.fut:850:4-856:44\n   #2  ftRelational.fut:258:6-261:37\n   #3  ftRelational.fut:254:3-261:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_171398 = b_140577 * defunc_res_170992;
                
                if (mem_171337_cached_sizze_172155 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171337, &mem_171337_cached_sizze_172155, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171214 = 0; i_171214 < nR_140576; i_171214++) {
                    int64_t eta_p_166561 = ((int64_t *) mem_171297)[i_171214];
                    int64_t zv_lhs_166563 = add64((int64_t) -1, i_171214);
                    int64_t tmp_166564 = smod64(zv_lhs_166563, nR_140576);
                    int64_t lifted_lambda_res_166565 = ((int64_t *) mem_171291)[tmp_166564];
                    bool cond_166567 = i_171214 == (int64_t) 0;
                    int64_t lifted_lambda_res_166568;
                    
                    if (cond_166567) {
                        lifted_lambda_res_166568 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_166568 = lifted_lambda_res_166565;
                    }
                    
                    bool cond_166570 = slt64((int64_t) 0, eta_p_166561);
                    int64_t lifted_lambda_res_166571;
                    
                    if (cond_166570) {
                        lifted_lambda_res_166571 = lifted_lambda_res_166568;
                    } else {
                        lifted_lambda_res_166571 = (int64_t) -1;
                    }
                    ((int64_t *) mem_171337)[i_171214] = lifted_lambda_res_166571;
                }
                if (memblock_alloc(ctx, &mem_171361, bytes_171360, "mem_171361")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172130 = 0; nest_i_172130 < defunc_res_170992; nest_i_172130++) {
                    ((int64_t *) mem_171361.mem)[nest_i_172130] = (int64_t) 0;
                }
                for (int64_t write_iter_171227 = 0; write_iter_171227 < nR_140576; write_iter_171227++) {
                    int64_t write_iv_171229 = ((int64_t *) mem_171337)[write_iter_171227];
                    
                    if (sle64((int64_t) 0, write_iv_171229) && slt64(write_iv_171229, defunc_res_170992)) {
                        ((int64_t *) mem_171361.mem)[write_iv_171229] = write_iter_171227;
                    }
                }
                if (memblock_alloc(ctx, &mem_171369, bytes_171360, "mem_171369")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172132 = 0; nest_i_172132 < defunc_res_170992; nest_i_172132++) {
                    ((int64_t *) mem_171369.mem)[nest_i_172132] = (int64_t) 1;
                }
                
                int64_t distance_160097 = sub64(max_mult_160085, (int64_t) 1);
                
                if (memblock_set(ctx, &mem_param_171372, &mem_171369, "mem_171369") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171375, &mem_171361, "mem_171361") != 0)
                    return 1;
                for (int64_t i_160102 = 0; i_160102 < distance_160097; i_160102++) {
                    int64_t index_primexp_160105 = add64((int64_t) 1, i_160102);
                    
                    if (memblock_alloc(ctx, &mem_171377, bytes_171360, "mem_171377")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171377.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171375.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170992});
                    if (memblock_alloc(ctx, &mem_171379, bytes_171360, "mem_171379")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171379.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171372.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170992});
                    
                    int64_t replicate_arg1_160117 = add64((int64_t) 2, i_160102);
                    
                    for (int64_t write_iter_171232 = 0; write_iter_171232 < nR_140576; write_iter_171232++) {
                        int64_t zlze_lhs_167558 = ((int64_t *) mem_171297)[write_iter_171232];
                        bool cond_167559 = sle64(zlze_lhs_167558, index_primexp_160105);
                        int64_t lifted_lambda_res_167560;
                        
                        if (cond_167559) {
                            lifted_lambda_res_167560 = (int64_t) -1;
                        } else {
                            int64_t zp_lhs_167561 = ((int64_t *) mem_171337)[write_iter_171232];
                            int64_t lifted_lambda_res_f_res_167562 = add64(index_primexp_160105, zp_lhs_167561);
                            
                            lifted_lambda_res_167560 = lifted_lambda_res_f_res_167562;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_167560) && slt64(lifted_lambda_res_167560, defunc_res_170992)) {
                            ((int64_t *) mem_171379.mem)[lifted_lambda_res_167560] = replicate_arg1_160117;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_167560) && slt64(lifted_lambda_res_167560, defunc_res_170992)) {
                            ((int64_t *) mem_171377.mem)[lifted_lambda_res_167560] = write_iter_171232;
                        }
                    }
                    if (memblock_set(ctx, &mem_param_tmp_172133, &mem_171379, "mem_171379") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_172134, &mem_171377, "mem_171377") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_171372, &mem_param_tmp_172133, "mem_param_tmp_172133") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_171375, &mem_param_tmp_172134, "mem_param_tmp_172134") != 0)
                        return 1;
                }
                if (memblock_set(ctx, &ext_mem_171397, &mem_param_171372, "mem_param_171372") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171396, &mem_param_171375, "mem_param_171375") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_171361, "mem_171361") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_171369, "mem_171369") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_171399, bytes_171398, "mem_171399")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc(ctx, &mem_171401, bytes_171360, "mem_171401")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171242 = 0; i_171242 < defunc_res_170992; i_171242++) {
                    int64_t eta_p_167458 = ((int64_t *) ext_mem_171396.mem)[i_171242];
                    bool x_167460 = sle64((int64_t) 0, eta_p_167458);
                    bool y_167461 = slt64(eta_p_167458, nR_140576);
                    bool bounds_check_167462 = x_167460 && y_167461;
                    bool index_certs_167463;
                    
                    if (!bounds_check_167462) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_167458, "] out of bounds for array of shape [", (long long) nR_140576, "].", "-> #0  ftHashJoin.fut:831:16-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:830:8-838:6\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t eta_p_167457 = ((int64_t *) ext_mem_171397.mem)[i_171242];
                    int64_t rv_167464 = ((int64_t *) mem_171299)[eta_p_167458];
                    int64_t inf_s_idx_167465 = ((int64_t *) mem_171295)[eta_p_167458];
                    int64_t tmp_167466 = sub64(inf_s_idx_167465, (int64_t) 1);
                    bool loop_cond_167467 = slt64((int64_t) 0, eta_p_167457);
                    bool kth_match_167468;
                    int64_t kth_match_167469;
                    int64_t kth_match_167470;
                    bool loop_while_167471;
                    int64_t j_167472;
                    int64_t m_167473;
                    
                    loop_while_167471 = loop_cond_167467;
                    j_167472 = tmp_167466;
                    m_167473 = (int64_t) 0;
                    while (loop_while_167471) {
                        int64_t zeze_rhs_167474 = add64((int64_t) 1, j_167472);
                        bool x_167475 = sle64((int64_t) 0, zeze_rhs_167474);
                        bool y_167476 = slt64(zeze_rhs_167474, nS_140578);
                        bool bounds_check_167477 = x_167475 && y_167476;
                        bool index_certs_167478;
                        
                        if (!bounds_check_167477) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_167474, "] out of bounds for array of shape [", (long long) nS_140578, "].", "-> #0  ftHashJoin.fut:835:29-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:830:8-838:6\n   #3  ftHashJoin.fut:850:4-856:44\n   #4  ftRelational.fut:258:6-261:37\n   #5  ftRelational.fut:254:3-261:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t zeze_rhs_167479 = ((int64_t *) mem_171281)[zeze_rhs_167474];
                        bool is_eq_167480 = rv_167464 == zeze_rhs_167479;
                        int64_t loopres_167481;
                        
                        if (is_eq_167480) {
                            int64_t tmp_170988 = add64((int64_t) 1, m_167473);
                            
                            loopres_167481 = tmp_170988;
                        } else {
                            loopres_167481 = m_167473;
                        }
                        
                        bool loop_cond_167483 = slt64(loopres_167481, eta_p_167457);
                        bool loop_while_tmp_172141 = loop_cond_167483;
                        int64_t j_tmp_172142 = zeze_rhs_167474;
                        int64_t m_tmp_172143 = loopres_167481;
                        
                        loop_while_167471 = loop_while_tmp_172141;
                        j_167472 = j_tmp_172142;
                        m_167473 = m_tmp_172143;
                    }
                    kth_match_167468 = loop_while_167471;
                    kth_match_167469 = j_167472;
                    kth_match_167470 = m_167473;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171399.mem, i_171242 * b_140577, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171274.mem, eta_p_167458 * b_140577, (int64_t []) {(int64_t) 1}, (int64_t []) {b_140577});
                    ((int64_t *) mem_171401.mem)[i_171242] = kth_match_167469;
                }
                if (memblock_unref(ctx, &ext_mem_171397, "ext_mem_171397") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_171417, bytes_171360, "mem_171417")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171417.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171396.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170992});
                if (memblock_unref(ctx, &ext_mem_171396, "ext_mem_171396") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171563, &mem_171417, "mem_171417") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171562, &mem_171401, "mem_171401") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171559, &mem_171399, "mem_171399") != 0)
                    return 1;
                radix_hash_join_res_f_res_f_res_159454 = defunc_res_170992;
            }
            if (memblock_set(ctx, &ext_mem_171709, &ext_mem_171563, "ext_mem_171563") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171708, &ext_mem_171562, "ext_mem_171562") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171705, &ext_mem_171559, "ext_mem_171559") != 0)
                return 1;
            radix_hash_join_res_f_res_159095 = radix_hash_join_res_f_res_f_res_159454;
            radix_hash_join_res_f_res_159096 = radix_hash_join_res_f_res_f_res_159454;
            radix_hash_join_res_f_res_159097 = radix_hash_join_res_f_res_f_res_159454;
        }
        if (memblock_set(ctx, &ext_mem_171853, &ext_mem_171709, "ext_mem_171709") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171852, &ext_mem_171708, "ext_mem_171708") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171849, &ext_mem_171705, "ext_mem_171705") != 0)
            return 1;
        radix_hash_join_res_158736 = radix_hash_join_res_f_res_159095;
        radix_hash_join_res_158737 = radix_hash_join_res_f_res_159096;
        radix_hash_join_res_158738 = radix_hash_join_res_f_res_159097;
    }
    
    bool dim_match_160159 = radix_hash_join_res_158736 == radix_hash_join_res_158737;
    bool empty_or_match_cert_160160;
    
    if (!dim_match_160159) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:846:1-856:52\n   #1  ftRelational.fut:258:6-261:37\n   #2  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_160162 = radix_hash_join_res_158736 == radix_hash_join_res_158738;
    bool empty_or_match_cert_160163;
    
    if (!dim_match_160162) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:846:1-856:52\n   #1  ftRelational.fut:258:6-261:37\n   #2  ftRelational.fut:254:3-261:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171853, "ext_mem_171853") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171852, "ext_mem_171852") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &ext_mem_171849, "ext_mem_171849") != 0)
        return 1;
    prim_out_171959 = radix_hash_join_res_158736;
    if (memblock_set(ctx, &*mem_out_p_172144, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172145, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172146, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172147 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171281);
        free(mem_171289);
        free(mem_171291);
        free(mem_171293);
        free(mem_171295);
        free(mem_171297);
        free(mem_171299);
        free(mem_171337);
        free(mem_171345);
        free(mem_171347);
        free(mem_171419);
        free(mem_171427);
        free(mem_171429);
        free(mem_171431);
        free(mem_171433);
        free(mem_171435);
        free(mem_171437);
        free(mem_171475);
        free(mem_171483);
        free(mem_171485);
        free(mem_171565);
        free(mem_171573);
        free(mem_171575);
        free(mem_171577);
        free(mem_171579);
        free(mem_171581);
        free(mem_171583);
        free(mem_171621);
        free(mem_171629);
        free(mem_171631);
        free(mem_171710);
        free(mem_171718);
        free(mem_171720);
        free(mem_171722);
        free(mem_171724);
        free(mem_171726);
        free(mem_171727);
        free(mem_171765);
        free(mem_171773);
        free(mem_171775);
        if (memblock_unref(ctx, &mem_171417, "mem_171417") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171401, "mem_171401") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171399, "mem_171399") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172134, "mem_param_tmp_172134") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172133, "mem_param_tmp_172133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171379, "mem_171379") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171377, "mem_171377") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171375, "mem_param_171375") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171372, "mem_param_171372") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171396, "ext_mem_171396") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171397, "ext_mem_171397") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171369, "mem_171369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171361, "mem_171361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171555, "mem_171555") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171539, "mem_171539") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171537, "mem_171537") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172088, "mem_param_tmp_172088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172087, "mem_param_tmp_172087") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171517, "mem_171517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171515, "mem_171515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171513, "mem_param_171513") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171510, "mem_param_171510") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171534, "ext_mem_171534") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171535, "ext_mem_171535") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171507, "mem_171507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171499, "mem_171499") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171559, "ext_mem_171559") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171562, "ext_mem_171562") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171563, "ext_mem_171563") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171701, "mem_171701") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171685, "mem_171685") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171683, "mem_171683") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172042, "mem_param_tmp_172042") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172041, "mem_param_tmp_172041") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171663, "mem_171663") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171661, "mem_171661") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171659, "mem_param_171659") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171656, "mem_param_171656") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171680, "ext_mem_171680") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171681, "ext_mem_171681") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171653, "mem_171653") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171645, "mem_171645") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171705, "ext_mem_171705") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171708, "ext_mem_171708") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171709, "ext_mem_171709") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171827, "mem_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171996, "mem_param_tmp_171996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171995, "mem_param_tmp_171995") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171807, "mem_171807") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171805, "mem_171805") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171803, "mem_param_171803") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171800, "mem_param_171800") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171824, "ext_mem_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171825, "ext_mem_171825") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171797, "mem_171797") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171789, "mem_171789") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171852, "ext_mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171853, "ext_mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct memblock *mem_out_p_172188, struct memblock *mem_out_p_172189, struct memblock *mem_out_p_172190, int64_t *out_prim_out_172191, struct memblock pR_mem_171274, struct memblock pS_mem_171275, struct memblock bounds_mem_171276, struct memblock depths_mem_171277, struct memblock first_info_idx_mem_171278, struct memblock last_info_idx_mem_171279, int64_t nR_143049, int64_t b_143050, int64_t nS_143051, int64_t dz2081U_143052, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, int32_t radix_sizze_143054, int32_t maxDepth_143059)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171281_cached_sizze_172192 = 0;
    unsigned char *mem_171281 = NULL;
    int64_t mem_171289_cached_sizze_172193 = 0;
    unsigned char *mem_171289 = NULL;
    int64_t mem_171291_cached_sizze_172194 = 0;
    unsigned char *mem_171291 = NULL;
    int64_t mem_171335_cached_sizze_172195 = 0;
    unsigned char *mem_171335 = NULL;
    int64_t mem_171343_cached_sizze_172196 = 0;
    unsigned char *mem_171343 = NULL;
    int64_t mem_171345_cached_sizze_172197 = 0;
    unsigned char *mem_171345 = NULL;
    int64_t mem_171399_cached_sizze_172198 = 0;
    unsigned char *mem_171399 = NULL;
    int64_t mem_171407_cached_sizze_172199 = 0;
    unsigned char *mem_171407 = NULL;
    int64_t mem_171409_cached_sizze_172200 = 0;
    unsigned char *mem_171409 = NULL;
    int64_t mem_171462_cached_sizze_172201 = 0;
    unsigned char *mem_171462 = NULL;
    int64_t mem_171470_cached_sizze_172202 = 0;
    unsigned char *mem_171470 = NULL;
    int64_t mem_171472_cached_sizze_172203 = 0;
    unsigned char *mem_171472 = NULL;
    struct memblock ext_mem_171329;
    
    ext_mem_171329.references = NULL;
    
    struct memblock mem_171322;
    
    mem_171322.references = NULL;
    
    struct memblock mem_171320;
    
    mem_171320.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_171305;
    
    mem_171305.references = NULL;
    
    struct memblock ext_mem_171383;
    
    ext_mem_171383.references = NULL;
    
    struct memblock mem_171376;
    
    mem_171376.references = NULL;
    
    struct memblock mem_171374;
    
    mem_171374.references = NULL;
    
    struct memblock mem_171361;
    
    mem_171361.references = NULL;
    
    struct memblock mem_171359;
    
    mem_171359.references = NULL;
    
    struct memblock ext_mem_171391;
    
    ext_mem_171391.references = NULL;
    
    struct memblock ext_mem_171394;
    
    ext_mem_171394.references = NULL;
    
    struct memblock ext_mem_171397;
    
    ext_mem_171397.references = NULL;
    
    struct memblock ext_mem_171447;
    
    ext_mem_171447.references = NULL;
    
    struct memblock mem_171440;
    
    mem_171440.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock mem_171425;
    
    mem_171425.references = NULL;
    
    struct memblock mem_171423;
    
    mem_171423.references = NULL;
    
    struct memblock ext_mem_171455;
    
    ext_mem_171455.references = NULL;
    
    struct memblock ext_mem_171458;
    
    ext_mem_171458.references = NULL;
    
    struct memblock ext_mem_171461;
    
    ext_mem_171461.references = NULL;
    
    struct memblock ext_mem_171510;
    
    ext_mem_171510.references = NULL;
    
    struct memblock mem_171503;
    
    mem_171503.references = NULL;
    
    struct memblock mem_171501;
    
    mem_171501.references = NULL;
    
    struct memblock mem_171488;
    
    mem_171488.references = NULL;
    
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock ext_mem_171518;
    
    ext_mem_171518.references = NULL;
    
    struct memblock ext_mem_171521;
    
    ext_mem_171521.references = NULL;
    
    struct memblock ext_mem_171524;
    
    ext_mem_171524.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t i32_res_158696 = sext_i32_i64(radix_sizze_143054);
    bool nonnegative_158697 = sle64((int64_t) 0, i32_res_158696);
    bool nonzzero_cert_158698;
    
    if (!nonnegative_158697) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:8:47-268:55\n   #1  ftRelational.fut:263:3-270:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_158699 = shl64((int64_t) 1, i32_res_158696);
    bool assert_cond_158700 = arg_158699 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053;
    bool assert_c_158701;
    
    if (!assert_cond_158700) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftRelational.fut:268:6-270:39\n   #1  ftRelational.fut:263:3-270:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_158702 = b_143050 == (int64_t) 1;
    bool cond_158703 = b_143050 == (int64_t) 2;
    bool cond_158704 = sle64(b_143050, (int64_t) 4);
    int64_t unsign_arg0_158705 = zext_i32_i64(radix_sizze_143054);
    int64_t asPow_158706 = shl64((int64_t) 1, unsign_arg0_158705);
    int64_t u64_arg0_158707 = sub64(asPow_158706, (int64_t) 1);
    int64_t zeze_rhs_158708 = sub64(dz2081U_143052, (int64_t) 1);
    int32_t u64_res_158709 = zext_i64_i32(asPow_158706);
    int32_t za_rhs_158710 = sub32(u64_res_158709, 1);
    int16_t u64_res_158711 = zext_i64_i16(u64_arg0_158707);
    int8_t u64_res_158712 = zext_i64_i8(u64_arg0_158707);
    int64_t bytes_171280 = (int64_t) 8 * nS_143051;
    int64_t bytes_171288 = (int64_t) 8 * nR_143049;
    int64_t bytes_171334 = (int64_t) 4 * nS_143051;
    int64_t bytes_171398 = (int64_t) 2 * nS_143051;
    int64_t radix_hash_join_with_S_keys_unique_res_158713;
    int64_t radix_hash_join_with_S_keys_unique_res_158714;
    int64_t radix_hash_join_with_S_keys_unique_res_158715;
    
    if (cond_158702) {
        if (mem_171462_cached_sizze_172201 < nS_143051) {
            err = lexical_realloc(ctx, &mem_171462, &mem_171462_cached_sizze_172201, nS_143051);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < nS_143051; i_171003++) {
            int8_t defunc_0_byteSeq_to_prim_res_167082;
            int8_t y_167084 = (int8_t) 0;
            
            for (int64_t i_167083 = 0; i_167083 < b_143050; i_167083++) {
                int64_t zm_lhs_167085 = sub64(b_143050, i_167083);
                int64_t from_u8_arg0_167086 = sub64(zm_lhs_167085, (int64_t) 1);
                bool x_167087 = sle64((int64_t) 0, from_u8_arg0_167086);
                bool y_167088 = slt64(from_u8_arg0_167086, b_143050);
                bool bounds_check_167089 = x_167087 && y_167088;
                bool index_certs_167090;
                
                if (!bounds_check_167089) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167086, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:423:70-76\n   #2  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_167091 = ((int8_t *) pS_mem_171275.mem)[i_171003 * b_143050 + from_u8_arg0_167086];
                int32_t i64_res_167092 = sext_i64_i32(i_167083);
                int32_t shift_left_rhs_167093 = mul32(8, i64_res_167092);
                int8_t unsign_arg0_167094 = zext_i32_i8(shift_left_rhs_167093);
                int8_t lifted_lambda_res_167095 = shl8(from_u8_arg0_167091, unsign_arg0_167094);
                int8_t unsign_arg0_167096 = y_167084 | lifted_lambda_res_167095;
                int8_t y_tmp_171961 = unsign_arg0_167096;
                
                y_167084 = y_tmp_171961;
            }
            defunc_0_byteSeq_to_prim_res_167082 = y_167084;
            ((int8_t *) mem_171462)[i_171003] = defunc_0_byteSeq_to_prim_res_167082;
        }
        if (mem_171470_cached_sizze_172202 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171470, &mem_171470_cached_sizze_172202, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171472_cached_sizze_172203 < bytes_171288) {
            err = lexical_realloc(ctx, &mem_171472, &mem_171472_cached_sizze_172203, bytes_171288);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_171014;
        int64_t defunc_res_167100;
        int64_t scanacc_171007;
        int64_t redout_171009;
        
        scanacc_171007 = (int64_t) 0;
        redout_171009 = (int64_t) 0;
        for (int64_t i_171011 = 0; i_171011 < nR_143049; i_171011++) {
            int8_t defunc_0_byteSeq_to_prim_res_167103;
            int8_t y_167105 = (int8_t) 0;
            
            for (int64_t i_167104 = 0; i_167104 < b_143050; i_167104++) {
                int64_t zm_lhs_167106 = sub64(b_143050, i_167104);
                int64_t from_u8_arg0_167107 = sub64(zm_lhs_167106, (int64_t) 1);
                bool x_167108 = sle64((int64_t) 0, from_u8_arg0_167107);
                bool y_167109 = slt64(from_u8_arg0_167107, b_143050);
                bool bounds_check_167110 = x_167108 && y_167109;
                bool index_certs_167111;
                
                if (!bounds_check_167110) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167107, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:423:70-76\n   #2  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_167112 = ((int8_t *) pR_mem_171274.mem)[i_171011 * b_143050 + from_u8_arg0_167107];
                int32_t i64_res_167113 = sext_i64_i32(i_167104);
                int32_t shift_left_rhs_167114 = mul32(8, i64_res_167113);
                int8_t unsign_arg0_167115 = zext_i32_i8(shift_left_rhs_167114);
                int8_t lifted_lambda_res_167116 = shl8(from_u8_arg0_167112, unsign_arg0_167115);
                int8_t unsign_arg0_167117 = y_167105 | lifted_lambda_res_167116;
                int8_t y_tmp_171966 = unsign_arg0_167117;
                
                y_167105 = y_tmp_171966;
            }
            defunc_0_byteSeq_to_prim_res_167103 = y_167105;
            
            int8_t lifted_lambda_res_167118 = u64_res_158712 & defunc_0_byteSeq_to_prim_res_167103;
            int64_t u8_res_167119 = zext_i8_i64(lifted_lambda_res_167118);
            bool x_167120 = sle64((int64_t) 0, u8_res_167119);
            bool y_167121 = slt64(u8_res_167119, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053);
            bool bounds_check_167122 = x_167120 && y_167121;
            bool index_certs_167123;
            
            if (!bounds_check_167122) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_res_167119, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t spi_167124 = ((int64_t *) first_info_idx_mem_171278.mem)[u8_res_167119];
            bool cond_167125 = slt64(spi_167124, (int64_t) 0);
            int64_t defunc_res_167126;
            
            if (cond_167125) {
                defunc_res_167126 = (int64_t) -1;
            } else {
                int64_t zeze_rhs_167127 = ((int64_t *) last_info_idx_mem_171279.mem)[u8_res_167119];
                bool cond_167128 = spi_167124 == zeze_rhs_167127;
                int64_t defunc_res_f_res_167129;
                
                if (cond_167128) {
                    defunc_res_f_res_167129 = spi_167124;
                } else {
                    int64_t zs_lhs_167130 = sub64(zeze_rhs_167127, spi_167124);
                    int64_t max_arg1_167131 = sdiv64(zs_lhs_167130, (int64_t) 2);
                    int64_t max_res_167132 = smax64((int64_t) 1, max_arg1_167131);
                    bool loop_cond_167133 = slt64((int64_t) 0, max_res_167132);
                    bool bsearch_167134;
                    int64_t bsearch_167135;
                    int64_t bsearch_167136;
                    bool loop_while_167137;
                    int64_t heshi_167138;
                    int64_t step_167139;
                    
                    loop_while_167137 = loop_cond_167133;
                    heshi_167138 = spi_167124;
                    step_167139 = max_res_167132;
                    while (loop_while_167137) {
                        bool x_167140 = sle64((int64_t) 0, heshi_167138);
                        bool y_167141 = slt64(heshi_167138, dz2081U_143052);
                        bool bounds_check_167142 = x_167140 && y_167141;
                        bool index_certs_167143;
                        
                        if (!bounds_check_167142) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_167138, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t cur_S_167161 = ((int64_t *) bounds_mem_171276.mem)[heshi_167138];
                        bool x_167162 = sle64((int64_t) 0, cur_S_167161);
                        bool y_167163 = slt64(cur_S_167161, nS_143051);
                        bool bounds_check_167164 = x_167162 && y_167163;
                        bool index_certs_167165;
                        
                        if (!bounds_check_167164) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_167161, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t cur_depth_167144 = ((int32_t *) depths_mem_171277.mem)[heshi_167138];
                        bool cond_167145 = heshi_167138 == spi_167124;
                        int32_t prev_depth_167146;
                        
                        if (cond_167145) {
                            prev_depth_167146 = cur_depth_167144;
                        } else {
                            int64_t tmp_167147 = sub64(heshi_167138, (int64_t) 1);
                            bool x_167148 = sle64((int64_t) 0, tmp_167147);
                            bool y_167149 = slt64(tmp_167147, dz2081U_143052);
                            bool bounds_check_167150 = x_167148 && y_167149;
                            bool index_certs_167151;
                            
                            if (!bounds_check_167150) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167147, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t prev_depth_f_res_167152 = ((int32_t *) depths_mem_171277.mem)[tmp_167147];
                            
                            prev_depth_167146 = prev_depth_f_res_167152;
                        }
                        
                        bool cond_167153 = heshi_167138 == zeze_rhs_167127;
                        int32_t next_depth_167154;
                        
                        if (cond_167153) {
                            next_depth_167154 = cur_depth_167144;
                        } else {
                            int64_t tmp_167155 = add64((int64_t) 1, heshi_167138);
                            bool x_167156 = sle64((int64_t) 0, tmp_167155);
                            bool y_167157 = slt64(tmp_167155, dz2081U_143052);
                            bool bounds_check_167158 = x_167156 && y_167157;
                            bool index_certs_167159;
                            
                            if (!bounds_check_167158) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167155, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t next_depth_f_res_167160 = ((int32_t *) depths_mem_171277.mem)[tmp_167155];
                            
                            next_depth_167154 = next_depth_f_res_167160;
                        }
                        
                        int8_t cur_S_167166 = ((int8_t *) mem_171462)[cur_S_167161];
                        int8_t prev_S_167167;
                        
                        if (cond_167145) {
                            prev_S_167167 = cur_S_167166;
                        } else {
                            int64_t tmp_167168 = sub64(heshi_167138, (int64_t) 1);
                            bool x_167169 = sle64((int64_t) 0, tmp_167168);
                            bool y_167170 = slt64(tmp_167168, dz2081U_143052);
                            bool bounds_check_167171 = x_167169 && y_167170;
                            bool index_certs_167172;
                            
                            if (!bounds_check_167171) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167168, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_167173 = ((int64_t *) bounds_mem_171276.mem)[tmp_167168];
                            bool x_167174 = sle64((int64_t) 0, tmp_167173);
                            bool y_167175 = slt64(tmp_167173, nS_143051);
                            bool bounds_check_167176 = x_167174 && y_167175;
                            bool index_certs_167177;
                            
                            if (!bounds_check_167176) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167173, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t prev_S_f_res_167178 = ((int8_t *) mem_171462)[tmp_167173];
                            
                            prev_S_167167 = prev_S_f_res_167178;
                        }
                        
                        int8_t next_S_167179;
                        
                        if (cond_167153) {
                            next_S_167179 = cur_S_167166;
                        } else {
                            int64_t tmp_167180 = add64((int64_t) 1, heshi_167138);
                            bool x_167181 = sle64((int64_t) 0, tmp_167180);
                            bool y_167182 = slt64(tmp_167180, dz2081U_143052);
                            bool bounds_check_167183 = x_167181 && y_167182;
                            bool index_certs_167184;
                            
                            if (!bounds_check_167183) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167180, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_167185 = ((int64_t *) bounds_mem_171276.mem)[tmp_167180];
                            bool x_167186 = sle64((int64_t) 0, tmp_167185);
                            bool y_167187 = slt64(tmp_167185, nS_143051);
                            bool bounds_check_167188 = x_167186 && y_167187;
                            bool index_certs_167189;
                            
                            if (!bounds_check_167188) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167185, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:863:4-870:86\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-986:70\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t next_S_f_res_167190 = ((int8_t *) mem_171462)[tmp_167185];
                            
                            next_S_167179 = next_S_f_res_167190;
                        }
                        
                        int32_t prim_get_radix_arg0_167191 = mul32(radix_sizze_143054, cur_depth_167144);
                        int64_t unsign_arg0_167192 = zext_i32_i64(prim_get_radix_arg0_167191);
                        int64_t asPow_167193 = shl64((int64_t) 1, unsign_arg0_167192);
                        int64_t u64_arg0_167194 = sub64(asPow_167193, (int64_t) 1);
                        int8_t u64_res_167195 = zext_i64_i8(u64_arg0_167194);
                        int8_t lifted_lambda_res_167196 = defunc_0_byteSeq_to_prim_res_167103 & u64_res_167195;
                        int8_t lifted_lambda_res_167197 = cur_S_167166 & u64_res_167195;
                        bool defunc_0_eq_res_167198 = lifted_lambda_res_167196 == lifted_lambda_res_167197;
                        int64_t loopres_167199;
                        int64_t loopres_167200;
                        
                        if (defunc_0_eq_res_167198) {
                            loopres_167199 = heshi_167138;
                            loopres_167200 = (int64_t) 0;
                        } else {
                            bool loop_cond_t_res_167201 = slt32(0, cur_depth_167144);
                            bool is_lt_167202;
                            bool is_lt_167203;
                            int32_t is_lt_167204;
                            bool loop_while_167205;
                            bool def_lt_167206;
                            int32_t bi_167207;
                            
                            loop_while_167205 = loop_cond_t_res_167201;
                            def_lt_167206 = 0;
                            bi_167207 = 0;
                            while (loop_while_167205) {
                                int32_t zt_rhs_167208 = add32(1, bi_167207);
                                int32_t prim_get_radix_arg0_167209 = mul32(radix_sizze_143054, zt_rhs_167208);
                                int64_t unsign_arg0_167210 = zext_i32_i64(prim_get_radix_arg0_167209);
                                int64_t asPow_167211 = shl64((int64_t) 1, unsign_arg0_167210);
                                int64_t u64_arg0_167212 = sub64(asPow_167211, (int64_t) 1);
                                int8_t u64_res_167213 = zext_i64_i8(u64_arg0_167212);
                                int8_t lifted_lambda_res_167214 = defunc_0_byteSeq_to_prim_res_167103 & u64_res_167213;
                                int8_t lifted_lambda_res_167215 = cur_S_167166 & u64_res_167213;
                                bool defunc_0_lt_res_167216 = ult8(lifted_lambda_res_167214, lifted_lambda_res_167215);
                                bool defunc_0_lt_res_167217 = ult8(lifted_lambda_res_167215, lifted_lambda_res_167214);
                                bool cond_167218 = !defunc_0_lt_res_167217;
                                bool cond_t_res_167219 = !defunc_0_lt_res_167216;
                                bool x_167220 = cond_167218 && cond_t_res_167219;
                                bool loop_cond_t_res_167221 = slt32(zt_rhs_167208, cur_depth_167144);
                                bool x_167222 = x_167220 && loop_cond_t_res_167221;
                                bool loop_while_tmp_171970 = x_167222;
                                bool def_lt_tmp_171971 = defunc_0_lt_res_167216;
                                int32_t bi_tmp_171972 = zt_rhs_167208;
                                
                                loop_while_167205 = loop_while_tmp_171970;
                                def_lt_167206 = def_lt_tmp_171971;
                                bi_167207 = bi_tmp_171972;
                            }
                            is_lt_167202 = loop_while_167205;
                            is_lt_167203 = def_lt_167206;
                            is_lt_167204 = bi_167207;
                            
                            int64_t loopres_f_res_167223;
                            int64_t loopres_f_res_167224;
                            
                            if (is_lt_167203) {
                                bool loop_cond_t_res_167225 = slt32(0, prev_depth_167146);
                                bool is_gt_167226;
                                bool is_gt_167227;
                                int32_t is_gt_167228;
                                bool loop_while_167229;
                                bool def_gt_167230;
                                int32_t bi_167231;
                                
                                loop_while_167229 = loop_cond_t_res_167225;
                                def_gt_167230 = 0;
                                bi_167231 = 0;
                                while (loop_while_167229) {
                                    int32_t zt_rhs_167232 = add32(1, bi_167231);
                                    int32_t prim_get_radix_arg0_167233 = mul32(radix_sizze_143054, zt_rhs_167232);
                                    int64_t unsign_arg0_167234 = zext_i32_i64(prim_get_radix_arg0_167233);
                                    int64_t asPow_167235 = shl64((int64_t) 1, unsign_arg0_167234);
                                    int64_t u64_arg0_167236 = sub64(asPow_167235, (int64_t) 1);
                                    int8_t u64_res_167237 = zext_i64_i8(u64_arg0_167236);
                                    int8_t lifted_lambda_res_167238 = defunc_0_byteSeq_to_prim_res_167103 & u64_res_167237;
                                    int8_t lifted_lambda_res_167239 = prev_S_167167 & u64_res_167237;
                                    bool defunc_0_gt_res_167240 = ult8(lifted_lambda_res_167239, lifted_lambda_res_167238);
                                    bool defunc_0_gt_res_167241 = ult8(lifted_lambda_res_167238, lifted_lambda_res_167239);
                                    bool cond_167242 = !defunc_0_gt_res_167240;
                                    bool cond_t_res_167243 = !defunc_0_gt_res_167241;
                                    bool x_167244 = cond_167242 && cond_t_res_167243;
                                    bool loop_cond_t_res_167245 = slt32(zt_rhs_167232, prev_depth_167146);
                                    bool x_167246 = x_167244 && loop_cond_t_res_167245;
                                    bool loop_while_tmp_171973 = x_167246;
                                    bool def_gt_tmp_171974 = defunc_0_gt_res_167240;
                                    int32_t bi_tmp_171975 = zt_rhs_167232;
                                    
                                    loop_while_167229 = loop_while_tmp_171973;
                                    def_gt_167230 = def_gt_tmp_171974;
                                    bi_167231 = bi_tmp_171975;
                                }
                                is_gt_167226 = loop_while_167229;
                                is_gt_167227 = def_gt_167230;
                                is_gt_167228 = bi_167231;
                                
                                bool x_167247 = !cond_167145;
                                bool y_167248 = is_gt_167227 && x_167247;
                                bool cond_167249 = cond_167145 || y_167248;
                                int64_t loopres_f_res_t_res_167250;
                                int64_t loopres_f_res_t_res_167251;
                                
                                if (cond_167249) {
                                    loopres_f_res_t_res_167250 = (int64_t) -1;
                                    loopres_f_res_t_res_167251 = (int64_t) 0;
                                } else {
                                    int64_t tmp_167252 = sub64(heshi_167138, step_167139);
                                    int64_t max_arg1_167253 = sdiv64(step_167139, (int64_t) 2);
                                    int64_t max_res_167254 = smax64((int64_t) 1, max_arg1_167253);
                                    
                                    loopres_f_res_t_res_167250 = tmp_167252;
                                    loopres_f_res_t_res_167251 = max_res_167254;
                                }
                                loopres_f_res_167223 = loopres_f_res_t_res_167250;
                                loopres_f_res_167224 = loopres_f_res_t_res_167251;
                            } else {
                                bool loop_cond_t_res_167255 = slt32(0, next_depth_167154);
                                bool is_lt_167256;
                                bool is_lt_167257;
                                int32_t is_lt_167258;
                                bool loop_while_167259;
                                bool def_lt_167260;
                                int32_t bi_167261;
                                
                                loop_while_167259 = loop_cond_t_res_167255;
                                def_lt_167260 = 0;
                                bi_167261 = 0;
                                while (loop_while_167259) {
                                    int32_t zt_rhs_167262 = add32(1, bi_167261);
                                    int32_t prim_get_radix_arg0_167263 = mul32(radix_sizze_143054, zt_rhs_167262);
                                    int64_t unsign_arg0_167264 = zext_i32_i64(prim_get_radix_arg0_167263);
                                    int64_t asPow_167265 = shl64((int64_t) 1, unsign_arg0_167264);
                                    int64_t u64_arg0_167266 = sub64(asPow_167265, (int64_t) 1);
                                    int8_t u64_res_167267 = zext_i64_i8(u64_arg0_167266);
                                    int8_t lifted_lambda_res_167268 = defunc_0_byteSeq_to_prim_res_167103 & u64_res_167267;
                                    int8_t lifted_lambda_res_167269 = next_S_167179 & u64_res_167267;
                                    bool defunc_0_lt_res_167270 = ult8(lifted_lambda_res_167268, lifted_lambda_res_167269);
                                    bool defunc_0_lt_res_167271 = ult8(lifted_lambda_res_167269, lifted_lambda_res_167268);
                                    bool cond_167272 = !defunc_0_lt_res_167271;
                                    bool cond_t_res_167273 = !defunc_0_lt_res_167270;
                                    bool x_167274 = cond_167272 && cond_t_res_167273;
                                    bool loop_cond_t_res_167275 = slt32(zt_rhs_167262, next_depth_167154);
                                    bool x_167276 = x_167274 && loop_cond_t_res_167275;
                                    bool loop_while_tmp_171976 = x_167276;
                                    bool def_lt_tmp_171977 = defunc_0_lt_res_167270;
                                    int32_t bi_tmp_171978 = zt_rhs_167262;
                                    
                                    loop_while_167259 = loop_while_tmp_171976;
                                    def_lt_167260 = def_lt_tmp_171977;
                                    bi_167261 = bi_tmp_171978;
                                }
                                is_lt_167256 = loop_while_167259;
                                is_lt_167257 = def_lt_167260;
                                is_lt_167258 = bi_167261;
                                
                                bool x_167277 = !cond_167153;
                                bool y_167278 = is_lt_167257 && x_167277;
                                bool cond_167279 = cond_167153 || y_167278;
                                int64_t loopres_f_res_f_res_167280;
                                int64_t loopres_f_res_f_res_167281;
                                
                                if (cond_167279) {
                                    loopres_f_res_f_res_167280 = (int64_t) -1;
                                    loopres_f_res_f_res_167281 = (int64_t) 0;
                                } else {
                                    int64_t tmp_167282 = add64(heshi_167138, step_167139);
                                    int64_t max_arg1_167283 = sdiv64(step_167139, (int64_t) 2);
                                    int64_t max_res_167284 = smax64((int64_t) 1, max_arg1_167283);
                                    
                                    loopres_f_res_f_res_167280 = tmp_167282;
                                    loopres_f_res_f_res_167281 = max_res_167284;
                                }
                                loopres_f_res_167223 = loopres_f_res_f_res_167280;
                                loopres_f_res_167224 = loopres_f_res_f_res_167281;
                            }
                            loopres_167199 = loopres_f_res_167223;
                            loopres_167200 = loopres_f_res_167224;
                        }
                        
                        bool loop_cond_167285 = slt64((int64_t) 0, loopres_167200);
                        bool loop_while_tmp_171967 = loop_cond_167285;
                        int64_t heshi_tmp_171968 = loopres_167199;
                        int64_t step_tmp_171969 = loopres_167200;
                        
                        loop_while_167137 = loop_while_tmp_171967;
                        heshi_167138 = heshi_tmp_171968;
                        step_167139 = step_tmp_171969;
                    }
                    bsearch_167134 = loop_while_167137;
                    bsearch_167135 = heshi_167138;
                    bsearch_167136 = step_167139;
                    defunc_res_f_res_167129 = bsearch_167135;
                }
                defunc_res_167126 = defunc_res_f_res_167129;
            }
            
            bool cond_167286 = sle64(defunc_res_167126, (int64_t) 0);
            int64_t inf_167287;
            
            if (cond_167286) {
                inf_167287 = (int64_t) 0;
            } else {
                bool x_167288 = sle64((int64_t) 0, defunc_res_167126);
                bool y_167289 = slt64(defunc_res_167126, dz2081U_143052);
                bool bounds_check_167290 = x_167288 && y_167289;
                bool index_certs_167291;
                
                if (!bounds_check_167290) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167126, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:871:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-986:70\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t inf_f_res_167292 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_167126];
                
                inf_167287 = inf_f_res_167292;
            }
            
            bool cond_167293 = defunc_res_167126 == zeze_rhs_158708;
            int64_t sup_167294;
            
            if (cond_167293) {
                sup_167294 = nS_143051;
            } else {
                int64_t tmp_167295 = add64((int64_t) 1, defunc_res_167126);
                bool x_167296 = sle64((int64_t) 0, tmp_167295);
                bool y_167297 = slt64(tmp_167295, dz2081U_143052);
                bool bounds_check_167298 = x_167296 && y_167297;
                bool index_certs_167299;
                
                if (!bounds_check_167298) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167295, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:872:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-986:70\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t sup_f_res_167300 = ((int64_t *) bounds_mem_171276.mem)[tmp_167295];
                
                sup_167294 = sup_f_res_167300;
            }
            
            bool cond_167301 = slt64(inf_167287, sup_167294);
            bool sm_167302;
            int64_t sm_167303;
            bool loop_while_167304;
            int64_t j_167305;
            
            loop_while_167304 = cond_167301;
            j_167305 = inf_167287;
            while (loop_while_167304) {
                bool x_167306 = sle64((int64_t) 0, j_167305);
                bool y_167307 = slt64(j_167305, nS_143051);
                bool bounds_check_167308 = x_167306 && y_167307;
                bool index_certs_167309;
                
                if (!bounds_check_167308) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_167305, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:875:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-986:70\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t zeze_rhs_167310 = ((int8_t *) mem_171462)[j_167305];
                bool is_eq_167311 = defunc_0_byteSeq_to_prim_res_167103 == zeze_rhs_167310;
                int64_t loopres_167312;
                
                if (is_eq_167311) {
                    loopres_167312 = j_167305;
                } else {
                    int64_t tmp_167313 = add64((int64_t) 1, j_167305);
                    
                    loopres_167312 = tmp_167313;
                }
                
                bool cond_167314 = slt64(loopres_167312, sup_167294);
                bool loop_cond_t_res_167315 = !is_eq_167311;
                bool x_167316 = cond_167314 && loop_cond_t_res_167315;
                bool loop_while_tmp_171979 = x_167316;
                int64_t j_tmp_171980 = loopres_167312;
                
                loop_while_167304 = loop_while_tmp_171979;
                j_167305 = j_tmp_171980;
            }
            sm_167302 = loop_while_167304;
            sm_167303 = j_167305;
            
            bool cond_167317 = slt64(sm_167303, sup_167294);
            int64_t lifted_lambda_res_167318;
            
            if (cond_167317) {
                lifted_lambda_res_167318 = sm_167303;
            } else {
                lifted_lambda_res_167318 = (int64_t) -1;
            }
            
            bool lifted_lambda_res_167319 = sle64((int64_t) 0, lifted_lambda_res_167318);
            int64_t bool_res_167320 = btoi_bool_i64(lifted_lambda_res_167319);
            int64_t defunc_0_op_res_167325 = add64(bool_res_167320, scanacc_171007);
            int64_t zp_res_167328 = add64(bool_res_167320, redout_171009);
            
            ((int64_t *) mem_171470)[i_171011] = defunc_0_op_res_167325;
            ((int64_t *) mem_171472)[i_171011] = lifted_lambda_res_167318;
            
            int64_t scanacc_tmp_171962 = defunc_0_op_res_167325;
            int64_t redout_tmp_171964 = zp_res_167328;
            
            scanacc_171007 = scanacc_tmp_171962;
            redout_171009 = redout_tmp_171964;
        }
        discard_171014 = scanacc_171007;
        defunc_res_167100 = redout_171009;
        
        int64_t bytes_171485 = (int64_t) 8 * defunc_res_167100;
        int64_t bytes_171502 = b_143050 * defunc_res_167100;
        
        if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171981 = 0; nest_i_171981 < defunc_res_167100; nest_i_171981++) {
            ((int64_t *) mem_171486.mem)[nest_i_171981] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171488, bytes_171485, "mem_171488")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171982 = 0; nest_i_171982 < defunc_res_167100; nest_i_171982++) {
            ((int64_t *) mem_171488.mem)[nest_i_171982] = (int64_t) -1;
        }
        for (int64_t write_iter_171015 = 0; write_iter_171015 < nR_143049; write_iter_171015++) {
            int64_t write_iv_171019 = ((int64_t *) mem_171472)[write_iter_171015];
            int64_t zv_lhs_167342 = add64((int64_t) -1, write_iter_171015);
            int64_t tmp_167343 = smod64(zv_lhs_167342, nR_143049);
            int64_t lifted_lambda_res_167344 = ((int64_t *) mem_171470)[tmp_167343];
            bool cond_167345 = write_iter_171015 == (int64_t) 0;
            int64_t lifted_lambda_res_167346;
            
            if (cond_167345) {
                lifted_lambda_res_167346 = (int64_t) 0;
            } else {
                lifted_lambda_res_167346 = lifted_lambda_res_167344;
            }
            
            bool cond_167347 = sle64((int64_t) 0, write_iv_171019);
            int64_t lifted_lambda_res_167348;
            
            if (cond_167347) {
                lifted_lambda_res_167348 = lifted_lambda_res_167346;
            } else {
                lifted_lambda_res_167348 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_167348) && slt64(lifted_lambda_res_167348, defunc_res_167100)) {
                ((int64_t *) mem_171486.mem)[lifted_lambda_res_167348] = write_iv_171019;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_167348) && slt64(lifted_lambda_res_167348, defunc_res_167100)) {
                ((int64_t *) mem_171488.mem)[lifted_lambda_res_167348] = write_iter_171015;
            }
        }
        if (memblock_alloc(ctx, &mem_171501, b_143050, "mem_171501")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171985 = 0; nest_i_171985 < b_143050; nest_i_171985++) {
            ((int8_t *) mem_171501.mem)[nest_i_171985] = (int8_t) 0;
        }
        if (memblock_alloc(ctx, &mem_171503, bytes_171502, "mem_171503")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171024 = 0; i_171024 < defunc_res_167100; i_171024++) {
            int64_t eta_p_167355 = ((int64_t *) mem_171488.mem)[i_171024];
            bool cond_167356 = sle64((int64_t) 0, eta_p_167355);
            bool cond_t_res_167357 = slt64(eta_p_167355, nR_143049);
            bool x_167358 = cond_167356 && cond_t_res_167357;
            int64_t lmad_ext_171508 = b_143050 * eta_p_167355;
            int64_t ext_171509;
            
            if (x_167358) {
                ext_171509 = lmad_ext_171508;
            } else {
                ext_171509 = (int64_t) 0;
            }
            if (x_167358) {
                bool index_certs_167360;
                
                if (!x_167358) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_167355, "] out of bounds for array of shape [", (long long) nR_143049, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_set(ctx, &ext_mem_171510, &pR_mem_171274, "pR_mem_171274") != 0)
                    return 1;
            } else if (memblock_set(ctx, &ext_mem_171510, &mem_171501, "mem_171501") != 0)
                return 1;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171503.mem, i_171024 * b_143050, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171510.mem, ext_171509, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143050});
            if (memblock_unref(ctx, &ext_mem_171510, "ext_mem_171510") != 0)
                return 1;
        }
        if (memblock_unref(ctx, &mem_171501, "mem_171501") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171524, &mem_171488, "mem_171488") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171521, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171518, &mem_171503, "mem_171503") != 0)
            return 1;
        radix_hash_join_with_S_keys_unique_res_158713 = defunc_res_167100;
        radix_hash_join_with_S_keys_unique_res_158714 = defunc_res_167100;
        radix_hash_join_with_S_keys_unique_res_158715 = defunc_res_167100;
    } else {
        int64_t radix_hash_join_with_S_keys_unique_res_f_res_158972;
        int64_t radix_hash_join_with_S_keys_unique_res_f_res_158973;
        int64_t radix_hash_join_with_S_keys_unique_res_f_res_158974;
        
        if (cond_158703) {
            if (mem_171399_cached_sizze_172198 < bytes_171398) {
                err = lexical_realloc(ctx, &mem_171399, &mem_171399_cached_sizze_172198, bytes_171398);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171028 = 0; i_171028 < nS_143051; i_171028++) {
                int16_t defunc_0_byteSeq_to_prim_res_167405;
                int16_t y_167407 = (int16_t) 0;
                
                for (int64_t i_167406 = 0; i_167406 < b_143050; i_167406++) {
                    int64_t zm_lhs_167408 = sub64(b_143050, i_167406);
                    int64_t from_u8_arg0_167409 = sub64(zm_lhs_167408, (int64_t) 1);
                    bool x_167410 = sle64((int64_t) 0, from_u8_arg0_167409);
                    bool y_167411 = slt64(from_u8_arg0_167409, b_143050);
                    bool bounds_check_167412 = x_167410 && y_167411;
                    bool index_certs_167413;
                    
                    if (!bounds_check_167412) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167409, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:425:75-82\n   #2  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_167414 = ((int8_t *) pS_mem_171275.mem)[i_171028 * b_143050 + from_u8_arg0_167409];
                    int16_t u8_res_167415 = zext_i8_i16(from_u8_arg0_167414);
                    int32_t i64_res_167416 = sext_i64_i32(i_167406);
                    int32_t shift_left_rhs_167417 = mul32(8, i64_res_167416);
                    int16_t unsign_arg0_167418 = zext_i32_i16(shift_left_rhs_167417);
                    int16_t lifted_lambda_res_167419 = shl16(u8_res_167415, unsign_arg0_167418);
                    int16_t unsign_arg0_167420 = y_167407 | lifted_lambda_res_167419;
                    int16_t y_tmp_171988 = unsign_arg0_167420;
                    
                    y_167407 = y_tmp_171988;
                }
                defunc_0_byteSeq_to_prim_res_167405 = y_167407;
                ((int16_t *) mem_171399)[i_171028] = defunc_0_byteSeq_to_prim_res_167405;
            }
            if (mem_171407_cached_sizze_172199 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171407, &mem_171407_cached_sizze_172199, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171409_cached_sizze_172200 < bytes_171288) {
                err = lexical_realloc(ctx, &mem_171409, &mem_171409_cached_sizze_172200, bytes_171288);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171039;
            int64_t defunc_res_167425;
            int64_t scanacc_171032;
            int64_t redout_171034;
            
            scanacc_171032 = (int64_t) 0;
            redout_171034 = (int64_t) 0;
            for (int64_t i_171036 = 0; i_171036 < nR_143049; i_171036++) {
                int16_t defunc_0_byteSeq_to_prim_res_167428;
                int16_t y_167430 = (int16_t) 0;
                
                for (int64_t i_167429 = 0; i_167429 < b_143050; i_167429++) {
                    int64_t zm_lhs_167431 = sub64(b_143050, i_167429);
                    int64_t from_u8_arg0_167432 = sub64(zm_lhs_167431, (int64_t) 1);
                    bool x_167433 = sle64((int64_t) 0, from_u8_arg0_167432);
                    bool y_167434 = slt64(from_u8_arg0_167432, b_143050);
                    bool bounds_check_167435 = x_167433 && y_167434;
                    bool index_certs_167436;
                    
                    if (!bounds_check_167435) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167432, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:425:75-82\n   #2  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_167437 = ((int8_t *) pR_mem_171274.mem)[i_171036 * b_143050 + from_u8_arg0_167432];
                    int16_t u8_res_167438 = zext_i8_i16(from_u8_arg0_167437);
                    int32_t i64_res_167439 = sext_i64_i32(i_167429);
                    int32_t shift_left_rhs_167440 = mul32(8, i64_res_167439);
                    int16_t unsign_arg0_167441 = zext_i32_i16(shift_left_rhs_167440);
                    int16_t lifted_lambda_res_167442 = shl16(u8_res_167438, unsign_arg0_167441);
                    int16_t unsign_arg0_167443 = y_167430 | lifted_lambda_res_167442;
                    int16_t y_tmp_171993 = unsign_arg0_167443;
                    
                    y_167430 = y_tmp_171993;
                }
                defunc_0_byteSeq_to_prim_res_167428 = y_167430;
                
                int16_t lifted_lambda_res_167444 = u64_res_158711 & defunc_0_byteSeq_to_prim_res_167428;
                int64_t u16_res_167445 = zext_i16_i64(lifted_lambda_res_167444);
                bool x_167446 = sle64((int64_t) 0, u16_res_167445);
                bool y_167447 = slt64(u16_res_167445, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053);
                bool bounds_check_167448 = x_167446 && y_167447;
                bool index_certs_167449;
                
                if (!bounds_check_167448) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u16_res_167445, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t spi_167450 = ((int64_t *) first_info_idx_mem_171278.mem)[u16_res_167445];
                bool cond_167451 = slt64(spi_167450, (int64_t) 0);
                int64_t defunc_res_167452;
                
                if (cond_167451) {
                    defunc_res_167452 = (int64_t) -1;
                } else {
                    int64_t zeze_rhs_167453 = ((int64_t *) last_info_idx_mem_171279.mem)[u16_res_167445];
                    bool cond_167454 = spi_167450 == zeze_rhs_167453;
                    int64_t defunc_res_f_res_167455;
                    
                    if (cond_167454) {
                        defunc_res_f_res_167455 = spi_167450;
                    } else {
                        int64_t zs_lhs_167456 = sub64(zeze_rhs_167453, spi_167450);
                        int64_t max_arg1_167457 = sdiv64(zs_lhs_167456, (int64_t) 2);
                        int64_t max_res_167458 = smax64((int64_t) 1, max_arg1_167457);
                        bool loop_cond_167459 = slt64((int64_t) 0, max_res_167458);
                        bool bsearch_167460;
                        int64_t bsearch_167461;
                        int64_t bsearch_167462;
                        bool loop_while_167463;
                        int64_t heshi_167464;
                        int64_t step_167465;
                        
                        loop_while_167463 = loop_cond_167459;
                        heshi_167464 = spi_167450;
                        step_167465 = max_res_167458;
                        while (loop_while_167463) {
                            bool x_167466 = sle64((int64_t) 0, heshi_167464);
                            bool y_167467 = slt64(heshi_167464, dz2081U_143052);
                            bool bounds_check_167468 = x_167466 && y_167467;
                            bool index_certs_167469;
                            
                            if (!bounds_check_167468) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_167464, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t cur_S_167487 = ((int64_t *) bounds_mem_171276.mem)[heshi_167464];
                            bool x_167488 = sle64((int64_t) 0, cur_S_167487);
                            bool y_167489 = slt64(cur_S_167487, nS_143051);
                            bool bounds_check_167490 = x_167488 && y_167489;
                            bool index_certs_167491;
                            
                            if (!bounds_check_167490) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_167487, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t cur_depth_167470 = ((int32_t *) depths_mem_171277.mem)[heshi_167464];
                            bool cond_167471 = heshi_167464 == spi_167450;
                            int32_t prev_depth_167472;
                            
                            if (cond_167471) {
                                prev_depth_167472 = cur_depth_167470;
                            } else {
                                int64_t tmp_167473 = sub64(heshi_167464, (int64_t) 1);
                                bool x_167474 = sle64((int64_t) 0, tmp_167473);
                                bool y_167475 = slt64(tmp_167473, dz2081U_143052);
                                bool bounds_check_167476 = x_167474 && y_167475;
                                bool index_certs_167477;
                                
                                if (!bounds_check_167476) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167473, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t prev_depth_f_res_167478 = ((int32_t *) depths_mem_171277.mem)[tmp_167473];
                                
                                prev_depth_167472 = prev_depth_f_res_167478;
                            }
                            
                            bool cond_167479 = heshi_167464 == zeze_rhs_167453;
                            int32_t next_depth_167480;
                            
                            if (cond_167479) {
                                next_depth_167480 = cur_depth_167470;
                            } else {
                                int64_t tmp_167481 = add64((int64_t) 1, heshi_167464);
                                bool x_167482 = sle64((int64_t) 0, tmp_167481);
                                bool y_167483 = slt64(tmp_167481, dz2081U_143052);
                                bool bounds_check_167484 = x_167482 && y_167483;
                                bool index_certs_167485;
                                
                                if (!bounds_check_167484) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167481, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t next_depth_f_res_167486 = ((int32_t *) depths_mem_171277.mem)[tmp_167481];
                                
                                next_depth_167480 = next_depth_f_res_167486;
                            }
                            
                            int16_t cur_S_167492 = ((int16_t *) mem_171399)[cur_S_167487];
                            int16_t prev_S_167493;
                            
                            if (cond_167471) {
                                prev_S_167493 = cur_S_167492;
                            } else {
                                int64_t tmp_167494 = sub64(heshi_167464, (int64_t) 1);
                                bool x_167495 = sle64((int64_t) 0, tmp_167494);
                                bool y_167496 = slt64(tmp_167494, dz2081U_143052);
                                bool bounds_check_167497 = x_167495 && y_167496;
                                bool index_certs_167498;
                                
                                if (!bounds_check_167497) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167494, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_167499 = ((int64_t *) bounds_mem_171276.mem)[tmp_167494];
                                bool x_167500 = sle64((int64_t) 0, tmp_167499);
                                bool y_167501 = slt64(tmp_167499, nS_143051);
                                bool bounds_check_167502 = x_167500 && y_167501;
                                bool index_certs_167503;
                                
                                if (!bounds_check_167502) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167499, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t prev_S_f_res_167504 = ((int16_t *) mem_171399)[tmp_167499];
                                
                                prev_S_167493 = prev_S_f_res_167504;
                            }
                            
                            int16_t next_S_167505;
                            
                            if (cond_167479) {
                                next_S_167505 = cur_S_167492;
                            } else {
                                int64_t tmp_167506 = add64((int64_t) 1, heshi_167464);
                                bool x_167507 = sle64((int64_t) 0, tmp_167506);
                                bool y_167508 = slt64(tmp_167506, dz2081U_143052);
                                bool bounds_check_167509 = x_167507 && y_167508;
                                bool index_certs_167510;
                                
                                if (!bounds_check_167509) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167506, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_167511 = ((int64_t *) bounds_mem_171276.mem)[tmp_167506];
                                bool x_167512 = sle64((int64_t) 0, tmp_167511);
                                bool y_167513 = slt64(tmp_167511, nS_143051);
                                bool bounds_check_167514 = x_167512 && y_167513;
                                bool index_certs_167515;
                                
                                if (!bounds_check_167514) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167511, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:893:4-900:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-987:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t next_S_f_res_167516 = ((int16_t *) mem_171399)[tmp_167511];
                                
                                next_S_167505 = next_S_f_res_167516;
                            }
                            
                            int32_t prim_get_radix_arg0_167517 = mul32(radix_sizze_143054, cur_depth_167470);
                            int64_t unsign_arg0_167518 = zext_i32_i64(prim_get_radix_arg0_167517);
                            int64_t asPow_167519 = shl64((int64_t) 1, unsign_arg0_167518);
                            int64_t u64_arg0_167520 = sub64(asPow_167519, (int64_t) 1);
                            int16_t u64_res_167521 = zext_i64_i16(u64_arg0_167520);
                            int16_t lifted_lambda_res_167522 = defunc_0_byteSeq_to_prim_res_167428 & u64_res_167521;
                            int16_t lifted_lambda_res_167523 = cur_S_167492 & u64_res_167521;
                            bool defunc_0_eq_res_167524 = lifted_lambda_res_167522 == lifted_lambda_res_167523;
                            int64_t loopres_167525;
                            int64_t loopres_167526;
                            
                            if (defunc_0_eq_res_167524) {
                                loopres_167525 = heshi_167464;
                                loopres_167526 = (int64_t) 0;
                            } else {
                                bool loop_cond_t_res_167527 = slt32(0, cur_depth_167470);
                                bool is_lt_167528;
                                bool is_lt_167529;
                                int32_t is_lt_167530;
                                bool loop_while_167531;
                                bool def_lt_167532;
                                int32_t bi_167533;
                                
                                loop_while_167531 = loop_cond_t_res_167527;
                                def_lt_167532 = 0;
                                bi_167533 = 0;
                                while (loop_while_167531) {
                                    int32_t zt_rhs_167534 = add32(1, bi_167533);
                                    int32_t prim_get_radix_arg0_167535 = mul32(radix_sizze_143054, zt_rhs_167534);
                                    int64_t unsign_arg0_167536 = zext_i32_i64(prim_get_radix_arg0_167535);
                                    int64_t asPow_167537 = shl64((int64_t) 1, unsign_arg0_167536);
                                    int64_t u64_arg0_167538 = sub64(asPow_167537, (int64_t) 1);
                                    int16_t u64_res_167539 = zext_i64_i16(u64_arg0_167538);
                                    int16_t lifted_lambda_res_167540 = defunc_0_byteSeq_to_prim_res_167428 & u64_res_167539;
                                    int16_t lifted_lambda_res_167541 = cur_S_167492 & u64_res_167539;
                                    bool defunc_0_lt_res_167542 = ult16(lifted_lambda_res_167540, lifted_lambda_res_167541);
                                    bool defunc_0_lt_res_167543 = ult16(lifted_lambda_res_167541, lifted_lambda_res_167540);
                                    bool cond_167544 = !defunc_0_lt_res_167543;
                                    bool cond_t_res_167545 = !defunc_0_lt_res_167542;
                                    bool x_167546 = cond_167544 && cond_t_res_167545;
                                    bool loop_cond_t_res_167547 = slt32(zt_rhs_167534, cur_depth_167470);
                                    bool x_167548 = x_167546 && loop_cond_t_res_167547;
                                    bool loop_while_tmp_171997 = x_167548;
                                    bool def_lt_tmp_171998 = defunc_0_lt_res_167542;
                                    int32_t bi_tmp_171999 = zt_rhs_167534;
                                    
                                    loop_while_167531 = loop_while_tmp_171997;
                                    def_lt_167532 = def_lt_tmp_171998;
                                    bi_167533 = bi_tmp_171999;
                                }
                                is_lt_167528 = loop_while_167531;
                                is_lt_167529 = def_lt_167532;
                                is_lt_167530 = bi_167533;
                                
                                int64_t loopres_f_res_167549;
                                int64_t loopres_f_res_167550;
                                
                                if (is_lt_167529) {
                                    bool loop_cond_t_res_167551 = slt32(0, prev_depth_167472);
                                    bool is_gt_167552;
                                    bool is_gt_167553;
                                    int32_t is_gt_167554;
                                    bool loop_while_167555;
                                    bool def_gt_167556;
                                    int32_t bi_167557;
                                    
                                    loop_while_167555 = loop_cond_t_res_167551;
                                    def_gt_167556 = 0;
                                    bi_167557 = 0;
                                    while (loop_while_167555) {
                                        int32_t zt_rhs_167558 = add32(1, bi_167557);
                                        int32_t prim_get_radix_arg0_167559 = mul32(radix_sizze_143054, zt_rhs_167558);
                                        int64_t unsign_arg0_167560 = zext_i32_i64(prim_get_radix_arg0_167559);
                                        int64_t asPow_167561 = shl64((int64_t) 1, unsign_arg0_167560);
                                        int64_t u64_arg0_167562 = sub64(asPow_167561, (int64_t) 1);
                                        int16_t u64_res_167563 = zext_i64_i16(u64_arg0_167562);
                                        int16_t lifted_lambda_res_167564 = defunc_0_byteSeq_to_prim_res_167428 & u64_res_167563;
                                        int16_t lifted_lambda_res_167565 = prev_S_167493 & u64_res_167563;
                                        bool defunc_0_gt_res_167566 = ult16(lifted_lambda_res_167565, lifted_lambda_res_167564);
                                        bool defunc_0_gt_res_167567 = ult16(lifted_lambda_res_167564, lifted_lambda_res_167565);
                                        bool cond_167568 = !defunc_0_gt_res_167566;
                                        bool cond_t_res_167569 = !defunc_0_gt_res_167567;
                                        bool x_167570 = cond_167568 && cond_t_res_167569;
                                        bool loop_cond_t_res_167571 = slt32(zt_rhs_167558, prev_depth_167472);
                                        bool x_167572 = x_167570 && loop_cond_t_res_167571;
                                        bool loop_while_tmp_172000 = x_167572;
                                        bool def_gt_tmp_172001 = defunc_0_gt_res_167566;
                                        int32_t bi_tmp_172002 = zt_rhs_167558;
                                        
                                        loop_while_167555 = loop_while_tmp_172000;
                                        def_gt_167556 = def_gt_tmp_172001;
                                        bi_167557 = bi_tmp_172002;
                                    }
                                    is_gt_167552 = loop_while_167555;
                                    is_gt_167553 = def_gt_167556;
                                    is_gt_167554 = bi_167557;
                                    
                                    bool x_167573 = !cond_167471;
                                    bool y_167574 = is_gt_167553 && x_167573;
                                    bool cond_167575 = cond_167471 || y_167574;
                                    int64_t loopres_f_res_t_res_167576;
                                    int64_t loopres_f_res_t_res_167577;
                                    
                                    if (cond_167575) {
                                        loopres_f_res_t_res_167576 = (int64_t) -1;
                                        loopres_f_res_t_res_167577 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_167578 = sub64(heshi_167464, step_167465);
                                        int64_t max_arg1_167579 = sdiv64(step_167465, (int64_t) 2);
                                        int64_t max_res_167580 = smax64((int64_t) 1, max_arg1_167579);
                                        
                                        loopres_f_res_t_res_167576 = tmp_167578;
                                        loopres_f_res_t_res_167577 = max_res_167580;
                                    }
                                    loopres_f_res_167549 = loopres_f_res_t_res_167576;
                                    loopres_f_res_167550 = loopres_f_res_t_res_167577;
                                } else {
                                    bool loop_cond_t_res_167581 = slt32(0, next_depth_167480);
                                    bool is_lt_167582;
                                    bool is_lt_167583;
                                    int32_t is_lt_167584;
                                    bool loop_while_167585;
                                    bool def_lt_167586;
                                    int32_t bi_167587;
                                    
                                    loop_while_167585 = loop_cond_t_res_167581;
                                    def_lt_167586 = 0;
                                    bi_167587 = 0;
                                    while (loop_while_167585) {
                                        int32_t zt_rhs_167588 = add32(1, bi_167587);
                                        int32_t prim_get_radix_arg0_167589 = mul32(radix_sizze_143054, zt_rhs_167588);
                                        int64_t unsign_arg0_167590 = zext_i32_i64(prim_get_radix_arg0_167589);
                                        int64_t asPow_167591 = shl64((int64_t) 1, unsign_arg0_167590);
                                        int64_t u64_arg0_167592 = sub64(asPow_167591, (int64_t) 1);
                                        int16_t u64_res_167593 = zext_i64_i16(u64_arg0_167592);
                                        int16_t lifted_lambda_res_167594 = defunc_0_byteSeq_to_prim_res_167428 & u64_res_167593;
                                        int16_t lifted_lambda_res_167595 = next_S_167505 & u64_res_167593;
                                        bool defunc_0_lt_res_167596 = ult16(lifted_lambda_res_167594, lifted_lambda_res_167595);
                                        bool defunc_0_lt_res_167597 = ult16(lifted_lambda_res_167595, lifted_lambda_res_167594);
                                        bool cond_167598 = !defunc_0_lt_res_167597;
                                        bool cond_t_res_167599 = !defunc_0_lt_res_167596;
                                        bool x_167600 = cond_167598 && cond_t_res_167599;
                                        bool loop_cond_t_res_167601 = slt32(zt_rhs_167588, next_depth_167480);
                                        bool x_167602 = x_167600 && loop_cond_t_res_167601;
                                        bool loop_while_tmp_172003 = x_167602;
                                        bool def_lt_tmp_172004 = defunc_0_lt_res_167596;
                                        int32_t bi_tmp_172005 = zt_rhs_167588;
                                        
                                        loop_while_167585 = loop_while_tmp_172003;
                                        def_lt_167586 = def_lt_tmp_172004;
                                        bi_167587 = bi_tmp_172005;
                                    }
                                    is_lt_167582 = loop_while_167585;
                                    is_lt_167583 = def_lt_167586;
                                    is_lt_167584 = bi_167587;
                                    
                                    bool x_167603 = !cond_167479;
                                    bool y_167604 = is_lt_167583 && x_167603;
                                    bool cond_167605 = cond_167479 || y_167604;
                                    int64_t loopres_f_res_f_res_167606;
                                    int64_t loopres_f_res_f_res_167607;
                                    
                                    if (cond_167605) {
                                        loopres_f_res_f_res_167606 = (int64_t) -1;
                                        loopres_f_res_f_res_167607 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_167608 = add64(heshi_167464, step_167465);
                                        int64_t max_arg1_167609 = sdiv64(step_167465, (int64_t) 2);
                                        int64_t max_res_167610 = smax64((int64_t) 1, max_arg1_167609);
                                        
                                        loopres_f_res_f_res_167606 = tmp_167608;
                                        loopres_f_res_f_res_167607 = max_res_167610;
                                    }
                                    loopres_f_res_167549 = loopres_f_res_f_res_167606;
                                    loopres_f_res_167550 = loopres_f_res_f_res_167607;
                                }
                                loopres_167525 = loopres_f_res_167549;
                                loopres_167526 = loopres_f_res_167550;
                            }
                            
                            bool loop_cond_167611 = slt64((int64_t) 0, loopres_167526);
                            bool loop_while_tmp_171994 = loop_cond_167611;
                            int64_t heshi_tmp_171995 = loopres_167525;
                            int64_t step_tmp_171996 = loopres_167526;
                            
                            loop_while_167463 = loop_while_tmp_171994;
                            heshi_167464 = heshi_tmp_171995;
                            step_167465 = step_tmp_171996;
                        }
                        bsearch_167460 = loop_while_167463;
                        bsearch_167461 = heshi_167464;
                        bsearch_167462 = step_167465;
                        defunc_res_f_res_167455 = bsearch_167461;
                    }
                    defunc_res_167452 = defunc_res_f_res_167455;
                }
                
                bool cond_167612 = sle64(defunc_res_167452, (int64_t) 0);
                int64_t inf_167613;
                
                if (cond_167612) {
                    inf_167613 = (int64_t) 0;
                } else {
                    bool x_167614 = sle64((int64_t) 0, defunc_res_167452);
                    bool y_167615 = slt64(defunc_res_167452, dz2081U_143052);
                    bool bounds_check_167616 = x_167614 && y_167615;
                    bool index_certs_167617;
                    
                    if (!bounds_check_167616) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167452, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:901:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-987:76\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t inf_f_res_167618 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_167452];
                    
                    inf_167613 = inf_f_res_167618;
                }
                
                bool cond_167619 = defunc_res_167452 == zeze_rhs_158708;
                int64_t sup_167620;
                
                if (cond_167619) {
                    sup_167620 = nS_143051;
                } else {
                    int64_t tmp_167621 = add64((int64_t) 1, defunc_res_167452);
                    bool x_167622 = sle64((int64_t) 0, tmp_167621);
                    bool y_167623 = slt64(tmp_167621, dz2081U_143052);
                    bool bounds_check_167624 = x_167622 && y_167623;
                    bool index_certs_167625;
                    
                    if (!bounds_check_167624) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167621, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:902:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-987:76\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t sup_f_res_167626 = ((int64_t *) bounds_mem_171276.mem)[tmp_167621];
                    
                    sup_167620 = sup_f_res_167626;
                }
                
                bool cond_167627 = slt64(inf_167613, sup_167620);
                bool sm_167628;
                int64_t sm_167629;
                bool loop_while_167630;
                int64_t j_167631;
                
                loop_while_167630 = cond_167627;
                j_167631 = inf_167613;
                while (loop_while_167630) {
                    bool x_167632 = sle64((int64_t) 0, j_167631);
                    bool y_167633 = slt64(j_167631, nS_143051);
                    bool bounds_check_167634 = x_167632 && y_167633;
                    bool index_certs_167635;
                    
                    if (!bounds_check_167634) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_167631, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:905:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-987:76\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t zeze_rhs_167636 = ((int16_t *) mem_171399)[j_167631];
                    bool is_eq_167637 = defunc_0_byteSeq_to_prim_res_167428 == zeze_rhs_167636;
                    int64_t loopres_167638;
                    
                    if (is_eq_167637) {
                        loopres_167638 = j_167631;
                    } else {
                        int64_t tmp_167639 = add64((int64_t) 1, j_167631);
                        
                        loopres_167638 = tmp_167639;
                    }
                    
                    bool cond_167640 = slt64(loopres_167638, sup_167620);
                    bool loop_cond_t_res_167641 = !is_eq_167637;
                    bool x_167642 = cond_167640 && loop_cond_t_res_167641;
                    bool loop_while_tmp_172006 = x_167642;
                    int64_t j_tmp_172007 = loopres_167638;
                    
                    loop_while_167630 = loop_while_tmp_172006;
                    j_167631 = j_tmp_172007;
                }
                sm_167628 = loop_while_167630;
                sm_167629 = j_167631;
                
                bool cond_167643 = slt64(sm_167629, sup_167620);
                int64_t lifted_lambda_res_167644;
                
                if (cond_167643) {
                    lifted_lambda_res_167644 = sm_167629;
                } else {
                    lifted_lambda_res_167644 = (int64_t) -1;
                }
                
                bool lifted_lambda_res_167645 = sle64((int64_t) 0, lifted_lambda_res_167644);
                int64_t bool_res_167646 = btoi_bool_i64(lifted_lambda_res_167645);
                int64_t defunc_0_op_res_167651 = add64(bool_res_167646, scanacc_171032);
                int64_t zp_res_167654 = add64(bool_res_167646, redout_171034);
                
                ((int64_t *) mem_171407)[i_171036] = defunc_0_op_res_167651;
                ((int64_t *) mem_171409)[i_171036] = lifted_lambda_res_167644;
                
                int64_t scanacc_tmp_171989 = defunc_0_op_res_167651;
                int64_t redout_tmp_171991 = zp_res_167654;
                
                scanacc_171032 = scanacc_tmp_171989;
                redout_171034 = redout_tmp_171991;
            }
            discard_171039 = scanacc_171032;
            defunc_res_167425 = redout_171034;
            
            int64_t bytes_171422 = (int64_t) 8 * defunc_res_167425;
            int64_t bytes_171439 = b_143050 * defunc_res_167425;
            
            if (memblock_alloc(ctx, &mem_171423, bytes_171422, "mem_171423")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172008 = 0; nest_i_172008 < defunc_res_167425; nest_i_172008++) {
                ((int64_t *) mem_171423.mem)[nest_i_172008] = (int64_t) -1;
            }
            if (memblock_alloc(ctx, &mem_171425, bytes_171422, "mem_171425")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172009 = 0; nest_i_172009 < defunc_res_167425; nest_i_172009++) {
                ((int64_t *) mem_171425.mem)[nest_i_172009] = (int64_t) -1;
            }
            for (int64_t write_iter_171040 = 0; write_iter_171040 < nR_143049; write_iter_171040++) {
                int64_t write_iv_171044 = ((int64_t *) mem_171409)[write_iter_171040];
                int64_t zv_lhs_167671 = add64((int64_t) -1, write_iter_171040);
                int64_t tmp_167672 = smod64(zv_lhs_167671, nR_143049);
                int64_t lifted_lambda_res_167673 = ((int64_t *) mem_171407)[tmp_167672];
                bool cond_167674 = write_iter_171040 == (int64_t) 0;
                int64_t lifted_lambda_res_167675;
                
                if (cond_167674) {
                    lifted_lambda_res_167675 = (int64_t) 0;
                } else {
                    lifted_lambda_res_167675 = lifted_lambda_res_167673;
                }
                
                bool cond_167676 = sle64((int64_t) 0, write_iv_171044);
                int64_t lifted_lambda_res_167677;
                
                if (cond_167676) {
                    lifted_lambda_res_167677 = lifted_lambda_res_167675;
                } else {
                    lifted_lambda_res_167677 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_167677) && slt64(lifted_lambda_res_167677, defunc_res_167425)) {
                    ((int64_t *) mem_171423.mem)[lifted_lambda_res_167677] = write_iv_171044;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_167677) && slt64(lifted_lambda_res_167677, defunc_res_167425)) {
                    ((int64_t *) mem_171425.mem)[lifted_lambda_res_167677] = write_iter_171040;
                }
            }
            if (memblock_alloc(ctx, &mem_171438, b_143050, "mem_171438")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172012 = 0; nest_i_172012 < b_143050; nest_i_172012++) {
                ((int8_t *) mem_171438.mem)[nest_i_172012] = (int8_t) 0;
            }
            if (memblock_alloc(ctx, &mem_171440, bytes_171439, "mem_171440")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171049 = 0; i_171049 < defunc_res_167425; i_171049++) {
                int64_t eta_p_167686 = ((int64_t *) mem_171425.mem)[i_171049];
                bool cond_167687 = sle64((int64_t) 0, eta_p_167686);
                bool cond_t_res_167688 = slt64(eta_p_167686, nR_143049);
                bool x_167689 = cond_167687 && cond_t_res_167688;
                int64_t lmad_ext_171445 = b_143050 * eta_p_167686;
                int64_t ext_171446;
                
                if (x_167689) {
                    ext_171446 = lmad_ext_171445;
                } else {
                    ext_171446 = (int64_t) 0;
                }
                if (x_167689) {
                    bool index_certs_167691;
                    
                    if (!x_167689) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_167686, "] out of bounds for array of shape [", (long long) nR_143049, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    if (memblock_set(ctx, &ext_mem_171447, &pR_mem_171274, "pR_mem_171274") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_171447, &mem_171438, "mem_171438") != 0)
                    return 1;
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171440.mem, i_171049 * b_143050, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171447.mem, ext_171446, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143050});
                if (memblock_unref(ctx, &ext_mem_171447, "ext_mem_171447") != 0)
                    return 1;
            }
            if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171461, &mem_171425, "mem_171425") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171458, &mem_171423, "mem_171423") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171455, &mem_171440, "mem_171440") != 0)
                return 1;
            radix_hash_join_with_S_keys_unique_res_f_res_158972 = defunc_res_167425;
            radix_hash_join_with_S_keys_unique_res_f_res_158973 = defunc_res_167425;
            radix_hash_join_with_S_keys_unique_res_f_res_158974 = defunc_res_167425;
        } else {
            int64_t radix_hash_join_with_S_keys_unique_res_f_res_f_res_159231;
            
            if (cond_158704) {
                if (mem_171335_cached_sizze_172195 < bytes_171334) {
                    err = lexical_realloc(ctx, &mem_171335, &mem_171335_cached_sizze_172195, bytes_171334);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171053 = 0; i_171053 < nS_143051; i_171053++) {
                    int32_t defunc_0_byteSeq_to_prim_res_167737;
                    int32_t y_167739 = 0;
                    
                    for (int64_t i_167738 = 0; i_167738 < b_143050; i_167738++) {
                        int64_t zm_lhs_167740 = sub64(b_143050, i_167738);
                        int64_t from_u8_arg0_167741 = sub64(zm_lhs_167740, (int64_t) 1);
                        bool x_167742 = sle64((int64_t) 0, from_u8_arg0_167741);
                        bool y_167743 = slt64(from_u8_arg0_167741, b_143050);
                        bool bounds_check_167744 = x_167742 && y_167743;
                        bool index_certs_167745;
                        
                        if (!bounds_check_167744) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167741, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:427:75-82\n   #2  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_167746 = ((int8_t *) pS_mem_171275.mem)[i_171053 * b_143050 + from_u8_arg0_167741];
                        int32_t u8_res_167747 = zext_i8_i32(from_u8_arg0_167746);
                        int32_t i64_res_167748 = sext_i64_i32(i_167738);
                        int32_t shift_left_rhs_167749 = mul32(8, i64_res_167748);
                        int32_t lifted_lambda_res_167750 = shl32(u8_res_167747, shift_left_rhs_167749);
                        int32_t unsign_arg0_167751 = y_167739 | lifted_lambda_res_167750;
                        int32_t y_tmp_172015 = unsign_arg0_167751;
                        
                        y_167739 = y_tmp_172015;
                    }
                    defunc_0_byteSeq_to_prim_res_167737 = y_167739;
                    ((int32_t *) mem_171335)[i_171053] = defunc_0_byteSeq_to_prim_res_167737;
                }
                if (mem_171343_cached_sizze_172196 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171343, &mem_171343_cached_sizze_172196, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171345_cached_sizze_172197 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171345, &mem_171345_cached_sizze_172197, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171064;
                int64_t defunc_res_167757;
                int64_t scanacc_171057;
                int64_t redout_171059;
                
                scanacc_171057 = (int64_t) 0;
                redout_171059 = (int64_t) 0;
                for (int64_t i_171061 = 0; i_171061 < nR_143049; i_171061++) {
                    int32_t defunc_0_byteSeq_to_prim_res_167760;
                    int32_t y_167762 = 0;
                    
                    for (int64_t i_167761 = 0; i_167761 < b_143050; i_167761++) {
                        int64_t zm_lhs_167763 = sub64(b_143050, i_167761);
                        int64_t from_u8_arg0_167764 = sub64(zm_lhs_167763, (int64_t) 1);
                        bool x_167765 = sle64((int64_t) 0, from_u8_arg0_167764);
                        bool y_167766 = slt64(from_u8_arg0_167764, b_143050);
                        bool bounds_check_167767 = x_167765 && y_167766;
                        bool index_certs_167768;
                        
                        if (!bounds_check_167767) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167764, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:427:75-82\n   #2  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_167769 = ((int8_t *) pR_mem_171274.mem)[i_171061 * b_143050 + from_u8_arg0_167764];
                        int32_t u8_res_167770 = zext_i8_i32(from_u8_arg0_167769);
                        int32_t i64_res_167771 = sext_i64_i32(i_167761);
                        int32_t shift_left_rhs_167772 = mul32(8, i64_res_167771);
                        int32_t lifted_lambda_res_167773 = shl32(u8_res_167770, shift_left_rhs_167772);
                        int32_t unsign_arg0_167774 = y_167762 | lifted_lambda_res_167773;
                        int32_t y_tmp_172020 = unsign_arg0_167774;
                        
                        y_167762 = y_tmp_172020;
                    }
                    defunc_0_byteSeq_to_prim_res_167760 = y_167762;
                    
                    int32_t lifted_lambda_res_167775 = za_rhs_158710 & defunc_0_byteSeq_to_prim_res_167760;
                    int64_t u32_res_167776 = zext_i32_i64(lifted_lambda_res_167775);
                    bool x_167777 = sle64((int64_t) 0, u32_res_167776);
                    bool y_167778 = slt64(u32_res_167776, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053);
                    bool bounds_check_167779 = x_167777 && y_167778;
                    bool index_certs_167780;
                    
                    if (!bounds_check_167779) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u32_res_167776, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_167781 = ((int64_t *) first_info_idx_mem_171278.mem)[u32_res_167776];
                    bool cond_167782 = slt64(spi_167781, (int64_t) 0);
                    int64_t defunc_res_167783;
                    
                    if (cond_167782) {
                        defunc_res_167783 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_167784 = ((int64_t *) last_info_idx_mem_171279.mem)[u32_res_167776];
                        bool cond_167785 = spi_167781 == zeze_rhs_167784;
                        int64_t defunc_res_f_res_167786;
                        
                        if (cond_167785) {
                            defunc_res_f_res_167786 = spi_167781;
                        } else {
                            int64_t zs_lhs_167787 = sub64(zeze_rhs_167784, spi_167781);
                            int64_t max_arg1_167788 = sdiv64(zs_lhs_167787, (int64_t) 2);
                            int64_t max_res_167789 = smax64((int64_t) 1, max_arg1_167788);
                            bool loop_cond_167790 = slt64((int64_t) 0, max_res_167789);
                            bool bsearch_167791;
                            int64_t bsearch_167792;
                            int64_t bsearch_167793;
                            bool loop_while_167794;
                            int64_t heshi_167795;
                            int64_t step_167796;
                            
                            loop_while_167794 = loop_cond_167790;
                            heshi_167795 = spi_167781;
                            step_167796 = max_res_167789;
                            while (loop_while_167794) {
                                bool x_167797 = sle64((int64_t) 0, heshi_167795);
                                bool y_167798 = slt64(heshi_167795, dz2081U_143052);
                                bool bounds_check_167799 = x_167797 && y_167798;
                                bool index_certs_167800;
                                
                                if (!bounds_check_167799) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_167795, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_167818 = ((int64_t *) bounds_mem_171276.mem)[heshi_167795];
                                bool x_167819 = sle64((int64_t) 0, cur_S_167818);
                                bool y_167820 = slt64(cur_S_167818, nS_143051);
                                bool bounds_check_167821 = x_167819 && y_167820;
                                bool index_certs_167822;
                                
                                if (!bounds_check_167821) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_167818, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_167801 = ((int32_t *) depths_mem_171277.mem)[heshi_167795];
                                bool cond_167802 = heshi_167795 == spi_167781;
                                int32_t prev_depth_167803;
                                
                                if (cond_167802) {
                                    prev_depth_167803 = cur_depth_167801;
                                } else {
                                    int64_t tmp_167804 = sub64(heshi_167795, (int64_t) 1);
                                    bool x_167805 = sle64((int64_t) 0, tmp_167804);
                                    bool y_167806 = slt64(tmp_167804, dz2081U_143052);
                                    bool bounds_check_167807 = x_167805 && y_167806;
                                    bool index_certs_167808;
                                    
                                    if (!bounds_check_167807) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167804, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_167809 = ((int32_t *) depths_mem_171277.mem)[tmp_167804];
                                    
                                    prev_depth_167803 = prev_depth_f_res_167809;
                                }
                                
                                bool cond_167810 = heshi_167795 == zeze_rhs_167784;
                                int32_t next_depth_167811;
                                
                                if (cond_167810) {
                                    next_depth_167811 = cur_depth_167801;
                                } else {
                                    int64_t tmp_167812 = add64((int64_t) 1, heshi_167795);
                                    bool x_167813 = sle64((int64_t) 0, tmp_167812);
                                    bool y_167814 = slt64(tmp_167812, dz2081U_143052);
                                    bool bounds_check_167815 = x_167813 && y_167814;
                                    bool index_certs_167816;
                                    
                                    if (!bounds_check_167815) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167812, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_167817 = ((int32_t *) depths_mem_171277.mem)[tmp_167812];
                                    
                                    next_depth_167811 = next_depth_f_res_167817;
                                }
                                
                                int32_t cur_S_167823 = ((int32_t *) mem_171335)[cur_S_167818];
                                int32_t prev_S_167824;
                                
                                if (cond_167802) {
                                    prev_S_167824 = cur_S_167823;
                                } else {
                                    int64_t tmp_167825 = sub64(heshi_167795, (int64_t) 1);
                                    bool x_167826 = sle64((int64_t) 0, tmp_167825);
                                    bool y_167827 = slt64(tmp_167825, dz2081U_143052);
                                    bool bounds_check_167828 = x_167826 && y_167827;
                                    bool index_certs_167829;
                                    
                                    if (!bounds_check_167828) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167825, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_167830 = ((int64_t *) bounds_mem_171276.mem)[tmp_167825];
                                    bool x_167831 = sle64((int64_t) 0, tmp_167830);
                                    bool y_167832 = slt64(tmp_167830, nS_143051);
                                    bool bounds_check_167833 = x_167831 && y_167832;
                                    bool index_certs_167834;
                                    
                                    if (!bounds_check_167833) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167830, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_S_f_res_167835 = ((int32_t *) mem_171335)[tmp_167830];
                                    
                                    prev_S_167824 = prev_S_f_res_167835;
                                }
                                
                                int32_t next_S_167836;
                                
                                if (cond_167810) {
                                    next_S_167836 = cur_S_167823;
                                } else {
                                    int64_t tmp_167837 = add64((int64_t) 1, heshi_167795);
                                    bool x_167838 = sle64((int64_t) 0, tmp_167837);
                                    bool y_167839 = slt64(tmp_167837, dz2081U_143052);
                                    bool bounds_check_167840 = x_167838 && y_167839;
                                    bool index_certs_167841;
                                    
                                    if (!bounds_check_167840) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167837, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_167842 = ((int64_t *) bounds_mem_171276.mem)[tmp_167837];
                                    bool x_167843 = sle64((int64_t) 0, tmp_167842);
                                    bool y_167844 = slt64(tmp_167842, nS_143051);
                                    bool bounds_check_167845 = x_167843 && y_167844;
                                    bool index_certs_167846;
                                    
                                    if (!bounds_check_167845) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167842, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:923:4-930:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-988:76\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_S_f_res_167847 = ((int32_t *) mem_171335)[tmp_167842];
                                    
                                    next_S_167836 = next_S_f_res_167847;
                                }
                                
                                int32_t prim_get_radix_arg0_167848 = mul32(radix_sizze_143054, cur_depth_167801);
                                int64_t unsign_arg0_167849 = zext_i32_i64(prim_get_radix_arg0_167848);
                                int64_t asPow_167850 = shl64((int64_t) 1, unsign_arg0_167849);
                                int64_t u64_arg0_167851 = sub64(asPow_167850, (int64_t) 1);
                                int32_t u64_res_167852 = zext_i64_i32(u64_arg0_167851);
                                int32_t lifted_lambda_res_167853 = defunc_0_byteSeq_to_prim_res_167760 & u64_res_167852;
                                int32_t lifted_lambda_res_167854 = cur_S_167823 & u64_res_167852;
                                bool defunc_0_eq_res_167855 = lifted_lambda_res_167853 == lifted_lambda_res_167854;
                                int64_t loopres_167856;
                                int64_t loopres_167857;
                                
                                if (defunc_0_eq_res_167855) {
                                    loopres_167856 = heshi_167795;
                                    loopres_167857 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_167858 = slt32(0, cur_depth_167801);
                                    bool is_lt_167859;
                                    bool is_lt_167860;
                                    int32_t is_lt_167861;
                                    bool loop_while_167862;
                                    bool def_lt_167863;
                                    int32_t bi_167864;
                                    
                                    loop_while_167862 = loop_cond_t_res_167858;
                                    def_lt_167863 = 0;
                                    bi_167864 = 0;
                                    while (loop_while_167862) {
                                        int32_t zt_rhs_167865 = add32(1, bi_167864);
                                        int32_t prim_get_radix_arg0_167866 = mul32(radix_sizze_143054, zt_rhs_167865);
                                        int64_t unsign_arg0_167867 = zext_i32_i64(prim_get_radix_arg0_167866);
                                        int64_t asPow_167868 = shl64((int64_t) 1, unsign_arg0_167867);
                                        int64_t u64_arg0_167869 = sub64(asPow_167868, (int64_t) 1);
                                        int32_t u64_res_167870 = zext_i64_i32(u64_arg0_167869);
                                        int32_t lifted_lambda_res_167871 = defunc_0_byteSeq_to_prim_res_167760 & u64_res_167870;
                                        int32_t lifted_lambda_res_167872 = cur_S_167823 & u64_res_167870;
                                        bool defunc_0_lt_res_167873 = ult32(lifted_lambda_res_167871, lifted_lambda_res_167872);
                                        bool defunc_0_lt_res_167874 = ult32(lifted_lambda_res_167872, lifted_lambda_res_167871);
                                        bool cond_167875 = !defunc_0_lt_res_167874;
                                        bool cond_t_res_167876 = !defunc_0_lt_res_167873;
                                        bool x_167877 = cond_167875 && cond_t_res_167876;
                                        bool loop_cond_t_res_167878 = slt32(zt_rhs_167865, cur_depth_167801);
                                        bool x_167879 = x_167877 && loop_cond_t_res_167878;
                                        bool loop_while_tmp_172024 = x_167879;
                                        bool def_lt_tmp_172025 = defunc_0_lt_res_167873;
                                        int32_t bi_tmp_172026 = zt_rhs_167865;
                                        
                                        loop_while_167862 = loop_while_tmp_172024;
                                        def_lt_167863 = def_lt_tmp_172025;
                                        bi_167864 = bi_tmp_172026;
                                    }
                                    is_lt_167859 = loop_while_167862;
                                    is_lt_167860 = def_lt_167863;
                                    is_lt_167861 = bi_167864;
                                    
                                    int64_t loopres_f_res_167880;
                                    int64_t loopres_f_res_167881;
                                    
                                    if (is_lt_167860) {
                                        bool loop_cond_t_res_167882 = slt32(0, prev_depth_167803);
                                        bool is_gt_167883;
                                        bool is_gt_167884;
                                        int32_t is_gt_167885;
                                        bool loop_while_167886;
                                        bool def_gt_167887;
                                        int32_t bi_167888;
                                        
                                        loop_while_167886 = loop_cond_t_res_167882;
                                        def_gt_167887 = 0;
                                        bi_167888 = 0;
                                        while (loop_while_167886) {
                                            int32_t zt_rhs_167889 = add32(1, bi_167888);
                                            int32_t prim_get_radix_arg0_167890 = mul32(radix_sizze_143054, zt_rhs_167889);
                                            int64_t unsign_arg0_167891 = zext_i32_i64(prim_get_radix_arg0_167890);
                                            int64_t asPow_167892 = shl64((int64_t) 1, unsign_arg0_167891);
                                            int64_t u64_arg0_167893 = sub64(asPow_167892, (int64_t) 1);
                                            int32_t u64_res_167894 = zext_i64_i32(u64_arg0_167893);
                                            int32_t lifted_lambda_res_167895 = defunc_0_byteSeq_to_prim_res_167760 & u64_res_167894;
                                            int32_t lifted_lambda_res_167896 = prev_S_167824 & u64_res_167894;
                                            bool defunc_0_gt_res_167897 = ult32(lifted_lambda_res_167896, lifted_lambda_res_167895);
                                            bool defunc_0_gt_res_167898 = ult32(lifted_lambda_res_167895, lifted_lambda_res_167896);
                                            bool cond_167899 = !defunc_0_gt_res_167897;
                                            bool cond_t_res_167900 = !defunc_0_gt_res_167898;
                                            bool x_167901 = cond_167899 && cond_t_res_167900;
                                            bool loop_cond_t_res_167902 = slt32(zt_rhs_167889, prev_depth_167803);
                                            bool x_167903 = x_167901 && loop_cond_t_res_167902;
                                            bool loop_while_tmp_172027 = x_167903;
                                            bool def_gt_tmp_172028 = defunc_0_gt_res_167897;
                                            int32_t bi_tmp_172029 = zt_rhs_167889;
                                            
                                            loop_while_167886 = loop_while_tmp_172027;
                                            def_gt_167887 = def_gt_tmp_172028;
                                            bi_167888 = bi_tmp_172029;
                                        }
                                        is_gt_167883 = loop_while_167886;
                                        is_gt_167884 = def_gt_167887;
                                        is_gt_167885 = bi_167888;
                                        
                                        bool x_167904 = !cond_167802;
                                        bool y_167905 = is_gt_167884 && x_167904;
                                        bool cond_167906 = cond_167802 || y_167905;
                                        int64_t loopres_f_res_t_res_167907;
                                        int64_t loopres_f_res_t_res_167908;
                                        
                                        if (cond_167906) {
                                            loopres_f_res_t_res_167907 = (int64_t) -1;
                                            loopres_f_res_t_res_167908 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_167909 = sub64(heshi_167795, step_167796);
                                            int64_t max_arg1_167910 = sdiv64(step_167796, (int64_t) 2);
                                            int64_t max_res_167911 = smax64((int64_t) 1, max_arg1_167910);
                                            
                                            loopres_f_res_t_res_167907 = tmp_167909;
                                            loopres_f_res_t_res_167908 = max_res_167911;
                                        }
                                        loopres_f_res_167880 = loopres_f_res_t_res_167907;
                                        loopres_f_res_167881 = loopres_f_res_t_res_167908;
                                    } else {
                                        bool loop_cond_t_res_167912 = slt32(0, next_depth_167811);
                                        bool is_lt_167913;
                                        bool is_lt_167914;
                                        int32_t is_lt_167915;
                                        bool loop_while_167916;
                                        bool def_lt_167917;
                                        int32_t bi_167918;
                                        
                                        loop_while_167916 = loop_cond_t_res_167912;
                                        def_lt_167917 = 0;
                                        bi_167918 = 0;
                                        while (loop_while_167916) {
                                            int32_t zt_rhs_167919 = add32(1, bi_167918);
                                            int32_t prim_get_radix_arg0_167920 = mul32(radix_sizze_143054, zt_rhs_167919);
                                            int64_t unsign_arg0_167921 = zext_i32_i64(prim_get_radix_arg0_167920);
                                            int64_t asPow_167922 = shl64((int64_t) 1, unsign_arg0_167921);
                                            int64_t u64_arg0_167923 = sub64(asPow_167922, (int64_t) 1);
                                            int32_t u64_res_167924 = zext_i64_i32(u64_arg0_167923);
                                            int32_t lifted_lambda_res_167925 = defunc_0_byteSeq_to_prim_res_167760 & u64_res_167924;
                                            int32_t lifted_lambda_res_167926 = next_S_167836 & u64_res_167924;
                                            bool defunc_0_lt_res_167927 = ult32(lifted_lambda_res_167925, lifted_lambda_res_167926);
                                            bool defunc_0_lt_res_167928 = ult32(lifted_lambda_res_167926, lifted_lambda_res_167925);
                                            bool cond_167929 = !defunc_0_lt_res_167928;
                                            bool cond_t_res_167930 = !defunc_0_lt_res_167927;
                                            bool x_167931 = cond_167929 && cond_t_res_167930;
                                            bool loop_cond_t_res_167932 = slt32(zt_rhs_167919, next_depth_167811);
                                            bool x_167933 = x_167931 && loop_cond_t_res_167932;
                                            bool loop_while_tmp_172030 = x_167933;
                                            bool def_lt_tmp_172031 = defunc_0_lt_res_167927;
                                            int32_t bi_tmp_172032 = zt_rhs_167919;
                                            
                                            loop_while_167916 = loop_while_tmp_172030;
                                            def_lt_167917 = def_lt_tmp_172031;
                                            bi_167918 = bi_tmp_172032;
                                        }
                                        is_lt_167913 = loop_while_167916;
                                        is_lt_167914 = def_lt_167917;
                                        is_lt_167915 = bi_167918;
                                        
                                        bool x_167934 = !cond_167810;
                                        bool y_167935 = is_lt_167914 && x_167934;
                                        bool cond_167936 = cond_167810 || y_167935;
                                        int64_t loopres_f_res_f_res_167937;
                                        int64_t loopres_f_res_f_res_167938;
                                        
                                        if (cond_167936) {
                                            loopres_f_res_f_res_167937 = (int64_t) -1;
                                            loopres_f_res_f_res_167938 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_167939 = add64(heshi_167795, step_167796);
                                            int64_t max_arg1_167940 = sdiv64(step_167796, (int64_t) 2);
                                            int64_t max_res_167941 = smax64((int64_t) 1, max_arg1_167940);
                                            
                                            loopres_f_res_f_res_167937 = tmp_167939;
                                            loopres_f_res_f_res_167938 = max_res_167941;
                                        }
                                        loopres_f_res_167880 = loopres_f_res_f_res_167937;
                                        loopres_f_res_167881 = loopres_f_res_f_res_167938;
                                    }
                                    loopres_167856 = loopres_f_res_167880;
                                    loopres_167857 = loopres_f_res_167881;
                                }
                                
                                bool loop_cond_167942 = slt64((int64_t) 0, loopres_167857);
                                bool loop_while_tmp_172021 = loop_cond_167942;
                                int64_t heshi_tmp_172022 = loopres_167856;
                                int64_t step_tmp_172023 = loopres_167857;
                                
                                loop_while_167794 = loop_while_tmp_172021;
                                heshi_167795 = heshi_tmp_172022;
                                step_167796 = step_tmp_172023;
                            }
                            bsearch_167791 = loop_while_167794;
                            bsearch_167792 = heshi_167795;
                            bsearch_167793 = step_167796;
                            defunc_res_f_res_167786 = bsearch_167792;
                        }
                        defunc_res_167783 = defunc_res_f_res_167786;
                    }
                    
                    bool cond_167943 = sle64(defunc_res_167783, (int64_t) 0);
                    int64_t inf_167944;
                    
                    if (cond_167943) {
                        inf_167944 = (int64_t) 0;
                    } else {
                        bool x_167945 = sle64((int64_t) 0, defunc_res_167783);
                        bool y_167946 = slt64(defunc_res_167783, dz2081U_143052);
                        bool bounds_check_167947 = x_167945 && y_167946;
                        bool index_certs_167948;
                        
                        if (!bounds_check_167947) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167783, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:931:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-988:76\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_167949 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_167783];
                        
                        inf_167944 = inf_f_res_167949;
                    }
                    
                    bool cond_167950 = defunc_res_167783 == zeze_rhs_158708;
                    int64_t sup_167951;
                    
                    if (cond_167950) {
                        sup_167951 = nS_143051;
                    } else {
                        int64_t tmp_167952 = add64((int64_t) 1, defunc_res_167783);
                        bool x_167953 = sle64((int64_t) 0, tmp_167952);
                        bool y_167954 = slt64(tmp_167952, dz2081U_143052);
                        bool bounds_check_167955 = x_167953 && y_167954;
                        bool index_certs_167956;
                        
                        if (!bounds_check_167955) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167952, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:932:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-988:76\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_167957 = ((int64_t *) bounds_mem_171276.mem)[tmp_167952];
                        
                        sup_167951 = sup_f_res_167957;
                    }
                    
                    bool cond_167958 = slt64(inf_167944, sup_167951);
                    bool sm_167959;
                    int64_t sm_167960;
                    bool loop_while_167961;
                    int64_t j_167962;
                    
                    loop_while_167961 = cond_167958;
                    j_167962 = inf_167944;
                    while (loop_while_167961) {
                        bool x_167963 = sle64((int64_t) 0, j_167962);
                        bool y_167964 = slt64(j_167962, nS_143051);
                        bool bounds_check_167965 = x_167963 && y_167964;
                        bool index_certs_167966;
                        
                        if (!bounds_check_167965) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_167962, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:935:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-988:76\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_rhs_167967 = ((int32_t *) mem_171335)[j_167962];
                        bool is_eq_167968 = defunc_0_byteSeq_to_prim_res_167760 == zeze_rhs_167967;
                        int64_t loopres_167969;
                        
                        if (is_eq_167968) {
                            loopres_167969 = j_167962;
                        } else {
                            int64_t tmp_167970 = add64((int64_t) 1, j_167962);
                            
                            loopres_167969 = tmp_167970;
                        }
                        
                        bool cond_167971 = slt64(loopres_167969, sup_167951);
                        bool loop_cond_t_res_167972 = !is_eq_167968;
                        bool x_167973 = cond_167971 && loop_cond_t_res_167972;
                        bool loop_while_tmp_172033 = x_167973;
                        int64_t j_tmp_172034 = loopres_167969;
                        
                        loop_while_167961 = loop_while_tmp_172033;
                        j_167962 = j_tmp_172034;
                    }
                    sm_167959 = loop_while_167961;
                    sm_167960 = j_167962;
                    
                    bool cond_167974 = slt64(sm_167960, sup_167951);
                    int64_t lifted_lambda_res_167975;
                    
                    if (cond_167974) {
                        lifted_lambda_res_167975 = sm_167960;
                    } else {
                        lifted_lambda_res_167975 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_167976 = sle64((int64_t) 0, lifted_lambda_res_167975);
                    int64_t bool_res_167977 = btoi_bool_i64(lifted_lambda_res_167976);
                    int64_t defunc_0_op_res_167982 = add64(bool_res_167977, scanacc_171057);
                    int64_t zp_res_167985 = add64(bool_res_167977, redout_171059);
                    
                    ((int64_t *) mem_171343)[i_171061] = defunc_0_op_res_167982;
                    ((int64_t *) mem_171345)[i_171061] = lifted_lambda_res_167975;
                    
                    int64_t scanacc_tmp_172016 = defunc_0_op_res_167982;
                    int64_t redout_tmp_172018 = zp_res_167985;
                    
                    scanacc_171057 = scanacc_tmp_172016;
                    redout_171059 = redout_tmp_172018;
                }
                discard_171064 = scanacc_171057;
                defunc_res_167757 = redout_171059;
                
                int64_t bytes_171358 = (int64_t) 8 * defunc_res_167757;
                int64_t bytes_171375 = b_143050 * defunc_res_167757;
                
                if (memblock_alloc(ctx, &mem_171359, bytes_171358, "mem_171359")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172035 = 0; nest_i_172035 < defunc_res_167757; nest_i_172035++) {
                    ((int64_t *) mem_171359.mem)[nest_i_172035] = (int64_t) -1;
                }
                if (memblock_alloc(ctx, &mem_171361, bytes_171358, "mem_171361")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172036 = 0; nest_i_172036 < defunc_res_167757; nest_i_172036++) {
                    ((int64_t *) mem_171361.mem)[nest_i_172036] = (int64_t) -1;
                }
                for (int64_t write_iter_171065 = 0; write_iter_171065 < nR_143049; write_iter_171065++) {
                    int64_t write_iv_171069 = ((int64_t *) mem_171345)[write_iter_171065];
                    int64_t zv_lhs_168005 = add64((int64_t) -1, write_iter_171065);
                    int64_t tmp_168006 = smod64(zv_lhs_168005, nR_143049);
                    int64_t lifted_lambda_res_168007 = ((int64_t *) mem_171343)[tmp_168006];
                    bool cond_168008 = write_iter_171065 == (int64_t) 0;
                    int64_t lifted_lambda_res_168009;
                    
                    if (cond_168008) {
                        lifted_lambda_res_168009 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_168009 = lifted_lambda_res_168007;
                    }
                    
                    bool cond_168010 = sle64((int64_t) 0, write_iv_171069);
                    int64_t lifted_lambda_res_168011;
                    
                    if (cond_168010) {
                        lifted_lambda_res_168011 = lifted_lambda_res_168009;
                    } else {
                        lifted_lambda_res_168011 = (int64_t) -1;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_168011) && slt64(lifted_lambda_res_168011, defunc_res_167757)) {
                        ((int64_t *) mem_171359.mem)[lifted_lambda_res_168011] = write_iv_171069;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_168011) && slt64(lifted_lambda_res_168011, defunc_res_167757)) {
                        ((int64_t *) mem_171361.mem)[lifted_lambda_res_168011] = write_iter_171065;
                    }
                }
                if (memblock_alloc(ctx, &mem_171374, b_143050, "mem_171374")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172039 = 0; nest_i_172039 < b_143050; nest_i_172039++) {
                    ((int8_t *) mem_171374.mem)[nest_i_172039] = (int8_t) 0;
                }
                if (memblock_alloc(ctx, &mem_171376, bytes_171375, "mem_171376")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171074 = 0; i_171074 < defunc_res_167757; i_171074++) {
                    int64_t eta_p_168022 = ((int64_t *) mem_171361.mem)[i_171074];
                    bool cond_168023 = sle64((int64_t) 0, eta_p_168022);
                    bool cond_t_res_168024 = slt64(eta_p_168022, nR_143049);
                    bool x_168025 = cond_168023 && cond_t_res_168024;
                    int64_t lmad_ext_171381 = b_143050 * eta_p_168022;
                    int64_t ext_171382;
                    
                    if (x_168025) {
                        ext_171382 = lmad_ext_171381;
                    } else {
                        ext_171382 = (int64_t) 0;
                    }
                    if (x_168025) {
                        bool index_certs_168027;
                        
                        if (!x_168025) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_168022, "] out of bounds for array of shape [", (long long) nR_143049, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (memblock_set(ctx, &ext_mem_171383, &pR_mem_171274, "pR_mem_171274") != 0)
                            return 1;
                    } else if (memblock_set(ctx, &ext_mem_171383, &mem_171374, "mem_171374") != 0)
                        return 1;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171376.mem, i_171074 * b_143050, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171383.mem, ext_171382, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143050});
                    if (memblock_unref(ctx, &ext_mem_171383, "ext_mem_171383") != 0)
                        return 1;
                }
                if (memblock_unref(ctx, &mem_171374, "mem_171374") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171397, &mem_171361, "mem_171361") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171394, &mem_171359, "mem_171359") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171391, &mem_171376, "mem_171376") != 0)
                    return 1;
                radix_hash_join_with_S_keys_unique_res_f_res_f_res_159231 = defunc_res_167757;
            } else {
                if (mem_171281_cached_sizze_172192 < bytes_171280) {
                    err = lexical_realloc(ctx, &mem_171281, &mem_171281_cached_sizze_172192, bytes_171280);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171078 = 0; i_171078 < nS_143051; i_171078++) {
                    int64_t defunc_0_byteSeq_to_prim_res_161906;
                    int64_t y_161908 = (int64_t) 0;
                    
                    for (int64_t i_161907 = 0; i_161907 < b_143050; i_161907++) {
                        int64_t zm_lhs_161909 = sub64(b_143050, i_161907);
                        int64_t from_u8_arg0_161910 = sub64(zm_lhs_161909, (int64_t) 1);
                        bool x_161911 = sle64((int64_t) 0, from_u8_arg0_161910);
                        bool y_161912 = slt64(from_u8_arg0_161910, b_143050);
                        bool bounds_check_161913 = x_161911 && y_161912;
                        bool index_certs_161914;
                        
                        if (!bounds_check_161913) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_161910, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:429:75-82\n   #2  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_161915 = ((int8_t *) pS_mem_171275.mem)[i_171078 * b_143050 + from_u8_arg0_161910];
                        int64_t u8_res_161916 = zext_i8_i64(from_u8_arg0_161915);
                        int32_t i64_res_161917 = sext_i64_i32(i_161907);
                        int32_t shift_left_rhs_161918 = mul32(8, i64_res_161917);
                        int64_t unsign_arg0_161919 = zext_i32_i64(shift_left_rhs_161918);
                        int64_t lifted_lambda_res_161920 = shl64(u8_res_161916, unsign_arg0_161919);
                        int64_t unsign_arg0_161921 = y_161908 | lifted_lambda_res_161920;
                        int64_t y_tmp_172042 = unsign_arg0_161921;
                        
                        y_161908 = y_tmp_172042;
                    }
                    defunc_0_byteSeq_to_prim_res_161906 = y_161908;
                    ((int64_t *) mem_171281)[i_171078] = defunc_0_byteSeq_to_prim_res_161906;
                }
                if (mem_171289_cached_sizze_172193 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171289, &mem_171289_cached_sizze_172193, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171291_cached_sizze_172194 < bytes_171288) {
                    err = lexical_realloc(ctx, &mem_171291, &mem_171291_cached_sizze_172194, bytes_171288);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171089;
                int64_t defunc_res_168066;
                int64_t scanacc_171082;
                int64_t redout_171084;
                
                scanacc_171082 = (int64_t) 0;
                redout_171084 = (int64_t) 0;
                for (int64_t i_171086 = 0; i_171086 < nR_143049; i_171086++) {
                    int64_t defunc_0_byteSeq_to_prim_res_165647;
                    int64_t y_165649 = (int64_t) 0;
                    
                    for (int64_t i_165648 = 0; i_165648 < b_143050; i_165648++) {
                        int64_t zm_lhs_165650 = sub64(b_143050, i_165648);
                        int64_t from_u8_arg0_165651 = sub64(zm_lhs_165650, (int64_t) 1);
                        bool x_165652 = sle64((int64_t) 0, from_u8_arg0_165651);
                        bool y_165653 = slt64(from_u8_arg0_165651, b_143050);
                        bool bounds_check_165654 = x_165652 && y_165653;
                        bool index_certs_165655;
                        
                        if (!bounds_check_165654) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_165651, "] out of bounds for array of shape [", (long long) b_143050, "].", "-> #0  ftHashJoin.fut:419:22-30\n   #1  ftHashJoin.fut:429:75-82\n   #2  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_165656 = ((int8_t *) pR_mem_171274.mem)[i_171086 * b_143050 + from_u8_arg0_165651];
                        int64_t u8_res_165657 = zext_i8_i64(from_u8_arg0_165656);
                        int32_t i64_res_165658 = sext_i64_i32(i_165648);
                        int32_t shift_left_rhs_165659 = mul32(8, i64_res_165658);
                        int64_t unsign_arg0_165660 = zext_i32_i64(shift_left_rhs_165659);
                        int64_t lifted_lambda_res_165661 = shl64(u8_res_165657, unsign_arg0_165660);
                        int64_t unsign_arg0_165662 = y_165649 | lifted_lambda_res_165661;
                        int64_t y_tmp_172047 = unsign_arg0_165662;
                        
                        y_165649 = y_tmp_172047;
                    }
                    defunc_0_byteSeq_to_prim_res_165647 = y_165649;
                    
                    int64_t lifted_lambda_res_165664 = u64_arg0_158707 & defunc_0_byteSeq_to_prim_res_165647;
                    bool x_165665 = sle64((int64_t) 0, lifted_lambda_res_165664);
                    bool y_165666 = slt64(lifted_lambda_res_165664, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053);
                    bool bounds_check_165667 = x_165665 && y_165666;
                    bool index_certs_165668;
                    
                    if (!bounds_check_165667) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_165664, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, "].", "-> #0  ftHashJoin.fut:532:13-35\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_165669 = ((int64_t *) first_info_idx_mem_171278.mem)[lifted_lambda_res_165664];
                    bool cond_165670 = slt64(spi_165669, (int64_t) 0);
                    int64_t defunc_res_165671;
                    
                    if (cond_165670) {
                        defunc_res_165671 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_165672 = ((int64_t *) last_info_idx_mem_171279.mem)[lifted_lambda_res_165664];
                        bool cond_165673 = spi_165669 == zeze_rhs_165672;
                        int64_t defunc_res_f_res_165674;
                        
                        if (cond_165673) {
                            defunc_res_f_res_165674 = spi_165669;
                        } else {
                            int64_t zs_lhs_165675 = sub64(zeze_rhs_165672, spi_165669);
                            int64_t max_arg1_165676 = sdiv64(zs_lhs_165675, (int64_t) 2);
                            int64_t max_res_165677 = smax64((int64_t) 1, max_arg1_165676);
                            bool loop_cond_165678 = slt64((int64_t) 0, max_res_165677);
                            bool bsearch_165679;
                            int64_t bsearch_165680;
                            int64_t bsearch_165681;
                            bool loop_while_165682;
                            int64_t heshi_165683;
                            int64_t step_165684;
                            
                            loop_while_165682 = loop_cond_165678;
                            heshi_165683 = spi_165669;
                            step_165684 = max_res_165677;
                            while (loop_while_165682) {
                                bool x_165685 = sle64((int64_t) 0, heshi_165683);
                                bool y_165686 = slt64(heshi_165683, dz2081U_143052);
                                bool bounds_check_165687 = x_165685 && y_165686;
                                bool index_certs_165688;
                                
                                if (!bounds_check_165687) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_165683, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:541:25-40\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_165706 = ((int64_t *) bounds_mem_171276.mem)[heshi_165683];
                                bool x_165707 = sle64((int64_t) 0, cur_S_165706);
                                bool y_165708 = slt64(cur_S_165706, nS_143051);
                                bool bounds_check_165709 = x_165707 && y_165708;
                                bool index_certs_165710;
                                
                                if (!bounds_check_165709) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_165706, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:544:21-40\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_165689 = ((int32_t *) depths_mem_171277.mem)[heshi_165683];
                                bool cond_165690 = heshi_165683 == spi_165669;
                                int32_t prev_depth_165691;
                                
                                if (cond_165690) {
                                    prev_depth_165691 = cur_depth_165689;
                                } else {
                                    int64_t tmp_165692 = sub64(heshi_165683, (int64_t) 1);
                                    bool x_165693 = sle64((int64_t) 0, tmp_165692);
                                    bool y_165694 = slt64(tmp_165692, dz2081U_143052);
                                    bool bounds_check_165695 = x_165693 && y_165694;
                                    bool index_certs_165696;
                                    
                                    if (!bounds_check_165695) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165692, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:542:60-77\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_165697 = ((int32_t *) depths_mem_171277.mem)[tmp_165692];
                                    
                                    prev_depth_165691 = prev_depth_f_res_165697;
                                }
                                
                                bool cond_165698 = heshi_165683 == zeze_rhs_165672;
                                int32_t next_depth_165699;
                                
                                if (cond_165698) {
                                    next_depth_165699 = cur_depth_165689;
                                } else {
                                    int64_t tmp_165700 = add64((int64_t) 1, heshi_165683);
                                    bool x_165701 = sle64((int64_t) 0, tmp_165700);
                                    bool y_165702 = slt64(tmp_165700, dz2081U_143052);
                                    bool bounds_check_165703 = x_165701 && y_165702;
                                    bool index_certs_165704;
                                    
                                    if (!bounds_check_165703) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165700, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:543:64-81\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_165705 = ((int32_t *) depths_mem_171277.mem)[tmp_165700];
                                    
                                    next_depth_165699 = next_depth_f_res_165705;
                                }
                                
                                int64_t cur_S_165711 = ((int64_t *) mem_171281)[cur_S_165706];
                                int64_t prev_S_165712;
                                
                                if (cond_165690) {
                                    prev_S_165712 = cur_S_165711;
                                } else {
                                    int64_t tmp_165713 = sub64(heshi_165683, (int64_t) 1);
                                    bool x_165714 = sle64((int64_t) 0, tmp_165713);
                                    bool y_165715 = slt64(tmp_165713, dz2081U_143052);
                                    bool bounds_check_165716 = x_165714 && y_165715;
                                    bool index_certs_165717;
                                    
                                    if (!bounds_check_165716) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165713, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:545:55-72\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_165718 = ((int64_t *) bounds_mem_171276.mem)[tmp_165713];
                                    bool x_165719 = sle64((int64_t) 0, tmp_165718);
                                    bool y_165720 = slt64(tmp_165718, nS_143051);
                                    bool bounds_check_165721 = x_165719 && y_165720;
                                    bool index_certs_165722;
                                    
                                    if (!bounds_check_165721) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165718, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:545:52-73\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t prev_S_f_res_165723 = ((int64_t *) mem_171281)[tmp_165718];
                                    
                                    prev_S_165712 = prev_S_f_res_165723;
                                }
                                
                                int64_t next_S_165724;
                                
                                if (cond_165698) {
                                    next_S_165724 = cur_S_165711;
                                } else {
                                    int64_t tmp_165725 = add64((int64_t) 1, heshi_165683);
                                    bool x_165726 = sle64((int64_t) 0, tmp_165725);
                                    bool y_165727 = slt64(tmp_165725, dz2081U_143052);
                                    bool bounds_check_165728 = x_165726 && y_165727;
                                    bool index_certs_165729;
                                    
                                    if (!bounds_check_165728) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165725, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:546:59-76\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_165730 = ((int64_t *) bounds_mem_171276.mem)[tmp_165725];
                                    bool x_165731 = sle64((int64_t) 0, tmp_165730);
                                    bool y_165732 = slt64(tmp_165730, nS_143051);
                                    bool bounds_check_165733 = x_165731 && y_165732;
                                    bool index_certs_165734;
                                    
                                    if (!bounds_check_165733) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165730, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:546:56-77\n   #1  ftHashJoin.fut:953:4-960:87\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:4-989:63\n   #4  ftRelational.fut:267:6-270:56\n   #5  ftRelational.fut:263:3-270:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t next_S_f_res_165735 = ((int64_t *) mem_171281)[tmp_165730];
                                    
                                    next_S_165724 = next_S_f_res_165735;
                                }
                                
                                int32_t prim_get_radix_arg0_165736 = mul32(radix_sizze_143054, cur_depth_165689);
                                int64_t unsign_arg0_165737 = zext_i32_i64(prim_get_radix_arg0_165736);
                                int64_t asPow_165738 = shl64((int64_t) 1, unsign_arg0_165737);
                                int64_t za_rhs_165739 = sub64(asPow_165738, (int64_t) 1);
                                int64_t lifted_lambda_res_165740 = defunc_0_byteSeq_to_prim_res_165647 & za_rhs_165739;
                                int64_t lifted_lambda_res_165741 = cur_S_165711 & za_rhs_165739;
                                bool defunc_0_eq_res_165742 = lifted_lambda_res_165740 == lifted_lambda_res_165741;
                                int64_t loopres_165743;
                                int64_t loopres_165744;
                                
                                if (defunc_0_eq_res_165742) {
                                    loopres_165743 = heshi_165683;
                                    loopres_165744 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_165745 = slt32(0, cur_depth_165689);
                                    bool is_lt_165746;
                                    bool is_lt_165747;
                                    int32_t is_lt_165748;
                                    bool loop_while_165749;
                                    bool def_lt_165750;
                                    int32_t bi_165751;
                                    
                                    loop_while_165749 = loop_cond_t_res_165745;
                                    def_lt_165750 = 0;
                                    bi_165751 = 0;
                                    while (loop_while_165749) {
                                        int32_t zt_rhs_165752 = add32(1, bi_165751);
                                        int32_t prim_get_radix_arg0_165753 = mul32(radix_sizze_143054, zt_rhs_165752);
                                        int64_t unsign_arg0_165754 = zext_i32_i64(prim_get_radix_arg0_165753);
                                        int64_t asPow_165755 = shl64((int64_t) 1, unsign_arg0_165754);
                                        int64_t za_rhs_165756 = sub64(asPow_165755, (int64_t) 1);
                                        int64_t lifted_lambda_res_165757 = defunc_0_byteSeq_to_prim_res_165647 & za_rhs_165756;
                                        int64_t lifted_lambda_res_165758 = cur_S_165711 & za_rhs_165756;
                                        bool defunc_0_lt_res_165759 = ult64(lifted_lambda_res_165757, lifted_lambda_res_165758);
                                        bool defunc_0_lt_res_165760 = ult64(lifted_lambda_res_165758, lifted_lambda_res_165757);
                                        bool cond_165761 = !defunc_0_lt_res_165760;
                                        bool cond_t_res_165762 = !defunc_0_lt_res_165759;
                                        bool x_165763 = cond_165761 && cond_t_res_165762;
                                        bool loop_cond_t_res_165764 = slt32(zt_rhs_165752, cur_depth_165689);
                                        bool x_165765 = x_165763 && loop_cond_t_res_165764;
                                        bool loop_while_tmp_172051 = x_165765;
                                        bool def_lt_tmp_172052 = defunc_0_lt_res_165759;
                                        int32_t bi_tmp_172053 = zt_rhs_165752;
                                        
                                        loop_while_165749 = loop_while_tmp_172051;
                                        def_lt_165750 = def_lt_tmp_172052;
                                        bi_165751 = bi_tmp_172053;
                                    }
                                    is_lt_165746 = loop_while_165749;
                                    is_lt_165747 = def_lt_165750;
                                    is_lt_165748 = bi_165751;
                                    
                                    int64_t loopres_f_res_165766;
                                    int64_t loopres_f_res_165767;
                                    
                                    if (is_lt_165747) {
                                        bool loop_cond_t_res_168033 = slt32(0, prev_depth_165691);
                                        bool is_gt_168034;
                                        bool is_gt_168035;
                                        int32_t is_gt_168036;
                                        bool loop_while_168037;
                                        bool def_gt_168038;
                                        int32_t bi_168039;
                                        
                                        loop_while_168037 = loop_cond_t_res_168033;
                                        def_gt_168038 = 0;
                                        bi_168039 = 0;
                                        while (loop_while_168037) {
                                            int32_t zt_rhs_168040 = add32(1, bi_168039);
                                            int32_t prim_get_radix_arg0_168041 = mul32(radix_sizze_143054, zt_rhs_168040);
                                            int64_t unsign_arg0_168042 = zext_i32_i64(prim_get_radix_arg0_168041);
                                            int64_t asPow_168043 = shl64((int64_t) 1, unsign_arg0_168042);
                                            int64_t za_rhs_168044 = sub64(asPow_168043, (int64_t) 1);
                                            int64_t lifted_lambda_res_168045 = defunc_0_byteSeq_to_prim_res_165647 & za_rhs_168044;
                                            int64_t lifted_lambda_res_168046 = prev_S_165712 & za_rhs_168044;
                                            bool defunc_0_gt_res_168047 = ult64(lifted_lambda_res_168046, lifted_lambda_res_168045);
                                            bool defunc_0_gt_res_168048 = ult64(lifted_lambda_res_168045, lifted_lambda_res_168046);
                                            bool cond_168049 = !defunc_0_gt_res_168047;
                                            bool cond_t_res_168050 = !defunc_0_gt_res_168048;
                                            bool x_168051 = cond_168049 && cond_t_res_168050;
                                            bool loop_cond_t_res_168052 = slt32(zt_rhs_168040, prev_depth_165691);
                                            bool x_168053 = x_168051 && loop_cond_t_res_168052;
                                            bool loop_while_tmp_172054 = x_168053;
                                            bool def_gt_tmp_172055 = defunc_0_gt_res_168047;
                                            int32_t bi_tmp_172056 = zt_rhs_168040;
                                            
                                            loop_while_168037 = loop_while_tmp_172054;
                                            def_gt_168038 = def_gt_tmp_172055;
                                            bi_168039 = bi_tmp_172056;
                                        }
                                        is_gt_168034 = loop_while_168037;
                                        is_gt_168035 = def_gt_168038;
                                        is_gt_168036 = bi_168039;
                                        
                                        bool x_168054 = !cond_165690;
                                        bool y_168055 = is_gt_168035 && x_168054;
                                        bool cond_168056 = cond_165690 || y_168055;
                                        int64_t loopres_f_res_t_res_168057;
                                        int64_t loopres_f_res_t_res_168058;
                                        
                                        if (cond_168056) {
                                            loopres_f_res_t_res_168057 = (int64_t) -1;
                                            loopres_f_res_t_res_168058 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_168059 = sub64(heshi_165683, step_165684);
                                            int64_t max_arg1_168060 = sdiv64(step_165684, (int64_t) 2);
                                            int64_t max_res_168061 = smax64((int64_t) 1, max_arg1_168060);
                                            
                                            loopres_f_res_t_res_168057 = tmp_168059;
                                            loopres_f_res_t_res_168058 = max_res_168061;
                                        }
                                        loopres_f_res_165766 = loopres_f_res_t_res_168057;
                                        loopres_f_res_165767 = loopres_f_res_t_res_168058;
                                    } else {
                                        bool loop_cond_t_res_165797 = slt32(0, next_depth_165699);
                                        bool is_lt_165798;
                                        bool is_lt_165799;
                                        int32_t is_lt_165800;
                                        bool loop_while_165801;
                                        bool def_lt_165802;
                                        int32_t bi_165803;
                                        
                                        loop_while_165801 = loop_cond_t_res_165797;
                                        def_lt_165802 = 0;
                                        bi_165803 = 0;
                                        while (loop_while_165801) {
                                            int32_t zt_rhs_165804 = add32(1, bi_165803);
                                            int32_t prim_get_radix_arg0_165805 = mul32(radix_sizze_143054, zt_rhs_165804);
                                            int64_t unsign_arg0_165806 = zext_i32_i64(prim_get_radix_arg0_165805);
                                            int64_t asPow_165807 = shl64((int64_t) 1, unsign_arg0_165806);
                                            int64_t za_rhs_165808 = sub64(asPow_165807, (int64_t) 1);
                                            int64_t lifted_lambda_res_165809 = defunc_0_byteSeq_to_prim_res_165647 & za_rhs_165808;
                                            int64_t lifted_lambda_res_165810 = next_S_165724 & za_rhs_165808;
                                            bool defunc_0_lt_res_165811 = ult64(lifted_lambda_res_165809, lifted_lambda_res_165810);
                                            bool defunc_0_lt_res_165812 = ult64(lifted_lambda_res_165810, lifted_lambda_res_165809);
                                            bool cond_165813 = !defunc_0_lt_res_165812;
                                            bool cond_t_res_165814 = !defunc_0_lt_res_165811;
                                            bool x_165815 = cond_165813 && cond_t_res_165814;
                                            bool loop_cond_t_res_165816 = slt32(zt_rhs_165804, next_depth_165699);
                                            bool x_165817 = x_165815 && loop_cond_t_res_165816;
                                            bool loop_while_tmp_172057 = x_165817;
                                            bool def_lt_tmp_172058 = defunc_0_lt_res_165811;
                                            int32_t bi_tmp_172059 = zt_rhs_165804;
                                            
                                            loop_while_165801 = loop_while_tmp_172057;
                                            def_lt_165802 = def_lt_tmp_172058;
                                            bi_165803 = bi_tmp_172059;
                                        }
                                        is_lt_165798 = loop_while_165801;
                                        is_lt_165799 = def_lt_165802;
                                        is_lt_165800 = bi_165803;
                                        
                                        bool x_165818 = !cond_165698;
                                        bool y_165819 = is_lt_165799 && x_165818;
                                        bool cond_165820 = cond_165698 || y_165819;
                                        int64_t loopres_f_res_f_res_165821;
                                        int64_t loopres_f_res_f_res_165822;
                                        
                                        if (cond_165820) {
                                            loopres_f_res_f_res_165821 = (int64_t) -1;
                                            loopres_f_res_f_res_165822 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_165823 = add64(heshi_165683, step_165684);
                                            int64_t max_arg1_165824 = sdiv64(step_165684, (int64_t) 2);
                                            int64_t max_res_165825 = smax64((int64_t) 1, max_arg1_165824);
                                            
                                            loopres_f_res_f_res_165821 = tmp_165823;
                                            loopres_f_res_f_res_165822 = max_res_165825;
                                        }
                                        loopres_f_res_165766 = loopres_f_res_f_res_165821;
                                        loopres_f_res_165767 = loopres_f_res_f_res_165822;
                                    }
                                    loopres_165743 = loopres_f_res_165766;
                                    loopres_165744 = loopres_f_res_165767;
                                }
                                
                                bool loop_cond_165826 = slt64((int64_t) 0, loopres_165744);
                                bool loop_while_tmp_172048 = loop_cond_165826;
                                int64_t heshi_tmp_172049 = loopres_165743;
                                int64_t step_tmp_172050 = loopres_165744;
                                
                                loop_while_165682 = loop_while_tmp_172048;
                                heshi_165683 = heshi_tmp_172049;
                                step_165684 = step_tmp_172050;
                            }
                            bsearch_165679 = loop_while_165682;
                            bsearch_165680 = heshi_165683;
                            bsearch_165681 = step_165684;
                            defunc_res_f_res_165674 = bsearch_165680;
                        }
                        defunc_res_165671 = defunc_res_f_res_165674;
                    }
                    
                    bool cond_165827 = sle64(defunc_res_165671, (int64_t) 0);
                    int64_t inf_165828;
                    
                    if (cond_165827) {
                        inf_165828 = (int64_t) 0;
                    } else {
                        bool x_165829 = sle64((int64_t) 0, defunc_res_165671);
                        bool y_165830 = slt64(defunc_res_165671, dz2081U_143052);
                        bool bounds_check_165831 = x_165829 && y_165830;
                        bool index_certs_165832;
                        
                        if (!bounds_check_165831) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_165671, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:961:41-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-989:63\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_165833 = ((int64_t *) bounds_mem_171276.mem)[defunc_res_165671];
                        
                        inf_165828 = inf_f_res_165833;
                    }
                    
                    bool cond_165834 = defunc_res_165671 == zeze_rhs_158708;
                    int64_t sup_165835;
                    
                    if (cond_165834) {
                        sup_165835 = nS_143051;
                    } else {
                        int64_t tmp_165836 = add64((int64_t) 1, defunc_res_165671);
                        bool x_165837 = sle64((int64_t) 0, tmp_165836);
                        bool y_165838 = slt64(tmp_165836, dz2081U_143052);
                        bool bounds_check_165839 = x_165837 && y_165838;
                        bool index_certs_165840;
                        
                        if (!bounds_check_165839) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_165836, "] out of bounds for array of shape [", (long long) dz2081U_143052, "].", "-> #0  ftHashJoin.fut:962:47-65\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-989:63\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_165841 = ((int64_t *) bounds_mem_171276.mem)[tmp_165836];
                        
                        sup_165835 = sup_f_res_165841;
                    }
                    
                    bool cond_165842 = slt64(inf_165828, sup_165835);
                    bool sm_165843;
                    int64_t sm_165844;
                    bool loop_while_165845;
                    int64_t j_165846;
                    
                    loop_while_165845 = cond_165842;
                    j_165846 = inf_165828;
                    while (loop_while_165845) {
                        bool x_165847 = sle64((int64_t) 0, j_165846);
                        bool y_165848 = slt64(j_165846, nS_143051);
                        bool bounds_check_165849 = x_165847 && y_165848;
                        bool index_certs_165850;
                        
                        if (!bounds_check_165849) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_165846, "] out of bounds for array of shape [", (long long) nS_143051, "].", "-> #0  ftHashJoin.fut:965:29-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:4-989:63\n   #3  ftRelational.fut:267:6-270:56\n   #4  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t zeze_rhs_165851 = ((int64_t *) mem_171281)[j_165846];
                        bool is_eq_165852 = defunc_0_byteSeq_to_prim_res_165647 == zeze_rhs_165851;
                        int64_t loopres_165853;
                        
                        if (is_eq_165852) {
                            loopres_165853 = j_165846;
                        } else {
                            int64_t tmp_165854 = add64((int64_t) 1, j_165846);
                            
                            loopres_165853 = tmp_165854;
                        }
                        
                        bool cond_165855 = slt64(loopres_165853, sup_165835);
                        bool loop_cond_t_res_165856 = !is_eq_165852;
                        bool x_165857 = cond_165855 && loop_cond_t_res_165856;
                        bool loop_while_tmp_172060 = x_165857;
                        int64_t j_tmp_172061 = loopres_165853;
                        
                        loop_while_165845 = loop_while_tmp_172060;
                        j_165846 = j_tmp_172061;
                    }
                    sm_165843 = loop_while_165845;
                    sm_165844 = j_165846;
                    
                    bool cond_165858 = slt64(sm_165844, sup_165835);
                    int64_t lifted_lambda_res_165859;
                    
                    if (cond_165858) {
                        lifted_lambda_res_165859 = sm_165844;
                    } else {
                        lifted_lambda_res_165859 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_165861 = sle64((int64_t) 0, lifted_lambda_res_165859);
                    int64_t bool_res_165862 = btoi_bool_i64(lifted_lambda_res_165861);
                    int64_t defunc_0_op_res_159709 = add64(bool_res_165862, scanacc_171082);
                    int64_t zp_res_159700 = add64(bool_res_165862, redout_171084);
                    
                    ((int64_t *) mem_171289)[i_171086] = defunc_0_op_res_159709;
                    ((int64_t *) mem_171291)[i_171086] = lifted_lambda_res_165859;
                    
                    int64_t scanacc_tmp_172043 = defunc_0_op_res_159709;
                    int64_t redout_tmp_172045 = zp_res_159700;
                    
                    scanacc_171082 = scanacc_tmp_172043;
                    redout_171084 = redout_tmp_172045;
                }
                discard_171089 = scanacc_171082;
                defunc_res_168066 = redout_171084;
                
                int64_t bytes_171304 = (int64_t) 8 * defunc_res_168066;
                int64_t bytes_171321 = b_143050 * defunc_res_168066;
                
                if (memblock_alloc(ctx, &mem_171305, bytes_171304, "mem_171305")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172062 = 0; nest_i_172062 < defunc_res_168066; nest_i_172062++) {
                    ((int64_t *) mem_171305.mem)[nest_i_172062] = (int64_t) -1;
                }
                if (memblock_alloc(ctx, &mem_171307, bytes_171304, "mem_171307")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172063 = 0; nest_i_172063 < defunc_res_168066; nest_i_172063++) {
                    ((int64_t *) mem_171307.mem)[nest_i_172063] = (int64_t) -1;
                }
                for (int64_t write_iter_171090 = 0; write_iter_171090 < nR_143049; write_iter_171090++) {
                    int64_t write_iv_171094 = ((int64_t *) mem_171291)[write_iter_171090];
                    int64_t zv_lhs_165909 = add64((int64_t) -1, write_iter_171090);
                    int64_t tmp_165910 = smod64(zv_lhs_165909, nR_143049);
                    int64_t lifted_lambda_res_165911 = ((int64_t *) mem_171289)[tmp_165910];
                    bool cond_165912 = write_iter_171090 == (int64_t) 0;
                    int64_t lifted_lambda_res_165913;
                    
                    if (cond_165912) {
                        lifted_lambda_res_165913 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_165913 = lifted_lambda_res_165911;
                    }
                    
                    bool cond_165914 = sle64((int64_t) 0, write_iv_171094);
                    int64_t lifted_lambda_res_165915;
                    
                    if (cond_165914) {
                        lifted_lambda_res_165915 = lifted_lambda_res_165913;
                    } else {
                        lifted_lambda_res_165915 = (int64_t) -1;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_165915) && slt64(lifted_lambda_res_165915, defunc_res_168066)) {
                        ((int64_t *) mem_171305.mem)[lifted_lambda_res_165915] = write_iv_171094;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_165915) && slt64(lifted_lambda_res_165915, defunc_res_168066)) {
                        ((int64_t *) mem_171307.mem)[lifted_lambda_res_165915] = write_iter_171090;
                    }
                }
                if (memblock_alloc(ctx, &mem_171320, b_143050, "mem_171320")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172066 = 0; nest_i_172066 < b_143050; nest_i_172066++) {
                    ((int8_t *) mem_171320.mem)[nest_i_172066] = (int8_t) 0;
                }
                if (memblock_alloc(ctx, &mem_171322, bytes_171321, "mem_171322")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171099 = 0; i_171099 < defunc_res_168066; i_171099++) {
                    int64_t eta_p_161929 = ((int64_t *) mem_171307.mem)[i_171099];
                    bool cond_161930 = sle64((int64_t) 0, eta_p_161929);
                    bool cond_t_res_161931 = slt64(eta_p_161929, nR_143049);
                    bool x_161932 = cond_161930 && cond_t_res_161931;
                    int64_t lmad_ext_171327 = b_143050 * eta_p_161929;
                    int64_t ext_171328;
                    
                    if (x_161932) {
                        ext_171328 = lmad_ext_171327;
                    } else {
                        ext_171328 = (int64_t) 0;
                    }
                    if (x_161932) {
                        bool index_certs_168062;
                        
                        if (!x_161932) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161929, "] out of bounds for array of shape [", (long long) nR_143049, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:263:3-270:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (memblock_set(ctx, &ext_mem_171329, &pR_mem_171274, "pR_mem_171274") != 0)
                            return 1;
                    } else if (memblock_set(ctx, &ext_mem_171329, &mem_171320, "mem_171320") != 0)
                        return 1;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171322.mem, i_171099 * b_143050, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171329.mem, ext_171328, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143050});
                    if (memblock_unref(ctx, &ext_mem_171329, "ext_mem_171329") != 0)
                        return 1;
                }
                if (memblock_unref(ctx, &mem_171320, "mem_171320") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171397, &mem_171307, "mem_171307") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171394, &mem_171305, "mem_171305") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171391, &mem_171322, "mem_171322") != 0)
                    return 1;
                radix_hash_join_with_S_keys_unique_res_f_res_f_res_159231 = defunc_res_168066;
            }
            if (memblock_set(ctx, &ext_mem_171461, &ext_mem_171397, "ext_mem_171397") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171458, &ext_mem_171394, "ext_mem_171394") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171455, &ext_mem_171391, "ext_mem_171391") != 0)
                return 1;
            radix_hash_join_with_S_keys_unique_res_f_res_158972 = radix_hash_join_with_S_keys_unique_res_f_res_f_res_159231;
            radix_hash_join_with_S_keys_unique_res_f_res_158973 = radix_hash_join_with_S_keys_unique_res_f_res_f_res_159231;
            radix_hash_join_with_S_keys_unique_res_f_res_158974 = radix_hash_join_with_S_keys_unique_res_f_res_f_res_159231;
        }
        if (memblock_set(ctx, &ext_mem_171524, &ext_mem_171461, "ext_mem_171461") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171521, &ext_mem_171458, "ext_mem_171458") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171518, &ext_mem_171455, "ext_mem_171455") != 0)
            return 1;
        radix_hash_join_with_S_keys_unique_res_158713 = radix_hash_join_with_S_keys_unique_res_f_res_158972;
        radix_hash_join_with_S_keys_unique_res_158714 = radix_hash_join_with_S_keys_unique_res_f_res_158973;
        radix_hash_join_with_S_keys_unique_res_158715 = radix_hash_join_with_S_keys_unique_res_f_res_158974;
    }
    
    bool dim_match_159736 = radix_hash_join_with_S_keys_unique_res_158713 == radix_hash_join_with_S_keys_unique_res_158714;
    bool empty_or_match_cert_159737;
    
    if (!dim_match_159736) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:979:1-989:71\n   #1  ftRelational.fut:267:6-270:56\n   #2  ftRelational.fut:263:3-270:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_159739 = radix_hash_join_with_S_keys_unique_res_158713 == radix_hash_join_with_S_keys_unique_res_158715;
    bool empty_or_match_cert_159740;
    
    if (!dim_match_159739) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:979:1-989:71\n   #1  ftRelational.fut:267:6-270:56\n   #2  ftRelational.fut:263:3-270:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171524, "ext_mem_171524") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171521, "ext_mem_171521") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &ext_mem_171518, "ext_mem_171518") != 0)
        return 1;
    prim_out_171959 = radix_hash_join_with_S_keys_unique_res_158713;
    if (memblock_set(ctx, &*mem_out_p_172188, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172189, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172190, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172191 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171281);
        free(mem_171289);
        free(mem_171291);
        free(mem_171335);
        free(mem_171343);
        free(mem_171345);
        free(mem_171399);
        free(mem_171407);
        free(mem_171409);
        free(mem_171462);
        free(mem_171470);
        free(mem_171472);
        if (memblock_unref(ctx, &ext_mem_171329, "ext_mem_171329") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171322, "mem_171322") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171320, "mem_171320") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171305, "mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171383, "ext_mem_171383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171376, "mem_171376") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171374, "mem_171374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171361, "mem_171361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171359, "mem_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171391, "ext_mem_171391") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171394, "ext_mem_171394") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171397, "ext_mem_171397") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171447, "ext_mem_171447") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171440, "mem_171440") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171425, "mem_171425") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171423, "mem_171423") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171455, "ext_mem_171455") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171458, "ext_mem_171458") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171461, "ext_mem_171461") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171510, "ext_mem_171510") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171503, "mem_171503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171501, "mem_171501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171488, "mem_171488") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171518, "ext_mem_171518") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171521, "ext_mem_171521") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171524, "ext_mem_171524") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172204, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_152052, int64_t nz2080U_152053)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * group_noz2081U_152052;
    int64_t defunc_0_reduce_res_162003;
    int64_t redout_171001 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171002 = 0; i_171002 < group_noz2081U_152052; i_171002++) {
        int64_t x_154397 = ((int64_t *) eta_p_mem_171275.mem)[i_171002];
        int64_t max_res_154400 = smax64(x_154397, redout_171001);
        int64_t redout_tmp_171957 = max_res_154400;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_162003 = redout_171001;
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171007 = 0; i_171007 < group_noz2081U_152052; i_171007++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171007];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171007];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_152053);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_152053, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ftRelational.fut:349:28-60\n   #5  ftRelational.fut:349:5-60\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double defunc_0_reduce_comm_res_162002;
        double redout_171003 = 0.0;
        
        for (int64_t i_171004 = 0; i_171004 < defunc_0_reduce_res_162003; i_171004++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171004);
            double index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = 0.0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171004;
                double index_concat_171249 = ((double *) eta_p_mem_171276.mem)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            double zp_res_162000 = redout_171003 + index_concat_branch_171250;
            double redout_tmp_171959 = zp_res_162000;
            
            redout_171003 = redout_tmp_171959;
        }
        defunc_0_reduce_comm_res_162002 = redout_171003;
        ((double *) mem_171278.mem)[i_171007] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172204, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172205, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_152119, int64_t nz2080U_152120)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171279_cached_sizze_172206 = 0;
    unsigned char *mem_171279 = NULL;
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171278 = (int64_t) 8 * nz2080U_152120;
    int64_t bytes_171286 = (int64_t) 8 * group_noz2081U_152119;
    
    if (mem_171279_cached_sizze_172206 < bytes_171278) {
        err = lexical_realloc(ctx, &mem_171279, &mem_171279_cached_sizze_172206, bytes_171278);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < nz2080U_152120; i_171003++) {
        double eta_p_154764 = ((double *) eta_p_mem_171276.mem)[i_171003];
        double eta_p_154765 = ((double *) eta_p_mem_171277.mem)[i_171003];
        double zt_res_154766 = eta_p_154764 * eta_p_154765;
        
        ((double *) mem_171279)[i_171003] = zt_res_154766;
    }
    
    int64_t defunc_0_reduce_res_162004;
    int64_t redout_171005 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171006 = 0; i_171006 < group_noz2081U_152119; i_171006++) {
        int64_t x_154768 = ((int64_t *) eta_p_mem_171275.mem)[i_171006];
        int64_t max_res_154771 = smax64(x_154768, redout_171005);
        int64_t redout_tmp_171958 = max_res_154771;
        
        redout_171005 = redout_tmp_171958;
    }
    defunc_0_reduce_res_162004 = redout_171005;
    if (memblock_alloc(ctx, &mem_171287, bytes_171286, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < group_noz2081U_152119; i_171011++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171011];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171011];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_152120);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_152120, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ft_SortGroupBy.fut:434:19-64\n   #5  ftRelational.fut:350:31-66\n   #6  ftRelational.fut:350:5-66\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double defunc_0_reduce_comm_res_162002;
        double redout_171007 = 0.0;
        
        for (int64_t i_171008 = 0; i_171008 < defunc_0_reduce_res_162004; i_171008++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171008);
            double index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = 0.0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171008;
                double index_concat_171249 = ((double *) mem_171279)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            double zp_res_162000 = redout_171007 + index_concat_branch_171250;
            double redout_tmp_171960 = zp_res_162000;
            
            redout_171007 = redout_tmp_171960;
        }
        defunc_0_reduce_comm_res_162002 = redout_171007;
        ((double *) mem_171287.mem)[i_171011] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172205, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171279);
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172207, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_151611, int64_t nz2080U_151612)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 4 * group_noz2081U_151611;
    int64_t defunc_0_reduce_res_162003;
    int64_t redout_171001 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171002 = 0; i_171002 < group_noz2081U_151611; i_171002++) {
        int64_t x_154397 = ((int64_t *) eta_p_mem_171275.mem)[i_171002];
        int64_t max_res_154400 = smax64(x_154397, redout_171001);
        int64_t redout_tmp_171957 = max_res_154400;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_162003 = redout_171001;
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171007 = 0; i_171007 < group_noz2081U_151611; i_171007++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171007];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171007];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_151612);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_151612, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ftRelational.fut:346:27-58\n   #5  ftRelational.fut:346:5-58\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float defunc_0_reduce_comm_res_162002;
        float redout_171003 = 0.0F;
        
        for (int64_t i_171004 = 0; i_171004 < defunc_0_reduce_res_162003; i_171004++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171004);
            float index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = 0.0F;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171004;
                float index_concat_171249 = ((float *) eta_p_mem_171276.mem)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            float zp_res_162000 = redout_171003 + index_concat_branch_171250;
            float redout_tmp_171959 = zp_res_162000;
            
            redout_171003 = redout_tmp_171959;
        }
        defunc_0_reduce_comm_res_162002 = redout_171003;
        ((float *) mem_171278.mem)[i_171007] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172207, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172208, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_151678, int64_t nz2080U_151679)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171279_cached_sizze_172209 = 0;
    unsigned char *mem_171279 = NULL;
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171278 = (int64_t) 4 * nz2080U_151679;
    int64_t bytes_171286 = (int64_t) 4 * group_noz2081U_151678;
    
    if (mem_171279_cached_sizze_172209 < bytes_171278) {
        err = lexical_realloc(ctx, &mem_171279, &mem_171279_cached_sizze_172209, bytes_171278);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < nz2080U_151679; i_171003++) {
        float eta_p_154764 = ((float *) eta_p_mem_171276.mem)[i_171003];
        float eta_p_154765 = ((float *) eta_p_mem_171277.mem)[i_171003];
        float zt_res_154766 = eta_p_154764 * eta_p_154765;
        
        ((float *) mem_171279)[i_171003] = zt_res_154766;
    }
    
    int64_t defunc_0_reduce_res_162004;
    int64_t redout_171005 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171006 = 0; i_171006 < group_noz2081U_151678; i_171006++) {
        int64_t x_154768 = ((int64_t *) eta_p_mem_171275.mem)[i_171006];
        int64_t max_res_154771 = smax64(x_154768, redout_171005);
        int64_t redout_tmp_171958 = max_res_154771;
        
        redout_171005 = redout_tmp_171958;
    }
    defunc_0_reduce_res_162004 = redout_171005;
    if (memblock_alloc(ctx, &mem_171287, bytes_171286, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < group_noz2081U_151678; i_171011++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171011];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171011];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_151679);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_151679, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ft_SortGroupBy.fut:434:19-64\n   #5  ftRelational.fut:347:30-64\n   #6  ftRelational.fut:347:5-64\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float defunc_0_reduce_comm_res_162002;
        float redout_171007 = 0.0F;
        
        for (int64_t i_171008 = 0; i_171008 < defunc_0_reduce_res_162004; i_171008++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171008);
            float index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = 0.0F;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171008;
                float index_concat_171249 = ((float *) mem_171279)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            float zp_res_162000 = redout_171007 + index_concat_branch_171250;
            float redout_tmp_171960 = zp_res_162000;
            
            redout_171007 = redout_tmp_171960;
        }
        defunc_0_reduce_comm_res_162002 = redout_171007;
        ((float *) mem_171287.mem)[i_171011] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172208, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171279);
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172210, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_150738, int64_t nz2080U_150739)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 4 * group_noz2081U_150738;
    int64_t defunc_0_reduce_res_162003;
    int64_t redout_171001 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171002 = 0; i_171002 < group_noz2081U_150738; i_171002++) {
        int64_t x_154397 = ((int64_t *) eta_p_mem_171275.mem)[i_171002];
        int64_t max_res_154400 = smax64(x_154397, redout_171001);
        int64_t redout_tmp_171957 = max_res_154400;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_162003 = redout_171001;
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171007 = 0; i_171007 < group_noz2081U_150738; i_171007++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171007];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171007];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_150739);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_150739, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ftRelational.fut:340:25-54\n   #5  ftRelational.fut:340:5-54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t defunc_0_reduce_comm_res_162002;
        int32_t redout_171003 = 0;
        
        for (int64_t i_171004 = 0; i_171004 < defunc_0_reduce_res_162003; i_171004++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171004);
            int32_t index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = 0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171004;
                int32_t index_concat_171249 = ((int32_t *) eta_p_mem_171276.mem)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            int32_t zp_res_162000 = add32(redout_171003, index_concat_branch_171250);
            int32_t redout_tmp_171959 = zp_res_162000;
            
            redout_171003 = redout_tmp_171959;
        }
        defunc_0_reduce_comm_res_162002 = redout_171003;
        ((int32_t *) mem_171278.mem)[i_171007] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172210, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172211, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_150805, int64_t nz2080U_150806)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171279_cached_sizze_172212 = 0;
    unsigned char *mem_171279 = NULL;
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171278 = (int64_t) 4 * nz2080U_150806;
    int64_t bytes_171286 = (int64_t) 4 * group_noz2081U_150805;
    
    if (mem_171279_cached_sizze_172212 < bytes_171278) {
        err = lexical_realloc(ctx, &mem_171279, &mem_171279_cached_sizze_172212, bytes_171278);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < nz2080U_150806; i_171003++) {
        int32_t eta_p_154764 = ((int32_t *) eta_p_mem_171276.mem)[i_171003];
        int32_t eta_p_154765 = ((int32_t *) eta_p_mem_171277.mem)[i_171003];
        int32_t zt_res_154766 = mul32(eta_p_154764, eta_p_154765);
        
        ((int32_t *) mem_171279)[i_171003] = zt_res_154766;
    }
    
    int64_t defunc_0_reduce_res_162004;
    int64_t redout_171005 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171006 = 0; i_171006 < group_noz2081U_150805; i_171006++) {
        int64_t x_154768 = ((int64_t *) eta_p_mem_171275.mem)[i_171006];
        int64_t max_res_154771 = smax64(x_154768, redout_171005);
        int64_t redout_tmp_171958 = max_res_154771;
        
        redout_171005 = redout_tmp_171958;
    }
    defunc_0_reduce_res_162004 = redout_171005;
    if (memblock_alloc(ctx, &mem_171287, bytes_171286, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < group_noz2081U_150805; i_171011++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171011];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171011];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_150806);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_150806, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ft_SortGroupBy.fut:434:19-64\n   #5  ftRelational.fut:341:28-60\n   #6  ftRelational.fut:341:5-60\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t defunc_0_reduce_comm_res_162002;
        int32_t redout_171007 = 0;
        
        for (int64_t i_171008 = 0; i_171008 < defunc_0_reduce_res_162004; i_171008++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171008);
            int32_t index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = 0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171008;
                int32_t index_concat_171249 = ((int32_t *) mem_171279)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            int32_t zp_res_162000 = add32(redout_171007, index_concat_branch_171250);
            int32_t redout_tmp_171960 = zp_res_162000;
            
            redout_171007 = redout_tmp_171960;
        }
        defunc_0_reduce_comm_res_162002 = redout_171007;
        ((int32_t *) mem_171287.mem)[i_171011] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172211, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171279);
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172213, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_151170, int64_t nz2080U_151171)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * group_noz2081U_151170;
    int64_t defunc_0_reduce_res_162003;
    int64_t redout_171001 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171002 = 0; i_171002 < group_noz2081U_151170; i_171002++) {
        int64_t x_154397 = ((int64_t *) eta_p_mem_171275.mem)[i_171002];
        int64_t max_res_154400 = smax64(x_154397, redout_171001);
        int64_t redout_tmp_171957 = max_res_154400;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_162003 = redout_171001;
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171007 = 0; i_171007 < group_noz2081U_151170; i_171007++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171007];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171007];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_151171);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_151171, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ftRelational.fut:343:26-56\n   #5  ftRelational.fut:343:5-56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t defunc_0_reduce_comm_res_162002;
        int64_t redout_171003 = (int64_t) 0;
        
        for (int64_t i_171004 = 0; i_171004 < defunc_0_reduce_res_162003; i_171004++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171004);
            int64_t index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = (int64_t) 0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171004;
                int64_t index_concat_171249 = ((int64_t *) eta_p_mem_171276.mem)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            int64_t zp_res_162000 = add64(redout_171003, index_concat_branch_171250);
            int64_t redout_tmp_171959 = zp_res_162000;
            
            redout_171003 = redout_tmp_171959;
        }
        defunc_0_reduce_comm_res_162002 = redout_171003;
        ((int64_t *) mem_171278.mem)[i_171007] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172213, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172214, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_151237, int64_t nz2080U_151238)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171279_cached_sizze_172215 = 0;
    unsigned char *mem_171279 = NULL;
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171278 = (int64_t) 8 * nz2080U_151238;
    int64_t bytes_171286 = (int64_t) 8 * group_noz2081U_151237;
    
    if (mem_171279_cached_sizze_172215 < bytes_171278) {
        err = lexical_realloc(ctx, &mem_171279, &mem_171279_cached_sizze_172215, bytes_171278);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < nz2080U_151238; i_171003++) {
        int64_t eta_p_154764 = ((int64_t *) eta_p_mem_171276.mem)[i_171003];
        int64_t eta_p_154765 = ((int64_t *) eta_p_mem_171277.mem)[i_171003];
        int64_t zt_res_154766 = mul64(eta_p_154764, eta_p_154765);
        
        ((int64_t *) mem_171279)[i_171003] = zt_res_154766;
    }
    
    int64_t defunc_0_reduce_res_162004;
    int64_t redout_171005 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171006 = 0; i_171006 < group_noz2081U_151237; i_171006++) {
        int64_t x_154768 = ((int64_t *) eta_p_mem_171275.mem)[i_171006];
        int64_t max_res_154771 = smax64(x_154768, redout_171005);
        int64_t redout_tmp_171958 = max_res_154771;
        
        redout_171005 = redout_tmp_171958;
    }
    defunc_0_reduce_res_162004 = redout_171005;
    if (memblock_alloc(ctx, &mem_171287, bytes_171286, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < group_noz2081U_151237; i_171011++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171011];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171011];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_151238);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_151238, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ft_SortGroupBy.fut:434:19-64\n   #5  ftRelational.fut:344:29-62\n   #6  ftRelational.fut:344:5-62\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t defunc_0_reduce_comm_res_162002;
        int64_t redout_171007 = (int64_t) 0;
        
        for (int64_t i_171008 = 0; i_171008 < defunc_0_reduce_res_162004; i_171008++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171008);
            int64_t index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = (int64_t) 0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171008;
                int64_t index_concat_171249 = ((int64_t *) mem_171279)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            int64_t zp_res_162000 = add64(redout_171007, index_concat_branch_171250);
            int64_t redout_tmp_171960 = zp_res_162000;
            
            redout_171007 = redout_tmp_171960;
        }
        defunc_0_reduce_comm_res_162002 = redout_171007;
        ((int64_t *) mem_171287.mem)[i_171011] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172214, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171279);
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172216, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t group_noz2081U_150306, int64_t nz2080U_150307)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 2 * group_noz2081U_150306;
    int64_t defunc_0_reduce_res_162003;
    int64_t redout_171001 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171002 = 0; i_171002 < group_noz2081U_150306; i_171002++) {
        int64_t x_154397 = ((int64_t *) eta_p_mem_171275.mem)[i_171002];
        int64_t max_res_154400 = smax64(x_154397, redout_171001);
        int64_t redout_tmp_171957 = max_res_154400;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_162003 = redout_171001;
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171007 = 0; i_171007 < group_noz2081U_150306; i_171007++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171007];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171007];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_150307);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_150307, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ftRelational.fut:337:27-58\n   #5  ftRelational.fut:337:5-58\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t defunc_0_reduce_comm_res_162002;
        int16_t redout_171003 = (int16_t) 0;
        
        for (int64_t i_171004 = 0; i_171004 < defunc_0_reduce_res_162003; i_171004++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171004);
            int16_t index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = (int16_t) 0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171004;
                int16_t index_concat_171249 = ((int16_t *) eta_p_mem_171276.mem)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            int16_t zp_res_162000 = add16(redout_171003, index_concat_branch_171250);
            int16_t redout_tmp_171959 = zp_res_162000;
            
            redout_171003 = redout_tmp_171959;
        }
        defunc_0_reduce_comm_res_162002 = redout_171003;
        ((int16_t *) mem_171278.mem)[i_171007] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172216, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172217, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, struct memblock eta_p_mem_171277, int64_t group_noz2081U_150373, int64_t nz2080U_150374)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171279_cached_sizze_172218 = 0;
    unsigned char *mem_171279 = NULL;
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171278 = (int64_t) 2 * nz2080U_150374;
    int64_t bytes_171286 = (int64_t) 2 * group_noz2081U_150373;
    
    if (mem_171279_cached_sizze_172218 < bytes_171278) {
        err = lexical_realloc(ctx, &mem_171279, &mem_171279_cached_sizze_172218, bytes_171278);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < nz2080U_150374; i_171003++) {
        int16_t eta_p_154764 = ((int16_t *) eta_p_mem_171276.mem)[i_171003];
        int16_t eta_p_154765 = ((int16_t *) eta_p_mem_171277.mem)[i_171003];
        int16_t zt_res_154766 = mul16(eta_p_154764, eta_p_154765);
        
        ((int16_t *) mem_171279)[i_171003] = zt_res_154766;
    }
    
    int64_t defunc_0_reduce_res_162004;
    int64_t redout_171005 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171006 = 0; i_171006 < group_noz2081U_150373; i_171006++) {
        int64_t x_154768 = ((int64_t *) eta_p_mem_171275.mem)[i_171006];
        int64_t max_res_154771 = smax64(x_154768, redout_171005);
        int64_t redout_tmp_171958 = max_res_154771;
        
        redout_171005 = redout_tmp_171958;
    }
    defunc_0_reduce_res_162004 = redout_171005;
    if (memblock_alloc(ctx, &mem_171287, bytes_171286, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < group_noz2081U_150373; i_171011++) {
        int64_t this_inf_161976 = ((int64_t *) eta_p_mem_171274.mem)[i_171011];
        int64_t zp_rhs_161977 = ((int64_t *) eta_p_mem_171275.mem)[i_171011];
        int64_t this_sup_161978 = add64(this_inf_161976, zp_rhs_161977);
        bool empty_slice_161980 = zp_rhs_161977 == (int64_t) 0;
        int64_t m_161981 = sub64(zp_rhs_161977, (int64_t) 1);
        int64_t i_p_m_t_s_161982 = add64(this_inf_161976, m_161981);
        bool zzero_leq_i_p_m_t_s_161983 = sle64((int64_t) 0, i_p_m_t_s_161982);
        bool i_p_m_t_s_leq_w_161984 = slt64(i_p_m_t_s_161982, nz2080U_150374);
        bool zzero_lte_i_161985 = sle64((int64_t) 0, this_inf_161976);
        bool i_lte_j_161986 = sle64(this_inf_161976, this_sup_161978);
        bool y_161987 = i_p_m_t_s_leq_w_161984 && zzero_lte_i_161985;
        bool y_161988 = zzero_leq_i_p_m_t_s_161983 && y_161987;
        bool forwards_ok_161989 = i_lte_j_161986 && y_161988;
        bool ok_or_empty_161990 = empty_slice_161980 || forwards_ok_161989;
        bool index_certs_161991;
        
        if (!ok_or_empty_161990) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_161976, ":", (long long) this_sup_161978, "] out of bounds for array of shape [", (long long) nz2080U_150374, "].", "-> #0  ft_SortGroupBy.fut:305:29-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:301:20-306:18\n   #3  ft_SortGroupBy.fut:428:72-74\n   #4  ft_SortGroupBy.fut:434:19-64\n   #5  ftRelational.fut:338:30-64\n   #6  ftRelational.fut:338:5-64\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t defunc_0_reduce_comm_res_162002;
        int16_t redout_171007 = (int16_t) 0;
        
        for (int64_t i_171008 = 0; i_171008 < defunc_0_reduce_res_162004; i_171008++) {
            bool index_concat_cmp_171246 = sle64(zp_rhs_161977, i_171008);
            int16_t index_concat_branch_171250;
            
            if (index_concat_cmp_171246) {
                index_concat_branch_171250 = (int16_t) 0;
            } else {
                int64_t slice_171253 = this_inf_161976 + i_171008;
                int16_t index_concat_171249 = ((int16_t *) mem_171279)[slice_171253];
                
                index_concat_branch_171250 = index_concat_171249;
            }
            
            int16_t zp_res_162000 = add16(redout_171007, index_concat_branch_171250);
            int16_t redout_tmp_171960 = zp_res_162000;
            
            redout_171007 = redout_tmp_171960;
        }
        defunc_0_reduce_comm_res_162002 = redout_171007;
        ((int16_t *) mem_171287.mem)[i_171011] = defunc_0_reduce_comm_res_162002;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172217, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171279);
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_172219, struct memblock ks_mem_171274, int64_t n_79452)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_comm_res_161970;
    double defunc_0_reduce_comm_res_161971;
    int64_t redout_171001;
    double redout_171002;
    
    redout_171001 = n_79452;
    redout_171002 = INFINITY;
    for (int64_t i_171003 = 0; i_171003 < n_79452; i_171003++) {
        double x_152993 = ((double *) ks_mem_171274.mem)[i_171003];
        bool defunc_0_lt_res_152998 = redout_171002 < x_152993;
        bool defunc_0_eq_res_153000 = redout_171002 == x_152993;
        bool cond_f_res_t_res_153001 = slt64(redout_171001, i_171003);
        bool x_153002 = defunc_0_eq_res_153000 && cond_f_res_t_res_153001;
        bool x_161768 = !defunc_0_lt_res_152998;
        bool y_161769 = x_153002 && x_161768;
        bool cond_152999 = defunc_0_lt_res_152998 || y_161769;
        int64_t defunc_0_op_res_153003;
        
        if (cond_152999) {
            defunc_0_op_res_153003 = redout_171001;
        } else {
            defunc_0_op_res_153003 = i_171003;
        }
        
        double defunc_0_op_res_153004;
        
        if (cond_152999) {
            defunc_0_op_res_153004 = redout_171002;
        } else {
            defunc_0_op_res_153004 = x_152993;
        }
        
        int64_t redout_tmp_171957 = defunc_0_op_res_153003;
        double redout_tmp_171958 = defunc_0_op_res_153004;
        
        redout_171001 = redout_tmp_171957;
        redout_171002 = redout_tmp_171958;
    }
    defunc_0_reduce_comm_res_161970 = redout_171001;
    defunc_0_reduce_comm_res_161971 = redout_171002;
    prim_out_171956 = defunc_0_reduce_comm_res_161970;
    *out_prim_out_172219 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_172220, struct memblock ks_mem_171274, int64_t n_79275)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_comm_res_161970;
    float defunc_0_reduce_comm_res_161971;
    int64_t redout_171001;
    float redout_171002;
    
    redout_171001 = n_79275;
    redout_171002 = INFINITY;
    for (int64_t i_171003 = 0; i_171003 < n_79275; i_171003++) {
        float x_152993 = ((float *) ks_mem_171274.mem)[i_171003];
        bool defunc_0_lt_res_152998 = redout_171002 < x_152993;
        bool defunc_0_eq_res_153000 = redout_171002 == x_152993;
        bool cond_f_res_t_res_153001 = slt64(redout_171001, i_171003);
        bool x_153002 = defunc_0_eq_res_153000 && cond_f_res_t_res_153001;
        bool x_161768 = !defunc_0_lt_res_152998;
        bool y_161769 = x_153002 && x_161768;
        bool cond_152999 = defunc_0_lt_res_152998 || y_161769;
        int64_t defunc_0_op_res_153003;
        
        if (cond_152999) {
            defunc_0_op_res_153003 = redout_171001;
        } else {
            defunc_0_op_res_153003 = i_171003;
        }
        
        float defunc_0_op_res_153004;
        
        if (cond_152999) {
            defunc_0_op_res_153004 = redout_171002;
        } else {
            defunc_0_op_res_153004 = x_152993;
        }
        
        int64_t redout_tmp_171957 = defunc_0_op_res_153003;
        float redout_tmp_171958 = defunc_0_op_res_153004;
        
        redout_171001 = redout_tmp_171957;
        redout_171002 = redout_tmp_171958;
    }
    defunc_0_reduce_comm_res_161970 = redout_171001;
    defunc_0_reduce_comm_res_161971 = redout_171002;
    prim_out_171956 = defunc_0_reduce_comm_res_161970;
    *out_prim_out_172220 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_172221, struct memblock ks_mem_171274, int64_t n_78924)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_comm_res_161970;
    int32_t defunc_0_reduce_comm_res_161971;
    int64_t redout_171001;
    int32_t redout_171002;
    
    redout_171001 = n_78924;
    redout_171002 = 2147483647;
    for (int64_t i_171003 = 0; i_171003 < n_78924; i_171003++) {
        int32_t x_152993 = ((int32_t *) ks_mem_171274.mem)[i_171003];
        bool defunc_0_lt_res_152998 = slt32(redout_171002, x_152993);
        bool defunc_0_eq_res_153000 = redout_171002 == x_152993;
        bool cond_f_res_t_res_153001 = slt64(redout_171001, i_171003);
        bool x_153002 = defunc_0_eq_res_153000 && cond_f_res_t_res_153001;
        bool x_161768 = !defunc_0_lt_res_152998;
        bool y_161769 = x_153002 && x_161768;
        bool cond_152999 = defunc_0_lt_res_152998 || y_161769;
        int64_t defunc_0_op_res_153003;
        
        if (cond_152999) {
            defunc_0_op_res_153003 = redout_171001;
        } else {
            defunc_0_op_res_153003 = i_171003;
        }
        
        int32_t defunc_0_op_res_153004;
        
        if (cond_152999) {
            defunc_0_op_res_153004 = redout_171002;
        } else {
            defunc_0_op_res_153004 = x_152993;
        }
        
        int64_t redout_tmp_171957 = defunc_0_op_res_153003;
        int32_t redout_tmp_171958 = defunc_0_op_res_153004;
        
        redout_171001 = redout_tmp_171957;
        redout_171002 = redout_tmp_171958;
    }
    defunc_0_reduce_comm_res_161970 = redout_171001;
    defunc_0_reduce_comm_res_161971 = redout_171002;
    prim_out_171956 = defunc_0_reduce_comm_res_161970;
    *out_prim_out_172221 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_172222, struct memblock ks_mem_171274, int64_t n_79098)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_comm_res_161970;
    int64_t defunc_0_reduce_comm_res_161971;
    int64_t redout_171001;
    int64_t redout_171002;
    
    redout_171001 = n_79098;
    redout_171002 = (int64_t) 9223372036854775807;
    for (int64_t i_171003 = 0; i_171003 < n_79098; i_171003++) {
        int64_t x_152993 = ((int64_t *) ks_mem_171274.mem)[i_171003];
        bool defunc_0_lt_res_152998 = slt64(redout_171002, x_152993);
        bool defunc_0_eq_res_153000 = redout_171002 == x_152993;
        bool cond_f_res_t_res_153001 = slt64(redout_171001, i_171003);
        bool x_153002 = defunc_0_eq_res_153000 && cond_f_res_t_res_153001;
        bool x_161768 = !defunc_0_lt_res_152998;
        bool y_161769 = x_153002 && x_161768;
        bool cond_152999 = defunc_0_lt_res_152998 || y_161769;
        int64_t defunc_0_op_res_153003;
        
        if (cond_152999) {
            defunc_0_op_res_153003 = redout_171001;
        } else {
            defunc_0_op_res_153003 = i_171003;
        }
        
        int64_t defunc_0_op_res_153004;
        
        if (cond_152999) {
            defunc_0_op_res_153004 = redout_171002;
        } else {
            defunc_0_op_res_153004 = x_152993;
        }
        
        int64_t redout_tmp_171957 = defunc_0_op_res_153003;
        int64_t redout_tmp_171958 = defunc_0_op_res_153004;
        
        redout_171001 = redout_tmp_171957;
        redout_171002 = redout_tmp_171958;
    }
    defunc_0_reduce_comm_res_161970 = redout_171001;
    defunc_0_reduce_comm_res_161971 = redout_171002;
    prim_out_171956 = defunc_0_reduce_comm_res_161970;
    *out_prim_out_172222 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_172223, struct memblock ks_mem_171274, int64_t n_78750)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_comm_res_161970;
    int16_t defunc_0_reduce_comm_res_161971;
    int64_t redout_171001;
    int16_t redout_171002;
    
    redout_171001 = n_78750;
    redout_171002 = (int16_t) 32767;
    for (int64_t i_171003 = 0; i_171003 < n_78750; i_171003++) {
        int16_t x_152993 = ((int16_t *) ks_mem_171274.mem)[i_171003];
        bool defunc_0_lt_res_152998 = slt16(redout_171002, x_152993);
        bool defunc_0_eq_res_153000 = redout_171002 == x_152993;
        bool cond_f_res_t_res_153001 = slt64(redout_171001, i_171003);
        bool x_153002 = defunc_0_eq_res_153000 && cond_f_res_t_res_153001;
        bool x_161768 = !defunc_0_lt_res_152998;
        bool y_161769 = x_153002 && x_161768;
        bool cond_152999 = defunc_0_lt_res_152998 || y_161769;
        int64_t defunc_0_op_res_153003;
        
        if (cond_152999) {
            defunc_0_op_res_153003 = redout_171001;
        } else {
            defunc_0_op_res_153003 = i_171003;
        }
        
        int16_t defunc_0_op_res_153004;
        
        if (cond_152999) {
            defunc_0_op_res_153004 = redout_171002;
        } else {
            defunc_0_op_res_153004 = x_152993;
        }
        
        int64_t redout_tmp_171957 = defunc_0_op_res_153003;
        int16_t redout_tmp_171958 = defunc_0_op_res_153004;
        
        redout_171001 = redout_tmp_171957;
        redout_171002 = redout_tmp_171958;
    }
    defunc_0_reduce_comm_res_161970 = redout_171001;
    defunc_0_reduce_comm_res_161971 = redout_171002;
    prim_out_171956 = defunc_0_reduce_comm_res_161970;
    *out_prim_out_172223 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172224, struct memblock *mem_out_p_172225, int64_t *out_prim_out_172226, int32_t *out_prim_out_172227, struct memblock pXs_mem_171274, int64_t n_131688, int64_t b_131689, int32_t radix_sizze_131690, int64_t offset_131692, int64_t sizze_thresh_131693, int32_t max_depth_131694)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171284_cached_sizze_172228 = 0;
    unsigned char *mem_171284 = NULL;
    int64_t mem_171286_cached_sizze_172229 = 0;
    unsigned char *mem_171286 = NULL;
    int64_t mem_171288_cached_sizze_172230 = 0;
    unsigned char *mem_171288 = NULL;
    int64_t mem_171290_cached_sizze_172231 = 0;
    unsigned char *mem_171290 = NULL;
    int64_t mem_171316_cached_sizze_172232 = 0;
    unsigned char *mem_171316 = NULL;
    int64_t mem_171318_cached_sizze_172233 = 0;
    unsigned char *mem_171318 = NULL;
    int64_t mem_171320_cached_sizze_172234 = 0;
    unsigned char *mem_171320 = NULL;
    struct memblock mem_171375;
    
    mem_171375.references = NULL;
    
    struct memblock mem_param_tmp_171961;
    
    mem_param_tmp_171961.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171979;
    
    mem_param_tmp_171979.references = NULL;
    
    struct memblock mem_param_tmp_171978;
    
    mem_param_tmp_171978.references = NULL;
    
    struct memblock mem_171361;
    
    mem_171361.references = NULL;
    
    struct memblock mem_171359;
    
    mem_171359.references = NULL;
    
    struct memblock ext_mem_171348;
    
    ext_mem_171348.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock mem_171346;
    
    mem_171346.references = NULL;
    
    struct memblock mem_param_171344;
    
    mem_param_171344.references = NULL;
    
    struct memblock mem_param_171341;
    
    mem_param_171341.references = NULL;
    
    struct memblock ext_mem_171366;
    
    ext_mem_171366.references = NULL;
    
    struct memblock ext_mem_171367;
    
    ext_mem_171367.references = NULL;
    
    struct memblock mem_param_171282;
    
    mem_param_171282.references = NULL;
    
    struct memblock mem_param_171279;
    
    mem_param_171279.references = NULL;
    
    struct memblock ext_mem_171372;
    
    ext_mem_171372.references = NULL;
    
    struct memblock ext_mem_171373;
    
    ext_mem_171373.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock ext_mem_171276;
    
    ext_mem_171276.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int32_t prim_out_171959;
    int32_t getPartitionBounds_arg3_153514 = sub32(radix_sizze_131690, 1);
    int64_t calc_partInfo_res_153515;
    int64_t calc_partInfo_res_153516;
    int32_t calc_partInfo_res_153519;
    
    if (futrts_getPartitionBounds_16843(ctx, &ext_mem_171276, &ext_mem_171275, &calc_partInfo_res_153515, &calc_partInfo_res_153516, &calc_partInfo_res_153519, pXs_mem_171274, n_131688, b_131689, 1, 0, getPartitionBounds_arg3_153514) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool cond_153520 = slt32(calc_partInfo_res_153519, max_depth_131694);
    int64_t calc_partInfo_res_153521;
    int64_t calc_partInfo_res_153522;
    bool calc_partInfo_res_153523;
    int32_t calc_partInfo_res_153526;
    int64_t loop_dz2088U_153527;
    int64_t loop_dz2089U_153528;
    bool loop_while_153529;
    int32_t p_153532;
    
    if (memblock_set(ctx, &mem_param_171279, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171282, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    loop_dz2088U_153527 = calc_partInfo_res_153515;
    loop_dz2089U_153528 = calc_partInfo_res_153516;
    loop_while_153529 = cond_153520;
    p_153532 = calc_partInfo_res_153519;
    while (loop_while_153529) {
        int64_t zl_rhs_153534 = sub64(loop_dz2088U_153527, (int64_t) 1);
        int64_t bytes_171283 = (int64_t) 8 * loop_dz2088U_153527;
        
        if (mem_171284_cached_sizze_172228 < bytes_171283) {
            err = lexical_realloc(ctx, &mem_171284, &mem_171284_cached_sizze_172228, bytes_171283);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171286_cached_sizze_172229 < bytes_171283) {
            err = lexical_realloc(ctx, &mem_171286, &mem_171286_cached_sizze_172229, bytes_171283);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171288_cached_sizze_172230 < bytes_171283) {
            err = lexical_realloc(ctx, &mem_171288, &mem_171288_cached_sizze_172230, bytes_171283);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171290_cached_sizze_172231 < bytes_171283) {
            err = lexical_realloc(ctx, &mem_171290, &mem_171290_cached_sizze_172231, bytes_171283);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_171015;
        int64_t scanacc_171005 = (int64_t) 0;
        
        for (int64_t i_171010 = 0; i_171010 < loop_dz2088U_153527; i_171010++) {
            int64_t tmp_161994 = ((int64_t *) mem_param_171279.mem)[i_171010];
            bool cond_161995 = slt64(i_171010, zl_rhs_153534);
            int64_t tmp_161996;
            
            if (cond_161995) {
                int64_t tmp_162034 = add64((int64_t) 1, i_171010);
                bool x_162035 = sle64((int64_t) 0, tmp_162034);
                bool y_162036 = slt64(tmp_162034, loop_dz2088U_153527);
                bool bounds_check_162037 = x_162035 && y_162036;
                bool index_certs_162038;
                
                if (!bounds_check_162037) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162034, "] out of bounds for array of shape [", (long long) loop_dz2088U_153527, "].", "-> #0  ftHashJoin.fut:335:55-62\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:242:5-62\n   #3  ftRelational.fut:235:3-242:62\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_t_res_162039 = ((int64_t *) mem_param_171279.mem)[tmp_162034];
                
                tmp_161996 = tmp_t_res_162039;
            } else {
                tmp_161996 = n_131688;
            }
            
            int64_t zg_lhs_162005 = sub64(tmp_161996, tmp_161994);
            bool lifted_lambda_res_162006 = slt64(sizze_thresh_131693, zg_lhs_162005);
            int64_t defunc_0_f_res_162007 = btoi_bool_i64(lifted_lambda_res_162006);
            int64_t defunc_0_op_res_153561 = add64(defunc_0_f_res_162007, scanacc_171005);
            
            ((int64_t *) mem_171284)[i_171010] = defunc_0_op_res_153561;
            ((int64_t *) mem_171286)[i_171010] = defunc_0_f_res_162007;
            ((int64_t *) mem_171288)[i_171010] = tmp_161994;
            ((int64_t *) mem_171290)[i_171010] = tmp_161996;
            
            int64_t scanacc_tmp_171968 = defunc_0_op_res_153561;
            
            scanacc_171005 = scanacc_tmp_171968;
        }
        discard_171015 = scanacc_171005;
        
        bool cond_153562 = loop_dz2088U_153527 == (int64_t) 0;
        bool x_153563 = !cond_153562;
        bool x_153564 = sle64((int64_t) 0, zl_rhs_153534);
        bool y_153565 = slt64(zl_rhs_153534, loop_dz2088U_153527);
        bool bounds_check_153566 = x_153564 && y_153565;
        bool protect_assert_disj_153567 = cond_153562 || bounds_check_153566;
        bool index_certs_153568;
        
        if (!protect_assert_disj_153567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_153534, "] out of bounds for array of shape [", (long long) loop_dz2088U_153527, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:242:5-62\n   #3  ftRelational.fut:235:3-242:62\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t m_f_res_153569;
        
        if (x_153563) {
            int64_t x_162040 = ((int64_t *) mem_171284)[zl_rhs_153534];
            
            m_f_res_153569 = x_162040;
        } else {
            m_f_res_153569 = (int64_t) 0;
        }
        
        int64_t m_153571;
        
        if (cond_153562) {
            m_153571 = (int64_t) 0;
        } else {
            m_153571 = m_f_res_153569;
        }
        
        int64_t m_153581 = sub64(m_153571, (int64_t) 1);
        bool i_p_m_t_s_leq_w_153583 = slt64(m_153581, loop_dz2088U_153527);
        bool zzero_leq_i_p_m_t_s_153582 = sle64((int64_t) 0, m_153581);
        bool y_153585 = zzero_leq_i_p_m_t_s_153582 && i_p_m_t_s_leq_w_153583;
        bool i_lte_j_153584 = sle64((int64_t) 0, m_153571);
        bool forwards_ok_153586 = i_lte_j_153584 && y_153585;
        bool eq_x_zz_153578 = (int64_t) 0 == m_f_res_153569;
        bool p_and_eq_x_y_153579 = x_153563 && eq_x_zz_153578;
        bool empty_slice_153580 = cond_153562 || p_and_eq_x_y_153579;
        bool ok_or_empty_153587 = empty_slice_153580 || forwards_ok_153586;
        bool index_certs_153588;
        
        if (!ok_or_empty_153587) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_153571, "] out of bounds for array of shape [", (long long) loop_dz2088U_153527, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:242:5-62\n   #3  ftRelational.fut:235:3-242:62\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171315 = (int64_t) 8 * m_153571;
        
        if (mem_171316_cached_sizze_172232 < bytes_171315) {
            err = lexical_realloc(ctx, &mem_171316, &mem_171316_cached_sizze_172232, bytes_171315);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171973 = 0; i_171973 < m_153571; i_171973++) {
            int64_t x_171974 = (int64_t) 0 + i_171973 * (int64_t) 1;
            
            ((int64_t *) mem_171316)[i_171973] = x_171974;
        }
        if (mem_171318_cached_sizze_172233 < bytes_171315) {
            err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172233, bytes_171315);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171290, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_153571});
        if (mem_171320_cached_sizze_172234 < bytes_171315) {
            err = lexical_realloc(ctx, &mem_171320, &mem_171320_cached_sizze_172234, bytes_171315);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171288, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_153571});
        for (int64_t write_iter_171016 = 0; write_iter_171016 < loop_dz2088U_153527; write_iter_171016++) {
            int64_t write_iv_171020 = ((int64_t *) mem_171286)[write_iter_171016];
            int64_t write_iv_171021 = ((int64_t *) mem_171284)[write_iter_171016];
            int64_t write_iv_171022 = ((int64_t *) mem_171288)[write_iter_171016];
            int64_t write_iv_171023 = ((int64_t *) mem_171290)[write_iter_171016];
            bool cond_161976 = write_iv_171020 == (int64_t) 1;
            int64_t lifted_lambda_res_161977;
            
            if (cond_161976) {
                int64_t lifted_lambda_res_t_res_162041 = sub64(write_iv_171021, (int64_t) 1);
                
                lifted_lambda_res_161977 = lifted_lambda_res_t_res_162041;
            } else {
                lifted_lambda_res_161977 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_161977) && slt64(lifted_lambda_res_161977, m_153571)) {
                ((int64_t *) mem_171320)[lifted_lambda_res_161977] = write_iv_171022;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_161977) && slt64(lifted_lambda_res_161977, m_153571)) {
                ((int64_t *) mem_171318)[lifted_lambda_res_161977] = write_iv_171023;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_161977) && slt64(lifted_lambda_res_161977, m_153571)) {
                ((int64_t *) mem_171316)[lifted_lambda_res_161977] = write_iter_171016;
            }
        }
        
        int32_t new_i_153601 = mul32(radix_sizze_131690, p_153532);
        int32_t zt_rhs_153602 = add32(1, p_153532);
        int32_t zm_lhs_153603 = mul32(radix_sizze_131690, zt_rhs_153602);
        int32_t new_j_153604 = sub32(zm_lhs_153603, 1);
        int64_t loopres_153605;
        int64_t loopres_153606;
        int32_t loopres_153609;
        int64_t loopres_153610;
        int64_t loopres_153611;
        int64_t loop_dz2084Uz2089U_153613;
        int64_t loop_dz2085Uz2080U_153614;
        int32_t q_153617;
        int64_t ad_153618;
        int64_t ox_153619;
        
        if (memblock_set(ctx, &mem_param_171341, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171344, &mem_param_171282, "mem_param_171282") != 0)
            return 1;
        loop_dz2084Uz2089U_153613 = loop_dz2088U_153527;
        loop_dz2085Uz2080U_153614 = loop_dz2089U_153528;
        q_153617 = p_153532;
        ad_153618 = (int64_t) 0;
        ox_153619 = (int64_t) 0;
        for (int64_t i_153612 = 0; i_153612 < m_153571; i_153612++) {
            int64_t bounds_153620 = ((int64_t *) mem_171320)[i_153612];
            int64_t bounds_153621 = ((int64_t *) mem_171318)[i_153612];
            int64_t bounds_153622 = ((int64_t *) mem_171316)[i_153612];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_153623 = sub64(bounds_153621, bounds_153620);
            bool empty_slice_153624 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_153623 == (int64_t) 0;
            int64_t m_153625 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_153623, (int64_t) 1);
            int64_t i_p_m_t_s_153626 = add64(bounds_153620, m_153625);
            bool zzero_leq_i_p_m_t_s_153627 = sle64((int64_t) 0, i_p_m_t_s_153626);
            bool i_p_m_t_s_leq_w_153628 = slt64(i_p_m_t_s_153626, n_131688);
            bool zzero_lte_i_153629 = sle64((int64_t) 0, bounds_153620);
            bool i_lte_j_153630 = sle64(bounds_153620, bounds_153621);
            bool y_153631 = i_p_m_t_s_leq_w_153628 && zzero_lte_i_153629;
            bool y_153632 = zzero_leq_i_p_m_t_s_153627 && y_153631;
            bool forwards_ok_153633 = i_lte_j_153630 && y_153632;
            bool ok_or_empty_153634 = empty_slice_153624 || forwards_ok_153633;
            bool index_certs_153635;
            
            if (!ok_or_empty_153634) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_153620, ":", (long long) bounds_153621, "] out of bounds for array of shape [", (long long) n_131688, "].", "-> #0  ftHashJoin.fut:341:21-43\n   #1  ftRelational.fut:242:5-62\n   #2  ftRelational.fut:235:3-242:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171345 = b_131689 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_153623;
            
            if (memblock_alloc(ctx, &mem_171346, bytes_171345, "mem_171346")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171346.mem, (int64_t) 0, (int64_t []) {b_131689, (int64_t) 1}, (uint8_t *) pXs_mem_171274.mem, b_131689 * bounds_153620, (int64_t []) {b_131689, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_153623, b_131689});
            
            int64_t loopres_153637;
            int64_t loopres_153638;
            int32_t loopres_153641;
            
            if (futrts_getPartitionBounds_16843(ctx, &ext_mem_171349, &ext_mem_171348, &loopres_153637, &loopres_153638, &loopres_153641, mem_171346, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_153623, b_131689, zt_rhs_153602, new_i_153601, new_j_153604) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
                return 1;
            
            int64_t zm_lhs_153642 = add64(ox_153619, bounds_153622);
            int64_t stitch_153643 = sub64(zm_lhs_153642, ad_153618);
            bool empty_slice_153644 = stitch_153643 == (int64_t) 0;
            int64_t m_153645 = sub64(stitch_153643, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_153646 = sle64((int64_t) 0, m_153645);
            bool i_p_m_t_s_leq_w_153647 = slt64(m_153645, loop_dz2084Uz2089U_153613);
            bool i_lte_j_153648 = sle64((int64_t) 0, stitch_153643);
            bool y_153649 = zzero_leq_i_p_m_t_s_153646 && i_p_m_t_s_leq_w_153647;
            bool forwards_ok_153650 = i_lte_j_153648 && y_153649;
            bool ok_or_empty_153651 = empty_slice_153644 || forwards_ok_153650;
            bool index_certs_153652;
            
            if (!ok_or_empty_153651) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_153643, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_153613, "].", "-> #0  ftHashJoin.fut:349:18-36\n   #1  ftRelational.fut:242:5-62\n   #2  ftRelational.fut:235:3-242:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_153657 = loopres_153637 + stitch_153643;
            int64_t zpzp_rhs_153658 = add64((int64_t) 1, stitch_153643);
            int64_t j_m_i_153659 = sub64(loop_dz2084Uz2089U_153613, zpzp_rhs_153658);
            bool empty_slice_153660 = j_m_i_153659 == (int64_t) 0;
            int64_t m_153661 = sub64(j_m_i_153659, (int64_t) 1);
            int64_t i_p_m_t_s_153662 = add64(zpzp_rhs_153658, m_153661);
            bool zzero_leq_i_p_m_t_s_153663 = sle64((int64_t) 0, i_p_m_t_s_153662);
            bool i_p_m_t_s_leq_w_153664 = slt64(i_p_m_t_s_153662, loop_dz2084Uz2089U_153613);
            bool zzero_lte_i_153665 = sle64((int64_t) 0, zpzp_rhs_153658);
            bool i_lte_j_153666 = sle64(zpzp_rhs_153658, loop_dz2084Uz2089U_153613);
            bool y_153667 = i_p_m_t_s_leq_w_153664 && zzero_lte_i_153665;
            bool y_153668 = zzero_leq_i_p_m_t_s_153663 && y_153667;
            bool forwards_ok_153669 = i_lte_j_153666 && y_153668;
            bool ok_or_empty_153670 = empty_slice_153660 || forwards_ok_153669;
            bool index_certs_153671;
            
            if (!ok_or_empty_153670) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_153658, ":", (long long) loop_dz2084Uz2089U_153613, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_153613, "].", "-> #0  ftHashJoin.fut:349:90-126\n   #1  ftRelational.fut:242:5-62\n   #2  ftRelational.fut:235:3-242:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_153673 = conc_tmp_153657 + j_m_i_153659;
            int64_t bytes_171358 = (int64_t) 8 * conc_tmp_153673;
            bool i_p_m_t_s_leq_w_153675 = slt64(m_153645, loop_dz2085Uz2080U_153614);
            bool y_153676 = zzero_leq_i_p_m_t_s_153646 && i_p_m_t_s_leq_w_153675;
            bool ok_or_empty_153677 = empty_slice_153644 || y_153676;
            bool index_certs_153678;
            
            if (!ok_or_empty_153677) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_153643, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_153614, "].", "-> #0  ftHashJoin.fut:350:18-36\n   #1  ftRelational.fut:242:5-62\n   #2  ftRelational.fut:235:3-242:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_153680 = loopres_153638 + stitch_153643;
            int64_t j_m_i_153681 = sub64(loop_dz2085Uz2080U_153614, zpzp_rhs_153658);
            bool empty_slice_153682 = j_m_i_153681 == (int64_t) 0;
            int64_t m_153683 = sub64(j_m_i_153681, (int64_t) 1);
            int64_t i_p_m_t_s_153684 = add64(zpzp_rhs_153658, m_153683);
            bool zzero_leq_i_p_m_t_s_153685 = sle64((int64_t) 0, i_p_m_t_s_153684);
            bool i_p_m_t_s_leq_w_153686 = slt64(i_p_m_t_s_153684, loop_dz2085Uz2080U_153614);
            bool i_lte_j_153687 = sle64(zpzp_rhs_153658, loop_dz2085Uz2080U_153614);
            bool y_153688 = zzero_lte_i_153665 && i_p_m_t_s_leq_w_153686;
            bool y_153689 = zzero_leq_i_p_m_t_s_153685 && y_153688;
            bool forwards_ok_153690 = i_lte_j_153687 && y_153689;
            bool ok_or_empty_153691 = empty_slice_153682 || forwards_ok_153690;
            bool index_certs_153692;
            
            if (!ok_or_empty_153691) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_153658, ":", (long long) loop_dz2085Uz2080U_153614, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_153614, "].", "-> #0  ftHashJoin.fut:350:62-98\n   #1  ftRelational.fut:242:5-62\n   #2  ftRelational.fut:235:3-242:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_153694 = conc_tmp_153680 + j_m_i_153681;
            int64_t bytes_171360 = (int64_t) 4 * conc_tmp_153694;
            
            if (memblock_alloc(ctx, &mem_171359, bytes_171358, "mem_171359")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171030 = 0; i_171030 < loopres_153637; i_171030++) {
                int64_t eta_p_153655 = ((int64_t *) ext_mem_171349.mem)[i_171030];
                int64_t lifted_lambda_res_153656 = add64(bounds_153620, eta_p_153655);
                
                ((int64_t *) mem_171359.mem)[stitch_153643 + i_171030] = lifted_lambda_res_153656;
            }
            if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
                return 1;
            
            int64_t tmp_offs_171988 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171359.mem, tmp_offs_171988, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_153643});
            tmp_offs_171988 += stitch_153643;
            if (!(tmp_offs_171988 == stitch_153643)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171359.mem, tmp_offs_171988, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171359.mem, stitch_153643, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_153637});
            }
            tmp_offs_171988 += loopres_153637;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171359.mem, tmp_offs_171988, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171341.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_153658, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_153659});
            tmp_offs_171988 += j_m_i_153659;
            if (memblock_alloc(ctx, &mem_171361, bytes_171360, "mem_171361")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_171989 = (int64_t) 0;
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171361.mem, tmp_offs_171989, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_153643});
            tmp_offs_171989 += stitch_153643;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171361.mem, tmp_offs_171989, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171348.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_153638});
            tmp_offs_171989 += loopres_153638;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171361.mem, tmp_offs_171989, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171344.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_153658, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_153681});
            tmp_offs_171989 += j_m_i_153681;
            if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
                return 1;
            
            int64_t tmp_153696 = add64((int64_t) 1, ad_153618);
            int64_t tmp_153697 = add64(ox_153619, loopres_153637);
            
            if (memblock_set(ctx, &mem_param_tmp_171978, &mem_171359, "mem_171359") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171979, &mem_171361, "mem_171361") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2089U_tmp_171980 = conc_tmp_153673;
            int64_t loop_dz2085Uz2080U_tmp_171981 = conc_tmp_153694;
            int32_t q_tmp_171984 = zt_rhs_153602;
            int64_t ad_tmp_171985 = tmp_153696;
            int64_t ox_tmp_171986 = tmp_153697;
            
            if (memblock_set(ctx, &mem_param_171341, &mem_param_tmp_171978, "mem_param_tmp_171978") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171344, &mem_param_tmp_171979, "mem_param_tmp_171979") != 0)
                return 1;
            loop_dz2084Uz2089U_153613 = loop_dz2084Uz2089U_tmp_171980;
            loop_dz2085Uz2080U_153614 = loop_dz2085Uz2080U_tmp_171981;
            q_153617 = q_tmp_171984;
            ad_153618 = ad_tmp_171985;
            ox_153619 = ox_tmp_171986;
        }
        if (memblock_set(ctx, &ext_mem_171367, &mem_param_171341, "mem_param_171341") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171366, &mem_param_171344, "mem_param_171344") != 0)
            return 1;
        loopres_153605 = loop_dz2084Uz2089U_153613;
        loopres_153606 = loop_dz2085Uz2080U_153614;
        loopres_153609 = q_153617;
        loopres_153610 = ad_153618;
        loopres_153611 = ox_153619;
        
        bool tmp_153698 = slt64((int64_t) 0, m_153571);
        bool cond_153699 = slt32(loopres_153609, max_depth_131694);
        bool x_153700 = tmp_153698 && cond_153699;
        
        if (memblock_set(ctx, &mem_param_tmp_171960, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171961, &ext_mem_171366, "ext_mem_171366") != 0)
            return 1;
        
        int64_t loop_dz2088U_tmp_171962 = loopres_153605;
        int64_t loop_dz2089U_tmp_171963 = loopres_153606;
        bool loop_while_tmp_171964 = x_153700;
        int32_t p_tmp_171967 = loopres_153609;
        
        if (memblock_set(ctx, &mem_param_171279, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171282, &mem_param_tmp_171961, "mem_param_tmp_171961") != 0)
            return 1;
        loop_dz2088U_153527 = loop_dz2088U_tmp_171962;
        loop_dz2089U_153528 = loop_dz2089U_tmp_171963;
        loop_while_153529 = loop_while_tmp_171964;
        p_153532 = p_tmp_171967;
    }
    if (memblock_set(ctx, &ext_mem_171373, &mem_param_171279, "mem_param_171279") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171372, &mem_param_171282, "mem_param_171282") != 0)
        return 1;
    calc_partInfo_res_153521 = loop_dz2088U_153527;
    calc_partInfo_res_153522 = loop_dz2089U_153528;
    calc_partInfo_res_153523 = loop_while_153529;
    calc_partInfo_res_153526 = p_153532;
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    
    int64_t bytes_171374 = (int64_t) 8 * calc_partInfo_res_153521;
    bool dim_match_153704 = calc_partInfo_res_153521 == calc_partInfo_res_153522;
    bool empty_or_match_cert_153705;
    
    if (!dim_match_153704) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) calc_partInfo_res_153522, "] cannot match shape of type `[", (long long) calc_partInfo_res_153521, "]i32`.", "-> #0  ftHashJoin.fut:358:14-54\n   #1  ftRelational.fut:242:5-62\n   #2  ftRelational.fut:235:3-242:62\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171375, bytes_171374, "mem_171375")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171034 = 0; i_171034 < calc_partInfo_res_153521; i_171034++) {
        int64_t eta_p_153702 = ((int64_t *) ext_mem_171373.mem)[i_171034];
        int64_t lifted_lambda_res_153703 = add64(offset_131692, eta_p_153702);
        
        ((int64_t *) mem_171375.mem)[i_171034] = lifted_lambda_res_153703;
    }
    if (memblock_unref(ctx, &ext_mem_171373, "ext_mem_171373") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171375, "mem_171375") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171372, "ext_mem_171372") != 0)
        return 1;
    prim_out_171958 = calc_partInfo_res_153521;
    prim_out_171959 = calc_partInfo_res_153526;
    if (memblock_set(ctx, &*mem_out_p_172224, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172225, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172226 = prim_out_171958;
    *out_prim_out_172227 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171284);
        free(mem_171286);
        free(mem_171288);
        free(mem_171290);
        free(mem_171316);
        free(mem_171318);
        free(mem_171320);
        if (memblock_unref(ctx, &mem_171375, "mem_171375") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171961, "mem_param_tmp_171961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171979, "mem_param_tmp_171979") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171978, "mem_param_tmp_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171361, "mem_171361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171359, "mem_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171344, "mem_param_171344") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171341, "mem_param_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171366, "ext_mem_171366") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171282, "mem_param_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171372, "ext_mem_171372") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171373, "ext_mem_171373") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172235, struct memblock *mem_out_p_172236, int64_t *out_prim_out_172237, struct memblock pXs_mem_171274, struct memblock bounds_mem_171275, struct memblock depths_mem_171276, int64_t n_132270, int64_t b_132271, int64_t dz2080U_132272, int64_t dz2081U_132273, int32_t radix_sizze_132274, int32_t maxDepth_132278, int64_t scatter_psizze_132279)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171278_cached_sizze_172238 = 0;
    unsigned char *mem_171278 = NULL;
    int64_t mem_171282_cached_sizze_172239 = 0;
    unsigned char *mem_171282 = NULL;
    struct memblock mem_171316;
    
    mem_171316.references = NULL;
    
    struct memblock mem_171314;
    
    mem_171314.references = NULL;
    
    struct memblock mem_171293;
    
    mem_171293.references = NULL;
    
    struct memblock mem_171292;
    
    mem_171292.references = NULL;
    
    struct memblock mem_171306;
    
    mem_171306.references = NULL;
    
    struct memblock ext_mem_171309;
    
    ext_mem_171309.references = NULL;
    
    struct memblock ext_mem_171312;
    
    ext_mem_171312.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t i32_res_153304 = sext_i32_i64(radix_sizze_132274);
    bool nonnegative_153305 = sle64((int64_t) 0, i32_res_153304);
    bool nonzzero_cert_153306;
    
    if (!nonnegative_153305) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:387:52-57\n   #1  ftRelational.fut:247:6-250:58\n   #2  ftRelational.fut:244:3-250:58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307 = shl64((int64_t) 1, i32_res_153304);
    int32_t getRadix_arg1_153309 = sub32(radix_sizze_132274, 1);
    int32_t zm_lhs_153310 = add32(8, radix_sizze_132274);
    int32_t zs_lhs_153311 = sub32(zm_lhs_153310, 1);
    int32_t i32_arg0_153312 = sdiv32(zs_lhs_153311, 8);
    int64_t i32_res_153313 = sext_i32_i64(i32_arg0_153312);
    bool bounds_invalid_upwards_153314 = slt64(i32_res_153313, (int64_t) 0);
    bool valid_153315 = !bounds_invalid_upwards_153314;
    bool range_valid_c_153316;
    
    if (!valid_153315) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) i32_res_153313, " is invalid.", "-> #0  ftHashJoin.fut:41:15-30\n   #1  ftHashJoin.fut:372:20-67\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:247:6-250:58\n   #4  ftRelational.fut:244:3-250:58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t i64_res_161778 = sext_i64_i32(b_132271);
    int32_t zm_lhs_161779 = mul32(8, i64_res_161778);
    int32_t min_arg1_161780 = sub32(zm_lhs_161779, 1);
    int32_t min_res_161781 = smin32(getRadix_arg1_153309, min_arg1_161780);
    int32_t i32_arg0_161785 = sub32(i64_res_161778, 1);
    int64_t i32_res_161786 = sext_i32_i64(i32_arg0_161785);
    int32_t zm_rhs_161788 = sdiv32(min_res_161781, 8);
    int32_t zm_lhs_161789 = sub32(i64_res_161778, zm_rhs_161788);
    int32_t i32_arg0_161790 = sub32(zm_lhs_161789, 1);
    int64_t i32_res_161791 = sext_i32_i64(i32_arg0_161790);
    int64_t zm_lhs_161792 = mul64((int64_t) 8, b_132271);
    int64_t min_arg1_161793 = sub64(zm_lhs_161792, (int64_t) 1);
    int64_t min_res_161794 = smin64(i32_res_161791, min_arg1_161793);
    bool x_161811 = sle64((int64_t) 0, i32_res_161786);
    bool y_161812 = slt64(i32_res_161786, b_132271);
    bool bounds_check_161813 = x_161811 && y_161812;
    bool index_certs_161814;
    
    if (!bounds_check_161813) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_161786, "] out of bounds for array of shape [", (long long) b_132271, "].", "-> #0  ftHashJoin.fut:32:48-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_161822 = sle64((int64_t) 0, min_res_161794);
    bool y_161823 = slt64(min_res_161794, b_132271);
    bool bounds_check_161824 = x_161822 && y_161823;
    bool index_certs_161825;
    
    if (!bounds_check_161824) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_161794, "] out of bounds for array of shape [", (long long) b_132271, "].", "-> #0  ftHashJoin.fut:33:38-54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171277 = (int64_t) 8 * dz2080U_132272;
    int64_t bytes_171313 = (int64_t) 8 * dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307;
    int32_t lastBit_161796 = smod32(min_res_161781, 8);
    int32_t zm_lhs_161799 = sub32(8, lastBit_161796);
    int32_t i32_arg0_161800 = sub32(zm_lhs_161799, 1);
    int8_t unsign_arg0_161801 = zext_i32_i8(i32_arg0_161800);
    int8_t unsign_arg0_161802 = lshr8((int8_t) -1, unsign_arg0_161801);
    
    if (mem_171278_cached_sizze_172238 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172238, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171282_cached_sizze_172239 < b_132271) {
        err = lexical_realloc(ctx, &mem_171282, &mem_171282_cached_sizze_172239, b_132271);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171007 = 0; i_171007 < dz2080U_132272; i_171007++) {
        int64_t radix_to_idx_arg1_153323 = ((int64_t *) bounds_mem_171275.mem)[i_171007];
        bool x_153324 = sle64((int64_t) 0, radix_to_idx_arg1_153323);
        bool y_153325 = slt64(radix_to_idx_arg1_153323, n_132270);
        bool bounds_check_153326 = x_153324 && y_153325;
        bool index_certs_153327;
        
        if (!bounds_check_153326) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_arg1_153323, "] out of bounds for array of shape [", (long long) n_132270, "].", "-> #0  ftHashJoin.fut:372:46-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:247:6-250:58\n   #3  ftRelational.fut:244:3-250:58\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < b_132271; i_171003++) {
            int8_t eta_p_161806 = ((int8_t *) pXs_mem_171274.mem)[radix_to_idx_arg1_153323 * b_132271 + i_171003];
            bool cond_161807 = sle64(i_171003, i32_res_161786);
            bool cond_t_res_161808 = sle64(min_res_161794, i_171003);
            bool x_161809 = cond_161807 && cond_t_res_161808;
            int8_t lifted_lambda_res_161810;
            
            if (x_161809) {
                lifted_lambda_res_161810 = eta_p_161806;
            } else {
                lifted_lambda_res_161810 = (int8_t) 0;
            }
            ((int8_t *) mem_171282)[i_171003] = lifted_lambda_res_161810;
        }
        
        int8_t za_lhs_161815 = ((int8_t *) mem_171282)[i32_res_161786];
        int8_t mod1_x_161816 = (int8_t) -1 & za_lhs_161815;
        
        ((int8_t *) mem_171282)[i32_res_161786] = mod1_x_161816;
        
        int8_t za_lhs_161826 = ((int8_t *) mem_171282)[min_res_161794];
        int8_t tmp_161827 = unsign_arg0_161802 & za_lhs_161826;
        
        ((int8_t *) mem_171282)[min_res_161794] = tmp_161827;
        
        int64_t radix_to_idx_res_153330;
        int64_t y_153332 = (int64_t) 0;
        
        for (int64_t i_153331 = 0; i_153331 < i32_res_153313; i_153331++) {
            int64_t zm_lhs_153333 = sub64(b_132271, i_153331);
            int64_t u8_arg0_153334 = sub64(zm_lhs_153333, (int64_t) 1);
            bool x_153335 = sle64((int64_t) 0, u8_arg0_153334);
            bool y_153336 = slt64(u8_arg0_153334, b_132271);
            bool bounds_check_153337 = x_153335 && y_153336;
            bool index_certs_153338;
            
            if (!bounds_check_153337) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_arg0_153334, "] out of bounds for array of shape [", (long long) b_132271, "].", "-> #0  ftHashJoin.fut:42:23-33\n   #1  ftHashJoin.fut:372:20-67\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:247:6-250:58\n   #4  ftRelational.fut:244:3-250:58\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t u8_arg0_153339 = ((int8_t *) mem_171282)[u8_arg0_153334];
            int64_t u8_res_153340 = zext_i8_i64(u8_arg0_153339);
            int64_t zlzl_rhs_153341 = mul64((int64_t) 8, i_153331);
            int64_t r_153342 = shl64(u8_res_153340, zlzl_rhs_153341);
            int64_t loopres_153343 = y_153332 | r_153342;
            int64_t y_tmp_171961 = loopres_153343;
            
            y_153332 = y_tmp_171961;
        }
        radix_to_idx_res_153330 = y_153332;
        ((int64_t *) mem_171278)[i_171007] = radix_to_idx_res_153330;
    }
    
    bool cond_153347 = maxDepth_132278 == 1;
    
    if (cond_153347) {
        if (memblock_alloc(ctx, &mem_171306, dz2080U_132272, "mem_171306")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171962 = 0; nest_i_171962 < dz2080U_132272; nest_i_171962++) {
            ((bool *) mem_171306.mem)[nest_i_171962] = 1;
        }
        if (memblock_set(ctx, &ext_mem_171312, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171309, &mem_171306, "mem_171306") != 0)
            return 1;
    } else {
        int64_t zeze_rhs_153351 = sub64(dz2080U_132272, (int64_t) 1);
        
        if (memblock_alloc(ctx, &mem_171292, dz2080U_132272, "mem_171292")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171293, dz2080U_132272, "mem_171293")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171013 = 0; i_171013 < dz2080U_132272; i_171013++) {
            int64_t cur_i_153359 = ((int64_t *) mem_171278)[i_171013];
            bool cond_153360 = i_171013 == (int64_t) 0;
            int64_t pre_i_153361;
            
            if (cond_153360) {
                pre_i_153361 = (int64_t) -1;
            } else {
                int64_t tmp_153362 = sub64(i_171013, (int64_t) 1);
                bool x_153363 = sle64((int64_t) 0, tmp_153362);
                bool y_153364 = slt64(tmp_153362, dz2080U_132272);
                bool bounds_check_153365 = x_153363 && y_153364;
                bool index_certs_153366;
                
                if (!bounds_check_153365) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_153362, "] out of bounds for array of shape [", (long long) dz2080U_132272, "].", "-> #0  ftHashJoin.fut:379:42-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:377:10-384:8\n   #3  ftRelational.fut:247:6-250:58\n   #4  ftRelational.fut:244:3-250:58\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pre_i_f_res_153367 = ((int64_t *) mem_171278)[tmp_153362];
                
                pre_i_153361 = pre_i_f_res_153367;
            }
            
            bool is_first_153368 = cur_i_153359 == pre_i_153361;
            bool is_first_153369 = !is_first_153368;
            bool cond_153370 = i_171013 == zeze_rhs_153351;
            int64_t pos_i_153371;
            
            if (cond_153370) {
                pos_i_153371 = (int64_t) -1;
            } else {
                int64_t tmp_153372 = add64((int64_t) 1, i_171013);
                bool x_153373 = sle64((int64_t) 0, tmp_153372);
                bool y_153374 = slt64(tmp_153372, dz2080U_132272);
                bool bounds_check_153375 = x_153373 && y_153374;
                bool index_certs_153376;
                
                if (!bounds_check_153375) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_153372, "] out of bounds for array of shape [", (long long) dz2080U_132272, "].", "-> #0  ftHashJoin.fut:381:46-78\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:377:10-384:8\n   #3  ftRelational.fut:247:6-250:58\n   #4  ftRelational.fut:244:3-250:58\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pos_i_f_res_153377 = ((int64_t *) mem_171278)[tmp_153372];
                
                pos_i_153371 = pos_i_f_res_153377;
            }
            
            bool is_last_153378 = cur_i_153359 == pos_i_153371;
            bool is_last_153379 = !is_last_153378;
            
            ((bool *) mem_171292.mem)[i_171013] = is_first_153369;
            ((bool *) mem_171293.mem)[i_171013] = is_last_153379;
        }
        if (memblock_set(ctx, &ext_mem_171312, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171309, &mem_171293, "mem_171293") != 0)
            return 1;
    }
    if (memblock_alloc(ctx, &mem_171314, bytes_171313, "mem_171314")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171965 = 0; nest_i_171965 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307; nest_i_171965++) {
        ((int64_t *) mem_171314.mem)[nest_i_171965] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171316, bytes_171313, "mem_171316")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171966 = 0; nest_i_171966 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307; nest_i_171966++) {
        ((int64_t *) mem_171316.mem)[nest_i_171966] = (int64_t) -1;
    }
    for (int64_t write_iter_171016 = 0; write_iter_171016 < dz2080U_132272; write_iter_171016++) {
        bool write_iv_171019 = ((bool *) ext_mem_171309.mem)[write_iter_171016];
        bool write_iv_171021 = ((bool *) ext_mem_171312.mem)[write_iter_171016];
        int64_t lifted_lambda_res_161998;
        
        if (write_iv_171021) {
            int64_t lifted_lambda_res_t_res_162037 = ((int64_t *) mem_171278)[write_iter_171016];
            
            lifted_lambda_res_161998 = lifted_lambda_res_t_res_162037;
        } else {
            lifted_lambda_res_161998 = (int64_t) -1;
        }
        
        int64_t lifted_lambda_res_162006;
        
        if (write_iv_171019) {
            int64_t lifted_lambda_res_t_res_162042 = ((int64_t *) mem_171278)[write_iter_171016];
            
            lifted_lambda_res_162006 = lifted_lambda_res_t_res_162042;
        } else {
            lifted_lambda_res_162006 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162006) && slt64(lifted_lambda_res_162006, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307)) {
            ((int64_t *) mem_171314.mem)[lifted_lambda_res_162006] = write_iter_171016;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161998) && slt64(lifted_lambda_res_161998, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307)) {
            ((int64_t *) mem_171316.mem)[lifted_lambda_res_161998] = write_iter_171016;
        }
    }
    if (memblock_unref(ctx, &ext_mem_171309, "ext_mem_171309") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171312, "ext_mem_171312") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171316, "mem_171316") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171314, "mem_171314") != 0)
        return 1;
    prim_out_171958 = dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153307;
    if (memblock_set(ctx, &*mem_out_p_172235, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172236, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172237 = prim_out_171958;
    
  cleanup:
    {
        free(mem_171278);
        free(mem_171282);
        if (memblock_unref(ctx, &mem_171316, "mem_171316") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171314, "mem_171314") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171293, "mem_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171309, "ext_mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171312, "ext_mem_171312") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172240, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149856, int64_t group_no_149857)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    bool bounds_invalid_upwards_161778 = slt64(group_no_149857, (int64_t) 0);
    bool valid_161779 = !bounds_invalid_upwards_161778;
    bool range_valid_c_161780;
    
    if (!valid_161779) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149857, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:41-43\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:334:24-52\n   #4  ftRelational.fut:334:5-52\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171276 = (int64_t) 8 * group_no_149857;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149857; nest_i_171957++) {
        ((double *) mem_171277.mem)[nest_i_171957] = 0.0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149856; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        double pixel_171004 = ((double *) eta_p_mem_171275.mem)[iter_171001];
        bool less_than_zzero_171005 = slt64(pixel_171003, (int64_t) 0);
        bool greater_than_sizze_171006 = sle64(group_no_149857, pixel_171003);
        bool outside_bounds_dim_171007 = less_than_zzero_171005 || greater_than_sizze_171006;
        
        if (!outside_bounds_dim_171007) {
            double read_hist_171009 = ((double *) mem_171277.mem)[pixel_171003];
            double zp_res_161785 = pixel_171004 + read_hist_171009;
            
            ((double *) mem_171277.mem)[pixel_171003] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172240, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172241, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149933, int64_t group_no_149934)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * group_no_149934;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149934; nest_i_171957++) {
        ((double *) mem_171278.mem)[nest_i_171957] = 0.0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149933; iter_171001++) {
        double pixel_171003 = ((double *) eta_p_mem_171275.mem)[iter_171001];
        double pixel_171004 = ((double *) eta_p_mem_171276.mem)[iter_171001];
        int64_t pixel_171005 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        double zt_res_161974 = pixel_171003 * pixel_171004;
        bool less_than_zzero_171006 = slt64(pixel_171005, (int64_t) 0);
        bool greater_than_sizze_171007 = sle64(group_no_149934, pixel_171005);
        bool outside_bounds_dim_171008 = less_than_zzero_171006 || greater_than_sizze_171007;
        
        if (!outside_bounds_dim_171008) {
            double read_hist_171010 = ((double *) mem_171278.mem)[pixel_171005];
            double zp_res_161785 = zt_res_161974 + read_hist_171010;
            
            ((double *) mem_171278.mem)[pixel_171005] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172241, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172242, struct memblock ks_mem_171274, int64_t nz2082U_143157, int64_t key_no_143158)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    bool bounds_invalid_upwards_152815 = slt64(key_no_143158, (int64_t) 0);
    bool valid_152816 = !bounds_invalid_upwards_152815;
    bool range_valid_c_152817;
    
    if (!valid_152816) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) key_no_143158, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:40:31-44\n   #2  ftRelational.fut:274:7-38\n   #3  ftRelational.fut:273:5-274:38\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * key_no_143158;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < key_no_143158; nest_i_171957++) {
        ((int64_t *) mem_171276.mem)[nest_i_171957] = (int64_t) 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2082U_143157; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) ks_mem_171274.mem)[iter_171001];
        bool less_than_zzero_171005 = slt64(pixel_171003, (int64_t) 0);
        bool greater_than_sizze_171006 = sle64(key_no_143158, pixel_171003);
        bool outside_bounds_dim_171007 = less_than_zzero_171005 || greater_than_sizze_171006;
        
        if (!outside_bounds_dim_171007) {
            int64_t read_hist_171009 = ((int64_t *) mem_171276.mem)[pixel_171003];
            int64_t defunc_0_op_res_152822 = add64((int64_t) 1, read_hist_171009);
            
            ((int64_t *) mem_171276.mem)[pixel_171003] = defunc_0_op_res_152822;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172242, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172243, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149645, int64_t group_no_149646)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    bool bounds_invalid_upwards_161778 = slt64(group_no_149646, (int64_t) 0);
    bool valid_161779 = !bounds_invalid_upwards_161778;
    bool range_valid_c_161780;
    
    if (!valid_161779) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149646, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:41-43\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:331:23-50\n   #4  ftRelational.fut:331:5-50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171276 = (int64_t) 4 * group_no_149646;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149646; nest_i_171957++) {
        ((float *) mem_171277.mem)[nest_i_171957] = 0.0F;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149645; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        float pixel_171004 = ((float *) eta_p_mem_171275.mem)[iter_171001];
        bool less_than_zzero_171005 = slt64(pixel_171003, (int64_t) 0);
        bool greater_than_sizze_171006 = sle64(group_no_149646, pixel_171003);
        bool outside_bounds_dim_171007 = less_than_zzero_171005 || greater_than_sizze_171006;
        
        if (!outside_bounds_dim_171007) {
            float read_hist_171009 = ((float *) mem_171277.mem)[pixel_171003];
            float zp_res_161785 = pixel_171004 + read_hist_171009;
            
            ((float *) mem_171277.mem)[pixel_171003] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172243, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172244, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149722, int64_t group_no_149723)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 4 * group_no_149723;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149723; nest_i_171957++) {
        ((float *) mem_171278.mem)[nest_i_171957] = 0.0F;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149722; iter_171001++) {
        float pixel_171003 = ((float *) eta_p_mem_171275.mem)[iter_171001];
        float pixel_171004 = ((float *) eta_p_mem_171276.mem)[iter_171001];
        int64_t pixel_171005 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        float zt_res_161974 = pixel_171003 * pixel_171004;
        bool less_than_zzero_171006 = slt64(pixel_171005, (int64_t) 0);
        bool greater_than_sizze_171007 = sle64(group_no_149723, pixel_171005);
        bool outside_bounds_dim_171008 = less_than_zzero_171006 || greater_than_sizze_171007;
        
        if (!outside_bounds_dim_171008) {
            float read_hist_171010 = ((float *) mem_171278.mem)[pixel_171005];
            float zp_res_161785 = zt_res_161974 + read_hist_171010;
            
            ((float *) mem_171278.mem)[pixel_171005] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172244, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_172245, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_81485, int64_t dz2083U_81486, int64_t incr_81487, int64_t psizze_81488, int64_t pL_bytes_81490)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172246 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock ext_mem_171301;
    
    ext_mem_171301.references = NULL;
    
    struct memblock mem_171291;
    
    mem_171291.references = NULL;
    
    struct memblock mem_param_171289;
    
    mem_param_171289.references = NULL;
    
    struct memblock ext_mem_171309;
    
    ext_mem_171309.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int32_t i64_res_153301 = sext_i64_i32(pL_bytes_81490);
    int32_t gather_payloads_arg0_153302 = mul32(8, i64_res_153301);
    int64_t bytes_171276 = (int64_t) 8 * niz2084U_81485;
    int64_t bytes_171284 = niz2084U_81485 * pL_bytes_81490;
    int32_t zm_lhs_153307 = add32(8, gather_payloads_arg0_153302);
    int32_t zs_lhs_153308 = sub32(zm_lhs_153307, 1);
    int32_t i32_arg0_153309 = sdiv32(zs_lhs_153308, 8);
    int64_t i32_res_153310 = sext_i32_i64(i32_arg0_153309);
    bool zzero_153311 = i32_res_153310 == (int64_t) 0;
    bool nonzzero_153312 = !zzero_153311;
    bool nonzzero_cert_153313;
    
    if (!nonzzero_153312) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n   #1  ftRelational.fut:53:3-54:104\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_153314 = sdiv64(psizze_81488, i32_res_153310);
    int64_t max_res_153315 = smax64((int64_t) 1, max_arg1_153314);
    int64_t zm_lhs_153316 = add64(dz2083U_81486, max_res_153315);
    int64_t zs_lhs_153317 = sub64(zm_lhs_153316, (int64_t) 1);
    bool zzero_153318 = max_res_153315 == (int64_t) 0;
    bool nonzzero_153319 = !zzero_153318;
    bool nonzzero_cert_153320;
    
    if (!nonzzero_153319) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n   #1  ftRelational.fut:53:3-54:104\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_153321 = sdiv64(zs_lhs_153317, max_res_153315);
    bool bounds_invalid_upwards_153322 = slt64(max_iter_153321, (int64_t) 0);
    bool valid_153323 = !bounds_invalid_upwards_153322;
    bool range_valid_c_153324;
    
    if (!valid_153323) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_153321, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n   #2  ftRelational.fut:53:3-54:104\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171277_cached_sizze_172246 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172246, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < niz2084U_81485; i_171003++) {
        int64_t eta_p_153304 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_153305 = sub64(eta_p_153304, incr_81487);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_153305;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < niz2084U_81485; nest_i_171958++) {
        for (int64_t nest_i_171959 = 0; nest_i_171959 < pL_bytes_81490; nest_i_171959++) {
            ((int8_t *) mem_171285.mem)[nest_i_171958 * pL_bytes_81490 + nest_i_171959] = (int8_t) 0;
        }
    }
    if (memblock_set(ctx, &mem_param_171289, &mem_171285, "mem_171285") != 0)
        return 1;
    for (int64_t i_153326 = 0; i_153326 < max_iter_153321; i_153326++) {
        int64_t inf_153328 = mul64(max_res_153315, i_153326);
        int64_t min_arg1_153329 = add64(max_res_153315, inf_153328);
        int64_t min_res_153330 = smin64(dz2083U_81486, min_arg1_153329);
        
        if (memblock_alloc(ctx, &mem_171291, bytes_171284, "mem_171291")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171007 = 0; i_171007 < niz2084U_81485; i_171007++) {
            int64_t eta_p_153332 = ((int64_t *) mem_171277)[i_171007];
            bool cond_153334 = sle64(inf_153328, eta_p_153332);
            bool cond_t_res_153335 = slt64(eta_p_153332, min_res_153330);
            bool x_153336 = cond_153334 && cond_t_res_153335;
            int64_t binop_y_171296 = pL_bytes_81490 * i_171007;
            int64_t lmad_ext_171298 = pL_bytes_81490 * eta_p_153332;
            int64_t ext_171300;
            
            if (x_153336) {
                ext_171300 = lmad_ext_171298;
            } else {
                ext_171300 = binop_y_171296;
            }
            if (x_153336) {
                bool x_161970 = sle64((int64_t) 0, eta_p_153332);
                bool y_161971 = slt64(eta_p_153332, dz2083U_81486);
                bool bounds_check_161972 = x_161970 && y_161971;
                bool index_certs_161973;
                
                if (!bounds_check_161972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153332, "] out of bounds for array of shape [", (long long) dz2083U_81486, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n   #3  ftRelational.fut:53:3-54:104\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_set(ctx, &ext_mem_171301, &ys_mem_171275, "ys_mem_171275") != 0)
                    return 1;
            } else if (memblock_set(ctx, &ext_mem_171301, &mem_param_171289, "mem_param_171289") != 0)
                return 1;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171291.mem, i_171007 * pL_bytes_81490, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171301.mem, ext_171300, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_bytes_81490});
            if (memblock_unref(ctx, &ext_mem_171301, "ext_mem_171301") != 0)
                return 1;
        }
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171291, "mem_171291") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171289, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171309, &mem_param_171289, "mem_param_171289") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171309, "ext_mem_171309") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172245, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171301, "ext_mem_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171291, "mem_171291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171289, "mem_param_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171309, "ext_mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_172247, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_81118, int64_t dz2083U_81119, int64_t incr_81120, int64_t psizze_81121)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172248 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * niz2084U_81118;
    
    if (mem_171277_cached_sizze_172248 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172248, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < niz2084U_81118; i_171003++) {
        int64_t eta_p_152986 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152987 = sub64(eta_p_152986, incr_81120);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152987;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171276, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < niz2084U_81118; nest_i_171958++) {
        ((double *) mem_171285.mem)[nest_i_171958] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81118});
    if (futrts_partitioned_gather_over_array_15625(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, niz2084U_81118, dz2083U_81119, 64, psizze_81121) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172247, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172249, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81773, int64_t n_81774, int64_t incr_81775, int64_t psizze_81776)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171278_cached_sizze_172250 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock ext_mem_171288;
    
    ext_mem_171288.references = NULL;
    
    struct memblock mem_171286;
    
    mem_171286.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * ni_81773;
    
    if (mem_171278_cached_sizze_172250 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172250, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < ni_81773; i_171003++) {
        int64_t eta_p_152819 = ((int64_t *) is_mem_171275.mem)[i_171003];
        int64_t lifted_lambda_res_152820 = sub64(eta_p_152819, incr_81775);
        
        ((int64_t *) mem_171278)[i_171003] = lifted_lambda_res_152820;
    }
    if (memblock_alloc(ctx, &mem_171286, bytes_171277, "mem_171286")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171278, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_81773});
    if (futrts_partitioned_gather_over_array_15625(ctx, &ext_mem_171288, preVals_mem_171274, ys_mem_171276, mem_171286, ni_81773, n_81774, 64, psizze_81776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171288, "ext_mem_171288") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172249, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171278);
        if (memblock_unref(ctx, &ext_mem_171288, "ext_mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_172251, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_81053, int64_t dz2083U_81054, int64_t incr_81055, int64_t psizze_81056)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172252 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * niz2084U_81053;
    int64_t bytes_171284 = (int64_t) 4 * niz2084U_81053;
    
    if (mem_171277_cached_sizze_172252 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172252, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < niz2084U_81053; i_171003++) {
        int64_t eta_p_152986 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152987 = sub64(eta_p_152986, incr_81055);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152987;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < niz2084U_81053; nest_i_171958++) {
        ((float *) mem_171285.mem)[nest_i_171958] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81053});
    if (futrts_partitioned_gather_over_array_15613(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, niz2084U_81053, dz2083U_81054, 32, psizze_81056) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172251, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172253, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81716, int64_t n_81717, int64_t incr_81718, int64_t psizze_81719)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171278_cached_sizze_172254 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock ext_mem_171288;
    
    ext_mem_171288.references = NULL;
    
    struct memblock mem_171286;
    
    mem_171286.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * ni_81716;
    
    if (mem_171278_cached_sizze_172254 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172254, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < ni_81716; i_171003++) {
        int64_t eta_p_152819 = ((int64_t *) is_mem_171275.mem)[i_171003];
        int64_t lifted_lambda_res_152820 = sub64(eta_p_152819, incr_81718);
        
        ((int64_t *) mem_171278)[i_171003] = lifted_lambda_res_152820;
    }
    if (memblock_alloc(ctx, &mem_171286, bytes_171277, "mem_171286")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171278, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_81716});
    if (futrts_partitioned_gather_over_array_15613(ctx, &ext_mem_171288, preVals_mem_171274, ys_mem_171276, mem_171286, ni_81716, n_81717, 32, psizze_81719) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171288, "ext_mem_171288") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172253, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171278);
        if (memblock_unref(ctx, &ext_mem_171288, "ext_mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_172255, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_80923, int64_t dz2083U_80924, int64_t incr_80925, int64_t psizze_80926)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172256 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * niz2084U_80923;
    int64_t bytes_171284 = (int64_t) 4 * niz2084U_80923;
    
    if (mem_171277_cached_sizze_172256 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172256, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < niz2084U_80923; i_171003++) {
        int64_t eta_p_152986 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152987 = sub64(eta_p_152986, incr_80925);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152987;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < niz2084U_80923; nest_i_171958++) {
        ((int32_t *) mem_171285.mem)[nest_i_171958] = 0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_80923});
    if (futrts_partitioned_gather_over_array_15590(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, niz2084U_80923, dz2083U_80924, 32, psizze_80926) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172255, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172257, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81602, int64_t n_81603, int64_t incr_81604, int64_t psizze_81605)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171278_cached_sizze_172258 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock ext_mem_171288;
    
    ext_mem_171288.references = NULL;
    
    struct memblock mem_171286;
    
    mem_171286.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * ni_81602;
    
    if (mem_171278_cached_sizze_172258 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172258, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < ni_81602; i_171003++) {
        int64_t eta_p_152819 = ((int64_t *) is_mem_171275.mem)[i_171003];
        int64_t lifted_lambda_res_152820 = sub64(eta_p_152819, incr_81604);
        
        ((int64_t *) mem_171278)[i_171003] = lifted_lambda_res_152820;
    }
    if (memblock_alloc(ctx, &mem_171286, bytes_171277, "mem_171286")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171278, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_81602});
    if (futrts_partitioned_gather_over_array_15590(ctx, &ext_mem_171288, preVals_mem_171274, ys_mem_171276, mem_171286, ni_81602, n_81603, 32, psizze_81605) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171288, "ext_mem_171288") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172257, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171278);
        if (memblock_unref(ctx, &ext_mem_171288, "ext_mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_172259, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_80988, int64_t dz2083U_80989, int64_t incr_80990, int64_t psizze_80991)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172260 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * niz2084U_80988;
    
    if (mem_171277_cached_sizze_172260 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172260, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < niz2084U_80988; i_171003++) {
        int64_t eta_p_152986 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152987 = sub64(eta_p_152986, incr_80990);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152987;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171276, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < niz2084U_80988; nest_i_171958++) {
        ((int64_t *) mem_171285.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_80988});
    if (futrts_partitioned_gather_over_array_15601(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, niz2084U_80988, dz2083U_80989, 64, psizze_80991) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172259, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172261, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81659, int64_t n_81660, int64_t incr_81661, int64_t psizze_81662)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171278_cached_sizze_172262 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock ext_mem_171288;
    
    ext_mem_171288.references = NULL;
    
    struct memblock mem_171286;
    
    mem_171286.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * ni_81659;
    
    if (mem_171278_cached_sizze_172262 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172262, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < ni_81659; i_171003++) {
        int64_t eta_p_152819 = ((int64_t *) is_mem_171275.mem)[i_171003];
        int64_t lifted_lambda_res_152820 = sub64(eta_p_152819, incr_81661);
        
        ((int64_t *) mem_171278)[i_171003] = lifted_lambda_res_152820;
    }
    if (memblock_alloc(ctx, &mem_171286, bytes_171277, "mem_171286")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171278, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_81659});
    if (futrts_partitioned_gather_over_array_15601(ctx, &ext_mem_171288, preVals_mem_171274, ys_mem_171276, mem_171286, ni_81659, n_81660, 64, psizze_81662) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171288, "ext_mem_171288") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172261, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171278);
        if (memblock_unref(ctx, &ext_mem_171288, "ext_mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_172263, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t niz2084U_80858, int64_t dz2083U_80859, int64_t incr_80860, int64_t psizze_80861)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172264 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * niz2084U_80858;
    int64_t bytes_171284 = (int64_t) 2 * niz2084U_80858;
    
    if (mem_171277_cached_sizze_172264 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172264, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < niz2084U_80858; i_171003++) {
        int64_t eta_p_152986 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152987 = sub64(eta_p_152986, incr_80860);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152987;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < niz2084U_80858; nest_i_171958++) {
        ((int16_t *) mem_171285.mem)[nest_i_171958] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_80858});
    if (futrts_partitioned_gather_over_array_15578(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, niz2084U_80858, dz2083U_80859, 16, psizze_80861) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172263, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172265, struct memblock preVals_mem_171274, struct memblock is_mem_171275, struct memblock ys_mem_171276, int64_t ni_81545, int64_t n_81546, int64_t incr_81547, int64_t psizze_81548)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171278_cached_sizze_172266 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock ext_mem_171288;
    
    ext_mem_171288.references = NULL;
    
    struct memblock mem_171286;
    
    mem_171286.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * ni_81545;
    
    if (mem_171278_cached_sizze_172266 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172266, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < ni_81545; i_171003++) {
        int64_t eta_p_152819 = ((int64_t *) is_mem_171275.mem)[i_171003];
        int64_t lifted_lambda_res_152820 = sub64(eta_p_152819, incr_81547);
        
        ((int64_t *) mem_171278)[i_171003] = lifted_lambda_res_152820;
    }
    if (memblock_alloc(ctx, &mem_171286, bytes_171277, "mem_171286")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171278, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_81545});
    if (futrts_partitioned_gather_over_array_15578(ctx, &ext_mem_171288, preVals_mem_171274, ys_mem_171276, mem_171286, ni_81545, n_81546, 16, psizze_81548) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171288, "ext_mem_171288") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172265, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171278);
        if (memblock_unref(ctx, &ext_mem_171288, "ext_mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171286, "mem_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_172267, struct memblock *mem_out_p_172268, struct memblock *mem_out_p_172269, int64_t *out_prim_out_172270, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_126913, int64_t nS_126914, int64_t offset_R_126917, int64_t offset_S_126918, int64_t partitionSizze_126919, int64_t scatter_psizze_126920)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171370_cached_sizze_172271 = 0;
    unsigned char *mem_171370 = NULL;
    int64_t mem_171372_cached_sizze_172272 = 0;
    unsigned char *mem_171372 = NULL;
    int64_t mem_171374_cached_sizze_172273 = 0;
    unsigned char *mem_171374 = NULL;
    int64_t mem_171376_cached_sizze_172274 = 0;
    unsigned char *mem_171376 = NULL;
    int64_t mem_171378_cached_sizze_172275 = 0;
    unsigned char *mem_171378 = NULL;
    int64_t mem_171380_cached_sizze_172276 = 0;
    unsigned char *mem_171380 = NULL;
    int64_t mem_171382_cached_sizze_172277 = 0;
    unsigned char *mem_171382 = NULL;
    int64_t mem_171426_cached_sizze_172278 = 0;
    unsigned char *mem_171426 = NULL;
    int64_t mem_171458_cached_sizze_172279 = 0;
    unsigned char *mem_171458 = NULL;
    int64_t mem_171460_cached_sizze_172280 = 0;
    unsigned char *mem_171460 = NULL;
    struct memblock mem_171520;
    
    mem_171520.references = NULL;
    
    struct memblock mem_171518;
    
    mem_171518.references = NULL;
    
    struct memblock mem_171516;
    
    mem_171516.references = NULL;
    
    struct memblock mem_param_tmp_172014;
    
    mem_param_tmp_172014.references = NULL;
    
    struct memblock mem_param_tmp_172013;
    
    mem_param_tmp_172013.references = NULL;
    
    struct memblock mem_param_tmp_172012;
    
    mem_param_tmp_172012.references = NULL;
    
    struct memblock mem_171487;
    
    mem_171487.references = NULL;
    
    struct memblock mem_171485;
    
    mem_171485.references = NULL;
    
    struct memblock mem_171483;
    
    mem_171483.references = NULL;
    
    struct memblock mem_param_171481;
    
    mem_param_171481.references = NULL;
    
    struct memblock mem_param_171478;
    
    mem_param_171478.references = NULL;
    
    struct memblock mem_param_171475;
    
    mem_param_171475.references = NULL;
    
    struct memblock ext_mem_171512;
    
    ext_mem_171512.references = NULL;
    
    struct memblock ext_mem_171513;
    
    ext_mem_171513.references = NULL;
    
    struct memblock ext_mem_171514;
    
    ext_mem_171514.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock mem_171436;
    
    mem_171436.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_171362;
    
    mem_171362.references = NULL;
    
    struct memblock mem_171360;
    
    mem_171360.references = NULL;
    
    struct memblock mem_param_tmp_171972;
    
    mem_param_tmp_171972.references = NULL;
    
    struct memblock mem_param_tmp_171971;
    
    mem_param_tmp_171971.references = NULL;
    
    struct memblock mem_171328;
    
    mem_171328.references = NULL;
    
    struct memblock mem_171326;
    
    mem_171326.references = NULL;
    
    struct memblock mem_param_tmp_171986;
    
    mem_param_tmp_171986.references = NULL;
    
    struct memblock mem_171315;
    
    mem_171315.references = NULL;
    
    struct memblock mem_param_171313;
    
    mem_param_171313.references = NULL;
    
    struct memblock ext_mem_171324;
    
    ext_mem_171324.references = NULL;
    
    struct memblock mem_param_tmp_171982;
    
    mem_param_tmp_171982.references = NULL;
    
    struct memblock mem_171301;
    
    mem_171301.references = NULL;
    
    struct memblock mem_param_171299;
    
    mem_param_171299.references = NULL;
    
    struct memblock ext_mem_171310;
    
    ext_mem_171310.references = NULL;
    
    struct memblock ext_mem_171343;
    
    ext_mem_171343.references = NULL;
    
    struct memblock ext_mem_171346;
    
    ext_mem_171346.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock ext_mem_171352;
    
    ext_mem_171352.references = NULL;
    
    struct memblock mem_param_171296;
    
    mem_param_171296.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171357;
    
    ext_mem_171357.references = NULL;
    
    struct memblock ext_mem_171358;
    
    ext_mem_171358.references = NULL;
    
    struct memblock mem_171290;
    
    mem_171290.references = NULL;
    
    struct memblock mem_171288;
    
    mem_171288.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock ext_mem_171367;
    
    ext_mem_171367.references = NULL;
    
    struct memblock ext_mem_171368;
    
    ext_mem_171368.references = NULL;
    
    struct memblock mem_171280;
    
    mem_171280.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock ext_mem_171276;
    
    ext_mem_171276.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t partitionSizze_153966 = sdiv64(partitionSizze_126919, (int64_t) 8);
    int64_t zm_lhs_153967 = add64(nR_126913, partitionSizze_153966);
    int64_t zs_lhs_153968 = sub64(zm_lhs_153967, (int64_t) 1);
    bool zzero_153969 = partitionSizze_153966 == (int64_t) 0;
    bool nonzzero_153970 = !zzero_153969;
    bool nonzzero_cert_153971;
    
    if (!nonzzero_153970) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_153972 = sdiv64(zs_lhs_153968, partitionSizze_153966);
    int64_t zm_lhs_153973 = add64(nS_126914, partitionSizze_153966);
    int64_t zs_lhs_153974 = sub64(zm_lhs_153973, (int64_t) 1);
    int64_t numIter_S_153975 = sdiv64(zs_lhs_153974, partitionSizze_153966);
    
    if (futrts_indicesWithIncrement_16342(ctx, &ext_mem_171276, tR_mem_171274, nR_126913, offset_R_126917) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171277 = (int64_t) 8 * nR_126913;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171960 = 0; nest_i_171960 < nR_126913; nest_i_171960++) {
        ((int64_t *) mem_171278.mem)[nest_i_171960] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171280, bytes_171277, "mem_171280")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171961 = 0; nest_i_171961 < nR_126913; nest_i_171961++) {
        ((int64_t *) mem_171280.mem)[nest_i_171961] = (int64_t) 0;
    }
    
    bool loop_cond_153979 = slt64((int64_t) 0, numIter_R_153972);
    bool defunc_0_mergeJoin_res_153980;
    int64_t defunc_0_mergeJoin_res_153981;
    int64_t defunc_0_mergeJoin_res_153984;
    bool loop_while_153985;
    int64_t iter_153986;
    int64_t first_relevant_in_S_153989;
    
    if (memblock_set(ctx, &mem_param_171283, &mem_171280, "mem_171280") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &mem_171278, "mem_171278") != 0)
        return 1;
    loop_while_153985 = loop_cond_153979;
    iter_153986 = (int64_t) 0;
    first_relevant_in_S_153989 = (int64_t) 0;
    while (loop_while_153985) {
        int64_t tR_start_153990 = mul64(partitionSizze_153966, iter_153986);
        int64_t min_arg1_153991 = add64(partitionSizze_153966, tR_start_153990);
        int64_t min_res_153992 = smin64(nR_126913, min_arg1_153991);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 = sub64(min_res_153992, tR_start_153990);
        bool empty_slice_153994 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 == (int64_t) 0;
        int64_t m_153995 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, (int64_t) 1);
        int64_t i_p_m_t_s_153996 = add64(tR_start_153990, m_153995);
        bool zzero_leq_i_p_m_t_s_153997 = sle64((int64_t) 0, i_p_m_t_s_153996);
        bool i_p_m_t_s_leq_w_153998 = slt64(i_p_m_t_s_153996, nR_126913);
        bool zzero_lte_i_153999 = sle64((int64_t) 0, tR_start_153990);
        bool i_lte_j_154000 = sle64(tR_start_153990, min_res_153992);
        bool y_154001 = i_p_m_t_s_leq_w_153998 && zzero_lte_i_153999;
        bool y_154002 = zzero_leq_i_p_m_t_s_153997 && y_154001;
        bool forwards_ok_154003 = i_lte_j_154000 && y_154002;
        bool ok_or_empty_154004 = empty_slice_153994 || forwards_ok_154003;
        bool index_certs_154005;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_126913, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171287 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993;
        bool cond_154009 = slt64(first_relevant_in_S_153989, numIter_S_153975);
        bool y_154010 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool loop_not_taken_154011 = !cond_154009;
        bool protect_assert_disj_154012 = y_154010 || loop_not_taken_154011;
        bool index_certs_154013;
        
        if (!protect_assert_disj_154012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154016 = sle64((int64_t) 0, m_153995);
        bool y_154017 = slt64(m_153995, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool bounds_check_154018 = x_154016 && y_154017;
        bool protect_assert_disj_154019 = loop_not_taken_154011 || bounds_check_154018;
        bool index_certs_154020;
        
        if (!protect_assert_disj_154019) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154251;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_126913, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:201:99-102\n   #4  ftRelational.fut:192:3-201:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171288, bytes_171287, "mem_171288")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171969 = 0; nest_i_171969 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171969++) {
            ((int64_t *) mem_171288.mem)[nest_i_171969] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171290, bytes_171287, "mem_171290")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171970 = 0; nest_i_171970 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171970++) {
            ((int64_t *) mem_171290.mem)[nest_i_171970] = (int64_t) 0;
        }
        
        double gt_lhs_154014;
        
        if (cond_154009) {
            double x_162598 = ((double *) tR_mem_171274.mem)[tR_start_153990];
            
            gt_lhs_154014 = x_162598;
        } else {
            gt_lhs_154014 = 0.0;
        }
        
        double lt_lhs_154021;
        
        if (cond_154009) {
            double x_162599 = ((double *) tR_mem_171274.mem)[i_p_m_t_s_153996];
            
            lt_lhs_154021 = x_162599;
        } else {
            lt_lhs_154021 = 0.0;
        }
        
        int64_t ext_171356;
        int64_t ext_171355;
        int64_t ext_171354;
        int64_t ext_171353;
        bool loopres_154023;
        int64_t loopres_154024;
        int64_t loopres_154027;
        bool loop_while_154028;
        int64_t s_iter_154029;
        int64_t minRelevant_154032;
        int64_t ctx_param_ext_171291;
        int64_t ctx_param_ext_171292;
        int64_t ctx_param_ext_171294;
        int64_t ctx_param_ext_171295;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171296, &mem_171288, "mem_171288") != 0)
            return 1;
        ctx_param_ext_171291 = (int64_t) 0;
        ctx_param_ext_171292 = (int64_t) 1;
        ctx_param_ext_171294 = (int64_t) 0;
        ctx_param_ext_171295 = (int64_t) 1;
        loop_while_154028 = cond_154009;
        s_iter_154029 = first_relevant_in_S_153989;
        minRelevant_154032 = first_relevant_in_S_153989;
        while (loop_while_154028) {
            int64_t tS_start_154033 = mul64(partitionSizze_153966, s_iter_154029);
            int64_t min_arg1_154034 = add64(partitionSizze_153966, tS_start_154033);
            int64_t min_res_154035 = smin64(nS_126914, min_arg1_154034);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 = sub64(min_res_154035, tS_start_154033);
            bool empty_slice_154037 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 == (int64_t) 0;
            int64_t m_154038 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, (int64_t) 1);
            int64_t i_p_m_t_s_154039 = add64(tS_start_154033, m_154038);
            bool zzero_leq_i_p_m_t_s_154040 = sle64((int64_t) 0, i_p_m_t_s_154039);
            bool i_p_m_t_s_leq_w_154041 = slt64(i_p_m_t_s_154039, nS_126914);
            bool zzero_lte_i_154042 = sle64((int64_t) 0, tS_start_154033);
            bool i_lte_j_154043 = sle64(tS_start_154033, min_res_154035);
            bool y_154044 = i_p_m_t_s_leq_w_154041 && zzero_lte_i_154042;
            bool y_154045 = zzero_leq_i_p_m_t_s_154040 && y_154044;
            bool forwards_ok_154046 = i_lte_j_154043 && y_154045;
            bool ok_or_empty_154047 = empty_slice_154037 || forwards_ok_154046;
            bool index_certs_154048;
            
            if (!ok_or_empty_154047) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154033, ":", (long long) min_res_154035, "] out of bounds for array of shape [", (long long) nS_126914, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154049 = sle64((int64_t) 0, m_154038);
            bool y_154050 = slt64(m_154038, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool bounds_check_154051 = x_154049 && y_154050;
            bool index_certs_154052;
            
            if (!bounds_check_154051) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154055 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool index_certs_154056;
            
            if (!y_154055) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double gt_rhs_154053 = ((double *) tS_mem_171275.mem)[i_p_m_t_s_154039];
            bool defunc_0_gt_res_154054 = gt_rhs_154053 < gt_lhs_154014;
            double lt_rhs_154057 = ((double *) tS_mem_171275.mem)[tS_start_154033];
            bool defunc_0_lt_res_154058 = lt_lhs_154021 < lt_rhs_154057;
            bool thisStillRel_154059 = !defunc_0_lt_res_154058;
            int64_t ext_171345;
            
            if (defunc_0_lt_res_154058) {
                ext_171345 = ctx_param_ext_171291;
            } else {
                ext_171345 = (int64_t) 0;
            }
            
            int64_t ext_171344;
            
            if (defunc_0_lt_res_154058) {
                ext_171344 = ctx_param_ext_171292;
            } else {
                ext_171344 = (int64_t) 1;
            }
            
            int64_t ext_171342;
            
            if (defunc_0_lt_res_154058) {
                ext_171342 = ctx_param_ext_171294;
            } else {
                ext_171342 = (int64_t) 0;
            }
            
            int64_t ext_171341;
            
            if (defunc_0_lt_res_154058) {
                ext_171341 = ctx_param_ext_171295;
            } else {
                ext_171341 = (int64_t) 1;
            }
            
            int64_t ext_171351;
            
            if (defunc_0_gt_res_154054) {
                ext_171351 = ctx_param_ext_171291;
            } else {
                ext_171351 = ext_171345;
            }
            
            int64_t ext_171350;
            
            if (defunc_0_gt_res_154054) {
                ext_171350 = ctx_param_ext_171292;
            } else {
                ext_171350 = ext_171344;
            }
            
            int64_t ext_171348;
            
            if (defunc_0_gt_res_154054) {
                ext_171348 = ctx_param_ext_171294;
            } else {
                ext_171348 = ext_171342;
            }
            
            int64_t ext_171347;
            
            if (defunc_0_gt_res_154054) {
                ext_171347 = ctx_param_ext_171295;
            } else {
                ext_171347 = ext_171341;
            }
            
            int64_t loopres_154060;
            bool loopres_154063;
            int64_t loopres_154064;
            
            if (defunc_0_gt_res_154054) {
                int64_t tmp_162600 = add64((int64_t) 1, s_iter_154029);
                
                if (memblock_set(ctx, &ext_mem_171352, &mem_param_171293, "mem_param_171293") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &mem_param_171296, "mem_param_171296") != 0)
                    return 1;
                loopres_154060 = tmp_162600;
                loopres_154063 = 1;
                loopres_154064 = tmp_162600;
            } else {
                int64_t loopres_f_res_154066;
                bool loopres_f_res_154069;
                
                if (defunc_0_lt_res_154058) {
                    if (memblock_set(ctx, &ext_mem_171346, &mem_param_171293, "mem_param_171293") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_param_171296, "mem_param_171296") != 0)
                        return 1;
                    loopres_f_res_154066 = s_iter_154029;
                    loopres_f_res_154069 = thisStillRel_154059;
                } else {
                    bool index_certs_154070;
                    
                    if (!bounds_check_154018) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lt_lhs_154071 = ((double *) tR_mem_171274.mem)[i_p_m_t_s_153996];
                    bool defunc_0_lt_res_154072 = lt_lhs_154071 < gt_rhs_154053;
                    bool nextRel_154073 = !defunc_0_lt_res_154072;
                    int64_t find_joinTuples_arg3_154074 = add64(offset_S_126918, tS_start_154033);
                    double i64_res_154075 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                    double log2_res_154076 = futrts_log2_64(i64_res_154075);
                    double ceil_res_154077 = futrts_ceil64(log2_res_154076);
                    int64_t f64_res_154078 = fptosi_f64_i64(ceil_res_154077);
                    int64_t num_iter_154079 = add64((int64_t) 1, f64_res_154078);
                    int64_t bsearch_first_154081;
                    int64_t last_step_154084;
                    
                    if (memblock_set(ctx, &mem_param_171299, &mem_171290, "mem_171290") != 0)
                        return 1;
                    last_step_154084 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154082 = 0; i_154082 < num_iter_154079; i_154082++) {
                        int64_t zs_lhs_154085 = add64((int64_t) 1, last_step_154084);
                        int64_t this_step_154086 = sdiv64(zs_lhs_154085, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171301, bytes_171287, "mem_171301")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171003++) {
                            int64_t eta_p_162154 = ((int64_t *) mem_param_171299.mem)[i_171003];
                            int64_t slice_171252 = tR_start_153990 + i_171003;
                            double eta_p_162155 = ((double *) tR_mem_171274.mem)[slice_171252];
                            bool cond_162157 = sle64(eta_p_162154, (int64_t) 0);
                            double prev_elem_162158;
                            
                            if (cond_162157) {
                                bool index_certs_162602;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162158 = lt_rhs_154057;
                            } else {
                                int64_t tmp_162162 = sub64(eta_p_162154, (int64_t) 1);
                                bool x_162163 = sle64((int64_t) 0, tmp_162162);
                                bool y_162164 = slt64(tmp_162162, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162165 = x_162163 && y_162164;
                                bool index_certs_162166;
                                
                                if (!bounds_check_162165) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162167 = tS_start_154033 + tmp_162162;
                                double prev_elem_f_res_162168 = ((double *) tS_mem_171275.mem)[slice_162167];
                                
                                prev_elem_162158 = prev_elem_f_res_162168;
                            }
                            
                            bool cond_162169 = slt64(eta_p_162154, (int64_t) 0);
                            double cur_elem_162170;
                            
                            if (cond_162169) {
                                bool index_certs_162605;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162170 = lt_rhs_154057;
                            } else {
                                bool x_162174 = sle64((int64_t) 0, eta_p_162154);
                                bool y_162175 = slt64(eta_p_162154, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162176 = x_162174 && y_162175;
                                bool index_certs_162177;
                                
                                if (!bounds_check_162176) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162154, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162178 = tS_start_154033 + eta_p_162154;
                                double cur_elem_f_res_162179 = ((double *) tS_mem_171275.mem)[slice_162178];
                                
                                cur_elem_162170 = cur_elem_f_res_162179;
                            }
                            
                            bool cond_162180 = sle64(m_154038, eta_p_162154);
                            double next_elem_162181;
                            
                            if (cond_162180) {
                                bool index_certs_162611;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162181 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162189 = add64((int64_t) 1, eta_p_162154);
                                bool x_162190 = sle64((int64_t) 0, tmp_162189);
                                bool y_162191 = slt64(tmp_162189, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162192 = x_162190 && y_162191;
                                bool index_certs_162193;
                                
                                if (!bounds_check_162192) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162189, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162194 = tS_start_154033 + tmp_162189;
                                double next_elem_f_res_162195 = ((double *) tS_mem_171275.mem)[slice_162194];
                                
                                next_elem_162181 = next_elem_f_res_162195;
                            }
                            
                            int64_t defunc_0_f_res_162200;
                            
                            if (cond_162169) {
                                defunc_0_f_res_162200 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162201 = eta_p_162155 == cur_elem_162170;
                                bool cond_162202 = eta_p_162154 == (int64_t) 0;
                                bool defunc_0_gt_res_162203 = prev_elem_162158 < eta_p_162155;
                                bool x_162204 = !cond_162202;
                                bool y_162205 = defunc_0_gt_res_162203 && x_162204;
                                bool cond_t_res_162206 = cond_162202 || y_162205;
                                bool x_162207 = defunc_0_eq_res_162201 && cond_t_res_162206;
                                int64_t defunc_0_f_res_f_res_162208;
                                
                                if (x_162207) {
                                    defunc_0_f_res_f_res_162208 = eta_p_162154;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162209;
                                    
                                    if (defunc_0_eq_res_162201) {
                                        int64_t max_arg1_162614 = sub64(eta_p_162154, this_step_154086);
                                        int64_t max_res_162615 = smax64((int64_t) 0, max_arg1_162614);
                                        
                                        defunc_0_f_res_f_res_f_res_162209 = max_res_162615;
                                    } else {
                                        bool defunc_0_gt_res_162212 = cur_elem_162170 < eta_p_162155;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162213;
                                        
                                        if (defunc_0_gt_res_162212) {
                                            bool cond_162617 = eta_p_162154 == m_154038;
                                            bool defunc_0_lt_res_162618 = eta_p_162155 < next_elem_162181;
                                            bool x_162619 = !cond_162617;
                                            bool y_162620 = defunc_0_lt_res_162618 && x_162619;
                                            bool cond_162621 = cond_162617 || y_162620;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                            
                                            if (cond_162621) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_162623 = add64(this_step_154086, eta_p_162154);
                                                int64_t min_res_162624 = smin64(m_154038, min_arg1_162623);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = min_res_162624;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                            
                                            if (cond_t_res_162206) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162224 = sub64(eta_p_162154, this_step_154086);
                                                int64_t max_res_162225 = smax64((int64_t) 0, max_arg1_162224);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = max_res_162225;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                        }
                                        defunc_0_f_res_f_res_f_res_162209 = defunc_0_f_res_f_res_f_res_f_res_162213;
                                    }
                                    defunc_0_f_res_f_res_162208 = defunc_0_f_res_f_res_f_res_162209;
                                }
                                defunc_0_f_res_162200 = defunc_0_f_res_f_res_162208;
                            }
                            ((int64_t *) mem_171301.mem)[i_171003] = defunc_0_f_res_162200;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171982, &mem_171301, "mem_171301") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171984 = this_step_154086;
                        
                        if (memblock_set(ctx, &mem_param_171299, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
                            return 1;
                        last_step_154084 = last_step_tmp_171984;
                    }
                    if (memblock_set(ctx, &ext_mem_171310, &mem_param_171299, "mem_param_171299") != 0)
                        return 1;
                    bsearch_first_154081 = last_step_154084;
                    
                    int64_t bsearch_last_154164;
                    int64_t last_step_154167;
                    
                    if (memblock_set(ctx, &mem_param_171313, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    last_step_154167 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154165 = 0; i_154165 < num_iter_154079; i_154165++) {
                        int64_t zs_lhs_154168 = add64((int64_t) 1, last_step_154167);
                        int64_t max_arg1_154169 = sdiv64(zs_lhs_154168, (int64_t) 2);
                        int64_t max_res_154170 = smax64((int64_t) 1, max_arg1_154169);
                        
                        if (memblock_alloc(ctx, &mem_171315, bytes_171287, "mem_171315")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171007 = 0; i_171007 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171007++) {
                            int64_t eta_p_162277 = ((int64_t *) mem_param_171313.mem)[i_171007];
                            int64_t slice_171251 = tR_start_153990 + i_171007;
                            double eta_p_162278 = ((double *) tR_mem_171274.mem)[slice_171251];
                            bool cond_162280 = slt64(eta_p_162277, (int64_t) 0);
                            double cur_elem_162281;
                            
                            if (cond_162280) {
                                bool index_certs_162627;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162281 = lt_rhs_154057;
                            } else {
                                bool x_162285 = sle64((int64_t) 0, eta_p_162277);
                                bool y_162286 = slt64(eta_p_162277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162287 = x_162285 && y_162286;
                                bool index_certs_162288;
                                
                                if (!bounds_check_162287) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162289 = tS_start_154033 + eta_p_162277;
                                double cur_elem_f_res_162290 = ((double *) tS_mem_171275.mem)[slice_162289];
                                
                                cur_elem_162281 = cur_elem_f_res_162290;
                            }
                            
                            bool cond_162291 = sle64(m_154038, eta_p_162277);
                            double next_elem_162292;
                            
                            if (cond_162291) {
                                bool index_certs_162633;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162292 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162300 = add64((int64_t) 1, eta_p_162277);
                                bool x_162301 = sle64((int64_t) 0, tmp_162300);
                                bool y_162302 = slt64(tmp_162300, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162303 = x_162301 && y_162302;
                                bool index_certs_162304;
                                
                                if (!bounds_check_162303) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162300, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162305 = tS_start_154033 + tmp_162300;
                                double next_elem_f_res_162306 = ((double *) tS_mem_171275.mem)[slice_162305];
                                
                                next_elem_162292 = next_elem_f_res_162306;
                            }
                            
                            int64_t defunc_0_f_res_162310;
                            
                            if (cond_162280) {
                                defunc_0_f_res_162310 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162311 = eta_p_162278 == cur_elem_162281;
                                bool cond_162313 = eta_p_162277 == m_154038;
                                bool defunc_0_gt_res_162314 = eta_p_162278 < next_elem_162292;
                                bool x_162315 = !cond_162313;
                                bool y_162316 = defunc_0_gt_res_162314 && x_162315;
                                bool cond_t_res_162317 = cond_162313 || y_162316;
                                bool x_162318 = defunc_0_eq_res_162311 && cond_t_res_162317;
                                int64_t defunc_0_f_res_f_res_162319;
                                
                                if (x_162318) {
                                    defunc_0_f_res_f_res_162319 = eta_p_162277;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162320;
                                    
                                    if (defunc_0_eq_res_162311) {
                                        int64_t min_arg1_162636 = add64(max_res_154170, eta_p_162277);
                                        int64_t min_res_162637 = smin64(m_154038, min_arg1_162636);
                                        
                                        defunc_0_f_res_f_res_f_res_162320 = min_res_162637;
                                    } else {
                                        bool defunc_0_gt_res_162323 = cur_elem_162281 < eta_p_162278;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162324;
                                        
                                        if (defunc_0_gt_res_162323) {
                                            int64_t min_arg1_162638 = add64(max_res_154170, eta_p_162277);
                                            int64_t min_res_162639 = smin64(m_154038, min_arg1_162638);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = min_res_162639;
                                        } else {
                                            int64_t max_arg1_162327 = sub64(eta_p_162277, max_res_154170);
                                            int64_t max_res_162328 = smax64((int64_t) 0, max_arg1_162327);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = max_res_162328;
                                        }
                                        defunc_0_f_res_f_res_f_res_162320 = defunc_0_f_res_f_res_f_res_f_res_162324;
                                    }
                                    defunc_0_f_res_f_res_162319 = defunc_0_f_res_f_res_f_res_162320;
                                }
                                defunc_0_f_res_162310 = defunc_0_f_res_f_res_162319;
                            }
                            ((int64_t *) mem_171315.mem)[i_171007] = defunc_0_f_res_162310;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171986, &mem_171315, "mem_171315") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171988 = max_res_154170;
                        
                        if (memblock_set(ctx, &mem_param_171313, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
                            return 1;
                        last_step_154167 = last_step_tmp_171988;
                    }
                    if (memblock_set(ctx, &ext_mem_171324, &mem_param_171313, "mem_param_171313") != 0)
                        return 1;
                    bsearch_last_154164 = last_step_154167;
                    if (memblock_alloc(ctx, &mem_171326, bytes_171287, "mem_171326")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171328, bytes_171287, "mem_171328")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171013 = 0; i_171013 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171013++) {
                        int64_t eta_p_162133 = ((int64_t *) ext_mem_171310.mem)[i_171013];
                        int64_t eta_p_162134 = ((int64_t *) mem_param_171296.mem)[ctx_param_ext_171294 + i_171013 * ctx_param_ext_171295];
                        int64_t eta_p_162135 = ((int64_t *) ext_mem_171324.mem)[i_171013];
                        int64_t eta_p_162136 = ((int64_t *) mem_param_171293.mem)[ctx_param_ext_171291 + i_171013 * ctx_param_ext_171292];
                        bool cond_162138 = slt64(eta_p_162133, (int64_t) 0);
                        int64_t lifted_lambda_res_162139;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162139 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162140 = sub64(eta_p_162135, eta_p_162133);
                            int64_t lifted_lambda_res_f_res_162141 = add64((int64_t) 1, zp_lhs_162140);
                            
                            lifted_lambda_res_162139 = lifted_lambda_res_f_res_162141;
                        }
                        
                        int64_t defunc_0_f_res_162143 = add64(eta_p_162136, lifted_lambda_res_162139);
                        int64_t lifted_lambda_res_162146;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162146 = eta_p_162133;
                        } else {
                            int64_t lifted_lambda_res_f_res_162147 = add64(find_joinTuples_arg3_154074, eta_p_162133);
                            
                            lifted_lambda_res_162146 = lifted_lambda_res_f_res_162147;
                        }
                        
                        bool cond_162149 = slt64(eta_p_162134, (int64_t) 0);
                        int64_t lifted_lambda_res_162150;
                        
                        if (cond_162149) {
                            lifted_lambda_res_162150 = lifted_lambda_res_162146;
                        } else {
                            lifted_lambda_res_162150 = eta_p_162134;
                        }
                        ((int64_t *) mem_171326.mem)[i_171013] = lifted_lambda_res_162150;
                        ((int64_t *) mem_171328.mem)[i_171013] = defunc_0_f_res_162143;
                    }
                    if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
                        return 1;
                    
                    int64_t tmp_154247 = add64((int64_t) 1, s_iter_154029);
                    
                    if (memblock_set(ctx, &ext_mem_171346, &mem_171328, "mem_171328") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_171326, "mem_171326") != 0)
                        return 1;
                    loopres_f_res_154066 = tmp_154247;
                    loopres_f_res_154069 = nextRel_154073;
                }
                if (memblock_set(ctx, &ext_mem_171352, &ext_mem_171346, "ext_mem_171346") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &ext_mem_171343, "ext_mem_171343") != 0)
                    return 1;
                loopres_154060 = loopres_f_res_154066;
                loopres_154063 = loopres_f_res_154069;
                loopres_154064 = minRelevant_154032;
            }
            
            bool cond_154248 = slt64(loopres_154060, numIter_S_153975);
            bool x_154249 = loopres_154063 && cond_154248;
            
            if (memblock_set(ctx, &mem_param_tmp_171971, &ext_mem_171352, "ext_mem_171352") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171972, &ext_mem_171349, "ext_mem_171349") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_171973 = ext_171351;
            int64_t ctx_param_ext_tmp_171974 = ext_171350;
            int64_t ctx_param_ext_tmp_171975 = ext_171348;
            int64_t ctx_param_ext_tmp_171976 = ext_171347;
            bool loop_while_tmp_171977 = x_154249;
            int64_t s_iter_tmp_171978 = loopres_154060;
            int64_t minRelevant_tmp_171981 = loopres_154064;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171296, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
                return 1;
            ctx_param_ext_171291 = ctx_param_ext_tmp_171973;
            ctx_param_ext_171292 = ctx_param_ext_tmp_171974;
            ctx_param_ext_171294 = ctx_param_ext_tmp_171975;
            ctx_param_ext_171295 = ctx_param_ext_tmp_171976;
            loop_while_154028 = loop_while_tmp_171977;
            s_iter_154029 = s_iter_tmp_171978;
            minRelevant_154032 = minRelevant_tmp_171981;
        }
        if (memblock_set(ctx, &ext_mem_171358, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171357, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        ext_171356 = ctx_param_ext_171291;
        ext_171355 = ctx_param_ext_171292;
        ext_171354 = ctx_param_ext_171294;
        ext_171353 = ctx_param_ext_171295;
        loopres_154023 = loop_while_154028;
        loopres_154024 = s_iter_154029;
        loopres_154027 = minRelevant_154032;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171360, bytes_171277, "mem_171360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_126913});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171357.mem, ext_171354, (int64_t []) {ext_171353}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171362, bytes_171277, "mem_171362")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_126913});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171358.mem, ext_171356, (int64_t []) {ext_171355}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        
        int64_t tmp_154255 = add64((int64_t) 1, iter_153986);
        bool loop_cond_154256 = slt64(tmp_154255, numIter_R_153972);
        
        if (memblock_set(ctx, &mem_param_tmp_171962, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171360, "mem_171360") != 0)
            return 1;
        
        bool loop_while_tmp_171964 = loop_cond_154256;
        int64_t iter_tmp_171965 = tmp_154255;
        int64_t first_relevant_in_S_tmp_171968 = loopres_154027;
        
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        loop_while_153985 = loop_while_tmp_171964;
        iter_153986 = iter_tmp_171965;
        first_relevant_in_S_153989 = first_relevant_in_S_tmp_171968;
    }
    if (memblock_set(ctx, &ext_mem_171368, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171367, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    defunc_0_mergeJoin_res_153980 = loop_while_153985;
    defunc_0_mergeJoin_res_153981 = iter_153986;
    defunc_0_mergeJoin_res_153984 = first_relevant_in_S_153989;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
        return 1;
    if (mem_171370_cached_sizze_172271 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171370, &mem_171370_cached_sizze_172271, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171372_cached_sizze_172272 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171372, &mem_171372_cached_sizze_172272, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171374_cached_sizze_172273 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171374, &mem_171374_cached_sizze_172273, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171376_cached_sizze_172274 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171376, &mem_171376_cached_sizze_172274, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171378_cached_sizze_172275 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171378, &mem_171378_cached_sizze_172275, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171380_cached_sizze_172276 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171380, &mem_171380_cached_sizze_172276, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171382_cached_sizze_172277 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171382, &mem_171382_cached_sizze_172277, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171041;
    int64_t discard_171042;
    int64_t defunc_res_162686;
    int64_t scanacc_171023;
    int64_t scanacc_171024;
    int64_t redout_171027;
    
    scanacc_171023 = (int64_t) 0;
    scanacc_171024 = (int64_t) 0;
    redout_171027 = (int64_t) 0;
    for (int64_t i_171033 = 0; i_171033 < nR_126913; i_171033++) {
        int64_t zg_lhs_162079 = ((int64_t *) ext_mem_171368.mem)[i_171033];
        bool cond_162080 = slt64((int64_t) 0, zg_lhs_162079);
        int64_t lifted_lambda_res_162081;
        
        if (cond_162080) {
            lifted_lambda_res_162081 = i_171033;
        } else {
            lifted_lambda_res_162081 = (int64_t) -1;
        }
        
        bool cond_162083 = sle64((int64_t) 0, lifted_lambda_res_162081);
        bool cond_t_res_162084 = slt64(lifted_lambda_res_162081, nR_126913);
        bool x_162085 = cond_162083 && cond_t_res_162084;
        int64_t lifted_lambda_res_162086;
        
        if (x_162085) {
            bool index_certs_162643;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_126913, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:201:99-102\n   #4  ftRelational.fut:192:3-201:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_162644 = ((int64_t *) ext_mem_171368.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162086 = lifted_lambda_res_t_res_162644;
        } else {
            lifted_lambda_res_162086 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162090 = slt64((int64_t) 1, lifted_lambda_res_162086);
        int64_t defunc_0_f_res_162091 = btoi_bool_i64(lifted_lambda_res_162090);
        double lifted_lambda_res_162103;
        int64_t lifted_lambda_res_162104;
        int64_t lifted_lambda_res_162105;
        
        if (x_162085) {
            bool index_certs_162645;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_126913, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:201:99-102\n   #5  ftRelational.fut:192:3-201:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double lifted_lambda_res_t_res_162646 = ((double *) tR_mem_171274.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162647 = ((int64_t *) ext_mem_171276.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162648 = ((int64_t *) ext_mem_171367.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162103 = lifted_lambda_res_t_res_162646;
            lifted_lambda_res_162104 = lifted_lambda_res_t_res_162647;
            lifted_lambda_res_162105 = lifted_lambda_res_t_res_162648;
        } else {
            lifted_lambda_res_162103 = 0.0;
            lifted_lambda_res_162104 = (int64_t) -1;
            lifted_lambda_res_162105 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154319 = add64(defunc_0_f_res_162091, scanacc_171023);
        int64_t lifted_lambda_res_154280 = add64(lifted_lambda_res_162086, scanacc_171024);
        int64_t zp_res_154300 = add64(lifted_lambda_res_162086, redout_171027);
        
        ((int64_t *) mem_171370)[i_171033] = defunc_0_op_res_154319;
        ((int64_t *) mem_171372)[i_171033] = lifted_lambda_res_154280;
        ((double *) mem_171374)[i_171033] = lifted_lambda_res_162103;
        ((int64_t *) mem_171376)[i_171033] = lifted_lambda_res_162104;
        ((int64_t *) mem_171378)[i_171033] = lifted_lambda_res_162105;
        ((int64_t *) mem_171380)[i_171033] = defunc_0_f_res_162091;
        ((int64_t *) mem_171382)[i_171033] = lifted_lambda_res_162086;
        
        int64_t scanacc_tmp_171992 = defunc_0_op_res_154319;
        int64_t scanacc_tmp_171993 = lifted_lambda_res_154280;
        int64_t redout_tmp_171996 = zp_res_154300;
        
        scanacc_171023 = scanacc_tmp_171992;
        scanacc_171024 = scanacc_tmp_171993;
        redout_171027 = redout_tmp_171996;
    }
    discard_171041 = scanacc_171023;
    discard_171042 = scanacc_171024;
    defunc_res_162686 = redout_171027;
    if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
        return 1;
    
    int64_t bytes_171433 = (int64_t) 8 * defunc_res_162686;
    bool cond_154320 = nR_126913 == (int64_t) 0;
    bool x_154321 = !cond_154320;
    int64_t tmp_154322 = sub64(nR_126913, (int64_t) 1);
    bool x_154323 = sle64((int64_t) 0, tmp_154322);
    bool y_154324 = slt64(tmp_154322, nR_126913);
    bool bounds_check_154325 = x_154323 && y_154324;
    bool protect_assert_disj_154326 = cond_154320 || bounds_check_154325;
    bool index_certs_154327;
    
    if (!protect_assert_disj_154326) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154322, "] out of bounds for array of shape [", (long long) nR_126913, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:201:99-102\n   #4  ftRelational.fut:192:3-201:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154328;
    
    if (x_154321) {
        int64_t x_162649 = ((int64_t *) mem_171370)[tmp_154322];
        
        m_f_res_154328 = x_162649;
    } else {
        m_f_res_154328 = (int64_t) 0;
    }
    
    int64_t m_154330;
    
    if (cond_154320) {
        m_154330 = (int64_t) 0;
    } else {
        m_154330 = m_f_res_154328;
    }
    
    bool cond_154353 = slt64((int64_t) 0, m_154330);
    int64_t m_154340 = sub64(m_154330, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154342 = slt64(m_154340, nR_126913);
    bool zzero_leq_i_p_m_t_s_154341 = sle64((int64_t) 0, m_154340);
    bool y_154344 = zzero_leq_i_p_m_t_s_154341 && i_p_m_t_s_leq_w_154342;
    bool i_lte_j_154343 = sle64((int64_t) 0, m_154330);
    bool forwards_ok_154345 = i_lte_j_154343 && y_154344;
    bool eq_x_zz_154337 = (int64_t) 0 == m_f_res_154328;
    bool p_and_eq_x_y_154338 = x_154321 && eq_x_zz_154337;
    bool empty_slice_154339 = cond_154320 || p_and_eq_x_y_154338;
    bool ok_or_empty_154346 = empty_slice_154339 || forwards_ok_154345;
    bool index_certs_154347;
    
    if (!ok_or_empty_154346) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154330, "] out of bounds for array of shape [", (long long) nR_126913, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:201:99-102\n   #4  ftRelational.fut:192:3-201:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171457 = (int64_t) 8 * m_154330;
    
    if (mem_171458_cached_sizze_172279 < bytes_171457) {
        err = lexical_realloc(ctx, &mem_171458, &mem_171458_cached_sizze_172279, bytes_171457);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171382, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154330});
    
    int64_t max_mult_154354;
    
    if (cond_154353) {
        if (mem_171460_cached_sizze_172280 < bytes_171277) {
            err = lexical_realloc(ctx, &mem_171460, &mem_171460_cached_sizze_172280, bytes_171277);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171060 = 0; i_171060 < nR_126913; i_171060++) {
            int64_t eta_p_162655 = ((int64_t *) mem_171380)[i_171060];
            int64_t eta_p_162656 = ((int64_t *) mem_171370)[i_171060];
            bool cond_162657 = eta_p_162655 == (int64_t) 1;
            int64_t lifted_lambda_res_162658;
            
            if (cond_162657) {
                int64_t lifted_lambda_res_t_res_162659 = sub64(eta_p_162656, (int64_t) 1);
                
                lifted_lambda_res_162658 = lifted_lambda_res_t_res_162659;
            } else {
                lifted_lambda_res_162658 = (int64_t) -1;
            }
            ((int64_t *) mem_171460)[i_171060] = lifted_lambda_res_162658;
        }
        for (int64_t write_iter_171062 = 0; write_iter_171062 < nR_126913; write_iter_171062++) {
            int64_t write_iv_171064 = ((int64_t *) mem_171460)[write_iter_171062];
            int64_t write_iv_171065 = ((int64_t *) mem_171382)[write_iter_171062];
            
            if (sle64((int64_t) 0, write_iv_171064) && slt64(write_iv_171064, m_154330)) {
                ((int64_t *) mem_171458)[write_iv_171064] = write_iv_171065;
            }
        }
        
        int64_t defunc_0_reduce_res_162669;
        int64_t redout_171067 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171068 = 0; i_171068 < m_154330; i_171068++) {
            int64_t x_162670 = ((int64_t *) mem_171458)[i_171068];
            int64_t max_res_162673 = smax64(x_162670, redout_171067);
            int64_t redout_tmp_172004 = max_res_162673;
            
            redout_171067 = redout_tmp_172004;
        }
        defunc_0_reduce_res_162669 = redout_171067;
        max_mult_154354 = defunc_0_reduce_res_162669;
    } else {
        max_mult_154354 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154360 = slt64(max_mult_154354, (int64_t) 1);
    bool valid_154362 = !bounds_invalid_upwards_154360;
    bool range_valid_c_154363;
    
    if (!valid_154362) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154354, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:201:99-102\n   #3  ftRelational.fut:192:3-201:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171426_cached_sizze_172278 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171426, &mem_171426_cached_sizze_172278, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171045 = 0; i_171045 < nR_126913; i_171045++) {
        int64_t eta_p_161986 = ((int64_t *) mem_171382)[i_171045];
        int64_t zv_lhs_161988 = add64((int64_t) -1, i_171045);
        int64_t tmp_161989 = smod64(zv_lhs_161988, nR_126913);
        int64_t lifted_lambda_res_161990 = ((int64_t *) mem_171372)[tmp_161989];
        bool cond_161992 = i_171045 == (int64_t) 0;
        int64_t lifted_lambda_res_161993;
        
        if (cond_161992) {
            lifted_lambda_res_161993 = (int64_t) 0;
        } else {
            lifted_lambda_res_161993 = lifted_lambda_res_161990;
        }
        
        bool cond_161995 = slt64((int64_t) 0, eta_p_161986);
        int64_t lifted_lambda_res_161996;
        
        if (cond_161995) {
            lifted_lambda_res_161996 = lifted_lambda_res_161993;
        } else {
            lifted_lambda_res_161996 = (int64_t) -1;
        }
        ((int64_t *) mem_171426)[i_171045] = lifted_lambda_res_161996;
    }
    if (memblock_alloc(ctx, &mem_171434, bytes_171433, "mem_171434")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172006 = 0; nest_i_172006 < defunc_res_162686; nest_i_172006++) {
        ((double *) mem_171434.mem)[nest_i_172006] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_171436, bytes_171433, "mem_171436")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172007 = 0; nest_i_172007 < defunc_res_162686; nest_i_172007++) {
        ((int64_t *) mem_171436.mem)[nest_i_172007] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171438, bytes_171433, "mem_171438")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172008 = 0; nest_i_172008 < defunc_res_162686; nest_i_172008++) {
        ((int64_t *) mem_171438.mem)[nest_i_172008] = (int64_t) -1;
    }
    for (int64_t write_iter_171047 = 0; write_iter_171047 < nR_126913; write_iter_171047++) {
        int64_t write_iv_171051 = ((int64_t *) mem_171426)[write_iter_171047];
        double write_iv_171052 = ((double *) mem_171374)[write_iter_171047];
        int64_t write_iv_171053 = ((int64_t *) mem_171376)[write_iter_171047];
        int64_t write_iv_171054 = ((int64_t *) mem_171378)[write_iter_171047];
        
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((double *) mem_171434.mem)[write_iv_171051] = write_iv_171052;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171436.mem)[write_iv_171051] = write_iv_171053;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171438.mem)[write_iv_171051] = write_iv_171054;
        }
    }
    
    int64_t distance_154361 = sub64(max_mult_154354, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_171475, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171478, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171481, &mem_171438, "mem_171438") != 0)
        return 1;
    for (int64_t i_154367 = 0; i_154367 < distance_154361; i_154367++) {
        int64_t index_primexp_154371 = add64((int64_t) 1, i_154367);
        
        if (memblock_alloc(ctx, &mem_171483, bytes_171433, "mem_171483")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171483.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171485, bytes_171433, "mem_171485")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171485.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171478.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171487, bytes_171433, "mem_171487")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        for (int64_t write_iter_171069 = 0; write_iter_171069 < nR_126913; write_iter_171069++) {
            int64_t write_iv_171074 = ((int64_t *) mem_171378)[write_iter_171069];
            double write_iv_171075 = ((double *) mem_171374)[write_iter_171069];
            int64_t write_iv_171076 = ((int64_t *) mem_171376)[write_iter_171069];
            int64_t zg_lhs_162583 = ((int64_t *) mem_171382)[write_iter_171069];
            bool cond_162584 = slt64(index_primexp_154371, zg_lhs_162583);
            int64_t lifted_lambda_res_162585;
            
            if (cond_162584) {
                int64_t zp_lhs_162679 = ((int64_t *) mem_171426)[write_iter_171069];
                int64_t lifted_lambda_res_t_res_162680 = add64(index_primexp_154371, zp_lhs_162679);
                
                lifted_lambda_res_162585 = lifted_lambda_res_t_res_162680;
            } else {
                lifted_lambda_res_162585 = (int64_t) -1;
            }
            
            int64_t tmp_162589 = add64(index_primexp_154371, write_iv_171074);
            
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((double *) mem_171487.mem)[lifted_lambda_res_162585] = write_iv_171075;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171485.mem)[lifted_lambda_res_162585] = write_iv_171076;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171483.mem)[lifted_lambda_res_162585] = tmp_162589;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172012, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172013, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172014, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171475, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171478, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171481, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171514, &mem_param_171475, "mem_param_171475") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171513, &mem_param_171478, "mem_param_171478") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171512, &mem_param_171481, "mem_param_171481") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171516, bytes_171433, "mem_171516")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171516.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171514.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171518, bytes_171433, "mem_171518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171518.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171520, bytes_171433, "mem_171520")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171520.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171518, "mem_171518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171520, "mem_171520") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &mem_171516, "mem_171516") != 0)
        return 1;
    prim_out_171959 = defunc_res_162686;
    if (memblock_set(ctx, &*mem_out_p_172267, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172268, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172269, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172270 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171370);
        free(mem_171372);
        free(mem_171374);
        free(mem_171376);
        free(mem_171378);
        free(mem_171380);
        free(mem_171382);
        free(mem_171426);
        free(mem_171458);
        free(mem_171460);
        if (memblock_unref(ctx, &mem_171520, "mem_171520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171518, "mem_171518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171516, "mem_171516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171481, "mem_param_171481") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171478, "mem_param_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171475, "mem_param_171475") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171360, "mem_171360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171328, "mem_171328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171326, "mem_171326") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171315, "mem_171315") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171313, "mem_param_171313") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171301, "mem_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171299, "mem_param_171299") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171343, "ext_mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171346, "ext_mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171352, "ext_mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_172281, struct memblock *mem_out_p_172282, struct memblock *mem_out_p_172283, int64_t *out_prim_out_172284, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_124250, int64_t nS_124251, int64_t offset_R_124254, int64_t offset_S_124255, int64_t partitionSizze_124256, int64_t scatter_psizze_124257)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171370_cached_sizze_172285 = 0;
    unsigned char *mem_171370 = NULL;
    int64_t mem_171372_cached_sizze_172286 = 0;
    unsigned char *mem_171372 = NULL;
    int64_t mem_171374_cached_sizze_172287 = 0;
    unsigned char *mem_171374 = NULL;
    int64_t mem_171376_cached_sizze_172288 = 0;
    unsigned char *mem_171376 = NULL;
    int64_t mem_171378_cached_sizze_172289 = 0;
    unsigned char *mem_171378 = NULL;
    int64_t mem_171380_cached_sizze_172290 = 0;
    unsigned char *mem_171380 = NULL;
    int64_t mem_171382_cached_sizze_172291 = 0;
    unsigned char *mem_171382 = NULL;
    int64_t mem_171426_cached_sizze_172292 = 0;
    unsigned char *mem_171426 = NULL;
    int64_t mem_171458_cached_sizze_172293 = 0;
    unsigned char *mem_171458 = NULL;
    int64_t mem_171460_cached_sizze_172294 = 0;
    unsigned char *mem_171460 = NULL;
    struct memblock mem_171520;
    
    mem_171520.references = NULL;
    
    struct memblock mem_171518;
    
    mem_171518.references = NULL;
    
    struct memblock mem_171516;
    
    mem_171516.references = NULL;
    
    struct memblock mem_param_tmp_172014;
    
    mem_param_tmp_172014.references = NULL;
    
    struct memblock mem_param_tmp_172013;
    
    mem_param_tmp_172013.references = NULL;
    
    struct memblock mem_param_tmp_172012;
    
    mem_param_tmp_172012.references = NULL;
    
    struct memblock mem_171487;
    
    mem_171487.references = NULL;
    
    struct memblock mem_171485;
    
    mem_171485.references = NULL;
    
    struct memblock mem_171483;
    
    mem_171483.references = NULL;
    
    struct memblock mem_param_171481;
    
    mem_param_171481.references = NULL;
    
    struct memblock mem_param_171478;
    
    mem_param_171478.references = NULL;
    
    struct memblock mem_param_171475;
    
    mem_param_171475.references = NULL;
    
    struct memblock ext_mem_171512;
    
    ext_mem_171512.references = NULL;
    
    struct memblock ext_mem_171513;
    
    ext_mem_171513.references = NULL;
    
    struct memblock ext_mem_171514;
    
    ext_mem_171514.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock mem_171436;
    
    mem_171436.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_171362;
    
    mem_171362.references = NULL;
    
    struct memblock mem_171360;
    
    mem_171360.references = NULL;
    
    struct memblock mem_param_tmp_171972;
    
    mem_param_tmp_171972.references = NULL;
    
    struct memblock mem_param_tmp_171971;
    
    mem_param_tmp_171971.references = NULL;
    
    struct memblock mem_171328;
    
    mem_171328.references = NULL;
    
    struct memblock mem_171326;
    
    mem_171326.references = NULL;
    
    struct memblock mem_param_tmp_171986;
    
    mem_param_tmp_171986.references = NULL;
    
    struct memblock mem_171315;
    
    mem_171315.references = NULL;
    
    struct memblock mem_param_171313;
    
    mem_param_171313.references = NULL;
    
    struct memblock ext_mem_171324;
    
    ext_mem_171324.references = NULL;
    
    struct memblock mem_param_tmp_171982;
    
    mem_param_tmp_171982.references = NULL;
    
    struct memblock mem_171301;
    
    mem_171301.references = NULL;
    
    struct memblock mem_param_171299;
    
    mem_param_171299.references = NULL;
    
    struct memblock ext_mem_171310;
    
    ext_mem_171310.references = NULL;
    
    struct memblock ext_mem_171343;
    
    ext_mem_171343.references = NULL;
    
    struct memblock ext_mem_171346;
    
    ext_mem_171346.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock ext_mem_171352;
    
    ext_mem_171352.references = NULL;
    
    struct memblock mem_param_171296;
    
    mem_param_171296.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171357;
    
    ext_mem_171357.references = NULL;
    
    struct memblock ext_mem_171358;
    
    ext_mem_171358.references = NULL;
    
    struct memblock mem_171290;
    
    mem_171290.references = NULL;
    
    struct memblock mem_171288;
    
    mem_171288.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock ext_mem_171367;
    
    ext_mem_171367.references = NULL;
    
    struct memblock ext_mem_171368;
    
    ext_mem_171368.references = NULL;
    
    struct memblock mem_171280;
    
    mem_171280.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock ext_mem_171276;
    
    ext_mem_171276.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t partitionSizze_153966 = sdiv64(partitionSizze_124256, (int64_t) 4);
    int64_t zm_lhs_153967 = add64(nR_124250, partitionSizze_153966);
    int64_t zs_lhs_153968 = sub64(zm_lhs_153967, (int64_t) 1);
    bool zzero_153969 = partitionSizze_153966 == (int64_t) 0;
    bool nonzzero_153970 = !zzero_153969;
    bool nonzzero_cert_153971;
    
    if (!nonzzero_153970) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_153972 = sdiv64(zs_lhs_153968, partitionSizze_153966);
    int64_t zm_lhs_153973 = add64(nS_124251, partitionSizze_153966);
    int64_t zs_lhs_153974 = sub64(zm_lhs_153973, (int64_t) 1);
    int64_t numIter_S_153975 = sdiv64(zs_lhs_153974, partitionSizze_153966);
    
    if (futrts_indicesWithIncrement_16321(ctx, &ext_mem_171276, tR_mem_171274, nR_124250, offset_R_124254) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171277 = (int64_t) 8 * nR_124250;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171960 = 0; nest_i_171960 < nR_124250; nest_i_171960++) {
        ((int64_t *) mem_171278.mem)[nest_i_171960] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171280, bytes_171277, "mem_171280")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171961 = 0; nest_i_171961 < nR_124250; nest_i_171961++) {
        ((int64_t *) mem_171280.mem)[nest_i_171961] = (int64_t) 0;
    }
    
    bool loop_cond_153979 = slt64((int64_t) 0, numIter_R_153972);
    bool defunc_0_mergeJoin_res_153980;
    int64_t defunc_0_mergeJoin_res_153981;
    int64_t defunc_0_mergeJoin_res_153984;
    bool loop_while_153985;
    int64_t iter_153986;
    int64_t first_relevant_in_S_153989;
    
    if (memblock_set(ctx, &mem_param_171283, &mem_171280, "mem_171280") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &mem_171278, "mem_171278") != 0)
        return 1;
    loop_while_153985 = loop_cond_153979;
    iter_153986 = (int64_t) 0;
    first_relevant_in_S_153989 = (int64_t) 0;
    while (loop_while_153985) {
        int64_t tR_start_153990 = mul64(partitionSizze_153966, iter_153986);
        int64_t min_arg1_153991 = add64(partitionSizze_153966, tR_start_153990);
        int64_t min_res_153992 = smin64(nR_124250, min_arg1_153991);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 = sub64(min_res_153992, tR_start_153990);
        bool empty_slice_153994 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 == (int64_t) 0;
        int64_t m_153995 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, (int64_t) 1);
        int64_t i_p_m_t_s_153996 = add64(tR_start_153990, m_153995);
        bool zzero_leq_i_p_m_t_s_153997 = sle64((int64_t) 0, i_p_m_t_s_153996);
        bool i_p_m_t_s_leq_w_153998 = slt64(i_p_m_t_s_153996, nR_124250);
        bool zzero_lte_i_153999 = sle64((int64_t) 0, tR_start_153990);
        bool i_lte_j_154000 = sle64(tR_start_153990, min_res_153992);
        bool y_154001 = i_p_m_t_s_leq_w_153998 && zzero_lte_i_153999;
        bool y_154002 = zzero_leq_i_p_m_t_s_153997 && y_154001;
        bool forwards_ok_154003 = i_lte_j_154000 && y_154002;
        bool ok_or_empty_154004 = empty_slice_153994 || forwards_ok_154003;
        bool index_certs_154005;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_124250, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171287 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993;
        bool cond_154009 = slt64(first_relevant_in_S_153989, numIter_S_153975);
        bool y_154010 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool loop_not_taken_154011 = !cond_154009;
        bool protect_assert_disj_154012 = y_154010 || loop_not_taken_154011;
        bool index_certs_154013;
        
        if (!protect_assert_disj_154012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154016 = sle64((int64_t) 0, m_153995);
        bool y_154017 = slt64(m_153995, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool bounds_check_154018 = x_154016 && y_154017;
        bool protect_assert_disj_154019 = loop_not_taken_154011 || bounds_check_154018;
        bool index_certs_154020;
        
        if (!protect_assert_disj_154019) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154251;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_124250, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:190:99-102\n   #4  ftRelational.fut:181:3-190:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171288, bytes_171287, "mem_171288")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171969 = 0; nest_i_171969 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171969++) {
            ((int64_t *) mem_171288.mem)[nest_i_171969] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171290, bytes_171287, "mem_171290")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171970 = 0; nest_i_171970 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171970++) {
            ((int64_t *) mem_171290.mem)[nest_i_171970] = (int64_t) 0;
        }
        
        float gt_lhs_154014;
        
        if (cond_154009) {
            float x_162598 = ((float *) tR_mem_171274.mem)[tR_start_153990];
            
            gt_lhs_154014 = x_162598;
        } else {
            gt_lhs_154014 = 0.0F;
        }
        
        float lt_lhs_154021;
        
        if (cond_154009) {
            float x_162599 = ((float *) tR_mem_171274.mem)[i_p_m_t_s_153996];
            
            lt_lhs_154021 = x_162599;
        } else {
            lt_lhs_154021 = 0.0F;
        }
        
        int64_t ext_171356;
        int64_t ext_171355;
        int64_t ext_171354;
        int64_t ext_171353;
        bool loopres_154023;
        int64_t loopres_154024;
        int64_t loopres_154027;
        bool loop_while_154028;
        int64_t s_iter_154029;
        int64_t minRelevant_154032;
        int64_t ctx_param_ext_171291;
        int64_t ctx_param_ext_171292;
        int64_t ctx_param_ext_171294;
        int64_t ctx_param_ext_171295;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171296, &mem_171288, "mem_171288") != 0)
            return 1;
        ctx_param_ext_171291 = (int64_t) 0;
        ctx_param_ext_171292 = (int64_t) 1;
        ctx_param_ext_171294 = (int64_t) 0;
        ctx_param_ext_171295 = (int64_t) 1;
        loop_while_154028 = cond_154009;
        s_iter_154029 = first_relevant_in_S_153989;
        minRelevant_154032 = first_relevant_in_S_153989;
        while (loop_while_154028) {
            int64_t tS_start_154033 = mul64(partitionSizze_153966, s_iter_154029);
            int64_t min_arg1_154034 = add64(partitionSizze_153966, tS_start_154033);
            int64_t min_res_154035 = smin64(nS_124251, min_arg1_154034);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 = sub64(min_res_154035, tS_start_154033);
            bool empty_slice_154037 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 == (int64_t) 0;
            int64_t m_154038 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, (int64_t) 1);
            int64_t i_p_m_t_s_154039 = add64(tS_start_154033, m_154038);
            bool zzero_leq_i_p_m_t_s_154040 = sle64((int64_t) 0, i_p_m_t_s_154039);
            bool i_p_m_t_s_leq_w_154041 = slt64(i_p_m_t_s_154039, nS_124251);
            bool zzero_lte_i_154042 = sle64((int64_t) 0, tS_start_154033);
            bool i_lte_j_154043 = sle64(tS_start_154033, min_res_154035);
            bool y_154044 = i_p_m_t_s_leq_w_154041 && zzero_lte_i_154042;
            bool y_154045 = zzero_leq_i_p_m_t_s_154040 && y_154044;
            bool forwards_ok_154046 = i_lte_j_154043 && y_154045;
            bool ok_or_empty_154047 = empty_slice_154037 || forwards_ok_154046;
            bool index_certs_154048;
            
            if (!ok_or_empty_154047) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154033, ":", (long long) min_res_154035, "] out of bounds for array of shape [", (long long) nS_124251, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154049 = sle64((int64_t) 0, m_154038);
            bool y_154050 = slt64(m_154038, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool bounds_check_154051 = x_154049 && y_154050;
            bool index_certs_154052;
            
            if (!bounds_check_154051) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154055 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool index_certs_154056;
            
            if (!y_154055) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float gt_rhs_154053 = ((float *) tS_mem_171275.mem)[i_p_m_t_s_154039];
            bool defunc_0_gt_res_154054 = gt_rhs_154053 < gt_lhs_154014;
            float lt_rhs_154057 = ((float *) tS_mem_171275.mem)[tS_start_154033];
            bool defunc_0_lt_res_154058 = lt_lhs_154021 < lt_rhs_154057;
            bool thisStillRel_154059 = !defunc_0_lt_res_154058;
            int64_t ext_171345;
            
            if (defunc_0_lt_res_154058) {
                ext_171345 = ctx_param_ext_171291;
            } else {
                ext_171345 = (int64_t) 0;
            }
            
            int64_t ext_171344;
            
            if (defunc_0_lt_res_154058) {
                ext_171344 = ctx_param_ext_171292;
            } else {
                ext_171344 = (int64_t) 1;
            }
            
            int64_t ext_171342;
            
            if (defunc_0_lt_res_154058) {
                ext_171342 = ctx_param_ext_171294;
            } else {
                ext_171342 = (int64_t) 0;
            }
            
            int64_t ext_171341;
            
            if (defunc_0_lt_res_154058) {
                ext_171341 = ctx_param_ext_171295;
            } else {
                ext_171341 = (int64_t) 1;
            }
            
            int64_t ext_171351;
            
            if (defunc_0_gt_res_154054) {
                ext_171351 = ctx_param_ext_171291;
            } else {
                ext_171351 = ext_171345;
            }
            
            int64_t ext_171350;
            
            if (defunc_0_gt_res_154054) {
                ext_171350 = ctx_param_ext_171292;
            } else {
                ext_171350 = ext_171344;
            }
            
            int64_t ext_171348;
            
            if (defunc_0_gt_res_154054) {
                ext_171348 = ctx_param_ext_171294;
            } else {
                ext_171348 = ext_171342;
            }
            
            int64_t ext_171347;
            
            if (defunc_0_gt_res_154054) {
                ext_171347 = ctx_param_ext_171295;
            } else {
                ext_171347 = ext_171341;
            }
            
            int64_t loopres_154060;
            bool loopres_154063;
            int64_t loopres_154064;
            
            if (defunc_0_gt_res_154054) {
                int64_t tmp_162600 = add64((int64_t) 1, s_iter_154029);
                
                if (memblock_set(ctx, &ext_mem_171352, &mem_param_171293, "mem_param_171293") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &mem_param_171296, "mem_param_171296") != 0)
                    return 1;
                loopres_154060 = tmp_162600;
                loopres_154063 = 1;
                loopres_154064 = tmp_162600;
            } else {
                int64_t loopres_f_res_154066;
                bool loopres_f_res_154069;
                
                if (defunc_0_lt_res_154058) {
                    if (memblock_set(ctx, &ext_mem_171346, &mem_param_171293, "mem_param_171293") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_param_171296, "mem_param_171296") != 0)
                        return 1;
                    loopres_f_res_154066 = s_iter_154029;
                    loopres_f_res_154069 = thisStillRel_154059;
                } else {
                    bool index_certs_154070;
                    
                    if (!bounds_check_154018) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lt_lhs_154071 = ((float *) tR_mem_171274.mem)[i_p_m_t_s_153996];
                    bool defunc_0_lt_res_154072 = lt_lhs_154071 < gt_rhs_154053;
                    bool nextRel_154073 = !defunc_0_lt_res_154072;
                    int64_t find_joinTuples_arg3_154074 = add64(offset_S_124255, tS_start_154033);
                    double i64_res_154075 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                    double log2_res_154076 = futrts_log2_64(i64_res_154075);
                    double ceil_res_154077 = futrts_ceil64(log2_res_154076);
                    int64_t f64_res_154078 = fptosi_f64_i64(ceil_res_154077);
                    int64_t num_iter_154079 = add64((int64_t) 1, f64_res_154078);
                    int64_t bsearch_first_154081;
                    int64_t last_step_154084;
                    
                    if (memblock_set(ctx, &mem_param_171299, &mem_171290, "mem_171290") != 0)
                        return 1;
                    last_step_154084 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154082 = 0; i_154082 < num_iter_154079; i_154082++) {
                        int64_t zs_lhs_154085 = add64((int64_t) 1, last_step_154084);
                        int64_t this_step_154086 = sdiv64(zs_lhs_154085, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171301, bytes_171287, "mem_171301")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171003++) {
                            int64_t eta_p_162154 = ((int64_t *) mem_param_171299.mem)[i_171003];
                            int64_t slice_171252 = tR_start_153990 + i_171003;
                            float eta_p_162155 = ((float *) tR_mem_171274.mem)[slice_171252];
                            bool cond_162157 = sle64(eta_p_162154, (int64_t) 0);
                            float prev_elem_162158;
                            
                            if (cond_162157) {
                                bool index_certs_162602;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162158 = lt_rhs_154057;
                            } else {
                                int64_t tmp_162162 = sub64(eta_p_162154, (int64_t) 1);
                                bool x_162163 = sle64((int64_t) 0, tmp_162162);
                                bool y_162164 = slt64(tmp_162162, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162165 = x_162163 && y_162164;
                                bool index_certs_162166;
                                
                                if (!bounds_check_162165) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162167 = tS_start_154033 + tmp_162162;
                                float prev_elem_f_res_162168 = ((float *) tS_mem_171275.mem)[slice_162167];
                                
                                prev_elem_162158 = prev_elem_f_res_162168;
                            }
                            
                            bool cond_162169 = slt64(eta_p_162154, (int64_t) 0);
                            float cur_elem_162170;
                            
                            if (cond_162169) {
                                bool index_certs_162605;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162170 = lt_rhs_154057;
                            } else {
                                bool x_162174 = sle64((int64_t) 0, eta_p_162154);
                                bool y_162175 = slt64(eta_p_162154, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162176 = x_162174 && y_162175;
                                bool index_certs_162177;
                                
                                if (!bounds_check_162176) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162154, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162178 = tS_start_154033 + eta_p_162154;
                                float cur_elem_f_res_162179 = ((float *) tS_mem_171275.mem)[slice_162178];
                                
                                cur_elem_162170 = cur_elem_f_res_162179;
                            }
                            
                            bool cond_162180 = sle64(m_154038, eta_p_162154);
                            float next_elem_162181;
                            
                            if (cond_162180) {
                                bool index_certs_162611;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162181 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162189 = add64((int64_t) 1, eta_p_162154);
                                bool x_162190 = sle64((int64_t) 0, tmp_162189);
                                bool y_162191 = slt64(tmp_162189, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162192 = x_162190 && y_162191;
                                bool index_certs_162193;
                                
                                if (!bounds_check_162192) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162189, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162194 = tS_start_154033 + tmp_162189;
                                float next_elem_f_res_162195 = ((float *) tS_mem_171275.mem)[slice_162194];
                                
                                next_elem_162181 = next_elem_f_res_162195;
                            }
                            
                            int64_t defunc_0_f_res_162200;
                            
                            if (cond_162169) {
                                defunc_0_f_res_162200 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162201 = eta_p_162155 == cur_elem_162170;
                                bool cond_162202 = eta_p_162154 == (int64_t) 0;
                                bool defunc_0_gt_res_162203 = prev_elem_162158 < eta_p_162155;
                                bool x_162204 = !cond_162202;
                                bool y_162205 = defunc_0_gt_res_162203 && x_162204;
                                bool cond_t_res_162206 = cond_162202 || y_162205;
                                bool x_162207 = defunc_0_eq_res_162201 && cond_t_res_162206;
                                int64_t defunc_0_f_res_f_res_162208;
                                
                                if (x_162207) {
                                    defunc_0_f_res_f_res_162208 = eta_p_162154;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162209;
                                    
                                    if (defunc_0_eq_res_162201) {
                                        int64_t max_arg1_162614 = sub64(eta_p_162154, this_step_154086);
                                        int64_t max_res_162615 = smax64((int64_t) 0, max_arg1_162614);
                                        
                                        defunc_0_f_res_f_res_f_res_162209 = max_res_162615;
                                    } else {
                                        bool defunc_0_gt_res_162212 = cur_elem_162170 < eta_p_162155;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162213;
                                        
                                        if (defunc_0_gt_res_162212) {
                                            bool cond_162617 = eta_p_162154 == m_154038;
                                            bool defunc_0_lt_res_162618 = eta_p_162155 < next_elem_162181;
                                            bool x_162619 = !cond_162617;
                                            bool y_162620 = defunc_0_lt_res_162618 && x_162619;
                                            bool cond_162621 = cond_162617 || y_162620;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                            
                                            if (cond_162621) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_162623 = add64(this_step_154086, eta_p_162154);
                                                int64_t min_res_162624 = smin64(m_154038, min_arg1_162623);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = min_res_162624;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                            
                                            if (cond_t_res_162206) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162224 = sub64(eta_p_162154, this_step_154086);
                                                int64_t max_res_162225 = smax64((int64_t) 0, max_arg1_162224);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = max_res_162225;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                        }
                                        defunc_0_f_res_f_res_f_res_162209 = defunc_0_f_res_f_res_f_res_f_res_162213;
                                    }
                                    defunc_0_f_res_f_res_162208 = defunc_0_f_res_f_res_f_res_162209;
                                }
                                defunc_0_f_res_162200 = defunc_0_f_res_f_res_162208;
                            }
                            ((int64_t *) mem_171301.mem)[i_171003] = defunc_0_f_res_162200;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171982, &mem_171301, "mem_171301") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171984 = this_step_154086;
                        
                        if (memblock_set(ctx, &mem_param_171299, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
                            return 1;
                        last_step_154084 = last_step_tmp_171984;
                    }
                    if (memblock_set(ctx, &ext_mem_171310, &mem_param_171299, "mem_param_171299") != 0)
                        return 1;
                    bsearch_first_154081 = last_step_154084;
                    
                    int64_t bsearch_last_154164;
                    int64_t last_step_154167;
                    
                    if (memblock_set(ctx, &mem_param_171313, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    last_step_154167 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154165 = 0; i_154165 < num_iter_154079; i_154165++) {
                        int64_t zs_lhs_154168 = add64((int64_t) 1, last_step_154167);
                        int64_t max_arg1_154169 = sdiv64(zs_lhs_154168, (int64_t) 2);
                        int64_t max_res_154170 = smax64((int64_t) 1, max_arg1_154169);
                        
                        if (memblock_alloc(ctx, &mem_171315, bytes_171287, "mem_171315")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171007 = 0; i_171007 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171007++) {
                            int64_t eta_p_162277 = ((int64_t *) mem_param_171313.mem)[i_171007];
                            int64_t slice_171251 = tR_start_153990 + i_171007;
                            float eta_p_162278 = ((float *) tR_mem_171274.mem)[slice_171251];
                            bool cond_162280 = slt64(eta_p_162277, (int64_t) 0);
                            float cur_elem_162281;
                            
                            if (cond_162280) {
                                bool index_certs_162627;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162281 = lt_rhs_154057;
                            } else {
                                bool x_162285 = sle64((int64_t) 0, eta_p_162277);
                                bool y_162286 = slt64(eta_p_162277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162287 = x_162285 && y_162286;
                                bool index_certs_162288;
                                
                                if (!bounds_check_162287) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162289 = tS_start_154033 + eta_p_162277;
                                float cur_elem_f_res_162290 = ((float *) tS_mem_171275.mem)[slice_162289];
                                
                                cur_elem_162281 = cur_elem_f_res_162290;
                            }
                            
                            bool cond_162291 = sle64(m_154038, eta_p_162277);
                            float next_elem_162292;
                            
                            if (cond_162291) {
                                bool index_certs_162633;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162292 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162300 = add64((int64_t) 1, eta_p_162277);
                                bool x_162301 = sle64((int64_t) 0, tmp_162300);
                                bool y_162302 = slt64(tmp_162300, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162303 = x_162301 && y_162302;
                                bool index_certs_162304;
                                
                                if (!bounds_check_162303) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162300, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162305 = tS_start_154033 + tmp_162300;
                                float next_elem_f_res_162306 = ((float *) tS_mem_171275.mem)[slice_162305];
                                
                                next_elem_162292 = next_elem_f_res_162306;
                            }
                            
                            int64_t defunc_0_f_res_162310;
                            
                            if (cond_162280) {
                                defunc_0_f_res_162310 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162311 = eta_p_162278 == cur_elem_162281;
                                bool cond_162313 = eta_p_162277 == m_154038;
                                bool defunc_0_gt_res_162314 = eta_p_162278 < next_elem_162292;
                                bool x_162315 = !cond_162313;
                                bool y_162316 = defunc_0_gt_res_162314 && x_162315;
                                bool cond_t_res_162317 = cond_162313 || y_162316;
                                bool x_162318 = defunc_0_eq_res_162311 && cond_t_res_162317;
                                int64_t defunc_0_f_res_f_res_162319;
                                
                                if (x_162318) {
                                    defunc_0_f_res_f_res_162319 = eta_p_162277;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162320;
                                    
                                    if (defunc_0_eq_res_162311) {
                                        int64_t min_arg1_162636 = add64(max_res_154170, eta_p_162277);
                                        int64_t min_res_162637 = smin64(m_154038, min_arg1_162636);
                                        
                                        defunc_0_f_res_f_res_f_res_162320 = min_res_162637;
                                    } else {
                                        bool defunc_0_gt_res_162323 = cur_elem_162281 < eta_p_162278;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162324;
                                        
                                        if (defunc_0_gt_res_162323) {
                                            int64_t min_arg1_162638 = add64(max_res_154170, eta_p_162277);
                                            int64_t min_res_162639 = smin64(m_154038, min_arg1_162638);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = min_res_162639;
                                        } else {
                                            int64_t max_arg1_162327 = sub64(eta_p_162277, max_res_154170);
                                            int64_t max_res_162328 = smax64((int64_t) 0, max_arg1_162327);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = max_res_162328;
                                        }
                                        defunc_0_f_res_f_res_f_res_162320 = defunc_0_f_res_f_res_f_res_f_res_162324;
                                    }
                                    defunc_0_f_res_f_res_162319 = defunc_0_f_res_f_res_f_res_162320;
                                }
                                defunc_0_f_res_162310 = defunc_0_f_res_f_res_162319;
                            }
                            ((int64_t *) mem_171315.mem)[i_171007] = defunc_0_f_res_162310;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171986, &mem_171315, "mem_171315") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171988 = max_res_154170;
                        
                        if (memblock_set(ctx, &mem_param_171313, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
                            return 1;
                        last_step_154167 = last_step_tmp_171988;
                    }
                    if (memblock_set(ctx, &ext_mem_171324, &mem_param_171313, "mem_param_171313") != 0)
                        return 1;
                    bsearch_last_154164 = last_step_154167;
                    if (memblock_alloc(ctx, &mem_171326, bytes_171287, "mem_171326")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171328, bytes_171287, "mem_171328")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171013 = 0; i_171013 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171013++) {
                        int64_t eta_p_162133 = ((int64_t *) ext_mem_171310.mem)[i_171013];
                        int64_t eta_p_162134 = ((int64_t *) mem_param_171296.mem)[ctx_param_ext_171294 + i_171013 * ctx_param_ext_171295];
                        int64_t eta_p_162135 = ((int64_t *) ext_mem_171324.mem)[i_171013];
                        int64_t eta_p_162136 = ((int64_t *) mem_param_171293.mem)[ctx_param_ext_171291 + i_171013 * ctx_param_ext_171292];
                        bool cond_162138 = slt64(eta_p_162133, (int64_t) 0);
                        int64_t lifted_lambda_res_162139;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162139 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162140 = sub64(eta_p_162135, eta_p_162133);
                            int64_t lifted_lambda_res_f_res_162141 = add64((int64_t) 1, zp_lhs_162140);
                            
                            lifted_lambda_res_162139 = lifted_lambda_res_f_res_162141;
                        }
                        
                        int64_t defunc_0_f_res_162143 = add64(eta_p_162136, lifted_lambda_res_162139);
                        int64_t lifted_lambda_res_162146;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162146 = eta_p_162133;
                        } else {
                            int64_t lifted_lambda_res_f_res_162147 = add64(find_joinTuples_arg3_154074, eta_p_162133);
                            
                            lifted_lambda_res_162146 = lifted_lambda_res_f_res_162147;
                        }
                        
                        bool cond_162149 = slt64(eta_p_162134, (int64_t) 0);
                        int64_t lifted_lambda_res_162150;
                        
                        if (cond_162149) {
                            lifted_lambda_res_162150 = lifted_lambda_res_162146;
                        } else {
                            lifted_lambda_res_162150 = eta_p_162134;
                        }
                        ((int64_t *) mem_171326.mem)[i_171013] = lifted_lambda_res_162150;
                        ((int64_t *) mem_171328.mem)[i_171013] = defunc_0_f_res_162143;
                    }
                    if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
                        return 1;
                    
                    int64_t tmp_154247 = add64((int64_t) 1, s_iter_154029);
                    
                    if (memblock_set(ctx, &ext_mem_171346, &mem_171328, "mem_171328") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_171326, "mem_171326") != 0)
                        return 1;
                    loopres_f_res_154066 = tmp_154247;
                    loopres_f_res_154069 = nextRel_154073;
                }
                if (memblock_set(ctx, &ext_mem_171352, &ext_mem_171346, "ext_mem_171346") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &ext_mem_171343, "ext_mem_171343") != 0)
                    return 1;
                loopres_154060 = loopres_f_res_154066;
                loopres_154063 = loopres_f_res_154069;
                loopres_154064 = minRelevant_154032;
            }
            
            bool cond_154248 = slt64(loopres_154060, numIter_S_153975);
            bool x_154249 = loopres_154063 && cond_154248;
            
            if (memblock_set(ctx, &mem_param_tmp_171971, &ext_mem_171352, "ext_mem_171352") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171972, &ext_mem_171349, "ext_mem_171349") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_171973 = ext_171351;
            int64_t ctx_param_ext_tmp_171974 = ext_171350;
            int64_t ctx_param_ext_tmp_171975 = ext_171348;
            int64_t ctx_param_ext_tmp_171976 = ext_171347;
            bool loop_while_tmp_171977 = x_154249;
            int64_t s_iter_tmp_171978 = loopres_154060;
            int64_t minRelevant_tmp_171981 = loopres_154064;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171296, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
                return 1;
            ctx_param_ext_171291 = ctx_param_ext_tmp_171973;
            ctx_param_ext_171292 = ctx_param_ext_tmp_171974;
            ctx_param_ext_171294 = ctx_param_ext_tmp_171975;
            ctx_param_ext_171295 = ctx_param_ext_tmp_171976;
            loop_while_154028 = loop_while_tmp_171977;
            s_iter_154029 = s_iter_tmp_171978;
            minRelevant_154032 = minRelevant_tmp_171981;
        }
        if (memblock_set(ctx, &ext_mem_171358, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171357, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        ext_171356 = ctx_param_ext_171291;
        ext_171355 = ctx_param_ext_171292;
        ext_171354 = ctx_param_ext_171294;
        ext_171353 = ctx_param_ext_171295;
        loopres_154023 = loop_while_154028;
        loopres_154024 = s_iter_154029;
        loopres_154027 = minRelevant_154032;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171360, bytes_171277, "mem_171360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_124250});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171357.mem, ext_171354, (int64_t []) {ext_171353}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171362, bytes_171277, "mem_171362")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_124250});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171358.mem, ext_171356, (int64_t []) {ext_171355}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        
        int64_t tmp_154255 = add64((int64_t) 1, iter_153986);
        bool loop_cond_154256 = slt64(tmp_154255, numIter_R_153972);
        
        if (memblock_set(ctx, &mem_param_tmp_171962, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171360, "mem_171360") != 0)
            return 1;
        
        bool loop_while_tmp_171964 = loop_cond_154256;
        int64_t iter_tmp_171965 = tmp_154255;
        int64_t first_relevant_in_S_tmp_171968 = loopres_154027;
        
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        loop_while_153985 = loop_while_tmp_171964;
        iter_153986 = iter_tmp_171965;
        first_relevant_in_S_153989 = first_relevant_in_S_tmp_171968;
    }
    if (memblock_set(ctx, &ext_mem_171368, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171367, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    defunc_0_mergeJoin_res_153980 = loop_while_153985;
    defunc_0_mergeJoin_res_153981 = iter_153986;
    defunc_0_mergeJoin_res_153984 = first_relevant_in_S_153989;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
        return 1;
    if (mem_171370_cached_sizze_172285 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171370, &mem_171370_cached_sizze_172285, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171372_cached_sizze_172286 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171372, &mem_171372_cached_sizze_172286, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_171373 = (int64_t) 4 * nR_124250;
    
    if (mem_171374_cached_sizze_172287 < bytes_171373) {
        err = lexical_realloc(ctx, &mem_171374, &mem_171374_cached_sizze_172287, bytes_171373);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171376_cached_sizze_172288 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171376, &mem_171376_cached_sizze_172288, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171378_cached_sizze_172289 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171378, &mem_171378_cached_sizze_172289, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171380_cached_sizze_172290 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171380, &mem_171380_cached_sizze_172290, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171382_cached_sizze_172291 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171382, &mem_171382_cached_sizze_172291, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171041;
    int64_t discard_171042;
    int64_t defunc_res_162686;
    int64_t scanacc_171023;
    int64_t scanacc_171024;
    int64_t redout_171027;
    
    scanacc_171023 = (int64_t) 0;
    scanacc_171024 = (int64_t) 0;
    redout_171027 = (int64_t) 0;
    for (int64_t i_171033 = 0; i_171033 < nR_124250; i_171033++) {
        int64_t zg_lhs_162079 = ((int64_t *) ext_mem_171368.mem)[i_171033];
        bool cond_162080 = slt64((int64_t) 0, zg_lhs_162079);
        int64_t lifted_lambda_res_162081;
        
        if (cond_162080) {
            lifted_lambda_res_162081 = i_171033;
        } else {
            lifted_lambda_res_162081 = (int64_t) -1;
        }
        
        bool cond_162083 = sle64((int64_t) 0, lifted_lambda_res_162081);
        bool cond_t_res_162084 = slt64(lifted_lambda_res_162081, nR_124250);
        bool x_162085 = cond_162083 && cond_t_res_162084;
        int64_t lifted_lambda_res_162086;
        
        if (x_162085) {
            bool index_certs_162643;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_124250, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:190:99-102\n   #4  ftRelational.fut:181:3-190:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_162644 = ((int64_t *) ext_mem_171368.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162086 = lifted_lambda_res_t_res_162644;
        } else {
            lifted_lambda_res_162086 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162090 = slt64((int64_t) 1, lifted_lambda_res_162086);
        int64_t defunc_0_f_res_162091 = btoi_bool_i64(lifted_lambda_res_162090);
        float lifted_lambda_res_162103;
        int64_t lifted_lambda_res_162104;
        int64_t lifted_lambda_res_162105;
        
        if (x_162085) {
            bool index_certs_162645;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_124250, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:190:99-102\n   #5  ftRelational.fut:181:3-190:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float lifted_lambda_res_t_res_162646 = ((float *) tR_mem_171274.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162647 = ((int64_t *) ext_mem_171276.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162648 = ((int64_t *) ext_mem_171367.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162103 = lifted_lambda_res_t_res_162646;
            lifted_lambda_res_162104 = lifted_lambda_res_t_res_162647;
            lifted_lambda_res_162105 = lifted_lambda_res_t_res_162648;
        } else {
            lifted_lambda_res_162103 = 0.0F;
            lifted_lambda_res_162104 = (int64_t) -1;
            lifted_lambda_res_162105 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154319 = add64(defunc_0_f_res_162091, scanacc_171023);
        int64_t lifted_lambda_res_154280 = add64(lifted_lambda_res_162086, scanacc_171024);
        int64_t zp_res_154300 = add64(lifted_lambda_res_162086, redout_171027);
        
        ((int64_t *) mem_171370)[i_171033] = defunc_0_op_res_154319;
        ((int64_t *) mem_171372)[i_171033] = lifted_lambda_res_154280;
        ((float *) mem_171374)[i_171033] = lifted_lambda_res_162103;
        ((int64_t *) mem_171376)[i_171033] = lifted_lambda_res_162104;
        ((int64_t *) mem_171378)[i_171033] = lifted_lambda_res_162105;
        ((int64_t *) mem_171380)[i_171033] = defunc_0_f_res_162091;
        ((int64_t *) mem_171382)[i_171033] = lifted_lambda_res_162086;
        
        int64_t scanacc_tmp_171992 = defunc_0_op_res_154319;
        int64_t scanacc_tmp_171993 = lifted_lambda_res_154280;
        int64_t redout_tmp_171996 = zp_res_154300;
        
        scanacc_171023 = scanacc_tmp_171992;
        scanacc_171024 = scanacc_tmp_171993;
        redout_171027 = redout_tmp_171996;
    }
    discard_171041 = scanacc_171023;
    discard_171042 = scanacc_171024;
    defunc_res_162686 = redout_171027;
    if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
        return 1;
    
    int64_t bytes_171433 = (int64_t) 4 * defunc_res_162686;
    int64_t bytes_171435 = (int64_t) 8 * defunc_res_162686;
    bool cond_154320 = nR_124250 == (int64_t) 0;
    bool x_154321 = !cond_154320;
    int64_t tmp_154322 = sub64(nR_124250, (int64_t) 1);
    bool x_154323 = sle64((int64_t) 0, tmp_154322);
    bool y_154324 = slt64(tmp_154322, nR_124250);
    bool bounds_check_154325 = x_154323 && y_154324;
    bool protect_assert_disj_154326 = cond_154320 || bounds_check_154325;
    bool index_certs_154327;
    
    if (!protect_assert_disj_154326) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154322, "] out of bounds for array of shape [", (long long) nR_124250, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:190:99-102\n   #4  ftRelational.fut:181:3-190:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154328;
    
    if (x_154321) {
        int64_t x_162649 = ((int64_t *) mem_171370)[tmp_154322];
        
        m_f_res_154328 = x_162649;
    } else {
        m_f_res_154328 = (int64_t) 0;
    }
    
    int64_t m_154330;
    
    if (cond_154320) {
        m_154330 = (int64_t) 0;
    } else {
        m_154330 = m_f_res_154328;
    }
    
    bool cond_154353 = slt64((int64_t) 0, m_154330);
    int64_t m_154340 = sub64(m_154330, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154342 = slt64(m_154340, nR_124250);
    bool zzero_leq_i_p_m_t_s_154341 = sle64((int64_t) 0, m_154340);
    bool y_154344 = zzero_leq_i_p_m_t_s_154341 && i_p_m_t_s_leq_w_154342;
    bool i_lte_j_154343 = sle64((int64_t) 0, m_154330);
    bool forwards_ok_154345 = i_lte_j_154343 && y_154344;
    bool eq_x_zz_154337 = (int64_t) 0 == m_f_res_154328;
    bool p_and_eq_x_y_154338 = x_154321 && eq_x_zz_154337;
    bool empty_slice_154339 = cond_154320 || p_and_eq_x_y_154338;
    bool ok_or_empty_154346 = empty_slice_154339 || forwards_ok_154345;
    bool index_certs_154347;
    
    if (!ok_or_empty_154346) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154330, "] out of bounds for array of shape [", (long long) nR_124250, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:190:99-102\n   #4  ftRelational.fut:181:3-190:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171457 = (int64_t) 8 * m_154330;
    
    if (mem_171458_cached_sizze_172293 < bytes_171457) {
        err = lexical_realloc(ctx, &mem_171458, &mem_171458_cached_sizze_172293, bytes_171457);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171382, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154330});
    
    int64_t max_mult_154354;
    
    if (cond_154353) {
        if (mem_171460_cached_sizze_172294 < bytes_171277) {
            err = lexical_realloc(ctx, &mem_171460, &mem_171460_cached_sizze_172294, bytes_171277);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171060 = 0; i_171060 < nR_124250; i_171060++) {
            int64_t eta_p_162655 = ((int64_t *) mem_171380)[i_171060];
            int64_t eta_p_162656 = ((int64_t *) mem_171370)[i_171060];
            bool cond_162657 = eta_p_162655 == (int64_t) 1;
            int64_t lifted_lambda_res_162658;
            
            if (cond_162657) {
                int64_t lifted_lambda_res_t_res_162659 = sub64(eta_p_162656, (int64_t) 1);
                
                lifted_lambda_res_162658 = lifted_lambda_res_t_res_162659;
            } else {
                lifted_lambda_res_162658 = (int64_t) -1;
            }
            ((int64_t *) mem_171460)[i_171060] = lifted_lambda_res_162658;
        }
        for (int64_t write_iter_171062 = 0; write_iter_171062 < nR_124250; write_iter_171062++) {
            int64_t write_iv_171064 = ((int64_t *) mem_171460)[write_iter_171062];
            int64_t write_iv_171065 = ((int64_t *) mem_171382)[write_iter_171062];
            
            if (sle64((int64_t) 0, write_iv_171064) && slt64(write_iv_171064, m_154330)) {
                ((int64_t *) mem_171458)[write_iv_171064] = write_iv_171065;
            }
        }
        
        int64_t defunc_0_reduce_res_162669;
        int64_t redout_171067 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171068 = 0; i_171068 < m_154330; i_171068++) {
            int64_t x_162670 = ((int64_t *) mem_171458)[i_171068];
            int64_t max_res_162673 = smax64(x_162670, redout_171067);
            int64_t redout_tmp_172004 = max_res_162673;
            
            redout_171067 = redout_tmp_172004;
        }
        defunc_0_reduce_res_162669 = redout_171067;
        max_mult_154354 = defunc_0_reduce_res_162669;
    } else {
        max_mult_154354 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154360 = slt64(max_mult_154354, (int64_t) 1);
    bool valid_154362 = !bounds_invalid_upwards_154360;
    bool range_valid_c_154363;
    
    if (!valid_154362) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154354, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:190:99-102\n   #3  ftRelational.fut:181:3-190:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171426_cached_sizze_172292 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171426, &mem_171426_cached_sizze_172292, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171045 = 0; i_171045 < nR_124250; i_171045++) {
        int64_t eta_p_161986 = ((int64_t *) mem_171382)[i_171045];
        int64_t zv_lhs_161988 = add64((int64_t) -1, i_171045);
        int64_t tmp_161989 = smod64(zv_lhs_161988, nR_124250);
        int64_t lifted_lambda_res_161990 = ((int64_t *) mem_171372)[tmp_161989];
        bool cond_161992 = i_171045 == (int64_t) 0;
        int64_t lifted_lambda_res_161993;
        
        if (cond_161992) {
            lifted_lambda_res_161993 = (int64_t) 0;
        } else {
            lifted_lambda_res_161993 = lifted_lambda_res_161990;
        }
        
        bool cond_161995 = slt64((int64_t) 0, eta_p_161986);
        int64_t lifted_lambda_res_161996;
        
        if (cond_161995) {
            lifted_lambda_res_161996 = lifted_lambda_res_161993;
        } else {
            lifted_lambda_res_161996 = (int64_t) -1;
        }
        ((int64_t *) mem_171426)[i_171045] = lifted_lambda_res_161996;
    }
    if (memblock_alloc(ctx, &mem_171434, bytes_171433, "mem_171434")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172006 = 0; nest_i_172006 < defunc_res_162686; nest_i_172006++) {
        ((float *) mem_171434.mem)[nest_i_172006] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_171436, bytes_171435, "mem_171436")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172007 = 0; nest_i_172007 < defunc_res_162686; nest_i_172007++) {
        ((int64_t *) mem_171436.mem)[nest_i_172007] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171438, bytes_171435, "mem_171438")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172008 = 0; nest_i_172008 < defunc_res_162686; nest_i_172008++) {
        ((int64_t *) mem_171438.mem)[nest_i_172008] = (int64_t) -1;
    }
    for (int64_t write_iter_171047 = 0; write_iter_171047 < nR_124250; write_iter_171047++) {
        int64_t write_iv_171051 = ((int64_t *) mem_171426)[write_iter_171047];
        float write_iv_171052 = ((float *) mem_171374)[write_iter_171047];
        int64_t write_iv_171053 = ((int64_t *) mem_171376)[write_iter_171047];
        int64_t write_iv_171054 = ((int64_t *) mem_171378)[write_iter_171047];
        
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((float *) mem_171434.mem)[write_iv_171051] = write_iv_171052;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171436.mem)[write_iv_171051] = write_iv_171053;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171438.mem)[write_iv_171051] = write_iv_171054;
        }
    }
    
    int64_t distance_154361 = sub64(max_mult_154354, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_171475, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171478, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171481, &mem_171438, "mem_171438") != 0)
        return 1;
    for (int64_t i_154367 = 0; i_154367 < distance_154361; i_154367++) {
        int64_t index_primexp_154371 = add64((int64_t) 1, i_154367);
        
        if (memblock_alloc(ctx, &mem_171483, bytes_171435, "mem_171483")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171483.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171485, bytes_171435, "mem_171485")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171485.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171478.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171487, bytes_171433, "mem_171487")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        for (int64_t write_iter_171069 = 0; write_iter_171069 < nR_124250; write_iter_171069++) {
            int64_t write_iv_171074 = ((int64_t *) mem_171378)[write_iter_171069];
            float write_iv_171075 = ((float *) mem_171374)[write_iter_171069];
            int64_t write_iv_171076 = ((int64_t *) mem_171376)[write_iter_171069];
            int64_t zg_lhs_162583 = ((int64_t *) mem_171382)[write_iter_171069];
            bool cond_162584 = slt64(index_primexp_154371, zg_lhs_162583);
            int64_t lifted_lambda_res_162585;
            
            if (cond_162584) {
                int64_t zp_lhs_162679 = ((int64_t *) mem_171426)[write_iter_171069];
                int64_t lifted_lambda_res_t_res_162680 = add64(index_primexp_154371, zp_lhs_162679);
                
                lifted_lambda_res_162585 = lifted_lambda_res_t_res_162680;
            } else {
                lifted_lambda_res_162585 = (int64_t) -1;
            }
            
            int64_t tmp_162589 = add64(index_primexp_154371, write_iv_171074);
            
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((float *) mem_171487.mem)[lifted_lambda_res_162585] = write_iv_171075;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171485.mem)[lifted_lambda_res_162585] = write_iv_171076;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171483.mem)[lifted_lambda_res_162585] = tmp_162589;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172012, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172013, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172014, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171475, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171478, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171481, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171514, &mem_param_171475, "mem_param_171475") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171513, &mem_param_171478, "mem_param_171478") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171512, &mem_param_171481, "mem_param_171481") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171516, bytes_171433, "mem_171516")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171516.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171514.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171518, bytes_171435, "mem_171518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171518.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171520, bytes_171435, "mem_171520")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171520.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171518, "mem_171518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171520, "mem_171520") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &mem_171516, "mem_171516") != 0)
        return 1;
    prim_out_171959 = defunc_res_162686;
    if (memblock_set(ctx, &*mem_out_p_172281, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172282, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172283, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172284 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171370);
        free(mem_171372);
        free(mem_171374);
        free(mem_171376);
        free(mem_171378);
        free(mem_171380);
        free(mem_171382);
        free(mem_171426);
        free(mem_171458);
        free(mem_171460);
        if (memblock_unref(ctx, &mem_171520, "mem_171520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171518, "mem_171518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171516, "mem_171516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171481, "mem_param_171481") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171478, "mem_param_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171475, "mem_param_171475") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171360, "mem_171360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171328, "mem_171328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171326, "mem_171326") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171315, "mem_171315") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171313, "mem_param_171313") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171301, "mem_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171299, "mem_param_171299") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171343, "ext_mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171346, "ext_mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171352, "ext_mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_172295, struct memblock *mem_out_p_172296, struct memblock *mem_out_p_172297, int64_t *out_prim_out_172298, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_118936, int64_t nS_118937, int64_t offset_R_118940, int64_t offset_S_118941, int64_t partitionSizze_118942, int64_t scatter_psizze_118943)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171370_cached_sizze_172299 = 0;
    unsigned char *mem_171370 = NULL;
    int64_t mem_171372_cached_sizze_172300 = 0;
    unsigned char *mem_171372 = NULL;
    int64_t mem_171374_cached_sizze_172301 = 0;
    unsigned char *mem_171374 = NULL;
    int64_t mem_171376_cached_sizze_172302 = 0;
    unsigned char *mem_171376 = NULL;
    int64_t mem_171378_cached_sizze_172303 = 0;
    unsigned char *mem_171378 = NULL;
    int64_t mem_171380_cached_sizze_172304 = 0;
    unsigned char *mem_171380 = NULL;
    int64_t mem_171382_cached_sizze_172305 = 0;
    unsigned char *mem_171382 = NULL;
    int64_t mem_171426_cached_sizze_172306 = 0;
    unsigned char *mem_171426 = NULL;
    int64_t mem_171458_cached_sizze_172307 = 0;
    unsigned char *mem_171458 = NULL;
    int64_t mem_171460_cached_sizze_172308 = 0;
    unsigned char *mem_171460 = NULL;
    struct memblock mem_171520;
    
    mem_171520.references = NULL;
    
    struct memblock mem_171518;
    
    mem_171518.references = NULL;
    
    struct memblock mem_171516;
    
    mem_171516.references = NULL;
    
    struct memblock mem_param_tmp_172014;
    
    mem_param_tmp_172014.references = NULL;
    
    struct memblock mem_param_tmp_172013;
    
    mem_param_tmp_172013.references = NULL;
    
    struct memblock mem_param_tmp_172012;
    
    mem_param_tmp_172012.references = NULL;
    
    struct memblock mem_171487;
    
    mem_171487.references = NULL;
    
    struct memblock mem_171485;
    
    mem_171485.references = NULL;
    
    struct memblock mem_171483;
    
    mem_171483.references = NULL;
    
    struct memblock mem_param_171481;
    
    mem_param_171481.references = NULL;
    
    struct memblock mem_param_171478;
    
    mem_param_171478.references = NULL;
    
    struct memblock mem_param_171475;
    
    mem_param_171475.references = NULL;
    
    struct memblock ext_mem_171512;
    
    ext_mem_171512.references = NULL;
    
    struct memblock ext_mem_171513;
    
    ext_mem_171513.references = NULL;
    
    struct memblock ext_mem_171514;
    
    ext_mem_171514.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock mem_171436;
    
    mem_171436.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_171362;
    
    mem_171362.references = NULL;
    
    struct memblock mem_171360;
    
    mem_171360.references = NULL;
    
    struct memblock mem_param_tmp_171972;
    
    mem_param_tmp_171972.references = NULL;
    
    struct memblock mem_param_tmp_171971;
    
    mem_param_tmp_171971.references = NULL;
    
    struct memblock mem_171328;
    
    mem_171328.references = NULL;
    
    struct memblock mem_171326;
    
    mem_171326.references = NULL;
    
    struct memblock mem_param_tmp_171986;
    
    mem_param_tmp_171986.references = NULL;
    
    struct memblock mem_171315;
    
    mem_171315.references = NULL;
    
    struct memblock mem_param_171313;
    
    mem_param_171313.references = NULL;
    
    struct memblock ext_mem_171324;
    
    ext_mem_171324.references = NULL;
    
    struct memblock mem_param_tmp_171982;
    
    mem_param_tmp_171982.references = NULL;
    
    struct memblock mem_171301;
    
    mem_171301.references = NULL;
    
    struct memblock mem_param_171299;
    
    mem_param_171299.references = NULL;
    
    struct memblock ext_mem_171310;
    
    ext_mem_171310.references = NULL;
    
    struct memblock ext_mem_171343;
    
    ext_mem_171343.references = NULL;
    
    struct memblock ext_mem_171346;
    
    ext_mem_171346.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock ext_mem_171352;
    
    ext_mem_171352.references = NULL;
    
    struct memblock mem_param_171296;
    
    mem_param_171296.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171357;
    
    ext_mem_171357.references = NULL;
    
    struct memblock ext_mem_171358;
    
    ext_mem_171358.references = NULL;
    
    struct memblock mem_171290;
    
    mem_171290.references = NULL;
    
    struct memblock mem_171288;
    
    mem_171288.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock ext_mem_171367;
    
    ext_mem_171367.references = NULL;
    
    struct memblock ext_mem_171368;
    
    ext_mem_171368.references = NULL;
    
    struct memblock mem_171280;
    
    mem_171280.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock ext_mem_171276;
    
    ext_mem_171276.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t partitionSizze_153966 = sdiv64(partitionSizze_118942, (int64_t) 4);
    int64_t zm_lhs_153967 = add64(nR_118936, partitionSizze_153966);
    int64_t zs_lhs_153968 = sub64(zm_lhs_153967, (int64_t) 1);
    bool zzero_153969 = partitionSizze_153966 == (int64_t) 0;
    bool nonzzero_153970 = !zzero_153969;
    bool nonzzero_cert_153971;
    
    if (!nonzzero_153970) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_153972 = sdiv64(zs_lhs_153968, partitionSizze_153966);
    int64_t zm_lhs_153973 = add64(nS_118937, partitionSizze_153966);
    int64_t zs_lhs_153974 = sub64(zm_lhs_153973, (int64_t) 1);
    int64_t numIter_S_153975 = sdiv64(zs_lhs_153974, partitionSizze_153966);
    
    if (futrts_indicesWithIncrement_16277(ctx, &ext_mem_171276, tR_mem_171274, nR_118936, offset_R_118940) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171277 = (int64_t) 8 * nR_118936;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171960 = 0; nest_i_171960 < nR_118936; nest_i_171960++) {
        ((int64_t *) mem_171278.mem)[nest_i_171960] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171280, bytes_171277, "mem_171280")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171961 = 0; nest_i_171961 < nR_118936; nest_i_171961++) {
        ((int64_t *) mem_171280.mem)[nest_i_171961] = (int64_t) 0;
    }
    
    bool loop_cond_153979 = slt64((int64_t) 0, numIter_R_153972);
    bool defunc_0_mergeJoin_res_153980;
    int64_t defunc_0_mergeJoin_res_153981;
    int64_t defunc_0_mergeJoin_res_153984;
    bool loop_while_153985;
    int64_t iter_153986;
    int64_t first_relevant_in_S_153989;
    
    if (memblock_set(ctx, &mem_param_171283, &mem_171280, "mem_171280") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &mem_171278, "mem_171278") != 0)
        return 1;
    loop_while_153985 = loop_cond_153979;
    iter_153986 = (int64_t) 0;
    first_relevant_in_S_153989 = (int64_t) 0;
    while (loop_while_153985) {
        int64_t tR_start_153990 = mul64(partitionSizze_153966, iter_153986);
        int64_t min_arg1_153991 = add64(partitionSizze_153966, tR_start_153990);
        int64_t min_res_153992 = smin64(nR_118936, min_arg1_153991);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 = sub64(min_res_153992, tR_start_153990);
        bool empty_slice_153994 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 == (int64_t) 0;
        int64_t m_153995 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, (int64_t) 1);
        int64_t i_p_m_t_s_153996 = add64(tR_start_153990, m_153995);
        bool zzero_leq_i_p_m_t_s_153997 = sle64((int64_t) 0, i_p_m_t_s_153996);
        bool i_p_m_t_s_leq_w_153998 = slt64(i_p_m_t_s_153996, nR_118936);
        bool zzero_lte_i_153999 = sle64((int64_t) 0, tR_start_153990);
        bool i_lte_j_154000 = sle64(tR_start_153990, min_res_153992);
        bool y_154001 = i_p_m_t_s_leq_w_153998 && zzero_lte_i_153999;
        bool y_154002 = zzero_leq_i_p_m_t_s_153997 && y_154001;
        bool forwards_ok_154003 = i_lte_j_154000 && y_154002;
        bool ok_or_empty_154004 = empty_slice_153994 || forwards_ok_154003;
        bool index_certs_154005;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_118936, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171287 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993;
        bool cond_154009 = slt64(first_relevant_in_S_153989, numIter_S_153975);
        bool y_154010 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool loop_not_taken_154011 = !cond_154009;
        bool protect_assert_disj_154012 = y_154010 || loop_not_taken_154011;
        bool index_certs_154013;
        
        if (!protect_assert_disj_154012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154016 = sle64((int64_t) 0, m_153995);
        bool y_154017 = slt64(m_153995, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool bounds_check_154018 = x_154016 && y_154017;
        bool protect_assert_disj_154019 = loop_not_taken_154011 || bounds_check_154018;
        bool index_certs_154020;
        
        if (!protect_assert_disj_154019) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154251;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_118936, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:168:99-102\n   #4  ftRelational.fut:159:3-168:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171288, bytes_171287, "mem_171288")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171969 = 0; nest_i_171969 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171969++) {
            ((int64_t *) mem_171288.mem)[nest_i_171969] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171290, bytes_171287, "mem_171290")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171970 = 0; nest_i_171970 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171970++) {
            ((int64_t *) mem_171290.mem)[nest_i_171970] = (int64_t) 0;
        }
        
        int32_t gt_lhs_154014;
        
        if (cond_154009) {
            int32_t x_162598 = ((int32_t *) tR_mem_171274.mem)[tR_start_153990];
            
            gt_lhs_154014 = x_162598;
        } else {
            gt_lhs_154014 = 0;
        }
        
        int32_t lt_lhs_154021;
        
        if (cond_154009) {
            int32_t x_162599 = ((int32_t *) tR_mem_171274.mem)[i_p_m_t_s_153996];
            
            lt_lhs_154021 = x_162599;
        } else {
            lt_lhs_154021 = 0;
        }
        
        int64_t ext_171356;
        int64_t ext_171355;
        int64_t ext_171354;
        int64_t ext_171353;
        bool loopres_154023;
        int64_t loopres_154024;
        int64_t loopres_154027;
        bool loop_while_154028;
        int64_t s_iter_154029;
        int64_t minRelevant_154032;
        int64_t ctx_param_ext_171291;
        int64_t ctx_param_ext_171292;
        int64_t ctx_param_ext_171294;
        int64_t ctx_param_ext_171295;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171296, &mem_171288, "mem_171288") != 0)
            return 1;
        ctx_param_ext_171291 = (int64_t) 0;
        ctx_param_ext_171292 = (int64_t) 1;
        ctx_param_ext_171294 = (int64_t) 0;
        ctx_param_ext_171295 = (int64_t) 1;
        loop_while_154028 = cond_154009;
        s_iter_154029 = first_relevant_in_S_153989;
        minRelevant_154032 = first_relevant_in_S_153989;
        while (loop_while_154028) {
            int64_t tS_start_154033 = mul64(partitionSizze_153966, s_iter_154029);
            int64_t min_arg1_154034 = add64(partitionSizze_153966, tS_start_154033);
            int64_t min_res_154035 = smin64(nS_118937, min_arg1_154034);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 = sub64(min_res_154035, tS_start_154033);
            bool empty_slice_154037 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 == (int64_t) 0;
            int64_t m_154038 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, (int64_t) 1);
            int64_t i_p_m_t_s_154039 = add64(tS_start_154033, m_154038);
            bool zzero_leq_i_p_m_t_s_154040 = sle64((int64_t) 0, i_p_m_t_s_154039);
            bool i_p_m_t_s_leq_w_154041 = slt64(i_p_m_t_s_154039, nS_118937);
            bool zzero_lte_i_154042 = sle64((int64_t) 0, tS_start_154033);
            bool i_lte_j_154043 = sle64(tS_start_154033, min_res_154035);
            bool y_154044 = i_p_m_t_s_leq_w_154041 && zzero_lte_i_154042;
            bool y_154045 = zzero_leq_i_p_m_t_s_154040 && y_154044;
            bool forwards_ok_154046 = i_lte_j_154043 && y_154045;
            bool ok_or_empty_154047 = empty_slice_154037 || forwards_ok_154046;
            bool index_certs_154048;
            
            if (!ok_or_empty_154047) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154033, ":", (long long) min_res_154035, "] out of bounds for array of shape [", (long long) nS_118937, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154049 = sle64((int64_t) 0, m_154038);
            bool y_154050 = slt64(m_154038, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool bounds_check_154051 = x_154049 && y_154050;
            bool index_certs_154052;
            
            if (!bounds_check_154051) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154055 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool index_certs_154056;
            
            if (!y_154055) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t gt_rhs_154053 = ((int32_t *) tS_mem_171275.mem)[i_p_m_t_s_154039];
            bool defunc_0_gt_res_154054 = slt32(gt_rhs_154053, gt_lhs_154014);
            int32_t lt_rhs_154057 = ((int32_t *) tS_mem_171275.mem)[tS_start_154033];
            bool defunc_0_lt_res_154058 = slt32(lt_lhs_154021, lt_rhs_154057);
            bool thisStillRel_154059 = !defunc_0_lt_res_154058;
            int64_t ext_171345;
            
            if (defunc_0_lt_res_154058) {
                ext_171345 = ctx_param_ext_171291;
            } else {
                ext_171345 = (int64_t) 0;
            }
            
            int64_t ext_171344;
            
            if (defunc_0_lt_res_154058) {
                ext_171344 = ctx_param_ext_171292;
            } else {
                ext_171344 = (int64_t) 1;
            }
            
            int64_t ext_171342;
            
            if (defunc_0_lt_res_154058) {
                ext_171342 = ctx_param_ext_171294;
            } else {
                ext_171342 = (int64_t) 0;
            }
            
            int64_t ext_171341;
            
            if (defunc_0_lt_res_154058) {
                ext_171341 = ctx_param_ext_171295;
            } else {
                ext_171341 = (int64_t) 1;
            }
            
            int64_t ext_171351;
            
            if (defunc_0_gt_res_154054) {
                ext_171351 = ctx_param_ext_171291;
            } else {
                ext_171351 = ext_171345;
            }
            
            int64_t ext_171350;
            
            if (defunc_0_gt_res_154054) {
                ext_171350 = ctx_param_ext_171292;
            } else {
                ext_171350 = ext_171344;
            }
            
            int64_t ext_171348;
            
            if (defunc_0_gt_res_154054) {
                ext_171348 = ctx_param_ext_171294;
            } else {
                ext_171348 = ext_171342;
            }
            
            int64_t ext_171347;
            
            if (defunc_0_gt_res_154054) {
                ext_171347 = ctx_param_ext_171295;
            } else {
                ext_171347 = ext_171341;
            }
            
            int64_t loopres_154060;
            bool loopres_154063;
            int64_t loopres_154064;
            
            if (defunc_0_gt_res_154054) {
                int64_t tmp_162600 = add64((int64_t) 1, s_iter_154029);
                
                if (memblock_set(ctx, &ext_mem_171352, &mem_param_171293, "mem_param_171293") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &mem_param_171296, "mem_param_171296") != 0)
                    return 1;
                loopres_154060 = tmp_162600;
                loopres_154063 = 1;
                loopres_154064 = tmp_162600;
            } else {
                int64_t loopres_f_res_154066;
                bool loopres_f_res_154069;
                
                if (defunc_0_lt_res_154058) {
                    if (memblock_set(ctx, &ext_mem_171346, &mem_param_171293, "mem_param_171293") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_param_171296, "mem_param_171296") != 0)
                        return 1;
                    loopres_f_res_154066 = s_iter_154029;
                    loopres_f_res_154069 = thisStillRel_154059;
                } else {
                    bool index_certs_154070;
                    
                    if (!bounds_check_154018) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lt_lhs_154071 = ((int32_t *) tR_mem_171274.mem)[i_p_m_t_s_153996];
                    bool defunc_0_lt_res_154072 = slt32(lt_lhs_154071, gt_rhs_154053);
                    bool nextRel_154073 = !defunc_0_lt_res_154072;
                    int64_t find_joinTuples_arg3_154074 = add64(offset_S_118941, tS_start_154033);
                    double i64_res_154075 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                    double log2_res_154076 = futrts_log2_64(i64_res_154075);
                    double ceil_res_154077 = futrts_ceil64(log2_res_154076);
                    int64_t f64_res_154078 = fptosi_f64_i64(ceil_res_154077);
                    int64_t num_iter_154079 = add64((int64_t) 1, f64_res_154078);
                    int64_t bsearch_first_154081;
                    int64_t last_step_154084;
                    
                    if (memblock_set(ctx, &mem_param_171299, &mem_171290, "mem_171290") != 0)
                        return 1;
                    last_step_154084 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154082 = 0; i_154082 < num_iter_154079; i_154082++) {
                        int64_t zs_lhs_154085 = add64((int64_t) 1, last_step_154084);
                        int64_t this_step_154086 = sdiv64(zs_lhs_154085, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171301, bytes_171287, "mem_171301")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171003++) {
                            int64_t eta_p_162154 = ((int64_t *) mem_param_171299.mem)[i_171003];
                            int64_t slice_171252 = tR_start_153990 + i_171003;
                            int32_t eta_p_162155 = ((int32_t *) tR_mem_171274.mem)[slice_171252];
                            bool cond_162157 = sle64(eta_p_162154, (int64_t) 0);
                            int32_t prev_elem_162158;
                            
                            if (cond_162157) {
                                bool index_certs_162602;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162158 = lt_rhs_154057;
                            } else {
                                int64_t tmp_162162 = sub64(eta_p_162154, (int64_t) 1);
                                bool x_162163 = sle64((int64_t) 0, tmp_162162);
                                bool y_162164 = slt64(tmp_162162, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162165 = x_162163 && y_162164;
                                bool index_certs_162166;
                                
                                if (!bounds_check_162165) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162167 = tS_start_154033 + tmp_162162;
                                int32_t prev_elem_f_res_162168 = ((int32_t *) tS_mem_171275.mem)[slice_162167];
                                
                                prev_elem_162158 = prev_elem_f_res_162168;
                            }
                            
                            bool cond_162169 = slt64(eta_p_162154, (int64_t) 0);
                            int32_t cur_elem_162170;
                            
                            if (cond_162169) {
                                bool index_certs_162605;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162170 = lt_rhs_154057;
                            } else {
                                bool x_162174 = sle64((int64_t) 0, eta_p_162154);
                                bool y_162175 = slt64(eta_p_162154, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162176 = x_162174 && y_162175;
                                bool index_certs_162177;
                                
                                if (!bounds_check_162176) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162154, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162178 = tS_start_154033 + eta_p_162154;
                                int32_t cur_elem_f_res_162179 = ((int32_t *) tS_mem_171275.mem)[slice_162178];
                                
                                cur_elem_162170 = cur_elem_f_res_162179;
                            }
                            
                            bool cond_162180 = sle64(m_154038, eta_p_162154);
                            int32_t next_elem_162181;
                            
                            if (cond_162180) {
                                bool index_certs_162611;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162181 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162189 = add64((int64_t) 1, eta_p_162154);
                                bool x_162190 = sle64((int64_t) 0, tmp_162189);
                                bool y_162191 = slt64(tmp_162189, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162192 = x_162190 && y_162191;
                                bool index_certs_162193;
                                
                                if (!bounds_check_162192) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162189, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162194 = tS_start_154033 + tmp_162189;
                                int32_t next_elem_f_res_162195 = ((int32_t *) tS_mem_171275.mem)[slice_162194];
                                
                                next_elem_162181 = next_elem_f_res_162195;
                            }
                            
                            int64_t defunc_0_f_res_162200;
                            
                            if (cond_162169) {
                                defunc_0_f_res_162200 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162201 = eta_p_162155 == cur_elem_162170;
                                bool cond_162202 = eta_p_162154 == (int64_t) 0;
                                bool defunc_0_gt_res_162203 = slt32(prev_elem_162158, eta_p_162155);
                                bool x_162204 = !cond_162202;
                                bool y_162205 = defunc_0_gt_res_162203 && x_162204;
                                bool cond_t_res_162206 = cond_162202 || y_162205;
                                bool x_162207 = defunc_0_eq_res_162201 && cond_t_res_162206;
                                int64_t defunc_0_f_res_f_res_162208;
                                
                                if (x_162207) {
                                    defunc_0_f_res_f_res_162208 = eta_p_162154;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162209;
                                    
                                    if (defunc_0_eq_res_162201) {
                                        int64_t max_arg1_162614 = sub64(eta_p_162154, this_step_154086);
                                        int64_t max_res_162615 = smax64((int64_t) 0, max_arg1_162614);
                                        
                                        defunc_0_f_res_f_res_f_res_162209 = max_res_162615;
                                    } else {
                                        bool defunc_0_gt_res_162212 = slt32(cur_elem_162170, eta_p_162155);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162213;
                                        
                                        if (defunc_0_gt_res_162212) {
                                            bool cond_162617 = eta_p_162154 == m_154038;
                                            bool defunc_0_lt_res_162618 = slt32(eta_p_162155, next_elem_162181);
                                            bool x_162619 = !cond_162617;
                                            bool y_162620 = defunc_0_lt_res_162618 && x_162619;
                                            bool cond_162621 = cond_162617 || y_162620;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                            
                                            if (cond_162621) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_162623 = add64(this_step_154086, eta_p_162154);
                                                int64_t min_res_162624 = smin64(m_154038, min_arg1_162623);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = min_res_162624;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                            
                                            if (cond_t_res_162206) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162224 = sub64(eta_p_162154, this_step_154086);
                                                int64_t max_res_162225 = smax64((int64_t) 0, max_arg1_162224);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = max_res_162225;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                        }
                                        defunc_0_f_res_f_res_f_res_162209 = defunc_0_f_res_f_res_f_res_f_res_162213;
                                    }
                                    defunc_0_f_res_f_res_162208 = defunc_0_f_res_f_res_f_res_162209;
                                }
                                defunc_0_f_res_162200 = defunc_0_f_res_f_res_162208;
                            }
                            ((int64_t *) mem_171301.mem)[i_171003] = defunc_0_f_res_162200;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171982, &mem_171301, "mem_171301") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171984 = this_step_154086;
                        
                        if (memblock_set(ctx, &mem_param_171299, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
                            return 1;
                        last_step_154084 = last_step_tmp_171984;
                    }
                    if (memblock_set(ctx, &ext_mem_171310, &mem_param_171299, "mem_param_171299") != 0)
                        return 1;
                    bsearch_first_154081 = last_step_154084;
                    
                    int64_t bsearch_last_154164;
                    int64_t last_step_154167;
                    
                    if (memblock_set(ctx, &mem_param_171313, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    last_step_154167 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154165 = 0; i_154165 < num_iter_154079; i_154165++) {
                        int64_t zs_lhs_154168 = add64((int64_t) 1, last_step_154167);
                        int64_t max_arg1_154169 = sdiv64(zs_lhs_154168, (int64_t) 2);
                        int64_t max_res_154170 = smax64((int64_t) 1, max_arg1_154169);
                        
                        if (memblock_alloc(ctx, &mem_171315, bytes_171287, "mem_171315")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171007 = 0; i_171007 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171007++) {
                            int64_t eta_p_162277 = ((int64_t *) mem_param_171313.mem)[i_171007];
                            int64_t slice_171251 = tR_start_153990 + i_171007;
                            int32_t eta_p_162278 = ((int32_t *) tR_mem_171274.mem)[slice_171251];
                            bool cond_162280 = slt64(eta_p_162277, (int64_t) 0);
                            int32_t cur_elem_162281;
                            
                            if (cond_162280) {
                                bool index_certs_162627;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162281 = lt_rhs_154057;
                            } else {
                                bool x_162285 = sle64((int64_t) 0, eta_p_162277);
                                bool y_162286 = slt64(eta_p_162277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162287 = x_162285 && y_162286;
                                bool index_certs_162288;
                                
                                if (!bounds_check_162287) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162289 = tS_start_154033 + eta_p_162277;
                                int32_t cur_elem_f_res_162290 = ((int32_t *) tS_mem_171275.mem)[slice_162289];
                                
                                cur_elem_162281 = cur_elem_f_res_162290;
                            }
                            
                            bool cond_162291 = sle64(m_154038, eta_p_162277);
                            int32_t next_elem_162292;
                            
                            if (cond_162291) {
                                bool index_certs_162633;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162292 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162300 = add64((int64_t) 1, eta_p_162277);
                                bool x_162301 = sle64((int64_t) 0, tmp_162300);
                                bool y_162302 = slt64(tmp_162300, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162303 = x_162301 && y_162302;
                                bool index_certs_162304;
                                
                                if (!bounds_check_162303) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162300, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162305 = tS_start_154033 + tmp_162300;
                                int32_t next_elem_f_res_162306 = ((int32_t *) tS_mem_171275.mem)[slice_162305];
                                
                                next_elem_162292 = next_elem_f_res_162306;
                            }
                            
                            int64_t defunc_0_f_res_162310;
                            
                            if (cond_162280) {
                                defunc_0_f_res_162310 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162311 = eta_p_162278 == cur_elem_162281;
                                bool cond_162313 = eta_p_162277 == m_154038;
                                bool defunc_0_gt_res_162314 = slt32(eta_p_162278, next_elem_162292);
                                bool x_162315 = !cond_162313;
                                bool y_162316 = defunc_0_gt_res_162314 && x_162315;
                                bool cond_t_res_162317 = cond_162313 || y_162316;
                                bool x_162318 = defunc_0_eq_res_162311 && cond_t_res_162317;
                                int64_t defunc_0_f_res_f_res_162319;
                                
                                if (x_162318) {
                                    defunc_0_f_res_f_res_162319 = eta_p_162277;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162320;
                                    
                                    if (defunc_0_eq_res_162311) {
                                        int64_t min_arg1_162636 = add64(max_res_154170, eta_p_162277);
                                        int64_t min_res_162637 = smin64(m_154038, min_arg1_162636);
                                        
                                        defunc_0_f_res_f_res_f_res_162320 = min_res_162637;
                                    } else {
                                        bool defunc_0_gt_res_162323 = slt32(cur_elem_162281, eta_p_162278);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162324;
                                        
                                        if (defunc_0_gt_res_162323) {
                                            int64_t min_arg1_162638 = add64(max_res_154170, eta_p_162277);
                                            int64_t min_res_162639 = smin64(m_154038, min_arg1_162638);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = min_res_162639;
                                        } else {
                                            int64_t max_arg1_162327 = sub64(eta_p_162277, max_res_154170);
                                            int64_t max_res_162328 = smax64((int64_t) 0, max_arg1_162327);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = max_res_162328;
                                        }
                                        defunc_0_f_res_f_res_f_res_162320 = defunc_0_f_res_f_res_f_res_f_res_162324;
                                    }
                                    defunc_0_f_res_f_res_162319 = defunc_0_f_res_f_res_f_res_162320;
                                }
                                defunc_0_f_res_162310 = defunc_0_f_res_f_res_162319;
                            }
                            ((int64_t *) mem_171315.mem)[i_171007] = defunc_0_f_res_162310;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171986, &mem_171315, "mem_171315") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171988 = max_res_154170;
                        
                        if (memblock_set(ctx, &mem_param_171313, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
                            return 1;
                        last_step_154167 = last_step_tmp_171988;
                    }
                    if (memblock_set(ctx, &ext_mem_171324, &mem_param_171313, "mem_param_171313") != 0)
                        return 1;
                    bsearch_last_154164 = last_step_154167;
                    if (memblock_alloc(ctx, &mem_171326, bytes_171287, "mem_171326")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171328, bytes_171287, "mem_171328")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171013 = 0; i_171013 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171013++) {
                        int64_t eta_p_162133 = ((int64_t *) ext_mem_171310.mem)[i_171013];
                        int64_t eta_p_162134 = ((int64_t *) mem_param_171296.mem)[ctx_param_ext_171294 + i_171013 * ctx_param_ext_171295];
                        int64_t eta_p_162135 = ((int64_t *) ext_mem_171324.mem)[i_171013];
                        int64_t eta_p_162136 = ((int64_t *) mem_param_171293.mem)[ctx_param_ext_171291 + i_171013 * ctx_param_ext_171292];
                        bool cond_162138 = slt64(eta_p_162133, (int64_t) 0);
                        int64_t lifted_lambda_res_162139;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162139 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162140 = sub64(eta_p_162135, eta_p_162133);
                            int64_t lifted_lambda_res_f_res_162141 = add64((int64_t) 1, zp_lhs_162140);
                            
                            lifted_lambda_res_162139 = lifted_lambda_res_f_res_162141;
                        }
                        
                        int64_t defunc_0_f_res_162143 = add64(eta_p_162136, lifted_lambda_res_162139);
                        int64_t lifted_lambda_res_162146;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162146 = eta_p_162133;
                        } else {
                            int64_t lifted_lambda_res_f_res_162147 = add64(find_joinTuples_arg3_154074, eta_p_162133);
                            
                            lifted_lambda_res_162146 = lifted_lambda_res_f_res_162147;
                        }
                        
                        bool cond_162149 = slt64(eta_p_162134, (int64_t) 0);
                        int64_t lifted_lambda_res_162150;
                        
                        if (cond_162149) {
                            lifted_lambda_res_162150 = lifted_lambda_res_162146;
                        } else {
                            lifted_lambda_res_162150 = eta_p_162134;
                        }
                        ((int64_t *) mem_171326.mem)[i_171013] = lifted_lambda_res_162150;
                        ((int64_t *) mem_171328.mem)[i_171013] = defunc_0_f_res_162143;
                    }
                    if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
                        return 1;
                    
                    int64_t tmp_154247 = add64((int64_t) 1, s_iter_154029);
                    
                    if (memblock_set(ctx, &ext_mem_171346, &mem_171328, "mem_171328") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_171326, "mem_171326") != 0)
                        return 1;
                    loopres_f_res_154066 = tmp_154247;
                    loopres_f_res_154069 = nextRel_154073;
                }
                if (memblock_set(ctx, &ext_mem_171352, &ext_mem_171346, "ext_mem_171346") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &ext_mem_171343, "ext_mem_171343") != 0)
                    return 1;
                loopres_154060 = loopres_f_res_154066;
                loopres_154063 = loopres_f_res_154069;
                loopres_154064 = minRelevant_154032;
            }
            
            bool cond_154248 = slt64(loopres_154060, numIter_S_153975);
            bool x_154249 = loopres_154063 && cond_154248;
            
            if (memblock_set(ctx, &mem_param_tmp_171971, &ext_mem_171352, "ext_mem_171352") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171972, &ext_mem_171349, "ext_mem_171349") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_171973 = ext_171351;
            int64_t ctx_param_ext_tmp_171974 = ext_171350;
            int64_t ctx_param_ext_tmp_171975 = ext_171348;
            int64_t ctx_param_ext_tmp_171976 = ext_171347;
            bool loop_while_tmp_171977 = x_154249;
            int64_t s_iter_tmp_171978 = loopres_154060;
            int64_t minRelevant_tmp_171981 = loopres_154064;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171296, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
                return 1;
            ctx_param_ext_171291 = ctx_param_ext_tmp_171973;
            ctx_param_ext_171292 = ctx_param_ext_tmp_171974;
            ctx_param_ext_171294 = ctx_param_ext_tmp_171975;
            ctx_param_ext_171295 = ctx_param_ext_tmp_171976;
            loop_while_154028 = loop_while_tmp_171977;
            s_iter_154029 = s_iter_tmp_171978;
            minRelevant_154032 = minRelevant_tmp_171981;
        }
        if (memblock_set(ctx, &ext_mem_171358, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171357, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        ext_171356 = ctx_param_ext_171291;
        ext_171355 = ctx_param_ext_171292;
        ext_171354 = ctx_param_ext_171294;
        ext_171353 = ctx_param_ext_171295;
        loopres_154023 = loop_while_154028;
        loopres_154024 = s_iter_154029;
        loopres_154027 = minRelevant_154032;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171360, bytes_171277, "mem_171360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_118936});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171357.mem, ext_171354, (int64_t []) {ext_171353}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171362, bytes_171277, "mem_171362")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_118936});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171358.mem, ext_171356, (int64_t []) {ext_171355}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        
        int64_t tmp_154255 = add64((int64_t) 1, iter_153986);
        bool loop_cond_154256 = slt64(tmp_154255, numIter_R_153972);
        
        if (memblock_set(ctx, &mem_param_tmp_171962, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171360, "mem_171360") != 0)
            return 1;
        
        bool loop_while_tmp_171964 = loop_cond_154256;
        int64_t iter_tmp_171965 = tmp_154255;
        int64_t first_relevant_in_S_tmp_171968 = loopres_154027;
        
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        loop_while_153985 = loop_while_tmp_171964;
        iter_153986 = iter_tmp_171965;
        first_relevant_in_S_153989 = first_relevant_in_S_tmp_171968;
    }
    if (memblock_set(ctx, &ext_mem_171368, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171367, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    defunc_0_mergeJoin_res_153980 = loop_while_153985;
    defunc_0_mergeJoin_res_153981 = iter_153986;
    defunc_0_mergeJoin_res_153984 = first_relevant_in_S_153989;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
        return 1;
    if (mem_171370_cached_sizze_172299 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171370, &mem_171370_cached_sizze_172299, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171372_cached_sizze_172300 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171372, &mem_171372_cached_sizze_172300, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_171373 = (int64_t) 4 * nR_118936;
    
    if (mem_171374_cached_sizze_172301 < bytes_171373) {
        err = lexical_realloc(ctx, &mem_171374, &mem_171374_cached_sizze_172301, bytes_171373);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171376_cached_sizze_172302 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171376, &mem_171376_cached_sizze_172302, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171378_cached_sizze_172303 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171378, &mem_171378_cached_sizze_172303, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171380_cached_sizze_172304 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171380, &mem_171380_cached_sizze_172304, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171382_cached_sizze_172305 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171382, &mem_171382_cached_sizze_172305, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171041;
    int64_t discard_171042;
    int64_t defunc_res_162686;
    int64_t scanacc_171023;
    int64_t scanacc_171024;
    int64_t redout_171027;
    
    scanacc_171023 = (int64_t) 0;
    scanacc_171024 = (int64_t) 0;
    redout_171027 = (int64_t) 0;
    for (int64_t i_171033 = 0; i_171033 < nR_118936; i_171033++) {
        int64_t zg_lhs_162079 = ((int64_t *) ext_mem_171368.mem)[i_171033];
        bool cond_162080 = slt64((int64_t) 0, zg_lhs_162079);
        int64_t lifted_lambda_res_162081;
        
        if (cond_162080) {
            lifted_lambda_res_162081 = i_171033;
        } else {
            lifted_lambda_res_162081 = (int64_t) -1;
        }
        
        bool cond_162083 = sle64((int64_t) 0, lifted_lambda_res_162081);
        bool cond_t_res_162084 = slt64(lifted_lambda_res_162081, nR_118936);
        bool x_162085 = cond_162083 && cond_t_res_162084;
        int64_t lifted_lambda_res_162086;
        
        if (x_162085) {
            bool index_certs_162643;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_118936, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:168:99-102\n   #4  ftRelational.fut:159:3-168:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_162644 = ((int64_t *) ext_mem_171368.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162086 = lifted_lambda_res_t_res_162644;
        } else {
            lifted_lambda_res_162086 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162090 = slt64((int64_t) 1, lifted_lambda_res_162086);
        int64_t defunc_0_f_res_162091 = btoi_bool_i64(lifted_lambda_res_162090);
        int32_t lifted_lambda_res_162103;
        int64_t lifted_lambda_res_162104;
        int64_t lifted_lambda_res_162105;
        
        if (x_162085) {
            bool index_certs_162645;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_118936, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:168:99-102\n   #5  ftRelational.fut:159:3-168:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t lifted_lambda_res_t_res_162646 = ((int32_t *) tR_mem_171274.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162647 = ((int64_t *) ext_mem_171276.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162648 = ((int64_t *) ext_mem_171367.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162103 = lifted_lambda_res_t_res_162646;
            lifted_lambda_res_162104 = lifted_lambda_res_t_res_162647;
            lifted_lambda_res_162105 = lifted_lambda_res_t_res_162648;
        } else {
            lifted_lambda_res_162103 = 0;
            lifted_lambda_res_162104 = (int64_t) -1;
            lifted_lambda_res_162105 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154319 = add64(defunc_0_f_res_162091, scanacc_171023);
        int64_t lifted_lambda_res_154280 = add64(lifted_lambda_res_162086, scanacc_171024);
        int64_t zp_res_154300 = add64(lifted_lambda_res_162086, redout_171027);
        
        ((int64_t *) mem_171370)[i_171033] = defunc_0_op_res_154319;
        ((int64_t *) mem_171372)[i_171033] = lifted_lambda_res_154280;
        ((int32_t *) mem_171374)[i_171033] = lifted_lambda_res_162103;
        ((int64_t *) mem_171376)[i_171033] = lifted_lambda_res_162104;
        ((int64_t *) mem_171378)[i_171033] = lifted_lambda_res_162105;
        ((int64_t *) mem_171380)[i_171033] = defunc_0_f_res_162091;
        ((int64_t *) mem_171382)[i_171033] = lifted_lambda_res_162086;
        
        int64_t scanacc_tmp_171992 = defunc_0_op_res_154319;
        int64_t scanacc_tmp_171993 = lifted_lambda_res_154280;
        int64_t redout_tmp_171996 = zp_res_154300;
        
        scanacc_171023 = scanacc_tmp_171992;
        scanacc_171024 = scanacc_tmp_171993;
        redout_171027 = redout_tmp_171996;
    }
    discard_171041 = scanacc_171023;
    discard_171042 = scanacc_171024;
    defunc_res_162686 = redout_171027;
    if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
        return 1;
    
    int64_t bytes_171433 = (int64_t) 4 * defunc_res_162686;
    int64_t bytes_171435 = (int64_t) 8 * defunc_res_162686;
    bool cond_154320 = nR_118936 == (int64_t) 0;
    bool x_154321 = !cond_154320;
    int64_t tmp_154322 = sub64(nR_118936, (int64_t) 1);
    bool x_154323 = sle64((int64_t) 0, tmp_154322);
    bool y_154324 = slt64(tmp_154322, nR_118936);
    bool bounds_check_154325 = x_154323 && y_154324;
    bool protect_assert_disj_154326 = cond_154320 || bounds_check_154325;
    bool index_certs_154327;
    
    if (!protect_assert_disj_154326) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154322, "] out of bounds for array of shape [", (long long) nR_118936, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:168:99-102\n   #4  ftRelational.fut:159:3-168:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154328;
    
    if (x_154321) {
        int64_t x_162649 = ((int64_t *) mem_171370)[tmp_154322];
        
        m_f_res_154328 = x_162649;
    } else {
        m_f_res_154328 = (int64_t) 0;
    }
    
    int64_t m_154330;
    
    if (cond_154320) {
        m_154330 = (int64_t) 0;
    } else {
        m_154330 = m_f_res_154328;
    }
    
    bool cond_154353 = slt64((int64_t) 0, m_154330);
    int64_t m_154340 = sub64(m_154330, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154342 = slt64(m_154340, nR_118936);
    bool zzero_leq_i_p_m_t_s_154341 = sle64((int64_t) 0, m_154340);
    bool y_154344 = zzero_leq_i_p_m_t_s_154341 && i_p_m_t_s_leq_w_154342;
    bool i_lte_j_154343 = sle64((int64_t) 0, m_154330);
    bool forwards_ok_154345 = i_lte_j_154343 && y_154344;
    bool eq_x_zz_154337 = (int64_t) 0 == m_f_res_154328;
    bool p_and_eq_x_y_154338 = x_154321 && eq_x_zz_154337;
    bool empty_slice_154339 = cond_154320 || p_and_eq_x_y_154338;
    bool ok_or_empty_154346 = empty_slice_154339 || forwards_ok_154345;
    bool index_certs_154347;
    
    if (!ok_or_empty_154346) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154330, "] out of bounds for array of shape [", (long long) nR_118936, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:168:99-102\n   #4  ftRelational.fut:159:3-168:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171457 = (int64_t) 8 * m_154330;
    
    if (mem_171458_cached_sizze_172307 < bytes_171457) {
        err = lexical_realloc(ctx, &mem_171458, &mem_171458_cached_sizze_172307, bytes_171457);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171382, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154330});
    
    int64_t max_mult_154354;
    
    if (cond_154353) {
        if (mem_171460_cached_sizze_172308 < bytes_171277) {
            err = lexical_realloc(ctx, &mem_171460, &mem_171460_cached_sizze_172308, bytes_171277);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171060 = 0; i_171060 < nR_118936; i_171060++) {
            int64_t eta_p_162655 = ((int64_t *) mem_171380)[i_171060];
            int64_t eta_p_162656 = ((int64_t *) mem_171370)[i_171060];
            bool cond_162657 = eta_p_162655 == (int64_t) 1;
            int64_t lifted_lambda_res_162658;
            
            if (cond_162657) {
                int64_t lifted_lambda_res_t_res_162659 = sub64(eta_p_162656, (int64_t) 1);
                
                lifted_lambda_res_162658 = lifted_lambda_res_t_res_162659;
            } else {
                lifted_lambda_res_162658 = (int64_t) -1;
            }
            ((int64_t *) mem_171460)[i_171060] = lifted_lambda_res_162658;
        }
        for (int64_t write_iter_171062 = 0; write_iter_171062 < nR_118936; write_iter_171062++) {
            int64_t write_iv_171064 = ((int64_t *) mem_171460)[write_iter_171062];
            int64_t write_iv_171065 = ((int64_t *) mem_171382)[write_iter_171062];
            
            if (sle64((int64_t) 0, write_iv_171064) && slt64(write_iv_171064, m_154330)) {
                ((int64_t *) mem_171458)[write_iv_171064] = write_iv_171065;
            }
        }
        
        int64_t defunc_0_reduce_res_162669;
        int64_t redout_171067 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171068 = 0; i_171068 < m_154330; i_171068++) {
            int64_t x_162670 = ((int64_t *) mem_171458)[i_171068];
            int64_t max_res_162673 = smax64(x_162670, redout_171067);
            int64_t redout_tmp_172004 = max_res_162673;
            
            redout_171067 = redout_tmp_172004;
        }
        defunc_0_reduce_res_162669 = redout_171067;
        max_mult_154354 = defunc_0_reduce_res_162669;
    } else {
        max_mult_154354 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154360 = slt64(max_mult_154354, (int64_t) 1);
    bool valid_154362 = !bounds_invalid_upwards_154360;
    bool range_valid_c_154363;
    
    if (!valid_154362) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154354, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:168:99-102\n   #3  ftRelational.fut:159:3-168:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171426_cached_sizze_172306 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171426, &mem_171426_cached_sizze_172306, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171045 = 0; i_171045 < nR_118936; i_171045++) {
        int64_t eta_p_161986 = ((int64_t *) mem_171382)[i_171045];
        int64_t zv_lhs_161988 = add64((int64_t) -1, i_171045);
        int64_t tmp_161989 = smod64(zv_lhs_161988, nR_118936);
        int64_t lifted_lambda_res_161990 = ((int64_t *) mem_171372)[tmp_161989];
        bool cond_161992 = i_171045 == (int64_t) 0;
        int64_t lifted_lambda_res_161993;
        
        if (cond_161992) {
            lifted_lambda_res_161993 = (int64_t) 0;
        } else {
            lifted_lambda_res_161993 = lifted_lambda_res_161990;
        }
        
        bool cond_161995 = slt64((int64_t) 0, eta_p_161986);
        int64_t lifted_lambda_res_161996;
        
        if (cond_161995) {
            lifted_lambda_res_161996 = lifted_lambda_res_161993;
        } else {
            lifted_lambda_res_161996 = (int64_t) -1;
        }
        ((int64_t *) mem_171426)[i_171045] = lifted_lambda_res_161996;
    }
    if (memblock_alloc(ctx, &mem_171434, bytes_171433, "mem_171434")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172006 = 0; nest_i_172006 < defunc_res_162686; nest_i_172006++) {
        ((int32_t *) mem_171434.mem)[nest_i_172006] = 0;
    }
    if (memblock_alloc(ctx, &mem_171436, bytes_171435, "mem_171436")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172007 = 0; nest_i_172007 < defunc_res_162686; nest_i_172007++) {
        ((int64_t *) mem_171436.mem)[nest_i_172007] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171438, bytes_171435, "mem_171438")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172008 = 0; nest_i_172008 < defunc_res_162686; nest_i_172008++) {
        ((int64_t *) mem_171438.mem)[nest_i_172008] = (int64_t) -1;
    }
    for (int64_t write_iter_171047 = 0; write_iter_171047 < nR_118936; write_iter_171047++) {
        int64_t write_iv_171051 = ((int64_t *) mem_171426)[write_iter_171047];
        int32_t write_iv_171052 = ((int32_t *) mem_171374)[write_iter_171047];
        int64_t write_iv_171053 = ((int64_t *) mem_171376)[write_iter_171047];
        int64_t write_iv_171054 = ((int64_t *) mem_171378)[write_iter_171047];
        
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int32_t *) mem_171434.mem)[write_iv_171051] = write_iv_171052;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171436.mem)[write_iv_171051] = write_iv_171053;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171438.mem)[write_iv_171051] = write_iv_171054;
        }
    }
    
    int64_t distance_154361 = sub64(max_mult_154354, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_171475, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171478, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171481, &mem_171438, "mem_171438") != 0)
        return 1;
    for (int64_t i_154367 = 0; i_154367 < distance_154361; i_154367++) {
        int64_t index_primexp_154371 = add64((int64_t) 1, i_154367);
        
        if (memblock_alloc(ctx, &mem_171483, bytes_171435, "mem_171483")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171483.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171485, bytes_171435, "mem_171485")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171485.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171478.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171487, bytes_171433, "mem_171487")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        for (int64_t write_iter_171069 = 0; write_iter_171069 < nR_118936; write_iter_171069++) {
            int64_t write_iv_171074 = ((int64_t *) mem_171378)[write_iter_171069];
            int32_t write_iv_171075 = ((int32_t *) mem_171374)[write_iter_171069];
            int64_t write_iv_171076 = ((int64_t *) mem_171376)[write_iter_171069];
            int64_t zg_lhs_162583 = ((int64_t *) mem_171382)[write_iter_171069];
            bool cond_162584 = slt64(index_primexp_154371, zg_lhs_162583);
            int64_t lifted_lambda_res_162585;
            
            if (cond_162584) {
                int64_t zp_lhs_162679 = ((int64_t *) mem_171426)[write_iter_171069];
                int64_t lifted_lambda_res_t_res_162680 = add64(index_primexp_154371, zp_lhs_162679);
                
                lifted_lambda_res_162585 = lifted_lambda_res_t_res_162680;
            } else {
                lifted_lambda_res_162585 = (int64_t) -1;
            }
            
            int64_t tmp_162589 = add64(index_primexp_154371, write_iv_171074);
            
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int32_t *) mem_171487.mem)[lifted_lambda_res_162585] = write_iv_171075;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171485.mem)[lifted_lambda_res_162585] = write_iv_171076;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171483.mem)[lifted_lambda_res_162585] = tmp_162589;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172012, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172013, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172014, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171475, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171478, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171481, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171514, &mem_param_171475, "mem_param_171475") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171513, &mem_param_171478, "mem_param_171478") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171512, &mem_param_171481, "mem_param_171481") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171516, bytes_171433, "mem_171516")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171516.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171514.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171518, bytes_171435, "mem_171518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171518.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171520, bytes_171435, "mem_171520")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171520.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171518, "mem_171518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171520, "mem_171520") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &mem_171516, "mem_171516") != 0)
        return 1;
    prim_out_171959 = defunc_res_162686;
    if (memblock_set(ctx, &*mem_out_p_172295, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172296, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172297, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172298 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171370);
        free(mem_171372);
        free(mem_171374);
        free(mem_171376);
        free(mem_171378);
        free(mem_171380);
        free(mem_171382);
        free(mem_171426);
        free(mem_171458);
        free(mem_171460);
        if (memblock_unref(ctx, &mem_171520, "mem_171520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171518, "mem_171518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171516, "mem_171516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171481, "mem_param_171481") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171478, "mem_param_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171475, "mem_param_171475") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171360, "mem_171360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171328, "mem_171328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171326, "mem_171326") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171315, "mem_171315") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171313, "mem_param_171313") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171301, "mem_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171299, "mem_param_171299") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171343, "ext_mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171346, "ext_mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171352, "ext_mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_172309, struct memblock *mem_out_p_172310, struct memblock *mem_out_p_172311, int64_t *out_prim_out_172312, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_121587, int64_t nS_121588, int64_t offset_R_121591, int64_t offset_S_121592, int64_t partitionSizze_121593, int64_t scatter_psizze_121594)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171370_cached_sizze_172313 = 0;
    unsigned char *mem_171370 = NULL;
    int64_t mem_171372_cached_sizze_172314 = 0;
    unsigned char *mem_171372 = NULL;
    int64_t mem_171374_cached_sizze_172315 = 0;
    unsigned char *mem_171374 = NULL;
    int64_t mem_171376_cached_sizze_172316 = 0;
    unsigned char *mem_171376 = NULL;
    int64_t mem_171378_cached_sizze_172317 = 0;
    unsigned char *mem_171378 = NULL;
    int64_t mem_171380_cached_sizze_172318 = 0;
    unsigned char *mem_171380 = NULL;
    int64_t mem_171382_cached_sizze_172319 = 0;
    unsigned char *mem_171382 = NULL;
    int64_t mem_171426_cached_sizze_172320 = 0;
    unsigned char *mem_171426 = NULL;
    int64_t mem_171458_cached_sizze_172321 = 0;
    unsigned char *mem_171458 = NULL;
    int64_t mem_171460_cached_sizze_172322 = 0;
    unsigned char *mem_171460 = NULL;
    struct memblock mem_171520;
    
    mem_171520.references = NULL;
    
    struct memblock mem_171518;
    
    mem_171518.references = NULL;
    
    struct memblock mem_171516;
    
    mem_171516.references = NULL;
    
    struct memblock mem_param_tmp_172014;
    
    mem_param_tmp_172014.references = NULL;
    
    struct memblock mem_param_tmp_172013;
    
    mem_param_tmp_172013.references = NULL;
    
    struct memblock mem_param_tmp_172012;
    
    mem_param_tmp_172012.references = NULL;
    
    struct memblock mem_171487;
    
    mem_171487.references = NULL;
    
    struct memblock mem_171485;
    
    mem_171485.references = NULL;
    
    struct memblock mem_171483;
    
    mem_171483.references = NULL;
    
    struct memblock mem_param_171481;
    
    mem_param_171481.references = NULL;
    
    struct memblock mem_param_171478;
    
    mem_param_171478.references = NULL;
    
    struct memblock mem_param_171475;
    
    mem_param_171475.references = NULL;
    
    struct memblock ext_mem_171512;
    
    ext_mem_171512.references = NULL;
    
    struct memblock ext_mem_171513;
    
    ext_mem_171513.references = NULL;
    
    struct memblock ext_mem_171514;
    
    ext_mem_171514.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock mem_171436;
    
    mem_171436.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_171362;
    
    mem_171362.references = NULL;
    
    struct memblock mem_171360;
    
    mem_171360.references = NULL;
    
    struct memblock mem_param_tmp_171972;
    
    mem_param_tmp_171972.references = NULL;
    
    struct memblock mem_param_tmp_171971;
    
    mem_param_tmp_171971.references = NULL;
    
    struct memblock mem_171328;
    
    mem_171328.references = NULL;
    
    struct memblock mem_171326;
    
    mem_171326.references = NULL;
    
    struct memblock mem_param_tmp_171986;
    
    mem_param_tmp_171986.references = NULL;
    
    struct memblock mem_171315;
    
    mem_171315.references = NULL;
    
    struct memblock mem_param_171313;
    
    mem_param_171313.references = NULL;
    
    struct memblock ext_mem_171324;
    
    ext_mem_171324.references = NULL;
    
    struct memblock mem_param_tmp_171982;
    
    mem_param_tmp_171982.references = NULL;
    
    struct memblock mem_171301;
    
    mem_171301.references = NULL;
    
    struct memblock mem_param_171299;
    
    mem_param_171299.references = NULL;
    
    struct memblock ext_mem_171310;
    
    ext_mem_171310.references = NULL;
    
    struct memblock ext_mem_171343;
    
    ext_mem_171343.references = NULL;
    
    struct memblock ext_mem_171346;
    
    ext_mem_171346.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock ext_mem_171352;
    
    ext_mem_171352.references = NULL;
    
    struct memblock mem_param_171296;
    
    mem_param_171296.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171357;
    
    ext_mem_171357.references = NULL;
    
    struct memblock ext_mem_171358;
    
    ext_mem_171358.references = NULL;
    
    struct memblock mem_171290;
    
    mem_171290.references = NULL;
    
    struct memblock mem_171288;
    
    mem_171288.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock ext_mem_171367;
    
    ext_mem_171367.references = NULL;
    
    struct memblock ext_mem_171368;
    
    ext_mem_171368.references = NULL;
    
    struct memblock mem_171280;
    
    mem_171280.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock ext_mem_171276;
    
    ext_mem_171276.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t partitionSizze_153966 = sdiv64(partitionSizze_121593, (int64_t) 8);
    int64_t zm_lhs_153967 = add64(nR_121587, partitionSizze_153966);
    int64_t zs_lhs_153968 = sub64(zm_lhs_153967, (int64_t) 1);
    bool zzero_153969 = partitionSizze_153966 == (int64_t) 0;
    bool nonzzero_153970 = !zzero_153969;
    bool nonzzero_cert_153971;
    
    if (!nonzzero_153970) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_153972 = sdiv64(zs_lhs_153968, partitionSizze_153966);
    int64_t zm_lhs_153973 = add64(nS_121588, partitionSizze_153966);
    int64_t zs_lhs_153974 = sub64(zm_lhs_153973, (int64_t) 1);
    int64_t numIter_S_153975 = sdiv64(zs_lhs_153974, partitionSizze_153966);
    
    if (futrts_indicesWithIncrement_16299(ctx, &ext_mem_171276, tR_mem_171274, nR_121587, offset_R_121591) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171277 = (int64_t) 8 * nR_121587;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171960 = 0; nest_i_171960 < nR_121587; nest_i_171960++) {
        ((int64_t *) mem_171278.mem)[nest_i_171960] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171280, bytes_171277, "mem_171280")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171961 = 0; nest_i_171961 < nR_121587; nest_i_171961++) {
        ((int64_t *) mem_171280.mem)[nest_i_171961] = (int64_t) 0;
    }
    
    bool loop_cond_153979 = slt64((int64_t) 0, numIter_R_153972);
    bool defunc_0_mergeJoin_res_153980;
    int64_t defunc_0_mergeJoin_res_153981;
    int64_t defunc_0_mergeJoin_res_153984;
    bool loop_while_153985;
    int64_t iter_153986;
    int64_t first_relevant_in_S_153989;
    
    if (memblock_set(ctx, &mem_param_171283, &mem_171280, "mem_171280") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &mem_171278, "mem_171278") != 0)
        return 1;
    loop_while_153985 = loop_cond_153979;
    iter_153986 = (int64_t) 0;
    first_relevant_in_S_153989 = (int64_t) 0;
    while (loop_while_153985) {
        int64_t tR_start_153990 = mul64(partitionSizze_153966, iter_153986);
        int64_t min_arg1_153991 = add64(partitionSizze_153966, tR_start_153990);
        int64_t min_res_153992 = smin64(nR_121587, min_arg1_153991);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 = sub64(min_res_153992, tR_start_153990);
        bool empty_slice_153994 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 == (int64_t) 0;
        int64_t m_153995 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, (int64_t) 1);
        int64_t i_p_m_t_s_153996 = add64(tR_start_153990, m_153995);
        bool zzero_leq_i_p_m_t_s_153997 = sle64((int64_t) 0, i_p_m_t_s_153996);
        bool i_p_m_t_s_leq_w_153998 = slt64(i_p_m_t_s_153996, nR_121587);
        bool zzero_lte_i_153999 = sle64((int64_t) 0, tR_start_153990);
        bool i_lte_j_154000 = sle64(tR_start_153990, min_res_153992);
        bool y_154001 = i_p_m_t_s_leq_w_153998 && zzero_lte_i_153999;
        bool y_154002 = zzero_leq_i_p_m_t_s_153997 && y_154001;
        bool forwards_ok_154003 = i_lte_j_154000 && y_154002;
        bool ok_or_empty_154004 = empty_slice_153994 || forwards_ok_154003;
        bool index_certs_154005;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_121587, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171287 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993;
        bool cond_154009 = slt64(first_relevant_in_S_153989, numIter_S_153975);
        bool y_154010 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool loop_not_taken_154011 = !cond_154009;
        bool protect_assert_disj_154012 = y_154010 || loop_not_taken_154011;
        bool index_certs_154013;
        
        if (!protect_assert_disj_154012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154016 = sle64((int64_t) 0, m_153995);
        bool y_154017 = slt64(m_153995, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool bounds_check_154018 = x_154016 && y_154017;
        bool protect_assert_disj_154019 = loop_not_taken_154011 || bounds_check_154018;
        bool index_certs_154020;
        
        if (!protect_assert_disj_154019) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154251;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_121587, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:179:99-102\n   #4  ftRelational.fut:170:3-179:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171288, bytes_171287, "mem_171288")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171969 = 0; nest_i_171969 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171969++) {
            ((int64_t *) mem_171288.mem)[nest_i_171969] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171290, bytes_171287, "mem_171290")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171970 = 0; nest_i_171970 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171970++) {
            ((int64_t *) mem_171290.mem)[nest_i_171970] = (int64_t) 0;
        }
        
        int64_t gt_lhs_154014;
        
        if (cond_154009) {
            int64_t x_162598 = ((int64_t *) tR_mem_171274.mem)[tR_start_153990];
            
            gt_lhs_154014 = x_162598;
        } else {
            gt_lhs_154014 = (int64_t) 0;
        }
        
        int64_t lt_lhs_154021;
        
        if (cond_154009) {
            int64_t x_162599 = ((int64_t *) tR_mem_171274.mem)[i_p_m_t_s_153996];
            
            lt_lhs_154021 = x_162599;
        } else {
            lt_lhs_154021 = (int64_t) 0;
        }
        
        int64_t ext_171356;
        int64_t ext_171355;
        int64_t ext_171354;
        int64_t ext_171353;
        bool loopres_154023;
        int64_t loopres_154024;
        int64_t loopres_154027;
        bool loop_while_154028;
        int64_t s_iter_154029;
        int64_t minRelevant_154032;
        int64_t ctx_param_ext_171291;
        int64_t ctx_param_ext_171292;
        int64_t ctx_param_ext_171294;
        int64_t ctx_param_ext_171295;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171296, &mem_171288, "mem_171288") != 0)
            return 1;
        ctx_param_ext_171291 = (int64_t) 0;
        ctx_param_ext_171292 = (int64_t) 1;
        ctx_param_ext_171294 = (int64_t) 0;
        ctx_param_ext_171295 = (int64_t) 1;
        loop_while_154028 = cond_154009;
        s_iter_154029 = first_relevant_in_S_153989;
        minRelevant_154032 = first_relevant_in_S_153989;
        while (loop_while_154028) {
            int64_t tS_start_154033 = mul64(partitionSizze_153966, s_iter_154029);
            int64_t min_arg1_154034 = add64(partitionSizze_153966, tS_start_154033);
            int64_t min_res_154035 = smin64(nS_121588, min_arg1_154034);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 = sub64(min_res_154035, tS_start_154033);
            bool empty_slice_154037 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 == (int64_t) 0;
            int64_t m_154038 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, (int64_t) 1);
            int64_t i_p_m_t_s_154039 = add64(tS_start_154033, m_154038);
            bool zzero_leq_i_p_m_t_s_154040 = sle64((int64_t) 0, i_p_m_t_s_154039);
            bool i_p_m_t_s_leq_w_154041 = slt64(i_p_m_t_s_154039, nS_121588);
            bool zzero_lte_i_154042 = sle64((int64_t) 0, tS_start_154033);
            bool i_lte_j_154043 = sle64(tS_start_154033, min_res_154035);
            bool y_154044 = i_p_m_t_s_leq_w_154041 && zzero_lte_i_154042;
            bool y_154045 = zzero_leq_i_p_m_t_s_154040 && y_154044;
            bool forwards_ok_154046 = i_lte_j_154043 && y_154045;
            bool ok_or_empty_154047 = empty_slice_154037 || forwards_ok_154046;
            bool index_certs_154048;
            
            if (!ok_or_empty_154047) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154033, ":", (long long) min_res_154035, "] out of bounds for array of shape [", (long long) nS_121588, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154049 = sle64((int64_t) 0, m_154038);
            bool y_154050 = slt64(m_154038, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool bounds_check_154051 = x_154049 && y_154050;
            bool index_certs_154052;
            
            if (!bounds_check_154051) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154055 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool index_certs_154056;
            
            if (!y_154055) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t gt_rhs_154053 = ((int64_t *) tS_mem_171275.mem)[i_p_m_t_s_154039];
            bool defunc_0_gt_res_154054 = slt64(gt_rhs_154053, gt_lhs_154014);
            int64_t lt_rhs_154057 = ((int64_t *) tS_mem_171275.mem)[tS_start_154033];
            bool defunc_0_lt_res_154058 = slt64(lt_lhs_154021, lt_rhs_154057);
            bool thisStillRel_154059 = !defunc_0_lt_res_154058;
            int64_t ext_171345;
            
            if (defunc_0_lt_res_154058) {
                ext_171345 = ctx_param_ext_171291;
            } else {
                ext_171345 = (int64_t) 0;
            }
            
            int64_t ext_171344;
            
            if (defunc_0_lt_res_154058) {
                ext_171344 = ctx_param_ext_171292;
            } else {
                ext_171344 = (int64_t) 1;
            }
            
            int64_t ext_171342;
            
            if (defunc_0_lt_res_154058) {
                ext_171342 = ctx_param_ext_171294;
            } else {
                ext_171342 = (int64_t) 0;
            }
            
            int64_t ext_171341;
            
            if (defunc_0_lt_res_154058) {
                ext_171341 = ctx_param_ext_171295;
            } else {
                ext_171341 = (int64_t) 1;
            }
            
            int64_t ext_171351;
            
            if (defunc_0_gt_res_154054) {
                ext_171351 = ctx_param_ext_171291;
            } else {
                ext_171351 = ext_171345;
            }
            
            int64_t ext_171350;
            
            if (defunc_0_gt_res_154054) {
                ext_171350 = ctx_param_ext_171292;
            } else {
                ext_171350 = ext_171344;
            }
            
            int64_t ext_171348;
            
            if (defunc_0_gt_res_154054) {
                ext_171348 = ctx_param_ext_171294;
            } else {
                ext_171348 = ext_171342;
            }
            
            int64_t ext_171347;
            
            if (defunc_0_gt_res_154054) {
                ext_171347 = ctx_param_ext_171295;
            } else {
                ext_171347 = ext_171341;
            }
            
            int64_t loopres_154060;
            bool loopres_154063;
            int64_t loopres_154064;
            
            if (defunc_0_gt_res_154054) {
                int64_t tmp_162600 = add64((int64_t) 1, s_iter_154029);
                
                if (memblock_set(ctx, &ext_mem_171352, &mem_param_171293, "mem_param_171293") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &mem_param_171296, "mem_param_171296") != 0)
                    return 1;
                loopres_154060 = tmp_162600;
                loopres_154063 = 1;
                loopres_154064 = tmp_162600;
            } else {
                int64_t loopres_f_res_154066;
                bool loopres_f_res_154069;
                
                if (defunc_0_lt_res_154058) {
                    if (memblock_set(ctx, &ext_mem_171346, &mem_param_171293, "mem_param_171293") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_param_171296, "mem_param_171296") != 0)
                        return 1;
                    loopres_f_res_154066 = s_iter_154029;
                    loopres_f_res_154069 = thisStillRel_154059;
                } else {
                    bool index_certs_154070;
                    
                    if (!bounds_check_154018) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lt_lhs_154071 = ((int64_t *) tR_mem_171274.mem)[i_p_m_t_s_153996];
                    bool defunc_0_lt_res_154072 = slt64(lt_lhs_154071, gt_rhs_154053);
                    bool nextRel_154073 = !defunc_0_lt_res_154072;
                    int64_t find_joinTuples_arg3_154074 = add64(offset_S_121592, tS_start_154033);
                    double i64_res_154075 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                    double log2_res_154076 = futrts_log2_64(i64_res_154075);
                    double ceil_res_154077 = futrts_ceil64(log2_res_154076);
                    int64_t f64_res_154078 = fptosi_f64_i64(ceil_res_154077);
                    int64_t num_iter_154079 = add64((int64_t) 1, f64_res_154078);
                    int64_t bsearch_first_154081;
                    int64_t last_step_154084;
                    
                    if (memblock_set(ctx, &mem_param_171299, &mem_171290, "mem_171290") != 0)
                        return 1;
                    last_step_154084 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154082 = 0; i_154082 < num_iter_154079; i_154082++) {
                        int64_t zs_lhs_154085 = add64((int64_t) 1, last_step_154084);
                        int64_t this_step_154086 = sdiv64(zs_lhs_154085, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171301, bytes_171287, "mem_171301")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171003++) {
                            int64_t eta_p_162154 = ((int64_t *) mem_param_171299.mem)[i_171003];
                            int64_t slice_171252 = tR_start_153990 + i_171003;
                            int64_t eta_p_162155 = ((int64_t *) tR_mem_171274.mem)[slice_171252];
                            bool cond_162157 = sle64(eta_p_162154, (int64_t) 0);
                            int64_t prev_elem_162158;
                            
                            if (cond_162157) {
                                bool index_certs_162602;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162158 = lt_rhs_154057;
                            } else {
                                int64_t tmp_162162 = sub64(eta_p_162154, (int64_t) 1);
                                bool x_162163 = sle64((int64_t) 0, tmp_162162);
                                bool y_162164 = slt64(tmp_162162, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162165 = x_162163 && y_162164;
                                bool index_certs_162166;
                                
                                if (!bounds_check_162165) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162167 = tS_start_154033 + tmp_162162;
                                int64_t prev_elem_f_res_162168 = ((int64_t *) tS_mem_171275.mem)[slice_162167];
                                
                                prev_elem_162158 = prev_elem_f_res_162168;
                            }
                            
                            bool cond_162169 = slt64(eta_p_162154, (int64_t) 0);
                            int64_t cur_elem_162170;
                            
                            if (cond_162169) {
                                bool index_certs_162605;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162170 = lt_rhs_154057;
                            } else {
                                bool x_162174 = sle64((int64_t) 0, eta_p_162154);
                                bool y_162175 = slt64(eta_p_162154, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162176 = x_162174 && y_162175;
                                bool index_certs_162177;
                                
                                if (!bounds_check_162176) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162154, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162178 = tS_start_154033 + eta_p_162154;
                                int64_t cur_elem_f_res_162179 = ((int64_t *) tS_mem_171275.mem)[slice_162178];
                                
                                cur_elem_162170 = cur_elem_f_res_162179;
                            }
                            
                            bool cond_162180 = sle64(m_154038, eta_p_162154);
                            int64_t next_elem_162181;
                            
                            if (cond_162180) {
                                bool index_certs_162611;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162181 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162189 = add64((int64_t) 1, eta_p_162154);
                                bool x_162190 = sle64((int64_t) 0, tmp_162189);
                                bool y_162191 = slt64(tmp_162189, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162192 = x_162190 && y_162191;
                                bool index_certs_162193;
                                
                                if (!bounds_check_162192) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162189, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162194 = tS_start_154033 + tmp_162189;
                                int64_t next_elem_f_res_162195 = ((int64_t *) tS_mem_171275.mem)[slice_162194];
                                
                                next_elem_162181 = next_elem_f_res_162195;
                            }
                            
                            int64_t defunc_0_f_res_162200;
                            
                            if (cond_162169) {
                                defunc_0_f_res_162200 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162201 = eta_p_162155 == cur_elem_162170;
                                bool cond_162202 = eta_p_162154 == (int64_t) 0;
                                bool defunc_0_gt_res_162203 = slt64(prev_elem_162158, eta_p_162155);
                                bool x_162204 = !cond_162202;
                                bool y_162205 = defunc_0_gt_res_162203 && x_162204;
                                bool cond_t_res_162206 = cond_162202 || y_162205;
                                bool x_162207 = defunc_0_eq_res_162201 && cond_t_res_162206;
                                int64_t defunc_0_f_res_f_res_162208;
                                
                                if (x_162207) {
                                    defunc_0_f_res_f_res_162208 = eta_p_162154;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162209;
                                    
                                    if (defunc_0_eq_res_162201) {
                                        int64_t max_arg1_162614 = sub64(eta_p_162154, this_step_154086);
                                        int64_t max_res_162615 = smax64((int64_t) 0, max_arg1_162614);
                                        
                                        defunc_0_f_res_f_res_f_res_162209 = max_res_162615;
                                    } else {
                                        bool defunc_0_gt_res_162212 = slt64(cur_elem_162170, eta_p_162155);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162213;
                                        
                                        if (defunc_0_gt_res_162212) {
                                            bool cond_162617 = eta_p_162154 == m_154038;
                                            bool defunc_0_lt_res_162618 = slt64(eta_p_162155, next_elem_162181);
                                            bool x_162619 = !cond_162617;
                                            bool y_162620 = defunc_0_lt_res_162618 && x_162619;
                                            bool cond_162621 = cond_162617 || y_162620;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                            
                                            if (cond_162621) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_162623 = add64(this_step_154086, eta_p_162154);
                                                int64_t min_res_162624 = smin64(m_154038, min_arg1_162623);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = min_res_162624;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                            
                                            if (cond_t_res_162206) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162224 = sub64(eta_p_162154, this_step_154086);
                                                int64_t max_res_162225 = smax64((int64_t) 0, max_arg1_162224);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = max_res_162225;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                        }
                                        defunc_0_f_res_f_res_f_res_162209 = defunc_0_f_res_f_res_f_res_f_res_162213;
                                    }
                                    defunc_0_f_res_f_res_162208 = defunc_0_f_res_f_res_f_res_162209;
                                }
                                defunc_0_f_res_162200 = defunc_0_f_res_f_res_162208;
                            }
                            ((int64_t *) mem_171301.mem)[i_171003] = defunc_0_f_res_162200;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171982, &mem_171301, "mem_171301") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171984 = this_step_154086;
                        
                        if (memblock_set(ctx, &mem_param_171299, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
                            return 1;
                        last_step_154084 = last_step_tmp_171984;
                    }
                    if (memblock_set(ctx, &ext_mem_171310, &mem_param_171299, "mem_param_171299") != 0)
                        return 1;
                    bsearch_first_154081 = last_step_154084;
                    
                    int64_t bsearch_last_154164;
                    int64_t last_step_154167;
                    
                    if (memblock_set(ctx, &mem_param_171313, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    last_step_154167 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154165 = 0; i_154165 < num_iter_154079; i_154165++) {
                        int64_t zs_lhs_154168 = add64((int64_t) 1, last_step_154167);
                        int64_t max_arg1_154169 = sdiv64(zs_lhs_154168, (int64_t) 2);
                        int64_t max_res_154170 = smax64((int64_t) 1, max_arg1_154169);
                        
                        if (memblock_alloc(ctx, &mem_171315, bytes_171287, "mem_171315")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171007 = 0; i_171007 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171007++) {
                            int64_t eta_p_162277 = ((int64_t *) mem_param_171313.mem)[i_171007];
                            int64_t slice_171251 = tR_start_153990 + i_171007;
                            int64_t eta_p_162278 = ((int64_t *) tR_mem_171274.mem)[slice_171251];
                            bool cond_162280 = slt64(eta_p_162277, (int64_t) 0);
                            int64_t cur_elem_162281;
                            
                            if (cond_162280) {
                                bool index_certs_162627;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162281 = lt_rhs_154057;
                            } else {
                                bool x_162285 = sle64((int64_t) 0, eta_p_162277);
                                bool y_162286 = slt64(eta_p_162277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162287 = x_162285 && y_162286;
                                bool index_certs_162288;
                                
                                if (!bounds_check_162287) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162289 = tS_start_154033 + eta_p_162277;
                                int64_t cur_elem_f_res_162290 = ((int64_t *) tS_mem_171275.mem)[slice_162289];
                                
                                cur_elem_162281 = cur_elem_f_res_162290;
                            }
                            
                            bool cond_162291 = sle64(m_154038, eta_p_162277);
                            int64_t next_elem_162292;
                            
                            if (cond_162291) {
                                bool index_certs_162633;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162292 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162300 = add64((int64_t) 1, eta_p_162277);
                                bool x_162301 = sle64((int64_t) 0, tmp_162300);
                                bool y_162302 = slt64(tmp_162300, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162303 = x_162301 && y_162302;
                                bool index_certs_162304;
                                
                                if (!bounds_check_162303) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162300, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162305 = tS_start_154033 + tmp_162300;
                                int64_t next_elem_f_res_162306 = ((int64_t *) tS_mem_171275.mem)[slice_162305];
                                
                                next_elem_162292 = next_elem_f_res_162306;
                            }
                            
                            int64_t defunc_0_f_res_162310;
                            
                            if (cond_162280) {
                                defunc_0_f_res_162310 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162311 = eta_p_162278 == cur_elem_162281;
                                bool cond_162313 = eta_p_162277 == m_154038;
                                bool defunc_0_gt_res_162314 = slt64(eta_p_162278, next_elem_162292);
                                bool x_162315 = !cond_162313;
                                bool y_162316 = defunc_0_gt_res_162314 && x_162315;
                                bool cond_t_res_162317 = cond_162313 || y_162316;
                                bool x_162318 = defunc_0_eq_res_162311 && cond_t_res_162317;
                                int64_t defunc_0_f_res_f_res_162319;
                                
                                if (x_162318) {
                                    defunc_0_f_res_f_res_162319 = eta_p_162277;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162320;
                                    
                                    if (defunc_0_eq_res_162311) {
                                        int64_t min_arg1_162636 = add64(max_res_154170, eta_p_162277);
                                        int64_t min_res_162637 = smin64(m_154038, min_arg1_162636);
                                        
                                        defunc_0_f_res_f_res_f_res_162320 = min_res_162637;
                                    } else {
                                        bool defunc_0_gt_res_162323 = slt64(cur_elem_162281, eta_p_162278);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162324;
                                        
                                        if (defunc_0_gt_res_162323) {
                                            int64_t min_arg1_162638 = add64(max_res_154170, eta_p_162277);
                                            int64_t min_res_162639 = smin64(m_154038, min_arg1_162638);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = min_res_162639;
                                        } else {
                                            int64_t max_arg1_162327 = sub64(eta_p_162277, max_res_154170);
                                            int64_t max_res_162328 = smax64((int64_t) 0, max_arg1_162327);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = max_res_162328;
                                        }
                                        defunc_0_f_res_f_res_f_res_162320 = defunc_0_f_res_f_res_f_res_f_res_162324;
                                    }
                                    defunc_0_f_res_f_res_162319 = defunc_0_f_res_f_res_f_res_162320;
                                }
                                defunc_0_f_res_162310 = defunc_0_f_res_f_res_162319;
                            }
                            ((int64_t *) mem_171315.mem)[i_171007] = defunc_0_f_res_162310;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171986, &mem_171315, "mem_171315") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171988 = max_res_154170;
                        
                        if (memblock_set(ctx, &mem_param_171313, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
                            return 1;
                        last_step_154167 = last_step_tmp_171988;
                    }
                    if (memblock_set(ctx, &ext_mem_171324, &mem_param_171313, "mem_param_171313") != 0)
                        return 1;
                    bsearch_last_154164 = last_step_154167;
                    if (memblock_alloc(ctx, &mem_171326, bytes_171287, "mem_171326")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171328, bytes_171287, "mem_171328")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171013 = 0; i_171013 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171013++) {
                        int64_t eta_p_162133 = ((int64_t *) ext_mem_171310.mem)[i_171013];
                        int64_t eta_p_162134 = ((int64_t *) mem_param_171296.mem)[ctx_param_ext_171294 + i_171013 * ctx_param_ext_171295];
                        int64_t eta_p_162135 = ((int64_t *) ext_mem_171324.mem)[i_171013];
                        int64_t eta_p_162136 = ((int64_t *) mem_param_171293.mem)[ctx_param_ext_171291 + i_171013 * ctx_param_ext_171292];
                        bool cond_162138 = slt64(eta_p_162133, (int64_t) 0);
                        int64_t lifted_lambda_res_162139;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162139 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162140 = sub64(eta_p_162135, eta_p_162133);
                            int64_t lifted_lambda_res_f_res_162141 = add64((int64_t) 1, zp_lhs_162140);
                            
                            lifted_lambda_res_162139 = lifted_lambda_res_f_res_162141;
                        }
                        
                        int64_t defunc_0_f_res_162143 = add64(eta_p_162136, lifted_lambda_res_162139);
                        int64_t lifted_lambda_res_162146;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162146 = eta_p_162133;
                        } else {
                            int64_t lifted_lambda_res_f_res_162147 = add64(find_joinTuples_arg3_154074, eta_p_162133);
                            
                            lifted_lambda_res_162146 = lifted_lambda_res_f_res_162147;
                        }
                        
                        bool cond_162149 = slt64(eta_p_162134, (int64_t) 0);
                        int64_t lifted_lambda_res_162150;
                        
                        if (cond_162149) {
                            lifted_lambda_res_162150 = lifted_lambda_res_162146;
                        } else {
                            lifted_lambda_res_162150 = eta_p_162134;
                        }
                        ((int64_t *) mem_171326.mem)[i_171013] = lifted_lambda_res_162150;
                        ((int64_t *) mem_171328.mem)[i_171013] = defunc_0_f_res_162143;
                    }
                    if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
                        return 1;
                    
                    int64_t tmp_154247 = add64((int64_t) 1, s_iter_154029);
                    
                    if (memblock_set(ctx, &ext_mem_171346, &mem_171328, "mem_171328") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_171326, "mem_171326") != 0)
                        return 1;
                    loopres_f_res_154066 = tmp_154247;
                    loopres_f_res_154069 = nextRel_154073;
                }
                if (memblock_set(ctx, &ext_mem_171352, &ext_mem_171346, "ext_mem_171346") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &ext_mem_171343, "ext_mem_171343") != 0)
                    return 1;
                loopres_154060 = loopres_f_res_154066;
                loopres_154063 = loopres_f_res_154069;
                loopres_154064 = minRelevant_154032;
            }
            
            bool cond_154248 = slt64(loopres_154060, numIter_S_153975);
            bool x_154249 = loopres_154063 && cond_154248;
            
            if (memblock_set(ctx, &mem_param_tmp_171971, &ext_mem_171352, "ext_mem_171352") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171972, &ext_mem_171349, "ext_mem_171349") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_171973 = ext_171351;
            int64_t ctx_param_ext_tmp_171974 = ext_171350;
            int64_t ctx_param_ext_tmp_171975 = ext_171348;
            int64_t ctx_param_ext_tmp_171976 = ext_171347;
            bool loop_while_tmp_171977 = x_154249;
            int64_t s_iter_tmp_171978 = loopres_154060;
            int64_t minRelevant_tmp_171981 = loopres_154064;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171296, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
                return 1;
            ctx_param_ext_171291 = ctx_param_ext_tmp_171973;
            ctx_param_ext_171292 = ctx_param_ext_tmp_171974;
            ctx_param_ext_171294 = ctx_param_ext_tmp_171975;
            ctx_param_ext_171295 = ctx_param_ext_tmp_171976;
            loop_while_154028 = loop_while_tmp_171977;
            s_iter_154029 = s_iter_tmp_171978;
            minRelevant_154032 = minRelevant_tmp_171981;
        }
        if (memblock_set(ctx, &ext_mem_171358, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171357, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        ext_171356 = ctx_param_ext_171291;
        ext_171355 = ctx_param_ext_171292;
        ext_171354 = ctx_param_ext_171294;
        ext_171353 = ctx_param_ext_171295;
        loopres_154023 = loop_while_154028;
        loopres_154024 = s_iter_154029;
        loopres_154027 = minRelevant_154032;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171360, bytes_171277, "mem_171360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_121587});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171357.mem, ext_171354, (int64_t []) {ext_171353}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171362, bytes_171277, "mem_171362")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_121587});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171358.mem, ext_171356, (int64_t []) {ext_171355}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        
        int64_t tmp_154255 = add64((int64_t) 1, iter_153986);
        bool loop_cond_154256 = slt64(tmp_154255, numIter_R_153972);
        
        if (memblock_set(ctx, &mem_param_tmp_171962, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171360, "mem_171360") != 0)
            return 1;
        
        bool loop_while_tmp_171964 = loop_cond_154256;
        int64_t iter_tmp_171965 = tmp_154255;
        int64_t first_relevant_in_S_tmp_171968 = loopres_154027;
        
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        loop_while_153985 = loop_while_tmp_171964;
        iter_153986 = iter_tmp_171965;
        first_relevant_in_S_153989 = first_relevant_in_S_tmp_171968;
    }
    if (memblock_set(ctx, &ext_mem_171368, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171367, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    defunc_0_mergeJoin_res_153980 = loop_while_153985;
    defunc_0_mergeJoin_res_153981 = iter_153986;
    defunc_0_mergeJoin_res_153984 = first_relevant_in_S_153989;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
        return 1;
    if (mem_171370_cached_sizze_172313 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171370, &mem_171370_cached_sizze_172313, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171372_cached_sizze_172314 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171372, &mem_171372_cached_sizze_172314, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171374_cached_sizze_172315 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171374, &mem_171374_cached_sizze_172315, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171376_cached_sizze_172316 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171376, &mem_171376_cached_sizze_172316, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171378_cached_sizze_172317 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171378, &mem_171378_cached_sizze_172317, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171380_cached_sizze_172318 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171380, &mem_171380_cached_sizze_172318, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171382_cached_sizze_172319 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171382, &mem_171382_cached_sizze_172319, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171041;
    int64_t discard_171042;
    int64_t defunc_res_162686;
    int64_t scanacc_171023;
    int64_t scanacc_171024;
    int64_t redout_171027;
    
    scanacc_171023 = (int64_t) 0;
    scanacc_171024 = (int64_t) 0;
    redout_171027 = (int64_t) 0;
    for (int64_t i_171033 = 0; i_171033 < nR_121587; i_171033++) {
        int64_t zg_lhs_162079 = ((int64_t *) ext_mem_171368.mem)[i_171033];
        bool cond_162080 = slt64((int64_t) 0, zg_lhs_162079);
        int64_t lifted_lambda_res_162081;
        
        if (cond_162080) {
            lifted_lambda_res_162081 = i_171033;
        } else {
            lifted_lambda_res_162081 = (int64_t) -1;
        }
        
        bool cond_162083 = sle64((int64_t) 0, lifted_lambda_res_162081);
        bool cond_t_res_162084 = slt64(lifted_lambda_res_162081, nR_121587);
        bool x_162085 = cond_162083 && cond_t_res_162084;
        int64_t lifted_lambda_res_162086;
        
        if (x_162085) {
            bool index_certs_162643;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_121587, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:179:99-102\n   #4  ftRelational.fut:170:3-179:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_162644 = ((int64_t *) ext_mem_171368.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162086 = lifted_lambda_res_t_res_162644;
        } else {
            lifted_lambda_res_162086 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162090 = slt64((int64_t) 1, lifted_lambda_res_162086);
        int64_t defunc_0_f_res_162091 = btoi_bool_i64(lifted_lambda_res_162090);
        int64_t lifted_lambda_res_162103;
        int64_t lifted_lambda_res_162104;
        int64_t lifted_lambda_res_162105;
        
        if (x_162085) {
            bool index_certs_162645;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_121587, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:179:99-102\n   #5  ftRelational.fut:170:3-179:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_162646 = ((int64_t *) tR_mem_171274.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162647 = ((int64_t *) ext_mem_171276.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162648 = ((int64_t *) ext_mem_171367.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162103 = lifted_lambda_res_t_res_162646;
            lifted_lambda_res_162104 = lifted_lambda_res_t_res_162647;
            lifted_lambda_res_162105 = lifted_lambda_res_t_res_162648;
        } else {
            lifted_lambda_res_162103 = (int64_t) 0;
            lifted_lambda_res_162104 = (int64_t) -1;
            lifted_lambda_res_162105 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154319 = add64(defunc_0_f_res_162091, scanacc_171023);
        int64_t lifted_lambda_res_154280 = add64(lifted_lambda_res_162086, scanacc_171024);
        int64_t zp_res_154300 = add64(lifted_lambda_res_162086, redout_171027);
        
        ((int64_t *) mem_171370)[i_171033] = defunc_0_op_res_154319;
        ((int64_t *) mem_171372)[i_171033] = lifted_lambda_res_154280;
        ((int64_t *) mem_171374)[i_171033] = lifted_lambda_res_162103;
        ((int64_t *) mem_171376)[i_171033] = lifted_lambda_res_162104;
        ((int64_t *) mem_171378)[i_171033] = lifted_lambda_res_162105;
        ((int64_t *) mem_171380)[i_171033] = defunc_0_f_res_162091;
        ((int64_t *) mem_171382)[i_171033] = lifted_lambda_res_162086;
        
        int64_t scanacc_tmp_171992 = defunc_0_op_res_154319;
        int64_t scanacc_tmp_171993 = lifted_lambda_res_154280;
        int64_t redout_tmp_171996 = zp_res_154300;
        
        scanacc_171023 = scanacc_tmp_171992;
        scanacc_171024 = scanacc_tmp_171993;
        redout_171027 = redout_tmp_171996;
    }
    discard_171041 = scanacc_171023;
    discard_171042 = scanacc_171024;
    defunc_res_162686 = redout_171027;
    if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
        return 1;
    
    int64_t bytes_171433 = (int64_t) 8 * defunc_res_162686;
    bool cond_154320 = nR_121587 == (int64_t) 0;
    bool x_154321 = !cond_154320;
    int64_t tmp_154322 = sub64(nR_121587, (int64_t) 1);
    bool x_154323 = sle64((int64_t) 0, tmp_154322);
    bool y_154324 = slt64(tmp_154322, nR_121587);
    bool bounds_check_154325 = x_154323 && y_154324;
    bool protect_assert_disj_154326 = cond_154320 || bounds_check_154325;
    bool index_certs_154327;
    
    if (!protect_assert_disj_154326) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154322, "] out of bounds for array of shape [", (long long) nR_121587, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:179:99-102\n   #4  ftRelational.fut:170:3-179:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154328;
    
    if (x_154321) {
        int64_t x_162649 = ((int64_t *) mem_171370)[tmp_154322];
        
        m_f_res_154328 = x_162649;
    } else {
        m_f_res_154328 = (int64_t) 0;
    }
    
    int64_t m_154330;
    
    if (cond_154320) {
        m_154330 = (int64_t) 0;
    } else {
        m_154330 = m_f_res_154328;
    }
    
    bool cond_154353 = slt64((int64_t) 0, m_154330);
    int64_t m_154340 = sub64(m_154330, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154342 = slt64(m_154340, nR_121587);
    bool zzero_leq_i_p_m_t_s_154341 = sle64((int64_t) 0, m_154340);
    bool y_154344 = zzero_leq_i_p_m_t_s_154341 && i_p_m_t_s_leq_w_154342;
    bool i_lte_j_154343 = sle64((int64_t) 0, m_154330);
    bool forwards_ok_154345 = i_lte_j_154343 && y_154344;
    bool eq_x_zz_154337 = (int64_t) 0 == m_f_res_154328;
    bool p_and_eq_x_y_154338 = x_154321 && eq_x_zz_154337;
    bool empty_slice_154339 = cond_154320 || p_and_eq_x_y_154338;
    bool ok_or_empty_154346 = empty_slice_154339 || forwards_ok_154345;
    bool index_certs_154347;
    
    if (!ok_or_empty_154346) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154330, "] out of bounds for array of shape [", (long long) nR_121587, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:179:99-102\n   #4  ftRelational.fut:170:3-179:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171457 = (int64_t) 8 * m_154330;
    
    if (mem_171458_cached_sizze_172321 < bytes_171457) {
        err = lexical_realloc(ctx, &mem_171458, &mem_171458_cached_sizze_172321, bytes_171457);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171382, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154330});
    
    int64_t max_mult_154354;
    
    if (cond_154353) {
        if (mem_171460_cached_sizze_172322 < bytes_171277) {
            err = lexical_realloc(ctx, &mem_171460, &mem_171460_cached_sizze_172322, bytes_171277);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171060 = 0; i_171060 < nR_121587; i_171060++) {
            int64_t eta_p_162655 = ((int64_t *) mem_171380)[i_171060];
            int64_t eta_p_162656 = ((int64_t *) mem_171370)[i_171060];
            bool cond_162657 = eta_p_162655 == (int64_t) 1;
            int64_t lifted_lambda_res_162658;
            
            if (cond_162657) {
                int64_t lifted_lambda_res_t_res_162659 = sub64(eta_p_162656, (int64_t) 1);
                
                lifted_lambda_res_162658 = lifted_lambda_res_t_res_162659;
            } else {
                lifted_lambda_res_162658 = (int64_t) -1;
            }
            ((int64_t *) mem_171460)[i_171060] = lifted_lambda_res_162658;
        }
        for (int64_t write_iter_171062 = 0; write_iter_171062 < nR_121587; write_iter_171062++) {
            int64_t write_iv_171064 = ((int64_t *) mem_171460)[write_iter_171062];
            int64_t write_iv_171065 = ((int64_t *) mem_171382)[write_iter_171062];
            
            if (sle64((int64_t) 0, write_iv_171064) && slt64(write_iv_171064, m_154330)) {
                ((int64_t *) mem_171458)[write_iv_171064] = write_iv_171065;
            }
        }
        
        int64_t defunc_0_reduce_res_162669;
        int64_t redout_171067 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171068 = 0; i_171068 < m_154330; i_171068++) {
            int64_t x_162670 = ((int64_t *) mem_171458)[i_171068];
            int64_t max_res_162673 = smax64(x_162670, redout_171067);
            int64_t redout_tmp_172004 = max_res_162673;
            
            redout_171067 = redout_tmp_172004;
        }
        defunc_0_reduce_res_162669 = redout_171067;
        max_mult_154354 = defunc_0_reduce_res_162669;
    } else {
        max_mult_154354 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154360 = slt64(max_mult_154354, (int64_t) 1);
    bool valid_154362 = !bounds_invalid_upwards_154360;
    bool range_valid_c_154363;
    
    if (!valid_154362) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154354, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:179:99-102\n   #3  ftRelational.fut:170:3-179:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171426_cached_sizze_172320 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171426, &mem_171426_cached_sizze_172320, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171045 = 0; i_171045 < nR_121587; i_171045++) {
        int64_t eta_p_161986 = ((int64_t *) mem_171382)[i_171045];
        int64_t zv_lhs_161988 = add64((int64_t) -1, i_171045);
        int64_t tmp_161989 = smod64(zv_lhs_161988, nR_121587);
        int64_t lifted_lambda_res_161990 = ((int64_t *) mem_171372)[tmp_161989];
        bool cond_161992 = i_171045 == (int64_t) 0;
        int64_t lifted_lambda_res_161993;
        
        if (cond_161992) {
            lifted_lambda_res_161993 = (int64_t) 0;
        } else {
            lifted_lambda_res_161993 = lifted_lambda_res_161990;
        }
        
        bool cond_161995 = slt64((int64_t) 0, eta_p_161986);
        int64_t lifted_lambda_res_161996;
        
        if (cond_161995) {
            lifted_lambda_res_161996 = lifted_lambda_res_161993;
        } else {
            lifted_lambda_res_161996 = (int64_t) -1;
        }
        ((int64_t *) mem_171426)[i_171045] = lifted_lambda_res_161996;
    }
    if (memblock_alloc(ctx, &mem_171434, bytes_171433, "mem_171434")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172006 = 0; nest_i_172006 < defunc_res_162686; nest_i_172006++) {
        ((int64_t *) mem_171434.mem)[nest_i_172006] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171436, bytes_171433, "mem_171436")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172007 = 0; nest_i_172007 < defunc_res_162686; nest_i_172007++) {
        ((int64_t *) mem_171436.mem)[nest_i_172007] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171438, bytes_171433, "mem_171438")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172008 = 0; nest_i_172008 < defunc_res_162686; nest_i_172008++) {
        ((int64_t *) mem_171438.mem)[nest_i_172008] = (int64_t) -1;
    }
    for (int64_t write_iter_171047 = 0; write_iter_171047 < nR_121587; write_iter_171047++) {
        int64_t write_iv_171051 = ((int64_t *) mem_171426)[write_iter_171047];
        int64_t write_iv_171052 = ((int64_t *) mem_171374)[write_iter_171047];
        int64_t write_iv_171053 = ((int64_t *) mem_171376)[write_iter_171047];
        int64_t write_iv_171054 = ((int64_t *) mem_171378)[write_iter_171047];
        
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171434.mem)[write_iv_171051] = write_iv_171052;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171436.mem)[write_iv_171051] = write_iv_171053;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171438.mem)[write_iv_171051] = write_iv_171054;
        }
    }
    
    int64_t distance_154361 = sub64(max_mult_154354, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_171475, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171478, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171481, &mem_171438, "mem_171438") != 0)
        return 1;
    for (int64_t i_154367 = 0; i_154367 < distance_154361; i_154367++) {
        int64_t index_primexp_154371 = add64((int64_t) 1, i_154367);
        
        if (memblock_alloc(ctx, &mem_171483, bytes_171433, "mem_171483")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171483.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171485, bytes_171433, "mem_171485")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171485.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171478.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171487, bytes_171433, "mem_171487")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        for (int64_t write_iter_171069 = 0; write_iter_171069 < nR_121587; write_iter_171069++) {
            int64_t write_iv_171074 = ((int64_t *) mem_171378)[write_iter_171069];
            int64_t write_iv_171075 = ((int64_t *) mem_171374)[write_iter_171069];
            int64_t write_iv_171076 = ((int64_t *) mem_171376)[write_iter_171069];
            int64_t zg_lhs_162583 = ((int64_t *) mem_171382)[write_iter_171069];
            bool cond_162584 = slt64(index_primexp_154371, zg_lhs_162583);
            int64_t lifted_lambda_res_162585;
            
            if (cond_162584) {
                int64_t zp_lhs_162679 = ((int64_t *) mem_171426)[write_iter_171069];
                int64_t lifted_lambda_res_t_res_162680 = add64(index_primexp_154371, zp_lhs_162679);
                
                lifted_lambda_res_162585 = lifted_lambda_res_t_res_162680;
            } else {
                lifted_lambda_res_162585 = (int64_t) -1;
            }
            
            int64_t tmp_162589 = add64(index_primexp_154371, write_iv_171074);
            
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171487.mem)[lifted_lambda_res_162585] = write_iv_171075;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171485.mem)[lifted_lambda_res_162585] = write_iv_171076;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171483.mem)[lifted_lambda_res_162585] = tmp_162589;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172012, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172013, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172014, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171475, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171478, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171481, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171514, &mem_param_171475, "mem_param_171475") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171513, &mem_param_171478, "mem_param_171478") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171512, &mem_param_171481, "mem_param_171481") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171516, bytes_171433, "mem_171516")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171516.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171514.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171518, bytes_171433, "mem_171518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171518.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171520, bytes_171433, "mem_171520")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171520.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171518, "mem_171518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171520, "mem_171520") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &mem_171516, "mem_171516") != 0)
        return 1;
    prim_out_171959 = defunc_res_162686;
    if (memblock_set(ctx, &*mem_out_p_172309, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172310, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172311, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172312 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171370);
        free(mem_171372);
        free(mem_171374);
        free(mem_171376);
        free(mem_171378);
        free(mem_171380);
        free(mem_171382);
        free(mem_171426);
        free(mem_171458);
        free(mem_171460);
        if (memblock_unref(ctx, &mem_171520, "mem_171520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171518, "mem_171518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171516, "mem_171516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171481, "mem_param_171481") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171478, "mem_param_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171475, "mem_param_171475") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171360, "mem_171360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171328, "mem_171328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171326, "mem_171326") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171315, "mem_171315") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171313, "mem_param_171313") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171301, "mem_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171299, "mem_param_171299") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171343, "ext_mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171346, "ext_mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171352, "ext_mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_172323, struct memblock *mem_out_p_172324, struct memblock *mem_out_p_172325, int64_t *out_prim_out_172326, struct memblock tR_mem_171274, struct memblock tS_mem_171275, int64_t nR_116273, int64_t nS_116274, int64_t offset_R_116277, int64_t offset_S_116278, int64_t partitionSizze_116279, int64_t scatter_psizze_116280)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171370_cached_sizze_172327 = 0;
    unsigned char *mem_171370 = NULL;
    int64_t mem_171372_cached_sizze_172328 = 0;
    unsigned char *mem_171372 = NULL;
    int64_t mem_171374_cached_sizze_172329 = 0;
    unsigned char *mem_171374 = NULL;
    int64_t mem_171376_cached_sizze_172330 = 0;
    unsigned char *mem_171376 = NULL;
    int64_t mem_171378_cached_sizze_172331 = 0;
    unsigned char *mem_171378 = NULL;
    int64_t mem_171380_cached_sizze_172332 = 0;
    unsigned char *mem_171380 = NULL;
    int64_t mem_171382_cached_sizze_172333 = 0;
    unsigned char *mem_171382 = NULL;
    int64_t mem_171426_cached_sizze_172334 = 0;
    unsigned char *mem_171426 = NULL;
    int64_t mem_171458_cached_sizze_172335 = 0;
    unsigned char *mem_171458 = NULL;
    int64_t mem_171460_cached_sizze_172336 = 0;
    unsigned char *mem_171460 = NULL;
    struct memblock mem_171520;
    
    mem_171520.references = NULL;
    
    struct memblock mem_171518;
    
    mem_171518.references = NULL;
    
    struct memblock mem_171516;
    
    mem_171516.references = NULL;
    
    struct memblock mem_param_tmp_172014;
    
    mem_param_tmp_172014.references = NULL;
    
    struct memblock mem_param_tmp_172013;
    
    mem_param_tmp_172013.references = NULL;
    
    struct memblock mem_param_tmp_172012;
    
    mem_param_tmp_172012.references = NULL;
    
    struct memblock mem_171487;
    
    mem_171487.references = NULL;
    
    struct memblock mem_171485;
    
    mem_171485.references = NULL;
    
    struct memblock mem_171483;
    
    mem_171483.references = NULL;
    
    struct memblock mem_param_171481;
    
    mem_param_171481.references = NULL;
    
    struct memblock mem_param_171478;
    
    mem_param_171478.references = NULL;
    
    struct memblock mem_param_171475;
    
    mem_param_171475.references = NULL;
    
    struct memblock ext_mem_171512;
    
    ext_mem_171512.references = NULL;
    
    struct memblock ext_mem_171513;
    
    ext_mem_171513.references = NULL;
    
    struct memblock ext_mem_171514;
    
    ext_mem_171514.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock mem_171436;
    
    mem_171436.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_171362;
    
    mem_171362.references = NULL;
    
    struct memblock mem_171360;
    
    mem_171360.references = NULL;
    
    struct memblock mem_param_tmp_171972;
    
    mem_param_tmp_171972.references = NULL;
    
    struct memblock mem_param_tmp_171971;
    
    mem_param_tmp_171971.references = NULL;
    
    struct memblock mem_171328;
    
    mem_171328.references = NULL;
    
    struct memblock mem_171326;
    
    mem_171326.references = NULL;
    
    struct memblock mem_param_tmp_171986;
    
    mem_param_tmp_171986.references = NULL;
    
    struct memblock mem_171315;
    
    mem_171315.references = NULL;
    
    struct memblock mem_param_171313;
    
    mem_param_171313.references = NULL;
    
    struct memblock ext_mem_171324;
    
    ext_mem_171324.references = NULL;
    
    struct memblock mem_param_tmp_171982;
    
    mem_param_tmp_171982.references = NULL;
    
    struct memblock mem_171301;
    
    mem_171301.references = NULL;
    
    struct memblock mem_param_171299;
    
    mem_param_171299.references = NULL;
    
    struct memblock ext_mem_171310;
    
    ext_mem_171310.references = NULL;
    
    struct memblock ext_mem_171343;
    
    ext_mem_171343.references = NULL;
    
    struct memblock ext_mem_171346;
    
    ext_mem_171346.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock ext_mem_171352;
    
    ext_mem_171352.references = NULL;
    
    struct memblock mem_param_171296;
    
    mem_param_171296.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171357;
    
    ext_mem_171357.references = NULL;
    
    struct memblock ext_mem_171358;
    
    ext_mem_171358.references = NULL;
    
    struct memblock mem_171290;
    
    mem_171290.references = NULL;
    
    struct memblock mem_171288;
    
    mem_171288.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock ext_mem_171367;
    
    ext_mem_171367.references = NULL;
    
    struct memblock ext_mem_171368;
    
    ext_mem_171368.references = NULL;
    
    struct memblock mem_171280;
    
    mem_171280.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock ext_mem_171276;
    
    ext_mem_171276.references = NULL;
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171959;
    int64_t partitionSizze_153966 = sdiv64(partitionSizze_116279, (int64_t) 2);
    int64_t zm_lhs_153967 = add64(nR_116273, partitionSizze_153966);
    int64_t zs_lhs_153968 = sub64(zm_lhs_153967, (int64_t) 1);
    bool zzero_153969 = partitionSizze_153966 == (int64_t) 0;
    bool nonzzero_153970 = !zzero_153969;
    bool nonzzero_cert_153971;
    
    if (!nonzzero_153970) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_153972 = sdiv64(zs_lhs_153968, partitionSizze_153966);
    int64_t zm_lhs_153973 = add64(nS_116274, partitionSizze_153966);
    int64_t zs_lhs_153974 = sub64(zm_lhs_153973, (int64_t) 1);
    int64_t numIter_S_153975 = sdiv64(zs_lhs_153974, partitionSizze_153966);
    
    if (futrts_indicesWithIncrement_16256(ctx, &ext_mem_171276, tR_mem_171274, nR_116273, offset_R_116277) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171277 = (int64_t) 8 * nR_116273;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171960 = 0; nest_i_171960 < nR_116273; nest_i_171960++) {
        ((int64_t *) mem_171278.mem)[nest_i_171960] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171280, bytes_171277, "mem_171280")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171961 = 0; nest_i_171961 < nR_116273; nest_i_171961++) {
        ((int64_t *) mem_171280.mem)[nest_i_171961] = (int64_t) 0;
    }
    
    bool loop_cond_153979 = slt64((int64_t) 0, numIter_R_153972);
    bool defunc_0_mergeJoin_res_153980;
    int64_t defunc_0_mergeJoin_res_153981;
    int64_t defunc_0_mergeJoin_res_153984;
    bool loop_while_153985;
    int64_t iter_153986;
    int64_t first_relevant_in_S_153989;
    
    if (memblock_set(ctx, &mem_param_171283, &mem_171280, "mem_171280") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &mem_171278, "mem_171278") != 0)
        return 1;
    loop_while_153985 = loop_cond_153979;
    iter_153986 = (int64_t) 0;
    first_relevant_in_S_153989 = (int64_t) 0;
    while (loop_while_153985) {
        int64_t tR_start_153990 = mul64(partitionSizze_153966, iter_153986);
        int64_t min_arg1_153991 = add64(partitionSizze_153966, tR_start_153990);
        int64_t min_res_153992 = smin64(nR_116273, min_arg1_153991);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 = sub64(min_res_153992, tR_start_153990);
        bool empty_slice_153994 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993 == (int64_t) 0;
        int64_t m_153995 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, (int64_t) 1);
        int64_t i_p_m_t_s_153996 = add64(tR_start_153990, m_153995);
        bool zzero_leq_i_p_m_t_s_153997 = sle64((int64_t) 0, i_p_m_t_s_153996);
        bool i_p_m_t_s_leq_w_153998 = slt64(i_p_m_t_s_153996, nR_116273);
        bool zzero_lte_i_153999 = sle64((int64_t) 0, tR_start_153990);
        bool i_lte_j_154000 = sle64(tR_start_153990, min_res_153992);
        bool y_154001 = i_p_m_t_s_leq_w_153998 && zzero_lte_i_153999;
        bool y_154002 = zzero_leq_i_p_m_t_s_153997 && y_154001;
        bool forwards_ok_154003 = i_lte_j_154000 && y_154002;
        bool ok_or_empty_154004 = empty_slice_153994 || forwards_ok_154003;
        bool index_certs_154005;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_116273, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171287 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993;
        bool cond_154009 = slt64(first_relevant_in_S_153989, numIter_S_153975);
        bool y_154010 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool loop_not_taken_154011 = !cond_154009;
        bool protect_assert_disj_154012 = y_154010 || loop_not_taken_154011;
        bool index_certs_154013;
        
        if (!protect_assert_disj_154012) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154016 = sle64((int64_t) 0, m_153995);
        bool y_154017 = slt64(m_153995, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993);
        bool bounds_check_154018 = x_154016 && y_154017;
        bool protect_assert_disj_154019 = loop_not_taken_154011 || bounds_check_154018;
        bool index_certs_154020;
        
        if (!protect_assert_disj_154019) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154251;
        
        if (!ok_or_empty_154004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_153990, ":", (long long) min_res_153992, "] out of bounds for array of shape [", (long long) nR_116273, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:157:99-102\n   #4  ftRelational.fut:148:3-157:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171288, bytes_171287, "mem_171288")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171969 = 0; nest_i_171969 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171969++) {
            ((int64_t *) mem_171288.mem)[nest_i_171969] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171290, bytes_171287, "mem_171290")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_171970 = 0; nest_i_171970 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; nest_i_171970++) {
            ((int64_t *) mem_171290.mem)[nest_i_171970] = (int64_t) 0;
        }
        
        int16_t gt_lhs_154014;
        
        if (cond_154009) {
            int16_t x_162598 = ((int16_t *) tR_mem_171274.mem)[tR_start_153990];
            
            gt_lhs_154014 = x_162598;
        } else {
            gt_lhs_154014 = (int16_t) 0;
        }
        
        int16_t lt_lhs_154021;
        
        if (cond_154009) {
            int16_t x_162599 = ((int16_t *) tR_mem_171274.mem)[i_p_m_t_s_153996];
            
            lt_lhs_154021 = x_162599;
        } else {
            lt_lhs_154021 = (int16_t) 0;
        }
        
        int64_t ext_171356;
        int64_t ext_171355;
        int64_t ext_171354;
        int64_t ext_171353;
        bool loopres_154023;
        int64_t loopres_154024;
        int64_t loopres_154027;
        bool loop_while_154028;
        int64_t s_iter_154029;
        int64_t minRelevant_154032;
        int64_t ctx_param_ext_171291;
        int64_t ctx_param_ext_171292;
        int64_t ctx_param_ext_171294;
        int64_t ctx_param_ext_171295;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171296, &mem_171288, "mem_171288") != 0)
            return 1;
        ctx_param_ext_171291 = (int64_t) 0;
        ctx_param_ext_171292 = (int64_t) 1;
        ctx_param_ext_171294 = (int64_t) 0;
        ctx_param_ext_171295 = (int64_t) 1;
        loop_while_154028 = cond_154009;
        s_iter_154029 = first_relevant_in_S_153989;
        minRelevant_154032 = first_relevant_in_S_153989;
        while (loop_while_154028) {
            int64_t tS_start_154033 = mul64(partitionSizze_153966, s_iter_154029);
            int64_t min_arg1_154034 = add64(partitionSizze_153966, tS_start_154033);
            int64_t min_res_154035 = smin64(nS_116274, min_arg1_154034);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 = sub64(min_res_154035, tS_start_154033);
            bool empty_slice_154037 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036 == (int64_t) 0;
            int64_t m_154038 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, (int64_t) 1);
            int64_t i_p_m_t_s_154039 = add64(tS_start_154033, m_154038);
            bool zzero_leq_i_p_m_t_s_154040 = sle64((int64_t) 0, i_p_m_t_s_154039);
            bool i_p_m_t_s_leq_w_154041 = slt64(i_p_m_t_s_154039, nS_116274);
            bool zzero_lte_i_154042 = sle64((int64_t) 0, tS_start_154033);
            bool i_lte_j_154043 = sle64(tS_start_154033, min_res_154035);
            bool y_154044 = i_p_m_t_s_leq_w_154041 && zzero_lte_i_154042;
            bool y_154045 = zzero_leq_i_p_m_t_s_154040 && y_154044;
            bool forwards_ok_154046 = i_lte_j_154043 && y_154045;
            bool ok_or_empty_154047 = empty_slice_154037 || forwards_ok_154046;
            bool index_certs_154048;
            
            if (!ok_or_empty_154047) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154033, ":", (long long) min_res_154035, "] out of bounds for array of shape [", (long long) nS_116274, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154049 = sle64((int64_t) 0, m_154038);
            bool y_154050 = slt64(m_154038, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool bounds_check_154051 = x_154049 && y_154050;
            bool index_certs_154052;
            
            if (!bounds_check_154051) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154055 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
            bool index_certs_154056;
            
            if (!y_154055) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t gt_rhs_154053 = ((int16_t *) tS_mem_171275.mem)[i_p_m_t_s_154039];
            bool defunc_0_gt_res_154054 = slt16(gt_rhs_154053, gt_lhs_154014);
            int16_t lt_rhs_154057 = ((int16_t *) tS_mem_171275.mem)[tS_start_154033];
            bool defunc_0_lt_res_154058 = slt16(lt_lhs_154021, lt_rhs_154057);
            bool thisStillRel_154059 = !defunc_0_lt_res_154058;
            int64_t ext_171345;
            
            if (defunc_0_lt_res_154058) {
                ext_171345 = ctx_param_ext_171291;
            } else {
                ext_171345 = (int64_t) 0;
            }
            
            int64_t ext_171344;
            
            if (defunc_0_lt_res_154058) {
                ext_171344 = ctx_param_ext_171292;
            } else {
                ext_171344 = (int64_t) 1;
            }
            
            int64_t ext_171342;
            
            if (defunc_0_lt_res_154058) {
                ext_171342 = ctx_param_ext_171294;
            } else {
                ext_171342 = (int64_t) 0;
            }
            
            int64_t ext_171341;
            
            if (defunc_0_lt_res_154058) {
                ext_171341 = ctx_param_ext_171295;
            } else {
                ext_171341 = (int64_t) 1;
            }
            
            int64_t ext_171351;
            
            if (defunc_0_gt_res_154054) {
                ext_171351 = ctx_param_ext_171291;
            } else {
                ext_171351 = ext_171345;
            }
            
            int64_t ext_171350;
            
            if (defunc_0_gt_res_154054) {
                ext_171350 = ctx_param_ext_171292;
            } else {
                ext_171350 = ext_171344;
            }
            
            int64_t ext_171348;
            
            if (defunc_0_gt_res_154054) {
                ext_171348 = ctx_param_ext_171294;
            } else {
                ext_171348 = ext_171342;
            }
            
            int64_t ext_171347;
            
            if (defunc_0_gt_res_154054) {
                ext_171347 = ctx_param_ext_171295;
            } else {
                ext_171347 = ext_171341;
            }
            
            int64_t loopres_154060;
            bool loopres_154063;
            int64_t loopres_154064;
            
            if (defunc_0_gt_res_154054) {
                int64_t tmp_162600 = add64((int64_t) 1, s_iter_154029);
                
                if (memblock_set(ctx, &ext_mem_171352, &mem_param_171293, "mem_param_171293") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &mem_param_171296, "mem_param_171296") != 0)
                    return 1;
                loopres_154060 = tmp_162600;
                loopres_154063 = 1;
                loopres_154064 = tmp_162600;
            } else {
                int64_t loopres_f_res_154066;
                bool loopres_f_res_154069;
                
                if (defunc_0_lt_res_154058) {
                    if (memblock_set(ctx, &ext_mem_171346, &mem_param_171293, "mem_param_171293") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_param_171296, "mem_param_171296") != 0)
                        return 1;
                    loopres_f_res_154066 = s_iter_154029;
                    loopres_f_res_154069 = thisStillRel_154059;
                } else {
                    bool index_certs_154070;
                    
                    if (!bounds_check_154018) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_153995, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lt_lhs_154071 = ((int16_t *) tR_mem_171274.mem)[i_p_m_t_s_153996];
                    bool defunc_0_lt_res_154072 = slt16(lt_lhs_154071, gt_rhs_154053);
                    bool nextRel_154073 = !defunc_0_lt_res_154072;
                    int64_t find_joinTuples_arg3_154074 = add64(offset_S_116278, tS_start_154033);
                    double i64_res_154075 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                    double log2_res_154076 = futrts_log2_64(i64_res_154075);
                    double ceil_res_154077 = futrts_ceil64(log2_res_154076);
                    int64_t f64_res_154078 = fptosi_f64_i64(ceil_res_154077);
                    int64_t num_iter_154079 = add64((int64_t) 1, f64_res_154078);
                    int64_t bsearch_first_154081;
                    int64_t last_step_154084;
                    
                    if (memblock_set(ctx, &mem_param_171299, &mem_171290, "mem_171290") != 0)
                        return 1;
                    last_step_154084 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154082 = 0; i_154082 < num_iter_154079; i_154082++) {
                        int64_t zs_lhs_154085 = add64((int64_t) 1, last_step_154084);
                        int64_t this_step_154086 = sdiv64(zs_lhs_154085, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171301, bytes_171287, "mem_171301")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171003++) {
                            int64_t eta_p_162154 = ((int64_t *) mem_param_171299.mem)[i_171003];
                            int64_t slice_171252 = tR_start_153990 + i_171003;
                            int16_t eta_p_162155 = ((int16_t *) tR_mem_171274.mem)[slice_171252];
                            bool cond_162157 = sle64(eta_p_162154, (int64_t) 0);
                            int16_t prev_elem_162158;
                            
                            if (cond_162157) {
                                bool index_certs_162602;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162158 = lt_rhs_154057;
                            } else {
                                int64_t tmp_162162 = sub64(eta_p_162154, (int64_t) 1);
                                bool x_162163 = sle64((int64_t) 0, tmp_162162);
                                bool y_162164 = slt64(tmp_162162, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162165 = x_162163 && y_162164;
                                bool index_certs_162166;
                                
                                if (!bounds_check_162165) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162167 = tS_start_154033 + tmp_162162;
                                int16_t prev_elem_f_res_162168 = ((int16_t *) tS_mem_171275.mem)[slice_162167];
                                
                                prev_elem_162158 = prev_elem_f_res_162168;
                            }
                            
                            bool cond_162169 = slt64(eta_p_162154, (int64_t) 0);
                            int16_t cur_elem_162170;
                            
                            if (cond_162169) {
                                bool index_certs_162605;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162170 = lt_rhs_154057;
                            } else {
                                bool x_162174 = sle64((int64_t) 0, eta_p_162154);
                                bool y_162175 = slt64(eta_p_162154, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162176 = x_162174 && y_162175;
                                bool index_certs_162177;
                                
                                if (!bounds_check_162176) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162154, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162178 = tS_start_154033 + eta_p_162154;
                                int16_t cur_elem_f_res_162179 = ((int16_t *) tS_mem_171275.mem)[slice_162178];
                                
                                cur_elem_162170 = cur_elem_f_res_162179;
                            }
                            
                            bool cond_162180 = sle64(m_154038, eta_p_162154);
                            int16_t next_elem_162181;
                            
                            if (cond_162180) {
                                bool index_certs_162611;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162181 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162189 = add64((int64_t) 1, eta_p_162154);
                                bool x_162190 = sle64((int64_t) 0, tmp_162189);
                                bool y_162191 = slt64(tmp_162189, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162192 = x_162190 && y_162191;
                                bool index_certs_162193;
                                
                                if (!bounds_check_162192) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162189, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162194 = tS_start_154033 + tmp_162189;
                                int16_t next_elem_f_res_162195 = ((int16_t *) tS_mem_171275.mem)[slice_162194];
                                
                                next_elem_162181 = next_elem_f_res_162195;
                            }
                            
                            int64_t defunc_0_f_res_162200;
                            
                            if (cond_162169) {
                                defunc_0_f_res_162200 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162201 = eta_p_162155 == cur_elem_162170;
                                bool cond_162202 = eta_p_162154 == (int64_t) 0;
                                bool defunc_0_gt_res_162203 = slt16(prev_elem_162158, eta_p_162155);
                                bool x_162204 = !cond_162202;
                                bool y_162205 = defunc_0_gt_res_162203 && x_162204;
                                bool cond_t_res_162206 = cond_162202 || y_162205;
                                bool x_162207 = defunc_0_eq_res_162201 && cond_t_res_162206;
                                int64_t defunc_0_f_res_f_res_162208;
                                
                                if (x_162207) {
                                    defunc_0_f_res_f_res_162208 = eta_p_162154;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162209;
                                    
                                    if (defunc_0_eq_res_162201) {
                                        int64_t max_arg1_162614 = sub64(eta_p_162154, this_step_154086);
                                        int64_t max_res_162615 = smax64((int64_t) 0, max_arg1_162614);
                                        
                                        defunc_0_f_res_f_res_f_res_162209 = max_res_162615;
                                    } else {
                                        bool defunc_0_gt_res_162212 = slt16(cur_elem_162170, eta_p_162155);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162213;
                                        
                                        if (defunc_0_gt_res_162212) {
                                            bool cond_162617 = eta_p_162154 == m_154038;
                                            bool defunc_0_lt_res_162618 = slt16(eta_p_162155, next_elem_162181);
                                            bool x_162619 = !cond_162617;
                                            bool y_162620 = defunc_0_lt_res_162618 && x_162619;
                                            bool cond_162621 = cond_162617 || y_162620;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                            
                                            if (cond_162621) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_162623 = add64(this_step_154086, eta_p_162154);
                                                int64_t min_res_162624 = smin64(m_154038, min_arg1_162623);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_162622 = min_res_162624;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_t_res_162622;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                            
                                            if (cond_t_res_162206) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162224 = sub64(eta_p_162154, this_step_154086);
                                                int64_t max_res_162225 = smax64((int64_t) 0, max_arg1_162224);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162223 = max_res_162225;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162213 = defunc_0_f_res_f_res_f_res_f_res_f_res_162223;
                                        }
                                        defunc_0_f_res_f_res_f_res_162209 = defunc_0_f_res_f_res_f_res_f_res_162213;
                                    }
                                    defunc_0_f_res_f_res_162208 = defunc_0_f_res_f_res_f_res_162209;
                                }
                                defunc_0_f_res_162200 = defunc_0_f_res_f_res_162208;
                            }
                            ((int64_t *) mem_171301.mem)[i_171003] = defunc_0_f_res_162200;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171982, &mem_171301, "mem_171301") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171984 = this_step_154086;
                        
                        if (memblock_set(ctx, &mem_param_171299, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
                            return 1;
                        last_step_154084 = last_step_tmp_171984;
                    }
                    if (memblock_set(ctx, &ext_mem_171310, &mem_param_171299, "mem_param_171299") != 0)
                        return 1;
                    bsearch_first_154081 = last_step_154084;
                    
                    int64_t bsearch_last_154164;
                    int64_t last_step_154167;
                    
                    if (memblock_set(ctx, &mem_param_171313, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    last_step_154167 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036;
                    for (int64_t i_154165 = 0; i_154165 < num_iter_154079; i_154165++) {
                        int64_t zs_lhs_154168 = add64((int64_t) 1, last_step_154167);
                        int64_t max_arg1_154169 = sdiv64(zs_lhs_154168, (int64_t) 2);
                        int64_t max_res_154170 = smax64((int64_t) 1, max_arg1_154169);
                        
                        if (memblock_alloc(ctx, &mem_171315, bytes_171287, "mem_171315")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171007 = 0; i_171007 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171007++) {
                            int64_t eta_p_162277 = ((int64_t *) mem_param_171313.mem)[i_171007];
                            int64_t slice_171251 = tR_start_153990 + i_171007;
                            int16_t eta_p_162278 = ((int16_t *) tR_mem_171274.mem)[slice_171251];
                            bool cond_162280 = slt64(eta_p_162277, (int64_t) 0);
                            int16_t cur_elem_162281;
                            
                            if (cond_162280) {
                                bool index_certs_162627;
                                
                                if (!y_154055) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162281 = lt_rhs_154057;
                            } else {
                                bool x_162285 = sle64((int64_t) 0, eta_p_162277);
                                bool y_162286 = slt64(eta_p_162277, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162287 = x_162285 && y_162286;
                                bool index_certs_162288;
                                
                                if (!bounds_check_162287) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162277, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162289 = tS_start_154033 + eta_p_162277;
                                int16_t cur_elem_f_res_162290 = ((int16_t *) tS_mem_171275.mem)[slice_162289];
                                
                                cur_elem_162281 = cur_elem_f_res_162290;
                            }
                            
                            bool cond_162291 = sle64(m_154038, eta_p_162277);
                            int16_t next_elem_162292;
                            
                            if (cond_162291) {
                                bool index_certs_162633;
                                
                                if (!bounds_check_154051) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154038, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162292 = gt_rhs_154053;
                            } else {
                                int64_t tmp_162300 = add64((int64_t) 1, eta_p_162277);
                                bool x_162301 = sle64((int64_t) 0, tmp_162300);
                                bool y_162302 = slt64(tmp_162300, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036);
                                bool bounds_check_162303 = x_162301 && y_162302;
                                bool index_certs_162304;
                                
                                if (!bounds_check_162303) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162300, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154036, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162305 = tS_start_154033 + tmp_162300;
                                int16_t next_elem_f_res_162306 = ((int16_t *) tS_mem_171275.mem)[slice_162305];
                                
                                next_elem_162292 = next_elem_f_res_162306;
                            }
                            
                            int64_t defunc_0_f_res_162310;
                            
                            if (cond_162280) {
                                defunc_0_f_res_162310 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162311 = eta_p_162278 == cur_elem_162281;
                                bool cond_162313 = eta_p_162277 == m_154038;
                                bool defunc_0_gt_res_162314 = slt16(eta_p_162278, next_elem_162292);
                                bool x_162315 = !cond_162313;
                                bool y_162316 = defunc_0_gt_res_162314 && x_162315;
                                bool cond_t_res_162317 = cond_162313 || y_162316;
                                bool x_162318 = defunc_0_eq_res_162311 && cond_t_res_162317;
                                int64_t defunc_0_f_res_f_res_162319;
                                
                                if (x_162318) {
                                    defunc_0_f_res_f_res_162319 = eta_p_162277;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162320;
                                    
                                    if (defunc_0_eq_res_162311) {
                                        int64_t min_arg1_162636 = add64(max_res_154170, eta_p_162277);
                                        int64_t min_res_162637 = smin64(m_154038, min_arg1_162636);
                                        
                                        defunc_0_f_res_f_res_f_res_162320 = min_res_162637;
                                    } else {
                                        bool defunc_0_gt_res_162323 = slt16(cur_elem_162281, eta_p_162278);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162324;
                                        
                                        if (defunc_0_gt_res_162323) {
                                            int64_t min_arg1_162638 = add64(max_res_154170, eta_p_162277);
                                            int64_t min_res_162639 = smin64(m_154038, min_arg1_162638);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = min_res_162639;
                                        } else {
                                            int64_t max_arg1_162327 = sub64(eta_p_162277, max_res_154170);
                                            int64_t max_res_162328 = smax64((int64_t) 0, max_arg1_162327);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162324 = max_res_162328;
                                        }
                                        defunc_0_f_res_f_res_f_res_162320 = defunc_0_f_res_f_res_f_res_f_res_162324;
                                    }
                                    defunc_0_f_res_f_res_162319 = defunc_0_f_res_f_res_f_res_162320;
                                }
                                defunc_0_f_res_162310 = defunc_0_f_res_f_res_162319;
                            }
                            ((int64_t *) mem_171315.mem)[i_171007] = defunc_0_f_res_162310;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_171986, &mem_171315, "mem_171315") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_171988 = max_res_154170;
                        
                        if (memblock_set(ctx, &mem_param_171313, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
                            return 1;
                        last_step_154167 = last_step_tmp_171988;
                    }
                    if (memblock_set(ctx, &ext_mem_171324, &mem_param_171313, "mem_param_171313") != 0)
                        return 1;
                    bsearch_last_154164 = last_step_154167;
                    if (memblock_alloc(ctx, &mem_171326, bytes_171287, "mem_171326")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171328, bytes_171287, "mem_171328")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171013 = 0; i_171013 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993; i_171013++) {
                        int64_t eta_p_162133 = ((int64_t *) ext_mem_171310.mem)[i_171013];
                        int64_t eta_p_162134 = ((int64_t *) mem_param_171296.mem)[ctx_param_ext_171294 + i_171013 * ctx_param_ext_171295];
                        int64_t eta_p_162135 = ((int64_t *) ext_mem_171324.mem)[i_171013];
                        int64_t eta_p_162136 = ((int64_t *) mem_param_171293.mem)[ctx_param_ext_171291 + i_171013 * ctx_param_ext_171292];
                        bool cond_162138 = slt64(eta_p_162133, (int64_t) 0);
                        int64_t lifted_lambda_res_162139;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162139 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162140 = sub64(eta_p_162135, eta_p_162133);
                            int64_t lifted_lambda_res_f_res_162141 = add64((int64_t) 1, zp_lhs_162140);
                            
                            lifted_lambda_res_162139 = lifted_lambda_res_f_res_162141;
                        }
                        
                        int64_t defunc_0_f_res_162143 = add64(eta_p_162136, lifted_lambda_res_162139);
                        int64_t lifted_lambda_res_162146;
                        
                        if (cond_162138) {
                            lifted_lambda_res_162146 = eta_p_162133;
                        } else {
                            int64_t lifted_lambda_res_f_res_162147 = add64(find_joinTuples_arg3_154074, eta_p_162133);
                            
                            lifted_lambda_res_162146 = lifted_lambda_res_f_res_162147;
                        }
                        
                        bool cond_162149 = slt64(eta_p_162134, (int64_t) 0);
                        int64_t lifted_lambda_res_162150;
                        
                        if (cond_162149) {
                            lifted_lambda_res_162150 = lifted_lambda_res_162146;
                        } else {
                            lifted_lambda_res_162150 = eta_p_162134;
                        }
                        ((int64_t *) mem_171326.mem)[i_171013] = lifted_lambda_res_162150;
                        ((int64_t *) mem_171328.mem)[i_171013] = defunc_0_f_res_162143;
                    }
                    if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
                        return 1;
                    
                    int64_t tmp_154247 = add64((int64_t) 1, s_iter_154029);
                    
                    if (memblock_set(ctx, &ext_mem_171346, &mem_171328, "mem_171328") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171343, &mem_171326, "mem_171326") != 0)
                        return 1;
                    loopres_f_res_154066 = tmp_154247;
                    loopres_f_res_154069 = nextRel_154073;
                }
                if (memblock_set(ctx, &ext_mem_171352, &ext_mem_171346, "ext_mem_171346") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171349, &ext_mem_171343, "ext_mem_171343") != 0)
                    return 1;
                loopres_154060 = loopres_f_res_154066;
                loopres_154063 = loopres_f_res_154069;
                loopres_154064 = minRelevant_154032;
            }
            
            bool cond_154248 = slt64(loopres_154060, numIter_S_153975);
            bool x_154249 = loopres_154063 && cond_154248;
            
            if (memblock_set(ctx, &mem_param_tmp_171971, &ext_mem_171352, "ext_mem_171352") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171972, &ext_mem_171349, "ext_mem_171349") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_171973 = ext_171351;
            int64_t ctx_param_ext_tmp_171974 = ext_171350;
            int64_t ctx_param_ext_tmp_171975 = ext_171348;
            int64_t ctx_param_ext_tmp_171976 = ext_171347;
            bool loop_while_tmp_171977 = x_154249;
            int64_t s_iter_tmp_171978 = loopres_154060;
            int64_t minRelevant_tmp_171981 = loopres_154064;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171296, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
                return 1;
            ctx_param_ext_171291 = ctx_param_ext_tmp_171973;
            ctx_param_ext_171292 = ctx_param_ext_tmp_171974;
            ctx_param_ext_171294 = ctx_param_ext_tmp_171975;
            ctx_param_ext_171295 = ctx_param_ext_tmp_171976;
            loop_while_154028 = loop_while_tmp_171977;
            s_iter_154029 = s_iter_tmp_171978;
            minRelevant_154032 = minRelevant_tmp_171981;
        }
        if (memblock_set(ctx, &ext_mem_171358, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171357, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        ext_171356 = ctx_param_ext_171291;
        ext_171355 = ctx_param_ext_171292;
        ext_171354 = ctx_param_ext_171294;
        ext_171353 = ctx_param_ext_171295;
        loopres_154023 = loop_while_154028;
        loopres_154024 = s_iter_154029;
        loopres_154027 = minRelevant_154032;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171360, bytes_171277, "mem_171360")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_116273});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171360.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171357.mem, ext_171354, (int64_t []) {ext_171353}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171362, bytes_171277, "mem_171362")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_116273});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362.mem, tR_start_153990, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171358.mem, ext_171356, (int64_t []) {ext_171355}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_153993});
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        
        int64_t tmp_154255 = add64((int64_t) 1, iter_153986);
        bool loop_cond_154256 = slt64(tmp_154255, numIter_R_153972);
        
        if (memblock_set(ctx, &mem_param_tmp_171962, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171360, "mem_171360") != 0)
            return 1;
        
        bool loop_while_tmp_171964 = loop_cond_154256;
        int64_t iter_tmp_171965 = tmp_154255;
        int64_t first_relevant_in_S_tmp_171968 = loopres_154027;
        
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        loop_while_153985 = loop_while_tmp_171964;
        iter_153986 = iter_tmp_171965;
        first_relevant_in_S_153989 = first_relevant_in_S_tmp_171968;
    }
    if (memblock_set(ctx, &ext_mem_171368, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171367, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    defunc_0_mergeJoin_res_153980 = loop_while_153985;
    defunc_0_mergeJoin_res_153981 = iter_153986;
    defunc_0_mergeJoin_res_153984 = first_relevant_in_S_153989;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
        return 1;
    if (mem_171370_cached_sizze_172327 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171370, &mem_171370_cached_sizze_172327, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171372_cached_sizze_172328 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171372, &mem_171372_cached_sizze_172328, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_171373 = (int64_t) 2 * nR_116273;
    
    if (mem_171374_cached_sizze_172329 < bytes_171373) {
        err = lexical_realloc(ctx, &mem_171374, &mem_171374_cached_sizze_172329, bytes_171373);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171376_cached_sizze_172330 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171376, &mem_171376_cached_sizze_172330, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171378_cached_sizze_172331 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171378, &mem_171378_cached_sizze_172331, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171380_cached_sizze_172332 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171380, &mem_171380_cached_sizze_172332, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171382_cached_sizze_172333 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171382, &mem_171382_cached_sizze_172333, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171041;
    int64_t discard_171042;
    int64_t defunc_res_162686;
    int64_t scanacc_171023;
    int64_t scanacc_171024;
    int64_t redout_171027;
    
    scanacc_171023 = (int64_t) 0;
    scanacc_171024 = (int64_t) 0;
    redout_171027 = (int64_t) 0;
    for (int64_t i_171033 = 0; i_171033 < nR_116273; i_171033++) {
        int64_t zg_lhs_162079 = ((int64_t *) ext_mem_171368.mem)[i_171033];
        bool cond_162080 = slt64((int64_t) 0, zg_lhs_162079);
        int64_t lifted_lambda_res_162081;
        
        if (cond_162080) {
            lifted_lambda_res_162081 = i_171033;
        } else {
            lifted_lambda_res_162081 = (int64_t) -1;
        }
        
        bool cond_162083 = sle64((int64_t) 0, lifted_lambda_res_162081);
        bool cond_t_res_162084 = slt64(lifted_lambda_res_162081, nR_116273);
        bool x_162085 = cond_162083 && cond_t_res_162084;
        int64_t lifted_lambda_res_162086;
        
        if (x_162085) {
            bool index_certs_162643;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_116273, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:157:99-102\n   #4  ftRelational.fut:148:3-157:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_162644 = ((int64_t *) ext_mem_171368.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162086 = lifted_lambda_res_t_res_162644;
        } else {
            lifted_lambda_res_162086 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162090 = slt64((int64_t) 1, lifted_lambda_res_162086);
        int64_t defunc_0_f_res_162091 = btoi_bool_i64(lifted_lambda_res_162090);
        int16_t lifted_lambda_res_162103;
        int64_t lifted_lambda_res_162104;
        int64_t lifted_lambda_res_162105;
        
        if (x_162085) {
            bool index_certs_162645;
            
            if (!x_162085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162081, "] out of bounds for array of shape [", (long long) nR_116273, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:157:99-102\n   #5  ftRelational.fut:148:3-157:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t lifted_lambda_res_t_res_162646 = ((int16_t *) tR_mem_171274.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162647 = ((int64_t *) ext_mem_171276.mem)[lifted_lambda_res_162081];
            int64_t lifted_lambda_res_t_res_162648 = ((int64_t *) ext_mem_171367.mem)[lifted_lambda_res_162081];
            
            lifted_lambda_res_162103 = lifted_lambda_res_t_res_162646;
            lifted_lambda_res_162104 = lifted_lambda_res_t_res_162647;
            lifted_lambda_res_162105 = lifted_lambda_res_t_res_162648;
        } else {
            lifted_lambda_res_162103 = (int16_t) 0;
            lifted_lambda_res_162104 = (int64_t) -1;
            lifted_lambda_res_162105 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154319 = add64(defunc_0_f_res_162091, scanacc_171023);
        int64_t lifted_lambda_res_154280 = add64(lifted_lambda_res_162086, scanacc_171024);
        int64_t zp_res_154300 = add64(lifted_lambda_res_162086, redout_171027);
        
        ((int64_t *) mem_171370)[i_171033] = defunc_0_op_res_154319;
        ((int64_t *) mem_171372)[i_171033] = lifted_lambda_res_154280;
        ((int16_t *) mem_171374)[i_171033] = lifted_lambda_res_162103;
        ((int64_t *) mem_171376)[i_171033] = lifted_lambda_res_162104;
        ((int64_t *) mem_171378)[i_171033] = lifted_lambda_res_162105;
        ((int64_t *) mem_171380)[i_171033] = defunc_0_f_res_162091;
        ((int64_t *) mem_171382)[i_171033] = lifted_lambda_res_162086;
        
        int64_t scanacc_tmp_171992 = defunc_0_op_res_154319;
        int64_t scanacc_tmp_171993 = lifted_lambda_res_154280;
        int64_t redout_tmp_171996 = zp_res_154300;
        
        scanacc_171023 = scanacc_tmp_171992;
        scanacc_171024 = scanacc_tmp_171993;
        redout_171027 = redout_tmp_171996;
    }
    discard_171041 = scanacc_171023;
    discard_171042 = scanacc_171024;
    defunc_res_162686 = redout_171027;
    if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
        return 1;
    
    int64_t bytes_171433 = (int64_t) 2 * defunc_res_162686;
    int64_t bytes_171435 = (int64_t) 8 * defunc_res_162686;
    bool cond_154320 = nR_116273 == (int64_t) 0;
    bool x_154321 = !cond_154320;
    int64_t tmp_154322 = sub64(nR_116273, (int64_t) 1);
    bool x_154323 = sle64((int64_t) 0, tmp_154322);
    bool y_154324 = slt64(tmp_154322, nR_116273);
    bool bounds_check_154325 = x_154323 && y_154324;
    bool protect_assert_disj_154326 = cond_154320 || bounds_check_154325;
    bool index_certs_154327;
    
    if (!protect_assert_disj_154326) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154322, "] out of bounds for array of shape [", (long long) nR_116273, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:157:99-102\n   #4  ftRelational.fut:148:3-157:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154328;
    
    if (x_154321) {
        int64_t x_162649 = ((int64_t *) mem_171370)[tmp_154322];
        
        m_f_res_154328 = x_162649;
    } else {
        m_f_res_154328 = (int64_t) 0;
    }
    
    int64_t m_154330;
    
    if (cond_154320) {
        m_154330 = (int64_t) 0;
    } else {
        m_154330 = m_f_res_154328;
    }
    
    bool cond_154353 = slt64((int64_t) 0, m_154330);
    int64_t m_154340 = sub64(m_154330, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154342 = slt64(m_154340, nR_116273);
    bool zzero_leq_i_p_m_t_s_154341 = sle64((int64_t) 0, m_154340);
    bool y_154344 = zzero_leq_i_p_m_t_s_154341 && i_p_m_t_s_leq_w_154342;
    bool i_lte_j_154343 = sle64((int64_t) 0, m_154330);
    bool forwards_ok_154345 = i_lte_j_154343 && y_154344;
    bool eq_x_zz_154337 = (int64_t) 0 == m_f_res_154328;
    bool p_and_eq_x_y_154338 = x_154321 && eq_x_zz_154337;
    bool empty_slice_154339 = cond_154320 || p_and_eq_x_y_154338;
    bool ok_or_empty_154346 = empty_slice_154339 || forwards_ok_154345;
    bool index_certs_154347;
    
    if (!ok_or_empty_154346) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154330, "] out of bounds for array of shape [", (long long) nR_116273, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:157:99-102\n   #4  ftRelational.fut:148:3-157:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171457 = (int64_t) 8 * m_154330;
    
    if (mem_171458_cached_sizze_172335 < bytes_171457) {
        err = lexical_realloc(ctx, &mem_171458, &mem_171458_cached_sizze_172335, bytes_171457);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171382, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154330});
    
    int64_t max_mult_154354;
    
    if (cond_154353) {
        if (mem_171460_cached_sizze_172336 < bytes_171277) {
            err = lexical_realloc(ctx, &mem_171460, &mem_171460_cached_sizze_172336, bytes_171277);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171060 = 0; i_171060 < nR_116273; i_171060++) {
            int64_t eta_p_162655 = ((int64_t *) mem_171380)[i_171060];
            int64_t eta_p_162656 = ((int64_t *) mem_171370)[i_171060];
            bool cond_162657 = eta_p_162655 == (int64_t) 1;
            int64_t lifted_lambda_res_162658;
            
            if (cond_162657) {
                int64_t lifted_lambda_res_t_res_162659 = sub64(eta_p_162656, (int64_t) 1);
                
                lifted_lambda_res_162658 = lifted_lambda_res_t_res_162659;
            } else {
                lifted_lambda_res_162658 = (int64_t) -1;
            }
            ((int64_t *) mem_171460)[i_171060] = lifted_lambda_res_162658;
        }
        for (int64_t write_iter_171062 = 0; write_iter_171062 < nR_116273; write_iter_171062++) {
            int64_t write_iv_171064 = ((int64_t *) mem_171460)[write_iter_171062];
            int64_t write_iv_171065 = ((int64_t *) mem_171382)[write_iter_171062];
            
            if (sle64((int64_t) 0, write_iv_171064) && slt64(write_iv_171064, m_154330)) {
                ((int64_t *) mem_171458)[write_iv_171064] = write_iv_171065;
            }
        }
        
        int64_t defunc_0_reduce_res_162669;
        int64_t redout_171067 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171068 = 0; i_171068 < m_154330; i_171068++) {
            int64_t x_162670 = ((int64_t *) mem_171458)[i_171068];
            int64_t max_res_162673 = smax64(x_162670, redout_171067);
            int64_t redout_tmp_172004 = max_res_162673;
            
            redout_171067 = redout_tmp_172004;
        }
        defunc_0_reduce_res_162669 = redout_171067;
        max_mult_154354 = defunc_0_reduce_res_162669;
    } else {
        max_mult_154354 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154360 = slt64(max_mult_154354, (int64_t) 1);
    bool valid_154362 = !bounds_invalid_upwards_154360;
    bool range_valid_c_154363;
    
    if (!valid_154362) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154354, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:157:99-102\n   #3  ftRelational.fut:148:3-157:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171426_cached_sizze_172334 < bytes_171277) {
        err = lexical_realloc(ctx, &mem_171426, &mem_171426_cached_sizze_172334, bytes_171277);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171045 = 0; i_171045 < nR_116273; i_171045++) {
        int64_t eta_p_161986 = ((int64_t *) mem_171382)[i_171045];
        int64_t zv_lhs_161988 = add64((int64_t) -1, i_171045);
        int64_t tmp_161989 = smod64(zv_lhs_161988, nR_116273);
        int64_t lifted_lambda_res_161990 = ((int64_t *) mem_171372)[tmp_161989];
        bool cond_161992 = i_171045 == (int64_t) 0;
        int64_t lifted_lambda_res_161993;
        
        if (cond_161992) {
            lifted_lambda_res_161993 = (int64_t) 0;
        } else {
            lifted_lambda_res_161993 = lifted_lambda_res_161990;
        }
        
        bool cond_161995 = slt64((int64_t) 0, eta_p_161986);
        int64_t lifted_lambda_res_161996;
        
        if (cond_161995) {
            lifted_lambda_res_161996 = lifted_lambda_res_161993;
        } else {
            lifted_lambda_res_161996 = (int64_t) -1;
        }
        ((int64_t *) mem_171426)[i_171045] = lifted_lambda_res_161996;
    }
    if (memblock_alloc(ctx, &mem_171434, bytes_171433, "mem_171434")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172006 = 0; nest_i_172006 < defunc_res_162686; nest_i_172006++) {
        ((int16_t *) mem_171434.mem)[nest_i_172006] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171436, bytes_171435, "mem_171436")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172007 = 0; nest_i_172007 < defunc_res_162686; nest_i_172007++) {
        ((int64_t *) mem_171436.mem)[nest_i_172007] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171438, bytes_171435, "mem_171438")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172008 = 0; nest_i_172008 < defunc_res_162686; nest_i_172008++) {
        ((int64_t *) mem_171438.mem)[nest_i_172008] = (int64_t) -1;
    }
    for (int64_t write_iter_171047 = 0; write_iter_171047 < nR_116273; write_iter_171047++) {
        int64_t write_iv_171051 = ((int64_t *) mem_171426)[write_iter_171047];
        int16_t write_iv_171052 = ((int16_t *) mem_171374)[write_iter_171047];
        int64_t write_iv_171053 = ((int64_t *) mem_171376)[write_iter_171047];
        int64_t write_iv_171054 = ((int64_t *) mem_171378)[write_iter_171047];
        
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int16_t *) mem_171434.mem)[write_iv_171051] = write_iv_171052;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171436.mem)[write_iv_171051] = write_iv_171053;
        }
        if (sle64((int64_t) 0, write_iv_171051) && slt64(write_iv_171051, defunc_res_162686)) {
            ((int64_t *) mem_171438.mem)[write_iv_171051] = write_iv_171054;
        }
    }
    
    int64_t distance_154361 = sub64(max_mult_154354, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_171475, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171478, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171481, &mem_171438, "mem_171438") != 0)
        return 1;
    for (int64_t i_154367 = 0; i_154367 < distance_154361; i_154367++) {
        int64_t index_primexp_154371 = add64((int64_t) 1, i_154367);
        
        if (memblock_alloc(ctx, &mem_171483, bytes_171435, "mem_171483")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171483.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171481.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171485, bytes_171435, "mem_171485")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171485.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171478.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        if (memblock_alloc(ctx, &mem_171487, bytes_171433, "mem_171487")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_171487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_171475.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
        for (int64_t write_iter_171069 = 0; write_iter_171069 < nR_116273; write_iter_171069++) {
            int64_t write_iv_171074 = ((int64_t *) mem_171378)[write_iter_171069];
            int16_t write_iv_171075 = ((int16_t *) mem_171374)[write_iter_171069];
            int64_t write_iv_171076 = ((int64_t *) mem_171376)[write_iter_171069];
            int64_t zg_lhs_162583 = ((int64_t *) mem_171382)[write_iter_171069];
            bool cond_162584 = slt64(index_primexp_154371, zg_lhs_162583);
            int64_t lifted_lambda_res_162585;
            
            if (cond_162584) {
                int64_t zp_lhs_162679 = ((int64_t *) mem_171426)[write_iter_171069];
                int64_t lifted_lambda_res_t_res_162680 = add64(index_primexp_154371, zp_lhs_162679);
                
                lifted_lambda_res_162585 = lifted_lambda_res_t_res_162680;
            } else {
                lifted_lambda_res_162585 = (int64_t) -1;
            }
            
            int64_t tmp_162589 = add64(index_primexp_154371, write_iv_171074);
            
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int16_t *) mem_171487.mem)[lifted_lambda_res_162585] = write_iv_171075;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171485.mem)[lifted_lambda_res_162585] = write_iv_171076;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162585) && slt64(lifted_lambda_res_162585, defunc_res_162686)) {
                ((int64_t *) mem_171483.mem)[lifted_lambda_res_162585] = tmp_162589;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172012, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172013, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172014, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171475, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171478, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171481, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171514, &mem_param_171475, "mem_param_171475") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171513, &mem_param_171478, "mem_param_171478") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171512, &mem_param_171481, "mem_param_171481") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171516, bytes_171433, "mem_171516")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_171516.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171514.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171518, bytes_171435, "mem_171518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171518.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171513.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171520, bytes_171435, "mem_171520")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171520.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171512.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_162686});
    if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171518, "mem_171518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171520, "mem_171520") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171958, &mem_171516, "mem_171516") != 0)
        return 1;
    prim_out_171959 = defunc_res_162686;
    if (memblock_set(ctx, &*mem_out_p_172323, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172324, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172325, &mem_out_171958, "mem_out_171958") != 0)
        return 1;
    *out_prim_out_172326 = prim_out_171959;
    
  cleanup:
    {
        free(mem_171370);
        free(mem_171372);
        free(mem_171374);
        free(mem_171376);
        free(mem_171378);
        free(mem_171380);
        free(mem_171382);
        free(mem_171426);
        free(mem_171458);
        free(mem_171460);
        if (memblock_unref(ctx, &mem_171520, "mem_171520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171518, "mem_171518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171516, "mem_171516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172014, "mem_param_tmp_172014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172013, "mem_param_tmp_172013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172012, "mem_param_tmp_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171487, "mem_171487") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171485, "mem_171485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171483, "mem_171483") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171481, "mem_param_171481") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171478, "mem_param_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171475, "mem_param_171475") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171512, "ext_mem_171512") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171513, "ext_mem_171513") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171514, "ext_mem_171514") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171436, "mem_171436") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171362, "mem_171362") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171360, "mem_171360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171328, "mem_171328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171326, "mem_171326") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171986, "mem_param_tmp_171986") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171315, "mem_171315") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171313, "mem_param_171313") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171324, "ext_mem_171324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171301, "mem_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171299, "mem_param_171299") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171310, "ext_mem_171310") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171343, "ext_mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171346, "ext_mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171352, "ext_mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171296, "mem_param_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171357, "ext_mem_171357") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171358, "ext_mem_171358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171290, "mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171288, "mem_171288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171367, "ext_mem_171367") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171368, "ext_mem_171368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171280, "mem_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171276, "ext_mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171958, "mem_out_171958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172337, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149236, int64_t group_no_149237)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    bool bounds_invalid_upwards_161778 = slt64(group_no_149237, (int64_t) 0);
    bool valid_161779 = !bounds_invalid_upwards_161778;
    bool range_valid_c_161780;
    
    if (!valid_161779) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149237, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:41-43\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:325:21-46\n   #4  ftRelational.fut:325:5-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171276 = (int64_t) 4 * group_no_149237;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149237; nest_i_171957++) {
        ((int32_t *) mem_171277.mem)[nest_i_171957] = 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149236; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        int32_t pixel_171004 = ((int32_t *) eta_p_mem_171275.mem)[iter_171001];
        bool less_than_zzero_171005 = slt64(pixel_171003, (int64_t) 0);
        bool greater_than_sizze_171006 = sle64(group_no_149237, pixel_171003);
        bool outside_bounds_dim_171007 = less_than_zzero_171005 || greater_than_sizze_171006;
        
        if (!outside_bounds_dim_171007) {
            int32_t read_hist_171009 = ((int32_t *) mem_171277.mem)[pixel_171003];
            int32_t zp_res_161785 = add32(pixel_171004, read_hist_171009);
            
            ((int32_t *) mem_171277.mem)[pixel_171003] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172337, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172338, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149313, int64_t group_no_149314)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 4 * group_no_149314;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149314; nest_i_171957++) {
        ((int32_t *) mem_171278.mem)[nest_i_171957] = 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149313; iter_171001++) {
        int32_t pixel_171003 = ((int32_t *) eta_p_mem_171275.mem)[iter_171001];
        int32_t pixel_171004 = ((int32_t *) eta_p_mem_171276.mem)[iter_171001];
        int64_t pixel_171005 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        int32_t zt_res_161974 = mul32(pixel_171003, pixel_171004);
        bool less_than_zzero_171006 = slt64(pixel_171005, (int64_t) 0);
        bool greater_than_sizze_171007 = sle64(group_no_149314, pixel_171005);
        bool outside_bounds_dim_171008 = less_than_zzero_171006 || greater_than_sizze_171007;
        
        if (!outside_bounds_dim_171008) {
            int32_t read_hist_171010 = ((int32_t *) mem_171278.mem)[pixel_171005];
            int32_t zp_res_161785 = add32(zt_res_161974, read_hist_171010);
            
            ((int32_t *) mem_171278.mem)[pixel_171005] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172338, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172339, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149442, int64_t group_no_149443)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    bool bounds_invalid_upwards_161778 = slt64(group_no_149443, (int64_t) 0);
    bool valid_161779 = !bounds_invalid_upwards_161778;
    bool range_valid_c_161780;
    
    if (!valid_161779) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149443, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:41-43\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:328:22-48\n   #4  ftRelational.fut:328:5-48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171276 = (int64_t) 8 * group_no_149443;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149443; nest_i_171957++) {
        ((int64_t *) mem_171277.mem)[nest_i_171957] = (int64_t) 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149442; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        int64_t pixel_171004 = ((int64_t *) eta_p_mem_171275.mem)[iter_171001];
        bool less_than_zzero_171005 = slt64(pixel_171003, (int64_t) 0);
        bool greater_than_sizze_171006 = sle64(group_no_149443, pixel_171003);
        bool outside_bounds_dim_171007 = less_than_zzero_171005 || greater_than_sizze_171006;
        
        if (!outside_bounds_dim_171007) {
            int64_t read_hist_171009 = ((int64_t *) mem_171277.mem)[pixel_171003];
            int64_t zp_res_161785 = add64(pixel_171004, read_hist_171009);
            
            ((int64_t *) mem_171277.mem)[pixel_171003] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172339, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172340, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149509, int64_t group_no_149510)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 8 * group_no_149510;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149510; nest_i_171957++) {
        ((int64_t *) mem_171278.mem)[nest_i_171957] = (int64_t) 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149509; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) eta_p_mem_171275.mem)[iter_171001];
        int64_t pixel_171004 = ((int64_t *) eta_p_mem_171276.mem)[iter_171001];
        int64_t pixel_171005 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        int64_t zt_res_161974 = mul64(pixel_171003, pixel_171004);
        bool less_than_zzero_171006 = slt64(pixel_171005, (int64_t) 0);
        bool greater_than_sizze_171007 = sle64(group_no_149510, pixel_171005);
        bool outside_bounds_dim_171008 = less_than_zzero_171006 || greater_than_sizze_171007;
        
        if (!outside_bounds_dim_171008) {
            int64_t read_hist_171010 = ((int64_t *) mem_171278.mem)[pixel_171005];
            int64_t zp_res_161785 = add64(zt_res_161974, read_hist_171010);
            
            ((int64_t *) mem_171278.mem)[pixel_171005] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172340, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_172341, struct memblock eta_p_mem_171274, int64_t nz2080U_79529)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_res_161970;
    int64_t redout_171001 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171002 = 0; i_171002 < nz2080U_79529; i_171002++) {
        int64_t x_152814 = ((int64_t *) eta_p_mem_171274.mem)[i_171002];
        int64_t max_res_152817 = smax64(x_152814, redout_171001);
        int64_t redout_tmp_171957 = max_res_152817;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_161970 = redout_171001;
    prim_out_171956 = defunc_0_reduce_res_161970;
    *out_prim_out_172341 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_172342, struct memblock *mem_out_p_172343, struct memblock xs_mem_171274, int64_t n_113368, int64_t incr_113369)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172344 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172345 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172346 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172347 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172348 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172349 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172350 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172351 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172352 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172353 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_113368;
    bool cond_161239 = sle64(n_113368, (int64_t) 1);
    int64_t zs_lhs_161240 = sub64(n_113368, (int64_t) 1);
    int64_t zp_rhs_161241 = sdiv_safe64(zs_lhs_161240, (int64_t) 20);
    int64_t min_num_blocks_161242 = add64((int64_t) 1, zp_rhs_161241);
    bool loop_cond_161243 = slt64((int64_t) 1, min_num_blocks_161242);
    bool smallest_pow_2_geq_than_res_161244;
    int64_t smallest_pow_2_geq_than_res_161245;
    bool loop_while_161246;
    int64_t x_161247;
    
    loop_while_161246 = loop_cond_161243;
    x_161247 = (int64_t) 1;
    while (loop_while_161246) {
        int64_t loopres_161248 = mul64((int64_t) 2, x_161247);
        bool loop_cond_161249 = slt64(loopres_161248, min_num_blocks_161242);
        bool loop_while_tmp_171958 = loop_cond_161249;
        int64_t x_tmp_171959 = loopres_161248;
        
        loop_while_161246 = loop_while_tmp_171958;
        x_161247 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161244 = loop_while_161246;
    smallest_pow_2_geq_than_res_161245 = x_161247;
    
    bool zzero_161250 = smallest_pow_2_geq_than_res_161245 == (int64_t) 0;
    bool nonzzero_161251 = !zzero_161250;
    bool protect_assert_disj_161252 = cond_161239 || nonzzero_161251;
    bool nonzzero_cert_161253;
    
    if (!protect_assert_disj_161252) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:144:31-35\n   #5  ftRelational.fut:143:5-144:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161254 = sdiv_safe64(zs_lhs_161240, smallest_pow_2_geq_than_res_161245);
    int64_t block_sizze_161255 = add64((int64_t) 1, zp_rhs_161254);
    bool y_161261 = slt64((int64_t) 0, n_113368);
    bool protect_assert_disj_171871 = cond_161239 || y_161261;
    bool index_certs_161262;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_113368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:144:31-35\n   #5  ftRelational.fut:143:5-144:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161276 = slt64(smallest_pow_2_geq_than_res_161245, (int64_t) 0);
    bool valid_161277 = !bounds_invalid_upwards_161276;
    bool protect_assert_disj_171879 = cond_161239 || valid_161277;
    bool range_valid_c_161278;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161245, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:144:31-35\n   #6  ftRelational.fut:143:5-144:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161280 = slt64(block_sizze_161255, (int64_t) 0);
    bool valid_161281 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_171881 = cond_161239 || valid_161281;
    bool range_valid_c_161282;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161255, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161284 = sle64(block_sizze_161255, (int64_t) 1);
    int64_t tmp_161285 = sub64(block_sizze_161255, (int64_t) 2);
    bool bounds_invalid_upwards_161286 = slt64(tmp_161285, (int64_t) 0);
    bool valid_161288 = !bounds_invalid_upwards_161286;
    bool protect_assert_disj_161289 = cond_161284 || valid_161288;
    bool protect_assert_disj_171883 = cond_161239 || protect_assert_disj_161289;
    bool range_valid_c_161290;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161285, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_16342(ctx, &ext_mem_171275, xs_mem_171274, n_113368, incr_113369) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_113368; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161256 = smallest_pow_2_geq_than_res_161245 * block_sizze_161255;
    bool x_171866 = !cond_161239;
    int64_t greatest_divisor_leq_than_arg1_161259 = mul64((int64_t) 2, block_sizze_161255);
    int64_t merge_block_sizze_161260;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161259) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161260 = x_171868;
    } else {
        merge_block_sizze_161260 = (int64_t) 0;
    }
    
    double reduce_arg1_161263;
    
    if (x_171866) {
        double x_171872 = ((double *) xs_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161263 = x_171872;
    } else {
        reduce_arg1_161263 = 0.0;
    }
    
    double defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        double x_171874;
        int64_t x_171875;
        double redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161263;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_113368; i_171003++) {
            double x_161267 = ((double *) xs_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161273 = redout_171001 <= x_161267;
            double defunc_0_op_res_161274;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161274 = x_161267;
            } else {
                defunc_0_op_res_161274 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161275;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161275 = i_171003;
            } else {
                defunc_0_op_res_161275 = redout_171002;
            }
            
            double redout_tmp_171962 = defunc_0_op_res_161274;
            int64_t redout_tmp_171963 = defunc_0_op_res_161275;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = 0.0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161287 = add64((int64_t) 1, tmp_161285);
    int64_t binop_x_171278 = (int64_t) 8 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171279 = block_sizze_161255 * binop_x_171278;
    int64_t bytes_171292 = (int64_t) 8 * block_sizze_161255;
    bool loop_cond_161362 = slt64(block_sizze_161255, flat_dim_161256);
    bool zzero_161363 = merge_block_sizze_161260 == (int64_t) 0;
    bool nonzzero_161364 = !zzero_161363;
    
    if (cond_161239) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172344 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172344, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172345 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172345, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172346 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172346, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172347 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172347, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161245; i_171015++) {
            int64_t zp_lhs_161294 = mul64(block_sizze_161255, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161255; i_171008++) {
                int64_t k_161298 = add64(zp_lhs_161294, i_171008);
                bool cond_161299 = slt64(k_161298, n_113368);
                double lifted_lambda_res_161300;
                int64_t lifted_lambda_res_161301;
                
                if (cond_161299) {
                    bool x_161970 = sle64((int64_t) 0, k_161298);
                    bool bounds_check_161971 = cond_161299 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161298, "] out of bounds for array of shape [", (long long) n_113368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_161973 = ((double *) xs_mem_171274.mem)[k_161298];
                    
                    lifted_lambda_res_161300 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161301 = k_161298;
                } else {
                    lifted_lambda_res_161300 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161301 = defunc_0_reduce_res_162118;
                }
                ((double *) mem_171293)[i_171008] = lifted_lambda_res_161300;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161301;
            }
            if (!cond_161284) {
                for (int64_t i_161311 = 0; i_161311 < distance_161287; i_161311++) {
                    int64_t gt_arg1_161314 = add64((int64_t) 1, i_161311);
                    bool x_161315 = sle64((int64_t) 0, gt_arg1_161314);
                    bool y_161316 = slt64(gt_arg1_161314, block_sizze_161255);
                    bool bounds_check_161317 = x_161315 && y_161316;
                    bool index_certs_161318;
                    
                    if (!bounds_check_161317) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161314, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161320 = slt64(i_161311, block_sizze_161255);
                    bool index_certs_161321;
                    
                    if (!y_161320) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161311, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_161319 = ((double *) mem_171293)[gt_arg1_161314];
                    double gt_arg0_161322 = ((double *) mem_171293)[i_161311];
                    bool defunc_0_leq_res_161323 = gt_arg0_161322 <= gt_arg1_161319;
                    bool defunc_0_lifted_gt_res_161324 = !defunc_0_leq_res_161323;
                    bool s_161325;
                    int64_t s_161328;
                    bool loop_while_161329;
                    int64_t j_161332;
                    
                    loop_while_161329 = defunc_0_lifted_gt_res_161324;
                    j_161332 = i_161311;
                    while (loop_while_161329) {
                        bool x_161333 = sle64((int64_t) 0, j_161332);
                        bool y_161334 = slt64(j_161332, block_sizze_161255);
                        bool bounds_check_161335 = x_161333 && y_161334;
                        bool index_certs_161336;
                        
                        if (!bounds_check_161335) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161332, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161339 = add64((int64_t) 1, j_161332);
                        bool x_161340 = sle64((int64_t) 0, copy_arg0_161339);
                        bool y_161341 = slt64(copy_arg0_161339, block_sizze_161255);
                        bool bounds_check_161342 = x_161340 && y_161341;
                        bool index_certs_161343;
                        
                        if (!bounds_check_161342) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161339, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_161337 = ((double *) mem_171293)[j_161332];
                        int64_t copy_arg0_161338 = ((int64_t *) mem_171295)[j_161332];
                        double copy_arg0_161344 = ((double *) mem_171293)[copy_arg0_161339];
                        int64_t copy_arg0_161345 = ((int64_t *) mem_171295)[copy_arg0_161339];
                        
                        ((double *) mem_171293)[j_161332] = copy_arg0_161344;
                        ((int64_t *) mem_171295)[j_161332] = copy_arg0_161345;
                        ((double *) mem_171293)[copy_arg0_161339] = copy_arg0_161337;
                        ((int64_t *) mem_171295)[copy_arg0_161339] = copy_arg0_161338;
                        
                        int64_t tmp_161350 = sub64(j_161332, (int64_t) 1);
                        bool cond_161351 = sle64((int64_t) 0, tmp_161350);
                        bool loop_cond_161352;
                        
                        if (cond_161351) {
                            bool y_161975 = slt64(tmp_161350, block_sizze_161255);
                            bool bounds_check_161976 = cond_161351 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161350, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_161974 = ((double *) mem_171293)[j_161332];
                            double gt_arg0_161978 = ((double *) mem_171293)[tmp_161350];
                            bool defunc_0_leq_res_161979 = gt_arg0_161978 <= gt_arg1_161974;
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161352 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161352 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161352;
                        int64_t j_tmp_171973 = tmp_161350;
                        
                        loop_while_161329 = loop_while_tmp_171970;
                        j_161332 = j_tmp_171973;
                    }
                    s_161325 = loop_while_161329;
                    s_161328 = j_161332;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171280, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        if (memblock_alloc(ctx, &mem_171352, bytes_171279, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        
        int64_t data_161365;
        bool data_161366;
        int64_t data_161369;
        int64_t loop_dz2084Uz2082U_161370;
        bool loop_while_161371;
        int64_t stride_161374;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161370 = flat_dim_161256;
        loop_while_161371 = loop_cond_161362;
        stride_161374 = block_sizze_161255;
        while (loop_while_161371) {
            int64_t next_stride_161375 = mul64((int64_t) 2, stride_161374);
            bool zzero_161376 = next_stride_161375 == (int64_t) 0;
            bool nonzzero_161377 = !zzero_161376;
            bool nonzzero_cert_161378;
            
            if (!nonzzero_161377) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:144:31-35\n   #5  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161379 = sdiv64(flat_dim_161256, next_stride_161375);
            bool bounds_invalid_upwards_161380 = slt64(num_merges_161379, (int64_t) 0);
            bool valid_161381 = !bounds_invalid_upwards_161380;
            bool range_valid_c_161382;
            
            if (!valid_161381) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161379, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:144:31-35\n   #6  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161384 = sub64(next_stride_161375, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161385 = sle64((int64_t) 0, m_161384);
            bool cond_161387 = slt64(next_stride_161375, (int64_t) 10);
            bool protect_assert_disj_161388 = nonzzero_161364 || cond_161387;
            bool nonzzero_cert_161389;
            
            if (!protect_assert_disj_161388) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161390 = smod_safe64(next_stride_161375, merge_block_sizze_161260);
            bool num_blocks_161391 = zeze_lhs_161390 == (int64_t) 0;
            bool protect_assert_disj_161392 = cond_161387 || num_blocks_161391;
            bool assert_c_161393;
            
            if (!protect_assert_disj_161392) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161395 = sdiv_safe64(next_stride_161375, merge_block_sizze_161260);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396 = add64((int64_t) 1, num_blocks_161395);
            int64_t j_m_i_161397 = sub64(next_stride_161375, stride_161374);
            int64_t flat_dim_161398 = merge_block_sizze_161260 * num_blocks_161395;
            bool bounds_invalid_upwards_161399 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, (int64_t) 0);
            bool empty_slice_161400 = j_m_i_161397 == (int64_t) 0;
            int64_t m_161401 = sub64(j_m_i_161397, (int64_t) 1);
            bool zzero_lte_i_161402 = sle64((int64_t) 0, stride_161374);
            bool i_lte_j_161403 = sle64(stride_161374, next_stride_161375);
            bool empty_slice_161404 = stride_161374 == (int64_t) 0;
            int64_t m_161405 = sub64(stride_161374, (int64_t) 1);
            bool bounds_invalid_upwards_161406 = slt64(num_blocks_161395, (int64_t) 0);
            bool cond_161407 = slt64((int64_t) 0, stride_161374);
            bool valid_161408 = !bounds_invalid_upwards_161399;
            int64_t i_p_m_t_s_161409 = add64(stride_161374, m_161401);
            bool zzero_leq_i_p_m_t_s_161410 = sle64((int64_t) 0, m_161405);
            bool i_p_m_t_s_leq_w_161411 = slt64(m_161405, next_stride_161375);
            bool valid_161412 = !bounds_invalid_upwards_161406;
            bool i_p_m_t_s_leq_w_161413 = slt64(m_161384, flat_dim_161398);
            bool y_161414 = slt64((int64_t) 0, j_m_i_161397);
            bool protect_assert_disj_161415 = cond_161387 || valid_161408;
            bool range_valid_c_161416;
            
            if (!protect_assert_disj_161415) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:144:31-35\n   #10 ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161417 = sle64((int64_t) 0, i_p_m_t_s_161409);
            bool i_p_m_t_s_leq_w_161418 = slt64(i_p_m_t_s_161409, next_stride_161375);
            bool y_161419 = zzero_leq_i_p_m_t_s_161410 && i_p_m_t_s_leq_w_161411;
            bool protect_assert_disj_161420 = cond_161387 || valid_161412;
            bool range_valid_c_161421;
            
            if (!protect_assert_disj_161420) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161395, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161422 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161413;
            bool y_161423 = zzero_lte_i_161402 && i_p_m_t_s_leq_w_161418;
            bool forwards_ok_161424 = zzero_lte_i_161402 && y_161419;
            bool ok_or_empty_161425 = zzero_161376 || y_161422;
            bool protect_assert_disj_161426 = cond_161407 || y_161414;
            bool y_161427 = zzero_leq_i_p_m_t_s_161417 && y_161423;
            bool ok_or_empty_161428 = empty_slice_161404 || forwards_ok_161424;
            bool protect_assert_disj_161429 = cond_161387 || ok_or_empty_161425;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) flat_dim_161398, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161431 = !cond_161387;
            bool protect_assert_disj_161432 = protect_assert_disj_161426 || loop_not_taken_161431;
            bool index_certs_161433;
            
            if (!protect_assert_disj_161432) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:144:31-35\n   #10 ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161434 = i_lte_j_161403 && y_161427;
            bool protect_assert_disj_161435 = cond_161387 || ok_or_empty_161428;
            bool index_certs_161436;
            
            if (!protect_assert_disj_161435) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:144:31-35\n   #11 ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161437 = ok_or_empty_161428 || loop_not_taken_161431;
            bool index_certs_161438;
            
            if (!protect_assert_disj_161437) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161439 = empty_slice_161400 || forwards_ok_161434;
            bool protect_assert_disj_161440 = cond_161387 || ok_or_empty_161439;
            bool index_certs_161441;
            
            if (!protect_assert_disj_161440) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:144:31-35\n   #11 ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161442 = loop_not_taken_161431 || ok_or_empty_161439;
            bool index_certs_161443;
            
            if (!protect_assert_disj_161442) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 8 * num_merges_161379;
            int64_t bytes_171361 = next_stride_161375 * binop_x_171360;
            bool i_lte_j_161386 = sle64((int64_t) 0, next_stride_161375);
            
            if (mem_171362_cached_sizze_172348 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172348, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172349 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172349, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396;
            int64_t binop_x_171390 = (int64_t) 8 * num_blocks_161395;
            int64_t bytes_171391 = merge_block_sizze_161260 * binop_x_171390;
            int64_t bytes_171436 = (int64_t) 16 * stride_161374;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161379; i_171036++) {
                int64_t start_161447 = mul64(next_stride_161375, i_171036);
                int64_t j_m_i_161448 = sub64(loop_dz2084Uz2082U_161370, start_161447);
                bool empty_slice_161449 = j_m_i_161448 == (int64_t) 0;
                int64_t m_161450 = sub64(j_m_i_161448, (int64_t) 1);
                int64_t i_p_m_t_s_161451 = add64(start_161447, m_161450);
                bool zzero_leq_i_p_m_t_s_161452 = sle64((int64_t) 0, i_p_m_t_s_161451);
                bool i_p_m_t_s_leq_w_161453 = slt64(i_p_m_t_s_161451, loop_dz2084Uz2082U_161370);
                bool zzero_lte_i_161454 = sle64((int64_t) 0, start_161447);
                bool i_lte_j_161455 = sle64(start_161447, loop_dz2084Uz2082U_161370);
                bool y_161456 = i_p_m_t_s_leq_w_161453 && zzero_lte_i_161454;
                bool y_161457 = zzero_leq_i_p_m_t_s_161452 && y_161456;
                bool forwards_ok_161458 = i_lte_j_161455 && y_161457;
                bool ok_or_empty_161459 = empty_slice_161449 || forwards_ok_161458;
                bool index_certs_161460;
                
                if (!ok_or_empty_161459) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161447, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161370, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161461 = slt64(m_161384, j_m_i_161448);
                bool y_161462 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161461;
                bool forwards_ok_161463 = i_lte_j_161386 && y_161462;
                bool ok_or_empty_161464 = zzero_161376 || forwards_ok_161463;
                bool index_certs_161465;
                
                if (!ok_or_empty_161464) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) j_m_i_161448, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:144:31-35\n   #8  ftRelational.fut:143:5-144:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161387) {
                    double dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161407) {
                        double head_res_162008 = ((double *) mem_param_171356.mem)[start_161447];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161447];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161374 + start_161447;
                        double head_res_162011 = ((double *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161375; nest_i_171983++) {
                        ((double *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171436, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161375; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161375; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161397;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161374);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161397);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161374 + j_162022;
                                int64_t slice_162032 = start_161447 + slice_162031;
                                double leq_arg1_162033 = ((double *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161447 + i_162019;
                                double leq_arg0_162038 = ((double *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = leq_arg0_162038 <= leq_arg1_162033;
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        double loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161374);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161447 + i_162019;
                            double tmp_162049 = ((double *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161397);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:144:31-35\n   #9  ftRelational.fut:143:5-144:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161374 + j_162022;
                            int64_t slice_162056 = start_161447 + slice_162055;
                            double tmp_162057 = ((double *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((double *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172350 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172350, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172351 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172351, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396; i_171022++) {
                        int64_t split_count_arg3_161527 = mul64(merge_block_sizze_161260, i_171022);
                        int64_t defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161528, &defunc_0_split_count_res_161529, &defunc_0_split_count_res_161530, &defunc_0_split_count_res_161531, &defunc_0_split_count_res_161532, (int64_t) 0, stride_161374, (int64_t) 0, j_m_i_161397, split_count_arg3_161527) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161533 = slt64((int64_t) 0, defunc_0_split_count_res_161532);
                        bool defunc_0_split_count_res_161534;
                        int64_t defunc_0_split_count_res_161535;
                        int64_t defunc_0_split_count_res_161536;
                        int64_t defunc_0_split_count_res_161537;
                        int64_t defunc_0_split_count_res_161538;
                        int64_t defunc_0_split_count_res_161539;
                        bool loop_while_161540;
                        int64_t ss_161541;
                        int64_t ss_161542;
                        int64_t tt_161543;
                        int64_t tt_161544;
                        int64_t count_161545;
                        
                        loop_while_161540 = loop_cond_161533;
                        ss_161541 = defunc_0_split_count_res_161528;
                        ss_161542 = defunc_0_split_count_res_161529;
                        tt_161543 = defunc_0_split_count_res_161530;
                        tt_161544 = defunc_0_split_count_res_161531;
                        count_161545 = defunc_0_split_count_res_161532;
                        while (loop_while_161540) {
                            int64_t zlze_lhs_161546 = sub64(ss_161542, ss_161541);
                            bool cond_161547 = sle64(zlze_lhs_161546, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161548;
                            int64_t defunc_0_lifted_step_res_161549;
                            int64_t defunc_0_lifted_step_res_161550;
                            int64_t defunc_0_lifted_step_res_161551;
                            
                            if (cond_161547) {
                                int64_t tmp_162061 = add64(tt_161543, count_161545);
                                
                                defunc_0_lifted_step_res_161548 = ss_161541;
                                defunc_0_lifted_step_res_161549 = tmp_162061;
                                defunc_0_lifted_step_res_161550 = tt_161544;
                                defunc_0_lifted_step_res_161551 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161553 = sub64(tt_161544, tt_161543);
                                bool cond_161554 = sle64(zlze_lhs_161553, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161555;
                                int64_t defunc_0_lifted_step_res_f_res_161556;
                                int64_t defunc_0_lifted_step_res_f_res_161557;
                                int64_t defunc_0_lifted_step_res_f_res_161558;
                                
                                if (cond_161554) {
                                    int64_t tmp_162062 = add64(ss_161541, count_161545);
                                    
                                    defunc_0_lifted_step_res_f_res_161555 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161556 = tt_161543;
                                    defunc_0_lifted_step_res_f_res_161557 = tt_161544;
                                    defunc_0_lifted_step_res_f_res_161558 = (int64_t) 0;
                                } else {
                                    bool cond_161560 = count_161545 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161561;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161562;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161563;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161564;
                                    
                                    if (cond_161560) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161541);
                                        bool y_162065 = slt64(ss_161541, stride_161374);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161541, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:144:31-35\n   #13 ftRelational.fut:143:5-144:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161543);
                                        bool y_162071 = slt64(tt_161543, j_m_i_161397);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161543, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:144:31-35\n   #13 ftRelational.fut:143:5-144:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161447 + ss_161541;
                                        double leq_arg1_162069 = ((double *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161374 + tt_161543;
                                        int64_t slice_162075 = start_161447 + slice_162074;
                                        double leq_arg0_162076 = ((double *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = leq_arg0_162076 <= leq_arg1_162069;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161543);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161541;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161541);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161543;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = tt_161544;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = (int64_t) 0;
                                    } else {
                                        int64_t m_161583 = sdiv64(count_161545, (int64_t) 2);
                                        int64_t n_161584 = sub64(count_161545, m_161583);
                                        bool cond_161585 = n_161584 == (int64_t) 0;
                                        int64_t zgze_lhs_161586 = add64(ss_161541, m_161583);
                                        bool cond_f_res_161587 = sle64(ss_161542, zgze_lhs_161586);
                                        bool x_161588 = !cond_161585;
                                        bool y_161589 = cond_f_res_161587 && x_161588;
                                        bool cond_161590 = cond_161585 || y_161589;
                                        bool leq_y_x_161591;
                                        
                                        if (cond_161590) {
                                            leq_y_x_161591 = 1;
                                        } else {
                                            bool x_161592 = sle64((int64_t) 0, zgze_lhs_161586);
                                            bool y_161593 = slt64(zgze_lhs_161586, stride_161374);
                                            bool bounds_check_161594 = x_161592 && y_161593;
                                            bool index_certs_161595;
                                            
                                            if (!bounds_check_161594) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161586, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:144:31-35\n   #13 ftRelational.fut:143:5-144:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161598 = add64(tt_161543, n_161584);
                                            int64_t leq_arg0_161599 = sub64(zm_lhs_161598, (int64_t) 1);
                                            bool x_161600 = sle64((int64_t) 0, leq_arg0_161599);
                                            bool y_161601 = slt64(leq_arg0_161599, j_m_i_161397);
                                            bool bounds_check_161602 = x_161600 && y_161601;
                                            bool index_certs_161603;
                                            
                                            if (!bounds_check_161602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161599, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:144:31-35\n   #13 ftRelational.fut:143:5-144:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161596 = start_161447 + zgze_lhs_161586;
                                            double leq_arg1_161597 = ((double *) mem_param_171356.mem)[slice_161596];
                                            int64_t slice_161604 = stride_161374 + leq_arg0_161599;
                                            int64_t slice_161605 = start_161447 + slice_161604;
                                            double leq_arg0_161606 = ((double *) mem_param_171356.mem)[slice_161605];
                                            bool defunc_0_leq_res_161607 = leq_arg0_161606 <= leq_arg1_161597;
                                            
                                            leq_y_x_161591 = defunc_0_leq_res_161607;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                        
                                        if (leq_y_x_161591) {
                                            int64_t tmp_162082 = add64(tt_161543, n_161584);
                                            int64_t tmp_162083 = sub64(count_161545, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tt_161544;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = tmp_162083;
                                        } else {
                                            int64_t tmp_161613 = add64(tt_161543, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tt_161543;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tmp_161613;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = count_161545;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = ss_161541;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                    }
                                    defunc_0_lifted_step_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_161561;
                                    defunc_0_lifted_step_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_161562;
                                    defunc_0_lifted_step_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_161563;
                                    defunc_0_lifted_step_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_161564;
                                }
                                defunc_0_lifted_step_res_161548 = defunc_0_lifted_step_res_f_res_161555;
                                defunc_0_lifted_step_res_161549 = defunc_0_lifted_step_res_f_res_161556;
                                defunc_0_lifted_step_res_161550 = defunc_0_lifted_step_res_f_res_161557;
                                defunc_0_lifted_step_res_161551 = defunc_0_lifted_step_res_f_res_161558;
                            }
                            
                            int64_t loopres_161614;
                            int64_t loopres_161615;
                            int64_t loopres_161616;
                            int64_t loopres_161617;
                            int64_t loopres_161618;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161614, &loopres_161615, &loopres_161616, &loopres_161617, &loopres_161618, defunc_0_lifted_step_res_161548, ss_161542, defunc_0_lifted_step_res_161549, defunc_0_lifted_step_res_161550, defunc_0_lifted_step_res_161551) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161619 = slt64((int64_t) 0, loopres_161618);
                            bool loop_while_tmp_171990 = loop_cond_161619;
                            int64_t ss_tmp_171991 = loopres_161614;
                            int64_t ss_tmp_171992 = loopres_161615;
                            int64_t tt_tmp_171993 = loopres_161616;
                            int64_t tt_tmp_171994 = loopres_161617;
                            int64_t count_tmp_171995 = loopres_161618;
                            
                            loop_while_161540 = loop_while_tmp_171990;
                            ss_161541 = ss_tmp_171991;
                            ss_161542 = ss_tmp_171992;
                            tt_161543 = tt_tmp_171993;
                            tt_161544 = tt_tmp_171994;
                            count_161545 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161534 = loop_while_161540;
                        defunc_0_split_count_res_161535 = ss_161541;
                        defunc_0_split_count_res_161536 = ss_161542;
                        defunc_0_split_count_res_161537 = tt_161543;
                        defunc_0_split_count_res_161538 = tt_161544;
                        defunc_0_split_count_res_161539 = count_161545;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161535;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161537;
                    }
                    if (mem_171392_cached_sizze_172352 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172352, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172353 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172353, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161395; i_171029++) {
                        bool y_161625 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool index_certs_161627;
                        
                        if (!y_161625) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:144:31-35\n   #10 ftRelational.fut:143:5-144:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161628 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161630 = add64((int64_t) 1, i_171029);
                        bool x_161631 = sle64((int64_t) 0, tmp_161630);
                        bool y_161632 = slt64(tmp_161630, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool bounds_check_161633 = x_161631 && y_161632;
                        bool index_certs_161634;
                        
                        if (!bounds_check_161633) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161630, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:144:31-35\n   #10 ftRelational.fut:143:5-144:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161635 = ((int64_t *) mem_171375)[tmp_161630];
                        int64_t defunc_0_f_res_161636 = ((int64_t *) mem_171377)[tmp_161630];
                        int64_t merge_sequential_arg2_161637 = add64(stride_161374, defunc_0_f_res_161629);
                        int64_t merge_sequential_arg2_161638 = add64(stride_161374, defunc_0_f_res_161636);
                        int64_t j_m_i_161639 = sub64(merge_sequential_arg2_161638, merge_sequential_arg2_161637);
                        bool empty_slice_161640 = j_m_i_161639 == (int64_t) 0;
                        int64_t m_161641 = sub64(j_m_i_161639, (int64_t) 1);
                        int64_t i_p_m_t_s_161642 = add64(merge_sequential_arg2_161637, m_161641);
                        bool zzero_leq_i_p_m_t_s_161643 = sle64((int64_t) 0, i_p_m_t_s_161642);
                        bool i_p_m_t_s_leq_w_161644 = slt64(i_p_m_t_s_161642, next_stride_161375);
                        bool zzero_lte_i_161645 = sle64((int64_t) 0, merge_sequential_arg2_161637);
                        bool i_lte_j_161646 = sle64(merge_sequential_arg2_161637, merge_sequential_arg2_161638);
                        bool y_161647 = i_p_m_t_s_leq_w_161644 && zzero_lte_i_161645;
                        bool y_161648 = zzero_leq_i_p_m_t_s_161643 && y_161647;
                        bool forwards_ok_161649 = i_lte_j_161646 && y_161648;
                        bool ok_or_empty_161650 = empty_slice_161640 || forwards_ok_161649;
                        bool index_certs_161651;
                        
                        if (!ok_or_empty_161650) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161637, ":", (long long) merge_sequential_arg2_161638, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:144:31-35\n   #10 ftRelational.fut:143:5-144:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161652 = sub64(defunc_0_f_res_161635, defunc_0_f_res_161628);
                        bool empty_slice_161653 = j_m_i_161652 == (int64_t) 0;
                        int64_t m_161654 = sub64(j_m_i_161652, (int64_t) 1);
                        int64_t i_p_m_t_s_161655 = add64(defunc_0_f_res_161628, m_161654);
                        bool zzero_leq_i_p_m_t_s_161656 = sle64((int64_t) 0, i_p_m_t_s_161655);
                        bool i_p_m_t_s_leq_w_161657 = slt64(i_p_m_t_s_161655, next_stride_161375);
                        bool zzero_lte_i_161658 = sle64((int64_t) 0, defunc_0_f_res_161628);
                        bool i_lte_j_161659 = sle64(defunc_0_f_res_161628, defunc_0_f_res_161635);
                        bool y_161660 = i_p_m_t_s_leq_w_161657 && zzero_lte_i_161658;
                        bool y_161661 = zzero_leq_i_p_m_t_s_161656 && y_161660;
                        bool forwards_ok_161662 = i_lte_j_161659 && y_161661;
                        bool ok_or_empty_161663 = empty_slice_161653 || forwards_ok_161662;
                        bool index_certs_161664;
                        
                        if (!ok_or_empty_161663) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161628, ":", (long long) defunc_0_f_res_161635, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:144:31-35\n   #10 ftRelational.fut:143:5-144:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161665 = slt64((int64_t) 0, j_m_i_161652);
                        double dummy_161666;
                        int64_t dummy_161667;
                        
                        if (cond_161665) {
                            bool index_certs_162084;
                            
                            if (!cond_161665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:144:31-35\n   #12 ftRelational.fut:143:5-144:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161447 + defunc_0_f_res_161628;
                            double head_res_162086 = ((double *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161666 = head_res_162086;
                            dummy_161667 = head_res_162087;
                        } else {
                            bool y_161672 = slt64((int64_t) 0, j_m_i_161639);
                            bool index_certs_161673;
                            
                            if (!y_161672) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:144:31-35\n   #12 ftRelational.fut:143:5-144:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161674 = start_161447 + merge_sequential_arg2_161637;
                            double head_res_161675 = ((double *) mem_param_171356.mem)[slice_161674];
                            int64_t head_res_161676 = ((int64_t *) mem_param_171359.mem)[slice_161674];
                            
                            dummy_161666 = head_res_161675;
                            dummy_161667 = head_res_161676;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161260; nest_i_171998++) {
                            ((double *) mem_171392)[i_171029 * merge_block_sizze_161260 + nest_i_171998] = dummy_161666;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161260; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + nest_i_171999] = dummy_161667;
                        }
                        
                        int64_t data_161679;
                        int64_t i_161683 = (int64_t) 0;
                        
                        for (int64_t k_161682 = 0; k_161682 < merge_block_sizze_161260; k_161682++) {
                            int64_t j_161686 = sub64(k_161682, i_161683);
                            bool cond_161687 = j_161686 == j_m_i_161639;
                            bool cond_161688;
                            
                            if (cond_161687) {
                                cond_161688 = 1;
                            } else {
                                bool cond_161689 = slt64(i_161683, j_m_i_161652);
                                bool cond_f_res_161690;
                                
                                if (cond_161689) {
                                    bool x_162088 = sle64((int64_t) 0, j_161686);
                                    bool y_162089 = slt64(j_161686, j_m_i_161639);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:144:31-35\n   #11 ftRelational.fut:143:5-144:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161683);
                                    bool bounds_check_162096 = cond_161689 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:144:31-35\n   #11 ftRelational.fut:143:5-144:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161637 + j_161686;
                                    int64_t slice_162093 = start_161447 + slice_162092;
                                    double leq_arg1_162094 = ((double *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161628 + i_161683;
                                    int64_t slice_162099 = start_161447 + slice_162098;
                                    double leq_arg0_162100 = ((double *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = leq_arg0_162100 <= leq_arg1_162094;
                                    
                                    cond_f_res_161690 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161690 = 0;
                                }
                                cond_161688 = cond_f_res_161690;
                            }
                            
                            int64_t loopres_161705;
                            double loopres_161706;
                            int64_t loopres_161707;
                            
                            if (cond_161688) {
                                bool x_162103 = sle64((int64_t) 0, i_161683);
                                bool y_162104 = slt64(i_161683, j_m_i_161652);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:144:31-35\n   #11 ftRelational.fut:143:5-144:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161683);
                                int64_t slice_162107 = defunc_0_f_res_161628 + i_161683;
                                int64_t slice_162108 = start_161447 + slice_162107;
                                double tmp_162109 = ((double *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161705 = tmp_162102;
                                loopres_161706 = tmp_162109;
                                loopres_161707 = tmp_162110;
                            } else {
                                bool x_161717 = sle64((int64_t) 0, j_161686);
                                bool y_161718 = slt64(j_161686, j_m_i_161639);
                                bool bounds_check_161719 = x_161717 && y_161718;
                                bool index_certs_161720;
                                
                                if (!bounds_check_161719) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:144:31-35\n   #11 ftRelational.fut:143:5-144:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161721 = merge_sequential_arg2_161637 + j_161686;
                                int64_t slice_161722 = start_161447 + slice_161721;
                                double tmp_161723 = ((double *) mem_param_171356.mem)[slice_161722];
                                int64_t tmp_161724 = ((int64_t *) mem_param_171359.mem)[slice_161722];
                                
                                loopres_161705 = i_161683;
                                loopres_161706 = tmp_161723;
                                loopres_161707 = tmp_161724;
                            }
                            ((double *) mem_171392)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161706;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161707;
                            
                            int64_t i_tmp_172000 = loopres_161705;
                            
                            i_161683 = i_tmp_172000;
                        }
                        data_161679 = i_161683;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171391, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161731 = next_stride_161375 * num_merges_161379;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            if (memblock_alloc(ctx, &mem_171472, bytes_171361, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            
            bool loop_cond_161734 = slt64(next_stride_161375, flat_dim_161256);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161731;
            bool loop_while_tmp_171977 = loop_cond_161734;
            int64_t stride_tmp_171980 = next_stride_161375;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161370 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161371 = loop_while_tmp_171977;
            stride_161374 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161365 = loop_dz2084Uz2082U_161370;
        data_161366 = loop_while_161371;
        data_161369 = stride_161374;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161735 = n_113368 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161736 = sle64((int64_t) 0, zs_lhs_161240);
        bool i_p_m_t_s_leq_w_161737 = slt64(zs_lhs_161240, data_161365);
        bool y_161738 = zzero_leq_i_p_m_t_s_161736 && i_p_m_t_s_leq_w_161737;
        bool ok_or_empty_161739 = empty_slice_161735 || y_161738;
        bool index_certs_161740;
        
        if (!ok_or_empty_161739) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_113368, "] out of bounds for array of shape [", (long long) data_161365, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:144:31-35\n   #6  ftRelational.fut:143:5-144:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171276, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_113368; i_171043++) {
        int64_t eta_p_161748 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161749 = sle64((int64_t) 0, eta_p_161748);
        bool y_161750 = slt64(eta_p_161748, n_113368);
        bool bounds_check_161751 = x_161749 && y_161750;
        bool index_certs_161752;
        
        if (!bounds_check_161751) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161748, "] out of bounds for array of shape [", (long long) n_113368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:144:31-35\n   #5  ftRelational.fut:143:5-144:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_161753 = ((int64_t *) ext_mem_171275.mem)[eta_p_161748];
        double lifted_lambda_res_161754 = ((double *) xs_mem_171274.mem)[eta_p_161748];
        
        ((int64_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161753;
        ((double *) mem_171486.mem)[i_171043] = lifted_lambda_res_161754;
    }
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172342, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172343, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_172354, struct memblock *mem_out_p_172355, struct memblock xs_mem_171274, int64_t n_111223, int64_t incr_111224)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172356 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172357 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172358 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172359 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172360 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172361 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172362 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172363 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172364 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172365 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_111223;
    bool cond_161239 = sle64(n_111223, (int64_t) 1);
    int64_t zs_lhs_161240 = sub64(n_111223, (int64_t) 1);
    int64_t zp_rhs_161241 = sdiv_safe64(zs_lhs_161240, (int64_t) 20);
    int64_t min_num_blocks_161242 = add64((int64_t) 1, zp_rhs_161241);
    bool loop_cond_161243 = slt64((int64_t) 1, min_num_blocks_161242);
    bool smallest_pow_2_geq_than_res_161244;
    int64_t smallest_pow_2_geq_than_res_161245;
    bool loop_while_161246;
    int64_t x_161247;
    
    loop_while_161246 = loop_cond_161243;
    x_161247 = (int64_t) 1;
    while (loop_while_161246) {
        int64_t loopres_161248 = mul64((int64_t) 2, x_161247);
        bool loop_cond_161249 = slt64(loopres_161248, min_num_blocks_161242);
        bool loop_while_tmp_171958 = loop_cond_161249;
        int64_t x_tmp_171959 = loopres_161248;
        
        loop_while_161246 = loop_while_tmp_171958;
        x_161247 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161244 = loop_while_161246;
    smallest_pow_2_geq_than_res_161245 = x_161247;
    
    bool zzero_161250 = smallest_pow_2_geq_than_res_161245 == (int64_t) 0;
    bool nonzzero_161251 = !zzero_161250;
    bool protect_assert_disj_161252 = cond_161239 || nonzzero_161251;
    bool nonzzero_cert_161253;
    
    if (!protect_assert_disj_161252) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:142:31-35\n   #5  ftRelational.fut:141:5-142:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161254 = sdiv_safe64(zs_lhs_161240, smallest_pow_2_geq_than_res_161245);
    int64_t block_sizze_161255 = add64((int64_t) 1, zp_rhs_161254);
    bool y_161261 = slt64((int64_t) 0, n_111223);
    bool protect_assert_disj_171871 = cond_161239 || y_161261;
    bool index_certs_161262;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_111223, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:142:31-35\n   #5  ftRelational.fut:141:5-142:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161276 = slt64(smallest_pow_2_geq_than_res_161245, (int64_t) 0);
    bool valid_161277 = !bounds_invalid_upwards_161276;
    bool protect_assert_disj_171879 = cond_161239 || valid_161277;
    bool range_valid_c_161278;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161245, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:142:31-35\n   #6  ftRelational.fut:141:5-142:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161280 = slt64(block_sizze_161255, (int64_t) 0);
    bool valid_161281 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_171881 = cond_161239 || valid_161281;
    bool range_valid_c_161282;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161255, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161284 = sle64(block_sizze_161255, (int64_t) 1);
    int64_t tmp_161285 = sub64(block_sizze_161255, (int64_t) 2);
    bool bounds_invalid_upwards_161286 = slt64(tmp_161285, (int64_t) 0);
    bool valid_161288 = !bounds_invalid_upwards_161286;
    bool protect_assert_disj_161289 = cond_161284 || valid_161288;
    bool protect_assert_disj_171883 = cond_161239 || protect_assert_disj_161289;
    bool range_valid_c_161290;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161285, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171485 = (int64_t) 4 * n_111223;
    
    if (futrts_indicesWithIncrement_16321(ctx, &ext_mem_171275, xs_mem_171274, n_111223, incr_111224) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_111223; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161256 = smallest_pow_2_geq_than_res_161245 * block_sizze_161255;
    bool x_171866 = !cond_161239;
    int64_t greatest_divisor_leq_than_arg1_161259 = mul64((int64_t) 2, block_sizze_161255);
    int64_t merge_block_sizze_161260;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161259) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161260 = x_171868;
    } else {
        merge_block_sizze_161260 = (int64_t) 0;
    }
    
    float reduce_arg1_161263;
    
    if (x_171866) {
        float x_171872 = ((float *) xs_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161263 = x_171872;
    } else {
        reduce_arg1_161263 = 0.0F;
    }
    
    float defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        float x_171874;
        int64_t x_171875;
        float redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161263;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_111223; i_171003++) {
            float x_161267 = ((float *) xs_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161273 = redout_171001 <= x_161267;
            float defunc_0_op_res_161274;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161274 = x_161267;
            } else {
                defunc_0_op_res_161274 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161275;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161275 = i_171003;
            } else {
                defunc_0_op_res_161275 = redout_171002;
            }
            
            float redout_tmp_171962 = defunc_0_op_res_161274;
            int64_t redout_tmp_171963 = defunc_0_op_res_161275;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = 0.0F;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161287 = add64((int64_t) 1, tmp_161285);
    int64_t binop_x_171278 = (int64_t) 4 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171279 = block_sizze_161255 * binop_x_171278;
    int64_t binop_x_171281 = (int64_t) 8 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171282 = block_sizze_161255 * binop_x_171281;
    int64_t bytes_171292 = (int64_t) 4 * block_sizze_161255;
    int64_t bytes_171294 = (int64_t) 8 * block_sizze_161255;
    bool loop_cond_161362 = slt64(block_sizze_161255, flat_dim_161256);
    bool zzero_161363 = merge_block_sizze_161260 == (int64_t) 0;
    bool nonzzero_161364 = !zzero_161363;
    
    if (cond_161239) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172356 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172356, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172357 < bytes_171282) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172357, bytes_171282);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172358 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172358, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172359 < bytes_171294) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172359, bytes_171294);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161245; i_171015++) {
            int64_t zp_lhs_161294 = mul64(block_sizze_161255, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161255; i_171008++) {
                int64_t k_161298 = add64(zp_lhs_161294, i_171008);
                bool cond_161299 = slt64(k_161298, n_111223);
                float lifted_lambda_res_161300;
                int64_t lifted_lambda_res_161301;
                
                if (cond_161299) {
                    bool x_161970 = sle64((int64_t) 0, k_161298);
                    bool bounds_check_161971 = cond_161299 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161298, "] out of bounds for array of shape [", (long long) n_111223, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_161973 = ((float *) xs_mem_171274.mem)[k_161298];
                    
                    lifted_lambda_res_161300 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161301 = k_161298;
                } else {
                    lifted_lambda_res_161300 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161301 = defunc_0_reduce_res_162118;
                }
                ((float *) mem_171293)[i_171008] = lifted_lambda_res_161300;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161301;
            }
            if (!cond_161284) {
                for (int64_t i_161311 = 0; i_161311 < distance_161287; i_161311++) {
                    int64_t gt_arg1_161314 = add64((int64_t) 1, i_161311);
                    bool x_161315 = sle64((int64_t) 0, gt_arg1_161314);
                    bool y_161316 = slt64(gt_arg1_161314, block_sizze_161255);
                    bool bounds_check_161317 = x_161315 && y_161316;
                    bool index_certs_161318;
                    
                    if (!bounds_check_161317) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161314, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161320 = slt64(i_161311, block_sizze_161255);
                    bool index_certs_161321;
                    
                    if (!y_161320) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161311, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_161319 = ((float *) mem_171293)[gt_arg1_161314];
                    float gt_arg0_161322 = ((float *) mem_171293)[i_161311];
                    bool defunc_0_leq_res_161323 = gt_arg0_161322 <= gt_arg1_161319;
                    bool defunc_0_lifted_gt_res_161324 = !defunc_0_leq_res_161323;
                    bool s_161325;
                    int64_t s_161328;
                    bool loop_while_161329;
                    int64_t j_161332;
                    
                    loop_while_161329 = defunc_0_lifted_gt_res_161324;
                    j_161332 = i_161311;
                    while (loop_while_161329) {
                        bool x_161333 = sle64((int64_t) 0, j_161332);
                        bool y_161334 = slt64(j_161332, block_sizze_161255);
                        bool bounds_check_161335 = x_161333 && y_161334;
                        bool index_certs_161336;
                        
                        if (!bounds_check_161335) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161332, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161339 = add64((int64_t) 1, j_161332);
                        bool x_161340 = sle64((int64_t) 0, copy_arg0_161339);
                        bool y_161341 = slt64(copy_arg0_161339, block_sizze_161255);
                        bool bounds_check_161342 = x_161340 && y_161341;
                        bool index_certs_161343;
                        
                        if (!bounds_check_161342) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161339, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_161337 = ((float *) mem_171293)[j_161332];
                        int64_t copy_arg0_161338 = ((int64_t *) mem_171295)[j_161332];
                        float copy_arg0_161344 = ((float *) mem_171293)[copy_arg0_161339];
                        int64_t copy_arg0_161345 = ((int64_t *) mem_171295)[copy_arg0_161339];
                        
                        ((float *) mem_171293)[j_161332] = copy_arg0_161344;
                        ((int64_t *) mem_171295)[j_161332] = copy_arg0_161345;
                        ((float *) mem_171293)[copy_arg0_161339] = copy_arg0_161337;
                        ((int64_t *) mem_171295)[copy_arg0_161339] = copy_arg0_161338;
                        
                        int64_t tmp_161350 = sub64(j_161332, (int64_t) 1);
                        bool cond_161351 = sle64((int64_t) 0, tmp_161350);
                        bool loop_cond_161352;
                        
                        if (cond_161351) {
                            bool y_161975 = slt64(tmp_161350, block_sizze_161255);
                            bool bounds_check_161976 = cond_161351 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161350, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_161974 = ((float *) mem_171293)[j_161332];
                            float gt_arg0_161978 = ((float *) mem_171293)[tmp_161350];
                            bool defunc_0_leq_res_161979 = gt_arg0_161978 <= gt_arg1_161974;
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161352 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161352 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161352;
                        int64_t j_tmp_171973 = tmp_161350;
                        
                        loop_while_161329 = loop_while_tmp_171970;
                        j_161332 = j_tmp_171973;
                    }
                    s_161325 = loop_while_161329;
                    s_161328 = j_161332;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171280, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint32_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        if (memblock_alloc(ctx, &mem_171352, bytes_171282, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        
        int64_t data_161365;
        bool data_161366;
        int64_t data_161369;
        int64_t loop_dz2084Uz2082U_161370;
        bool loop_while_161371;
        int64_t stride_161374;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161370 = flat_dim_161256;
        loop_while_161371 = loop_cond_161362;
        stride_161374 = block_sizze_161255;
        while (loop_while_161371) {
            int64_t next_stride_161375 = mul64((int64_t) 2, stride_161374);
            bool zzero_161376 = next_stride_161375 == (int64_t) 0;
            bool nonzzero_161377 = !zzero_161376;
            bool nonzzero_cert_161378;
            
            if (!nonzzero_161377) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:142:31-35\n   #5  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161379 = sdiv64(flat_dim_161256, next_stride_161375);
            bool bounds_invalid_upwards_161380 = slt64(num_merges_161379, (int64_t) 0);
            bool valid_161381 = !bounds_invalid_upwards_161380;
            bool range_valid_c_161382;
            
            if (!valid_161381) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161379, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:142:31-35\n   #6  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161384 = sub64(next_stride_161375, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161385 = sle64((int64_t) 0, m_161384);
            bool cond_161387 = slt64(next_stride_161375, (int64_t) 10);
            bool protect_assert_disj_161388 = nonzzero_161364 || cond_161387;
            bool nonzzero_cert_161389;
            
            if (!protect_assert_disj_161388) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161390 = smod_safe64(next_stride_161375, merge_block_sizze_161260);
            bool num_blocks_161391 = zeze_lhs_161390 == (int64_t) 0;
            bool protect_assert_disj_161392 = cond_161387 || num_blocks_161391;
            bool assert_c_161393;
            
            if (!protect_assert_disj_161392) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161395 = sdiv_safe64(next_stride_161375, merge_block_sizze_161260);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396 = add64((int64_t) 1, num_blocks_161395);
            int64_t j_m_i_161397 = sub64(next_stride_161375, stride_161374);
            int64_t flat_dim_161398 = merge_block_sizze_161260 * num_blocks_161395;
            bool bounds_invalid_upwards_161399 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, (int64_t) 0);
            bool empty_slice_161400 = j_m_i_161397 == (int64_t) 0;
            int64_t m_161401 = sub64(j_m_i_161397, (int64_t) 1);
            bool zzero_lte_i_161402 = sle64((int64_t) 0, stride_161374);
            bool i_lte_j_161403 = sle64(stride_161374, next_stride_161375);
            bool empty_slice_161404 = stride_161374 == (int64_t) 0;
            int64_t m_161405 = sub64(stride_161374, (int64_t) 1);
            bool bounds_invalid_upwards_161406 = slt64(num_blocks_161395, (int64_t) 0);
            bool cond_161407 = slt64((int64_t) 0, stride_161374);
            bool valid_161408 = !bounds_invalid_upwards_161399;
            int64_t i_p_m_t_s_161409 = add64(stride_161374, m_161401);
            bool zzero_leq_i_p_m_t_s_161410 = sle64((int64_t) 0, m_161405);
            bool i_p_m_t_s_leq_w_161411 = slt64(m_161405, next_stride_161375);
            bool valid_161412 = !bounds_invalid_upwards_161406;
            bool i_p_m_t_s_leq_w_161413 = slt64(m_161384, flat_dim_161398);
            bool y_161414 = slt64((int64_t) 0, j_m_i_161397);
            bool protect_assert_disj_161415 = cond_161387 || valid_161408;
            bool range_valid_c_161416;
            
            if (!protect_assert_disj_161415) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:142:31-35\n   #10 ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161417 = sle64((int64_t) 0, i_p_m_t_s_161409);
            bool i_p_m_t_s_leq_w_161418 = slt64(i_p_m_t_s_161409, next_stride_161375);
            bool y_161419 = zzero_leq_i_p_m_t_s_161410 && i_p_m_t_s_leq_w_161411;
            bool protect_assert_disj_161420 = cond_161387 || valid_161412;
            bool range_valid_c_161421;
            
            if (!protect_assert_disj_161420) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161395, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161422 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161413;
            bool y_161423 = zzero_lte_i_161402 && i_p_m_t_s_leq_w_161418;
            bool forwards_ok_161424 = zzero_lte_i_161402 && y_161419;
            bool ok_or_empty_161425 = zzero_161376 || y_161422;
            bool protect_assert_disj_161426 = cond_161407 || y_161414;
            bool y_161427 = zzero_leq_i_p_m_t_s_161417 && y_161423;
            bool ok_or_empty_161428 = empty_slice_161404 || forwards_ok_161424;
            bool protect_assert_disj_161429 = cond_161387 || ok_or_empty_161425;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) flat_dim_161398, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161431 = !cond_161387;
            bool protect_assert_disj_161432 = protect_assert_disj_161426 || loop_not_taken_161431;
            bool index_certs_161433;
            
            if (!protect_assert_disj_161432) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:142:31-35\n   #10 ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161434 = i_lte_j_161403 && y_161427;
            bool protect_assert_disj_161435 = cond_161387 || ok_or_empty_161428;
            bool index_certs_161436;
            
            if (!protect_assert_disj_161435) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:142:31-35\n   #11 ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161437 = ok_or_empty_161428 || loop_not_taken_161431;
            bool index_certs_161438;
            
            if (!protect_assert_disj_161437) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161439 = empty_slice_161400 || forwards_ok_161434;
            bool protect_assert_disj_161440 = cond_161387 || ok_or_empty_161439;
            bool index_certs_161441;
            
            if (!protect_assert_disj_161440) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:142:31-35\n   #11 ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161442 = loop_not_taken_161431 || ok_or_empty_161439;
            bool index_certs_161443;
            
            if (!protect_assert_disj_161442) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 4 * num_merges_161379;
            int64_t bytes_171361 = next_stride_161375 * binop_x_171360;
            int64_t binop_x_171363 = (int64_t) 8 * num_merges_161379;
            int64_t bytes_171364 = next_stride_161375 * binop_x_171363;
            bool i_lte_j_161386 = sle64((int64_t) 0, next_stride_161375);
            
            if (mem_171362_cached_sizze_172360 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172360, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172361 < bytes_171364) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172361, bytes_171364);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396;
            int64_t binop_x_171390 = (int64_t) 4 * num_blocks_161395;
            int64_t bytes_171391 = merge_block_sizze_161260 * binop_x_171390;
            int64_t binop_x_171393 = (int64_t) 8 * num_blocks_161395;
            int64_t bytes_171394 = merge_block_sizze_161260 * binop_x_171393;
            int64_t bytes_171436 = (int64_t) 8 * stride_161374;
            int64_t bytes_171438 = (int64_t) 16 * stride_161374;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161379; i_171036++) {
                int64_t start_161447 = mul64(next_stride_161375, i_171036);
                int64_t j_m_i_161448 = sub64(loop_dz2084Uz2082U_161370, start_161447);
                bool empty_slice_161449 = j_m_i_161448 == (int64_t) 0;
                int64_t m_161450 = sub64(j_m_i_161448, (int64_t) 1);
                int64_t i_p_m_t_s_161451 = add64(start_161447, m_161450);
                bool zzero_leq_i_p_m_t_s_161452 = sle64((int64_t) 0, i_p_m_t_s_161451);
                bool i_p_m_t_s_leq_w_161453 = slt64(i_p_m_t_s_161451, loop_dz2084Uz2082U_161370);
                bool zzero_lte_i_161454 = sle64((int64_t) 0, start_161447);
                bool i_lte_j_161455 = sle64(start_161447, loop_dz2084Uz2082U_161370);
                bool y_161456 = i_p_m_t_s_leq_w_161453 && zzero_lte_i_161454;
                bool y_161457 = zzero_leq_i_p_m_t_s_161452 && y_161456;
                bool forwards_ok_161458 = i_lte_j_161455 && y_161457;
                bool ok_or_empty_161459 = empty_slice_161449 || forwards_ok_161458;
                bool index_certs_161460;
                
                if (!ok_or_empty_161459) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161447, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161370, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161461 = slt64(m_161384, j_m_i_161448);
                bool y_161462 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161461;
                bool forwards_ok_161463 = i_lte_j_161386 && y_161462;
                bool ok_or_empty_161464 = zzero_161376 || forwards_ok_161463;
                bool index_certs_161465;
                
                if (!ok_or_empty_161464) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) j_m_i_161448, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:142:31-35\n   #8  ftRelational.fut:141:5-142:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161387) {
                    float dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161407) {
                        float head_res_162008 = ((float *) mem_param_171356.mem)[start_161447];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161447];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161374 + start_161447;
                        float head_res_162011 = ((float *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161375; nest_i_171983++) {
                        ((float *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171438, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161375; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161375; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161397;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161374);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161397);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161374 + j_162022;
                                int64_t slice_162032 = start_161447 + slice_162031;
                                float leq_arg1_162033 = ((float *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161447 + i_162019;
                                float leq_arg0_162038 = ((float *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = leq_arg0_162038 <= leq_arg1_162033;
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        float loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161374);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161447 + i_162019;
                            float tmp_162049 = ((float *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161397);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:142:31-35\n   #9  ftRelational.fut:141:5-142:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161374 + j_162022;
                            int64_t slice_162056 = start_161447 + slice_162055;
                            float tmp_162057 = ((float *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((float *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172362 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172362, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172363 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172363, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396; i_171022++) {
                        int64_t split_count_arg3_161527 = mul64(merge_block_sizze_161260, i_171022);
                        int64_t defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161528, &defunc_0_split_count_res_161529, &defunc_0_split_count_res_161530, &defunc_0_split_count_res_161531, &defunc_0_split_count_res_161532, (int64_t) 0, stride_161374, (int64_t) 0, j_m_i_161397, split_count_arg3_161527) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161533 = slt64((int64_t) 0, defunc_0_split_count_res_161532);
                        bool defunc_0_split_count_res_161534;
                        int64_t defunc_0_split_count_res_161535;
                        int64_t defunc_0_split_count_res_161536;
                        int64_t defunc_0_split_count_res_161537;
                        int64_t defunc_0_split_count_res_161538;
                        int64_t defunc_0_split_count_res_161539;
                        bool loop_while_161540;
                        int64_t ss_161541;
                        int64_t ss_161542;
                        int64_t tt_161543;
                        int64_t tt_161544;
                        int64_t count_161545;
                        
                        loop_while_161540 = loop_cond_161533;
                        ss_161541 = defunc_0_split_count_res_161528;
                        ss_161542 = defunc_0_split_count_res_161529;
                        tt_161543 = defunc_0_split_count_res_161530;
                        tt_161544 = defunc_0_split_count_res_161531;
                        count_161545 = defunc_0_split_count_res_161532;
                        while (loop_while_161540) {
                            int64_t zlze_lhs_161546 = sub64(ss_161542, ss_161541);
                            bool cond_161547 = sle64(zlze_lhs_161546, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161548;
                            int64_t defunc_0_lifted_step_res_161549;
                            int64_t defunc_0_lifted_step_res_161550;
                            int64_t defunc_0_lifted_step_res_161551;
                            
                            if (cond_161547) {
                                int64_t tmp_162061 = add64(tt_161543, count_161545);
                                
                                defunc_0_lifted_step_res_161548 = ss_161541;
                                defunc_0_lifted_step_res_161549 = tmp_162061;
                                defunc_0_lifted_step_res_161550 = tt_161544;
                                defunc_0_lifted_step_res_161551 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161553 = sub64(tt_161544, tt_161543);
                                bool cond_161554 = sle64(zlze_lhs_161553, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161555;
                                int64_t defunc_0_lifted_step_res_f_res_161556;
                                int64_t defunc_0_lifted_step_res_f_res_161557;
                                int64_t defunc_0_lifted_step_res_f_res_161558;
                                
                                if (cond_161554) {
                                    int64_t tmp_162062 = add64(ss_161541, count_161545);
                                    
                                    defunc_0_lifted_step_res_f_res_161555 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161556 = tt_161543;
                                    defunc_0_lifted_step_res_f_res_161557 = tt_161544;
                                    defunc_0_lifted_step_res_f_res_161558 = (int64_t) 0;
                                } else {
                                    bool cond_161560 = count_161545 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161561;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161562;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161563;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161564;
                                    
                                    if (cond_161560) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161541);
                                        bool y_162065 = slt64(ss_161541, stride_161374);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161541, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:142:31-35\n   #13 ftRelational.fut:141:5-142:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161543);
                                        bool y_162071 = slt64(tt_161543, j_m_i_161397);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161543, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:142:31-35\n   #13 ftRelational.fut:141:5-142:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161447 + ss_161541;
                                        float leq_arg1_162069 = ((float *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161374 + tt_161543;
                                        int64_t slice_162075 = start_161447 + slice_162074;
                                        float leq_arg0_162076 = ((float *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = leq_arg0_162076 <= leq_arg1_162069;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161543);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161541;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161541);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161543;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = tt_161544;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = (int64_t) 0;
                                    } else {
                                        int64_t m_161583 = sdiv64(count_161545, (int64_t) 2);
                                        int64_t n_161584 = sub64(count_161545, m_161583);
                                        bool cond_161585 = n_161584 == (int64_t) 0;
                                        int64_t zgze_lhs_161586 = add64(ss_161541, m_161583);
                                        bool cond_f_res_161587 = sle64(ss_161542, zgze_lhs_161586);
                                        bool x_161588 = !cond_161585;
                                        bool y_161589 = cond_f_res_161587 && x_161588;
                                        bool cond_161590 = cond_161585 || y_161589;
                                        bool leq_y_x_161591;
                                        
                                        if (cond_161590) {
                                            leq_y_x_161591 = 1;
                                        } else {
                                            bool x_161592 = sle64((int64_t) 0, zgze_lhs_161586);
                                            bool y_161593 = slt64(zgze_lhs_161586, stride_161374);
                                            bool bounds_check_161594 = x_161592 && y_161593;
                                            bool index_certs_161595;
                                            
                                            if (!bounds_check_161594) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161586, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:142:31-35\n   #13 ftRelational.fut:141:5-142:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161598 = add64(tt_161543, n_161584);
                                            int64_t leq_arg0_161599 = sub64(zm_lhs_161598, (int64_t) 1);
                                            bool x_161600 = sle64((int64_t) 0, leq_arg0_161599);
                                            bool y_161601 = slt64(leq_arg0_161599, j_m_i_161397);
                                            bool bounds_check_161602 = x_161600 && y_161601;
                                            bool index_certs_161603;
                                            
                                            if (!bounds_check_161602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161599, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:142:31-35\n   #13 ftRelational.fut:141:5-142:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161596 = start_161447 + zgze_lhs_161586;
                                            float leq_arg1_161597 = ((float *) mem_param_171356.mem)[slice_161596];
                                            int64_t slice_161604 = stride_161374 + leq_arg0_161599;
                                            int64_t slice_161605 = start_161447 + slice_161604;
                                            float leq_arg0_161606 = ((float *) mem_param_171356.mem)[slice_161605];
                                            bool defunc_0_leq_res_161607 = leq_arg0_161606 <= leq_arg1_161597;
                                            
                                            leq_y_x_161591 = defunc_0_leq_res_161607;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                        
                                        if (leq_y_x_161591) {
                                            int64_t tmp_162082 = add64(tt_161543, n_161584);
                                            int64_t tmp_162083 = sub64(count_161545, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tt_161544;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = tmp_162083;
                                        } else {
                                            int64_t tmp_161613 = add64(tt_161543, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tt_161543;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tmp_161613;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = count_161545;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = ss_161541;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                    }
                                    defunc_0_lifted_step_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_161561;
                                    defunc_0_lifted_step_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_161562;
                                    defunc_0_lifted_step_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_161563;
                                    defunc_0_lifted_step_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_161564;
                                }
                                defunc_0_lifted_step_res_161548 = defunc_0_lifted_step_res_f_res_161555;
                                defunc_0_lifted_step_res_161549 = defunc_0_lifted_step_res_f_res_161556;
                                defunc_0_lifted_step_res_161550 = defunc_0_lifted_step_res_f_res_161557;
                                defunc_0_lifted_step_res_161551 = defunc_0_lifted_step_res_f_res_161558;
                            }
                            
                            int64_t loopres_161614;
                            int64_t loopres_161615;
                            int64_t loopres_161616;
                            int64_t loopres_161617;
                            int64_t loopres_161618;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161614, &loopres_161615, &loopres_161616, &loopres_161617, &loopres_161618, defunc_0_lifted_step_res_161548, ss_161542, defunc_0_lifted_step_res_161549, defunc_0_lifted_step_res_161550, defunc_0_lifted_step_res_161551) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161619 = slt64((int64_t) 0, loopres_161618);
                            bool loop_while_tmp_171990 = loop_cond_161619;
                            int64_t ss_tmp_171991 = loopres_161614;
                            int64_t ss_tmp_171992 = loopres_161615;
                            int64_t tt_tmp_171993 = loopres_161616;
                            int64_t tt_tmp_171994 = loopres_161617;
                            int64_t count_tmp_171995 = loopres_161618;
                            
                            loop_while_161540 = loop_while_tmp_171990;
                            ss_161541 = ss_tmp_171991;
                            ss_161542 = ss_tmp_171992;
                            tt_161543 = tt_tmp_171993;
                            tt_161544 = tt_tmp_171994;
                            count_161545 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161534 = loop_while_161540;
                        defunc_0_split_count_res_161535 = ss_161541;
                        defunc_0_split_count_res_161536 = ss_161542;
                        defunc_0_split_count_res_161537 = tt_161543;
                        defunc_0_split_count_res_161538 = tt_161544;
                        defunc_0_split_count_res_161539 = count_161545;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161535;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161537;
                    }
                    if (mem_171392_cached_sizze_172364 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172364, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172365 < bytes_171394) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172365, bytes_171394);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161395; i_171029++) {
                        bool y_161625 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool index_certs_161627;
                        
                        if (!y_161625) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:142:31-35\n   #10 ftRelational.fut:141:5-142:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161628 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161630 = add64((int64_t) 1, i_171029);
                        bool x_161631 = sle64((int64_t) 0, tmp_161630);
                        bool y_161632 = slt64(tmp_161630, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool bounds_check_161633 = x_161631 && y_161632;
                        bool index_certs_161634;
                        
                        if (!bounds_check_161633) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161630, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:142:31-35\n   #10 ftRelational.fut:141:5-142:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161635 = ((int64_t *) mem_171375)[tmp_161630];
                        int64_t defunc_0_f_res_161636 = ((int64_t *) mem_171377)[tmp_161630];
                        int64_t merge_sequential_arg2_161637 = add64(stride_161374, defunc_0_f_res_161629);
                        int64_t merge_sequential_arg2_161638 = add64(stride_161374, defunc_0_f_res_161636);
                        int64_t j_m_i_161639 = sub64(merge_sequential_arg2_161638, merge_sequential_arg2_161637);
                        bool empty_slice_161640 = j_m_i_161639 == (int64_t) 0;
                        int64_t m_161641 = sub64(j_m_i_161639, (int64_t) 1);
                        int64_t i_p_m_t_s_161642 = add64(merge_sequential_arg2_161637, m_161641);
                        bool zzero_leq_i_p_m_t_s_161643 = sle64((int64_t) 0, i_p_m_t_s_161642);
                        bool i_p_m_t_s_leq_w_161644 = slt64(i_p_m_t_s_161642, next_stride_161375);
                        bool zzero_lte_i_161645 = sle64((int64_t) 0, merge_sequential_arg2_161637);
                        bool i_lte_j_161646 = sle64(merge_sequential_arg2_161637, merge_sequential_arg2_161638);
                        bool y_161647 = i_p_m_t_s_leq_w_161644 && zzero_lte_i_161645;
                        bool y_161648 = zzero_leq_i_p_m_t_s_161643 && y_161647;
                        bool forwards_ok_161649 = i_lte_j_161646 && y_161648;
                        bool ok_or_empty_161650 = empty_slice_161640 || forwards_ok_161649;
                        bool index_certs_161651;
                        
                        if (!ok_or_empty_161650) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161637, ":", (long long) merge_sequential_arg2_161638, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:142:31-35\n   #10 ftRelational.fut:141:5-142:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161652 = sub64(defunc_0_f_res_161635, defunc_0_f_res_161628);
                        bool empty_slice_161653 = j_m_i_161652 == (int64_t) 0;
                        int64_t m_161654 = sub64(j_m_i_161652, (int64_t) 1);
                        int64_t i_p_m_t_s_161655 = add64(defunc_0_f_res_161628, m_161654);
                        bool zzero_leq_i_p_m_t_s_161656 = sle64((int64_t) 0, i_p_m_t_s_161655);
                        bool i_p_m_t_s_leq_w_161657 = slt64(i_p_m_t_s_161655, next_stride_161375);
                        bool zzero_lte_i_161658 = sle64((int64_t) 0, defunc_0_f_res_161628);
                        bool i_lte_j_161659 = sle64(defunc_0_f_res_161628, defunc_0_f_res_161635);
                        bool y_161660 = i_p_m_t_s_leq_w_161657 && zzero_lte_i_161658;
                        bool y_161661 = zzero_leq_i_p_m_t_s_161656 && y_161660;
                        bool forwards_ok_161662 = i_lte_j_161659 && y_161661;
                        bool ok_or_empty_161663 = empty_slice_161653 || forwards_ok_161662;
                        bool index_certs_161664;
                        
                        if (!ok_or_empty_161663) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161628, ":", (long long) defunc_0_f_res_161635, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:142:31-35\n   #10 ftRelational.fut:141:5-142:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161665 = slt64((int64_t) 0, j_m_i_161652);
                        float dummy_161666;
                        int64_t dummy_161667;
                        
                        if (cond_161665) {
                            bool index_certs_162084;
                            
                            if (!cond_161665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:142:31-35\n   #12 ftRelational.fut:141:5-142:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161447 + defunc_0_f_res_161628;
                            float head_res_162086 = ((float *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161666 = head_res_162086;
                            dummy_161667 = head_res_162087;
                        } else {
                            bool y_161672 = slt64((int64_t) 0, j_m_i_161639);
                            bool index_certs_161673;
                            
                            if (!y_161672) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:142:31-35\n   #12 ftRelational.fut:141:5-142:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161674 = start_161447 + merge_sequential_arg2_161637;
                            float head_res_161675 = ((float *) mem_param_171356.mem)[slice_161674];
                            int64_t head_res_161676 = ((int64_t *) mem_param_171359.mem)[slice_161674];
                            
                            dummy_161666 = head_res_161675;
                            dummy_161667 = head_res_161676;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161260; nest_i_171998++) {
                            ((float *) mem_171392)[i_171029 * merge_block_sizze_161260 + nest_i_171998] = dummy_161666;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161260; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + nest_i_171999] = dummy_161667;
                        }
                        
                        int64_t data_161679;
                        int64_t i_161683 = (int64_t) 0;
                        
                        for (int64_t k_161682 = 0; k_161682 < merge_block_sizze_161260; k_161682++) {
                            int64_t j_161686 = sub64(k_161682, i_161683);
                            bool cond_161687 = j_161686 == j_m_i_161639;
                            bool cond_161688;
                            
                            if (cond_161687) {
                                cond_161688 = 1;
                            } else {
                                bool cond_161689 = slt64(i_161683, j_m_i_161652);
                                bool cond_f_res_161690;
                                
                                if (cond_161689) {
                                    bool x_162088 = sle64((int64_t) 0, j_161686);
                                    bool y_162089 = slt64(j_161686, j_m_i_161639);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:142:31-35\n   #11 ftRelational.fut:141:5-142:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161683);
                                    bool bounds_check_162096 = cond_161689 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:142:31-35\n   #11 ftRelational.fut:141:5-142:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161637 + j_161686;
                                    int64_t slice_162093 = start_161447 + slice_162092;
                                    float leq_arg1_162094 = ((float *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161628 + i_161683;
                                    int64_t slice_162099 = start_161447 + slice_162098;
                                    float leq_arg0_162100 = ((float *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = leq_arg0_162100 <= leq_arg1_162094;
                                    
                                    cond_f_res_161690 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161690 = 0;
                                }
                                cond_161688 = cond_f_res_161690;
                            }
                            
                            int64_t loopres_161705;
                            float loopres_161706;
                            int64_t loopres_161707;
                            
                            if (cond_161688) {
                                bool x_162103 = sle64((int64_t) 0, i_161683);
                                bool y_162104 = slt64(i_161683, j_m_i_161652);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:142:31-35\n   #11 ftRelational.fut:141:5-142:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161683);
                                int64_t slice_162107 = defunc_0_f_res_161628 + i_161683;
                                int64_t slice_162108 = start_161447 + slice_162107;
                                float tmp_162109 = ((float *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161705 = tmp_162102;
                                loopres_161706 = tmp_162109;
                                loopres_161707 = tmp_162110;
                            } else {
                                bool x_161717 = sle64((int64_t) 0, j_161686);
                                bool y_161718 = slt64(j_161686, j_m_i_161639);
                                bool bounds_check_161719 = x_161717 && y_161718;
                                bool index_certs_161720;
                                
                                if (!bounds_check_161719) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:142:31-35\n   #11 ftRelational.fut:141:5-142:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161721 = merge_sequential_arg2_161637 + j_161686;
                                int64_t slice_161722 = start_161447 + slice_161721;
                                float tmp_161723 = ((float *) mem_param_171356.mem)[slice_161722];
                                int64_t tmp_161724 = ((int64_t *) mem_param_171359.mem)[slice_161722];
                                
                                loopres_161705 = i_161683;
                                loopres_161706 = tmp_161723;
                                loopres_161707 = tmp_161724;
                            }
                            ((float *) mem_171392)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161706;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161707;
                            
                            int64_t i_tmp_172000 = loopres_161705;
                            
                            i_161683 = i_tmp_172000;
                        }
                        data_161679 = i_161683;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint32_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171394, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171362, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161731 = next_stride_161375 * num_merges_161379;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint32_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            if (memblock_alloc(ctx, &mem_171472, bytes_171364, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            
            bool loop_cond_161734 = slt64(next_stride_161375, flat_dim_161256);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161731;
            bool loop_while_tmp_171977 = loop_cond_161734;
            int64_t stride_tmp_171980 = next_stride_161375;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161370 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161371 = loop_while_tmp_171977;
            stride_161374 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161365 = loop_dz2084Uz2082U_161370;
        data_161366 = loop_while_161371;
        data_161369 = stride_161374;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161735 = n_111223 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161736 = sle64((int64_t) 0, zs_lhs_161240);
        bool i_p_m_t_s_leq_w_161737 = slt64(zs_lhs_161240, data_161365);
        bool y_161738 = zzero_leq_i_p_m_t_s_161736 && i_p_m_t_s_leq_w_161737;
        bool ok_or_empty_161739 = empty_slice_161735 || y_161738;
        bool index_certs_161740;
        
        if (!ok_or_empty_161739) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_111223, "] out of bounds for array of shape [", (long long) data_161365, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:142:31-35\n   #6  ftRelational.fut:141:5-142:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_111223; i_171043++) {
        int64_t eta_p_161748 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161749 = sle64((int64_t) 0, eta_p_161748);
        bool y_161750 = slt64(eta_p_161748, n_111223);
        bool bounds_check_161751 = x_161749 && y_161750;
        bool index_certs_161752;
        
        if (!bounds_check_161751) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161748, "] out of bounds for array of shape [", (long long) n_111223, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:142:31-35\n   #5  ftRelational.fut:141:5-142:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_161753 = ((int64_t *) ext_mem_171275.mem)[eta_p_161748];
        float lifted_lambda_res_161754 = ((float *) xs_mem_171274.mem)[eta_p_161748];
        
        ((int64_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161753;
        ((float *) mem_171486.mem)[i_171043] = lifted_lambda_res_161754;
    }
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172354, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172355, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_172366, struct memblock *mem_out_p_172367, struct memblock xs_mem_171274, int64_t n_106937, int64_t incr_106938)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172368 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172369 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172370 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172371 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172372 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172373 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172374 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172375 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172376 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172377 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_106937;
    bool cond_161239 = sle64(n_106937, (int64_t) 1);
    int64_t zs_lhs_161240 = sub64(n_106937, (int64_t) 1);
    int64_t zp_rhs_161241 = sdiv_safe64(zs_lhs_161240, (int64_t) 20);
    int64_t min_num_blocks_161242 = add64((int64_t) 1, zp_rhs_161241);
    bool loop_cond_161243 = slt64((int64_t) 1, min_num_blocks_161242);
    bool smallest_pow_2_geq_than_res_161244;
    int64_t smallest_pow_2_geq_than_res_161245;
    bool loop_while_161246;
    int64_t x_161247;
    
    loop_while_161246 = loop_cond_161243;
    x_161247 = (int64_t) 1;
    while (loop_while_161246) {
        int64_t loopres_161248 = mul64((int64_t) 2, x_161247);
        bool loop_cond_161249 = slt64(loopres_161248, min_num_blocks_161242);
        bool loop_while_tmp_171958 = loop_cond_161249;
        int64_t x_tmp_171959 = loopres_161248;
        
        loop_while_161246 = loop_while_tmp_171958;
        x_161247 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161244 = loop_while_161246;
    smallest_pow_2_geq_than_res_161245 = x_161247;
    
    bool zzero_161250 = smallest_pow_2_geq_than_res_161245 == (int64_t) 0;
    bool nonzzero_161251 = !zzero_161250;
    bool protect_assert_disj_161252 = cond_161239 || nonzzero_161251;
    bool nonzzero_cert_161253;
    
    if (!protect_assert_disj_161252) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:138:31-35\n   #5  ftRelational.fut:137:5-138:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161254 = sdiv_safe64(zs_lhs_161240, smallest_pow_2_geq_than_res_161245);
    int64_t block_sizze_161255 = add64((int64_t) 1, zp_rhs_161254);
    bool y_161261 = slt64((int64_t) 0, n_106937);
    bool protect_assert_disj_171871 = cond_161239 || y_161261;
    bool index_certs_161262;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_106937, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:138:31-35\n   #5  ftRelational.fut:137:5-138:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161276 = slt64(smallest_pow_2_geq_than_res_161245, (int64_t) 0);
    bool valid_161277 = !bounds_invalid_upwards_161276;
    bool protect_assert_disj_171879 = cond_161239 || valid_161277;
    bool range_valid_c_161278;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161245, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:138:31-35\n   #6  ftRelational.fut:137:5-138:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161280 = slt64(block_sizze_161255, (int64_t) 0);
    bool valid_161281 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_171881 = cond_161239 || valid_161281;
    bool range_valid_c_161282;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161255, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161284 = sle64(block_sizze_161255, (int64_t) 1);
    int64_t tmp_161285 = sub64(block_sizze_161255, (int64_t) 2);
    bool bounds_invalid_upwards_161286 = slt64(tmp_161285, (int64_t) 0);
    bool valid_161288 = !bounds_invalid_upwards_161286;
    bool protect_assert_disj_161289 = cond_161284 || valid_161288;
    bool protect_assert_disj_171883 = cond_161239 || protect_assert_disj_161289;
    bool range_valid_c_161290;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161285, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171485 = (int64_t) 4 * n_106937;
    
    if (futrts_indicesWithIncrement_16277(ctx, &ext_mem_171275, xs_mem_171274, n_106937, incr_106938) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_106937; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161256 = smallest_pow_2_geq_than_res_161245 * block_sizze_161255;
    bool x_171866 = !cond_161239;
    int64_t greatest_divisor_leq_than_arg1_161259 = mul64((int64_t) 2, block_sizze_161255);
    int64_t merge_block_sizze_161260;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161259) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161260 = x_171868;
    } else {
        merge_block_sizze_161260 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_161263;
    
    if (x_171866) {
        int32_t x_171872 = ((int32_t *) xs_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161263 = x_171872;
    } else {
        reduce_arg1_161263 = 0;
    }
    
    int32_t defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        int32_t x_171874;
        int64_t x_171875;
        int32_t redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161263;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_106937; i_171003++) {
            int32_t x_161267 = ((int32_t *) xs_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161273 = sle32(redout_171001, x_161267);
            int32_t defunc_0_op_res_161274;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161274 = x_161267;
            } else {
                defunc_0_op_res_161274 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161275;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161275 = i_171003;
            } else {
                defunc_0_op_res_161275 = redout_171002;
            }
            
            int32_t redout_tmp_171962 = defunc_0_op_res_161274;
            int64_t redout_tmp_171963 = defunc_0_op_res_161275;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = 0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161287 = add64((int64_t) 1, tmp_161285);
    int64_t binop_x_171278 = (int64_t) 4 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171279 = block_sizze_161255 * binop_x_171278;
    int64_t binop_x_171281 = (int64_t) 8 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171282 = block_sizze_161255 * binop_x_171281;
    int64_t bytes_171292 = (int64_t) 4 * block_sizze_161255;
    int64_t bytes_171294 = (int64_t) 8 * block_sizze_161255;
    bool loop_cond_161362 = slt64(block_sizze_161255, flat_dim_161256);
    bool zzero_161363 = merge_block_sizze_161260 == (int64_t) 0;
    bool nonzzero_161364 = !zzero_161363;
    
    if (cond_161239) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172368 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172368, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172369 < bytes_171282) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172369, bytes_171282);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172370 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172370, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172371 < bytes_171294) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172371, bytes_171294);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161245; i_171015++) {
            int64_t zp_lhs_161294 = mul64(block_sizze_161255, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161255; i_171008++) {
                int64_t k_161298 = add64(zp_lhs_161294, i_171008);
                bool cond_161299 = slt64(k_161298, n_106937);
                int32_t lifted_lambda_res_161300;
                int64_t lifted_lambda_res_161301;
                
                if (cond_161299) {
                    bool x_161970 = sle64((int64_t) 0, k_161298);
                    bool bounds_check_161971 = cond_161299 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161298, "] out of bounds for array of shape [", (long long) n_106937, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_161973 = ((int32_t *) xs_mem_171274.mem)[k_161298];
                    
                    lifted_lambda_res_161300 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161301 = k_161298;
                } else {
                    lifted_lambda_res_161300 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161301 = defunc_0_reduce_res_162118;
                }
                ((int32_t *) mem_171293)[i_171008] = lifted_lambda_res_161300;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161301;
            }
            if (!cond_161284) {
                for (int64_t i_161311 = 0; i_161311 < distance_161287; i_161311++) {
                    int64_t gt_arg1_161314 = add64((int64_t) 1, i_161311);
                    bool x_161315 = sle64((int64_t) 0, gt_arg1_161314);
                    bool y_161316 = slt64(gt_arg1_161314, block_sizze_161255);
                    bool bounds_check_161317 = x_161315 && y_161316;
                    bool index_certs_161318;
                    
                    if (!bounds_check_161317) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161314, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161320 = slt64(i_161311, block_sizze_161255);
                    bool index_certs_161321;
                    
                    if (!y_161320) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161311, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_161319 = ((int32_t *) mem_171293)[gt_arg1_161314];
                    int32_t gt_arg0_161322 = ((int32_t *) mem_171293)[i_161311];
                    bool defunc_0_leq_res_161323 = sle32(gt_arg0_161322, gt_arg1_161319);
                    bool defunc_0_lifted_gt_res_161324 = !defunc_0_leq_res_161323;
                    bool s_161325;
                    int64_t s_161328;
                    bool loop_while_161329;
                    int64_t j_161332;
                    
                    loop_while_161329 = defunc_0_lifted_gt_res_161324;
                    j_161332 = i_161311;
                    while (loop_while_161329) {
                        bool x_161333 = sle64((int64_t) 0, j_161332);
                        bool y_161334 = slt64(j_161332, block_sizze_161255);
                        bool bounds_check_161335 = x_161333 && y_161334;
                        bool index_certs_161336;
                        
                        if (!bounds_check_161335) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161332, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161339 = add64((int64_t) 1, j_161332);
                        bool x_161340 = sle64((int64_t) 0, copy_arg0_161339);
                        bool y_161341 = slt64(copy_arg0_161339, block_sizze_161255);
                        bool bounds_check_161342 = x_161340 && y_161341;
                        bool index_certs_161343;
                        
                        if (!bounds_check_161342) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161339, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_161337 = ((int32_t *) mem_171293)[j_161332];
                        int64_t copy_arg0_161338 = ((int64_t *) mem_171295)[j_161332];
                        int32_t copy_arg0_161344 = ((int32_t *) mem_171293)[copy_arg0_161339];
                        int64_t copy_arg0_161345 = ((int64_t *) mem_171295)[copy_arg0_161339];
                        
                        ((int32_t *) mem_171293)[j_161332] = copy_arg0_161344;
                        ((int64_t *) mem_171295)[j_161332] = copy_arg0_161345;
                        ((int32_t *) mem_171293)[copy_arg0_161339] = copy_arg0_161337;
                        ((int64_t *) mem_171295)[copy_arg0_161339] = copy_arg0_161338;
                        
                        int64_t tmp_161350 = sub64(j_161332, (int64_t) 1);
                        bool cond_161351 = sle64((int64_t) 0, tmp_161350);
                        bool loop_cond_161352;
                        
                        if (cond_161351) {
                            bool y_161975 = slt64(tmp_161350, block_sizze_161255);
                            bool bounds_check_161976 = cond_161351 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161350, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_161974 = ((int32_t *) mem_171293)[j_161332];
                            int32_t gt_arg0_161978 = ((int32_t *) mem_171293)[tmp_161350];
                            bool defunc_0_leq_res_161979 = sle32(gt_arg0_161978, gt_arg1_161974);
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161352 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161352 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161352;
                        int64_t j_tmp_171973 = tmp_161350;
                        
                        loop_while_161329 = loop_while_tmp_171970;
                        j_161332 = j_tmp_171973;
                    }
                    s_161325 = loop_while_161329;
                    s_161328 = j_161332;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171280, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint32_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        if (memblock_alloc(ctx, &mem_171352, bytes_171282, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        
        int64_t data_161365;
        bool data_161366;
        int64_t data_161369;
        int64_t loop_dz2084Uz2082U_161370;
        bool loop_while_161371;
        int64_t stride_161374;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161370 = flat_dim_161256;
        loop_while_161371 = loop_cond_161362;
        stride_161374 = block_sizze_161255;
        while (loop_while_161371) {
            int64_t next_stride_161375 = mul64((int64_t) 2, stride_161374);
            bool zzero_161376 = next_stride_161375 == (int64_t) 0;
            bool nonzzero_161377 = !zzero_161376;
            bool nonzzero_cert_161378;
            
            if (!nonzzero_161377) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:138:31-35\n   #5  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161379 = sdiv64(flat_dim_161256, next_stride_161375);
            bool bounds_invalid_upwards_161380 = slt64(num_merges_161379, (int64_t) 0);
            bool valid_161381 = !bounds_invalid_upwards_161380;
            bool range_valid_c_161382;
            
            if (!valid_161381) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161379, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:138:31-35\n   #6  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161384 = sub64(next_stride_161375, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161385 = sle64((int64_t) 0, m_161384);
            bool cond_161387 = slt64(next_stride_161375, (int64_t) 10);
            bool protect_assert_disj_161388 = nonzzero_161364 || cond_161387;
            bool nonzzero_cert_161389;
            
            if (!protect_assert_disj_161388) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161390 = smod_safe64(next_stride_161375, merge_block_sizze_161260);
            bool num_blocks_161391 = zeze_lhs_161390 == (int64_t) 0;
            bool protect_assert_disj_161392 = cond_161387 || num_blocks_161391;
            bool assert_c_161393;
            
            if (!protect_assert_disj_161392) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161395 = sdiv_safe64(next_stride_161375, merge_block_sizze_161260);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396 = add64((int64_t) 1, num_blocks_161395);
            int64_t j_m_i_161397 = sub64(next_stride_161375, stride_161374);
            int64_t flat_dim_161398 = merge_block_sizze_161260 * num_blocks_161395;
            bool bounds_invalid_upwards_161399 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, (int64_t) 0);
            bool empty_slice_161400 = j_m_i_161397 == (int64_t) 0;
            int64_t m_161401 = sub64(j_m_i_161397, (int64_t) 1);
            bool zzero_lte_i_161402 = sle64((int64_t) 0, stride_161374);
            bool i_lte_j_161403 = sle64(stride_161374, next_stride_161375);
            bool empty_slice_161404 = stride_161374 == (int64_t) 0;
            int64_t m_161405 = sub64(stride_161374, (int64_t) 1);
            bool bounds_invalid_upwards_161406 = slt64(num_blocks_161395, (int64_t) 0);
            bool cond_161407 = slt64((int64_t) 0, stride_161374);
            bool valid_161408 = !bounds_invalid_upwards_161399;
            int64_t i_p_m_t_s_161409 = add64(stride_161374, m_161401);
            bool zzero_leq_i_p_m_t_s_161410 = sle64((int64_t) 0, m_161405);
            bool i_p_m_t_s_leq_w_161411 = slt64(m_161405, next_stride_161375);
            bool valid_161412 = !bounds_invalid_upwards_161406;
            bool i_p_m_t_s_leq_w_161413 = slt64(m_161384, flat_dim_161398);
            bool y_161414 = slt64((int64_t) 0, j_m_i_161397);
            bool protect_assert_disj_161415 = cond_161387 || valid_161408;
            bool range_valid_c_161416;
            
            if (!protect_assert_disj_161415) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:138:31-35\n   #10 ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161417 = sle64((int64_t) 0, i_p_m_t_s_161409);
            bool i_p_m_t_s_leq_w_161418 = slt64(i_p_m_t_s_161409, next_stride_161375);
            bool y_161419 = zzero_leq_i_p_m_t_s_161410 && i_p_m_t_s_leq_w_161411;
            bool protect_assert_disj_161420 = cond_161387 || valid_161412;
            bool range_valid_c_161421;
            
            if (!protect_assert_disj_161420) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161395, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161422 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161413;
            bool y_161423 = zzero_lte_i_161402 && i_p_m_t_s_leq_w_161418;
            bool forwards_ok_161424 = zzero_lte_i_161402 && y_161419;
            bool ok_or_empty_161425 = zzero_161376 || y_161422;
            bool protect_assert_disj_161426 = cond_161407 || y_161414;
            bool y_161427 = zzero_leq_i_p_m_t_s_161417 && y_161423;
            bool ok_or_empty_161428 = empty_slice_161404 || forwards_ok_161424;
            bool protect_assert_disj_161429 = cond_161387 || ok_or_empty_161425;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) flat_dim_161398, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161431 = !cond_161387;
            bool protect_assert_disj_161432 = protect_assert_disj_161426 || loop_not_taken_161431;
            bool index_certs_161433;
            
            if (!protect_assert_disj_161432) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:138:31-35\n   #10 ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161434 = i_lte_j_161403 && y_161427;
            bool protect_assert_disj_161435 = cond_161387 || ok_or_empty_161428;
            bool index_certs_161436;
            
            if (!protect_assert_disj_161435) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:138:31-35\n   #11 ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161437 = ok_or_empty_161428 || loop_not_taken_161431;
            bool index_certs_161438;
            
            if (!protect_assert_disj_161437) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161439 = empty_slice_161400 || forwards_ok_161434;
            bool protect_assert_disj_161440 = cond_161387 || ok_or_empty_161439;
            bool index_certs_161441;
            
            if (!protect_assert_disj_161440) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:138:31-35\n   #11 ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161442 = loop_not_taken_161431 || ok_or_empty_161439;
            bool index_certs_161443;
            
            if (!protect_assert_disj_161442) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 4 * num_merges_161379;
            int64_t bytes_171361 = next_stride_161375 * binop_x_171360;
            int64_t binop_x_171363 = (int64_t) 8 * num_merges_161379;
            int64_t bytes_171364 = next_stride_161375 * binop_x_171363;
            bool i_lte_j_161386 = sle64((int64_t) 0, next_stride_161375);
            
            if (mem_171362_cached_sizze_172372 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172372, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172373 < bytes_171364) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172373, bytes_171364);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396;
            int64_t binop_x_171390 = (int64_t) 4 * num_blocks_161395;
            int64_t bytes_171391 = merge_block_sizze_161260 * binop_x_171390;
            int64_t binop_x_171393 = (int64_t) 8 * num_blocks_161395;
            int64_t bytes_171394 = merge_block_sizze_161260 * binop_x_171393;
            int64_t bytes_171436 = (int64_t) 8 * stride_161374;
            int64_t bytes_171438 = (int64_t) 16 * stride_161374;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161379; i_171036++) {
                int64_t start_161447 = mul64(next_stride_161375, i_171036);
                int64_t j_m_i_161448 = sub64(loop_dz2084Uz2082U_161370, start_161447);
                bool empty_slice_161449 = j_m_i_161448 == (int64_t) 0;
                int64_t m_161450 = sub64(j_m_i_161448, (int64_t) 1);
                int64_t i_p_m_t_s_161451 = add64(start_161447, m_161450);
                bool zzero_leq_i_p_m_t_s_161452 = sle64((int64_t) 0, i_p_m_t_s_161451);
                bool i_p_m_t_s_leq_w_161453 = slt64(i_p_m_t_s_161451, loop_dz2084Uz2082U_161370);
                bool zzero_lte_i_161454 = sle64((int64_t) 0, start_161447);
                bool i_lte_j_161455 = sle64(start_161447, loop_dz2084Uz2082U_161370);
                bool y_161456 = i_p_m_t_s_leq_w_161453 && zzero_lte_i_161454;
                bool y_161457 = zzero_leq_i_p_m_t_s_161452 && y_161456;
                bool forwards_ok_161458 = i_lte_j_161455 && y_161457;
                bool ok_or_empty_161459 = empty_slice_161449 || forwards_ok_161458;
                bool index_certs_161460;
                
                if (!ok_or_empty_161459) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161447, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161370, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161461 = slt64(m_161384, j_m_i_161448);
                bool y_161462 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161461;
                bool forwards_ok_161463 = i_lte_j_161386 && y_161462;
                bool ok_or_empty_161464 = zzero_161376 || forwards_ok_161463;
                bool index_certs_161465;
                
                if (!ok_or_empty_161464) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) j_m_i_161448, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:138:31-35\n   #8  ftRelational.fut:137:5-138:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161387) {
                    int32_t dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161407) {
                        int32_t head_res_162008 = ((int32_t *) mem_param_171356.mem)[start_161447];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161447];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161374 + start_161447;
                        int32_t head_res_162011 = ((int32_t *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161375; nest_i_171983++) {
                        ((int32_t *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171438, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161375; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161375; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161397;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161374);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161397);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161374 + j_162022;
                                int64_t slice_162032 = start_161447 + slice_162031;
                                int32_t leq_arg1_162033 = ((int32_t *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161447 + i_162019;
                                int32_t leq_arg0_162038 = ((int32_t *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = sle32(leq_arg0_162038, leq_arg1_162033);
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        int32_t loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161374);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161447 + i_162019;
                            int32_t tmp_162049 = ((int32_t *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161397);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:138:31-35\n   #9  ftRelational.fut:137:5-138:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161374 + j_162022;
                            int64_t slice_162056 = start_161447 + slice_162055;
                            int32_t tmp_162057 = ((int32_t *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((int32_t *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172374 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172374, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172375 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172375, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396; i_171022++) {
                        int64_t split_count_arg3_161527 = mul64(merge_block_sizze_161260, i_171022);
                        int64_t defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161528, &defunc_0_split_count_res_161529, &defunc_0_split_count_res_161530, &defunc_0_split_count_res_161531, &defunc_0_split_count_res_161532, (int64_t) 0, stride_161374, (int64_t) 0, j_m_i_161397, split_count_arg3_161527) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161533 = slt64((int64_t) 0, defunc_0_split_count_res_161532);
                        bool defunc_0_split_count_res_161534;
                        int64_t defunc_0_split_count_res_161535;
                        int64_t defunc_0_split_count_res_161536;
                        int64_t defunc_0_split_count_res_161537;
                        int64_t defunc_0_split_count_res_161538;
                        int64_t defunc_0_split_count_res_161539;
                        bool loop_while_161540;
                        int64_t ss_161541;
                        int64_t ss_161542;
                        int64_t tt_161543;
                        int64_t tt_161544;
                        int64_t count_161545;
                        
                        loop_while_161540 = loop_cond_161533;
                        ss_161541 = defunc_0_split_count_res_161528;
                        ss_161542 = defunc_0_split_count_res_161529;
                        tt_161543 = defunc_0_split_count_res_161530;
                        tt_161544 = defunc_0_split_count_res_161531;
                        count_161545 = defunc_0_split_count_res_161532;
                        while (loop_while_161540) {
                            int64_t zlze_lhs_161546 = sub64(ss_161542, ss_161541);
                            bool cond_161547 = sle64(zlze_lhs_161546, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161548;
                            int64_t defunc_0_lifted_step_res_161549;
                            int64_t defunc_0_lifted_step_res_161550;
                            int64_t defunc_0_lifted_step_res_161551;
                            
                            if (cond_161547) {
                                int64_t tmp_162061 = add64(tt_161543, count_161545);
                                
                                defunc_0_lifted_step_res_161548 = ss_161541;
                                defunc_0_lifted_step_res_161549 = tmp_162061;
                                defunc_0_lifted_step_res_161550 = tt_161544;
                                defunc_0_lifted_step_res_161551 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161553 = sub64(tt_161544, tt_161543);
                                bool cond_161554 = sle64(zlze_lhs_161553, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161555;
                                int64_t defunc_0_lifted_step_res_f_res_161556;
                                int64_t defunc_0_lifted_step_res_f_res_161557;
                                int64_t defunc_0_lifted_step_res_f_res_161558;
                                
                                if (cond_161554) {
                                    int64_t tmp_162062 = add64(ss_161541, count_161545);
                                    
                                    defunc_0_lifted_step_res_f_res_161555 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161556 = tt_161543;
                                    defunc_0_lifted_step_res_f_res_161557 = tt_161544;
                                    defunc_0_lifted_step_res_f_res_161558 = (int64_t) 0;
                                } else {
                                    bool cond_161560 = count_161545 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161561;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161562;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161563;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161564;
                                    
                                    if (cond_161560) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161541);
                                        bool y_162065 = slt64(ss_161541, stride_161374);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161541, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:138:31-35\n   #13 ftRelational.fut:137:5-138:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161543);
                                        bool y_162071 = slt64(tt_161543, j_m_i_161397);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161543, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:138:31-35\n   #13 ftRelational.fut:137:5-138:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161447 + ss_161541;
                                        int32_t leq_arg1_162069 = ((int32_t *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161374 + tt_161543;
                                        int64_t slice_162075 = start_161447 + slice_162074;
                                        int32_t leq_arg0_162076 = ((int32_t *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = sle32(leq_arg0_162076, leq_arg1_162069);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161543);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161541;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161541);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161543;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = tt_161544;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = (int64_t) 0;
                                    } else {
                                        int64_t m_161583 = sdiv64(count_161545, (int64_t) 2);
                                        int64_t n_161584 = sub64(count_161545, m_161583);
                                        bool cond_161585 = n_161584 == (int64_t) 0;
                                        int64_t zgze_lhs_161586 = add64(ss_161541, m_161583);
                                        bool cond_f_res_161587 = sle64(ss_161542, zgze_lhs_161586);
                                        bool x_161588 = !cond_161585;
                                        bool y_161589 = cond_f_res_161587 && x_161588;
                                        bool cond_161590 = cond_161585 || y_161589;
                                        bool leq_y_x_161591;
                                        
                                        if (cond_161590) {
                                            leq_y_x_161591 = 1;
                                        } else {
                                            bool x_161592 = sle64((int64_t) 0, zgze_lhs_161586);
                                            bool y_161593 = slt64(zgze_lhs_161586, stride_161374);
                                            bool bounds_check_161594 = x_161592 && y_161593;
                                            bool index_certs_161595;
                                            
                                            if (!bounds_check_161594) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161586, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:138:31-35\n   #13 ftRelational.fut:137:5-138:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161598 = add64(tt_161543, n_161584);
                                            int64_t leq_arg0_161599 = sub64(zm_lhs_161598, (int64_t) 1);
                                            bool x_161600 = sle64((int64_t) 0, leq_arg0_161599);
                                            bool y_161601 = slt64(leq_arg0_161599, j_m_i_161397);
                                            bool bounds_check_161602 = x_161600 && y_161601;
                                            bool index_certs_161603;
                                            
                                            if (!bounds_check_161602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161599, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:138:31-35\n   #13 ftRelational.fut:137:5-138:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161596 = start_161447 + zgze_lhs_161586;
                                            int32_t leq_arg1_161597 = ((int32_t *) mem_param_171356.mem)[slice_161596];
                                            int64_t slice_161604 = stride_161374 + leq_arg0_161599;
                                            int64_t slice_161605 = start_161447 + slice_161604;
                                            int32_t leq_arg0_161606 = ((int32_t *) mem_param_171356.mem)[slice_161605];
                                            bool defunc_0_leq_res_161607 = sle32(leq_arg0_161606, leq_arg1_161597);
                                            
                                            leq_y_x_161591 = defunc_0_leq_res_161607;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                        
                                        if (leq_y_x_161591) {
                                            int64_t tmp_162082 = add64(tt_161543, n_161584);
                                            int64_t tmp_162083 = sub64(count_161545, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tt_161544;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = tmp_162083;
                                        } else {
                                            int64_t tmp_161613 = add64(tt_161543, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tt_161543;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tmp_161613;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = count_161545;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = ss_161541;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                    }
                                    defunc_0_lifted_step_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_161561;
                                    defunc_0_lifted_step_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_161562;
                                    defunc_0_lifted_step_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_161563;
                                    defunc_0_lifted_step_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_161564;
                                }
                                defunc_0_lifted_step_res_161548 = defunc_0_lifted_step_res_f_res_161555;
                                defunc_0_lifted_step_res_161549 = defunc_0_lifted_step_res_f_res_161556;
                                defunc_0_lifted_step_res_161550 = defunc_0_lifted_step_res_f_res_161557;
                                defunc_0_lifted_step_res_161551 = defunc_0_lifted_step_res_f_res_161558;
                            }
                            
                            int64_t loopres_161614;
                            int64_t loopres_161615;
                            int64_t loopres_161616;
                            int64_t loopres_161617;
                            int64_t loopres_161618;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161614, &loopres_161615, &loopres_161616, &loopres_161617, &loopres_161618, defunc_0_lifted_step_res_161548, ss_161542, defunc_0_lifted_step_res_161549, defunc_0_lifted_step_res_161550, defunc_0_lifted_step_res_161551) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161619 = slt64((int64_t) 0, loopres_161618);
                            bool loop_while_tmp_171990 = loop_cond_161619;
                            int64_t ss_tmp_171991 = loopres_161614;
                            int64_t ss_tmp_171992 = loopres_161615;
                            int64_t tt_tmp_171993 = loopres_161616;
                            int64_t tt_tmp_171994 = loopres_161617;
                            int64_t count_tmp_171995 = loopres_161618;
                            
                            loop_while_161540 = loop_while_tmp_171990;
                            ss_161541 = ss_tmp_171991;
                            ss_161542 = ss_tmp_171992;
                            tt_161543 = tt_tmp_171993;
                            tt_161544 = tt_tmp_171994;
                            count_161545 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161534 = loop_while_161540;
                        defunc_0_split_count_res_161535 = ss_161541;
                        defunc_0_split_count_res_161536 = ss_161542;
                        defunc_0_split_count_res_161537 = tt_161543;
                        defunc_0_split_count_res_161538 = tt_161544;
                        defunc_0_split_count_res_161539 = count_161545;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161535;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161537;
                    }
                    if (mem_171392_cached_sizze_172376 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172376, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172377 < bytes_171394) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172377, bytes_171394);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161395; i_171029++) {
                        bool y_161625 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool index_certs_161627;
                        
                        if (!y_161625) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:138:31-35\n   #10 ftRelational.fut:137:5-138:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161628 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161630 = add64((int64_t) 1, i_171029);
                        bool x_161631 = sle64((int64_t) 0, tmp_161630);
                        bool y_161632 = slt64(tmp_161630, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool bounds_check_161633 = x_161631 && y_161632;
                        bool index_certs_161634;
                        
                        if (!bounds_check_161633) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161630, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:138:31-35\n   #10 ftRelational.fut:137:5-138:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161635 = ((int64_t *) mem_171375)[tmp_161630];
                        int64_t defunc_0_f_res_161636 = ((int64_t *) mem_171377)[tmp_161630];
                        int64_t merge_sequential_arg2_161637 = add64(stride_161374, defunc_0_f_res_161629);
                        int64_t merge_sequential_arg2_161638 = add64(stride_161374, defunc_0_f_res_161636);
                        int64_t j_m_i_161639 = sub64(merge_sequential_arg2_161638, merge_sequential_arg2_161637);
                        bool empty_slice_161640 = j_m_i_161639 == (int64_t) 0;
                        int64_t m_161641 = sub64(j_m_i_161639, (int64_t) 1);
                        int64_t i_p_m_t_s_161642 = add64(merge_sequential_arg2_161637, m_161641);
                        bool zzero_leq_i_p_m_t_s_161643 = sle64((int64_t) 0, i_p_m_t_s_161642);
                        bool i_p_m_t_s_leq_w_161644 = slt64(i_p_m_t_s_161642, next_stride_161375);
                        bool zzero_lte_i_161645 = sle64((int64_t) 0, merge_sequential_arg2_161637);
                        bool i_lte_j_161646 = sle64(merge_sequential_arg2_161637, merge_sequential_arg2_161638);
                        bool y_161647 = i_p_m_t_s_leq_w_161644 && zzero_lte_i_161645;
                        bool y_161648 = zzero_leq_i_p_m_t_s_161643 && y_161647;
                        bool forwards_ok_161649 = i_lte_j_161646 && y_161648;
                        bool ok_or_empty_161650 = empty_slice_161640 || forwards_ok_161649;
                        bool index_certs_161651;
                        
                        if (!ok_or_empty_161650) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161637, ":", (long long) merge_sequential_arg2_161638, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:138:31-35\n   #10 ftRelational.fut:137:5-138:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161652 = sub64(defunc_0_f_res_161635, defunc_0_f_res_161628);
                        bool empty_slice_161653 = j_m_i_161652 == (int64_t) 0;
                        int64_t m_161654 = sub64(j_m_i_161652, (int64_t) 1);
                        int64_t i_p_m_t_s_161655 = add64(defunc_0_f_res_161628, m_161654);
                        bool zzero_leq_i_p_m_t_s_161656 = sle64((int64_t) 0, i_p_m_t_s_161655);
                        bool i_p_m_t_s_leq_w_161657 = slt64(i_p_m_t_s_161655, next_stride_161375);
                        bool zzero_lte_i_161658 = sle64((int64_t) 0, defunc_0_f_res_161628);
                        bool i_lte_j_161659 = sle64(defunc_0_f_res_161628, defunc_0_f_res_161635);
                        bool y_161660 = i_p_m_t_s_leq_w_161657 && zzero_lte_i_161658;
                        bool y_161661 = zzero_leq_i_p_m_t_s_161656 && y_161660;
                        bool forwards_ok_161662 = i_lte_j_161659 && y_161661;
                        bool ok_or_empty_161663 = empty_slice_161653 || forwards_ok_161662;
                        bool index_certs_161664;
                        
                        if (!ok_or_empty_161663) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161628, ":", (long long) defunc_0_f_res_161635, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:138:31-35\n   #10 ftRelational.fut:137:5-138:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161665 = slt64((int64_t) 0, j_m_i_161652);
                        int32_t dummy_161666;
                        int64_t dummy_161667;
                        
                        if (cond_161665) {
                            bool index_certs_162084;
                            
                            if (!cond_161665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:138:31-35\n   #12 ftRelational.fut:137:5-138:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161447 + defunc_0_f_res_161628;
                            int32_t head_res_162086 = ((int32_t *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161666 = head_res_162086;
                            dummy_161667 = head_res_162087;
                        } else {
                            bool y_161672 = slt64((int64_t) 0, j_m_i_161639);
                            bool index_certs_161673;
                            
                            if (!y_161672) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:138:31-35\n   #12 ftRelational.fut:137:5-138:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161674 = start_161447 + merge_sequential_arg2_161637;
                            int32_t head_res_161675 = ((int32_t *) mem_param_171356.mem)[slice_161674];
                            int64_t head_res_161676 = ((int64_t *) mem_param_171359.mem)[slice_161674];
                            
                            dummy_161666 = head_res_161675;
                            dummy_161667 = head_res_161676;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161260; nest_i_171998++) {
                            ((int32_t *) mem_171392)[i_171029 * merge_block_sizze_161260 + nest_i_171998] = dummy_161666;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161260; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + nest_i_171999] = dummy_161667;
                        }
                        
                        int64_t data_161679;
                        int64_t i_161683 = (int64_t) 0;
                        
                        for (int64_t k_161682 = 0; k_161682 < merge_block_sizze_161260; k_161682++) {
                            int64_t j_161686 = sub64(k_161682, i_161683);
                            bool cond_161687 = j_161686 == j_m_i_161639;
                            bool cond_161688;
                            
                            if (cond_161687) {
                                cond_161688 = 1;
                            } else {
                                bool cond_161689 = slt64(i_161683, j_m_i_161652);
                                bool cond_f_res_161690;
                                
                                if (cond_161689) {
                                    bool x_162088 = sle64((int64_t) 0, j_161686);
                                    bool y_162089 = slt64(j_161686, j_m_i_161639);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:138:31-35\n   #11 ftRelational.fut:137:5-138:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161683);
                                    bool bounds_check_162096 = cond_161689 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:138:31-35\n   #11 ftRelational.fut:137:5-138:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161637 + j_161686;
                                    int64_t slice_162093 = start_161447 + slice_162092;
                                    int32_t leq_arg1_162094 = ((int32_t *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161628 + i_161683;
                                    int64_t slice_162099 = start_161447 + slice_162098;
                                    int32_t leq_arg0_162100 = ((int32_t *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = sle32(leq_arg0_162100, leq_arg1_162094);
                                    
                                    cond_f_res_161690 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161690 = 0;
                                }
                                cond_161688 = cond_f_res_161690;
                            }
                            
                            int64_t loopres_161705;
                            int32_t loopres_161706;
                            int64_t loopres_161707;
                            
                            if (cond_161688) {
                                bool x_162103 = sle64((int64_t) 0, i_161683);
                                bool y_162104 = slt64(i_161683, j_m_i_161652);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:138:31-35\n   #11 ftRelational.fut:137:5-138:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161683);
                                int64_t slice_162107 = defunc_0_f_res_161628 + i_161683;
                                int64_t slice_162108 = start_161447 + slice_162107;
                                int32_t tmp_162109 = ((int32_t *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161705 = tmp_162102;
                                loopres_161706 = tmp_162109;
                                loopres_161707 = tmp_162110;
                            } else {
                                bool x_161717 = sle64((int64_t) 0, j_161686);
                                bool y_161718 = slt64(j_161686, j_m_i_161639);
                                bool bounds_check_161719 = x_161717 && y_161718;
                                bool index_certs_161720;
                                
                                if (!bounds_check_161719) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:138:31-35\n   #11 ftRelational.fut:137:5-138:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161721 = merge_sequential_arg2_161637 + j_161686;
                                int64_t slice_161722 = start_161447 + slice_161721;
                                int32_t tmp_161723 = ((int32_t *) mem_param_171356.mem)[slice_161722];
                                int64_t tmp_161724 = ((int64_t *) mem_param_171359.mem)[slice_161722];
                                
                                loopres_161705 = i_161683;
                                loopres_161706 = tmp_161723;
                                loopres_161707 = tmp_161724;
                            }
                            ((int32_t *) mem_171392)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161706;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161707;
                            
                            int64_t i_tmp_172000 = loopres_161705;
                            
                            i_161683 = i_tmp_172000;
                        }
                        data_161679 = i_161683;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint32_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171394, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171362, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161731 = next_stride_161375 * num_merges_161379;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint32_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            if (memblock_alloc(ctx, &mem_171472, bytes_171364, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            
            bool loop_cond_161734 = slt64(next_stride_161375, flat_dim_161256);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161731;
            bool loop_while_tmp_171977 = loop_cond_161734;
            int64_t stride_tmp_171980 = next_stride_161375;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161370 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161371 = loop_while_tmp_171977;
            stride_161374 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161365 = loop_dz2084Uz2082U_161370;
        data_161366 = loop_while_161371;
        data_161369 = stride_161374;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161735 = n_106937 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161736 = sle64((int64_t) 0, zs_lhs_161240);
        bool i_p_m_t_s_leq_w_161737 = slt64(zs_lhs_161240, data_161365);
        bool y_161738 = zzero_leq_i_p_m_t_s_161736 && i_p_m_t_s_leq_w_161737;
        bool ok_or_empty_161739 = empty_slice_161735 || y_161738;
        bool index_certs_161740;
        
        if (!ok_or_empty_161739) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_106937, "] out of bounds for array of shape [", (long long) data_161365, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:138:31-35\n   #6  ftRelational.fut:137:5-138:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_106937; i_171043++) {
        int64_t eta_p_161748 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161749 = sle64((int64_t) 0, eta_p_161748);
        bool y_161750 = slt64(eta_p_161748, n_106937);
        bool bounds_check_161751 = x_161749 && y_161750;
        bool index_certs_161752;
        
        if (!bounds_check_161751) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161748, "] out of bounds for array of shape [", (long long) n_106937, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:138:31-35\n   #5  ftRelational.fut:137:5-138:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_161753 = ((int64_t *) ext_mem_171275.mem)[eta_p_161748];
        int32_t lifted_lambda_res_161754 = ((int32_t *) xs_mem_171274.mem)[eta_p_161748];
        
        ((int64_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161753;
        ((int32_t *) mem_171486.mem)[i_171043] = lifted_lambda_res_161754;
    }
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172366, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172367, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_172378, struct memblock *mem_out_p_172379, struct memblock xs_mem_171274, int64_t n_109078, int64_t incr_109079)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172380 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172381 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172382 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172383 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172384 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172385 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172386 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172387 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172388 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172389 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_109078;
    bool cond_161239 = sle64(n_109078, (int64_t) 1);
    int64_t zs_lhs_161240 = sub64(n_109078, (int64_t) 1);
    int64_t zp_rhs_161241 = sdiv_safe64(zs_lhs_161240, (int64_t) 20);
    int64_t min_num_blocks_161242 = add64((int64_t) 1, zp_rhs_161241);
    bool loop_cond_161243 = slt64((int64_t) 1, min_num_blocks_161242);
    bool smallest_pow_2_geq_than_res_161244;
    int64_t smallest_pow_2_geq_than_res_161245;
    bool loop_while_161246;
    int64_t x_161247;
    
    loop_while_161246 = loop_cond_161243;
    x_161247 = (int64_t) 1;
    while (loop_while_161246) {
        int64_t loopres_161248 = mul64((int64_t) 2, x_161247);
        bool loop_cond_161249 = slt64(loopres_161248, min_num_blocks_161242);
        bool loop_while_tmp_171958 = loop_cond_161249;
        int64_t x_tmp_171959 = loopres_161248;
        
        loop_while_161246 = loop_while_tmp_171958;
        x_161247 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161244 = loop_while_161246;
    smallest_pow_2_geq_than_res_161245 = x_161247;
    
    bool zzero_161250 = smallest_pow_2_geq_than_res_161245 == (int64_t) 0;
    bool nonzzero_161251 = !zzero_161250;
    bool protect_assert_disj_161252 = cond_161239 || nonzzero_161251;
    bool nonzzero_cert_161253;
    
    if (!protect_assert_disj_161252) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:140:31-35\n   #5  ftRelational.fut:139:5-140:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161254 = sdiv_safe64(zs_lhs_161240, smallest_pow_2_geq_than_res_161245);
    int64_t block_sizze_161255 = add64((int64_t) 1, zp_rhs_161254);
    bool y_161261 = slt64((int64_t) 0, n_109078);
    bool protect_assert_disj_171871 = cond_161239 || y_161261;
    bool index_certs_161262;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_109078, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:140:31-35\n   #5  ftRelational.fut:139:5-140:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161276 = slt64(smallest_pow_2_geq_than_res_161245, (int64_t) 0);
    bool valid_161277 = !bounds_invalid_upwards_161276;
    bool protect_assert_disj_171879 = cond_161239 || valid_161277;
    bool range_valid_c_161278;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161245, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:140:31-35\n   #6  ftRelational.fut:139:5-140:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161280 = slt64(block_sizze_161255, (int64_t) 0);
    bool valid_161281 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_171881 = cond_161239 || valid_161281;
    bool range_valid_c_161282;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161255, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161284 = sle64(block_sizze_161255, (int64_t) 1);
    int64_t tmp_161285 = sub64(block_sizze_161255, (int64_t) 2);
    bool bounds_invalid_upwards_161286 = slt64(tmp_161285, (int64_t) 0);
    bool valid_161288 = !bounds_invalid_upwards_161286;
    bool protect_assert_disj_161289 = cond_161284 || valid_161288;
    bool protect_assert_disj_171883 = cond_161239 || protect_assert_disj_161289;
    bool range_valid_c_161290;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161285, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_16299(ctx, &ext_mem_171275, xs_mem_171274, n_109078, incr_109079) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_109078; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161256 = smallest_pow_2_geq_than_res_161245 * block_sizze_161255;
    bool x_171866 = !cond_161239;
    int64_t greatest_divisor_leq_than_arg1_161259 = mul64((int64_t) 2, block_sizze_161255);
    int64_t merge_block_sizze_161260;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161259) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161260 = x_171868;
    } else {
        merge_block_sizze_161260 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_161263;
    
    if (x_171866) {
        int64_t x_171872 = ((int64_t *) xs_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161263 = x_171872;
    } else {
        reduce_arg1_161263 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        int64_t x_171874;
        int64_t x_171875;
        int64_t redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161263;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_109078; i_171003++) {
            int64_t x_161267 = ((int64_t *) xs_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161273 = sle64(redout_171001, x_161267);
            int64_t defunc_0_op_res_161274;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161274 = x_161267;
            } else {
                defunc_0_op_res_161274 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161275;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161275 = i_171003;
            } else {
                defunc_0_op_res_161275 = redout_171002;
            }
            
            int64_t redout_tmp_171962 = defunc_0_op_res_161274;
            int64_t redout_tmp_171963 = defunc_0_op_res_161275;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = (int64_t) 0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161287 = add64((int64_t) 1, tmp_161285);
    int64_t binop_x_171278 = (int64_t) 8 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171279 = block_sizze_161255 * binop_x_171278;
    int64_t bytes_171292 = (int64_t) 8 * block_sizze_161255;
    bool loop_cond_161362 = slt64(block_sizze_161255, flat_dim_161256);
    bool zzero_161363 = merge_block_sizze_161260 == (int64_t) 0;
    bool nonzzero_161364 = !zzero_161363;
    
    if (cond_161239) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172380 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172380, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172381 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172381, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172382 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172382, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172383 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172383, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161245; i_171015++) {
            int64_t zp_lhs_161294 = mul64(block_sizze_161255, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161255; i_171008++) {
                int64_t k_161298 = add64(zp_lhs_161294, i_171008);
                bool cond_161299 = slt64(k_161298, n_109078);
                int64_t lifted_lambda_res_161300;
                int64_t lifted_lambda_res_161301;
                
                if (cond_161299) {
                    bool x_161970 = sle64((int64_t) 0, k_161298);
                    bool bounds_check_161971 = cond_161299 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161298, "] out of bounds for array of shape [", (long long) n_109078, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_161973 = ((int64_t *) xs_mem_171274.mem)[k_161298];
                    
                    lifted_lambda_res_161300 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161301 = k_161298;
                } else {
                    lifted_lambda_res_161300 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161301 = defunc_0_reduce_res_162118;
                }
                ((int64_t *) mem_171293)[i_171008] = lifted_lambda_res_161300;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161301;
            }
            if (!cond_161284) {
                for (int64_t i_161311 = 0; i_161311 < distance_161287; i_161311++) {
                    int64_t gt_arg1_161314 = add64((int64_t) 1, i_161311);
                    bool x_161315 = sle64((int64_t) 0, gt_arg1_161314);
                    bool y_161316 = slt64(gt_arg1_161314, block_sizze_161255);
                    bool bounds_check_161317 = x_161315 && y_161316;
                    bool index_certs_161318;
                    
                    if (!bounds_check_161317) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161314, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161320 = slt64(i_161311, block_sizze_161255);
                    bool index_certs_161321;
                    
                    if (!y_161320) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161311, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_161319 = ((int64_t *) mem_171293)[gt_arg1_161314];
                    int64_t gt_arg0_161322 = ((int64_t *) mem_171293)[i_161311];
                    bool defunc_0_leq_res_161323 = sle64(gt_arg0_161322, gt_arg1_161319);
                    bool defunc_0_lifted_gt_res_161324 = !defunc_0_leq_res_161323;
                    bool s_161325;
                    int64_t s_161328;
                    bool loop_while_161329;
                    int64_t j_161332;
                    
                    loop_while_161329 = defunc_0_lifted_gt_res_161324;
                    j_161332 = i_161311;
                    while (loop_while_161329) {
                        bool x_161333 = sle64((int64_t) 0, j_161332);
                        bool y_161334 = slt64(j_161332, block_sizze_161255);
                        bool bounds_check_161335 = x_161333 && y_161334;
                        bool index_certs_161336;
                        
                        if (!bounds_check_161335) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161332, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161339 = add64((int64_t) 1, j_161332);
                        bool x_161340 = sle64((int64_t) 0, copy_arg0_161339);
                        bool y_161341 = slt64(copy_arg0_161339, block_sizze_161255);
                        bool bounds_check_161342 = x_161340 && y_161341;
                        bool index_certs_161343;
                        
                        if (!bounds_check_161342) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161339, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161337 = ((int64_t *) mem_171293)[j_161332];
                        int64_t copy_arg0_161338 = ((int64_t *) mem_171295)[j_161332];
                        int64_t copy_arg0_161344 = ((int64_t *) mem_171293)[copy_arg0_161339];
                        int64_t copy_arg0_161345 = ((int64_t *) mem_171295)[copy_arg0_161339];
                        
                        ((int64_t *) mem_171293)[j_161332] = copy_arg0_161344;
                        ((int64_t *) mem_171295)[j_161332] = copy_arg0_161345;
                        ((int64_t *) mem_171293)[copy_arg0_161339] = copy_arg0_161337;
                        ((int64_t *) mem_171295)[copy_arg0_161339] = copy_arg0_161338;
                        
                        int64_t tmp_161350 = sub64(j_161332, (int64_t) 1);
                        bool cond_161351 = sle64((int64_t) 0, tmp_161350);
                        bool loop_cond_161352;
                        
                        if (cond_161351) {
                            bool y_161975 = slt64(tmp_161350, block_sizze_161255);
                            bool bounds_check_161976 = cond_161351 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161350, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_161974 = ((int64_t *) mem_171293)[j_161332];
                            int64_t gt_arg0_161978 = ((int64_t *) mem_171293)[tmp_161350];
                            bool defunc_0_leq_res_161979 = sle64(gt_arg0_161978, gt_arg1_161974);
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161352 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161352 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161352;
                        int64_t j_tmp_171973 = tmp_161350;
                        
                        loop_while_161329 = loop_while_tmp_171970;
                        j_161332 = j_tmp_171973;
                    }
                    s_161325 = loop_while_161329;
                    s_161328 = j_161332;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171280, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        if (memblock_alloc(ctx, &mem_171352, bytes_171279, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        
        int64_t data_161365;
        bool data_161366;
        int64_t data_161369;
        int64_t loop_dz2084Uz2082U_161370;
        bool loop_while_161371;
        int64_t stride_161374;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161370 = flat_dim_161256;
        loop_while_161371 = loop_cond_161362;
        stride_161374 = block_sizze_161255;
        while (loop_while_161371) {
            int64_t next_stride_161375 = mul64((int64_t) 2, stride_161374);
            bool zzero_161376 = next_stride_161375 == (int64_t) 0;
            bool nonzzero_161377 = !zzero_161376;
            bool nonzzero_cert_161378;
            
            if (!nonzzero_161377) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:140:31-35\n   #5  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161379 = sdiv64(flat_dim_161256, next_stride_161375);
            bool bounds_invalid_upwards_161380 = slt64(num_merges_161379, (int64_t) 0);
            bool valid_161381 = !bounds_invalid_upwards_161380;
            bool range_valid_c_161382;
            
            if (!valid_161381) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161379, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:140:31-35\n   #6  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161384 = sub64(next_stride_161375, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161385 = sle64((int64_t) 0, m_161384);
            bool cond_161387 = slt64(next_stride_161375, (int64_t) 10);
            bool protect_assert_disj_161388 = nonzzero_161364 || cond_161387;
            bool nonzzero_cert_161389;
            
            if (!protect_assert_disj_161388) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161390 = smod_safe64(next_stride_161375, merge_block_sizze_161260);
            bool num_blocks_161391 = zeze_lhs_161390 == (int64_t) 0;
            bool protect_assert_disj_161392 = cond_161387 || num_blocks_161391;
            bool assert_c_161393;
            
            if (!protect_assert_disj_161392) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161395 = sdiv_safe64(next_stride_161375, merge_block_sizze_161260);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396 = add64((int64_t) 1, num_blocks_161395);
            int64_t j_m_i_161397 = sub64(next_stride_161375, stride_161374);
            int64_t flat_dim_161398 = merge_block_sizze_161260 * num_blocks_161395;
            bool bounds_invalid_upwards_161399 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, (int64_t) 0);
            bool empty_slice_161400 = j_m_i_161397 == (int64_t) 0;
            int64_t m_161401 = sub64(j_m_i_161397, (int64_t) 1);
            bool zzero_lte_i_161402 = sle64((int64_t) 0, stride_161374);
            bool i_lte_j_161403 = sle64(stride_161374, next_stride_161375);
            bool empty_slice_161404 = stride_161374 == (int64_t) 0;
            int64_t m_161405 = sub64(stride_161374, (int64_t) 1);
            bool bounds_invalid_upwards_161406 = slt64(num_blocks_161395, (int64_t) 0);
            bool cond_161407 = slt64((int64_t) 0, stride_161374);
            bool valid_161408 = !bounds_invalid_upwards_161399;
            int64_t i_p_m_t_s_161409 = add64(stride_161374, m_161401);
            bool zzero_leq_i_p_m_t_s_161410 = sle64((int64_t) 0, m_161405);
            bool i_p_m_t_s_leq_w_161411 = slt64(m_161405, next_stride_161375);
            bool valid_161412 = !bounds_invalid_upwards_161406;
            bool i_p_m_t_s_leq_w_161413 = slt64(m_161384, flat_dim_161398);
            bool y_161414 = slt64((int64_t) 0, j_m_i_161397);
            bool protect_assert_disj_161415 = cond_161387 || valid_161408;
            bool range_valid_c_161416;
            
            if (!protect_assert_disj_161415) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:140:31-35\n   #10 ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161417 = sle64((int64_t) 0, i_p_m_t_s_161409);
            bool i_p_m_t_s_leq_w_161418 = slt64(i_p_m_t_s_161409, next_stride_161375);
            bool y_161419 = zzero_leq_i_p_m_t_s_161410 && i_p_m_t_s_leq_w_161411;
            bool protect_assert_disj_161420 = cond_161387 || valid_161412;
            bool range_valid_c_161421;
            
            if (!protect_assert_disj_161420) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161395, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161422 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161413;
            bool y_161423 = zzero_lte_i_161402 && i_p_m_t_s_leq_w_161418;
            bool forwards_ok_161424 = zzero_lte_i_161402 && y_161419;
            bool ok_or_empty_161425 = zzero_161376 || y_161422;
            bool protect_assert_disj_161426 = cond_161407 || y_161414;
            bool y_161427 = zzero_leq_i_p_m_t_s_161417 && y_161423;
            bool ok_or_empty_161428 = empty_slice_161404 || forwards_ok_161424;
            bool protect_assert_disj_161429 = cond_161387 || ok_or_empty_161425;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) flat_dim_161398, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161431 = !cond_161387;
            bool protect_assert_disj_161432 = protect_assert_disj_161426 || loop_not_taken_161431;
            bool index_certs_161433;
            
            if (!protect_assert_disj_161432) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:140:31-35\n   #10 ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161434 = i_lte_j_161403 && y_161427;
            bool protect_assert_disj_161435 = cond_161387 || ok_or_empty_161428;
            bool index_certs_161436;
            
            if (!protect_assert_disj_161435) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:140:31-35\n   #11 ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161437 = ok_or_empty_161428 || loop_not_taken_161431;
            bool index_certs_161438;
            
            if (!protect_assert_disj_161437) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161439 = empty_slice_161400 || forwards_ok_161434;
            bool protect_assert_disj_161440 = cond_161387 || ok_or_empty_161439;
            bool index_certs_161441;
            
            if (!protect_assert_disj_161440) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:140:31-35\n   #11 ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161442 = loop_not_taken_161431 || ok_or_empty_161439;
            bool index_certs_161443;
            
            if (!protect_assert_disj_161442) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 8 * num_merges_161379;
            int64_t bytes_171361 = next_stride_161375 * binop_x_171360;
            bool i_lte_j_161386 = sle64((int64_t) 0, next_stride_161375);
            
            if (mem_171362_cached_sizze_172384 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172384, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172385 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172385, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396;
            int64_t binop_x_171390 = (int64_t) 8 * num_blocks_161395;
            int64_t bytes_171391 = merge_block_sizze_161260 * binop_x_171390;
            int64_t bytes_171436 = (int64_t) 16 * stride_161374;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161379; i_171036++) {
                int64_t start_161447 = mul64(next_stride_161375, i_171036);
                int64_t j_m_i_161448 = sub64(loop_dz2084Uz2082U_161370, start_161447);
                bool empty_slice_161449 = j_m_i_161448 == (int64_t) 0;
                int64_t m_161450 = sub64(j_m_i_161448, (int64_t) 1);
                int64_t i_p_m_t_s_161451 = add64(start_161447, m_161450);
                bool zzero_leq_i_p_m_t_s_161452 = sle64((int64_t) 0, i_p_m_t_s_161451);
                bool i_p_m_t_s_leq_w_161453 = slt64(i_p_m_t_s_161451, loop_dz2084Uz2082U_161370);
                bool zzero_lte_i_161454 = sle64((int64_t) 0, start_161447);
                bool i_lte_j_161455 = sle64(start_161447, loop_dz2084Uz2082U_161370);
                bool y_161456 = i_p_m_t_s_leq_w_161453 && zzero_lte_i_161454;
                bool y_161457 = zzero_leq_i_p_m_t_s_161452 && y_161456;
                bool forwards_ok_161458 = i_lte_j_161455 && y_161457;
                bool ok_or_empty_161459 = empty_slice_161449 || forwards_ok_161458;
                bool index_certs_161460;
                
                if (!ok_or_empty_161459) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161447, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161370, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161461 = slt64(m_161384, j_m_i_161448);
                bool y_161462 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161461;
                bool forwards_ok_161463 = i_lte_j_161386 && y_161462;
                bool ok_or_empty_161464 = zzero_161376 || forwards_ok_161463;
                bool index_certs_161465;
                
                if (!ok_or_empty_161464) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) j_m_i_161448, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:140:31-35\n   #8  ftRelational.fut:139:5-140:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161387) {
                    int64_t dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161407) {
                        int64_t head_res_162008 = ((int64_t *) mem_param_171356.mem)[start_161447];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161447];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161374 + start_161447;
                        int64_t head_res_162011 = ((int64_t *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161375; nest_i_171983++) {
                        ((int64_t *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171436, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161375; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161375; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161397;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161374);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161397);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161374 + j_162022;
                                int64_t slice_162032 = start_161447 + slice_162031;
                                int64_t leq_arg1_162033 = ((int64_t *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161447 + i_162019;
                                int64_t leq_arg0_162038 = ((int64_t *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = sle64(leq_arg0_162038, leq_arg1_162033);
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        int64_t loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161374);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161447 + i_162019;
                            int64_t tmp_162049 = ((int64_t *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161397);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:140:31-35\n   #9  ftRelational.fut:139:5-140:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161374 + j_162022;
                            int64_t slice_162056 = start_161447 + slice_162055;
                            int64_t tmp_162057 = ((int64_t *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((int64_t *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172386 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172386, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172387 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172387, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396; i_171022++) {
                        int64_t split_count_arg3_161527 = mul64(merge_block_sizze_161260, i_171022);
                        int64_t defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161528, &defunc_0_split_count_res_161529, &defunc_0_split_count_res_161530, &defunc_0_split_count_res_161531, &defunc_0_split_count_res_161532, (int64_t) 0, stride_161374, (int64_t) 0, j_m_i_161397, split_count_arg3_161527) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161533 = slt64((int64_t) 0, defunc_0_split_count_res_161532);
                        bool defunc_0_split_count_res_161534;
                        int64_t defunc_0_split_count_res_161535;
                        int64_t defunc_0_split_count_res_161536;
                        int64_t defunc_0_split_count_res_161537;
                        int64_t defunc_0_split_count_res_161538;
                        int64_t defunc_0_split_count_res_161539;
                        bool loop_while_161540;
                        int64_t ss_161541;
                        int64_t ss_161542;
                        int64_t tt_161543;
                        int64_t tt_161544;
                        int64_t count_161545;
                        
                        loop_while_161540 = loop_cond_161533;
                        ss_161541 = defunc_0_split_count_res_161528;
                        ss_161542 = defunc_0_split_count_res_161529;
                        tt_161543 = defunc_0_split_count_res_161530;
                        tt_161544 = defunc_0_split_count_res_161531;
                        count_161545 = defunc_0_split_count_res_161532;
                        while (loop_while_161540) {
                            int64_t zlze_lhs_161546 = sub64(ss_161542, ss_161541);
                            bool cond_161547 = sle64(zlze_lhs_161546, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161548;
                            int64_t defunc_0_lifted_step_res_161549;
                            int64_t defunc_0_lifted_step_res_161550;
                            int64_t defunc_0_lifted_step_res_161551;
                            
                            if (cond_161547) {
                                int64_t tmp_162061 = add64(tt_161543, count_161545);
                                
                                defunc_0_lifted_step_res_161548 = ss_161541;
                                defunc_0_lifted_step_res_161549 = tmp_162061;
                                defunc_0_lifted_step_res_161550 = tt_161544;
                                defunc_0_lifted_step_res_161551 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161553 = sub64(tt_161544, tt_161543);
                                bool cond_161554 = sle64(zlze_lhs_161553, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161555;
                                int64_t defunc_0_lifted_step_res_f_res_161556;
                                int64_t defunc_0_lifted_step_res_f_res_161557;
                                int64_t defunc_0_lifted_step_res_f_res_161558;
                                
                                if (cond_161554) {
                                    int64_t tmp_162062 = add64(ss_161541, count_161545);
                                    
                                    defunc_0_lifted_step_res_f_res_161555 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161556 = tt_161543;
                                    defunc_0_lifted_step_res_f_res_161557 = tt_161544;
                                    defunc_0_lifted_step_res_f_res_161558 = (int64_t) 0;
                                } else {
                                    bool cond_161560 = count_161545 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161561;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161562;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161563;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161564;
                                    
                                    if (cond_161560) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161541);
                                        bool y_162065 = slt64(ss_161541, stride_161374);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161541, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:140:31-35\n   #13 ftRelational.fut:139:5-140:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161543);
                                        bool y_162071 = slt64(tt_161543, j_m_i_161397);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161543, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:140:31-35\n   #13 ftRelational.fut:139:5-140:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161447 + ss_161541;
                                        int64_t leq_arg1_162069 = ((int64_t *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161374 + tt_161543;
                                        int64_t slice_162075 = start_161447 + slice_162074;
                                        int64_t leq_arg0_162076 = ((int64_t *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = sle64(leq_arg0_162076, leq_arg1_162069);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161543);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161541;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161541);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161543;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = tt_161544;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = (int64_t) 0;
                                    } else {
                                        int64_t m_161583 = sdiv64(count_161545, (int64_t) 2);
                                        int64_t n_161584 = sub64(count_161545, m_161583);
                                        bool cond_161585 = n_161584 == (int64_t) 0;
                                        int64_t zgze_lhs_161586 = add64(ss_161541, m_161583);
                                        bool cond_f_res_161587 = sle64(ss_161542, zgze_lhs_161586);
                                        bool x_161588 = !cond_161585;
                                        bool y_161589 = cond_f_res_161587 && x_161588;
                                        bool cond_161590 = cond_161585 || y_161589;
                                        bool leq_y_x_161591;
                                        
                                        if (cond_161590) {
                                            leq_y_x_161591 = 1;
                                        } else {
                                            bool x_161592 = sle64((int64_t) 0, zgze_lhs_161586);
                                            bool y_161593 = slt64(zgze_lhs_161586, stride_161374);
                                            bool bounds_check_161594 = x_161592 && y_161593;
                                            bool index_certs_161595;
                                            
                                            if (!bounds_check_161594) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161586, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:140:31-35\n   #13 ftRelational.fut:139:5-140:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161598 = add64(tt_161543, n_161584);
                                            int64_t leq_arg0_161599 = sub64(zm_lhs_161598, (int64_t) 1);
                                            bool x_161600 = sle64((int64_t) 0, leq_arg0_161599);
                                            bool y_161601 = slt64(leq_arg0_161599, j_m_i_161397);
                                            bool bounds_check_161602 = x_161600 && y_161601;
                                            bool index_certs_161603;
                                            
                                            if (!bounds_check_161602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161599, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:140:31-35\n   #13 ftRelational.fut:139:5-140:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161596 = start_161447 + zgze_lhs_161586;
                                            int64_t leq_arg1_161597 = ((int64_t *) mem_param_171356.mem)[slice_161596];
                                            int64_t slice_161604 = stride_161374 + leq_arg0_161599;
                                            int64_t slice_161605 = start_161447 + slice_161604;
                                            int64_t leq_arg0_161606 = ((int64_t *) mem_param_171356.mem)[slice_161605];
                                            bool defunc_0_leq_res_161607 = sle64(leq_arg0_161606, leq_arg1_161597);
                                            
                                            leq_y_x_161591 = defunc_0_leq_res_161607;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                        
                                        if (leq_y_x_161591) {
                                            int64_t tmp_162082 = add64(tt_161543, n_161584);
                                            int64_t tmp_162083 = sub64(count_161545, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tt_161544;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = tmp_162083;
                                        } else {
                                            int64_t tmp_161613 = add64(tt_161543, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tt_161543;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tmp_161613;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = count_161545;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = ss_161541;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                    }
                                    defunc_0_lifted_step_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_161561;
                                    defunc_0_lifted_step_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_161562;
                                    defunc_0_lifted_step_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_161563;
                                    defunc_0_lifted_step_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_161564;
                                }
                                defunc_0_lifted_step_res_161548 = defunc_0_lifted_step_res_f_res_161555;
                                defunc_0_lifted_step_res_161549 = defunc_0_lifted_step_res_f_res_161556;
                                defunc_0_lifted_step_res_161550 = defunc_0_lifted_step_res_f_res_161557;
                                defunc_0_lifted_step_res_161551 = defunc_0_lifted_step_res_f_res_161558;
                            }
                            
                            int64_t loopres_161614;
                            int64_t loopres_161615;
                            int64_t loopres_161616;
                            int64_t loopres_161617;
                            int64_t loopres_161618;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161614, &loopres_161615, &loopres_161616, &loopres_161617, &loopres_161618, defunc_0_lifted_step_res_161548, ss_161542, defunc_0_lifted_step_res_161549, defunc_0_lifted_step_res_161550, defunc_0_lifted_step_res_161551) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161619 = slt64((int64_t) 0, loopres_161618);
                            bool loop_while_tmp_171990 = loop_cond_161619;
                            int64_t ss_tmp_171991 = loopres_161614;
                            int64_t ss_tmp_171992 = loopres_161615;
                            int64_t tt_tmp_171993 = loopres_161616;
                            int64_t tt_tmp_171994 = loopres_161617;
                            int64_t count_tmp_171995 = loopres_161618;
                            
                            loop_while_161540 = loop_while_tmp_171990;
                            ss_161541 = ss_tmp_171991;
                            ss_161542 = ss_tmp_171992;
                            tt_161543 = tt_tmp_171993;
                            tt_161544 = tt_tmp_171994;
                            count_161545 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161534 = loop_while_161540;
                        defunc_0_split_count_res_161535 = ss_161541;
                        defunc_0_split_count_res_161536 = ss_161542;
                        defunc_0_split_count_res_161537 = tt_161543;
                        defunc_0_split_count_res_161538 = tt_161544;
                        defunc_0_split_count_res_161539 = count_161545;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161535;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161537;
                    }
                    if (mem_171392_cached_sizze_172388 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172388, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172389 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172389, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161395; i_171029++) {
                        bool y_161625 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool index_certs_161627;
                        
                        if (!y_161625) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:140:31-35\n   #10 ftRelational.fut:139:5-140:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161628 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161630 = add64((int64_t) 1, i_171029);
                        bool x_161631 = sle64((int64_t) 0, tmp_161630);
                        bool y_161632 = slt64(tmp_161630, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool bounds_check_161633 = x_161631 && y_161632;
                        bool index_certs_161634;
                        
                        if (!bounds_check_161633) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161630, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:140:31-35\n   #10 ftRelational.fut:139:5-140:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161635 = ((int64_t *) mem_171375)[tmp_161630];
                        int64_t defunc_0_f_res_161636 = ((int64_t *) mem_171377)[tmp_161630];
                        int64_t merge_sequential_arg2_161637 = add64(stride_161374, defunc_0_f_res_161629);
                        int64_t merge_sequential_arg2_161638 = add64(stride_161374, defunc_0_f_res_161636);
                        int64_t j_m_i_161639 = sub64(merge_sequential_arg2_161638, merge_sequential_arg2_161637);
                        bool empty_slice_161640 = j_m_i_161639 == (int64_t) 0;
                        int64_t m_161641 = sub64(j_m_i_161639, (int64_t) 1);
                        int64_t i_p_m_t_s_161642 = add64(merge_sequential_arg2_161637, m_161641);
                        bool zzero_leq_i_p_m_t_s_161643 = sle64((int64_t) 0, i_p_m_t_s_161642);
                        bool i_p_m_t_s_leq_w_161644 = slt64(i_p_m_t_s_161642, next_stride_161375);
                        bool zzero_lte_i_161645 = sle64((int64_t) 0, merge_sequential_arg2_161637);
                        bool i_lte_j_161646 = sle64(merge_sequential_arg2_161637, merge_sequential_arg2_161638);
                        bool y_161647 = i_p_m_t_s_leq_w_161644 && zzero_lte_i_161645;
                        bool y_161648 = zzero_leq_i_p_m_t_s_161643 && y_161647;
                        bool forwards_ok_161649 = i_lte_j_161646 && y_161648;
                        bool ok_or_empty_161650 = empty_slice_161640 || forwards_ok_161649;
                        bool index_certs_161651;
                        
                        if (!ok_or_empty_161650) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161637, ":", (long long) merge_sequential_arg2_161638, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:140:31-35\n   #10 ftRelational.fut:139:5-140:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161652 = sub64(defunc_0_f_res_161635, defunc_0_f_res_161628);
                        bool empty_slice_161653 = j_m_i_161652 == (int64_t) 0;
                        int64_t m_161654 = sub64(j_m_i_161652, (int64_t) 1);
                        int64_t i_p_m_t_s_161655 = add64(defunc_0_f_res_161628, m_161654);
                        bool zzero_leq_i_p_m_t_s_161656 = sle64((int64_t) 0, i_p_m_t_s_161655);
                        bool i_p_m_t_s_leq_w_161657 = slt64(i_p_m_t_s_161655, next_stride_161375);
                        bool zzero_lte_i_161658 = sle64((int64_t) 0, defunc_0_f_res_161628);
                        bool i_lte_j_161659 = sle64(defunc_0_f_res_161628, defunc_0_f_res_161635);
                        bool y_161660 = i_p_m_t_s_leq_w_161657 && zzero_lte_i_161658;
                        bool y_161661 = zzero_leq_i_p_m_t_s_161656 && y_161660;
                        bool forwards_ok_161662 = i_lte_j_161659 && y_161661;
                        bool ok_or_empty_161663 = empty_slice_161653 || forwards_ok_161662;
                        bool index_certs_161664;
                        
                        if (!ok_or_empty_161663) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161628, ":", (long long) defunc_0_f_res_161635, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:140:31-35\n   #10 ftRelational.fut:139:5-140:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161665 = slt64((int64_t) 0, j_m_i_161652);
                        int64_t dummy_161666;
                        int64_t dummy_161667;
                        
                        if (cond_161665) {
                            bool index_certs_162084;
                            
                            if (!cond_161665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:140:31-35\n   #12 ftRelational.fut:139:5-140:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161447 + defunc_0_f_res_161628;
                            int64_t head_res_162086 = ((int64_t *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161666 = head_res_162086;
                            dummy_161667 = head_res_162087;
                        } else {
                            bool y_161672 = slt64((int64_t) 0, j_m_i_161639);
                            bool index_certs_161673;
                            
                            if (!y_161672) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:140:31-35\n   #12 ftRelational.fut:139:5-140:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161674 = start_161447 + merge_sequential_arg2_161637;
                            int64_t head_res_161675 = ((int64_t *) mem_param_171356.mem)[slice_161674];
                            int64_t head_res_161676 = ((int64_t *) mem_param_171359.mem)[slice_161674];
                            
                            dummy_161666 = head_res_161675;
                            dummy_161667 = head_res_161676;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161260; nest_i_171998++) {
                            ((int64_t *) mem_171392)[i_171029 * merge_block_sizze_161260 + nest_i_171998] = dummy_161666;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161260; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + nest_i_171999] = dummy_161667;
                        }
                        
                        int64_t data_161679;
                        int64_t i_161683 = (int64_t) 0;
                        
                        for (int64_t k_161682 = 0; k_161682 < merge_block_sizze_161260; k_161682++) {
                            int64_t j_161686 = sub64(k_161682, i_161683);
                            bool cond_161687 = j_161686 == j_m_i_161639;
                            bool cond_161688;
                            
                            if (cond_161687) {
                                cond_161688 = 1;
                            } else {
                                bool cond_161689 = slt64(i_161683, j_m_i_161652);
                                bool cond_f_res_161690;
                                
                                if (cond_161689) {
                                    bool x_162088 = sle64((int64_t) 0, j_161686);
                                    bool y_162089 = slt64(j_161686, j_m_i_161639);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:140:31-35\n   #11 ftRelational.fut:139:5-140:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161683);
                                    bool bounds_check_162096 = cond_161689 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:140:31-35\n   #11 ftRelational.fut:139:5-140:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161637 + j_161686;
                                    int64_t slice_162093 = start_161447 + slice_162092;
                                    int64_t leq_arg1_162094 = ((int64_t *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161628 + i_161683;
                                    int64_t slice_162099 = start_161447 + slice_162098;
                                    int64_t leq_arg0_162100 = ((int64_t *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = sle64(leq_arg0_162100, leq_arg1_162094);
                                    
                                    cond_f_res_161690 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161690 = 0;
                                }
                                cond_161688 = cond_f_res_161690;
                            }
                            
                            int64_t loopres_161705;
                            int64_t loopres_161706;
                            int64_t loopres_161707;
                            
                            if (cond_161688) {
                                bool x_162103 = sle64((int64_t) 0, i_161683);
                                bool y_162104 = slt64(i_161683, j_m_i_161652);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:140:31-35\n   #11 ftRelational.fut:139:5-140:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161683);
                                int64_t slice_162107 = defunc_0_f_res_161628 + i_161683;
                                int64_t slice_162108 = start_161447 + slice_162107;
                                int64_t tmp_162109 = ((int64_t *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161705 = tmp_162102;
                                loopres_161706 = tmp_162109;
                                loopres_161707 = tmp_162110;
                            } else {
                                bool x_161717 = sle64((int64_t) 0, j_161686);
                                bool y_161718 = slt64(j_161686, j_m_i_161639);
                                bool bounds_check_161719 = x_161717 && y_161718;
                                bool index_certs_161720;
                                
                                if (!bounds_check_161719) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:140:31-35\n   #11 ftRelational.fut:139:5-140:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161721 = merge_sequential_arg2_161637 + j_161686;
                                int64_t slice_161722 = start_161447 + slice_161721;
                                int64_t tmp_161723 = ((int64_t *) mem_param_171356.mem)[slice_161722];
                                int64_t tmp_161724 = ((int64_t *) mem_param_171359.mem)[slice_161722];
                                
                                loopres_161705 = i_161683;
                                loopres_161706 = tmp_161723;
                                loopres_161707 = tmp_161724;
                            }
                            ((int64_t *) mem_171392)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161706;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161707;
                            
                            int64_t i_tmp_172000 = loopres_161705;
                            
                            i_161683 = i_tmp_172000;
                        }
                        data_161679 = i_161683;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171391, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161731 = next_stride_161375 * num_merges_161379;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            if (memblock_alloc(ctx, &mem_171472, bytes_171361, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            
            bool loop_cond_161734 = slt64(next_stride_161375, flat_dim_161256);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161731;
            bool loop_while_tmp_171977 = loop_cond_161734;
            int64_t stride_tmp_171980 = next_stride_161375;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161370 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161371 = loop_while_tmp_171977;
            stride_161374 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161365 = loop_dz2084Uz2082U_161370;
        data_161366 = loop_while_161371;
        data_161369 = stride_161374;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161735 = n_109078 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161736 = sle64((int64_t) 0, zs_lhs_161240);
        bool i_p_m_t_s_leq_w_161737 = slt64(zs_lhs_161240, data_161365);
        bool y_161738 = zzero_leq_i_p_m_t_s_161736 && i_p_m_t_s_leq_w_161737;
        bool ok_or_empty_161739 = empty_slice_161735 || y_161738;
        bool index_certs_161740;
        
        if (!ok_or_empty_161739) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_109078, "] out of bounds for array of shape [", (long long) data_161365, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:140:31-35\n   #6  ftRelational.fut:139:5-140:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171276, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_109078; i_171043++) {
        int64_t eta_p_161748 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161749 = sle64((int64_t) 0, eta_p_161748);
        bool y_161750 = slt64(eta_p_161748, n_109078);
        bool bounds_check_161751 = x_161749 && y_161750;
        bool index_certs_161752;
        
        if (!bounds_check_161751) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161748, "] out of bounds for array of shape [", (long long) n_109078, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:140:31-35\n   #5  ftRelational.fut:139:5-140:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_161753 = ((int64_t *) ext_mem_171275.mem)[eta_p_161748];
        int64_t lifted_lambda_res_161754 = ((int64_t *) xs_mem_171274.mem)[eta_p_161748];
        
        ((int64_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161753;
        ((int64_t *) mem_171486.mem)[i_171043] = lifted_lambda_res_161754;
    }
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172378, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172379, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_172390, struct memblock *mem_out_p_172391, struct memblock xs_mem_171274, int64_t n_104792, int64_t incr_104793)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172392 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172393 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172394 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172395 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172396 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172397 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172398 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172399 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172400 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172401 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_104792;
    bool cond_161239 = sle64(n_104792, (int64_t) 1);
    int64_t zs_lhs_161240 = sub64(n_104792, (int64_t) 1);
    int64_t zp_rhs_161241 = sdiv_safe64(zs_lhs_161240, (int64_t) 20);
    int64_t min_num_blocks_161242 = add64((int64_t) 1, zp_rhs_161241);
    bool loop_cond_161243 = slt64((int64_t) 1, min_num_blocks_161242);
    bool smallest_pow_2_geq_than_res_161244;
    int64_t smallest_pow_2_geq_than_res_161245;
    bool loop_while_161246;
    int64_t x_161247;
    
    loop_while_161246 = loop_cond_161243;
    x_161247 = (int64_t) 1;
    while (loop_while_161246) {
        int64_t loopres_161248 = mul64((int64_t) 2, x_161247);
        bool loop_cond_161249 = slt64(loopres_161248, min_num_blocks_161242);
        bool loop_while_tmp_171958 = loop_cond_161249;
        int64_t x_tmp_171959 = loopres_161248;
        
        loop_while_161246 = loop_while_tmp_171958;
        x_161247 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161244 = loop_while_161246;
    smallest_pow_2_geq_than_res_161245 = x_161247;
    
    bool zzero_161250 = smallest_pow_2_geq_than_res_161245 == (int64_t) 0;
    bool nonzzero_161251 = !zzero_161250;
    bool protect_assert_disj_161252 = cond_161239 || nonzzero_161251;
    bool nonzzero_cert_161253;
    
    if (!protect_assert_disj_161252) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:136:31-35\n   #5  ftRelational.fut:135:5-136:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161254 = sdiv_safe64(zs_lhs_161240, smallest_pow_2_geq_than_res_161245);
    int64_t block_sizze_161255 = add64((int64_t) 1, zp_rhs_161254);
    bool y_161261 = slt64((int64_t) 0, n_104792);
    bool protect_assert_disj_171871 = cond_161239 || y_161261;
    bool index_certs_161262;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_104792, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:136:31-35\n   #5  ftRelational.fut:135:5-136:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161276 = slt64(smallest_pow_2_geq_than_res_161245, (int64_t) 0);
    bool valid_161277 = !bounds_invalid_upwards_161276;
    bool protect_assert_disj_171879 = cond_161239 || valid_161277;
    bool range_valid_c_161278;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161245, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:136:31-35\n   #6  ftRelational.fut:135:5-136:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161280 = slt64(block_sizze_161255, (int64_t) 0);
    bool valid_161281 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_171881 = cond_161239 || valid_161281;
    bool range_valid_c_161282;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161255, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161284 = sle64(block_sizze_161255, (int64_t) 1);
    int64_t tmp_161285 = sub64(block_sizze_161255, (int64_t) 2);
    bool bounds_invalid_upwards_161286 = slt64(tmp_161285, (int64_t) 0);
    bool valid_161288 = !bounds_invalid_upwards_161286;
    bool protect_assert_disj_161289 = cond_161284 || valid_161288;
    bool protect_assert_disj_171883 = cond_161239 || protect_assert_disj_161289;
    bool range_valid_c_161290;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161285, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171485 = (int64_t) 2 * n_104792;
    
    if (futrts_indicesWithIncrement_16256(ctx, &ext_mem_171275, xs_mem_171274, n_104792, incr_104793) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_104792; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161256 = smallest_pow_2_geq_than_res_161245 * block_sizze_161255;
    bool x_171866 = !cond_161239;
    int64_t greatest_divisor_leq_than_arg1_161259 = mul64((int64_t) 2, block_sizze_161255);
    int64_t merge_block_sizze_161260;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161259) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161260 = x_171868;
    } else {
        merge_block_sizze_161260 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_161263;
    
    if (x_171866) {
        int16_t x_171872 = ((int16_t *) xs_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161263 = x_171872;
    } else {
        reduce_arg1_161263 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        int16_t x_171874;
        int64_t x_171875;
        int16_t redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161263;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_104792; i_171003++) {
            int16_t x_161267 = ((int16_t *) xs_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161273 = sle16(redout_171001, x_161267);
            int16_t defunc_0_op_res_161274;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161274 = x_161267;
            } else {
                defunc_0_op_res_161274 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161275;
            
            if (defunc_0_leq_res_161273) {
                defunc_0_op_res_161275 = i_171003;
            } else {
                defunc_0_op_res_161275 = redout_171002;
            }
            
            int16_t redout_tmp_171962 = defunc_0_op_res_161274;
            int64_t redout_tmp_171963 = defunc_0_op_res_161275;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = (int16_t) 0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161287 = add64((int64_t) 1, tmp_161285);
    int64_t binop_x_171278 = (int64_t) 2 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171279 = block_sizze_161255 * binop_x_171278;
    int64_t binop_x_171281 = (int64_t) 8 * smallest_pow_2_geq_than_res_161245;
    int64_t bytes_171282 = block_sizze_161255 * binop_x_171281;
    int64_t bytes_171294 = (int64_t) 8 * block_sizze_161255;
    bool loop_cond_161362 = slt64(block_sizze_161255, flat_dim_161256);
    bool zzero_161363 = merge_block_sizze_161260 == (int64_t) 0;
    bool nonzzero_161364 = !zzero_161363;
    
    if (cond_161239) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172392 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172392, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172393 < bytes_171282) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172393, bytes_171282);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172394 < greatest_divisor_leq_than_arg1_161259) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172394, greatest_divisor_leq_than_arg1_161259);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172395 < bytes_171294) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172395, bytes_171294);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161245; i_171015++) {
            int64_t zp_lhs_161294 = mul64(block_sizze_161255, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161255; i_171008++) {
                int64_t k_161298 = add64(zp_lhs_161294, i_171008);
                bool cond_161299 = slt64(k_161298, n_104792);
                int16_t lifted_lambda_res_161300;
                int64_t lifted_lambda_res_161301;
                
                if (cond_161299) {
                    bool x_161970 = sle64((int64_t) 0, k_161298);
                    bool bounds_check_161971 = cond_161299 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161298, "] out of bounds for array of shape [", (long long) n_104792, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_161973 = ((int16_t *) xs_mem_171274.mem)[k_161298];
                    
                    lifted_lambda_res_161300 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161301 = k_161298;
                } else {
                    lifted_lambda_res_161300 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161301 = defunc_0_reduce_res_162118;
                }
                ((int16_t *) mem_171293)[i_171008] = lifted_lambda_res_161300;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161301;
            }
            if (!cond_161284) {
                for (int64_t i_161311 = 0; i_161311 < distance_161287; i_161311++) {
                    int64_t gt_arg1_161314 = add64((int64_t) 1, i_161311);
                    bool x_161315 = sle64((int64_t) 0, gt_arg1_161314);
                    bool y_161316 = slt64(gt_arg1_161314, block_sizze_161255);
                    bool bounds_check_161317 = x_161315 && y_161316;
                    bool index_certs_161318;
                    
                    if (!bounds_check_161317) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161314, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161320 = slt64(i_161311, block_sizze_161255);
                    bool index_certs_161321;
                    
                    if (!y_161320) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161311, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_161319 = ((int16_t *) mem_171293)[gt_arg1_161314];
                    int16_t gt_arg0_161322 = ((int16_t *) mem_171293)[i_161311];
                    bool defunc_0_leq_res_161323 = sle16(gt_arg0_161322, gt_arg1_161319);
                    bool defunc_0_lifted_gt_res_161324 = !defunc_0_leq_res_161323;
                    bool s_161325;
                    int64_t s_161328;
                    bool loop_while_161329;
                    int64_t j_161332;
                    
                    loop_while_161329 = defunc_0_lifted_gt_res_161324;
                    j_161332 = i_161311;
                    while (loop_while_161329) {
                        bool x_161333 = sle64((int64_t) 0, j_161332);
                        bool y_161334 = slt64(j_161332, block_sizze_161255);
                        bool bounds_check_161335 = x_161333 && y_161334;
                        bool index_certs_161336;
                        
                        if (!bounds_check_161335) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161332, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161339 = add64((int64_t) 1, j_161332);
                        bool x_161340 = sle64((int64_t) 0, copy_arg0_161339);
                        bool y_161341 = slt64(copy_arg0_161339, block_sizze_161255);
                        bool bounds_check_161342 = x_161340 && y_161341;
                        bool index_certs_161343;
                        
                        if (!bounds_check_161342) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161339, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_161337 = ((int16_t *) mem_171293)[j_161332];
                        int64_t copy_arg0_161338 = ((int64_t *) mem_171295)[j_161332];
                        int16_t copy_arg0_161344 = ((int16_t *) mem_171293)[copy_arg0_161339];
                        int64_t copy_arg0_161345 = ((int64_t *) mem_171295)[copy_arg0_161339];
                        
                        ((int16_t *) mem_171293)[j_161332] = copy_arg0_161344;
                        ((int64_t *) mem_171295)[j_161332] = copy_arg0_161345;
                        ((int16_t *) mem_171293)[copy_arg0_161339] = copy_arg0_161337;
                        ((int64_t *) mem_171295)[copy_arg0_161339] = copy_arg0_161338;
                        
                        int64_t tmp_161350 = sub64(j_161332, (int64_t) 1);
                        bool cond_161351 = sle64((int64_t) 0, tmp_161350);
                        bool loop_cond_161352;
                        
                        if (cond_161351) {
                            bool y_161975 = slt64(tmp_161350, block_sizze_161255);
                            bool bounds_check_161976 = cond_161351 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161350, "] out of bounds for array of shape [", (long long) block_sizze_161255, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_161974 = ((int16_t *) mem_171293)[j_161332];
                            int16_t gt_arg0_161978 = ((int16_t *) mem_171293)[tmp_161350];
                            bool defunc_0_leq_res_161979 = sle16(gt_arg0_161978, gt_arg1_161974);
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161352 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161352 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161352;
                        int64_t j_tmp_171973 = tmp_161350;
                        
                        loop_while_161329 = loop_while_tmp_171970;
                        j_161332 = j_tmp_171973;
                    }
                    s_161325 = loop_while_161329;
                    s_161328 = j_161332;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171280, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161255, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161255});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint16_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        if (memblock_alloc(ctx, &mem_171352, bytes_171282, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161255, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161245, block_sizze_161255});
        
        int64_t data_161365;
        bool data_161366;
        int64_t data_161369;
        int64_t loop_dz2084Uz2082U_161370;
        bool loop_while_161371;
        int64_t stride_161374;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161370 = flat_dim_161256;
        loop_while_161371 = loop_cond_161362;
        stride_161374 = block_sizze_161255;
        while (loop_while_161371) {
            int64_t next_stride_161375 = mul64((int64_t) 2, stride_161374);
            bool zzero_161376 = next_stride_161375 == (int64_t) 0;
            bool nonzzero_161377 = !zzero_161376;
            bool nonzzero_cert_161378;
            
            if (!nonzzero_161377) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:136:31-35\n   #5  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161379 = sdiv64(flat_dim_161256, next_stride_161375);
            bool bounds_invalid_upwards_161380 = slt64(num_merges_161379, (int64_t) 0);
            bool valid_161381 = !bounds_invalid_upwards_161380;
            bool range_valid_c_161382;
            
            if (!valid_161381) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161379, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:136:31-35\n   #6  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161384 = sub64(next_stride_161375, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161385 = sle64((int64_t) 0, m_161384);
            bool cond_161387 = slt64(next_stride_161375, (int64_t) 10);
            bool protect_assert_disj_161388 = nonzzero_161364 || cond_161387;
            bool nonzzero_cert_161389;
            
            if (!protect_assert_disj_161388) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161390 = smod_safe64(next_stride_161375, merge_block_sizze_161260);
            bool num_blocks_161391 = zeze_lhs_161390 == (int64_t) 0;
            bool protect_assert_disj_161392 = cond_161387 || num_blocks_161391;
            bool assert_c_161393;
            
            if (!protect_assert_disj_161392) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161395 = sdiv_safe64(next_stride_161375, merge_block_sizze_161260);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396 = add64((int64_t) 1, num_blocks_161395);
            int64_t j_m_i_161397 = sub64(next_stride_161375, stride_161374);
            int64_t flat_dim_161398 = merge_block_sizze_161260 * num_blocks_161395;
            bool bounds_invalid_upwards_161399 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, (int64_t) 0);
            bool empty_slice_161400 = j_m_i_161397 == (int64_t) 0;
            int64_t m_161401 = sub64(j_m_i_161397, (int64_t) 1);
            bool zzero_lte_i_161402 = sle64((int64_t) 0, stride_161374);
            bool i_lte_j_161403 = sle64(stride_161374, next_stride_161375);
            bool empty_slice_161404 = stride_161374 == (int64_t) 0;
            int64_t m_161405 = sub64(stride_161374, (int64_t) 1);
            bool bounds_invalid_upwards_161406 = slt64(num_blocks_161395, (int64_t) 0);
            bool cond_161407 = slt64((int64_t) 0, stride_161374);
            bool valid_161408 = !bounds_invalid_upwards_161399;
            int64_t i_p_m_t_s_161409 = add64(stride_161374, m_161401);
            bool zzero_leq_i_p_m_t_s_161410 = sle64((int64_t) 0, m_161405);
            bool i_p_m_t_s_leq_w_161411 = slt64(m_161405, next_stride_161375);
            bool valid_161412 = !bounds_invalid_upwards_161406;
            bool i_p_m_t_s_leq_w_161413 = slt64(m_161384, flat_dim_161398);
            bool y_161414 = slt64((int64_t) 0, j_m_i_161397);
            bool protect_assert_disj_161415 = cond_161387 || valid_161408;
            bool range_valid_c_161416;
            
            if (!protect_assert_disj_161415) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:136:31-35\n   #10 ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161417 = sle64((int64_t) 0, i_p_m_t_s_161409);
            bool i_p_m_t_s_leq_w_161418 = slt64(i_p_m_t_s_161409, next_stride_161375);
            bool y_161419 = zzero_leq_i_p_m_t_s_161410 && i_p_m_t_s_leq_w_161411;
            bool protect_assert_disj_161420 = cond_161387 || valid_161412;
            bool range_valid_c_161421;
            
            if (!protect_assert_disj_161420) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161395, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161422 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161413;
            bool y_161423 = zzero_lte_i_161402 && i_p_m_t_s_leq_w_161418;
            bool forwards_ok_161424 = zzero_lte_i_161402 && y_161419;
            bool ok_or_empty_161425 = zzero_161376 || y_161422;
            bool protect_assert_disj_161426 = cond_161407 || y_161414;
            bool y_161427 = zzero_leq_i_p_m_t_s_161417 && y_161423;
            bool ok_or_empty_161428 = empty_slice_161404 || forwards_ok_161424;
            bool protect_assert_disj_161429 = cond_161387 || ok_or_empty_161425;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) flat_dim_161398, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161431 = !cond_161387;
            bool protect_assert_disj_161432 = protect_assert_disj_161426 || loop_not_taken_161431;
            bool index_certs_161433;
            
            if (!protect_assert_disj_161432) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:136:31-35\n   #10 ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161434 = i_lte_j_161403 && y_161427;
            bool protect_assert_disj_161435 = cond_161387 || ok_or_empty_161428;
            bool index_certs_161436;
            
            if (!protect_assert_disj_161435) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:136:31-35\n   #11 ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161437 = ok_or_empty_161428 || loop_not_taken_161431;
            bool index_certs_161438;
            
            if (!protect_assert_disj_161437) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161374, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161439 = empty_slice_161400 || forwards_ok_161434;
            bool protect_assert_disj_161440 = cond_161387 || ok_or_empty_161439;
            bool index_certs_161441;
            
            if (!protect_assert_disj_161440) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:136:31-35\n   #11 ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161442 = loop_not_taken_161431 || ok_or_empty_161439;
            bool index_certs_161443;
            
            if (!protect_assert_disj_161442) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161374, ":] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 2 * num_merges_161379;
            int64_t bytes_171361 = next_stride_161375 * binop_x_171360;
            int64_t binop_x_171363 = (int64_t) 8 * num_merges_161379;
            int64_t bytes_171364 = next_stride_161375 * binop_x_171363;
            bool i_lte_j_161386 = sle64((int64_t) 0, next_stride_161375);
            
            if (mem_171362_cached_sizze_172396 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172396, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172397 < bytes_171364) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172397, bytes_171364);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396;
            int64_t binop_x_171390 = (int64_t) 2 * num_blocks_161395;
            int64_t bytes_171391 = merge_block_sizze_161260 * binop_x_171390;
            int64_t binop_x_171393 = (int64_t) 8 * num_blocks_161395;
            int64_t bytes_171394 = merge_block_sizze_161260 * binop_x_171393;
            int64_t bytes_171436 = (int64_t) 4 * stride_161374;
            int64_t bytes_171438 = (int64_t) 16 * stride_161374;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161379; i_171036++) {
                int64_t start_161447 = mul64(next_stride_161375, i_171036);
                int64_t j_m_i_161448 = sub64(loop_dz2084Uz2082U_161370, start_161447);
                bool empty_slice_161449 = j_m_i_161448 == (int64_t) 0;
                int64_t m_161450 = sub64(j_m_i_161448, (int64_t) 1);
                int64_t i_p_m_t_s_161451 = add64(start_161447, m_161450);
                bool zzero_leq_i_p_m_t_s_161452 = sle64((int64_t) 0, i_p_m_t_s_161451);
                bool i_p_m_t_s_leq_w_161453 = slt64(i_p_m_t_s_161451, loop_dz2084Uz2082U_161370);
                bool zzero_lte_i_161454 = sle64((int64_t) 0, start_161447);
                bool i_lte_j_161455 = sle64(start_161447, loop_dz2084Uz2082U_161370);
                bool y_161456 = i_p_m_t_s_leq_w_161453 && zzero_lte_i_161454;
                bool y_161457 = zzero_leq_i_p_m_t_s_161452 && y_161456;
                bool forwards_ok_161458 = i_lte_j_161455 && y_161457;
                bool ok_or_empty_161459 = empty_slice_161449 || forwards_ok_161458;
                bool index_certs_161460;
                
                if (!ok_or_empty_161459) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161447, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161370, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161461 = slt64(m_161384, j_m_i_161448);
                bool y_161462 = zzero_leq_i_p_m_t_s_161385 && i_p_m_t_s_leq_w_161461;
                bool forwards_ok_161463 = i_lte_j_161386 && y_161462;
                bool ok_or_empty_161464 = zzero_161376 || forwards_ok_161463;
                bool index_certs_161465;
                
                if (!ok_or_empty_161464) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161375, "] out of bounds for array of shape [", (long long) j_m_i_161448, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:136:31-35\n   #8  ftRelational.fut:135:5-136:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161387) {
                    int16_t dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161407) {
                        int16_t head_res_162008 = ((int16_t *) mem_param_171356.mem)[start_161447];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161447];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161374 + start_161447;
                        int16_t head_res_162011 = ((int16_t *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161375; nest_i_171983++) {
                        ((int16_t *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171438, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161375; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161375; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161397;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161374);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161397);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161374 + j_162022;
                                int64_t slice_162032 = start_161447 + slice_162031;
                                int16_t leq_arg1_162033 = ((int16_t *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161447 + i_162019;
                                int16_t leq_arg0_162038 = ((int16_t *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = sle16(leq_arg0_162038, leq_arg1_162033);
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        int16_t loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161374);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161447 + i_162019;
                            int16_t tmp_162049 = ((int16_t *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161397);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:136:31-35\n   #9  ftRelational.fut:135:5-136:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161374 + j_162022;
                            int64_t slice_162056 = start_161447 + slice_162055;
                            int16_t tmp_162057 = ((int16_t *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((int16_t *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172398 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172398, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172399 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172399, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396; i_171022++) {
                        int64_t split_count_arg3_161527 = mul64(merge_block_sizze_161260, i_171022);
                        int64_t defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161528, &defunc_0_split_count_res_161529, &defunc_0_split_count_res_161530, &defunc_0_split_count_res_161531, &defunc_0_split_count_res_161532, (int64_t) 0, stride_161374, (int64_t) 0, j_m_i_161397, split_count_arg3_161527) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161533 = slt64((int64_t) 0, defunc_0_split_count_res_161532);
                        bool defunc_0_split_count_res_161534;
                        int64_t defunc_0_split_count_res_161535;
                        int64_t defunc_0_split_count_res_161536;
                        int64_t defunc_0_split_count_res_161537;
                        int64_t defunc_0_split_count_res_161538;
                        int64_t defunc_0_split_count_res_161539;
                        bool loop_while_161540;
                        int64_t ss_161541;
                        int64_t ss_161542;
                        int64_t tt_161543;
                        int64_t tt_161544;
                        int64_t count_161545;
                        
                        loop_while_161540 = loop_cond_161533;
                        ss_161541 = defunc_0_split_count_res_161528;
                        ss_161542 = defunc_0_split_count_res_161529;
                        tt_161543 = defunc_0_split_count_res_161530;
                        tt_161544 = defunc_0_split_count_res_161531;
                        count_161545 = defunc_0_split_count_res_161532;
                        while (loop_while_161540) {
                            int64_t zlze_lhs_161546 = sub64(ss_161542, ss_161541);
                            bool cond_161547 = sle64(zlze_lhs_161546, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161548;
                            int64_t defunc_0_lifted_step_res_161549;
                            int64_t defunc_0_lifted_step_res_161550;
                            int64_t defunc_0_lifted_step_res_161551;
                            
                            if (cond_161547) {
                                int64_t tmp_162061 = add64(tt_161543, count_161545);
                                
                                defunc_0_lifted_step_res_161548 = ss_161541;
                                defunc_0_lifted_step_res_161549 = tmp_162061;
                                defunc_0_lifted_step_res_161550 = tt_161544;
                                defunc_0_lifted_step_res_161551 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161553 = sub64(tt_161544, tt_161543);
                                bool cond_161554 = sle64(zlze_lhs_161553, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161555;
                                int64_t defunc_0_lifted_step_res_f_res_161556;
                                int64_t defunc_0_lifted_step_res_f_res_161557;
                                int64_t defunc_0_lifted_step_res_f_res_161558;
                                
                                if (cond_161554) {
                                    int64_t tmp_162062 = add64(ss_161541, count_161545);
                                    
                                    defunc_0_lifted_step_res_f_res_161555 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161556 = tt_161543;
                                    defunc_0_lifted_step_res_f_res_161557 = tt_161544;
                                    defunc_0_lifted_step_res_f_res_161558 = (int64_t) 0;
                                } else {
                                    bool cond_161560 = count_161545 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161561;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161562;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161563;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161564;
                                    
                                    if (cond_161560) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161541);
                                        bool y_162065 = slt64(ss_161541, stride_161374);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161541, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:136:31-35\n   #13 ftRelational.fut:135:5-136:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161543);
                                        bool y_162071 = slt64(tt_161543, j_m_i_161397);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161543, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:136:31-35\n   #13 ftRelational.fut:135:5-136:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161447 + ss_161541;
                                        int16_t leq_arg1_162069 = ((int16_t *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161374 + tt_161543;
                                        int64_t slice_162075 = start_161447 + slice_162074;
                                        int16_t leq_arg0_162076 = ((int16_t *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = sle16(leq_arg0_162076, leq_arg1_162069);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161543);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161541;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161541);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161543;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = tt_161544;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = (int64_t) 0;
                                    } else {
                                        int64_t m_161583 = sdiv64(count_161545, (int64_t) 2);
                                        int64_t n_161584 = sub64(count_161545, m_161583);
                                        bool cond_161585 = n_161584 == (int64_t) 0;
                                        int64_t zgze_lhs_161586 = add64(ss_161541, m_161583);
                                        bool cond_f_res_161587 = sle64(ss_161542, zgze_lhs_161586);
                                        bool x_161588 = !cond_161585;
                                        bool y_161589 = cond_f_res_161587 && x_161588;
                                        bool cond_161590 = cond_161585 || y_161589;
                                        bool leq_y_x_161591;
                                        
                                        if (cond_161590) {
                                            leq_y_x_161591 = 1;
                                        } else {
                                            bool x_161592 = sle64((int64_t) 0, zgze_lhs_161586);
                                            bool y_161593 = slt64(zgze_lhs_161586, stride_161374);
                                            bool bounds_check_161594 = x_161592 && y_161593;
                                            bool index_certs_161595;
                                            
                                            if (!bounds_check_161594) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161586, "] out of bounds for array of shape [", (long long) stride_161374, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:136:31-35\n   #13 ftRelational.fut:135:5-136:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161598 = add64(tt_161543, n_161584);
                                            int64_t leq_arg0_161599 = sub64(zm_lhs_161598, (int64_t) 1);
                                            bool x_161600 = sle64((int64_t) 0, leq_arg0_161599);
                                            bool y_161601 = slt64(leq_arg0_161599, j_m_i_161397);
                                            bool bounds_check_161602 = x_161600 && y_161601;
                                            bool index_certs_161603;
                                            
                                            if (!bounds_check_161602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161599, "] out of bounds for array of shape [", (long long) j_m_i_161397, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:136:31-35\n   #13 ftRelational.fut:135:5-136:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161596 = start_161447 + zgze_lhs_161586;
                                            int16_t leq_arg1_161597 = ((int16_t *) mem_param_171356.mem)[slice_161596];
                                            int64_t slice_161604 = stride_161374 + leq_arg0_161599;
                                            int64_t slice_161605 = start_161447 + slice_161604;
                                            int16_t leq_arg0_161606 = ((int16_t *) mem_param_171356.mem)[slice_161605];
                                            bool defunc_0_leq_res_161607 = sle16(leq_arg0_161606, leq_arg1_161597);
                                            
                                            leq_y_x_161591 = defunc_0_leq_res_161607;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                        
                                        if (leq_y_x_161591) {
                                            int64_t tmp_162082 = add64(tt_161543, n_161584);
                                            int64_t tmp_162083 = sub64(count_161545, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tt_161544;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = tmp_162083;
                                        } else {
                                            int64_t tmp_161613 = add64(tt_161543, n_161584);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161608 = tt_161543;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161609 = tmp_161613;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161610 = count_161545;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161561 = ss_161541;
                                        defunc_0_lifted_step_res_f_res_f_res_161562 = defunc_0_lifted_step_res_f_res_f_res_f_res_161608;
                                        defunc_0_lifted_step_res_f_res_f_res_161563 = defunc_0_lifted_step_res_f_res_f_res_f_res_161609;
                                        defunc_0_lifted_step_res_f_res_f_res_161564 = defunc_0_lifted_step_res_f_res_f_res_f_res_161610;
                                    }
                                    defunc_0_lifted_step_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_161561;
                                    defunc_0_lifted_step_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_161562;
                                    defunc_0_lifted_step_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_161563;
                                    defunc_0_lifted_step_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_161564;
                                }
                                defunc_0_lifted_step_res_161548 = defunc_0_lifted_step_res_f_res_161555;
                                defunc_0_lifted_step_res_161549 = defunc_0_lifted_step_res_f_res_161556;
                                defunc_0_lifted_step_res_161550 = defunc_0_lifted_step_res_f_res_161557;
                                defunc_0_lifted_step_res_161551 = defunc_0_lifted_step_res_f_res_161558;
                            }
                            
                            int64_t loopres_161614;
                            int64_t loopres_161615;
                            int64_t loopres_161616;
                            int64_t loopres_161617;
                            int64_t loopres_161618;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161614, &loopres_161615, &loopres_161616, &loopres_161617, &loopres_161618, defunc_0_lifted_step_res_161548, ss_161542, defunc_0_lifted_step_res_161549, defunc_0_lifted_step_res_161550, defunc_0_lifted_step_res_161551) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161619 = slt64((int64_t) 0, loopres_161618);
                            bool loop_while_tmp_171990 = loop_cond_161619;
                            int64_t ss_tmp_171991 = loopres_161614;
                            int64_t ss_tmp_171992 = loopres_161615;
                            int64_t tt_tmp_171993 = loopres_161616;
                            int64_t tt_tmp_171994 = loopres_161617;
                            int64_t count_tmp_171995 = loopres_161618;
                            
                            loop_while_161540 = loop_while_tmp_171990;
                            ss_161541 = ss_tmp_171991;
                            ss_161542 = ss_tmp_171992;
                            tt_161543 = tt_tmp_171993;
                            tt_161544 = tt_tmp_171994;
                            count_161545 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161534 = loop_while_161540;
                        defunc_0_split_count_res_161535 = ss_161541;
                        defunc_0_split_count_res_161536 = ss_161542;
                        defunc_0_split_count_res_161537 = tt_161543;
                        defunc_0_split_count_res_161538 = tt_161544;
                        defunc_0_split_count_res_161539 = count_161545;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161535;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161537;
                    }
                    if (mem_171392_cached_sizze_172400 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172400, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172401 < bytes_171394) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172401, bytes_171394);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161395; i_171029++) {
                        bool y_161625 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool index_certs_161627;
                        
                        if (!y_161625) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:136:31-35\n   #10 ftRelational.fut:135:5-136:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161628 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161630 = add64((int64_t) 1, i_171029);
                        bool x_161631 = sle64((int64_t) 0, tmp_161630);
                        bool y_161632 = slt64(tmp_161630, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396);
                        bool bounds_check_161633 = x_161631 && y_161632;
                        bool index_certs_161634;
                        
                        if (!bounds_check_161633) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161630, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161396, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:136:31-35\n   #10 ftRelational.fut:135:5-136:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161635 = ((int64_t *) mem_171375)[tmp_161630];
                        int64_t defunc_0_f_res_161636 = ((int64_t *) mem_171377)[tmp_161630];
                        int64_t merge_sequential_arg2_161637 = add64(stride_161374, defunc_0_f_res_161629);
                        int64_t merge_sequential_arg2_161638 = add64(stride_161374, defunc_0_f_res_161636);
                        int64_t j_m_i_161639 = sub64(merge_sequential_arg2_161638, merge_sequential_arg2_161637);
                        bool empty_slice_161640 = j_m_i_161639 == (int64_t) 0;
                        int64_t m_161641 = sub64(j_m_i_161639, (int64_t) 1);
                        int64_t i_p_m_t_s_161642 = add64(merge_sequential_arg2_161637, m_161641);
                        bool zzero_leq_i_p_m_t_s_161643 = sle64((int64_t) 0, i_p_m_t_s_161642);
                        bool i_p_m_t_s_leq_w_161644 = slt64(i_p_m_t_s_161642, next_stride_161375);
                        bool zzero_lte_i_161645 = sle64((int64_t) 0, merge_sequential_arg2_161637);
                        bool i_lte_j_161646 = sle64(merge_sequential_arg2_161637, merge_sequential_arg2_161638);
                        bool y_161647 = i_p_m_t_s_leq_w_161644 && zzero_lte_i_161645;
                        bool y_161648 = zzero_leq_i_p_m_t_s_161643 && y_161647;
                        bool forwards_ok_161649 = i_lte_j_161646 && y_161648;
                        bool ok_or_empty_161650 = empty_slice_161640 || forwards_ok_161649;
                        bool index_certs_161651;
                        
                        if (!ok_or_empty_161650) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161637, ":", (long long) merge_sequential_arg2_161638, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:136:31-35\n   #10 ftRelational.fut:135:5-136:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161652 = sub64(defunc_0_f_res_161635, defunc_0_f_res_161628);
                        bool empty_slice_161653 = j_m_i_161652 == (int64_t) 0;
                        int64_t m_161654 = sub64(j_m_i_161652, (int64_t) 1);
                        int64_t i_p_m_t_s_161655 = add64(defunc_0_f_res_161628, m_161654);
                        bool zzero_leq_i_p_m_t_s_161656 = sle64((int64_t) 0, i_p_m_t_s_161655);
                        bool i_p_m_t_s_leq_w_161657 = slt64(i_p_m_t_s_161655, next_stride_161375);
                        bool zzero_lte_i_161658 = sle64((int64_t) 0, defunc_0_f_res_161628);
                        bool i_lte_j_161659 = sle64(defunc_0_f_res_161628, defunc_0_f_res_161635);
                        bool y_161660 = i_p_m_t_s_leq_w_161657 && zzero_lte_i_161658;
                        bool y_161661 = zzero_leq_i_p_m_t_s_161656 && y_161660;
                        bool forwards_ok_161662 = i_lte_j_161659 && y_161661;
                        bool ok_or_empty_161663 = empty_slice_161653 || forwards_ok_161662;
                        bool index_certs_161664;
                        
                        if (!ok_or_empty_161663) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161628, ":", (long long) defunc_0_f_res_161635, "] out of bounds for array of shape [", (long long) next_stride_161375, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:136:31-35\n   #10 ftRelational.fut:135:5-136:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161665 = slt64((int64_t) 0, j_m_i_161652);
                        int16_t dummy_161666;
                        int64_t dummy_161667;
                        
                        if (cond_161665) {
                            bool index_certs_162084;
                            
                            if (!cond_161665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:136:31-35\n   #12 ftRelational.fut:135:5-136:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161447 + defunc_0_f_res_161628;
                            int16_t head_res_162086 = ((int16_t *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161666 = head_res_162086;
                            dummy_161667 = head_res_162087;
                        } else {
                            bool y_161672 = slt64((int64_t) 0, j_m_i_161639);
                            bool index_certs_161673;
                            
                            if (!y_161672) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:136:31-35\n   #12 ftRelational.fut:135:5-136:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161674 = start_161447 + merge_sequential_arg2_161637;
                            int16_t head_res_161675 = ((int16_t *) mem_param_171356.mem)[slice_161674];
                            int64_t head_res_161676 = ((int64_t *) mem_param_171359.mem)[slice_161674];
                            
                            dummy_161666 = head_res_161675;
                            dummy_161667 = head_res_161676;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161260; nest_i_171998++) {
                            ((int16_t *) mem_171392)[i_171029 * merge_block_sizze_161260 + nest_i_171998] = dummy_161666;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161260; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + nest_i_171999] = dummy_161667;
                        }
                        
                        int64_t data_161679;
                        int64_t i_161683 = (int64_t) 0;
                        
                        for (int64_t k_161682 = 0; k_161682 < merge_block_sizze_161260; k_161682++) {
                            int64_t j_161686 = sub64(k_161682, i_161683);
                            bool cond_161687 = j_161686 == j_m_i_161639;
                            bool cond_161688;
                            
                            if (cond_161687) {
                                cond_161688 = 1;
                            } else {
                                bool cond_161689 = slt64(i_161683, j_m_i_161652);
                                bool cond_f_res_161690;
                                
                                if (cond_161689) {
                                    bool x_162088 = sle64((int64_t) 0, j_161686);
                                    bool y_162089 = slt64(j_161686, j_m_i_161639);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:136:31-35\n   #11 ftRelational.fut:135:5-136:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161683);
                                    bool bounds_check_162096 = cond_161689 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:136:31-35\n   #11 ftRelational.fut:135:5-136:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161637 + j_161686;
                                    int64_t slice_162093 = start_161447 + slice_162092;
                                    int16_t leq_arg1_162094 = ((int16_t *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161628 + i_161683;
                                    int64_t slice_162099 = start_161447 + slice_162098;
                                    int16_t leq_arg0_162100 = ((int16_t *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = sle16(leq_arg0_162100, leq_arg1_162094);
                                    
                                    cond_f_res_161690 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161690 = 0;
                                }
                                cond_161688 = cond_f_res_161690;
                            }
                            
                            int64_t loopres_161705;
                            int16_t loopres_161706;
                            int64_t loopres_161707;
                            
                            if (cond_161688) {
                                bool x_162103 = sle64((int64_t) 0, i_161683);
                                bool y_162104 = slt64(i_161683, j_m_i_161652);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161683, "] out of bounds for array of shape [", (long long) j_m_i_161652, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:136:31-35\n   #11 ftRelational.fut:135:5-136:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161683);
                                int64_t slice_162107 = defunc_0_f_res_161628 + i_161683;
                                int64_t slice_162108 = start_161447 + slice_162107;
                                int16_t tmp_162109 = ((int16_t *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161705 = tmp_162102;
                                loopres_161706 = tmp_162109;
                                loopres_161707 = tmp_162110;
                            } else {
                                bool x_161717 = sle64((int64_t) 0, j_161686);
                                bool y_161718 = slt64(j_161686, j_m_i_161639);
                                bool bounds_check_161719 = x_161717 && y_161718;
                                bool index_certs_161720;
                                
                                if (!bounds_check_161719) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161686, "] out of bounds for array of shape [", (long long) j_m_i_161639, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:136:31-35\n   #11 ftRelational.fut:135:5-136:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161721 = merge_sequential_arg2_161637 + j_161686;
                                int64_t slice_161722 = start_161447 + slice_161721;
                                int16_t tmp_161723 = ((int16_t *) mem_param_171356.mem)[slice_161722];
                                int64_t tmp_161724 = ((int64_t *) mem_param_171359.mem)[slice_161722];
                                
                                loopres_161705 = i_161683;
                                loopres_161706 = tmp_161723;
                                loopres_161707 = tmp_161724;
                            }
                            ((int16_t *) mem_171392)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161706;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161260 + k_161682] = loopres_161707;
                            
                            int64_t i_tmp_172000 = loopres_161705;
                            
                            i_161683 = i_tmp_172000;
                        }
                        data_161679 = i_161683;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint16_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171394, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161260, (int64_t) 1}, (int64_t []) {num_blocks_161395, merge_block_sizze_161260});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_171362, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161375, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161375});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161731 = next_stride_161375 * num_merges_161379;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint16_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            if (memblock_alloc(ctx, &mem_171472, bytes_171364, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161375, (int64_t) 1}, (int64_t []) {num_merges_161379, next_stride_161375});
            
            bool loop_cond_161734 = slt64(next_stride_161375, flat_dim_161256);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161731;
            bool loop_while_tmp_171977 = loop_cond_161734;
            int64_t stride_tmp_171980 = next_stride_161375;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161370 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161371 = loop_while_tmp_171977;
            stride_161374 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161365 = loop_dz2084Uz2082U_161370;
        data_161366 = loop_while_161371;
        data_161369 = stride_161374;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161735 = n_104792 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161736 = sle64((int64_t) 0, zs_lhs_161240);
        bool i_p_m_t_s_leq_w_161737 = slt64(zs_lhs_161240, data_161365);
        bool y_161738 = zzero_leq_i_p_m_t_s_161736 && i_p_m_t_s_leq_w_161737;
        bool ok_or_empty_161739 = empty_slice_161735 || y_161738;
        bool index_certs_161740;
        
        if (!ok_or_empty_161739) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_104792, "] out of bounds for array of shape [", (long long) data_161365, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:136:31-35\n   #6  ftRelational.fut:135:5-136:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_104792; i_171043++) {
        int64_t eta_p_161748 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161749 = sle64((int64_t) 0, eta_p_161748);
        bool y_161750 = slt64(eta_p_161748, n_104792);
        bool bounds_check_161751 = x_161749 && y_161750;
        bool index_certs_161752;
        
        if (!bounds_check_161751) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161748, "] out of bounds for array of shape [", (long long) n_104792, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:136:31-35\n   #5  ftRelational.fut:135:5-136:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_161753 = ((int64_t *) ext_mem_171275.mem)[eta_p_161748];
        int16_t lifted_lambda_res_161754 = ((int16_t *) xs_mem_171274.mem)[eta_p_161748];
        
        ((int64_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161753;
        ((int16_t *) mem_171486.mem)[i_171043] = lifted_lambda_res_161754;
    }
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172390, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172391, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_172402, struct memblock *mem_out_p_172403, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_98299, int64_t b_98300)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172404 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172405 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172406 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172407 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172408 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172409 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172410 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172411 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172412 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172413 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_98299;
    bool cond_161233 = sle64(n_98299, (int64_t) 1);
    int64_t zs_lhs_161234 = sub64(n_98299, (int64_t) 1);
    int64_t zp_rhs_161235 = sdiv_safe64(zs_lhs_161234, (int64_t) 20);
    int64_t min_num_blocks_161236 = add64((int64_t) 1, zp_rhs_161235);
    bool loop_cond_161237 = slt64((int64_t) 1, min_num_blocks_161236);
    bool smallest_pow_2_geq_than_res_161238;
    int64_t smallest_pow_2_geq_than_res_161239;
    bool loop_while_161240;
    int64_t x_161241;
    
    loop_while_161240 = loop_cond_161237;
    x_161241 = (int64_t) 1;
    while (loop_while_161240) {
        int64_t loopres_161242 = mul64((int64_t) 2, x_161241);
        bool loop_cond_161243 = slt64(loopres_161242, min_num_blocks_161236);
        bool loop_while_tmp_171958 = loop_cond_161243;
        int64_t x_tmp_171959 = loopres_161242;
        
        loop_while_161240 = loop_while_tmp_171958;
        x_161241 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161238 = loop_while_161240;
    smallest_pow_2_geq_than_res_161239 = x_161241;
    
    bool zzero_161244 = smallest_pow_2_geq_than_res_161239 == (int64_t) 0;
    bool nonzzero_161245 = !zzero_161244;
    bool protect_assert_disj_161246 = cond_161233 || nonzzero_161245;
    bool nonzzero_cert_161247;
    
    if (!protect_assert_disj_161246) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:118:32-36\n   #5  ftRelational.fut:115:5-118:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161248 = sdiv_safe64(zs_lhs_161234, smallest_pow_2_geq_than_res_161239);
    int64_t block_sizze_161249 = add64((int64_t) 1, zp_rhs_161248);
    bool y_161255 = slt64((int64_t) 0, n_98299);
    bool protect_assert_disj_171871 = cond_161233 || y_161255;
    bool index_certs_161256;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_98299, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:118:32-36\n   #5  ftRelational.fut:115:5-118:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161270 = slt64(smallest_pow_2_geq_than_res_161239, (int64_t) 0);
    bool valid_161271 = !bounds_invalid_upwards_161270;
    bool protect_assert_disj_171879 = cond_161233 || valid_161271;
    bool range_valid_c_161272;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:118:32-36\n   #6  ftRelational.fut:115:5-118:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161274 = slt64(block_sizze_161249, (int64_t) 0);
    bool valid_161275 = !bounds_invalid_upwards_161274;
    bool protect_assert_disj_171881 = cond_161233 || valid_161275;
    bool range_valid_c_161276;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161249, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161278 = sle64(block_sizze_161249, (int64_t) 1);
    int64_t tmp_161279 = sub64(block_sizze_161249, (int64_t) 2);
    bool bounds_invalid_upwards_161280 = slt64(tmp_161279, (int64_t) 0);
    bool valid_161282 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_161283 = cond_161278 || valid_161282;
    bool protect_assert_disj_171883 = cond_161233 || protect_assert_disj_161283;
    bool range_valid_c_161284;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161279, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171485 = n_98299 * b_98300;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_98299; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161250 = smallest_pow_2_geq_than_res_161239 * block_sizze_161249;
    bool x_171866 = !cond_161233;
    int64_t greatest_divisor_leq_than_arg1_161253 = mul64((int64_t) 2, block_sizze_161249);
    int64_t merge_block_sizze_161254;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161253) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161254 = x_171868;
    } else {
        merge_block_sizze_161254 = (int64_t) 0;
    }
    
    double reduce_arg1_161257;
    
    if (x_171866) {
        double x_171872 = ((double *) k_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161257 = x_171872;
    } else {
        reduce_arg1_161257 = 0.0;
    }
    
    double defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        double x_171874;
        int64_t x_171875;
        double redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161257;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_98299; i_171003++) {
            double x_161261 = ((double *) k_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161267 = redout_171001 <= x_161261;
            double defunc_0_op_res_161268;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161268 = x_161261;
            } else {
                defunc_0_op_res_161268 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161269;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161269 = i_171003;
            } else {
                defunc_0_op_res_161269 = redout_171002;
            }
            
            double redout_tmp_171962 = defunc_0_op_res_161268;
            int64_t redout_tmp_171963 = defunc_0_op_res_161269;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = 0.0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161281 = add64((int64_t) 1, tmp_161279);
    int64_t binop_x_171278 = (int64_t) 8 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171279 = block_sizze_161249 * binop_x_171278;
    int64_t bytes_171292 = (int64_t) 8 * block_sizze_161249;
    bool loop_cond_161356 = slt64(block_sizze_161249, flat_dim_161250);
    bool zzero_161357 = merge_block_sizze_161254 == (int64_t) 0;
    bool nonzzero_161358 = !zzero_161357;
    
    if (cond_161233) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172404 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172404, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172405 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172405, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172406 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172406, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172407 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172407, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161239; i_171015++) {
            int64_t zp_lhs_161288 = mul64(block_sizze_161249, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161249; i_171008++) {
                int64_t k_161292 = add64(zp_lhs_161288, i_171008);
                bool cond_161293 = slt64(k_161292, n_98299);
                double lifted_lambda_res_161294;
                int64_t lifted_lambda_res_161295;
                
                if (cond_161293) {
                    bool x_161970 = sle64((int64_t) 0, k_161292);
                    bool bounds_check_161971 = cond_161293 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161292, "] out of bounds for array of shape [", (long long) n_98299, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_161973 = ((double *) k_mem_171274.mem)[k_161292];
                    
                    lifted_lambda_res_161294 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161295 = k_161292;
                } else {
                    lifted_lambda_res_161294 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161295 = defunc_0_reduce_res_162118;
                }
                ((double *) mem_171293)[i_171008] = lifted_lambda_res_161294;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161295;
            }
            if (!cond_161278) {
                for (int64_t i_161305 = 0; i_161305 < distance_161281; i_161305++) {
                    int64_t gt_arg1_161308 = add64((int64_t) 1, i_161305);
                    bool x_161309 = sle64((int64_t) 0, gt_arg1_161308);
                    bool y_161310 = slt64(gt_arg1_161308, block_sizze_161249);
                    bool bounds_check_161311 = x_161309 && y_161310;
                    bool index_certs_161312;
                    
                    if (!bounds_check_161311) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161308, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161314 = slt64(i_161305, block_sizze_161249);
                    bool index_certs_161315;
                    
                    if (!y_161314) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161305, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_161313 = ((double *) mem_171293)[gt_arg1_161308];
                    double gt_arg0_161316 = ((double *) mem_171293)[i_161305];
                    bool defunc_0_leq_res_161317 = gt_arg0_161316 <= gt_arg1_161313;
                    bool defunc_0_lifted_gt_res_161318 = !defunc_0_leq_res_161317;
                    bool s_161319;
                    int64_t s_161322;
                    bool loop_while_161323;
                    int64_t j_161326;
                    
                    loop_while_161323 = defunc_0_lifted_gt_res_161318;
                    j_161326 = i_161305;
                    while (loop_while_161323) {
                        bool x_161327 = sle64((int64_t) 0, j_161326);
                        bool y_161328 = slt64(j_161326, block_sizze_161249);
                        bool bounds_check_161329 = x_161327 && y_161328;
                        bool index_certs_161330;
                        
                        if (!bounds_check_161329) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161326, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161333 = add64((int64_t) 1, j_161326);
                        bool x_161334 = sle64((int64_t) 0, copy_arg0_161333);
                        bool y_161335 = slt64(copy_arg0_161333, block_sizze_161249);
                        bool bounds_check_161336 = x_161334 && y_161335;
                        bool index_certs_161337;
                        
                        if (!bounds_check_161336) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161333, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_161331 = ((double *) mem_171293)[j_161326];
                        int64_t copy_arg0_161332 = ((int64_t *) mem_171295)[j_161326];
                        double copy_arg0_161338 = ((double *) mem_171293)[copy_arg0_161333];
                        int64_t copy_arg0_161339 = ((int64_t *) mem_171295)[copy_arg0_161333];
                        
                        ((double *) mem_171293)[j_161326] = copy_arg0_161338;
                        ((int64_t *) mem_171295)[j_161326] = copy_arg0_161339;
                        ((double *) mem_171293)[copy_arg0_161333] = copy_arg0_161331;
                        ((int64_t *) mem_171295)[copy_arg0_161333] = copy_arg0_161332;
                        
                        int64_t tmp_161344 = sub64(j_161326, (int64_t) 1);
                        bool cond_161345 = sle64((int64_t) 0, tmp_161344);
                        bool loop_cond_161346;
                        
                        if (cond_161345) {
                            bool y_161975 = slt64(tmp_161344, block_sizze_161249);
                            bool bounds_check_161976 = cond_161345 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161344, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_161974 = ((double *) mem_171293)[j_161326];
                            double gt_arg0_161978 = ((double *) mem_171293)[tmp_161344];
                            bool defunc_0_leq_res_161979 = gt_arg0_161978 <= gt_arg1_161974;
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161346 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161346 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161346;
                        int64_t j_tmp_171973 = tmp_161344;
                        
                        loop_while_161323 = loop_while_tmp_171970;
                        j_161326 = j_tmp_171973;
                    }
                    s_161319 = loop_while_161323;
                    s_161322 = j_161326;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171280, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        if (memblock_alloc(ctx, &mem_171352, bytes_171279, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        
        int64_t data_161359;
        bool data_161360;
        int64_t data_161363;
        int64_t loop_dz2084Uz2082U_161364;
        bool loop_while_161365;
        int64_t stride_161368;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161364 = flat_dim_161250;
        loop_while_161365 = loop_cond_161356;
        stride_161368 = block_sizze_161249;
        while (loop_while_161365) {
            int64_t next_stride_161369 = mul64((int64_t) 2, stride_161368);
            bool zzero_161370 = next_stride_161369 == (int64_t) 0;
            bool nonzzero_161371 = !zzero_161370;
            bool nonzzero_cert_161372;
            
            if (!nonzzero_161371) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:118:32-36\n   #5  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161373 = sdiv64(flat_dim_161250, next_stride_161369);
            bool bounds_invalid_upwards_161374 = slt64(num_merges_161373, (int64_t) 0);
            bool valid_161375 = !bounds_invalid_upwards_161374;
            bool range_valid_c_161376;
            
            if (!valid_161375) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161373, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:118:32-36\n   #6  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161378 = sub64(next_stride_161369, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161379 = sle64((int64_t) 0, m_161378);
            bool cond_161381 = slt64(next_stride_161369, (int64_t) 10);
            bool protect_assert_disj_161382 = nonzzero_161358 || cond_161381;
            bool nonzzero_cert_161383;
            
            if (!protect_assert_disj_161382) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161384 = smod_safe64(next_stride_161369, merge_block_sizze_161254);
            bool num_blocks_161385 = zeze_lhs_161384 == (int64_t) 0;
            bool protect_assert_disj_161386 = cond_161381 || num_blocks_161385;
            bool assert_c_161387;
            
            if (!protect_assert_disj_161386) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161389 = sdiv_safe64(next_stride_161369, merge_block_sizze_161254);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390 = add64((int64_t) 1, num_blocks_161389);
            int64_t j_m_i_161391 = sub64(next_stride_161369, stride_161368);
            int64_t flat_dim_161392 = merge_block_sizze_161254 * num_blocks_161389;
            bool bounds_invalid_upwards_161393 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, (int64_t) 0);
            bool empty_slice_161394 = j_m_i_161391 == (int64_t) 0;
            int64_t m_161395 = sub64(j_m_i_161391, (int64_t) 1);
            bool zzero_lte_i_161396 = sle64((int64_t) 0, stride_161368);
            bool i_lte_j_161397 = sle64(stride_161368, next_stride_161369);
            bool empty_slice_161398 = stride_161368 == (int64_t) 0;
            int64_t m_161399 = sub64(stride_161368, (int64_t) 1);
            bool bounds_invalid_upwards_161400 = slt64(num_blocks_161389, (int64_t) 0);
            bool cond_161401 = slt64((int64_t) 0, stride_161368);
            bool valid_161402 = !bounds_invalid_upwards_161393;
            int64_t i_p_m_t_s_161403 = add64(stride_161368, m_161395);
            bool zzero_leq_i_p_m_t_s_161404 = sle64((int64_t) 0, m_161399);
            bool i_p_m_t_s_leq_w_161405 = slt64(m_161399, next_stride_161369);
            bool valid_161406 = !bounds_invalid_upwards_161400;
            bool i_p_m_t_s_leq_w_161407 = slt64(m_161378, flat_dim_161392);
            bool y_161408 = slt64((int64_t) 0, j_m_i_161391);
            bool protect_assert_disj_161409 = cond_161381 || valid_161402;
            bool range_valid_c_161410;
            
            if (!protect_assert_disj_161409) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:118:32-36\n   #10 ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161411 = sle64((int64_t) 0, i_p_m_t_s_161403);
            bool i_p_m_t_s_leq_w_161412 = slt64(i_p_m_t_s_161403, next_stride_161369);
            bool y_161413 = zzero_leq_i_p_m_t_s_161404 && i_p_m_t_s_leq_w_161405;
            bool protect_assert_disj_161414 = cond_161381 || valid_161406;
            bool range_valid_c_161415;
            
            if (!protect_assert_disj_161414) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161389, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161416 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161407;
            bool y_161417 = zzero_lte_i_161396 && i_p_m_t_s_leq_w_161412;
            bool forwards_ok_161418 = zzero_lte_i_161396 && y_161413;
            bool ok_or_empty_161419 = zzero_161370 || y_161416;
            bool protect_assert_disj_161420 = cond_161401 || y_161408;
            bool y_161421 = zzero_leq_i_p_m_t_s_161411 && y_161417;
            bool ok_or_empty_161422 = empty_slice_161398 || forwards_ok_161418;
            bool protect_assert_disj_161423 = cond_161381 || ok_or_empty_161419;
            bool index_certs_161424;
            
            if (!protect_assert_disj_161423) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) flat_dim_161392, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161425 = !cond_161381;
            bool protect_assert_disj_161426 = protect_assert_disj_161420 || loop_not_taken_161425;
            bool index_certs_161427;
            
            if (!protect_assert_disj_161426) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:118:32-36\n   #10 ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161428 = i_lte_j_161397 && y_161421;
            bool protect_assert_disj_161429 = cond_161381 || ok_or_empty_161422;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:118:32-36\n   #11 ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161431 = ok_or_empty_161422 || loop_not_taken_161425;
            bool index_certs_161432;
            
            if (!protect_assert_disj_161431) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161433 = empty_slice_161394 || forwards_ok_161428;
            bool protect_assert_disj_161434 = cond_161381 || ok_or_empty_161433;
            bool index_certs_161435;
            
            if (!protect_assert_disj_161434) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:118:32-36\n   #11 ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161436 = loop_not_taken_161425 || ok_or_empty_161433;
            bool index_certs_161437;
            
            if (!protect_assert_disj_161436) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 8 * num_merges_161373;
            int64_t bytes_171361 = next_stride_161369 * binop_x_171360;
            bool i_lte_j_161380 = sle64((int64_t) 0, next_stride_161369);
            
            if (mem_171362_cached_sizze_172408 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172408, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172409 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172409, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390;
            int64_t binop_x_171390 = (int64_t) 8 * num_blocks_161389;
            int64_t bytes_171391 = merge_block_sizze_161254 * binop_x_171390;
            int64_t bytes_171436 = (int64_t) 16 * stride_161368;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161373; i_171036++) {
                int64_t start_161441 = mul64(next_stride_161369, i_171036);
                int64_t j_m_i_161442 = sub64(loop_dz2084Uz2082U_161364, start_161441);
                bool empty_slice_161443 = j_m_i_161442 == (int64_t) 0;
                int64_t m_161444 = sub64(j_m_i_161442, (int64_t) 1);
                int64_t i_p_m_t_s_161445 = add64(start_161441, m_161444);
                bool zzero_leq_i_p_m_t_s_161446 = sle64((int64_t) 0, i_p_m_t_s_161445);
                bool i_p_m_t_s_leq_w_161447 = slt64(i_p_m_t_s_161445, loop_dz2084Uz2082U_161364);
                bool zzero_lte_i_161448 = sle64((int64_t) 0, start_161441);
                bool i_lte_j_161449 = sle64(start_161441, loop_dz2084Uz2082U_161364);
                bool y_161450 = i_p_m_t_s_leq_w_161447 && zzero_lte_i_161448;
                bool y_161451 = zzero_leq_i_p_m_t_s_161446 && y_161450;
                bool forwards_ok_161452 = i_lte_j_161449 && y_161451;
                bool ok_or_empty_161453 = empty_slice_161443 || forwards_ok_161452;
                bool index_certs_161454;
                
                if (!ok_or_empty_161453) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161441, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161364, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161455 = slt64(m_161378, j_m_i_161442);
                bool y_161456 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161455;
                bool forwards_ok_161457 = i_lte_j_161380 && y_161456;
                bool ok_or_empty_161458 = zzero_161370 || forwards_ok_161457;
                bool index_certs_161459;
                
                if (!ok_or_empty_161458) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) j_m_i_161442, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:118:32-36\n   #8  ftRelational.fut:115:5-118:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161381) {
                    double dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161401) {
                        double head_res_162008 = ((double *) mem_param_171356.mem)[start_161441];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161441];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161368 + start_161441;
                        double head_res_162011 = ((double *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161369; nest_i_171983++) {
                        ((double *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171436, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161369; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161369; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161391;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161368);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161391);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161368 + j_162022;
                                int64_t slice_162032 = start_161441 + slice_162031;
                                double leq_arg1_162033 = ((double *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161441 + i_162019;
                                double leq_arg0_162038 = ((double *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = leq_arg0_162038 <= leq_arg1_162033;
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        double loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161368);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161441 + i_162019;
                            double tmp_162049 = ((double *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161391);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:118:32-36\n   #9  ftRelational.fut:115:5-118:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161368 + j_162022;
                            int64_t slice_162056 = start_161441 + slice_162055;
                            double tmp_162057 = ((double *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((double *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172410 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172410, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172411 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172411, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390; i_171022++) {
                        int64_t split_count_arg3_161521 = mul64(merge_block_sizze_161254, i_171022);
                        int64_t defunc_0_split_count_res_161522;
                        int64_t defunc_0_split_count_res_161523;
                        int64_t defunc_0_split_count_res_161524;
                        int64_t defunc_0_split_count_res_161525;
                        int64_t defunc_0_split_count_res_161526;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161522, &defunc_0_split_count_res_161523, &defunc_0_split_count_res_161524, &defunc_0_split_count_res_161525, &defunc_0_split_count_res_161526, (int64_t) 0, stride_161368, (int64_t) 0, j_m_i_161391, split_count_arg3_161521) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161527 = slt64((int64_t) 0, defunc_0_split_count_res_161526);
                        bool defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        int64_t defunc_0_split_count_res_161533;
                        bool loop_while_161534;
                        int64_t ss_161535;
                        int64_t ss_161536;
                        int64_t tt_161537;
                        int64_t tt_161538;
                        int64_t count_161539;
                        
                        loop_while_161534 = loop_cond_161527;
                        ss_161535 = defunc_0_split_count_res_161522;
                        ss_161536 = defunc_0_split_count_res_161523;
                        tt_161537 = defunc_0_split_count_res_161524;
                        tt_161538 = defunc_0_split_count_res_161525;
                        count_161539 = defunc_0_split_count_res_161526;
                        while (loop_while_161534) {
                            int64_t zlze_lhs_161540 = sub64(ss_161536, ss_161535);
                            bool cond_161541 = sle64(zlze_lhs_161540, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161542;
                            int64_t defunc_0_lifted_step_res_161543;
                            int64_t defunc_0_lifted_step_res_161544;
                            int64_t defunc_0_lifted_step_res_161545;
                            
                            if (cond_161541) {
                                int64_t tmp_162061 = add64(tt_161537, count_161539);
                                
                                defunc_0_lifted_step_res_161542 = ss_161535;
                                defunc_0_lifted_step_res_161543 = tmp_162061;
                                defunc_0_lifted_step_res_161544 = tt_161538;
                                defunc_0_lifted_step_res_161545 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161547 = sub64(tt_161538, tt_161537);
                                bool cond_161548 = sle64(zlze_lhs_161547, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161549;
                                int64_t defunc_0_lifted_step_res_f_res_161550;
                                int64_t defunc_0_lifted_step_res_f_res_161551;
                                int64_t defunc_0_lifted_step_res_f_res_161552;
                                
                                if (cond_161548) {
                                    int64_t tmp_162062 = add64(ss_161535, count_161539);
                                    
                                    defunc_0_lifted_step_res_f_res_161549 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161550 = tt_161537;
                                    defunc_0_lifted_step_res_f_res_161551 = tt_161538;
                                    defunc_0_lifted_step_res_f_res_161552 = (int64_t) 0;
                                } else {
                                    bool cond_161554 = count_161539 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161555;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161556;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161557;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161558;
                                    
                                    if (cond_161554) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161535);
                                        bool y_162065 = slt64(ss_161535, stride_161368);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161535, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:118:32-36\n   #13 ftRelational.fut:115:5-118:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161537);
                                        bool y_162071 = slt64(tt_161537, j_m_i_161391);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161537, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:118:32-36\n   #13 ftRelational.fut:115:5-118:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161441 + ss_161535;
                                        double leq_arg1_162069 = ((double *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161368 + tt_161537;
                                        int64_t slice_162075 = start_161441 + slice_162074;
                                        double leq_arg0_162076 = ((double *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = leq_arg0_162076 <= leq_arg1_162069;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161537);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161535;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161535);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161537;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = tt_161538;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = (int64_t) 0;
                                    } else {
                                        int64_t m_161577 = sdiv64(count_161539, (int64_t) 2);
                                        int64_t n_161578 = sub64(count_161539, m_161577);
                                        bool cond_161579 = n_161578 == (int64_t) 0;
                                        int64_t zgze_lhs_161580 = add64(ss_161535, m_161577);
                                        bool cond_f_res_161581 = sle64(ss_161536, zgze_lhs_161580);
                                        bool x_161582 = !cond_161579;
                                        bool y_161583 = cond_f_res_161581 && x_161582;
                                        bool cond_161584 = cond_161579 || y_161583;
                                        bool leq_y_x_161585;
                                        
                                        if (cond_161584) {
                                            leq_y_x_161585 = 1;
                                        } else {
                                            bool x_161586 = sle64((int64_t) 0, zgze_lhs_161580);
                                            bool y_161587 = slt64(zgze_lhs_161580, stride_161368);
                                            bool bounds_check_161588 = x_161586 && y_161587;
                                            bool index_certs_161589;
                                            
                                            if (!bounds_check_161588) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161580, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:118:32-36\n   #13 ftRelational.fut:115:5-118:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161592 = add64(tt_161537, n_161578);
                                            int64_t leq_arg0_161593 = sub64(zm_lhs_161592, (int64_t) 1);
                                            bool x_161594 = sle64((int64_t) 0, leq_arg0_161593);
                                            bool y_161595 = slt64(leq_arg0_161593, j_m_i_161391);
                                            bool bounds_check_161596 = x_161594 && y_161595;
                                            bool index_certs_161597;
                                            
                                            if (!bounds_check_161596) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161593, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:118:32-36\n   #13 ftRelational.fut:115:5-118:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161590 = start_161441 + zgze_lhs_161580;
                                            double leq_arg1_161591 = ((double *) mem_param_171356.mem)[slice_161590];
                                            int64_t slice_161598 = stride_161368 + leq_arg0_161593;
                                            int64_t slice_161599 = start_161441 + slice_161598;
                                            double leq_arg0_161600 = ((double *) mem_param_171356.mem)[slice_161599];
                                            bool defunc_0_leq_res_161601 = leq_arg0_161600 <= leq_arg1_161591;
                                            
                                            leq_y_x_161585 = defunc_0_leq_res_161601;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                        
                                        if (leq_y_x_161585) {
                                            int64_t tmp_162082 = add64(tt_161537, n_161578);
                                            int64_t tmp_162083 = sub64(count_161539, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tt_161538;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = tmp_162083;
                                        } else {
                                            int64_t tmp_161607 = add64(tt_161537, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tt_161537;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tmp_161607;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = count_161539;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = ss_161535;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                    }
                                    defunc_0_lifted_step_res_f_res_161549 = defunc_0_lifted_step_res_f_res_f_res_161555;
                                    defunc_0_lifted_step_res_f_res_161550 = defunc_0_lifted_step_res_f_res_f_res_161556;
                                    defunc_0_lifted_step_res_f_res_161551 = defunc_0_lifted_step_res_f_res_f_res_161557;
                                    defunc_0_lifted_step_res_f_res_161552 = defunc_0_lifted_step_res_f_res_f_res_161558;
                                }
                                defunc_0_lifted_step_res_161542 = defunc_0_lifted_step_res_f_res_161549;
                                defunc_0_lifted_step_res_161543 = defunc_0_lifted_step_res_f_res_161550;
                                defunc_0_lifted_step_res_161544 = defunc_0_lifted_step_res_f_res_161551;
                                defunc_0_lifted_step_res_161545 = defunc_0_lifted_step_res_f_res_161552;
                            }
                            
                            int64_t loopres_161608;
                            int64_t loopres_161609;
                            int64_t loopres_161610;
                            int64_t loopres_161611;
                            int64_t loopres_161612;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161608, &loopres_161609, &loopres_161610, &loopres_161611, &loopres_161612, defunc_0_lifted_step_res_161542, ss_161536, defunc_0_lifted_step_res_161543, defunc_0_lifted_step_res_161544, defunc_0_lifted_step_res_161545) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161613 = slt64((int64_t) 0, loopres_161612);
                            bool loop_while_tmp_171990 = loop_cond_161613;
                            int64_t ss_tmp_171991 = loopres_161608;
                            int64_t ss_tmp_171992 = loopres_161609;
                            int64_t tt_tmp_171993 = loopres_161610;
                            int64_t tt_tmp_171994 = loopres_161611;
                            int64_t count_tmp_171995 = loopres_161612;
                            
                            loop_while_161534 = loop_while_tmp_171990;
                            ss_161535 = ss_tmp_171991;
                            ss_161536 = ss_tmp_171992;
                            tt_161537 = tt_tmp_171993;
                            tt_161538 = tt_tmp_171994;
                            count_161539 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161528 = loop_while_161534;
                        defunc_0_split_count_res_161529 = ss_161535;
                        defunc_0_split_count_res_161530 = ss_161536;
                        defunc_0_split_count_res_161531 = tt_161537;
                        defunc_0_split_count_res_161532 = tt_161538;
                        defunc_0_split_count_res_161533 = count_161539;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161529;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161531;
                    }
                    if (mem_171392_cached_sizze_172412 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172412, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172413 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172413, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161389; i_171029++) {
                        bool y_161619 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool index_certs_161621;
                        
                        if (!y_161619) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:118:32-36\n   #10 ftRelational.fut:115:5-118:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161622 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161623 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161624 = add64((int64_t) 1, i_171029);
                        bool x_161625 = sle64((int64_t) 0, tmp_161624);
                        bool y_161626 = slt64(tmp_161624, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool bounds_check_161627 = x_161625 && y_161626;
                        bool index_certs_161628;
                        
                        if (!bounds_check_161627) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161624, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:118:32-36\n   #10 ftRelational.fut:115:5-118:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171375)[tmp_161624];
                        int64_t defunc_0_f_res_161630 = ((int64_t *) mem_171377)[tmp_161624];
                        int64_t merge_sequential_arg2_161631 = add64(stride_161368, defunc_0_f_res_161623);
                        int64_t merge_sequential_arg2_161632 = add64(stride_161368, defunc_0_f_res_161630);
                        int64_t j_m_i_161633 = sub64(merge_sequential_arg2_161632, merge_sequential_arg2_161631);
                        bool empty_slice_161634 = j_m_i_161633 == (int64_t) 0;
                        int64_t m_161635 = sub64(j_m_i_161633, (int64_t) 1);
                        int64_t i_p_m_t_s_161636 = add64(merge_sequential_arg2_161631, m_161635);
                        bool zzero_leq_i_p_m_t_s_161637 = sle64((int64_t) 0, i_p_m_t_s_161636);
                        bool i_p_m_t_s_leq_w_161638 = slt64(i_p_m_t_s_161636, next_stride_161369);
                        bool zzero_lte_i_161639 = sle64((int64_t) 0, merge_sequential_arg2_161631);
                        bool i_lte_j_161640 = sle64(merge_sequential_arg2_161631, merge_sequential_arg2_161632);
                        bool y_161641 = i_p_m_t_s_leq_w_161638 && zzero_lte_i_161639;
                        bool y_161642 = zzero_leq_i_p_m_t_s_161637 && y_161641;
                        bool forwards_ok_161643 = i_lte_j_161640 && y_161642;
                        bool ok_or_empty_161644 = empty_slice_161634 || forwards_ok_161643;
                        bool index_certs_161645;
                        
                        if (!ok_or_empty_161644) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161631, ":", (long long) merge_sequential_arg2_161632, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:118:32-36\n   #10 ftRelational.fut:115:5-118:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161646 = sub64(defunc_0_f_res_161629, defunc_0_f_res_161622);
                        bool empty_slice_161647 = j_m_i_161646 == (int64_t) 0;
                        int64_t m_161648 = sub64(j_m_i_161646, (int64_t) 1);
                        int64_t i_p_m_t_s_161649 = add64(defunc_0_f_res_161622, m_161648);
                        bool zzero_leq_i_p_m_t_s_161650 = sle64((int64_t) 0, i_p_m_t_s_161649);
                        bool i_p_m_t_s_leq_w_161651 = slt64(i_p_m_t_s_161649, next_stride_161369);
                        bool zzero_lte_i_161652 = sle64((int64_t) 0, defunc_0_f_res_161622);
                        bool i_lte_j_161653 = sle64(defunc_0_f_res_161622, defunc_0_f_res_161629);
                        bool y_161654 = i_p_m_t_s_leq_w_161651 && zzero_lte_i_161652;
                        bool y_161655 = zzero_leq_i_p_m_t_s_161650 && y_161654;
                        bool forwards_ok_161656 = i_lte_j_161653 && y_161655;
                        bool ok_or_empty_161657 = empty_slice_161647 || forwards_ok_161656;
                        bool index_certs_161658;
                        
                        if (!ok_or_empty_161657) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161622, ":", (long long) defunc_0_f_res_161629, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:118:32-36\n   #10 ftRelational.fut:115:5-118:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161659 = slt64((int64_t) 0, j_m_i_161646);
                        double dummy_161660;
                        int64_t dummy_161661;
                        
                        if (cond_161659) {
                            bool index_certs_162084;
                            
                            if (!cond_161659) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:118:32-36\n   #12 ftRelational.fut:115:5-118:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161441 + defunc_0_f_res_161622;
                            double head_res_162086 = ((double *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161660 = head_res_162086;
                            dummy_161661 = head_res_162087;
                        } else {
                            bool y_161666 = slt64((int64_t) 0, j_m_i_161633);
                            bool index_certs_161667;
                            
                            if (!y_161666) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:118:32-36\n   #12 ftRelational.fut:115:5-118:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161668 = start_161441 + merge_sequential_arg2_161631;
                            double head_res_161669 = ((double *) mem_param_171356.mem)[slice_161668];
                            int64_t head_res_161670 = ((int64_t *) mem_param_171359.mem)[slice_161668];
                            
                            dummy_161660 = head_res_161669;
                            dummy_161661 = head_res_161670;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161254; nest_i_171998++) {
                            ((double *) mem_171392)[i_171029 * merge_block_sizze_161254 + nest_i_171998] = dummy_161660;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161254; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + nest_i_171999] = dummy_161661;
                        }
                        
                        int64_t data_161673;
                        int64_t i_161677 = (int64_t) 0;
                        
                        for (int64_t k_161676 = 0; k_161676 < merge_block_sizze_161254; k_161676++) {
                            int64_t j_161680 = sub64(k_161676, i_161677);
                            bool cond_161681 = j_161680 == j_m_i_161633;
                            bool cond_161682;
                            
                            if (cond_161681) {
                                cond_161682 = 1;
                            } else {
                                bool cond_161683 = slt64(i_161677, j_m_i_161646);
                                bool cond_f_res_161684;
                                
                                if (cond_161683) {
                                    bool x_162088 = sle64((int64_t) 0, j_161680);
                                    bool y_162089 = slt64(j_161680, j_m_i_161633);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:118:32-36\n   #11 ftRelational.fut:115:5-118:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161677);
                                    bool bounds_check_162096 = cond_161683 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:118:32-36\n   #11 ftRelational.fut:115:5-118:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161631 + j_161680;
                                    int64_t slice_162093 = start_161441 + slice_162092;
                                    double leq_arg1_162094 = ((double *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161622 + i_161677;
                                    int64_t slice_162099 = start_161441 + slice_162098;
                                    double leq_arg0_162100 = ((double *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = leq_arg0_162100 <= leq_arg1_162094;
                                    
                                    cond_f_res_161684 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161684 = 0;
                                }
                                cond_161682 = cond_f_res_161684;
                            }
                            
                            int64_t loopres_161699;
                            double loopres_161700;
                            int64_t loopres_161701;
                            
                            if (cond_161682) {
                                bool x_162103 = sle64((int64_t) 0, i_161677);
                                bool y_162104 = slt64(i_161677, j_m_i_161646);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:118:32-36\n   #11 ftRelational.fut:115:5-118:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161677);
                                int64_t slice_162107 = defunc_0_f_res_161622 + i_161677;
                                int64_t slice_162108 = start_161441 + slice_162107;
                                double tmp_162109 = ((double *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161699 = tmp_162102;
                                loopres_161700 = tmp_162109;
                                loopres_161701 = tmp_162110;
                            } else {
                                bool x_161711 = sle64((int64_t) 0, j_161680);
                                bool y_161712 = slt64(j_161680, j_m_i_161633);
                                bool bounds_check_161713 = x_161711 && y_161712;
                                bool index_certs_161714;
                                
                                if (!bounds_check_161713) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:118:32-36\n   #11 ftRelational.fut:115:5-118:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161715 = merge_sequential_arg2_161631 + j_161680;
                                int64_t slice_161716 = start_161441 + slice_161715;
                                double tmp_161717 = ((double *) mem_param_171356.mem)[slice_161716];
                                int64_t tmp_161718 = ((int64_t *) mem_param_171359.mem)[slice_161716];
                                
                                loopres_161699 = i_161677;
                                loopres_161700 = tmp_161717;
                                loopres_161701 = tmp_161718;
                            }
                            ((double *) mem_171392)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161700;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161701;
                            
                            int64_t i_tmp_172000 = loopres_161699;
                            
                            i_161677 = i_tmp_172000;
                        }
                        data_161673 = i_161677;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171391, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161725 = next_stride_161369 * num_merges_161373;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            if (memblock_alloc(ctx, &mem_171472, bytes_171361, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            
            bool loop_cond_161728 = slt64(next_stride_161369, flat_dim_161250);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161725;
            bool loop_while_tmp_171977 = loop_cond_161728;
            int64_t stride_tmp_171980 = next_stride_161369;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161364 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161365 = loop_while_tmp_171977;
            stride_161368 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161359 = loop_dz2084Uz2082U_161364;
        data_161360 = loop_while_161365;
        data_161363 = stride_161368;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161729 = n_98299 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161730 = sle64((int64_t) 0, zs_lhs_161234);
        bool i_p_m_t_s_leq_w_161731 = slt64(zs_lhs_161234, data_161359);
        bool y_161732 = zzero_leq_i_p_m_t_s_161730 && i_p_m_t_s_leq_w_161731;
        bool ok_or_empty_161733 = empty_slice_161729 || y_161732;
        bool index_certs_161734;
        
        if (!ok_or_empty_161733) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_98299, "] out of bounds for array of shape [", (long long) data_161359, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:118:32-36\n   #6  ftRelational.fut:115:5-118:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_98299; i_171043++) {
        int64_t eta_p_161742 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161743 = sle64((int64_t) 0, eta_p_161742);
        bool y_161744 = slt64(eta_p_161742, n_98299);
        bool bounds_check_161745 = x_161743 && y_161744;
        bool index_certs_161746;
        
        if (!bounds_check_161745) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161742, "] out of bounds for array of shape [", (long long) n_98299, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:118:32-36\n   #5  ftRelational.fut:115:5-118:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double lifted_lambda_res_161747 = ((double *) k_mem_171274.mem)[eta_p_161742];
        
        ((double *) mem_171484.mem)[i_171043] = lifted_lambda_res_161747;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171486.mem, i_171043 * b_98300, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171275.mem, eta_p_161742 * b_98300, (int64_t []) {(int64_t) 1}, (int64_t []) {b_98300});
    }
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172402, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172403, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_172414, struct memblock *mem_out_p_172415, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_95934, int64_t b_95935)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172416 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172417 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172418 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172419 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172420 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172421 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172422 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172423 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172424 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172425 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_95934;
    bool cond_161233 = sle64(n_95934, (int64_t) 1);
    int64_t zs_lhs_161234 = sub64(n_95934, (int64_t) 1);
    int64_t zp_rhs_161235 = sdiv_safe64(zs_lhs_161234, (int64_t) 20);
    int64_t min_num_blocks_161236 = add64((int64_t) 1, zp_rhs_161235);
    bool loop_cond_161237 = slt64((int64_t) 1, min_num_blocks_161236);
    bool smallest_pow_2_geq_than_res_161238;
    int64_t smallest_pow_2_geq_than_res_161239;
    bool loop_while_161240;
    int64_t x_161241;
    
    loop_while_161240 = loop_cond_161237;
    x_161241 = (int64_t) 1;
    while (loop_while_161240) {
        int64_t loopres_161242 = mul64((int64_t) 2, x_161241);
        bool loop_cond_161243 = slt64(loopres_161242, min_num_blocks_161236);
        bool loop_while_tmp_171958 = loop_cond_161243;
        int64_t x_tmp_171959 = loopres_161242;
        
        loop_while_161240 = loop_while_tmp_171958;
        x_161241 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161238 = loop_while_161240;
    smallest_pow_2_geq_than_res_161239 = x_161241;
    
    bool zzero_161244 = smallest_pow_2_geq_than_res_161239 == (int64_t) 0;
    bool nonzzero_161245 = !zzero_161244;
    bool protect_assert_disj_161246 = cond_161233 || nonzzero_161245;
    bool nonzzero_cert_161247;
    
    if (!protect_assert_disj_161246) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:114:32-36\n   #5  ftRelational.fut:111:5-114:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161248 = sdiv_safe64(zs_lhs_161234, smallest_pow_2_geq_than_res_161239);
    int64_t block_sizze_161249 = add64((int64_t) 1, zp_rhs_161248);
    bool y_161255 = slt64((int64_t) 0, n_95934);
    bool protect_assert_disj_171871 = cond_161233 || y_161255;
    bool index_certs_161256;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_95934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:114:32-36\n   #5  ftRelational.fut:111:5-114:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161270 = slt64(smallest_pow_2_geq_than_res_161239, (int64_t) 0);
    bool valid_161271 = !bounds_invalid_upwards_161270;
    bool protect_assert_disj_171879 = cond_161233 || valid_161271;
    bool range_valid_c_161272;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:114:32-36\n   #6  ftRelational.fut:111:5-114:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161274 = slt64(block_sizze_161249, (int64_t) 0);
    bool valid_161275 = !bounds_invalid_upwards_161274;
    bool protect_assert_disj_171881 = cond_161233 || valid_161275;
    bool range_valid_c_161276;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161249, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161278 = sle64(block_sizze_161249, (int64_t) 1);
    int64_t tmp_161279 = sub64(block_sizze_161249, (int64_t) 2);
    bool bounds_invalid_upwards_161280 = slt64(tmp_161279, (int64_t) 0);
    bool valid_161282 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_161283 = cond_161278 || valid_161282;
    bool protect_assert_disj_171883 = cond_161233 || protect_assert_disj_161283;
    bool range_valid_c_161284;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161279, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171483 = (int64_t) 4 * n_95934;
    int64_t bytes_171485 = n_95934 * b_95935;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_95934; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161250 = smallest_pow_2_geq_than_res_161239 * block_sizze_161249;
    bool x_171866 = !cond_161233;
    int64_t greatest_divisor_leq_than_arg1_161253 = mul64((int64_t) 2, block_sizze_161249);
    int64_t merge_block_sizze_161254;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161253) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161254 = x_171868;
    } else {
        merge_block_sizze_161254 = (int64_t) 0;
    }
    
    float reduce_arg1_161257;
    
    if (x_171866) {
        float x_171872 = ((float *) k_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161257 = x_171872;
    } else {
        reduce_arg1_161257 = 0.0F;
    }
    
    float defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        float x_171874;
        int64_t x_171875;
        float redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161257;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_95934; i_171003++) {
            float x_161261 = ((float *) k_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161267 = redout_171001 <= x_161261;
            float defunc_0_op_res_161268;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161268 = x_161261;
            } else {
                defunc_0_op_res_161268 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161269;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161269 = i_171003;
            } else {
                defunc_0_op_res_161269 = redout_171002;
            }
            
            float redout_tmp_171962 = defunc_0_op_res_161268;
            int64_t redout_tmp_171963 = defunc_0_op_res_161269;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = 0.0F;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161281 = add64((int64_t) 1, tmp_161279);
    int64_t binop_x_171278 = (int64_t) 4 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171279 = block_sizze_161249 * binop_x_171278;
    int64_t binop_x_171281 = (int64_t) 8 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171282 = block_sizze_161249 * binop_x_171281;
    int64_t bytes_171292 = (int64_t) 4 * block_sizze_161249;
    int64_t bytes_171294 = (int64_t) 8 * block_sizze_161249;
    bool loop_cond_161356 = slt64(block_sizze_161249, flat_dim_161250);
    bool zzero_161357 = merge_block_sizze_161254 == (int64_t) 0;
    bool nonzzero_161358 = !zzero_161357;
    
    if (cond_161233) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172416 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172416, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172417 < bytes_171282) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172417, bytes_171282);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172418 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172418, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172419 < bytes_171294) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172419, bytes_171294);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161239; i_171015++) {
            int64_t zp_lhs_161288 = mul64(block_sizze_161249, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161249; i_171008++) {
                int64_t k_161292 = add64(zp_lhs_161288, i_171008);
                bool cond_161293 = slt64(k_161292, n_95934);
                float lifted_lambda_res_161294;
                int64_t lifted_lambda_res_161295;
                
                if (cond_161293) {
                    bool x_161970 = sle64((int64_t) 0, k_161292);
                    bool bounds_check_161971 = cond_161293 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161292, "] out of bounds for array of shape [", (long long) n_95934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_161973 = ((float *) k_mem_171274.mem)[k_161292];
                    
                    lifted_lambda_res_161294 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161295 = k_161292;
                } else {
                    lifted_lambda_res_161294 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161295 = defunc_0_reduce_res_162118;
                }
                ((float *) mem_171293)[i_171008] = lifted_lambda_res_161294;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161295;
            }
            if (!cond_161278) {
                for (int64_t i_161305 = 0; i_161305 < distance_161281; i_161305++) {
                    int64_t gt_arg1_161308 = add64((int64_t) 1, i_161305);
                    bool x_161309 = sle64((int64_t) 0, gt_arg1_161308);
                    bool y_161310 = slt64(gt_arg1_161308, block_sizze_161249);
                    bool bounds_check_161311 = x_161309 && y_161310;
                    bool index_certs_161312;
                    
                    if (!bounds_check_161311) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161308, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161314 = slt64(i_161305, block_sizze_161249);
                    bool index_certs_161315;
                    
                    if (!y_161314) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161305, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_161313 = ((float *) mem_171293)[gt_arg1_161308];
                    float gt_arg0_161316 = ((float *) mem_171293)[i_161305];
                    bool defunc_0_leq_res_161317 = gt_arg0_161316 <= gt_arg1_161313;
                    bool defunc_0_lifted_gt_res_161318 = !defunc_0_leq_res_161317;
                    bool s_161319;
                    int64_t s_161322;
                    bool loop_while_161323;
                    int64_t j_161326;
                    
                    loop_while_161323 = defunc_0_lifted_gt_res_161318;
                    j_161326 = i_161305;
                    while (loop_while_161323) {
                        bool x_161327 = sle64((int64_t) 0, j_161326);
                        bool y_161328 = slt64(j_161326, block_sizze_161249);
                        bool bounds_check_161329 = x_161327 && y_161328;
                        bool index_certs_161330;
                        
                        if (!bounds_check_161329) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161326, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161333 = add64((int64_t) 1, j_161326);
                        bool x_161334 = sle64((int64_t) 0, copy_arg0_161333);
                        bool y_161335 = slt64(copy_arg0_161333, block_sizze_161249);
                        bool bounds_check_161336 = x_161334 && y_161335;
                        bool index_certs_161337;
                        
                        if (!bounds_check_161336) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161333, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_161331 = ((float *) mem_171293)[j_161326];
                        int64_t copy_arg0_161332 = ((int64_t *) mem_171295)[j_161326];
                        float copy_arg0_161338 = ((float *) mem_171293)[copy_arg0_161333];
                        int64_t copy_arg0_161339 = ((int64_t *) mem_171295)[copy_arg0_161333];
                        
                        ((float *) mem_171293)[j_161326] = copy_arg0_161338;
                        ((int64_t *) mem_171295)[j_161326] = copy_arg0_161339;
                        ((float *) mem_171293)[copy_arg0_161333] = copy_arg0_161331;
                        ((int64_t *) mem_171295)[copy_arg0_161333] = copy_arg0_161332;
                        
                        int64_t tmp_161344 = sub64(j_161326, (int64_t) 1);
                        bool cond_161345 = sle64((int64_t) 0, tmp_161344);
                        bool loop_cond_161346;
                        
                        if (cond_161345) {
                            bool y_161975 = slt64(tmp_161344, block_sizze_161249);
                            bool bounds_check_161976 = cond_161345 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161344, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_161974 = ((float *) mem_171293)[j_161326];
                            float gt_arg0_161978 = ((float *) mem_171293)[tmp_161344];
                            bool defunc_0_leq_res_161979 = gt_arg0_161978 <= gt_arg1_161974;
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161346 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161346 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161346;
                        int64_t j_tmp_171973 = tmp_161344;
                        
                        loop_while_161323 = loop_while_tmp_171970;
                        j_161326 = j_tmp_171973;
                    }
                    s_161319 = loop_while_161323;
                    s_161322 = j_161326;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171280, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint32_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        if (memblock_alloc(ctx, &mem_171352, bytes_171282, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        
        int64_t data_161359;
        bool data_161360;
        int64_t data_161363;
        int64_t loop_dz2084Uz2082U_161364;
        bool loop_while_161365;
        int64_t stride_161368;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161364 = flat_dim_161250;
        loop_while_161365 = loop_cond_161356;
        stride_161368 = block_sizze_161249;
        while (loop_while_161365) {
            int64_t next_stride_161369 = mul64((int64_t) 2, stride_161368);
            bool zzero_161370 = next_stride_161369 == (int64_t) 0;
            bool nonzzero_161371 = !zzero_161370;
            bool nonzzero_cert_161372;
            
            if (!nonzzero_161371) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:114:32-36\n   #5  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161373 = sdiv64(flat_dim_161250, next_stride_161369);
            bool bounds_invalid_upwards_161374 = slt64(num_merges_161373, (int64_t) 0);
            bool valid_161375 = !bounds_invalid_upwards_161374;
            bool range_valid_c_161376;
            
            if (!valid_161375) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161373, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:114:32-36\n   #6  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161378 = sub64(next_stride_161369, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161379 = sle64((int64_t) 0, m_161378);
            bool cond_161381 = slt64(next_stride_161369, (int64_t) 10);
            bool protect_assert_disj_161382 = nonzzero_161358 || cond_161381;
            bool nonzzero_cert_161383;
            
            if (!protect_assert_disj_161382) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161384 = smod_safe64(next_stride_161369, merge_block_sizze_161254);
            bool num_blocks_161385 = zeze_lhs_161384 == (int64_t) 0;
            bool protect_assert_disj_161386 = cond_161381 || num_blocks_161385;
            bool assert_c_161387;
            
            if (!protect_assert_disj_161386) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161389 = sdiv_safe64(next_stride_161369, merge_block_sizze_161254);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390 = add64((int64_t) 1, num_blocks_161389);
            int64_t j_m_i_161391 = sub64(next_stride_161369, stride_161368);
            int64_t flat_dim_161392 = merge_block_sizze_161254 * num_blocks_161389;
            bool bounds_invalid_upwards_161393 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, (int64_t) 0);
            bool empty_slice_161394 = j_m_i_161391 == (int64_t) 0;
            int64_t m_161395 = sub64(j_m_i_161391, (int64_t) 1);
            bool zzero_lte_i_161396 = sle64((int64_t) 0, stride_161368);
            bool i_lte_j_161397 = sle64(stride_161368, next_stride_161369);
            bool empty_slice_161398 = stride_161368 == (int64_t) 0;
            int64_t m_161399 = sub64(stride_161368, (int64_t) 1);
            bool bounds_invalid_upwards_161400 = slt64(num_blocks_161389, (int64_t) 0);
            bool cond_161401 = slt64((int64_t) 0, stride_161368);
            bool valid_161402 = !bounds_invalid_upwards_161393;
            int64_t i_p_m_t_s_161403 = add64(stride_161368, m_161395);
            bool zzero_leq_i_p_m_t_s_161404 = sle64((int64_t) 0, m_161399);
            bool i_p_m_t_s_leq_w_161405 = slt64(m_161399, next_stride_161369);
            bool valid_161406 = !bounds_invalid_upwards_161400;
            bool i_p_m_t_s_leq_w_161407 = slt64(m_161378, flat_dim_161392);
            bool y_161408 = slt64((int64_t) 0, j_m_i_161391);
            bool protect_assert_disj_161409 = cond_161381 || valid_161402;
            bool range_valid_c_161410;
            
            if (!protect_assert_disj_161409) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:114:32-36\n   #10 ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161411 = sle64((int64_t) 0, i_p_m_t_s_161403);
            bool i_p_m_t_s_leq_w_161412 = slt64(i_p_m_t_s_161403, next_stride_161369);
            bool y_161413 = zzero_leq_i_p_m_t_s_161404 && i_p_m_t_s_leq_w_161405;
            bool protect_assert_disj_161414 = cond_161381 || valid_161406;
            bool range_valid_c_161415;
            
            if (!protect_assert_disj_161414) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161389, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161416 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161407;
            bool y_161417 = zzero_lte_i_161396 && i_p_m_t_s_leq_w_161412;
            bool forwards_ok_161418 = zzero_lte_i_161396 && y_161413;
            bool ok_or_empty_161419 = zzero_161370 || y_161416;
            bool protect_assert_disj_161420 = cond_161401 || y_161408;
            bool y_161421 = zzero_leq_i_p_m_t_s_161411 && y_161417;
            bool ok_or_empty_161422 = empty_slice_161398 || forwards_ok_161418;
            bool protect_assert_disj_161423 = cond_161381 || ok_or_empty_161419;
            bool index_certs_161424;
            
            if (!protect_assert_disj_161423) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) flat_dim_161392, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161425 = !cond_161381;
            bool protect_assert_disj_161426 = protect_assert_disj_161420 || loop_not_taken_161425;
            bool index_certs_161427;
            
            if (!protect_assert_disj_161426) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:114:32-36\n   #10 ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161428 = i_lte_j_161397 && y_161421;
            bool protect_assert_disj_161429 = cond_161381 || ok_or_empty_161422;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:114:32-36\n   #11 ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161431 = ok_or_empty_161422 || loop_not_taken_161425;
            bool index_certs_161432;
            
            if (!protect_assert_disj_161431) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161433 = empty_slice_161394 || forwards_ok_161428;
            bool protect_assert_disj_161434 = cond_161381 || ok_or_empty_161433;
            bool index_certs_161435;
            
            if (!protect_assert_disj_161434) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:114:32-36\n   #11 ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161436 = loop_not_taken_161425 || ok_or_empty_161433;
            bool index_certs_161437;
            
            if (!protect_assert_disj_161436) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 4 * num_merges_161373;
            int64_t bytes_171361 = next_stride_161369 * binop_x_171360;
            int64_t binop_x_171363 = (int64_t) 8 * num_merges_161373;
            int64_t bytes_171364 = next_stride_161369 * binop_x_171363;
            bool i_lte_j_161380 = sle64((int64_t) 0, next_stride_161369);
            
            if (mem_171362_cached_sizze_172420 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172420, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172421 < bytes_171364) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172421, bytes_171364);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390;
            int64_t binop_x_171390 = (int64_t) 4 * num_blocks_161389;
            int64_t bytes_171391 = merge_block_sizze_161254 * binop_x_171390;
            int64_t binop_x_171393 = (int64_t) 8 * num_blocks_161389;
            int64_t bytes_171394 = merge_block_sizze_161254 * binop_x_171393;
            int64_t bytes_171436 = (int64_t) 8 * stride_161368;
            int64_t bytes_171438 = (int64_t) 16 * stride_161368;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161373; i_171036++) {
                int64_t start_161441 = mul64(next_stride_161369, i_171036);
                int64_t j_m_i_161442 = sub64(loop_dz2084Uz2082U_161364, start_161441);
                bool empty_slice_161443 = j_m_i_161442 == (int64_t) 0;
                int64_t m_161444 = sub64(j_m_i_161442, (int64_t) 1);
                int64_t i_p_m_t_s_161445 = add64(start_161441, m_161444);
                bool zzero_leq_i_p_m_t_s_161446 = sle64((int64_t) 0, i_p_m_t_s_161445);
                bool i_p_m_t_s_leq_w_161447 = slt64(i_p_m_t_s_161445, loop_dz2084Uz2082U_161364);
                bool zzero_lte_i_161448 = sle64((int64_t) 0, start_161441);
                bool i_lte_j_161449 = sle64(start_161441, loop_dz2084Uz2082U_161364);
                bool y_161450 = i_p_m_t_s_leq_w_161447 && zzero_lte_i_161448;
                bool y_161451 = zzero_leq_i_p_m_t_s_161446 && y_161450;
                bool forwards_ok_161452 = i_lte_j_161449 && y_161451;
                bool ok_or_empty_161453 = empty_slice_161443 || forwards_ok_161452;
                bool index_certs_161454;
                
                if (!ok_or_empty_161453) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161441, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161364, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161455 = slt64(m_161378, j_m_i_161442);
                bool y_161456 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161455;
                bool forwards_ok_161457 = i_lte_j_161380 && y_161456;
                bool ok_or_empty_161458 = zzero_161370 || forwards_ok_161457;
                bool index_certs_161459;
                
                if (!ok_or_empty_161458) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) j_m_i_161442, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:114:32-36\n   #8  ftRelational.fut:111:5-114:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161381) {
                    float dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161401) {
                        float head_res_162008 = ((float *) mem_param_171356.mem)[start_161441];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161441];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161368 + start_161441;
                        float head_res_162011 = ((float *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161369; nest_i_171983++) {
                        ((float *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171438, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161369; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161369; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161391;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161368);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161391);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161368 + j_162022;
                                int64_t slice_162032 = start_161441 + slice_162031;
                                float leq_arg1_162033 = ((float *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161441 + i_162019;
                                float leq_arg0_162038 = ((float *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = leq_arg0_162038 <= leq_arg1_162033;
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        float loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161368);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161441 + i_162019;
                            float tmp_162049 = ((float *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161391);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:114:32-36\n   #9  ftRelational.fut:111:5-114:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161368 + j_162022;
                            int64_t slice_162056 = start_161441 + slice_162055;
                            float tmp_162057 = ((float *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((float *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172422 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172422, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172423 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172423, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390; i_171022++) {
                        int64_t split_count_arg3_161521 = mul64(merge_block_sizze_161254, i_171022);
                        int64_t defunc_0_split_count_res_161522;
                        int64_t defunc_0_split_count_res_161523;
                        int64_t defunc_0_split_count_res_161524;
                        int64_t defunc_0_split_count_res_161525;
                        int64_t defunc_0_split_count_res_161526;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161522, &defunc_0_split_count_res_161523, &defunc_0_split_count_res_161524, &defunc_0_split_count_res_161525, &defunc_0_split_count_res_161526, (int64_t) 0, stride_161368, (int64_t) 0, j_m_i_161391, split_count_arg3_161521) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161527 = slt64((int64_t) 0, defunc_0_split_count_res_161526);
                        bool defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        int64_t defunc_0_split_count_res_161533;
                        bool loop_while_161534;
                        int64_t ss_161535;
                        int64_t ss_161536;
                        int64_t tt_161537;
                        int64_t tt_161538;
                        int64_t count_161539;
                        
                        loop_while_161534 = loop_cond_161527;
                        ss_161535 = defunc_0_split_count_res_161522;
                        ss_161536 = defunc_0_split_count_res_161523;
                        tt_161537 = defunc_0_split_count_res_161524;
                        tt_161538 = defunc_0_split_count_res_161525;
                        count_161539 = defunc_0_split_count_res_161526;
                        while (loop_while_161534) {
                            int64_t zlze_lhs_161540 = sub64(ss_161536, ss_161535);
                            bool cond_161541 = sle64(zlze_lhs_161540, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161542;
                            int64_t defunc_0_lifted_step_res_161543;
                            int64_t defunc_0_lifted_step_res_161544;
                            int64_t defunc_0_lifted_step_res_161545;
                            
                            if (cond_161541) {
                                int64_t tmp_162061 = add64(tt_161537, count_161539);
                                
                                defunc_0_lifted_step_res_161542 = ss_161535;
                                defunc_0_lifted_step_res_161543 = tmp_162061;
                                defunc_0_lifted_step_res_161544 = tt_161538;
                                defunc_0_lifted_step_res_161545 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161547 = sub64(tt_161538, tt_161537);
                                bool cond_161548 = sle64(zlze_lhs_161547, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161549;
                                int64_t defunc_0_lifted_step_res_f_res_161550;
                                int64_t defunc_0_lifted_step_res_f_res_161551;
                                int64_t defunc_0_lifted_step_res_f_res_161552;
                                
                                if (cond_161548) {
                                    int64_t tmp_162062 = add64(ss_161535, count_161539);
                                    
                                    defunc_0_lifted_step_res_f_res_161549 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161550 = tt_161537;
                                    defunc_0_lifted_step_res_f_res_161551 = tt_161538;
                                    defunc_0_lifted_step_res_f_res_161552 = (int64_t) 0;
                                } else {
                                    bool cond_161554 = count_161539 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161555;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161556;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161557;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161558;
                                    
                                    if (cond_161554) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161535);
                                        bool y_162065 = slt64(ss_161535, stride_161368);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161535, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:114:32-36\n   #13 ftRelational.fut:111:5-114:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161537);
                                        bool y_162071 = slt64(tt_161537, j_m_i_161391);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161537, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:114:32-36\n   #13 ftRelational.fut:111:5-114:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161441 + ss_161535;
                                        float leq_arg1_162069 = ((float *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161368 + tt_161537;
                                        int64_t slice_162075 = start_161441 + slice_162074;
                                        float leq_arg0_162076 = ((float *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = leq_arg0_162076 <= leq_arg1_162069;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161537);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161535;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161535);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161537;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = tt_161538;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = (int64_t) 0;
                                    } else {
                                        int64_t m_161577 = sdiv64(count_161539, (int64_t) 2);
                                        int64_t n_161578 = sub64(count_161539, m_161577);
                                        bool cond_161579 = n_161578 == (int64_t) 0;
                                        int64_t zgze_lhs_161580 = add64(ss_161535, m_161577);
                                        bool cond_f_res_161581 = sle64(ss_161536, zgze_lhs_161580);
                                        bool x_161582 = !cond_161579;
                                        bool y_161583 = cond_f_res_161581 && x_161582;
                                        bool cond_161584 = cond_161579 || y_161583;
                                        bool leq_y_x_161585;
                                        
                                        if (cond_161584) {
                                            leq_y_x_161585 = 1;
                                        } else {
                                            bool x_161586 = sle64((int64_t) 0, zgze_lhs_161580);
                                            bool y_161587 = slt64(zgze_lhs_161580, stride_161368);
                                            bool bounds_check_161588 = x_161586 && y_161587;
                                            bool index_certs_161589;
                                            
                                            if (!bounds_check_161588) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161580, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:114:32-36\n   #13 ftRelational.fut:111:5-114:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161592 = add64(tt_161537, n_161578);
                                            int64_t leq_arg0_161593 = sub64(zm_lhs_161592, (int64_t) 1);
                                            bool x_161594 = sle64((int64_t) 0, leq_arg0_161593);
                                            bool y_161595 = slt64(leq_arg0_161593, j_m_i_161391);
                                            bool bounds_check_161596 = x_161594 && y_161595;
                                            bool index_certs_161597;
                                            
                                            if (!bounds_check_161596) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161593, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:114:32-36\n   #13 ftRelational.fut:111:5-114:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161590 = start_161441 + zgze_lhs_161580;
                                            float leq_arg1_161591 = ((float *) mem_param_171356.mem)[slice_161590];
                                            int64_t slice_161598 = stride_161368 + leq_arg0_161593;
                                            int64_t slice_161599 = start_161441 + slice_161598;
                                            float leq_arg0_161600 = ((float *) mem_param_171356.mem)[slice_161599];
                                            bool defunc_0_leq_res_161601 = leq_arg0_161600 <= leq_arg1_161591;
                                            
                                            leq_y_x_161585 = defunc_0_leq_res_161601;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                        
                                        if (leq_y_x_161585) {
                                            int64_t tmp_162082 = add64(tt_161537, n_161578);
                                            int64_t tmp_162083 = sub64(count_161539, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tt_161538;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = tmp_162083;
                                        } else {
                                            int64_t tmp_161607 = add64(tt_161537, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tt_161537;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tmp_161607;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = count_161539;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = ss_161535;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                    }
                                    defunc_0_lifted_step_res_f_res_161549 = defunc_0_lifted_step_res_f_res_f_res_161555;
                                    defunc_0_lifted_step_res_f_res_161550 = defunc_0_lifted_step_res_f_res_f_res_161556;
                                    defunc_0_lifted_step_res_f_res_161551 = defunc_0_lifted_step_res_f_res_f_res_161557;
                                    defunc_0_lifted_step_res_f_res_161552 = defunc_0_lifted_step_res_f_res_f_res_161558;
                                }
                                defunc_0_lifted_step_res_161542 = defunc_0_lifted_step_res_f_res_161549;
                                defunc_0_lifted_step_res_161543 = defunc_0_lifted_step_res_f_res_161550;
                                defunc_0_lifted_step_res_161544 = defunc_0_lifted_step_res_f_res_161551;
                                defunc_0_lifted_step_res_161545 = defunc_0_lifted_step_res_f_res_161552;
                            }
                            
                            int64_t loopres_161608;
                            int64_t loopres_161609;
                            int64_t loopres_161610;
                            int64_t loopres_161611;
                            int64_t loopres_161612;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161608, &loopres_161609, &loopres_161610, &loopres_161611, &loopres_161612, defunc_0_lifted_step_res_161542, ss_161536, defunc_0_lifted_step_res_161543, defunc_0_lifted_step_res_161544, defunc_0_lifted_step_res_161545) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161613 = slt64((int64_t) 0, loopres_161612);
                            bool loop_while_tmp_171990 = loop_cond_161613;
                            int64_t ss_tmp_171991 = loopres_161608;
                            int64_t ss_tmp_171992 = loopres_161609;
                            int64_t tt_tmp_171993 = loopres_161610;
                            int64_t tt_tmp_171994 = loopres_161611;
                            int64_t count_tmp_171995 = loopres_161612;
                            
                            loop_while_161534 = loop_while_tmp_171990;
                            ss_161535 = ss_tmp_171991;
                            ss_161536 = ss_tmp_171992;
                            tt_161537 = tt_tmp_171993;
                            tt_161538 = tt_tmp_171994;
                            count_161539 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161528 = loop_while_161534;
                        defunc_0_split_count_res_161529 = ss_161535;
                        defunc_0_split_count_res_161530 = ss_161536;
                        defunc_0_split_count_res_161531 = tt_161537;
                        defunc_0_split_count_res_161532 = tt_161538;
                        defunc_0_split_count_res_161533 = count_161539;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161529;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161531;
                    }
                    if (mem_171392_cached_sizze_172424 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172424, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172425 < bytes_171394) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172425, bytes_171394);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161389; i_171029++) {
                        bool y_161619 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool index_certs_161621;
                        
                        if (!y_161619) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:114:32-36\n   #10 ftRelational.fut:111:5-114:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161622 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161623 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161624 = add64((int64_t) 1, i_171029);
                        bool x_161625 = sle64((int64_t) 0, tmp_161624);
                        bool y_161626 = slt64(tmp_161624, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool bounds_check_161627 = x_161625 && y_161626;
                        bool index_certs_161628;
                        
                        if (!bounds_check_161627) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161624, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:114:32-36\n   #10 ftRelational.fut:111:5-114:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171375)[tmp_161624];
                        int64_t defunc_0_f_res_161630 = ((int64_t *) mem_171377)[tmp_161624];
                        int64_t merge_sequential_arg2_161631 = add64(stride_161368, defunc_0_f_res_161623);
                        int64_t merge_sequential_arg2_161632 = add64(stride_161368, defunc_0_f_res_161630);
                        int64_t j_m_i_161633 = sub64(merge_sequential_arg2_161632, merge_sequential_arg2_161631);
                        bool empty_slice_161634 = j_m_i_161633 == (int64_t) 0;
                        int64_t m_161635 = sub64(j_m_i_161633, (int64_t) 1);
                        int64_t i_p_m_t_s_161636 = add64(merge_sequential_arg2_161631, m_161635);
                        bool zzero_leq_i_p_m_t_s_161637 = sle64((int64_t) 0, i_p_m_t_s_161636);
                        bool i_p_m_t_s_leq_w_161638 = slt64(i_p_m_t_s_161636, next_stride_161369);
                        bool zzero_lte_i_161639 = sle64((int64_t) 0, merge_sequential_arg2_161631);
                        bool i_lte_j_161640 = sle64(merge_sequential_arg2_161631, merge_sequential_arg2_161632);
                        bool y_161641 = i_p_m_t_s_leq_w_161638 && zzero_lte_i_161639;
                        bool y_161642 = zzero_leq_i_p_m_t_s_161637 && y_161641;
                        bool forwards_ok_161643 = i_lte_j_161640 && y_161642;
                        bool ok_or_empty_161644 = empty_slice_161634 || forwards_ok_161643;
                        bool index_certs_161645;
                        
                        if (!ok_or_empty_161644) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161631, ":", (long long) merge_sequential_arg2_161632, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:114:32-36\n   #10 ftRelational.fut:111:5-114:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161646 = sub64(defunc_0_f_res_161629, defunc_0_f_res_161622);
                        bool empty_slice_161647 = j_m_i_161646 == (int64_t) 0;
                        int64_t m_161648 = sub64(j_m_i_161646, (int64_t) 1);
                        int64_t i_p_m_t_s_161649 = add64(defunc_0_f_res_161622, m_161648);
                        bool zzero_leq_i_p_m_t_s_161650 = sle64((int64_t) 0, i_p_m_t_s_161649);
                        bool i_p_m_t_s_leq_w_161651 = slt64(i_p_m_t_s_161649, next_stride_161369);
                        bool zzero_lte_i_161652 = sle64((int64_t) 0, defunc_0_f_res_161622);
                        bool i_lte_j_161653 = sle64(defunc_0_f_res_161622, defunc_0_f_res_161629);
                        bool y_161654 = i_p_m_t_s_leq_w_161651 && zzero_lte_i_161652;
                        bool y_161655 = zzero_leq_i_p_m_t_s_161650 && y_161654;
                        bool forwards_ok_161656 = i_lte_j_161653 && y_161655;
                        bool ok_or_empty_161657 = empty_slice_161647 || forwards_ok_161656;
                        bool index_certs_161658;
                        
                        if (!ok_or_empty_161657) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161622, ":", (long long) defunc_0_f_res_161629, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:114:32-36\n   #10 ftRelational.fut:111:5-114:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161659 = slt64((int64_t) 0, j_m_i_161646);
                        float dummy_161660;
                        int64_t dummy_161661;
                        
                        if (cond_161659) {
                            bool index_certs_162084;
                            
                            if (!cond_161659) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:114:32-36\n   #12 ftRelational.fut:111:5-114:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161441 + defunc_0_f_res_161622;
                            float head_res_162086 = ((float *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161660 = head_res_162086;
                            dummy_161661 = head_res_162087;
                        } else {
                            bool y_161666 = slt64((int64_t) 0, j_m_i_161633);
                            bool index_certs_161667;
                            
                            if (!y_161666) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:114:32-36\n   #12 ftRelational.fut:111:5-114:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161668 = start_161441 + merge_sequential_arg2_161631;
                            float head_res_161669 = ((float *) mem_param_171356.mem)[slice_161668];
                            int64_t head_res_161670 = ((int64_t *) mem_param_171359.mem)[slice_161668];
                            
                            dummy_161660 = head_res_161669;
                            dummy_161661 = head_res_161670;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161254; nest_i_171998++) {
                            ((float *) mem_171392)[i_171029 * merge_block_sizze_161254 + nest_i_171998] = dummy_161660;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161254; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + nest_i_171999] = dummy_161661;
                        }
                        
                        int64_t data_161673;
                        int64_t i_161677 = (int64_t) 0;
                        
                        for (int64_t k_161676 = 0; k_161676 < merge_block_sizze_161254; k_161676++) {
                            int64_t j_161680 = sub64(k_161676, i_161677);
                            bool cond_161681 = j_161680 == j_m_i_161633;
                            bool cond_161682;
                            
                            if (cond_161681) {
                                cond_161682 = 1;
                            } else {
                                bool cond_161683 = slt64(i_161677, j_m_i_161646);
                                bool cond_f_res_161684;
                                
                                if (cond_161683) {
                                    bool x_162088 = sle64((int64_t) 0, j_161680);
                                    bool y_162089 = slt64(j_161680, j_m_i_161633);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:114:32-36\n   #11 ftRelational.fut:111:5-114:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161677);
                                    bool bounds_check_162096 = cond_161683 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:114:32-36\n   #11 ftRelational.fut:111:5-114:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161631 + j_161680;
                                    int64_t slice_162093 = start_161441 + slice_162092;
                                    float leq_arg1_162094 = ((float *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161622 + i_161677;
                                    int64_t slice_162099 = start_161441 + slice_162098;
                                    float leq_arg0_162100 = ((float *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = leq_arg0_162100 <= leq_arg1_162094;
                                    
                                    cond_f_res_161684 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161684 = 0;
                                }
                                cond_161682 = cond_f_res_161684;
                            }
                            
                            int64_t loopres_161699;
                            float loopres_161700;
                            int64_t loopres_161701;
                            
                            if (cond_161682) {
                                bool x_162103 = sle64((int64_t) 0, i_161677);
                                bool y_162104 = slt64(i_161677, j_m_i_161646);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:114:32-36\n   #11 ftRelational.fut:111:5-114:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161677);
                                int64_t slice_162107 = defunc_0_f_res_161622 + i_161677;
                                int64_t slice_162108 = start_161441 + slice_162107;
                                float tmp_162109 = ((float *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161699 = tmp_162102;
                                loopres_161700 = tmp_162109;
                                loopres_161701 = tmp_162110;
                            } else {
                                bool x_161711 = sle64((int64_t) 0, j_161680);
                                bool y_161712 = slt64(j_161680, j_m_i_161633);
                                bool bounds_check_161713 = x_161711 && y_161712;
                                bool index_certs_161714;
                                
                                if (!bounds_check_161713) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:114:32-36\n   #11 ftRelational.fut:111:5-114:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161715 = merge_sequential_arg2_161631 + j_161680;
                                int64_t slice_161716 = start_161441 + slice_161715;
                                float tmp_161717 = ((float *) mem_param_171356.mem)[slice_161716];
                                int64_t tmp_161718 = ((int64_t *) mem_param_171359.mem)[slice_161716];
                                
                                loopres_161699 = i_161677;
                                loopres_161700 = tmp_161717;
                                loopres_161701 = tmp_161718;
                            }
                            ((float *) mem_171392)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161700;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161701;
                            
                            int64_t i_tmp_172000 = loopres_161699;
                            
                            i_161677 = i_tmp_172000;
                        }
                        data_161673 = i_161677;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint32_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171394, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171362, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161725 = next_stride_161369 * num_merges_161373;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint32_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            if (memblock_alloc(ctx, &mem_171472, bytes_171364, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            
            bool loop_cond_161728 = slt64(next_stride_161369, flat_dim_161250);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161725;
            bool loop_while_tmp_171977 = loop_cond_161728;
            int64_t stride_tmp_171980 = next_stride_161369;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161364 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161365 = loop_while_tmp_171977;
            stride_161368 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161359 = loop_dz2084Uz2082U_161364;
        data_161360 = loop_while_161365;
        data_161363 = stride_161368;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161729 = n_95934 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161730 = sle64((int64_t) 0, zs_lhs_161234);
        bool i_p_m_t_s_leq_w_161731 = slt64(zs_lhs_161234, data_161359);
        bool y_161732 = zzero_leq_i_p_m_t_s_161730 && i_p_m_t_s_leq_w_161731;
        bool ok_or_empty_161733 = empty_slice_161729 || y_161732;
        bool index_certs_161734;
        
        if (!ok_or_empty_161733) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_95934, "] out of bounds for array of shape [", (long long) data_161359, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:114:32-36\n   #6  ftRelational.fut:111:5-114:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171483, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_95934; i_171043++) {
        int64_t eta_p_161742 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161743 = sle64((int64_t) 0, eta_p_161742);
        bool y_161744 = slt64(eta_p_161742, n_95934);
        bool bounds_check_161745 = x_161743 && y_161744;
        bool index_certs_161746;
        
        if (!bounds_check_161745) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161742, "] out of bounds for array of shape [", (long long) n_95934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:114:32-36\n   #5  ftRelational.fut:111:5-114:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float lifted_lambda_res_161747 = ((float *) k_mem_171274.mem)[eta_p_161742];
        
        ((float *) mem_171484.mem)[i_171043] = lifted_lambda_res_161747;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171486.mem, i_171043 * b_95935, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171275.mem, eta_p_161742 * b_95935, (int64_t []) {(int64_t) 1}, (int64_t []) {b_95935});
    }
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172414, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172415, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_172426, struct memblock *mem_out_p_172427, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_91210, int64_t b_91211)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172428 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172429 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172430 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172431 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172432 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172433 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172434 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172435 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172436 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172437 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_91210;
    bool cond_161233 = sle64(n_91210, (int64_t) 1);
    int64_t zs_lhs_161234 = sub64(n_91210, (int64_t) 1);
    int64_t zp_rhs_161235 = sdiv_safe64(zs_lhs_161234, (int64_t) 20);
    int64_t min_num_blocks_161236 = add64((int64_t) 1, zp_rhs_161235);
    bool loop_cond_161237 = slt64((int64_t) 1, min_num_blocks_161236);
    bool smallest_pow_2_geq_than_res_161238;
    int64_t smallest_pow_2_geq_than_res_161239;
    bool loop_while_161240;
    int64_t x_161241;
    
    loop_while_161240 = loop_cond_161237;
    x_161241 = (int64_t) 1;
    while (loop_while_161240) {
        int64_t loopres_161242 = mul64((int64_t) 2, x_161241);
        bool loop_cond_161243 = slt64(loopres_161242, min_num_blocks_161236);
        bool loop_while_tmp_171958 = loop_cond_161243;
        int64_t x_tmp_171959 = loopres_161242;
        
        loop_while_161240 = loop_while_tmp_171958;
        x_161241 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161238 = loop_while_161240;
    smallest_pow_2_geq_than_res_161239 = x_161241;
    
    bool zzero_161244 = smallest_pow_2_geq_than_res_161239 == (int64_t) 0;
    bool nonzzero_161245 = !zzero_161244;
    bool protect_assert_disj_161246 = cond_161233 || nonzzero_161245;
    bool nonzzero_cert_161247;
    
    if (!protect_assert_disj_161246) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:106:32-36\n   #5  ftRelational.fut:103:5-106:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161248 = sdiv_safe64(zs_lhs_161234, smallest_pow_2_geq_than_res_161239);
    int64_t block_sizze_161249 = add64((int64_t) 1, zp_rhs_161248);
    bool y_161255 = slt64((int64_t) 0, n_91210);
    bool protect_assert_disj_171871 = cond_161233 || y_161255;
    bool index_certs_161256;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_91210, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:106:32-36\n   #5  ftRelational.fut:103:5-106:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161270 = slt64(smallest_pow_2_geq_than_res_161239, (int64_t) 0);
    bool valid_161271 = !bounds_invalid_upwards_161270;
    bool protect_assert_disj_171879 = cond_161233 || valid_161271;
    bool range_valid_c_161272;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:106:32-36\n   #6  ftRelational.fut:103:5-106:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161274 = slt64(block_sizze_161249, (int64_t) 0);
    bool valid_161275 = !bounds_invalid_upwards_161274;
    bool protect_assert_disj_171881 = cond_161233 || valid_161275;
    bool range_valid_c_161276;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161249, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161278 = sle64(block_sizze_161249, (int64_t) 1);
    int64_t tmp_161279 = sub64(block_sizze_161249, (int64_t) 2);
    bool bounds_invalid_upwards_161280 = slt64(tmp_161279, (int64_t) 0);
    bool valid_161282 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_161283 = cond_161278 || valid_161282;
    bool protect_assert_disj_171883 = cond_161233 || protect_assert_disj_161283;
    bool range_valid_c_161284;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161279, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171483 = (int64_t) 4 * n_91210;
    int64_t bytes_171485 = n_91210 * b_91211;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_91210; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161250 = smallest_pow_2_geq_than_res_161239 * block_sizze_161249;
    bool x_171866 = !cond_161233;
    int64_t greatest_divisor_leq_than_arg1_161253 = mul64((int64_t) 2, block_sizze_161249);
    int64_t merge_block_sizze_161254;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161253) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161254 = x_171868;
    } else {
        merge_block_sizze_161254 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_161257;
    
    if (x_171866) {
        int32_t x_171872 = ((int32_t *) k_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161257 = x_171872;
    } else {
        reduce_arg1_161257 = 0;
    }
    
    int32_t defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        int32_t x_171874;
        int64_t x_171875;
        int32_t redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161257;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_91210; i_171003++) {
            int32_t x_161261 = ((int32_t *) k_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161267 = sle32(redout_171001, x_161261);
            int32_t defunc_0_op_res_161268;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161268 = x_161261;
            } else {
                defunc_0_op_res_161268 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161269;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161269 = i_171003;
            } else {
                defunc_0_op_res_161269 = redout_171002;
            }
            
            int32_t redout_tmp_171962 = defunc_0_op_res_161268;
            int64_t redout_tmp_171963 = defunc_0_op_res_161269;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = 0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161281 = add64((int64_t) 1, tmp_161279);
    int64_t binop_x_171278 = (int64_t) 4 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171279 = block_sizze_161249 * binop_x_171278;
    int64_t binop_x_171281 = (int64_t) 8 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171282 = block_sizze_161249 * binop_x_171281;
    int64_t bytes_171292 = (int64_t) 4 * block_sizze_161249;
    int64_t bytes_171294 = (int64_t) 8 * block_sizze_161249;
    bool loop_cond_161356 = slt64(block_sizze_161249, flat_dim_161250);
    bool zzero_161357 = merge_block_sizze_161254 == (int64_t) 0;
    bool nonzzero_161358 = !zzero_161357;
    
    if (cond_161233) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172428 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172428, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172429 < bytes_171282) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172429, bytes_171282);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172430 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172430, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172431 < bytes_171294) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172431, bytes_171294);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161239; i_171015++) {
            int64_t zp_lhs_161288 = mul64(block_sizze_161249, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161249; i_171008++) {
                int64_t k_161292 = add64(zp_lhs_161288, i_171008);
                bool cond_161293 = slt64(k_161292, n_91210);
                int32_t lifted_lambda_res_161294;
                int64_t lifted_lambda_res_161295;
                
                if (cond_161293) {
                    bool x_161970 = sle64((int64_t) 0, k_161292);
                    bool bounds_check_161971 = cond_161293 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161292, "] out of bounds for array of shape [", (long long) n_91210, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_161973 = ((int32_t *) k_mem_171274.mem)[k_161292];
                    
                    lifted_lambda_res_161294 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161295 = k_161292;
                } else {
                    lifted_lambda_res_161294 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161295 = defunc_0_reduce_res_162118;
                }
                ((int32_t *) mem_171293)[i_171008] = lifted_lambda_res_161294;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161295;
            }
            if (!cond_161278) {
                for (int64_t i_161305 = 0; i_161305 < distance_161281; i_161305++) {
                    int64_t gt_arg1_161308 = add64((int64_t) 1, i_161305);
                    bool x_161309 = sle64((int64_t) 0, gt_arg1_161308);
                    bool y_161310 = slt64(gt_arg1_161308, block_sizze_161249);
                    bool bounds_check_161311 = x_161309 && y_161310;
                    bool index_certs_161312;
                    
                    if (!bounds_check_161311) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161308, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161314 = slt64(i_161305, block_sizze_161249);
                    bool index_certs_161315;
                    
                    if (!y_161314) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161305, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_161313 = ((int32_t *) mem_171293)[gt_arg1_161308];
                    int32_t gt_arg0_161316 = ((int32_t *) mem_171293)[i_161305];
                    bool defunc_0_leq_res_161317 = sle32(gt_arg0_161316, gt_arg1_161313);
                    bool defunc_0_lifted_gt_res_161318 = !defunc_0_leq_res_161317;
                    bool s_161319;
                    int64_t s_161322;
                    bool loop_while_161323;
                    int64_t j_161326;
                    
                    loop_while_161323 = defunc_0_lifted_gt_res_161318;
                    j_161326 = i_161305;
                    while (loop_while_161323) {
                        bool x_161327 = sle64((int64_t) 0, j_161326);
                        bool y_161328 = slt64(j_161326, block_sizze_161249);
                        bool bounds_check_161329 = x_161327 && y_161328;
                        bool index_certs_161330;
                        
                        if (!bounds_check_161329) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161326, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161333 = add64((int64_t) 1, j_161326);
                        bool x_161334 = sle64((int64_t) 0, copy_arg0_161333);
                        bool y_161335 = slt64(copy_arg0_161333, block_sizze_161249);
                        bool bounds_check_161336 = x_161334 && y_161335;
                        bool index_certs_161337;
                        
                        if (!bounds_check_161336) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161333, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_161331 = ((int32_t *) mem_171293)[j_161326];
                        int64_t copy_arg0_161332 = ((int64_t *) mem_171295)[j_161326];
                        int32_t copy_arg0_161338 = ((int32_t *) mem_171293)[copy_arg0_161333];
                        int64_t copy_arg0_161339 = ((int64_t *) mem_171295)[copy_arg0_161333];
                        
                        ((int32_t *) mem_171293)[j_161326] = copy_arg0_161338;
                        ((int64_t *) mem_171295)[j_161326] = copy_arg0_161339;
                        ((int32_t *) mem_171293)[copy_arg0_161333] = copy_arg0_161331;
                        ((int64_t *) mem_171295)[copy_arg0_161333] = copy_arg0_161332;
                        
                        int64_t tmp_161344 = sub64(j_161326, (int64_t) 1);
                        bool cond_161345 = sle64((int64_t) 0, tmp_161344);
                        bool loop_cond_161346;
                        
                        if (cond_161345) {
                            bool y_161975 = slt64(tmp_161344, block_sizze_161249);
                            bool bounds_check_161976 = cond_161345 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161344, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_161974 = ((int32_t *) mem_171293)[j_161326];
                            int32_t gt_arg0_161978 = ((int32_t *) mem_171293)[tmp_161344];
                            bool defunc_0_leq_res_161979 = sle32(gt_arg0_161978, gt_arg1_161974);
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161346 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161346 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161346;
                        int64_t j_tmp_171973 = tmp_161344;
                        
                        loop_while_161323 = loop_while_tmp_171970;
                        j_161326 = j_tmp_171973;
                    }
                    s_161319 = loop_while_161323;
                    s_161322 = j_161326;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171280, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint32_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        if (memblock_alloc(ctx, &mem_171352, bytes_171282, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        
        int64_t data_161359;
        bool data_161360;
        int64_t data_161363;
        int64_t loop_dz2084Uz2082U_161364;
        bool loop_while_161365;
        int64_t stride_161368;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161364 = flat_dim_161250;
        loop_while_161365 = loop_cond_161356;
        stride_161368 = block_sizze_161249;
        while (loop_while_161365) {
            int64_t next_stride_161369 = mul64((int64_t) 2, stride_161368);
            bool zzero_161370 = next_stride_161369 == (int64_t) 0;
            bool nonzzero_161371 = !zzero_161370;
            bool nonzzero_cert_161372;
            
            if (!nonzzero_161371) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:106:32-36\n   #5  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161373 = sdiv64(flat_dim_161250, next_stride_161369);
            bool bounds_invalid_upwards_161374 = slt64(num_merges_161373, (int64_t) 0);
            bool valid_161375 = !bounds_invalid_upwards_161374;
            bool range_valid_c_161376;
            
            if (!valid_161375) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161373, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:106:32-36\n   #6  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161378 = sub64(next_stride_161369, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161379 = sle64((int64_t) 0, m_161378);
            bool cond_161381 = slt64(next_stride_161369, (int64_t) 10);
            bool protect_assert_disj_161382 = nonzzero_161358 || cond_161381;
            bool nonzzero_cert_161383;
            
            if (!protect_assert_disj_161382) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161384 = smod_safe64(next_stride_161369, merge_block_sizze_161254);
            bool num_blocks_161385 = zeze_lhs_161384 == (int64_t) 0;
            bool protect_assert_disj_161386 = cond_161381 || num_blocks_161385;
            bool assert_c_161387;
            
            if (!protect_assert_disj_161386) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161389 = sdiv_safe64(next_stride_161369, merge_block_sizze_161254);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390 = add64((int64_t) 1, num_blocks_161389);
            int64_t j_m_i_161391 = sub64(next_stride_161369, stride_161368);
            int64_t flat_dim_161392 = merge_block_sizze_161254 * num_blocks_161389;
            bool bounds_invalid_upwards_161393 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, (int64_t) 0);
            bool empty_slice_161394 = j_m_i_161391 == (int64_t) 0;
            int64_t m_161395 = sub64(j_m_i_161391, (int64_t) 1);
            bool zzero_lte_i_161396 = sle64((int64_t) 0, stride_161368);
            bool i_lte_j_161397 = sle64(stride_161368, next_stride_161369);
            bool empty_slice_161398 = stride_161368 == (int64_t) 0;
            int64_t m_161399 = sub64(stride_161368, (int64_t) 1);
            bool bounds_invalid_upwards_161400 = slt64(num_blocks_161389, (int64_t) 0);
            bool cond_161401 = slt64((int64_t) 0, stride_161368);
            bool valid_161402 = !bounds_invalid_upwards_161393;
            int64_t i_p_m_t_s_161403 = add64(stride_161368, m_161395);
            bool zzero_leq_i_p_m_t_s_161404 = sle64((int64_t) 0, m_161399);
            bool i_p_m_t_s_leq_w_161405 = slt64(m_161399, next_stride_161369);
            bool valid_161406 = !bounds_invalid_upwards_161400;
            bool i_p_m_t_s_leq_w_161407 = slt64(m_161378, flat_dim_161392);
            bool y_161408 = slt64((int64_t) 0, j_m_i_161391);
            bool protect_assert_disj_161409 = cond_161381 || valid_161402;
            bool range_valid_c_161410;
            
            if (!protect_assert_disj_161409) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:106:32-36\n   #10 ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161411 = sle64((int64_t) 0, i_p_m_t_s_161403);
            bool i_p_m_t_s_leq_w_161412 = slt64(i_p_m_t_s_161403, next_stride_161369);
            bool y_161413 = zzero_leq_i_p_m_t_s_161404 && i_p_m_t_s_leq_w_161405;
            bool protect_assert_disj_161414 = cond_161381 || valid_161406;
            bool range_valid_c_161415;
            
            if (!protect_assert_disj_161414) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161389, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161416 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161407;
            bool y_161417 = zzero_lte_i_161396 && i_p_m_t_s_leq_w_161412;
            bool forwards_ok_161418 = zzero_lte_i_161396 && y_161413;
            bool ok_or_empty_161419 = zzero_161370 || y_161416;
            bool protect_assert_disj_161420 = cond_161401 || y_161408;
            bool y_161421 = zzero_leq_i_p_m_t_s_161411 && y_161417;
            bool ok_or_empty_161422 = empty_slice_161398 || forwards_ok_161418;
            bool protect_assert_disj_161423 = cond_161381 || ok_or_empty_161419;
            bool index_certs_161424;
            
            if (!protect_assert_disj_161423) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) flat_dim_161392, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161425 = !cond_161381;
            bool protect_assert_disj_161426 = protect_assert_disj_161420 || loop_not_taken_161425;
            bool index_certs_161427;
            
            if (!protect_assert_disj_161426) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:106:32-36\n   #10 ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161428 = i_lte_j_161397 && y_161421;
            bool protect_assert_disj_161429 = cond_161381 || ok_or_empty_161422;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:106:32-36\n   #11 ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161431 = ok_or_empty_161422 || loop_not_taken_161425;
            bool index_certs_161432;
            
            if (!protect_assert_disj_161431) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161433 = empty_slice_161394 || forwards_ok_161428;
            bool protect_assert_disj_161434 = cond_161381 || ok_or_empty_161433;
            bool index_certs_161435;
            
            if (!protect_assert_disj_161434) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:106:32-36\n   #11 ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161436 = loop_not_taken_161425 || ok_or_empty_161433;
            bool index_certs_161437;
            
            if (!protect_assert_disj_161436) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 4 * num_merges_161373;
            int64_t bytes_171361 = next_stride_161369 * binop_x_171360;
            int64_t binop_x_171363 = (int64_t) 8 * num_merges_161373;
            int64_t bytes_171364 = next_stride_161369 * binop_x_171363;
            bool i_lte_j_161380 = sle64((int64_t) 0, next_stride_161369);
            
            if (mem_171362_cached_sizze_172432 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172432, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172433 < bytes_171364) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172433, bytes_171364);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390;
            int64_t binop_x_171390 = (int64_t) 4 * num_blocks_161389;
            int64_t bytes_171391 = merge_block_sizze_161254 * binop_x_171390;
            int64_t binop_x_171393 = (int64_t) 8 * num_blocks_161389;
            int64_t bytes_171394 = merge_block_sizze_161254 * binop_x_171393;
            int64_t bytes_171436 = (int64_t) 8 * stride_161368;
            int64_t bytes_171438 = (int64_t) 16 * stride_161368;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161373; i_171036++) {
                int64_t start_161441 = mul64(next_stride_161369, i_171036);
                int64_t j_m_i_161442 = sub64(loop_dz2084Uz2082U_161364, start_161441);
                bool empty_slice_161443 = j_m_i_161442 == (int64_t) 0;
                int64_t m_161444 = sub64(j_m_i_161442, (int64_t) 1);
                int64_t i_p_m_t_s_161445 = add64(start_161441, m_161444);
                bool zzero_leq_i_p_m_t_s_161446 = sle64((int64_t) 0, i_p_m_t_s_161445);
                bool i_p_m_t_s_leq_w_161447 = slt64(i_p_m_t_s_161445, loop_dz2084Uz2082U_161364);
                bool zzero_lte_i_161448 = sle64((int64_t) 0, start_161441);
                bool i_lte_j_161449 = sle64(start_161441, loop_dz2084Uz2082U_161364);
                bool y_161450 = i_p_m_t_s_leq_w_161447 && zzero_lte_i_161448;
                bool y_161451 = zzero_leq_i_p_m_t_s_161446 && y_161450;
                bool forwards_ok_161452 = i_lte_j_161449 && y_161451;
                bool ok_or_empty_161453 = empty_slice_161443 || forwards_ok_161452;
                bool index_certs_161454;
                
                if (!ok_or_empty_161453) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161441, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161364, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161455 = slt64(m_161378, j_m_i_161442);
                bool y_161456 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161455;
                bool forwards_ok_161457 = i_lte_j_161380 && y_161456;
                bool ok_or_empty_161458 = zzero_161370 || forwards_ok_161457;
                bool index_certs_161459;
                
                if (!ok_or_empty_161458) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) j_m_i_161442, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:106:32-36\n   #8  ftRelational.fut:103:5-106:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161381) {
                    int32_t dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161401) {
                        int32_t head_res_162008 = ((int32_t *) mem_param_171356.mem)[start_161441];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161441];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161368 + start_161441;
                        int32_t head_res_162011 = ((int32_t *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161369; nest_i_171983++) {
                        ((int32_t *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171438, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161369; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161369; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161391;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161368);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161391);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161368 + j_162022;
                                int64_t slice_162032 = start_161441 + slice_162031;
                                int32_t leq_arg1_162033 = ((int32_t *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161441 + i_162019;
                                int32_t leq_arg0_162038 = ((int32_t *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = sle32(leq_arg0_162038, leq_arg1_162033);
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        int32_t loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161368);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161441 + i_162019;
                            int32_t tmp_162049 = ((int32_t *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161391);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:106:32-36\n   #9  ftRelational.fut:103:5-106:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161368 + j_162022;
                            int64_t slice_162056 = start_161441 + slice_162055;
                            int32_t tmp_162057 = ((int32_t *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((int32_t *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172434 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172434, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172435 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172435, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390; i_171022++) {
                        int64_t split_count_arg3_161521 = mul64(merge_block_sizze_161254, i_171022);
                        int64_t defunc_0_split_count_res_161522;
                        int64_t defunc_0_split_count_res_161523;
                        int64_t defunc_0_split_count_res_161524;
                        int64_t defunc_0_split_count_res_161525;
                        int64_t defunc_0_split_count_res_161526;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161522, &defunc_0_split_count_res_161523, &defunc_0_split_count_res_161524, &defunc_0_split_count_res_161525, &defunc_0_split_count_res_161526, (int64_t) 0, stride_161368, (int64_t) 0, j_m_i_161391, split_count_arg3_161521) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161527 = slt64((int64_t) 0, defunc_0_split_count_res_161526);
                        bool defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        int64_t defunc_0_split_count_res_161533;
                        bool loop_while_161534;
                        int64_t ss_161535;
                        int64_t ss_161536;
                        int64_t tt_161537;
                        int64_t tt_161538;
                        int64_t count_161539;
                        
                        loop_while_161534 = loop_cond_161527;
                        ss_161535 = defunc_0_split_count_res_161522;
                        ss_161536 = defunc_0_split_count_res_161523;
                        tt_161537 = defunc_0_split_count_res_161524;
                        tt_161538 = defunc_0_split_count_res_161525;
                        count_161539 = defunc_0_split_count_res_161526;
                        while (loop_while_161534) {
                            int64_t zlze_lhs_161540 = sub64(ss_161536, ss_161535);
                            bool cond_161541 = sle64(zlze_lhs_161540, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161542;
                            int64_t defunc_0_lifted_step_res_161543;
                            int64_t defunc_0_lifted_step_res_161544;
                            int64_t defunc_0_lifted_step_res_161545;
                            
                            if (cond_161541) {
                                int64_t tmp_162061 = add64(tt_161537, count_161539);
                                
                                defunc_0_lifted_step_res_161542 = ss_161535;
                                defunc_0_lifted_step_res_161543 = tmp_162061;
                                defunc_0_lifted_step_res_161544 = tt_161538;
                                defunc_0_lifted_step_res_161545 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161547 = sub64(tt_161538, tt_161537);
                                bool cond_161548 = sle64(zlze_lhs_161547, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161549;
                                int64_t defunc_0_lifted_step_res_f_res_161550;
                                int64_t defunc_0_lifted_step_res_f_res_161551;
                                int64_t defunc_0_lifted_step_res_f_res_161552;
                                
                                if (cond_161548) {
                                    int64_t tmp_162062 = add64(ss_161535, count_161539);
                                    
                                    defunc_0_lifted_step_res_f_res_161549 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161550 = tt_161537;
                                    defunc_0_lifted_step_res_f_res_161551 = tt_161538;
                                    defunc_0_lifted_step_res_f_res_161552 = (int64_t) 0;
                                } else {
                                    bool cond_161554 = count_161539 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161555;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161556;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161557;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161558;
                                    
                                    if (cond_161554) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161535);
                                        bool y_162065 = slt64(ss_161535, stride_161368);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161535, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:106:32-36\n   #13 ftRelational.fut:103:5-106:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161537);
                                        bool y_162071 = slt64(tt_161537, j_m_i_161391);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161537, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:106:32-36\n   #13 ftRelational.fut:103:5-106:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161441 + ss_161535;
                                        int32_t leq_arg1_162069 = ((int32_t *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161368 + tt_161537;
                                        int64_t slice_162075 = start_161441 + slice_162074;
                                        int32_t leq_arg0_162076 = ((int32_t *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = sle32(leq_arg0_162076, leq_arg1_162069);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161537);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161535;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161535);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161537;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = tt_161538;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = (int64_t) 0;
                                    } else {
                                        int64_t m_161577 = sdiv64(count_161539, (int64_t) 2);
                                        int64_t n_161578 = sub64(count_161539, m_161577);
                                        bool cond_161579 = n_161578 == (int64_t) 0;
                                        int64_t zgze_lhs_161580 = add64(ss_161535, m_161577);
                                        bool cond_f_res_161581 = sle64(ss_161536, zgze_lhs_161580);
                                        bool x_161582 = !cond_161579;
                                        bool y_161583 = cond_f_res_161581 && x_161582;
                                        bool cond_161584 = cond_161579 || y_161583;
                                        bool leq_y_x_161585;
                                        
                                        if (cond_161584) {
                                            leq_y_x_161585 = 1;
                                        } else {
                                            bool x_161586 = sle64((int64_t) 0, zgze_lhs_161580);
                                            bool y_161587 = slt64(zgze_lhs_161580, stride_161368);
                                            bool bounds_check_161588 = x_161586 && y_161587;
                                            bool index_certs_161589;
                                            
                                            if (!bounds_check_161588) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161580, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:106:32-36\n   #13 ftRelational.fut:103:5-106:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161592 = add64(tt_161537, n_161578);
                                            int64_t leq_arg0_161593 = sub64(zm_lhs_161592, (int64_t) 1);
                                            bool x_161594 = sle64((int64_t) 0, leq_arg0_161593);
                                            bool y_161595 = slt64(leq_arg0_161593, j_m_i_161391);
                                            bool bounds_check_161596 = x_161594 && y_161595;
                                            bool index_certs_161597;
                                            
                                            if (!bounds_check_161596) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161593, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:106:32-36\n   #13 ftRelational.fut:103:5-106:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161590 = start_161441 + zgze_lhs_161580;
                                            int32_t leq_arg1_161591 = ((int32_t *) mem_param_171356.mem)[slice_161590];
                                            int64_t slice_161598 = stride_161368 + leq_arg0_161593;
                                            int64_t slice_161599 = start_161441 + slice_161598;
                                            int32_t leq_arg0_161600 = ((int32_t *) mem_param_171356.mem)[slice_161599];
                                            bool defunc_0_leq_res_161601 = sle32(leq_arg0_161600, leq_arg1_161591);
                                            
                                            leq_y_x_161585 = defunc_0_leq_res_161601;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                        
                                        if (leq_y_x_161585) {
                                            int64_t tmp_162082 = add64(tt_161537, n_161578);
                                            int64_t tmp_162083 = sub64(count_161539, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tt_161538;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = tmp_162083;
                                        } else {
                                            int64_t tmp_161607 = add64(tt_161537, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tt_161537;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tmp_161607;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = count_161539;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = ss_161535;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                    }
                                    defunc_0_lifted_step_res_f_res_161549 = defunc_0_lifted_step_res_f_res_f_res_161555;
                                    defunc_0_lifted_step_res_f_res_161550 = defunc_0_lifted_step_res_f_res_f_res_161556;
                                    defunc_0_lifted_step_res_f_res_161551 = defunc_0_lifted_step_res_f_res_f_res_161557;
                                    defunc_0_lifted_step_res_f_res_161552 = defunc_0_lifted_step_res_f_res_f_res_161558;
                                }
                                defunc_0_lifted_step_res_161542 = defunc_0_lifted_step_res_f_res_161549;
                                defunc_0_lifted_step_res_161543 = defunc_0_lifted_step_res_f_res_161550;
                                defunc_0_lifted_step_res_161544 = defunc_0_lifted_step_res_f_res_161551;
                                defunc_0_lifted_step_res_161545 = defunc_0_lifted_step_res_f_res_161552;
                            }
                            
                            int64_t loopres_161608;
                            int64_t loopres_161609;
                            int64_t loopres_161610;
                            int64_t loopres_161611;
                            int64_t loopres_161612;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161608, &loopres_161609, &loopres_161610, &loopres_161611, &loopres_161612, defunc_0_lifted_step_res_161542, ss_161536, defunc_0_lifted_step_res_161543, defunc_0_lifted_step_res_161544, defunc_0_lifted_step_res_161545) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161613 = slt64((int64_t) 0, loopres_161612);
                            bool loop_while_tmp_171990 = loop_cond_161613;
                            int64_t ss_tmp_171991 = loopres_161608;
                            int64_t ss_tmp_171992 = loopres_161609;
                            int64_t tt_tmp_171993 = loopres_161610;
                            int64_t tt_tmp_171994 = loopres_161611;
                            int64_t count_tmp_171995 = loopres_161612;
                            
                            loop_while_161534 = loop_while_tmp_171990;
                            ss_161535 = ss_tmp_171991;
                            ss_161536 = ss_tmp_171992;
                            tt_161537 = tt_tmp_171993;
                            tt_161538 = tt_tmp_171994;
                            count_161539 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161528 = loop_while_161534;
                        defunc_0_split_count_res_161529 = ss_161535;
                        defunc_0_split_count_res_161530 = ss_161536;
                        defunc_0_split_count_res_161531 = tt_161537;
                        defunc_0_split_count_res_161532 = tt_161538;
                        defunc_0_split_count_res_161533 = count_161539;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161529;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161531;
                    }
                    if (mem_171392_cached_sizze_172436 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172436, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172437 < bytes_171394) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172437, bytes_171394);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161389; i_171029++) {
                        bool y_161619 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool index_certs_161621;
                        
                        if (!y_161619) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:106:32-36\n   #10 ftRelational.fut:103:5-106:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161622 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161623 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161624 = add64((int64_t) 1, i_171029);
                        bool x_161625 = sle64((int64_t) 0, tmp_161624);
                        bool y_161626 = slt64(tmp_161624, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool bounds_check_161627 = x_161625 && y_161626;
                        bool index_certs_161628;
                        
                        if (!bounds_check_161627) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161624, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:106:32-36\n   #10 ftRelational.fut:103:5-106:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171375)[tmp_161624];
                        int64_t defunc_0_f_res_161630 = ((int64_t *) mem_171377)[tmp_161624];
                        int64_t merge_sequential_arg2_161631 = add64(stride_161368, defunc_0_f_res_161623);
                        int64_t merge_sequential_arg2_161632 = add64(stride_161368, defunc_0_f_res_161630);
                        int64_t j_m_i_161633 = sub64(merge_sequential_arg2_161632, merge_sequential_arg2_161631);
                        bool empty_slice_161634 = j_m_i_161633 == (int64_t) 0;
                        int64_t m_161635 = sub64(j_m_i_161633, (int64_t) 1);
                        int64_t i_p_m_t_s_161636 = add64(merge_sequential_arg2_161631, m_161635);
                        bool zzero_leq_i_p_m_t_s_161637 = sle64((int64_t) 0, i_p_m_t_s_161636);
                        bool i_p_m_t_s_leq_w_161638 = slt64(i_p_m_t_s_161636, next_stride_161369);
                        bool zzero_lte_i_161639 = sle64((int64_t) 0, merge_sequential_arg2_161631);
                        bool i_lte_j_161640 = sle64(merge_sequential_arg2_161631, merge_sequential_arg2_161632);
                        bool y_161641 = i_p_m_t_s_leq_w_161638 && zzero_lte_i_161639;
                        bool y_161642 = zzero_leq_i_p_m_t_s_161637 && y_161641;
                        bool forwards_ok_161643 = i_lte_j_161640 && y_161642;
                        bool ok_or_empty_161644 = empty_slice_161634 || forwards_ok_161643;
                        bool index_certs_161645;
                        
                        if (!ok_or_empty_161644) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161631, ":", (long long) merge_sequential_arg2_161632, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:106:32-36\n   #10 ftRelational.fut:103:5-106:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161646 = sub64(defunc_0_f_res_161629, defunc_0_f_res_161622);
                        bool empty_slice_161647 = j_m_i_161646 == (int64_t) 0;
                        int64_t m_161648 = sub64(j_m_i_161646, (int64_t) 1);
                        int64_t i_p_m_t_s_161649 = add64(defunc_0_f_res_161622, m_161648);
                        bool zzero_leq_i_p_m_t_s_161650 = sle64((int64_t) 0, i_p_m_t_s_161649);
                        bool i_p_m_t_s_leq_w_161651 = slt64(i_p_m_t_s_161649, next_stride_161369);
                        bool zzero_lte_i_161652 = sle64((int64_t) 0, defunc_0_f_res_161622);
                        bool i_lte_j_161653 = sle64(defunc_0_f_res_161622, defunc_0_f_res_161629);
                        bool y_161654 = i_p_m_t_s_leq_w_161651 && zzero_lte_i_161652;
                        bool y_161655 = zzero_leq_i_p_m_t_s_161650 && y_161654;
                        bool forwards_ok_161656 = i_lte_j_161653 && y_161655;
                        bool ok_or_empty_161657 = empty_slice_161647 || forwards_ok_161656;
                        bool index_certs_161658;
                        
                        if (!ok_or_empty_161657) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161622, ":", (long long) defunc_0_f_res_161629, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:106:32-36\n   #10 ftRelational.fut:103:5-106:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161659 = slt64((int64_t) 0, j_m_i_161646);
                        int32_t dummy_161660;
                        int64_t dummy_161661;
                        
                        if (cond_161659) {
                            bool index_certs_162084;
                            
                            if (!cond_161659) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:106:32-36\n   #12 ftRelational.fut:103:5-106:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161441 + defunc_0_f_res_161622;
                            int32_t head_res_162086 = ((int32_t *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161660 = head_res_162086;
                            dummy_161661 = head_res_162087;
                        } else {
                            bool y_161666 = slt64((int64_t) 0, j_m_i_161633);
                            bool index_certs_161667;
                            
                            if (!y_161666) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:106:32-36\n   #12 ftRelational.fut:103:5-106:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161668 = start_161441 + merge_sequential_arg2_161631;
                            int32_t head_res_161669 = ((int32_t *) mem_param_171356.mem)[slice_161668];
                            int64_t head_res_161670 = ((int64_t *) mem_param_171359.mem)[slice_161668];
                            
                            dummy_161660 = head_res_161669;
                            dummy_161661 = head_res_161670;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161254; nest_i_171998++) {
                            ((int32_t *) mem_171392)[i_171029 * merge_block_sizze_161254 + nest_i_171998] = dummy_161660;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161254; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + nest_i_171999] = dummy_161661;
                        }
                        
                        int64_t data_161673;
                        int64_t i_161677 = (int64_t) 0;
                        
                        for (int64_t k_161676 = 0; k_161676 < merge_block_sizze_161254; k_161676++) {
                            int64_t j_161680 = sub64(k_161676, i_161677);
                            bool cond_161681 = j_161680 == j_m_i_161633;
                            bool cond_161682;
                            
                            if (cond_161681) {
                                cond_161682 = 1;
                            } else {
                                bool cond_161683 = slt64(i_161677, j_m_i_161646);
                                bool cond_f_res_161684;
                                
                                if (cond_161683) {
                                    bool x_162088 = sle64((int64_t) 0, j_161680);
                                    bool y_162089 = slt64(j_161680, j_m_i_161633);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:106:32-36\n   #11 ftRelational.fut:103:5-106:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161677);
                                    bool bounds_check_162096 = cond_161683 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:106:32-36\n   #11 ftRelational.fut:103:5-106:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161631 + j_161680;
                                    int64_t slice_162093 = start_161441 + slice_162092;
                                    int32_t leq_arg1_162094 = ((int32_t *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161622 + i_161677;
                                    int64_t slice_162099 = start_161441 + slice_162098;
                                    int32_t leq_arg0_162100 = ((int32_t *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = sle32(leq_arg0_162100, leq_arg1_162094);
                                    
                                    cond_f_res_161684 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161684 = 0;
                                }
                                cond_161682 = cond_f_res_161684;
                            }
                            
                            int64_t loopres_161699;
                            int32_t loopres_161700;
                            int64_t loopres_161701;
                            
                            if (cond_161682) {
                                bool x_162103 = sle64((int64_t) 0, i_161677);
                                bool y_162104 = slt64(i_161677, j_m_i_161646);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:106:32-36\n   #11 ftRelational.fut:103:5-106:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161677);
                                int64_t slice_162107 = defunc_0_f_res_161622 + i_161677;
                                int64_t slice_162108 = start_161441 + slice_162107;
                                int32_t tmp_162109 = ((int32_t *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161699 = tmp_162102;
                                loopres_161700 = tmp_162109;
                                loopres_161701 = tmp_162110;
                            } else {
                                bool x_161711 = sle64((int64_t) 0, j_161680);
                                bool y_161712 = slt64(j_161680, j_m_i_161633);
                                bool bounds_check_161713 = x_161711 && y_161712;
                                bool index_certs_161714;
                                
                                if (!bounds_check_161713) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:106:32-36\n   #11 ftRelational.fut:103:5-106:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161715 = merge_sequential_arg2_161631 + j_161680;
                                int64_t slice_161716 = start_161441 + slice_161715;
                                int32_t tmp_161717 = ((int32_t *) mem_param_171356.mem)[slice_161716];
                                int64_t tmp_161718 = ((int64_t *) mem_param_171359.mem)[slice_161716];
                                
                                loopres_161699 = i_161677;
                                loopres_161700 = tmp_161717;
                                loopres_161701 = tmp_161718;
                            }
                            ((int32_t *) mem_171392)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161700;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161701;
                            
                            int64_t i_tmp_172000 = loopres_161699;
                            
                            i_161677 = i_tmp_172000;
                        }
                        data_161673 = i_161677;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint32_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171394, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171362, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161725 = next_stride_161369 * num_merges_161373;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint32_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            if (memblock_alloc(ctx, &mem_171472, bytes_171364, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            
            bool loop_cond_161728 = slt64(next_stride_161369, flat_dim_161250);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161725;
            bool loop_while_tmp_171977 = loop_cond_161728;
            int64_t stride_tmp_171980 = next_stride_161369;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161364 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161365 = loop_while_tmp_171977;
            stride_161368 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161359 = loop_dz2084Uz2082U_161364;
        data_161360 = loop_while_161365;
        data_161363 = stride_161368;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161729 = n_91210 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161730 = sle64((int64_t) 0, zs_lhs_161234);
        bool i_p_m_t_s_leq_w_161731 = slt64(zs_lhs_161234, data_161359);
        bool y_161732 = zzero_leq_i_p_m_t_s_161730 && i_p_m_t_s_leq_w_161731;
        bool ok_or_empty_161733 = empty_slice_161729 || y_161732;
        bool index_certs_161734;
        
        if (!ok_or_empty_161733) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_91210, "] out of bounds for array of shape [", (long long) data_161359, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:106:32-36\n   #6  ftRelational.fut:103:5-106:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171483, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_91210; i_171043++) {
        int64_t eta_p_161742 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161743 = sle64((int64_t) 0, eta_p_161742);
        bool y_161744 = slt64(eta_p_161742, n_91210);
        bool bounds_check_161745 = x_161743 && y_161744;
        bool index_certs_161746;
        
        if (!bounds_check_161745) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161742, "] out of bounds for array of shape [", (long long) n_91210, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:106:32-36\n   #5  ftRelational.fut:103:5-106:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t lifted_lambda_res_161747 = ((int32_t *) k_mem_171274.mem)[eta_p_161742];
        
        ((int32_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161747;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171486.mem, i_171043 * b_91211, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171275.mem, eta_p_161742 * b_91211, (int64_t []) {(int64_t) 1}, (int64_t []) {b_91211});
    }
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172426, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172427, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_172438, struct memblock *mem_out_p_172439, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_93569, int64_t b_93570)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172440 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172441 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172442 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172443 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172444 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172445 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172446 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172447 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172448 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172449 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_93569;
    bool cond_161233 = sle64(n_93569, (int64_t) 1);
    int64_t zs_lhs_161234 = sub64(n_93569, (int64_t) 1);
    int64_t zp_rhs_161235 = sdiv_safe64(zs_lhs_161234, (int64_t) 20);
    int64_t min_num_blocks_161236 = add64((int64_t) 1, zp_rhs_161235);
    bool loop_cond_161237 = slt64((int64_t) 1, min_num_blocks_161236);
    bool smallest_pow_2_geq_than_res_161238;
    int64_t smallest_pow_2_geq_than_res_161239;
    bool loop_while_161240;
    int64_t x_161241;
    
    loop_while_161240 = loop_cond_161237;
    x_161241 = (int64_t) 1;
    while (loop_while_161240) {
        int64_t loopres_161242 = mul64((int64_t) 2, x_161241);
        bool loop_cond_161243 = slt64(loopres_161242, min_num_blocks_161236);
        bool loop_while_tmp_171958 = loop_cond_161243;
        int64_t x_tmp_171959 = loopres_161242;
        
        loop_while_161240 = loop_while_tmp_171958;
        x_161241 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161238 = loop_while_161240;
    smallest_pow_2_geq_than_res_161239 = x_161241;
    
    bool zzero_161244 = smallest_pow_2_geq_than_res_161239 == (int64_t) 0;
    bool nonzzero_161245 = !zzero_161244;
    bool protect_assert_disj_161246 = cond_161233 || nonzzero_161245;
    bool nonzzero_cert_161247;
    
    if (!protect_assert_disj_161246) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:110:32-36\n   #5  ftRelational.fut:107:5-110:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161248 = sdiv_safe64(zs_lhs_161234, smallest_pow_2_geq_than_res_161239);
    int64_t block_sizze_161249 = add64((int64_t) 1, zp_rhs_161248);
    bool y_161255 = slt64((int64_t) 0, n_93569);
    bool protect_assert_disj_171871 = cond_161233 || y_161255;
    bool index_certs_161256;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_93569, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:110:32-36\n   #5  ftRelational.fut:107:5-110:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161270 = slt64(smallest_pow_2_geq_than_res_161239, (int64_t) 0);
    bool valid_161271 = !bounds_invalid_upwards_161270;
    bool protect_assert_disj_171879 = cond_161233 || valid_161271;
    bool range_valid_c_161272;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:110:32-36\n   #6  ftRelational.fut:107:5-110:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161274 = slt64(block_sizze_161249, (int64_t) 0);
    bool valid_161275 = !bounds_invalid_upwards_161274;
    bool protect_assert_disj_171881 = cond_161233 || valid_161275;
    bool range_valid_c_161276;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161249, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161278 = sle64(block_sizze_161249, (int64_t) 1);
    int64_t tmp_161279 = sub64(block_sizze_161249, (int64_t) 2);
    bool bounds_invalid_upwards_161280 = slt64(tmp_161279, (int64_t) 0);
    bool valid_161282 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_161283 = cond_161278 || valid_161282;
    bool protect_assert_disj_171883 = cond_161233 || protect_assert_disj_161283;
    bool range_valid_c_161284;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161279, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171485 = n_93569 * b_93570;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_93569; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161250 = smallest_pow_2_geq_than_res_161239 * block_sizze_161249;
    bool x_171866 = !cond_161233;
    int64_t greatest_divisor_leq_than_arg1_161253 = mul64((int64_t) 2, block_sizze_161249);
    int64_t merge_block_sizze_161254;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161253) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161254 = x_171868;
    } else {
        merge_block_sizze_161254 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_161257;
    
    if (x_171866) {
        int64_t x_171872 = ((int64_t *) k_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161257 = x_171872;
    } else {
        reduce_arg1_161257 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        int64_t x_171874;
        int64_t x_171875;
        int64_t redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161257;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_93569; i_171003++) {
            int64_t x_161261 = ((int64_t *) k_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161267 = sle64(redout_171001, x_161261);
            int64_t defunc_0_op_res_161268;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161268 = x_161261;
            } else {
                defunc_0_op_res_161268 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161269;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161269 = i_171003;
            } else {
                defunc_0_op_res_161269 = redout_171002;
            }
            
            int64_t redout_tmp_171962 = defunc_0_op_res_161268;
            int64_t redout_tmp_171963 = defunc_0_op_res_161269;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = (int64_t) 0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161281 = add64((int64_t) 1, tmp_161279);
    int64_t binop_x_171278 = (int64_t) 8 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171279 = block_sizze_161249 * binop_x_171278;
    int64_t bytes_171292 = (int64_t) 8 * block_sizze_161249;
    bool loop_cond_161356 = slt64(block_sizze_161249, flat_dim_161250);
    bool zzero_161357 = merge_block_sizze_161254 == (int64_t) 0;
    bool nonzzero_161358 = !zzero_161357;
    
    if (cond_161233) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172440 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172440, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172441 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172441, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172442 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172442, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172443 < bytes_171292) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172443, bytes_171292);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161239; i_171015++) {
            int64_t zp_lhs_161288 = mul64(block_sizze_161249, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161249; i_171008++) {
                int64_t k_161292 = add64(zp_lhs_161288, i_171008);
                bool cond_161293 = slt64(k_161292, n_93569);
                int64_t lifted_lambda_res_161294;
                int64_t lifted_lambda_res_161295;
                
                if (cond_161293) {
                    bool x_161970 = sle64((int64_t) 0, k_161292);
                    bool bounds_check_161971 = cond_161293 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161292, "] out of bounds for array of shape [", (long long) n_93569, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_161973 = ((int64_t *) k_mem_171274.mem)[k_161292];
                    
                    lifted_lambda_res_161294 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161295 = k_161292;
                } else {
                    lifted_lambda_res_161294 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161295 = defunc_0_reduce_res_162118;
                }
                ((int64_t *) mem_171293)[i_171008] = lifted_lambda_res_161294;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161295;
            }
            if (!cond_161278) {
                for (int64_t i_161305 = 0; i_161305 < distance_161281; i_161305++) {
                    int64_t gt_arg1_161308 = add64((int64_t) 1, i_161305);
                    bool x_161309 = sle64((int64_t) 0, gt_arg1_161308);
                    bool y_161310 = slt64(gt_arg1_161308, block_sizze_161249);
                    bool bounds_check_161311 = x_161309 && y_161310;
                    bool index_certs_161312;
                    
                    if (!bounds_check_161311) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161308, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161314 = slt64(i_161305, block_sizze_161249);
                    bool index_certs_161315;
                    
                    if (!y_161314) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161305, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_161313 = ((int64_t *) mem_171293)[gt_arg1_161308];
                    int64_t gt_arg0_161316 = ((int64_t *) mem_171293)[i_161305];
                    bool defunc_0_leq_res_161317 = sle64(gt_arg0_161316, gt_arg1_161313);
                    bool defunc_0_lifted_gt_res_161318 = !defunc_0_leq_res_161317;
                    bool s_161319;
                    int64_t s_161322;
                    bool loop_while_161323;
                    int64_t j_161326;
                    
                    loop_while_161323 = defunc_0_lifted_gt_res_161318;
                    j_161326 = i_161305;
                    while (loop_while_161323) {
                        bool x_161327 = sle64((int64_t) 0, j_161326);
                        bool y_161328 = slt64(j_161326, block_sizze_161249);
                        bool bounds_check_161329 = x_161327 && y_161328;
                        bool index_certs_161330;
                        
                        if (!bounds_check_161329) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161326, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161333 = add64((int64_t) 1, j_161326);
                        bool x_161334 = sle64((int64_t) 0, copy_arg0_161333);
                        bool y_161335 = slt64(copy_arg0_161333, block_sizze_161249);
                        bool bounds_check_161336 = x_161334 && y_161335;
                        bool index_certs_161337;
                        
                        if (!bounds_check_161336) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161333, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161331 = ((int64_t *) mem_171293)[j_161326];
                        int64_t copy_arg0_161332 = ((int64_t *) mem_171295)[j_161326];
                        int64_t copy_arg0_161338 = ((int64_t *) mem_171293)[copy_arg0_161333];
                        int64_t copy_arg0_161339 = ((int64_t *) mem_171295)[copy_arg0_161333];
                        
                        ((int64_t *) mem_171293)[j_161326] = copy_arg0_161338;
                        ((int64_t *) mem_171295)[j_161326] = copy_arg0_161339;
                        ((int64_t *) mem_171293)[copy_arg0_161333] = copy_arg0_161331;
                        ((int64_t *) mem_171295)[copy_arg0_161333] = copy_arg0_161332;
                        
                        int64_t tmp_161344 = sub64(j_161326, (int64_t) 1);
                        bool cond_161345 = sle64((int64_t) 0, tmp_161344);
                        bool loop_cond_161346;
                        
                        if (cond_161345) {
                            bool y_161975 = slt64(tmp_161344, block_sizze_161249);
                            bool bounds_check_161976 = cond_161345 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161344, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_161974 = ((int64_t *) mem_171293)[j_161326];
                            int64_t gt_arg0_161978 = ((int64_t *) mem_171293)[tmp_161344];
                            bool defunc_0_leq_res_161979 = sle64(gt_arg0_161978, gt_arg1_161974);
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161346 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161346 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161346;
                        int64_t j_tmp_171973 = tmp_161344;
                        
                        loop_while_161323 = loop_while_tmp_171970;
                        j_161326 = j_tmp_171973;
                    }
                    s_161319 = loop_while_161323;
                    s_161322 = j_161326;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171280, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        if (memblock_alloc(ctx, &mem_171352, bytes_171279, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        
        int64_t data_161359;
        bool data_161360;
        int64_t data_161363;
        int64_t loop_dz2084Uz2082U_161364;
        bool loop_while_161365;
        int64_t stride_161368;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161364 = flat_dim_161250;
        loop_while_161365 = loop_cond_161356;
        stride_161368 = block_sizze_161249;
        while (loop_while_161365) {
            int64_t next_stride_161369 = mul64((int64_t) 2, stride_161368);
            bool zzero_161370 = next_stride_161369 == (int64_t) 0;
            bool nonzzero_161371 = !zzero_161370;
            bool nonzzero_cert_161372;
            
            if (!nonzzero_161371) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:110:32-36\n   #5  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161373 = sdiv64(flat_dim_161250, next_stride_161369);
            bool bounds_invalid_upwards_161374 = slt64(num_merges_161373, (int64_t) 0);
            bool valid_161375 = !bounds_invalid_upwards_161374;
            bool range_valid_c_161376;
            
            if (!valid_161375) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161373, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:110:32-36\n   #6  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161378 = sub64(next_stride_161369, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161379 = sle64((int64_t) 0, m_161378);
            bool cond_161381 = slt64(next_stride_161369, (int64_t) 10);
            bool protect_assert_disj_161382 = nonzzero_161358 || cond_161381;
            bool nonzzero_cert_161383;
            
            if (!protect_assert_disj_161382) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161384 = smod_safe64(next_stride_161369, merge_block_sizze_161254);
            bool num_blocks_161385 = zeze_lhs_161384 == (int64_t) 0;
            bool protect_assert_disj_161386 = cond_161381 || num_blocks_161385;
            bool assert_c_161387;
            
            if (!protect_assert_disj_161386) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161389 = sdiv_safe64(next_stride_161369, merge_block_sizze_161254);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390 = add64((int64_t) 1, num_blocks_161389);
            int64_t j_m_i_161391 = sub64(next_stride_161369, stride_161368);
            int64_t flat_dim_161392 = merge_block_sizze_161254 * num_blocks_161389;
            bool bounds_invalid_upwards_161393 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, (int64_t) 0);
            bool empty_slice_161394 = j_m_i_161391 == (int64_t) 0;
            int64_t m_161395 = sub64(j_m_i_161391, (int64_t) 1);
            bool zzero_lte_i_161396 = sle64((int64_t) 0, stride_161368);
            bool i_lte_j_161397 = sle64(stride_161368, next_stride_161369);
            bool empty_slice_161398 = stride_161368 == (int64_t) 0;
            int64_t m_161399 = sub64(stride_161368, (int64_t) 1);
            bool bounds_invalid_upwards_161400 = slt64(num_blocks_161389, (int64_t) 0);
            bool cond_161401 = slt64((int64_t) 0, stride_161368);
            bool valid_161402 = !bounds_invalid_upwards_161393;
            int64_t i_p_m_t_s_161403 = add64(stride_161368, m_161395);
            bool zzero_leq_i_p_m_t_s_161404 = sle64((int64_t) 0, m_161399);
            bool i_p_m_t_s_leq_w_161405 = slt64(m_161399, next_stride_161369);
            bool valid_161406 = !bounds_invalid_upwards_161400;
            bool i_p_m_t_s_leq_w_161407 = slt64(m_161378, flat_dim_161392);
            bool y_161408 = slt64((int64_t) 0, j_m_i_161391);
            bool protect_assert_disj_161409 = cond_161381 || valid_161402;
            bool range_valid_c_161410;
            
            if (!protect_assert_disj_161409) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:110:32-36\n   #10 ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161411 = sle64((int64_t) 0, i_p_m_t_s_161403);
            bool i_p_m_t_s_leq_w_161412 = slt64(i_p_m_t_s_161403, next_stride_161369);
            bool y_161413 = zzero_leq_i_p_m_t_s_161404 && i_p_m_t_s_leq_w_161405;
            bool protect_assert_disj_161414 = cond_161381 || valid_161406;
            bool range_valid_c_161415;
            
            if (!protect_assert_disj_161414) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161389, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161416 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161407;
            bool y_161417 = zzero_lte_i_161396 && i_p_m_t_s_leq_w_161412;
            bool forwards_ok_161418 = zzero_lte_i_161396 && y_161413;
            bool ok_or_empty_161419 = zzero_161370 || y_161416;
            bool protect_assert_disj_161420 = cond_161401 || y_161408;
            bool y_161421 = zzero_leq_i_p_m_t_s_161411 && y_161417;
            bool ok_or_empty_161422 = empty_slice_161398 || forwards_ok_161418;
            bool protect_assert_disj_161423 = cond_161381 || ok_or_empty_161419;
            bool index_certs_161424;
            
            if (!protect_assert_disj_161423) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) flat_dim_161392, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161425 = !cond_161381;
            bool protect_assert_disj_161426 = protect_assert_disj_161420 || loop_not_taken_161425;
            bool index_certs_161427;
            
            if (!protect_assert_disj_161426) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:110:32-36\n   #10 ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161428 = i_lte_j_161397 && y_161421;
            bool protect_assert_disj_161429 = cond_161381 || ok_or_empty_161422;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:110:32-36\n   #11 ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161431 = ok_or_empty_161422 || loop_not_taken_161425;
            bool index_certs_161432;
            
            if (!protect_assert_disj_161431) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161433 = empty_slice_161394 || forwards_ok_161428;
            bool protect_assert_disj_161434 = cond_161381 || ok_or_empty_161433;
            bool index_certs_161435;
            
            if (!protect_assert_disj_161434) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:110:32-36\n   #11 ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161436 = loop_not_taken_161425 || ok_or_empty_161433;
            bool index_certs_161437;
            
            if (!protect_assert_disj_161436) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 8 * num_merges_161373;
            int64_t bytes_171361 = next_stride_161369 * binop_x_171360;
            bool i_lte_j_161380 = sle64((int64_t) 0, next_stride_161369);
            
            if (mem_171362_cached_sizze_172444 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172444, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172445 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172445, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390;
            int64_t binop_x_171390 = (int64_t) 8 * num_blocks_161389;
            int64_t bytes_171391 = merge_block_sizze_161254 * binop_x_171390;
            int64_t bytes_171436 = (int64_t) 16 * stride_161368;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161373; i_171036++) {
                int64_t start_161441 = mul64(next_stride_161369, i_171036);
                int64_t j_m_i_161442 = sub64(loop_dz2084Uz2082U_161364, start_161441);
                bool empty_slice_161443 = j_m_i_161442 == (int64_t) 0;
                int64_t m_161444 = sub64(j_m_i_161442, (int64_t) 1);
                int64_t i_p_m_t_s_161445 = add64(start_161441, m_161444);
                bool zzero_leq_i_p_m_t_s_161446 = sle64((int64_t) 0, i_p_m_t_s_161445);
                bool i_p_m_t_s_leq_w_161447 = slt64(i_p_m_t_s_161445, loop_dz2084Uz2082U_161364);
                bool zzero_lte_i_161448 = sle64((int64_t) 0, start_161441);
                bool i_lte_j_161449 = sle64(start_161441, loop_dz2084Uz2082U_161364);
                bool y_161450 = i_p_m_t_s_leq_w_161447 && zzero_lte_i_161448;
                bool y_161451 = zzero_leq_i_p_m_t_s_161446 && y_161450;
                bool forwards_ok_161452 = i_lte_j_161449 && y_161451;
                bool ok_or_empty_161453 = empty_slice_161443 || forwards_ok_161452;
                bool index_certs_161454;
                
                if (!ok_or_empty_161453) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161441, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161364, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161455 = slt64(m_161378, j_m_i_161442);
                bool y_161456 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161455;
                bool forwards_ok_161457 = i_lte_j_161380 && y_161456;
                bool ok_or_empty_161458 = zzero_161370 || forwards_ok_161457;
                bool index_certs_161459;
                
                if (!ok_or_empty_161458) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) j_m_i_161442, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:110:32-36\n   #8  ftRelational.fut:107:5-110:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161381) {
                    int64_t dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161401) {
                        int64_t head_res_162008 = ((int64_t *) mem_param_171356.mem)[start_161441];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161441];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161368 + start_161441;
                        int64_t head_res_162011 = ((int64_t *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161369; nest_i_171983++) {
                        ((int64_t *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171436, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161369; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161369; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161391;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161368);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161391);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161368 + j_162022;
                                int64_t slice_162032 = start_161441 + slice_162031;
                                int64_t leq_arg1_162033 = ((int64_t *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161441 + i_162019;
                                int64_t leq_arg0_162038 = ((int64_t *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = sle64(leq_arg0_162038, leq_arg1_162033);
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        int64_t loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161368);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161441 + i_162019;
                            int64_t tmp_162049 = ((int64_t *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161391);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:110:32-36\n   #9  ftRelational.fut:107:5-110:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161368 + j_162022;
                            int64_t slice_162056 = start_161441 + slice_162055;
                            int64_t tmp_162057 = ((int64_t *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((int64_t *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172446 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172446, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172447 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172447, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390; i_171022++) {
                        int64_t split_count_arg3_161521 = mul64(merge_block_sizze_161254, i_171022);
                        int64_t defunc_0_split_count_res_161522;
                        int64_t defunc_0_split_count_res_161523;
                        int64_t defunc_0_split_count_res_161524;
                        int64_t defunc_0_split_count_res_161525;
                        int64_t defunc_0_split_count_res_161526;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161522, &defunc_0_split_count_res_161523, &defunc_0_split_count_res_161524, &defunc_0_split_count_res_161525, &defunc_0_split_count_res_161526, (int64_t) 0, stride_161368, (int64_t) 0, j_m_i_161391, split_count_arg3_161521) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161527 = slt64((int64_t) 0, defunc_0_split_count_res_161526);
                        bool defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        int64_t defunc_0_split_count_res_161533;
                        bool loop_while_161534;
                        int64_t ss_161535;
                        int64_t ss_161536;
                        int64_t tt_161537;
                        int64_t tt_161538;
                        int64_t count_161539;
                        
                        loop_while_161534 = loop_cond_161527;
                        ss_161535 = defunc_0_split_count_res_161522;
                        ss_161536 = defunc_0_split_count_res_161523;
                        tt_161537 = defunc_0_split_count_res_161524;
                        tt_161538 = defunc_0_split_count_res_161525;
                        count_161539 = defunc_0_split_count_res_161526;
                        while (loop_while_161534) {
                            int64_t zlze_lhs_161540 = sub64(ss_161536, ss_161535);
                            bool cond_161541 = sle64(zlze_lhs_161540, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161542;
                            int64_t defunc_0_lifted_step_res_161543;
                            int64_t defunc_0_lifted_step_res_161544;
                            int64_t defunc_0_lifted_step_res_161545;
                            
                            if (cond_161541) {
                                int64_t tmp_162061 = add64(tt_161537, count_161539);
                                
                                defunc_0_lifted_step_res_161542 = ss_161535;
                                defunc_0_lifted_step_res_161543 = tmp_162061;
                                defunc_0_lifted_step_res_161544 = tt_161538;
                                defunc_0_lifted_step_res_161545 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161547 = sub64(tt_161538, tt_161537);
                                bool cond_161548 = sle64(zlze_lhs_161547, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161549;
                                int64_t defunc_0_lifted_step_res_f_res_161550;
                                int64_t defunc_0_lifted_step_res_f_res_161551;
                                int64_t defunc_0_lifted_step_res_f_res_161552;
                                
                                if (cond_161548) {
                                    int64_t tmp_162062 = add64(ss_161535, count_161539);
                                    
                                    defunc_0_lifted_step_res_f_res_161549 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161550 = tt_161537;
                                    defunc_0_lifted_step_res_f_res_161551 = tt_161538;
                                    defunc_0_lifted_step_res_f_res_161552 = (int64_t) 0;
                                } else {
                                    bool cond_161554 = count_161539 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161555;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161556;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161557;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161558;
                                    
                                    if (cond_161554) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161535);
                                        bool y_162065 = slt64(ss_161535, stride_161368);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161535, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:110:32-36\n   #13 ftRelational.fut:107:5-110:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161537);
                                        bool y_162071 = slt64(tt_161537, j_m_i_161391);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161537, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:110:32-36\n   #13 ftRelational.fut:107:5-110:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161441 + ss_161535;
                                        int64_t leq_arg1_162069 = ((int64_t *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161368 + tt_161537;
                                        int64_t slice_162075 = start_161441 + slice_162074;
                                        int64_t leq_arg0_162076 = ((int64_t *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = sle64(leq_arg0_162076, leq_arg1_162069);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161537);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161535;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161535);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161537;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = tt_161538;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = (int64_t) 0;
                                    } else {
                                        int64_t m_161577 = sdiv64(count_161539, (int64_t) 2);
                                        int64_t n_161578 = sub64(count_161539, m_161577);
                                        bool cond_161579 = n_161578 == (int64_t) 0;
                                        int64_t zgze_lhs_161580 = add64(ss_161535, m_161577);
                                        bool cond_f_res_161581 = sle64(ss_161536, zgze_lhs_161580);
                                        bool x_161582 = !cond_161579;
                                        bool y_161583 = cond_f_res_161581 && x_161582;
                                        bool cond_161584 = cond_161579 || y_161583;
                                        bool leq_y_x_161585;
                                        
                                        if (cond_161584) {
                                            leq_y_x_161585 = 1;
                                        } else {
                                            bool x_161586 = sle64((int64_t) 0, zgze_lhs_161580);
                                            bool y_161587 = slt64(zgze_lhs_161580, stride_161368);
                                            bool bounds_check_161588 = x_161586 && y_161587;
                                            bool index_certs_161589;
                                            
                                            if (!bounds_check_161588) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161580, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:110:32-36\n   #13 ftRelational.fut:107:5-110:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161592 = add64(tt_161537, n_161578);
                                            int64_t leq_arg0_161593 = sub64(zm_lhs_161592, (int64_t) 1);
                                            bool x_161594 = sle64((int64_t) 0, leq_arg0_161593);
                                            bool y_161595 = slt64(leq_arg0_161593, j_m_i_161391);
                                            bool bounds_check_161596 = x_161594 && y_161595;
                                            bool index_certs_161597;
                                            
                                            if (!bounds_check_161596) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161593, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:110:32-36\n   #13 ftRelational.fut:107:5-110:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161590 = start_161441 + zgze_lhs_161580;
                                            int64_t leq_arg1_161591 = ((int64_t *) mem_param_171356.mem)[slice_161590];
                                            int64_t slice_161598 = stride_161368 + leq_arg0_161593;
                                            int64_t slice_161599 = start_161441 + slice_161598;
                                            int64_t leq_arg0_161600 = ((int64_t *) mem_param_171356.mem)[slice_161599];
                                            bool defunc_0_leq_res_161601 = sle64(leq_arg0_161600, leq_arg1_161591);
                                            
                                            leq_y_x_161585 = defunc_0_leq_res_161601;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                        
                                        if (leq_y_x_161585) {
                                            int64_t tmp_162082 = add64(tt_161537, n_161578);
                                            int64_t tmp_162083 = sub64(count_161539, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tt_161538;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = tmp_162083;
                                        } else {
                                            int64_t tmp_161607 = add64(tt_161537, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tt_161537;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tmp_161607;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = count_161539;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = ss_161535;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                    }
                                    defunc_0_lifted_step_res_f_res_161549 = defunc_0_lifted_step_res_f_res_f_res_161555;
                                    defunc_0_lifted_step_res_f_res_161550 = defunc_0_lifted_step_res_f_res_f_res_161556;
                                    defunc_0_lifted_step_res_f_res_161551 = defunc_0_lifted_step_res_f_res_f_res_161557;
                                    defunc_0_lifted_step_res_f_res_161552 = defunc_0_lifted_step_res_f_res_f_res_161558;
                                }
                                defunc_0_lifted_step_res_161542 = defunc_0_lifted_step_res_f_res_161549;
                                defunc_0_lifted_step_res_161543 = defunc_0_lifted_step_res_f_res_161550;
                                defunc_0_lifted_step_res_161544 = defunc_0_lifted_step_res_f_res_161551;
                                defunc_0_lifted_step_res_161545 = defunc_0_lifted_step_res_f_res_161552;
                            }
                            
                            int64_t loopres_161608;
                            int64_t loopres_161609;
                            int64_t loopres_161610;
                            int64_t loopres_161611;
                            int64_t loopres_161612;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161608, &loopres_161609, &loopres_161610, &loopres_161611, &loopres_161612, defunc_0_lifted_step_res_161542, ss_161536, defunc_0_lifted_step_res_161543, defunc_0_lifted_step_res_161544, defunc_0_lifted_step_res_161545) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161613 = slt64((int64_t) 0, loopres_161612);
                            bool loop_while_tmp_171990 = loop_cond_161613;
                            int64_t ss_tmp_171991 = loopres_161608;
                            int64_t ss_tmp_171992 = loopres_161609;
                            int64_t tt_tmp_171993 = loopres_161610;
                            int64_t tt_tmp_171994 = loopres_161611;
                            int64_t count_tmp_171995 = loopres_161612;
                            
                            loop_while_161534 = loop_while_tmp_171990;
                            ss_161535 = ss_tmp_171991;
                            ss_161536 = ss_tmp_171992;
                            tt_161537 = tt_tmp_171993;
                            tt_161538 = tt_tmp_171994;
                            count_161539 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161528 = loop_while_161534;
                        defunc_0_split_count_res_161529 = ss_161535;
                        defunc_0_split_count_res_161530 = ss_161536;
                        defunc_0_split_count_res_161531 = tt_161537;
                        defunc_0_split_count_res_161532 = tt_161538;
                        defunc_0_split_count_res_161533 = count_161539;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161529;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161531;
                    }
                    if (mem_171392_cached_sizze_172448 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172448, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172449 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172449, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161389; i_171029++) {
                        bool y_161619 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool index_certs_161621;
                        
                        if (!y_161619) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:110:32-36\n   #10 ftRelational.fut:107:5-110:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161622 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161623 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161624 = add64((int64_t) 1, i_171029);
                        bool x_161625 = sle64((int64_t) 0, tmp_161624);
                        bool y_161626 = slt64(tmp_161624, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool bounds_check_161627 = x_161625 && y_161626;
                        bool index_certs_161628;
                        
                        if (!bounds_check_161627) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161624, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:110:32-36\n   #10 ftRelational.fut:107:5-110:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171375)[tmp_161624];
                        int64_t defunc_0_f_res_161630 = ((int64_t *) mem_171377)[tmp_161624];
                        int64_t merge_sequential_arg2_161631 = add64(stride_161368, defunc_0_f_res_161623);
                        int64_t merge_sequential_arg2_161632 = add64(stride_161368, defunc_0_f_res_161630);
                        int64_t j_m_i_161633 = sub64(merge_sequential_arg2_161632, merge_sequential_arg2_161631);
                        bool empty_slice_161634 = j_m_i_161633 == (int64_t) 0;
                        int64_t m_161635 = sub64(j_m_i_161633, (int64_t) 1);
                        int64_t i_p_m_t_s_161636 = add64(merge_sequential_arg2_161631, m_161635);
                        bool zzero_leq_i_p_m_t_s_161637 = sle64((int64_t) 0, i_p_m_t_s_161636);
                        bool i_p_m_t_s_leq_w_161638 = slt64(i_p_m_t_s_161636, next_stride_161369);
                        bool zzero_lte_i_161639 = sle64((int64_t) 0, merge_sequential_arg2_161631);
                        bool i_lte_j_161640 = sle64(merge_sequential_arg2_161631, merge_sequential_arg2_161632);
                        bool y_161641 = i_p_m_t_s_leq_w_161638 && zzero_lte_i_161639;
                        bool y_161642 = zzero_leq_i_p_m_t_s_161637 && y_161641;
                        bool forwards_ok_161643 = i_lte_j_161640 && y_161642;
                        bool ok_or_empty_161644 = empty_slice_161634 || forwards_ok_161643;
                        bool index_certs_161645;
                        
                        if (!ok_or_empty_161644) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161631, ":", (long long) merge_sequential_arg2_161632, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:110:32-36\n   #10 ftRelational.fut:107:5-110:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161646 = sub64(defunc_0_f_res_161629, defunc_0_f_res_161622);
                        bool empty_slice_161647 = j_m_i_161646 == (int64_t) 0;
                        int64_t m_161648 = sub64(j_m_i_161646, (int64_t) 1);
                        int64_t i_p_m_t_s_161649 = add64(defunc_0_f_res_161622, m_161648);
                        bool zzero_leq_i_p_m_t_s_161650 = sle64((int64_t) 0, i_p_m_t_s_161649);
                        bool i_p_m_t_s_leq_w_161651 = slt64(i_p_m_t_s_161649, next_stride_161369);
                        bool zzero_lte_i_161652 = sle64((int64_t) 0, defunc_0_f_res_161622);
                        bool i_lte_j_161653 = sle64(defunc_0_f_res_161622, defunc_0_f_res_161629);
                        bool y_161654 = i_p_m_t_s_leq_w_161651 && zzero_lte_i_161652;
                        bool y_161655 = zzero_leq_i_p_m_t_s_161650 && y_161654;
                        bool forwards_ok_161656 = i_lte_j_161653 && y_161655;
                        bool ok_or_empty_161657 = empty_slice_161647 || forwards_ok_161656;
                        bool index_certs_161658;
                        
                        if (!ok_or_empty_161657) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161622, ":", (long long) defunc_0_f_res_161629, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:110:32-36\n   #10 ftRelational.fut:107:5-110:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161659 = slt64((int64_t) 0, j_m_i_161646);
                        int64_t dummy_161660;
                        int64_t dummy_161661;
                        
                        if (cond_161659) {
                            bool index_certs_162084;
                            
                            if (!cond_161659) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:110:32-36\n   #12 ftRelational.fut:107:5-110:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161441 + defunc_0_f_res_161622;
                            int64_t head_res_162086 = ((int64_t *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161660 = head_res_162086;
                            dummy_161661 = head_res_162087;
                        } else {
                            bool y_161666 = slt64((int64_t) 0, j_m_i_161633);
                            bool index_certs_161667;
                            
                            if (!y_161666) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:110:32-36\n   #12 ftRelational.fut:107:5-110:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161668 = start_161441 + merge_sequential_arg2_161631;
                            int64_t head_res_161669 = ((int64_t *) mem_param_171356.mem)[slice_161668];
                            int64_t head_res_161670 = ((int64_t *) mem_param_171359.mem)[slice_161668];
                            
                            dummy_161660 = head_res_161669;
                            dummy_161661 = head_res_161670;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161254; nest_i_171998++) {
                            ((int64_t *) mem_171392)[i_171029 * merge_block_sizze_161254 + nest_i_171998] = dummy_161660;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161254; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + nest_i_171999] = dummy_161661;
                        }
                        
                        int64_t data_161673;
                        int64_t i_161677 = (int64_t) 0;
                        
                        for (int64_t k_161676 = 0; k_161676 < merge_block_sizze_161254; k_161676++) {
                            int64_t j_161680 = sub64(k_161676, i_161677);
                            bool cond_161681 = j_161680 == j_m_i_161633;
                            bool cond_161682;
                            
                            if (cond_161681) {
                                cond_161682 = 1;
                            } else {
                                bool cond_161683 = slt64(i_161677, j_m_i_161646);
                                bool cond_f_res_161684;
                                
                                if (cond_161683) {
                                    bool x_162088 = sle64((int64_t) 0, j_161680);
                                    bool y_162089 = slt64(j_161680, j_m_i_161633);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:110:32-36\n   #11 ftRelational.fut:107:5-110:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161677);
                                    bool bounds_check_162096 = cond_161683 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:110:32-36\n   #11 ftRelational.fut:107:5-110:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161631 + j_161680;
                                    int64_t slice_162093 = start_161441 + slice_162092;
                                    int64_t leq_arg1_162094 = ((int64_t *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161622 + i_161677;
                                    int64_t slice_162099 = start_161441 + slice_162098;
                                    int64_t leq_arg0_162100 = ((int64_t *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = sle64(leq_arg0_162100, leq_arg1_162094);
                                    
                                    cond_f_res_161684 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161684 = 0;
                                }
                                cond_161682 = cond_f_res_161684;
                            }
                            
                            int64_t loopres_161699;
                            int64_t loopres_161700;
                            int64_t loopres_161701;
                            
                            if (cond_161682) {
                                bool x_162103 = sle64((int64_t) 0, i_161677);
                                bool y_162104 = slt64(i_161677, j_m_i_161646);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:110:32-36\n   #11 ftRelational.fut:107:5-110:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161677);
                                int64_t slice_162107 = defunc_0_f_res_161622 + i_161677;
                                int64_t slice_162108 = start_161441 + slice_162107;
                                int64_t tmp_162109 = ((int64_t *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161699 = tmp_162102;
                                loopres_161700 = tmp_162109;
                                loopres_161701 = tmp_162110;
                            } else {
                                bool x_161711 = sle64((int64_t) 0, j_161680);
                                bool y_161712 = slt64(j_161680, j_m_i_161633);
                                bool bounds_check_161713 = x_161711 && y_161712;
                                bool index_certs_161714;
                                
                                if (!bounds_check_161713) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:110:32-36\n   #11 ftRelational.fut:107:5-110:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161715 = merge_sequential_arg2_161631 + j_161680;
                                int64_t slice_161716 = start_161441 + slice_161715;
                                int64_t tmp_161717 = ((int64_t *) mem_param_171356.mem)[slice_161716];
                                int64_t tmp_161718 = ((int64_t *) mem_param_171359.mem)[slice_161716];
                                
                                loopres_161699 = i_161677;
                                loopres_161700 = tmp_161717;
                                loopres_161701 = tmp_161718;
                            }
                            ((int64_t *) mem_171392)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161700;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161701;
                            
                            int64_t i_tmp_172000 = loopres_161699;
                            
                            i_161677 = i_tmp_172000;
                        }
                        data_161673 = i_161677;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171391, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171362, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161725 = next_stride_161369 * num_merges_161373;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            if (memblock_alloc(ctx, &mem_171472, bytes_171361, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            
            bool loop_cond_161728 = slt64(next_stride_161369, flat_dim_161250);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161725;
            bool loop_while_tmp_171977 = loop_cond_161728;
            int64_t stride_tmp_171980 = next_stride_161369;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161364 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161365 = loop_while_tmp_171977;
            stride_161368 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161359 = loop_dz2084Uz2082U_161364;
        data_161360 = loop_while_161365;
        data_161363 = stride_161368;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161729 = n_93569 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161730 = sle64((int64_t) 0, zs_lhs_161234);
        bool i_p_m_t_s_leq_w_161731 = slt64(zs_lhs_161234, data_161359);
        bool y_161732 = zzero_leq_i_p_m_t_s_161730 && i_p_m_t_s_leq_w_161731;
        bool ok_or_empty_161733 = empty_slice_161729 || y_161732;
        bool index_certs_161734;
        
        if (!ok_or_empty_161733) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_93569, "] out of bounds for array of shape [", (long long) data_161359, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:110:32-36\n   #6  ftRelational.fut:107:5-110:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171276, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_93569; i_171043++) {
        int64_t eta_p_161742 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161743 = sle64((int64_t) 0, eta_p_161742);
        bool y_161744 = slt64(eta_p_161742, n_93569);
        bool bounds_check_161745 = x_161743 && y_161744;
        bool index_certs_161746;
        
        if (!bounds_check_161745) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161742, "] out of bounds for array of shape [", (long long) n_93569, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:110:32-36\n   #5  ftRelational.fut:107:5-110:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_161747 = ((int64_t *) k_mem_171274.mem)[eta_p_161742];
        
        ((int64_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161747;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171486.mem, i_171043 * b_93570, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171275.mem, eta_p_161742 * b_93570, (int64_t []) {(int64_t) 1}, (int64_t []) {b_93570});
    }
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172438, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172439, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_172450, struct memblock *mem_out_p_172451, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_88845, int64_t b_88846)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171280_cached_sizze_172452 = 0;
    unsigned char *mem_171280 = NULL;
    int64_t mem_171283_cached_sizze_172453 = 0;
    unsigned char *mem_171283 = NULL;
    int64_t mem_171293_cached_sizze_172454 = 0;
    unsigned char *mem_171293 = NULL;
    int64_t mem_171295_cached_sizze_172455 = 0;
    unsigned char *mem_171295 = NULL;
    int64_t mem_171362_cached_sizze_172456 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171365_cached_sizze_172457 = 0;
    unsigned char *mem_171365 = NULL;
    int64_t mem_171375_cached_sizze_172458 = 0;
    unsigned char *mem_171375 = NULL;
    int64_t mem_171377_cached_sizze_172459 = 0;
    unsigned char *mem_171377 = NULL;
    int64_t mem_171392_cached_sizze_172460 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171395_cached_sizze_172461 = 0;
    unsigned char *mem_171395 = NULL;
    struct memblock mem_171486;
    
    mem_171486.references = NULL;
    
    struct memblock mem_171484;
    
    mem_171484.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_171472;
    
    mem_171472.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171434;
    
    mem_171434.references = NULL;
    
    struct memblock mem_171430;
    
    mem_171430.references = NULL;
    
    struct memblock mem_171439;
    
    mem_171439.references = NULL;
    
    struct memblock mem_171437;
    
    mem_171437.references = NULL;
    
    struct memblock ext_mem_171454;
    
    ext_mem_171454.references = NULL;
    
    struct memblock ext_mem_171457;
    
    ext_mem_171457.references = NULL;
    
    struct memblock mem_param_171359;
    
    mem_param_171359.references = NULL;
    
    struct memblock mem_param_171356;
    
    mem_param_171356.references = NULL;
    
    struct memblock ext_mem_171478;
    
    ext_mem_171478.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock mem_171352;
    
    mem_171352.references = NULL;
    
    struct memblock mem_171348;
    
    mem_171348.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_88845;
    bool cond_161233 = sle64(n_88845, (int64_t) 1);
    int64_t zs_lhs_161234 = sub64(n_88845, (int64_t) 1);
    int64_t zp_rhs_161235 = sdiv_safe64(zs_lhs_161234, (int64_t) 20);
    int64_t min_num_blocks_161236 = add64((int64_t) 1, zp_rhs_161235);
    bool loop_cond_161237 = slt64((int64_t) 1, min_num_blocks_161236);
    bool smallest_pow_2_geq_than_res_161238;
    int64_t smallest_pow_2_geq_than_res_161239;
    bool loop_while_161240;
    int64_t x_161241;
    
    loop_while_161240 = loop_cond_161237;
    x_161241 = (int64_t) 1;
    while (loop_while_161240) {
        int64_t loopres_161242 = mul64((int64_t) 2, x_161241);
        bool loop_cond_161243 = slt64(loopres_161242, min_num_blocks_161236);
        bool loop_while_tmp_171958 = loop_cond_161243;
        int64_t x_tmp_171959 = loopres_161242;
        
        loop_while_161240 = loop_while_tmp_171958;
        x_161241 = x_tmp_171959;
    }
    smallest_pow_2_geq_than_res_161238 = loop_while_161240;
    smallest_pow_2_geq_than_res_161239 = x_161241;
    
    bool zzero_161244 = smallest_pow_2_geq_than_res_161239 == (int64_t) 0;
    bool nonzzero_161245 = !zzero_161244;
    bool protect_assert_disj_161246 = cond_161233 || nonzzero_161245;
    bool nonzzero_cert_161247;
    
    if (!protect_assert_disj_161246) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:102:32-36\n   #5  ftRelational.fut:99:5-102:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161248 = sdiv_safe64(zs_lhs_161234, smallest_pow_2_geq_than_res_161239);
    int64_t block_sizze_161249 = add64((int64_t) 1, zp_rhs_161248);
    bool y_161255 = slt64((int64_t) 0, n_88845);
    bool protect_assert_disj_171871 = cond_161233 || y_161255;
    bool index_certs_161256;
    
    if (!protect_assert_disj_171871) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_88845, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:102:32-36\n   #5  ftRelational.fut:99:5-102:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161270 = slt64(smallest_pow_2_geq_than_res_161239, (int64_t) 0);
    bool valid_161271 = !bounds_invalid_upwards_161270;
    bool protect_assert_disj_171879 = cond_161233 || valid_161271;
    bool range_valid_c_161272;
    
    if (!protect_assert_disj_171879) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161239, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:102:32-36\n   #6  ftRelational.fut:99:5-102:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161274 = slt64(block_sizze_161249, (int64_t) 0);
    bool valid_161275 = !bounds_invalid_upwards_161274;
    bool protect_assert_disj_171881 = cond_161233 || valid_161275;
    bool range_valid_c_161276;
    
    if (!protect_assert_disj_171881) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161249, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161278 = sle64(block_sizze_161249, (int64_t) 1);
    int64_t tmp_161279 = sub64(block_sizze_161249, (int64_t) 2);
    bool bounds_invalid_upwards_161280 = slt64(tmp_161279, (int64_t) 0);
    bool valid_161282 = !bounds_invalid_upwards_161280;
    bool protect_assert_disj_161283 = cond_161278 || valid_161282;
    bool protect_assert_disj_171883 = cond_161233 || protect_assert_disj_161283;
    bool range_valid_c_161284;
    
    if (!protect_assert_disj_171883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161279, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171483 = (int64_t) 2 * n_88845;
    int64_t bytes_171485 = n_88845 * b_88846;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171960 = 0; i_171960 < n_88845; i_171960++) {
        int64_t x_171961 = (int64_t) 0 + i_171960 * (int64_t) 1;
        
        ((int64_t *) mem_171277.mem)[i_171960] = x_171961;
    }
    
    int64_t flat_dim_161250 = smallest_pow_2_geq_than_res_161239 * block_sizze_161249;
    bool x_171866 = !cond_161233;
    int64_t greatest_divisor_leq_than_arg1_161253 = mul64((int64_t) 2, block_sizze_161249);
    int64_t merge_block_sizze_161254;
    
    if (x_171866) {
        int64_t x_171868;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_171868, (int64_t) 8, greatest_divisor_leq_than_arg1_161253) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161254 = x_171868;
    } else {
        merge_block_sizze_161254 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_161257;
    
    if (x_171866) {
        int16_t x_171872 = ((int16_t *) k_mem_171274.mem)[(int64_t) 0];
        
        reduce_arg1_161257 = x_171872;
    } else {
        reduce_arg1_161257 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_162117;
    int64_t defunc_0_reduce_res_162118;
    
    if (x_171866) {
        int16_t x_171874;
        int64_t x_171875;
        int16_t redout_171001;
        int64_t redout_171002;
        
        redout_171001 = reduce_arg1_161257;
        redout_171002 = (int64_t) 0;
        for (int64_t i_171003 = 0; i_171003 < n_88845; i_171003++) {
            int16_t x_161261 = ((int16_t *) k_mem_171274.mem)[i_171003];
            bool defunc_0_leq_res_161267 = sle16(redout_171001, x_161261);
            int16_t defunc_0_op_res_161268;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161268 = x_161261;
            } else {
                defunc_0_op_res_161268 = redout_171001;
            }
            
            int64_t defunc_0_op_res_161269;
            
            if (defunc_0_leq_res_161267) {
                defunc_0_op_res_161269 = i_171003;
            } else {
                defunc_0_op_res_161269 = redout_171002;
            }
            
            int16_t redout_tmp_171962 = defunc_0_op_res_161268;
            int64_t redout_tmp_171963 = defunc_0_op_res_161269;
            
            redout_171001 = redout_tmp_171962;
            redout_171002 = redout_tmp_171963;
        }
        x_171874 = redout_171001;
        x_171875 = redout_171002;
        defunc_0_reduce_res_162117 = x_171874;
        defunc_0_reduce_res_162118 = x_171875;
    } else {
        defunc_0_reduce_res_162117 = (int16_t) 0;
        defunc_0_reduce_res_162118 = (int64_t) 0;
    }
    
    int64_t distance_161281 = add64((int64_t) 1, tmp_161279);
    int64_t binop_x_171278 = (int64_t) 2 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171279 = block_sizze_161249 * binop_x_171278;
    int64_t binop_x_171281 = (int64_t) 8 * smallest_pow_2_geq_than_res_161239;
    int64_t bytes_171282 = block_sizze_161249 * binop_x_171281;
    int64_t bytes_171294 = (int64_t) 8 * block_sizze_161249;
    bool loop_cond_161356 = slt64(block_sizze_161249, flat_dim_161250);
    bool zzero_161357 = merge_block_sizze_161254 == (int64_t) 0;
    bool nonzzero_161358 = !zzero_161357;
    
    if (cond_161233) {
        if (memblock_set(ctx, &ext_mem_171482, &mem_171277, "mem_171277") != 0)
            return 1;
    } else {
        if (mem_171280_cached_sizze_172452 < bytes_171279) {
            err = lexical_realloc(ctx, &mem_171280, &mem_171280_cached_sizze_172452, bytes_171279);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171283_cached_sizze_172453 < bytes_171282) {
            err = lexical_realloc(ctx, &mem_171283, &mem_171283_cached_sizze_172453, bytes_171282);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171293_cached_sizze_172454 < greatest_divisor_leq_than_arg1_161253) {
            err = lexical_realloc(ctx, &mem_171293, &mem_171293_cached_sizze_172454, greatest_divisor_leq_than_arg1_161253);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171295_cached_sizze_172455 < bytes_171294) {
            err = lexical_realloc(ctx, &mem_171295, &mem_171295_cached_sizze_172455, bytes_171294);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171015 = 0; i_171015 < smallest_pow_2_geq_than_res_161239; i_171015++) {
            int64_t zp_lhs_161288 = mul64(block_sizze_161249, i_171015);
            
            for (int64_t i_171008 = 0; i_171008 < block_sizze_161249; i_171008++) {
                int64_t k_161292 = add64(zp_lhs_161288, i_171008);
                bool cond_161293 = slt64(k_161292, n_88845);
                int16_t lifted_lambda_res_161294;
                int64_t lifted_lambda_res_161295;
                
                if (cond_161293) {
                    bool x_161970 = sle64((int64_t) 0, k_161292);
                    bool bounds_check_161971 = cond_161293 && x_161970;
                    bool index_certs_161972;
                    
                    if (!bounds_check_161971) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161292, "] out of bounds for array of shape [", (long long) n_88845, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_161973 = ((int16_t *) k_mem_171274.mem)[k_161292];
                    
                    lifted_lambda_res_161294 = lifted_lambda_res_t_res_161973;
                    lifted_lambda_res_161295 = k_161292;
                } else {
                    lifted_lambda_res_161294 = defunc_0_reduce_res_162117;
                    lifted_lambda_res_161295 = defunc_0_reduce_res_162118;
                }
                ((int16_t *) mem_171293)[i_171008] = lifted_lambda_res_161294;
                ((int64_t *) mem_171295)[i_171008] = lifted_lambda_res_161295;
            }
            if (!cond_161278) {
                for (int64_t i_161305 = 0; i_161305 < distance_161281; i_161305++) {
                    int64_t gt_arg1_161308 = add64((int64_t) 1, i_161305);
                    bool x_161309 = sle64((int64_t) 0, gt_arg1_161308);
                    bool y_161310 = slt64(gt_arg1_161308, block_sizze_161249);
                    bool bounds_check_161311 = x_161309 && y_161310;
                    bool index_certs_161312;
                    
                    if (!bounds_check_161311) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161308, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161314 = slt64(i_161305, block_sizze_161249);
                    bool index_certs_161315;
                    
                    if (!y_161314) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161305, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_161313 = ((int16_t *) mem_171293)[gt_arg1_161308];
                    int16_t gt_arg0_161316 = ((int16_t *) mem_171293)[i_161305];
                    bool defunc_0_leq_res_161317 = sle16(gt_arg0_161316, gt_arg1_161313);
                    bool defunc_0_lifted_gt_res_161318 = !defunc_0_leq_res_161317;
                    bool s_161319;
                    int64_t s_161322;
                    bool loop_while_161323;
                    int64_t j_161326;
                    
                    loop_while_161323 = defunc_0_lifted_gt_res_161318;
                    j_161326 = i_161305;
                    while (loop_while_161323) {
                        bool x_161327 = sle64((int64_t) 0, j_161326);
                        bool y_161328 = slt64(j_161326, block_sizze_161249);
                        bool bounds_check_161329 = x_161327 && y_161328;
                        bool index_certs_161330;
                        
                        if (!bounds_check_161329) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161326, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161333 = add64((int64_t) 1, j_161326);
                        bool x_161334 = sle64((int64_t) 0, copy_arg0_161333);
                        bool y_161335 = slt64(copy_arg0_161333, block_sizze_161249);
                        bool bounds_check_161336 = x_161334 && y_161335;
                        bool index_certs_161337;
                        
                        if (!bounds_check_161336) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161333, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_161331 = ((int16_t *) mem_171293)[j_161326];
                        int64_t copy_arg0_161332 = ((int64_t *) mem_171295)[j_161326];
                        int16_t copy_arg0_161338 = ((int16_t *) mem_171293)[copy_arg0_161333];
                        int64_t copy_arg0_161339 = ((int64_t *) mem_171295)[copy_arg0_161333];
                        
                        ((int16_t *) mem_171293)[j_161326] = copy_arg0_161338;
                        ((int64_t *) mem_171295)[j_161326] = copy_arg0_161339;
                        ((int16_t *) mem_171293)[copy_arg0_161333] = copy_arg0_161331;
                        ((int64_t *) mem_171295)[copy_arg0_161333] = copy_arg0_161332;
                        
                        int64_t tmp_161344 = sub64(j_161326, (int64_t) 1);
                        bool cond_161345 = sle64((int64_t) 0, tmp_161344);
                        bool loop_cond_161346;
                        
                        if (cond_161345) {
                            bool y_161975 = slt64(tmp_161344, block_sizze_161249);
                            bool bounds_check_161976 = cond_161345 && y_161975;
                            bool index_certs_161977;
                            
                            if (!bounds_check_161976) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161344, "] out of bounds for array of shape [", (long long) block_sizze_161249, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_161974 = ((int16_t *) mem_171293)[j_161326];
                            int16_t gt_arg0_161978 = ((int16_t *) mem_171293)[tmp_161344];
                            bool defunc_0_leq_res_161979 = sle16(gt_arg0_161978, gt_arg1_161974);
                            bool defunc_0_lifted_gt_res_161980 = !defunc_0_leq_res_161979;
                            
                            loop_cond_161346 = defunc_0_lifted_gt_res_161980;
                        } else {
                            loop_cond_161346 = 0;
                        }
                        
                        bool loop_while_tmp_171970 = loop_cond_161346;
                        int64_t j_tmp_171973 = tmp_161344;
                        
                        loop_while_161323 = loop_while_tmp_171970;
                        j_161326 = j_tmp_171973;
                    }
                    s_161319 = loop_while_161323;
                    s_161322 = j_161326;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171280, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171293, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171283, i_171015 * block_sizze_161249, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171295, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161249});
        }
        if (memblock_alloc(ctx, &mem_171348, bytes_171279, "mem_171348")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_171348.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint16_t *) mem_171280, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        if (memblock_alloc(ctx, &mem_171352, bytes_171282, "mem_171352")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171352.mem, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (uint64_t *) mem_171283, (int64_t) 0, (int64_t []) {block_sizze_161249, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161239, block_sizze_161249});
        
        int64_t data_161359;
        bool data_161360;
        int64_t data_161363;
        int64_t loop_dz2084Uz2082U_161364;
        bool loop_while_161365;
        int64_t stride_161368;
        
        if (memblock_set(ctx, &mem_param_171356, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171359, &mem_171352, "mem_171352") != 0)
            return 1;
        loop_dz2084Uz2082U_161364 = flat_dim_161250;
        loop_while_161365 = loop_cond_161356;
        stride_161368 = block_sizze_161249;
        while (loop_while_161365) {
            int64_t next_stride_161369 = mul64((int64_t) 2, stride_161368);
            bool zzero_161370 = next_stride_161369 == (int64_t) 0;
            bool nonzzero_161371 = !zzero_161370;
            bool nonzzero_cert_161372;
            
            if (!nonzzero_161371) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:102:32-36\n   #5  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161373 = sdiv64(flat_dim_161250, next_stride_161369);
            bool bounds_invalid_upwards_161374 = slt64(num_merges_161373, (int64_t) 0);
            bool valid_161375 = !bounds_invalid_upwards_161374;
            bool range_valid_c_161376;
            
            if (!valid_161375) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161373, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:102:32-36\n   #6  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161378 = sub64(next_stride_161369, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161379 = sle64((int64_t) 0, m_161378);
            bool cond_161381 = slt64(next_stride_161369, (int64_t) 10);
            bool protect_assert_disj_161382 = nonzzero_161358 || cond_161381;
            bool nonzzero_cert_161383;
            
            if (!protect_assert_disj_161382) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161384 = smod_safe64(next_stride_161369, merge_block_sizze_161254);
            bool num_blocks_161385 = zeze_lhs_161384 == (int64_t) 0;
            bool protect_assert_disj_161386 = cond_161381 || num_blocks_161385;
            bool assert_c_161387;
            
            if (!protect_assert_disj_161386) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161389 = sdiv_safe64(next_stride_161369, merge_block_sizze_161254);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390 = add64((int64_t) 1, num_blocks_161389);
            int64_t j_m_i_161391 = sub64(next_stride_161369, stride_161368);
            int64_t flat_dim_161392 = merge_block_sizze_161254 * num_blocks_161389;
            bool bounds_invalid_upwards_161393 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, (int64_t) 0);
            bool empty_slice_161394 = j_m_i_161391 == (int64_t) 0;
            int64_t m_161395 = sub64(j_m_i_161391, (int64_t) 1);
            bool zzero_lte_i_161396 = sle64((int64_t) 0, stride_161368);
            bool i_lte_j_161397 = sle64(stride_161368, next_stride_161369);
            bool empty_slice_161398 = stride_161368 == (int64_t) 0;
            int64_t m_161399 = sub64(stride_161368, (int64_t) 1);
            bool bounds_invalid_upwards_161400 = slt64(num_blocks_161389, (int64_t) 0);
            bool cond_161401 = slt64((int64_t) 0, stride_161368);
            bool valid_161402 = !bounds_invalid_upwards_161393;
            int64_t i_p_m_t_s_161403 = add64(stride_161368, m_161395);
            bool zzero_leq_i_p_m_t_s_161404 = sle64((int64_t) 0, m_161399);
            bool i_p_m_t_s_leq_w_161405 = slt64(m_161399, next_stride_161369);
            bool valid_161406 = !bounds_invalid_upwards_161400;
            bool i_p_m_t_s_leq_w_161407 = slt64(m_161378, flat_dim_161392);
            bool y_161408 = slt64((int64_t) 0, j_m_i_161391);
            bool protect_assert_disj_161409 = cond_161381 || valid_161402;
            bool range_valid_c_161410;
            
            if (!protect_assert_disj_161409) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:102:32-36\n   #10 ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161411 = sle64((int64_t) 0, i_p_m_t_s_161403);
            bool i_p_m_t_s_leq_w_161412 = slt64(i_p_m_t_s_161403, next_stride_161369);
            bool y_161413 = zzero_leq_i_p_m_t_s_161404 && i_p_m_t_s_leq_w_161405;
            bool protect_assert_disj_161414 = cond_161381 || valid_161406;
            bool range_valid_c_161415;
            
            if (!protect_assert_disj_161414) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161389, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161416 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161407;
            bool y_161417 = zzero_lte_i_161396 && i_p_m_t_s_leq_w_161412;
            bool forwards_ok_161418 = zzero_lte_i_161396 && y_161413;
            bool ok_or_empty_161419 = zzero_161370 || y_161416;
            bool protect_assert_disj_161420 = cond_161401 || y_161408;
            bool y_161421 = zzero_leq_i_p_m_t_s_161411 && y_161417;
            bool ok_or_empty_161422 = empty_slice_161398 || forwards_ok_161418;
            bool protect_assert_disj_161423 = cond_161381 || ok_or_empty_161419;
            bool index_certs_161424;
            
            if (!protect_assert_disj_161423) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) flat_dim_161392, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161425 = !cond_161381;
            bool protect_assert_disj_161426 = protect_assert_disj_161420 || loop_not_taken_161425;
            bool index_certs_161427;
            
            if (!protect_assert_disj_161426) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:102:32-36\n   #10 ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161428 = i_lte_j_161397 && y_161421;
            bool protect_assert_disj_161429 = cond_161381 || ok_or_empty_161422;
            bool index_certs_161430;
            
            if (!protect_assert_disj_161429) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:102:32-36\n   #11 ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161431 = ok_or_empty_161422 || loop_not_taken_161425;
            bool index_certs_161432;
            
            if (!protect_assert_disj_161431) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161368, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161433 = empty_slice_161394 || forwards_ok_161428;
            bool protect_assert_disj_161434 = cond_161381 || ok_or_empty_161433;
            bool index_certs_161435;
            
            if (!protect_assert_disj_161434) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:102:32-36\n   #11 ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161436 = loop_not_taken_161425 || ok_or_empty_161433;
            bool index_certs_161437;
            
            if (!protect_assert_disj_161436) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161368, ":] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171360 = (int64_t) 2 * num_merges_161373;
            int64_t bytes_171361 = next_stride_161369 * binop_x_171360;
            int64_t binop_x_171363 = (int64_t) 8 * num_merges_161373;
            int64_t bytes_171364 = next_stride_161369 * binop_x_171363;
            bool i_lte_j_161380 = sle64((int64_t) 0, next_stride_161369);
            
            if (mem_171362_cached_sizze_172456 < bytes_171361) {
                err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172456, bytes_171361);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171365_cached_sizze_172457 < bytes_171364) {
                err = lexical_realloc(ctx, &mem_171365, &mem_171365_cached_sizze_172457, bytes_171364);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171374 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390;
            int64_t binop_x_171390 = (int64_t) 2 * num_blocks_161389;
            int64_t bytes_171391 = merge_block_sizze_161254 * binop_x_171390;
            int64_t binop_x_171393 = (int64_t) 8 * num_blocks_161389;
            int64_t bytes_171394 = merge_block_sizze_161254 * binop_x_171393;
            int64_t bytes_171436 = (int64_t) 4 * stride_161368;
            int64_t bytes_171438 = (int64_t) 16 * stride_161368;
            
            for (int64_t i_171036 = 0; i_171036 < num_merges_161373; i_171036++) {
                int64_t start_161441 = mul64(next_stride_161369, i_171036);
                int64_t j_m_i_161442 = sub64(loop_dz2084Uz2082U_161364, start_161441);
                bool empty_slice_161443 = j_m_i_161442 == (int64_t) 0;
                int64_t m_161444 = sub64(j_m_i_161442, (int64_t) 1);
                int64_t i_p_m_t_s_161445 = add64(start_161441, m_161444);
                bool zzero_leq_i_p_m_t_s_161446 = sle64((int64_t) 0, i_p_m_t_s_161445);
                bool i_p_m_t_s_leq_w_161447 = slt64(i_p_m_t_s_161445, loop_dz2084Uz2082U_161364);
                bool zzero_lte_i_161448 = sle64((int64_t) 0, start_161441);
                bool i_lte_j_161449 = sle64(start_161441, loop_dz2084Uz2082U_161364);
                bool y_161450 = i_p_m_t_s_leq_w_161447 && zzero_lte_i_161448;
                bool y_161451 = zzero_leq_i_p_m_t_s_161446 && y_161450;
                bool forwards_ok_161452 = i_lte_j_161449 && y_161451;
                bool ok_or_empty_161453 = empty_slice_161443 || forwards_ok_161452;
                bool index_certs_161454;
                
                if (!ok_or_empty_161453) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161441, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161364, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161455 = slt64(m_161378, j_m_i_161442);
                bool y_161456 = zzero_leq_i_p_m_t_s_161379 && i_p_m_t_s_leq_w_161455;
                bool forwards_ok_161457 = i_lte_j_161380 && y_161456;
                bool ok_or_empty_161458 = zzero_161370 || forwards_ok_161457;
                bool index_certs_161459;
                
                if (!ok_or_empty_161458) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161369, "] out of bounds for array of shape [", (long long) j_m_i_161442, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:102:32-36\n   #8  ftRelational.fut:99:5-102:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161381) {
                    int16_t dummy_162006;
                    int64_t dummy_162007;
                    
                    if (cond_161401) {
                        int16_t head_res_162008 = ((int16_t *) mem_param_171356.mem)[start_161441];
                        int64_t head_res_162009 = ((int64_t *) mem_param_171359.mem)[start_161441];
                        
                        dummy_162006 = head_res_162008;
                        dummy_162007 = head_res_162009;
                    } else {
                        int64_t slice_162010 = stride_161368 + start_161441;
                        int16_t head_res_162011 = ((int16_t *) mem_param_171356.mem)[slice_162010];
                        int64_t head_res_162012 = ((int64_t *) mem_param_171359.mem)[slice_162010];
                        
                        dummy_162006 = head_res_162011;
                        dummy_162007 = head_res_162012;
                    }
                    if (memblock_alloc(ctx, &mem_171437, bytes_171436, "mem_171437")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171983 = 0; nest_i_171983 < next_stride_161369; nest_i_171983++) {
                        ((int16_t *) mem_171437.mem)[nest_i_171983] = dummy_162006;
                    }
                    if (memblock_alloc(ctx, &mem_171439, bytes_171438, "mem_171439")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_171984 = 0; nest_i_171984 < next_stride_161369; nest_i_171984++) {
                        ((int64_t *) mem_171439.mem)[nest_i_171984] = dummy_162007;
                    }
                    
                    int64_t data_162015;
                    int64_t i_162019 = (int64_t) 0;
                    
                    for (int64_t k_162018 = 0; k_162018 < next_stride_161369; k_162018++) {
                        int64_t j_162022 = sub64(k_162018, i_162019);
                        bool cond_162023 = j_162022 == j_m_i_161391;
                        bool cond_162024;
                        
                        if (cond_162023) {
                            cond_162024 = 1;
                        } else {
                            bool cond_162025 = slt64(i_162019, stride_161368);
                            bool cond_f_res_162026;
                            
                            if (cond_162025) {
                                bool x_162027 = sle64((int64_t) 0, j_162022);
                                bool y_162028 = slt64(j_162022, j_m_i_161391);
                                bool bounds_check_162029 = x_162027 && y_162028;
                                bool index_certs_162030;
                                
                                if (!bounds_check_162029) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162034 = sle64((int64_t) 0, i_162019);
                                bool bounds_check_162035 = cond_162025 && x_162034;
                                bool index_certs_162036;
                                
                                if (!bounds_check_162035) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162031 = stride_161368 + j_162022;
                                int64_t slice_162032 = start_161441 + slice_162031;
                                int16_t leq_arg1_162033 = ((int16_t *) mem_param_171356.mem)[slice_162032];
                                int64_t slice_162037 = start_161441 + i_162019;
                                int16_t leq_arg0_162038 = ((int16_t *) mem_param_171356.mem)[slice_162037];
                                bool defunc_0_leq_res_162039 = sle16(leq_arg0_162038, leq_arg1_162033);
                                
                                cond_f_res_162026 = defunc_0_leq_res_162039;
                            } else {
                                cond_f_res_162026 = 0;
                            }
                            cond_162024 = cond_f_res_162026;
                        }
                        
                        int64_t loopres_162040;
                        int16_t loopres_162041;
                        int64_t loopres_162042;
                        
                        if (cond_162024) {
                            bool x_162044 = sle64((int64_t) 0, i_162019);
                            bool y_162045 = slt64(i_162019, stride_161368);
                            bool bounds_check_162046 = x_162044 && y_162045;
                            bool index_certs_162047;
                            
                            if (!bounds_check_162046) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162019, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162043 = add64((int64_t) 1, i_162019);
                            int64_t slice_162048 = start_161441 + i_162019;
                            int16_t tmp_162049 = ((int16_t *) mem_param_171356.mem)[slice_162048];
                            int64_t tmp_162050 = ((int64_t *) mem_param_171359.mem)[slice_162048];
                            
                            loopres_162040 = tmp_162043;
                            loopres_162041 = tmp_162049;
                            loopres_162042 = tmp_162050;
                        } else {
                            bool x_162051 = sle64((int64_t) 0, j_162022);
                            bool y_162052 = slt64(j_162022, j_m_i_161391);
                            bool bounds_check_162053 = x_162051 && y_162052;
                            bool index_certs_162054;
                            
                            if (!bounds_check_162053) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162022, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:102:32-36\n   #9  ftRelational.fut:99:5-102:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162055 = stride_161368 + j_162022;
                            int64_t slice_162056 = start_161441 + slice_162055;
                            int16_t tmp_162057 = ((int16_t *) mem_param_171356.mem)[slice_162056];
                            int64_t tmp_162058 = ((int64_t *) mem_param_171359.mem)[slice_162056];
                            
                            loopres_162040 = i_162019;
                            loopres_162041 = tmp_162057;
                            loopres_162042 = tmp_162058;
                        }
                        ((int16_t *) mem_171437.mem)[k_162018] = loopres_162041;
                        ((int64_t *) mem_171439.mem)[k_162018] = loopres_162042;
                        
                        int64_t i_tmp_171985 = loopres_162040;
                        
                        i_162019 = i_tmp_171985;
                    }
                    data_162015 = i_162019;
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171437, "mem_171437") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171439, "mem_171439") != 0)
                        return 1;
                } else {
                    if (mem_171375_cached_sizze_172458 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171375, &mem_171375_cached_sizze_172458, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171377_cached_sizze_172459 < bytes_171374) {
                        err = lexical_realloc(ctx, &mem_171377, &mem_171377_cached_sizze_172459, bytes_171374);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171022 = 0; i_171022 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390; i_171022++) {
                        int64_t split_count_arg3_161521 = mul64(merge_block_sizze_161254, i_171022);
                        int64_t defunc_0_split_count_res_161522;
                        int64_t defunc_0_split_count_res_161523;
                        int64_t defunc_0_split_count_res_161524;
                        int64_t defunc_0_split_count_res_161525;
                        int64_t defunc_0_split_count_res_161526;
                        
                        if (futrts_lifted_normalizze_15223(ctx, &defunc_0_split_count_res_161522, &defunc_0_split_count_res_161523, &defunc_0_split_count_res_161524, &defunc_0_split_count_res_161525, &defunc_0_split_count_res_161526, (int64_t) 0, stride_161368, (int64_t) 0, j_m_i_161391, split_count_arg3_161521) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_161527 = slt64((int64_t) 0, defunc_0_split_count_res_161526);
                        bool defunc_0_split_count_res_161528;
                        int64_t defunc_0_split_count_res_161529;
                        int64_t defunc_0_split_count_res_161530;
                        int64_t defunc_0_split_count_res_161531;
                        int64_t defunc_0_split_count_res_161532;
                        int64_t defunc_0_split_count_res_161533;
                        bool loop_while_161534;
                        int64_t ss_161535;
                        int64_t ss_161536;
                        int64_t tt_161537;
                        int64_t tt_161538;
                        int64_t count_161539;
                        
                        loop_while_161534 = loop_cond_161527;
                        ss_161535 = defunc_0_split_count_res_161522;
                        ss_161536 = defunc_0_split_count_res_161523;
                        tt_161537 = defunc_0_split_count_res_161524;
                        tt_161538 = defunc_0_split_count_res_161525;
                        count_161539 = defunc_0_split_count_res_161526;
                        while (loop_while_161534) {
                            int64_t zlze_lhs_161540 = sub64(ss_161536, ss_161535);
                            bool cond_161541 = sle64(zlze_lhs_161540, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_161542;
                            int64_t defunc_0_lifted_step_res_161543;
                            int64_t defunc_0_lifted_step_res_161544;
                            int64_t defunc_0_lifted_step_res_161545;
                            
                            if (cond_161541) {
                                int64_t tmp_162061 = add64(tt_161537, count_161539);
                                
                                defunc_0_lifted_step_res_161542 = ss_161535;
                                defunc_0_lifted_step_res_161543 = tmp_162061;
                                defunc_0_lifted_step_res_161544 = tt_161538;
                                defunc_0_lifted_step_res_161545 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_161547 = sub64(tt_161538, tt_161537);
                                bool cond_161548 = sle64(zlze_lhs_161547, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_161549;
                                int64_t defunc_0_lifted_step_res_f_res_161550;
                                int64_t defunc_0_lifted_step_res_f_res_161551;
                                int64_t defunc_0_lifted_step_res_f_res_161552;
                                
                                if (cond_161548) {
                                    int64_t tmp_162062 = add64(ss_161535, count_161539);
                                    
                                    defunc_0_lifted_step_res_f_res_161549 = tmp_162062;
                                    defunc_0_lifted_step_res_f_res_161550 = tt_161537;
                                    defunc_0_lifted_step_res_f_res_161551 = tt_161538;
                                    defunc_0_lifted_step_res_f_res_161552 = (int64_t) 0;
                                } else {
                                    bool cond_161554 = count_161539 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161555;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161556;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161557;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_161558;
                                    
                                    if (cond_161554) {
                                        bool x_162064 = sle64((int64_t) 0, ss_161535);
                                        bool y_162065 = slt64(ss_161535, stride_161368);
                                        bool bounds_check_162066 = x_162064 && y_162065;
                                        bool index_certs_162067;
                                        
                                        if (!bounds_check_162066) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_161535, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:102:32-36\n   #13 ftRelational.fut:99:5-102:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162070 = sle64((int64_t) 0, tt_161537);
                                        bool y_162071 = slt64(tt_161537, j_m_i_161391);
                                        bool bounds_check_162072 = x_162070 && y_162071;
                                        bool index_certs_162073;
                                        
                                        if (!bounds_check_162072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_161537, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:102:32-36\n   #13 ftRelational.fut:99:5-102:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162068 = start_161441 + ss_161535;
                                        int16_t leq_arg1_162069 = ((int16_t *) mem_param_171356.mem)[slice_162068];
                                        int64_t slice_162074 = stride_161368 + tt_161537;
                                        int64_t slice_162075 = start_161441 + slice_162074;
                                        int16_t leq_arg0_162076 = ((int16_t *) mem_param_171356.mem)[slice_162075];
                                        bool defunc_0_leq_res_162077 = sle16(leq_arg0_162076, leq_arg1_162069);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        
                                        if (defunc_0_leq_res_162077) {
                                            int64_t tmp_162080 = add64((int64_t) 1, tt_161537);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = ss_161535;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tmp_162080;
                                        } else {
                                            int64_t tmp_162081 = add64((int64_t) 1, ss_161535);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162078 = tmp_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162079 = tt_161537;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = defunc_0_lifted_step_res_f_res_f_res_t_res_162078;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_t_res_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = tt_161538;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = (int64_t) 0;
                                    } else {
                                        int64_t m_161577 = sdiv64(count_161539, (int64_t) 2);
                                        int64_t n_161578 = sub64(count_161539, m_161577);
                                        bool cond_161579 = n_161578 == (int64_t) 0;
                                        int64_t zgze_lhs_161580 = add64(ss_161535, m_161577);
                                        bool cond_f_res_161581 = sle64(ss_161536, zgze_lhs_161580);
                                        bool x_161582 = !cond_161579;
                                        bool y_161583 = cond_f_res_161581 && x_161582;
                                        bool cond_161584 = cond_161579 || y_161583;
                                        bool leq_y_x_161585;
                                        
                                        if (cond_161584) {
                                            leq_y_x_161585 = 1;
                                        } else {
                                            bool x_161586 = sle64((int64_t) 0, zgze_lhs_161580);
                                            bool y_161587 = slt64(zgze_lhs_161580, stride_161368);
                                            bool bounds_check_161588 = x_161586 && y_161587;
                                            bool index_certs_161589;
                                            
                                            if (!bounds_check_161588) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_161580, "] out of bounds for array of shape [", (long long) stride_161368, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:102:32-36\n   #13 ftRelational.fut:99:5-102:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_161592 = add64(tt_161537, n_161578);
                                            int64_t leq_arg0_161593 = sub64(zm_lhs_161592, (int64_t) 1);
                                            bool x_161594 = sle64((int64_t) 0, leq_arg0_161593);
                                            bool y_161595 = slt64(leq_arg0_161593, j_m_i_161391);
                                            bool bounds_check_161596 = x_161594 && y_161595;
                                            bool index_certs_161597;
                                            
                                            if (!bounds_check_161596) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_161593, "] out of bounds for array of shape [", (long long) j_m_i_161391, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:102:32-36\n   #13 ftRelational.fut:99:5-102:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_161590 = start_161441 + zgze_lhs_161580;
                                            int16_t leq_arg1_161591 = ((int16_t *) mem_param_171356.mem)[slice_161590];
                                            int64_t slice_161598 = stride_161368 + leq_arg0_161593;
                                            int64_t slice_161599 = start_161441 + slice_161598;
                                            int16_t leq_arg0_161600 = ((int16_t *) mem_param_171356.mem)[slice_161599];
                                            bool defunc_0_leq_res_161601 = sle16(leq_arg0_161600, leq_arg1_161591);
                                            
                                            leq_y_x_161585 = defunc_0_leq_res_161601;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                        
                                        if (leq_y_x_161585) {
                                            int64_t tmp_162082 = add64(tt_161537, n_161578);
                                            int64_t tmp_162083 = sub64(count_161539, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tmp_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tt_161538;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = tmp_162083;
                                        } else {
                                            int64_t tmp_161607 = add64(tt_161537, n_161578);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161602 = tt_161537;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161603 = tmp_161607;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_161604 = count_161539;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_161555 = ss_161535;
                                        defunc_0_lifted_step_res_f_res_f_res_161556 = defunc_0_lifted_step_res_f_res_f_res_f_res_161602;
                                        defunc_0_lifted_step_res_f_res_f_res_161557 = defunc_0_lifted_step_res_f_res_f_res_f_res_161603;
                                        defunc_0_lifted_step_res_f_res_f_res_161558 = defunc_0_lifted_step_res_f_res_f_res_f_res_161604;
                                    }
                                    defunc_0_lifted_step_res_f_res_161549 = defunc_0_lifted_step_res_f_res_f_res_161555;
                                    defunc_0_lifted_step_res_f_res_161550 = defunc_0_lifted_step_res_f_res_f_res_161556;
                                    defunc_0_lifted_step_res_f_res_161551 = defunc_0_lifted_step_res_f_res_f_res_161557;
                                    defunc_0_lifted_step_res_f_res_161552 = defunc_0_lifted_step_res_f_res_f_res_161558;
                                }
                                defunc_0_lifted_step_res_161542 = defunc_0_lifted_step_res_f_res_161549;
                                defunc_0_lifted_step_res_161543 = defunc_0_lifted_step_res_f_res_161550;
                                defunc_0_lifted_step_res_161544 = defunc_0_lifted_step_res_f_res_161551;
                                defunc_0_lifted_step_res_161545 = defunc_0_lifted_step_res_f_res_161552;
                            }
                            
                            int64_t loopres_161608;
                            int64_t loopres_161609;
                            int64_t loopres_161610;
                            int64_t loopres_161611;
                            int64_t loopres_161612;
                            
                            if (futrts_lifted_normalizze_15223(ctx, &loopres_161608, &loopres_161609, &loopres_161610, &loopres_161611, &loopres_161612, defunc_0_lifted_step_res_161542, ss_161536, defunc_0_lifted_step_res_161543, defunc_0_lifted_step_res_161544, defunc_0_lifted_step_res_161545) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_161613 = slt64((int64_t) 0, loopres_161612);
                            bool loop_while_tmp_171990 = loop_cond_161613;
                            int64_t ss_tmp_171991 = loopres_161608;
                            int64_t ss_tmp_171992 = loopres_161609;
                            int64_t tt_tmp_171993 = loopres_161610;
                            int64_t tt_tmp_171994 = loopres_161611;
                            int64_t count_tmp_171995 = loopres_161612;
                            
                            loop_while_161534 = loop_while_tmp_171990;
                            ss_161535 = ss_tmp_171991;
                            ss_161536 = ss_tmp_171992;
                            tt_161537 = tt_tmp_171993;
                            tt_161538 = tt_tmp_171994;
                            count_161539 = count_tmp_171995;
                        }
                        defunc_0_split_count_res_161528 = loop_while_161534;
                        defunc_0_split_count_res_161529 = ss_161535;
                        defunc_0_split_count_res_161530 = ss_161536;
                        defunc_0_split_count_res_161531 = tt_161537;
                        defunc_0_split_count_res_161532 = tt_161538;
                        defunc_0_split_count_res_161533 = count_161539;
                        ((int64_t *) mem_171375)[i_171022] = defunc_0_split_count_res_161529;
                        ((int64_t *) mem_171377)[i_171022] = defunc_0_split_count_res_161531;
                    }
                    if (mem_171392_cached_sizze_172460 < bytes_171391) {
                        err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172460, bytes_171391);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171395_cached_sizze_172461 < bytes_171394) {
                        err = lexical_realloc(ctx, &mem_171395, &mem_171395_cached_sizze_172461, bytes_171394);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171029 = 0; i_171029 < num_blocks_161389; i_171029++) {
                        bool y_161619 = slt64(i_171029, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool index_certs_161621;
                        
                        if (!y_161619) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171029, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:102:32-36\n   #10 ftRelational.fut:99:5-102:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161622 = ((int64_t *) mem_171375)[i_171029];
                        int64_t defunc_0_f_res_161623 = ((int64_t *) mem_171377)[i_171029];
                        int64_t tmp_161624 = add64((int64_t) 1, i_171029);
                        bool x_161625 = sle64((int64_t) 0, tmp_161624);
                        bool y_161626 = slt64(tmp_161624, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390);
                        bool bounds_check_161627 = x_161625 && y_161626;
                        bool index_certs_161628;
                        
                        if (!bounds_check_161627) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161624, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:102:32-36\n   #10 ftRelational.fut:99:5-102:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_161629 = ((int64_t *) mem_171375)[tmp_161624];
                        int64_t defunc_0_f_res_161630 = ((int64_t *) mem_171377)[tmp_161624];
                        int64_t merge_sequential_arg2_161631 = add64(stride_161368, defunc_0_f_res_161623);
                        int64_t merge_sequential_arg2_161632 = add64(stride_161368, defunc_0_f_res_161630);
                        int64_t j_m_i_161633 = sub64(merge_sequential_arg2_161632, merge_sequential_arg2_161631);
                        bool empty_slice_161634 = j_m_i_161633 == (int64_t) 0;
                        int64_t m_161635 = sub64(j_m_i_161633, (int64_t) 1);
                        int64_t i_p_m_t_s_161636 = add64(merge_sequential_arg2_161631, m_161635);
                        bool zzero_leq_i_p_m_t_s_161637 = sle64((int64_t) 0, i_p_m_t_s_161636);
                        bool i_p_m_t_s_leq_w_161638 = slt64(i_p_m_t_s_161636, next_stride_161369);
                        bool zzero_lte_i_161639 = sle64((int64_t) 0, merge_sequential_arg2_161631);
                        bool i_lte_j_161640 = sle64(merge_sequential_arg2_161631, merge_sequential_arg2_161632);
                        bool y_161641 = i_p_m_t_s_leq_w_161638 && zzero_lte_i_161639;
                        bool y_161642 = zzero_leq_i_p_m_t_s_161637 && y_161641;
                        bool forwards_ok_161643 = i_lte_j_161640 && y_161642;
                        bool ok_or_empty_161644 = empty_slice_161634 || forwards_ok_161643;
                        bool index_certs_161645;
                        
                        if (!ok_or_empty_161644) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_161631, ":", (long long) merge_sequential_arg2_161632, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:102:32-36\n   #10 ftRelational.fut:99:5-102:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_161646 = sub64(defunc_0_f_res_161629, defunc_0_f_res_161622);
                        bool empty_slice_161647 = j_m_i_161646 == (int64_t) 0;
                        int64_t m_161648 = sub64(j_m_i_161646, (int64_t) 1);
                        int64_t i_p_m_t_s_161649 = add64(defunc_0_f_res_161622, m_161648);
                        bool zzero_leq_i_p_m_t_s_161650 = sle64((int64_t) 0, i_p_m_t_s_161649);
                        bool i_p_m_t_s_leq_w_161651 = slt64(i_p_m_t_s_161649, next_stride_161369);
                        bool zzero_lte_i_161652 = sle64((int64_t) 0, defunc_0_f_res_161622);
                        bool i_lte_j_161653 = sle64(defunc_0_f_res_161622, defunc_0_f_res_161629);
                        bool y_161654 = i_p_m_t_s_leq_w_161651 && zzero_lte_i_161652;
                        bool y_161655 = zzero_leq_i_p_m_t_s_161650 && y_161654;
                        bool forwards_ok_161656 = i_lte_j_161653 && y_161655;
                        bool ok_or_empty_161657 = empty_slice_161647 || forwards_ok_161656;
                        bool index_certs_161658;
                        
                        if (!ok_or_empty_161657) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_161622, ":", (long long) defunc_0_f_res_161629, "] out of bounds for array of shape [", (long long) next_stride_161369, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:102:32-36\n   #10 ftRelational.fut:99:5-102:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_161659 = slt64((int64_t) 0, j_m_i_161646);
                        int16_t dummy_161660;
                        int64_t dummy_161661;
                        
                        if (cond_161659) {
                            bool index_certs_162084;
                            
                            if (!cond_161659) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:102:32-36\n   #12 ftRelational.fut:99:5-102:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162085 = start_161441 + defunc_0_f_res_161622;
                            int16_t head_res_162086 = ((int16_t *) mem_param_171356.mem)[slice_162085];
                            int64_t head_res_162087 = ((int64_t *) mem_param_171359.mem)[slice_162085];
                            
                            dummy_161660 = head_res_162086;
                            dummy_161661 = head_res_162087;
                        } else {
                            bool y_161666 = slt64((int64_t) 0, j_m_i_161633);
                            bool index_certs_161667;
                            
                            if (!y_161666) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:102:32-36\n   #12 ftRelational.fut:99:5-102:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_161668 = start_161441 + merge_sequential_arg2_161631;
                            int16_t head_res_161669 = ((int16_t *) mem_param_171356.mem)[slice_161668];
                            int64_t head_res_161670 = ((int64_t *) mem_param_171359.mem)[slice_161668];
                            
                            dummy_161660 = head_res_161669;
                            dummy_161661 = head_res_161670;
                        }
                        for (int64_t nest_i_171998 = 0; nest_i_171998 < merge_block_sizze_161254; nest_i_171998++) {
                            ((int16_t *) mem_171392)[i_171029 * merge_block_sizze_161254 + nest_i_171998] = dummy_161660;
                        }
                        for (int64_t nest_i_171999 = 0; nest_i_171999 < merge_block_sizze_161254; nest_i_171999++) {
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + nest_i_171999] = dummy_161661;
                        }
                        
                        int64_t data_161673;
                        int64_t i_161677 = (int64_t) 0;
                        
                        for (int64_t k_161676 = 0; k_161676 < merge_block_sizze_161254; k_161676++) {
                            int64_t j_161680 = sub64(k_161676, i_161677);
                            bool cond_161681 = j_161680 == j_m_i_161633;
                            bool cond_161682;
                            
                            if (cond_161681) {
                                cond_161682 = 1;
                            } else {
                                bool cond_161683 = slt64(i_161677, j_m_i_161646);
                                bool cond_f_res_161684;
                                
                                if (cond_161683) {
                                    bool x_162088 = sle64((int64_t) 0, j_161680);
                                    bool y_162089 = slt64(j_161680, j_m_i_161633);
                                    bool bounds_check_162090 = x_162088 && y_162089;
                                    bool index_certs_162091;
                                    
                                    if (!bounds_check_162090) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:102:32-36\n   #11 ftRelational.fut:99:5-102:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162095 = sle64((int64_t) 0, i_161677);
                                    bool bounds_check_162096 = cond_161683 && x_162095;
                                    bool index_certs_162097;
                                    
                                    if (!bounds_check_162096) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:102:32-36\n   #11 ftRelational.fut:99:5-102:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162092 = merge_sequential_arg2_161631 + j_161680;
                                    int64_t slice_162093 = start_161441 + slice_162092;
                                    int16_t leq_arg1_162094 = ((int16_t *) mem_param_171356.mem)[slice_162093];
                                    int64_t slice_162098 = defunc_0_f_res_161622 + i_161677;
                                    int64_t slice_162099 = start_161441 + slice_162098;
                                    int16_t leq_arg0_162100 = ((int16_t *) mem_param_171356.mem)[slice_162099];
                                    bool defunc_0_leq_res_162101 = sle16(leq_arg0_162100, leq_arg1_162094);
                                    
                                    cond_f_res_161684 = defunc_0_leq_res_162101;
                                } else {
                                    cond_f_res_161684 = 0;
                                }
                                cond_161682 = cond_f_res_161684;
                            }
                            
                            int64_t loopres_161699;
                            int16_t loopres_161700;
                            int64_t loopres_161701;
                            
                            if (cond_161682) {
                                bool x_162103 = sle64((int64_t) 0, i_161677);
                                bool y_162104 = slt64(i_161677, j_m_i_161646);
                                bool bounds_check_162105 = x_162103 && y_162104;
                                bool index_certs_162106;
                                
                                if (!bounds_check_162105) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161677, "] out of bounds for array of shape [", (long long) j_m_i_161646, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:102:32-36\n   #11 ftRelational.fut:99:5-102:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162102 = add64((int64_t) 1, i_161677);
                                int64_t slice_162107 = defunc_0_f_res_161622 + i_161677;
                                int64_t slice_162108 = start_161441 + slice_162107;
                                int16_t tmp_162109 = ((int16_t *) mem_param_171356.mem)[slice_162108];
                                int64_t tmp_162110 = ((int64_t *) mem_param_171359.mem)[slice_162108];
                                
                                loopres_161699 = tmp_162102;
                                loopres_161700 = tmp_162109;
                                loopres_161701 = tmp_162110;
                            } else {
                                bool x_161711 = sle64((int64_t) 0, j_161680);
                                bool y_161712 = slt64(j_161680, j_m_i_161633);
                                bool bounds_check_161713 = x_161711 && y_161712;
                                bool index_certs_161714;
                                
                                if (!bounds_check_161713) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161680, "] out of bounds for array of shape [", (long long) j_m_i_161633, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:102:32-36\n   #11 ftRelational.fut:99:5-102:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_161715 = merge_sequential_arg2_161631 + j_161680;
                                int64_t slice_161716 = start_161441 + slice_161715;
                                int16_t tmp_161717 = ((int16_t *) mem_param_171356.mem)[slice_161716];
                                int64_t tmp_161718 = ((int64_t *) mem_param_171359.mem)[slice_161716];
                                
                                loopres_161699 = i_161677;
                                loopres_161700 = tmp_161717;
                                loopres_161701 = tmp_161718;
                            }
                            ((int16_t *) mem_171392)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161700;
                            ((int64_t *) mem_171395)[i_171029 * merge_block_sizze_161254 + k_161676] = loopres_161701;
                            
                            int64_t i_tmp_172000 = loopres_161699;
                            
                            i_161677 = i_tmp_172000;
                        }
                        data_161673 = i_161677;
                    }
                    if (memblock_alloc(ctx, &mem_171430, bytes_171391, "mem_171430")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_171430.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint16_t *) mem_171392, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_alloc(ctx, &mem_171434, bytes_171394, "mem_171434")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171434.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (uint64_t *) mem_171395, (int64_t) 0, (int64_t []) {merge_block_sizze_161254, (int64_t) 1}, (int64_t []) {num_blocks_161389, merge_block_sizze_161254});
                    if (memblock_set(ctx, &ext_mem_171457, &mem_171430, "mem_171430") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171454, &mem_171434, "mem_171434") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_171362, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171457.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171365, i_171036 * next_stride_161369, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171454.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161369});
                if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
                    return 1;
            }
            
            int64_t flat_dim_161725 = next_stride_161369 * num_merges_161373;
            
            if (memblock_alloc(ctx, &mem_171468, bytes_171361, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_171468.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint16_t *) mem_171362, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            if (memblock_alloc(ctx, &mem_171472, bytes_171364, "mem_171472")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_171472.mem, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (uint64_t *) mem_171365, (int64_t) 0, (int64_t []) {next_stride_161369, (int64_t) 1}, (int64_t []) {num_merges_161373, next_stride_161369});
            
            bool loop_cond_161728 = slt64(next_stride_161369, flat_dim_161250);
            
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171472, "mem_171472") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_171976 = flat_dim_161725;
            bool loop_while_tmp_171977 = loop_cond_161728;
            int64_t stride_tmp_171980 = next_stride_161369;
            
            if (memblock_set(ctx, &mem_param_171356, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171359, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            loop_dz2084Uz2082U_161364 = loop_dz2084Uz2082U_tmp_171976;
            loop_while_161365 = loop_while_tmp_171977;
            stride_161368 = stride_tmp_171980;
        }
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171478, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        data_161359 = loop_dz2084Uz2082U_161364;
        data_161360 = loop_while_161365;
        data_161363 = stride_161368;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        
        bool empty_slice_161729 = n_88845 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_161730 = sle64((int64_t) 0, zs_lhs_161234);
        bool i_p_m_t_s_leq_w_161731 = slt64(zs_lhs_161234, data_161359);
        bool y_161732 = zzero_leq_i_p_m_t_s_161730 && i_p_m_t_s_leq_w_161731;
        bool ok_or_empty_161733 = empty_slice_161729 || y_161732;
        bool index_certs_161734;
        
        if (!ok_or_empty_161733) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_88845, "] out of bounds for array of shape [", (long long) data_161359, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:102:32-36\n   #6  ftRelational.fut:99:5-102:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_171482, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171484, bytes_171483, "mem_171484")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171486, bytes_171485, "mem_171486")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171043 = 0; i_171043 < n_88845; i_171043++) {
        int64_t eta_p_161742 = ((int64_t *) ext_mem_171482.mem)[i_171043];
        bool x_161743 = sle64((int64_t) 0, eta_p_161742);
        bool y_161744 = slt64(eta_p_161742, n_88845);
        bool bounds_check_161745 = x_161743 && y_161744;
        bool index_certs_161746;
        
        if (!bounds_check_161745) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161742, "] out of bounds for array of shape [", (long long) n_88845, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:102:32-36\n   #5  ftRelational.fut:99:5-102:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t lifted_lambda_res_161747 = ((int16_t *) k_mem_171274.mem)[eta_p_161742];
        
        ((int16_t *) mem_171484.mem)[i_171043] = lifted_lambda_res_161747;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171486.mem, i_171043 * b_88846, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171275.mem, eta_p_161742 * b_88846, (int64_t []) {(int64_t) 1}, (int64_t []) {b_88846});
    }
    if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171484, "mem_171484") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171486, "mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172450, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172451, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171280);
        free(mem_171283);
        free(mem_171293);
        free(mem_171295);
        free(mem_171362);
        free(mem_171365);
        free(mem_171375);
        free(mem_171377);
        free(mem_171392);
        free(mem_171395);
        if (memblock_unref(ctx, &mem_171486, "mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171484, "mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171472, "mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171434, "mem_171434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171430, "mem_171430") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171439, "mem_171439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171437, "mem_171437") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171454, "ext_mem_171454") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171457, "ext_mem_171457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171359, "mem_param_171359") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171356, "mem_param_171356") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171478, "ext_mem_171478") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171352, "mem_171352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171348, "mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_172462, struct memblock eta_p_mem_171274, int64_t nz2080U_79489)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t defunc_0_reduce_res_161970;
    int64_t redout_171001 = (int64_t) 9223372036854775807;
    
    for (int64_t i_171002 = 0; i_171002 < nz2080U_79489; i_171002++) {
        int64_t x_152814 = ((int64_t *) eta_p_mem_171274.mem)[i_171002];
        int64_t min_res_152817 = smin64(x_152814, redout_171001);
        int64_t redout_tmp_171957 = min_res_152817;
        
        redout_171001 = redout_tmp_171957;
    }
    defunc_0_reduce_res_161970 = redout_171001;
    prim_out_171956 = defunc_0_reduce_res_161970;
    *out_prim_out_172462 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_172463, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80791, int64_t incr_80792, int64_t block_sizze_80793)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172464 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_80791;
    
    if (mem_171277_cached_sizze_172464 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172464, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < n_80791; i_171003++) {
        int64_t eta_p_152985 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152986 = sub64(eta_p_152985, incr_80792);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152986;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171276, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_80791; nest_i_171958++) {
        ((double *) mem_171285.mem)[nest_i_171958] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80791});
    if (futrts_partitioned_gather_over_array_15625(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, n_80791, n_80791, 64, block_sizze_80793) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172463, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_172465, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80539, int64_t incr_80540, int64_t block_sizze_80541)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172466 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_80539;
    int64_t bytes_171284 = (int64_t) 4 * n_80539;
    
    if (mem_171277_cached_sizze_172466 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172466, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < n_80539; i_171003++) {
        int64_t eta_p_152985 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152986 = sub64(eta_p_152985, incr_80540);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152986;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_80539; nest_i_171958++) {
        ((float *) mem_171285.mem)[nest_i_171958] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80539});
    if (futrts_partitioned_gather_over_array_15613(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, n_80539, n_80539, 32, block_sizze_80541) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172465, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_172467, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80035, int64_t incr_80036, int64_t block_sizze_80037)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172468 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_80035;
    int64_t bytes_171284 = (int64_t) 4 * n_80035;
    
    if (mem_171277_cached_sizze_172468 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172468, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < n_80035; i_171003++) {
        int64_t eta_p_152985 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152986 = sub64(eta_p_152985, incr_80036);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152986;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_80035; nest_i_171958++) {
        ((int32_t *) mem_171285.mem)[nest_i_171958] = 0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80035});
    if (futrts_partitioned_gather_over_array_15590(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, n_80035, n_80035, 32, block_sizze_80037) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172467, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_172469, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_80287, int64_t incr_80288, int64_t block_sizze_80289)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172470 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_80287;
    
    if (mem_171277_cached_sizze_172470 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172470, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < n_80287; i_171003++) {
        int64_t eta_p_152985 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152986 = sub64(eta_p_152985, incr_80288);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152986;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171276, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_80287; nest_i_171958++) {
        ((int64_t *) mem_171285.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80287});
    if (futrts_partitioned_gather_over_array_15601(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, n_80287, n_80287, 64, block_sizze_80289) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172469, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_172471, struct memblock is_mem_171274, struct memblock ys_mem_171275, int64_t n_79783, int64_t incr_79784, int64_t block_sizze_79785)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171277_cached_sizze_172472 = 0;
    unsigned char *mem_171277 = NULL;
    struct memblock ext_mem_171289;
    
    ext_mem_171289.references = NULL;
    
    struct memblock mem_171287;
    
    mem_171287.references = NULL;
    
    struct memblock mem_171285;
    
    mem_171285.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_79783;
    int64_t bytes_171284 = (int64_t) 2 * n_79783;
    
    if (mem_171277_cached_sizze_172472 < bytes_171276) {
        err = lexical_realloc(ctx, &mem_171277, &mem_171277_cached_sizze_172472, bytes_171276);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171003 = 0; i_171003 < n_79783; i_171003++) {
        int64_t eta_p_152985 = ((int64_t *) is_mem_171274.mem)[i_171003];
        int64_t lifted_lambda_res_152986 = sub64(eta_p_152985, incr_79784);
        
        ((int64_t *) mem_171277)[i_171003] = lifted_lambda_res_152986;
    }
    if (memblock_alloc(ctx, &mem_171285, bytes_171284, "mem_171285")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_79783; nest_i_171958++) {
        ((int16_t *) mem_171285.mem)[nest_i_171958] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171287, bytes_171276, "mem_171287")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171287.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171277, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_79783});
    if (futrts_partitioned_gather_over_array_15578(ctx, &ext_mem_171289, mem_171285, ys_mem_171275, mem_171287, n_79783, n_79783, 16, block_sizze_79785) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171289, "ext_mem_171289") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172471, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171277);
        if (memblock_unref(ctx, &ext_mem_171289, "ext_mem_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171287, "mem_171287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171285, "mem_171285") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_172473, struct memblock *mem_out_p_172474, struct memblock xs_mem_171274, struct memblock pL_mem_171275, int64_t n_129492, int64_t b_129493, int64_t pL_b_129494, int16_t block_sizze_129495, int64_t gather_psizze_129496, int32_t radix_sizze_129497, int64_t sizze_thresh_129500, int32_t max_depth_129501, int32_t bit_step_129502)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171321_cached_sizze_172475 = 0;
    unsigned char *mem_171321 = NULL;
    int64_t mem_171355_cached_sizze_172476 = 0;
    unsigned char *mem_171355 = NULL;
    int64_t mem_171357_cached_sizze_172477 = 0;
    unsigned char *mem_171357 = NULL;
    int64_t mem_171366_cached_sizze_172478 = 0;
    unsigned char *mem_171366 = NULL;
    int64_t mem_171367_cached_sizze_172479 = 0;
    unsigned char *mem_171367 = NULL;
    int64_t mem_171398_cached_sizze_172480 = 0;
    unsigned char *mem_171398 = NULL;
    int64_t mem_171400_cached_sizze_172481 = 0;
    unsigned char *mem_171400 = NULL;
    int64_t mem_171402_cached_sizze_172482 = 0;
    unsigned char *mem_171402 = NULL;
    int64_t mem_171404_cached_sizze_172483 = 0;
    unsigned char *mem_171404 = NULL;
    int64_t mem_171430_cached_sizze_172484 = 0;
    unsigned char *mem_171430 = NULL;
    int64_t mem_171432_cached_sizze_172485 = 0;
    unsigned char *mem_171432 = NULL;
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_param_tmp_171961;
    
    mem_param_tmp_171961.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_param_tmp_171973;
    
    mem_param_tmp_171973.references = NULL;
    
    struct memblock mem_param_tmp_171972;
    
    mem_param_tmp_171972.references = NULL;
    
    struct memblock mem_param_tmp_171971;
    
    mem_param_tmp_171971.references = NULL;
    
    struct memblock mem_171468;
    
    mem_171468.references = NULL;
    
    struct memblock mem_171466;
    
    mem_171466.references = NULL;
    
    struct memblock mem_171448;
    
    mem_171448.references = NULL;
    
    struct memblock mem_171446;
    
    mem_171446.references = NULL;
    
    struct memblock ext_mem_171395;
    
    ext_mem_171395.references = NULL;
    
    struct memblock ext_mem_171396;
    
    ext_mem_171396.references = NULL;
    
    struct memblock mem_171393;
    
    mem_171393.references = NULL;
    
    struct memblock mem_param_tmp_171982;
    
    mem_param_tmp_171982.references = NULL;
    
    struct memblock mem_param_tmp_171981;
    
    mem_param_tmp_171981.references = NULL;
    
    struct memblock mem_171345;
    
    mem_171345.references = NULL;
    
    struct memblock mem_171343;
    
    mem_171343.references = NULL;
    
    struct memblock mem_param_tmp_171989;
    
    mem_param_tmp_171989.references = NULL;
    
    struct memblock mem_171332;
    
    mem_171332.references = NULL;
    
    struct memblock mem_param_171330;
    
    mem_param_171330.references = NULL;
    
    struct memblock ext_mem_171341;
    
    ext_mem_171341.references = NULL;
    
    struct memblock mem_param_171316;
    
    mem_param_171316.references = NULL;
    
    struct memblock mem_param_171312;
    
    mem_param_171312.references = NULL;
    
    struct memblock ext_mem_171390;
    
    ext_mem_171390.references = NULL;
    
    struct memblock ext_mem_171391;
    
    ext_mem_171391.references = NULL;
    
    struct memblock mem_171308;
    
    mem_171308.references = NULL;
    
    struct memblock mem_param_171306;
    
    mem_param_171306.references = NULL;
    
    struct memblock mem_param_171302;
    
    mem_param_171302.references = NULL;
    
    struct memblock mem_param_171298;
    
    mem_param_171298.references = NULL;
    
    struct memblock mem_param_171295;
    
    mem_param_171295.references = NULL;
    
    struct memblock ext_mem_171479;
    
    ext_mem_171479.references = NULL;
    
    struct memblock ext_mem_171480;
    
    ext_mem_171480.references = NULL;
    
    struct memblock ext_mem_171481;
    
    ext_mem_171481.references = NULL;
    
    struct memblock ext_mem_171482;
    
    ext_mem_171482.references = NULL;
    
    struct memblock mem_param_171292;
    
    mem_param_171292.references = NULL;
    
    struct memblock mem_param_171289;
    
    mem_param_171289.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171282;
    
    mem_param_171282.references = NULL;
    
    struct memblock ext_mem_171493;
    
    ext_mem_171493.references = NULL;
    
    struct memblock ext_mem_171494;
    
    ext_mem_171494.references = NULL;
    
    struct memblock ext_mem_171495;
    
    ext_mem_171495.references = NULL;
    
    struct memblock ext_mem_171496;
    
    ext_mem_171496.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    if (memblock_alloc(ctx, &mem_171276, (int64_t) 8, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < (int64_t) 1; nest_i_171958++) {
        ((int64_t *) mem_171276.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171277, (int64_t) 8, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171959 = 0; nest_i_171959 < (int64_t) 1; nest_i_171959++) {
        ((int64_t *) mem_171277.mem)[nest_i_171959] = n_129492;
    }
    
    bool loop_cond_t_res_154404 = slt32(0, max_depth_129501);
    
    if (memblock_alloc(ctx, &mem_171278, (int64_t) 0, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_154455 = sext_i64_i32(b_129493);
    int32_t zm_lhs_154456 = mul32(8, i64_res_154455);
    int32_t min_arg1_154457 = sub32(zm_lhs_154456, 1);
    int32_t s_sign_154464 = (bit_step_129502 > 0 ? 1 : 0) - (bit_step_129502 < 0 ? 1 : 0);
    int64_t s_sign_154465 = sext_i32_i64(s_sign_154464);
    bool downwards_154468 = s_sign_154464 == -1;
    bool x_154472 = !downwards_154468;
    int64_t subtracted_step_154481 = sext_i32_i64(bit_step_129502);
    int64_t pos_step_154482 = mul64(s_sign_154465, subtracted_step_154481);
    int32_t zm_lhs_154486 = add32(8, zm_lhs_154456);
    int32_t zs_lhs_154487 = sub32(zm_lhs_154486, 1);
    int32_t i32_arg0_154488 = sdiv32(zs_lhs_154487, 8);
    int64_t i32_res_154489 = sext_i32_i64(i32_arg0_154488);
    bool zzero_154490 = i32_res_154489 == (int64_t) 0;
    bool nonzzero_154491 = !zzero_154490;
    int64_t bytes_171445 = n_129492 * b_129493;
    int64_t bytes_171447 = n_129492 * pL_b_129494;
    
    if (mem_171366_cached_sizze_172478 < b_129493) {
        err = lexical_realloc(ctx, &mem_171366, &mem_171366_cached_sizze_172478, b_129493);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171367_cached_sizze_172479 < pL_b_129494) {
        err = lexical_realloc(ctx, &mem_171367, &mem_171367_cached_sizze_172479, pL_b_129494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_154406;
    bool partition_and_deepen_res_154407;
    int32_t partition_and_deepen_res_154408;
    int64_t loop_dz2087U_154413;
    bool loop_while_154414;
    int32_t p_154415;
    
    if (memblock_set(ctx, &mem_param_171282, &pL_mem_171275, "pL_mem_171275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171289, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171292, &mem_171277, "mem_171277") != 0)
        return 1;
    loop_dz2087U_154413 = (int64_t) 1;
    loop_while_154414 = loop_cond_t_res_154404;
    p_154415 = 0;
    while (loop_while_154414) {
        bool loop_nonempty_161767 = slt64((int64_t) 0, loop_dz2087U_154413);
        int32_t newDepth_154451 = add32(1, p_154415);
        int32_t new_i_154452 = mul32(radix_sizze_129497, p_154415);
        int32_t zm_lhs_154453 = mul32(radix_sizze_129497, newDepth_154451);
        int32_t new_j_154454 = sub32(zm_lhs_154453, 1);
        int32_t min_res_154458 = smin32(new_j_154454, min_arg1_154457);
        int32_t tmp_154459 = add32(bit_step_129502, new_i_154452);
        int64_t i_154460 = sext_i32_i64(new_i_154452);
        int64_t j__154461 = sext_i32_i64(min_res_154458);
        int64_t tmp_154462 = sext_i32_i64(tmp_154459);
        bool step_zzero_154463 = new_i_154452 == tmp_154459;
        bool bounds_invalid_downwards_154466 = slt32(new_i_154452, min_res_154458);
        bool bounds_invalid_upwards_154467 = slt32(min_res_154458, new_i_154452);
        int32_t distance_downwards_exclusive_154469 = sub32(new_i_154452, min_res_154458);
        int32_t distance_upwards_exclusive_154470 = sub32(min_res_154458, new_i_154452);
        bool x_154471 = bounds_invalid_downwards_154466 && downwards_154468;
        bool y_154473 = bounds_invalid_upwards_154467 && x_154472;
        bool bounds_invalid_154474 = x_154471 || y_154473;
        int32_t distance_exclusive_154475;
        
        if (downwards_154468) {
            distance_exclusive_154475 = distance_downwards_exclusive_154469;
        } else {
            distance_exclusive_154475 = distance_upwards_exclusive_154470;
        }
        
        int64_t distance_exclusive_154476 = sext_i32_i64(distance_exclusive_154475);
        int64_t distance_154477 = add64((int64_t) 1, distance_exclusive_154476);
        bool range_invalid_154478 = step_zzero_154463 || bounds_invalid_154474;
        bool valid_154479 = !range_invalid_154478;
        bool loop_not_taken_161768 = !loop_nonempty_161767;
        bool protect_assert_disj_161769 = valid_154479 || loop_not_taken_161768;
        bool range_valid_c_154480;
        
        if (!protect_assert_disj_161769) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_154460, "..", (long long) tmp_154462, "...", (long long) j__154461, " is invalid.", "-> #0  ftHashJoin.fut:223:15-37\n   #1  ftHashJoin.fut:266:20-272:13\n   #2  ftRelational.fut:217:7-99\n   #3  ftRelational.fut:206:3-218:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_154483 = sdiv_up_safe64(distance_154477, pos_step_154482);
        bool loop_nonempty_154484 = slt64((int64_t) 0, num_elems_154483);
        bool loop_not_taken_154492 = !loop_nonempty_154484;
        bool protect_assert_disj_154493 = nonzzero_154491 || loop_not_taken_154492;
        bool protect_assert_disj_161771 = protect_assert_disj_154493 || loop_not_taken_161768;
        bool nonzzero_cert_154494;
        
        if (!protect_assert_disj_161771) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:217:7-99\n   #5  ftRelational.fut:206:3-218:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154495 = sdiv_safe64(gather_psizze_129496, i32_res_154489);
        bool zzero_154498 = psizze__154495 == (int64_t) 0;
        bool nonzzero_154499 = !zzero_154498;
        bool protect_assert_disj_154500 = loop_not_taken_154492 || nonzzero_154499;
        bool protect_assert_disj_161773 = protect_assert_disj_154500 || loop_not_taken_161768;
        bool nonzzero_cert_154501;
        
        if (!protect_assert_disj_161773) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:217:7-99\n   #5  ftRelational.fut:206:3-218:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_154420;
        int64_t loop_dz2081Uz2089U_154426;
        
        if (memblock_set(ctx, &mem_param_171295, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171298, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171302, &mem_param_171282, "mem_param_171282") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171306, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        loop_dz2081Uz2089U_154426 = (int64_t) 0;
        for (int64_t i_154425 = 0; i_154425 < loop_dz2087U_154413; i_154425++) {
            int64_t bounds_154431 = ((int64_t *) mem_param_171289.mem)[i_154425];
            int64_t bounds_154432 = ((int64_t *) mem_param_171292.mem)[i_154425];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433 = sub64(bounds_154432, bounds_154431);
            bool empty_slice_154434 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433 == (int64_t) 0;
            int64_t m_154435 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, (int64_t) 1);
            int64_t i_p_m_t_s_154436 = add64(bounds_154431, m_154435);
            bool zzero_leq_i_p_m_t_s_154437 = sle64((int64_t) 0, i_p_m_t_s_154436);
            bool i_p_m_t_s_leq_w_154438 = slt64(i_p_m_t_s_154436, n_129492);
            bool zzero_lte_i_154439 = sle64((int64_t) 0, bounds_154431);
            bool i_lte_j_154440 = sle64(bounds_154431, bounds_154432);
            bool y_154441 = i_p_m_t_s_leq_w_154438 && zzero_lte_i_154439;
            bool y_154442 = zzero_leq_i_p_m_t_s_154437 && y_154441;
            bool forwards_ok_154443 = i_lte_j_154440 && y_154442;
            bool ok_or_empty_154444 = empty_slice_154434 || forwards_ok_154443;
            bool index_certs_154445;
            
            if (!ok_or_empty_154444) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_154431, ":", (long long) bounds_154432, "] out of bounds for array of shape [", (long long) n_129492, "].", "-> #0  ftHashJoin.fut:300:21-47\n   #1  ftRelational.fut:217:7-99\n   #2  ftRelational.fut:206:3-218:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171307 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433;
            
            if (memblock_alloc(ctx, &mem_171308, bytes_171307, "mem_171308")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_171980 = 0; nest_i_171980 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433; nest_i_171980++) {
                ((int64_t *) mem_171308.mem)[nest_i_171980] = (int64_t) 0;
            }
            
            int64_t zm_lhs_154496 = add64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, psizze__154495);
            int64_t zs_lhs_154497 = sub64(zm_lhs_154496, (int64_t) 1);
            int64_t max_iter_154502 = sdiv_safe64(zs_lhs_154497, psizze__154495);
            bool bounds_invalid_upwards_154503 = slt64(max_iter_154502, (int64_t) 0);
            bool valid_154504 = !bounds_invalid_upwards_154503;
            bool protect_assert_disj_154505 = loop_not_taken_154492 || valid_154504;
            bool range_valid_c_154506;
            
            if (!protect_assert_disj_154505) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154502, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftHashJoin.fut:210:83-86\n   #3  ftHashJoin.fut:224:6-71\n   #4  ftHashJoin.fut:266:20-272:13\n   #5  ftRelational.fut:217:7-99\n   #6  ftRelational.fut:206:3-218:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_y_171317 = b_129493 * bounds_154431;
            int64_t binop_y_171319 = pL_b_129494 * bounds_154431;
            int64_t bytes_171342 = b_129493 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433;
            int64_t bytes_171344 = pL_b_129494 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433;
            
            if (mem_171321_cached_sizze_172475 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433) {
                err = lexical_realloc(ctx, &mem_171321, &mem_171321_cached_sizze_172475, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_171389;
            int64_t ext_171386;
            int64_t ctx_param_ext_171309;
            int64_t ctx_param_ext_171313;
            
            if (memblock_set(ctx, &mem_param_171312, &mem_param_171306, "mem_param_171306") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171316, &mem_param_171302, "mem_param_171302") != 0)
                return 1;
            ctx_param_ext_171309 = binop_y_171317;
            ctx_param_ext_171313 = binop_y_171319;
            for (int64_t i_154509 = 0; i_154509 < num_elems_154483; i_154509++) {
                int32_t binop_x_154512 = sext_i64_i32(i_154509);
                int32_t binop_x_154513 = mul32(bit_step_129502, binop_x_154512);
                int32_t index_primexp_154514 = add32(new_i_154452, binop_x_154513);
                int32_t zm_lhs_154515 = add32(bit_step_129502, index_primexp_154514);
                int32_t min_arg1_154516 = sub32(zm_lhs_154515, 1);
                int32_t min_res_154517 = smin32(min_res_154458, min_arg1_154516);
                int32_t zp_lhs_154518 = sub32(min_res_154517, index_primexp_154514);
                int32_t ij_bits_154519 = add32(1, zp_lhs_154518);
                int32_t up_to_154520 = shl32(1, ij_bits_154519);
                int64_t tmp_154521 = sext_i32_i64(zp_lhs_154518);
                bool bounds_invalid_upwards_154522 = slt32(zp_lhs_154518, 0);
                bool valid_154524 = !bounds_invalid_upwards_154522;
                bool range_valid_c_154525;
                
                if (!valid_154524) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154521, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:210:83-86\n   #3  ftHashJoin.fut:224:6-71\n   #4  ftHashJoin.fut:266:20-272:13\n   #5  ftRelational.fut:217:7-99\n   #6  ftRelational.fut:206:3-218:32\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_154535 = sext_i32_i64(up_to_154520);
                bool bounds_invalid_upwards_154536 = slt32(up_to_154520, 0);
                bool valid_154537 = !bounds_invalid_upwards_154536;
                bool range_valid_c_154538;
                
                if (!valid_154537) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154535, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:217:7-99\n   #5  ftRelational.fut:206:3-218:32\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_154523 = add64((int64_t) 1, tmp_154521);
                
                for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433; i_171003++) {
                    int8_t defunc_0_f_res_154528;
                    int8_t y_154530 = (int8_t) 0;
                    
                    for (int64_t i_154529 = 0; i_154529 < distance_154523; i_154529++) {
                        int32_t binop_x_154531 = sext_i64_i32(i_154529);
                        int32_t get_bit_arg0_154532 = add32(index_primexp_154514, binop_x_154531);
                        int32_t zm_rhs_161940 = sdiv32(get_bit_arg0_154532, 8);
                        int32_t zm_lhs_161941 = sub32(i64_res_154455, zm_rhs_161940);
                        int32_t whichByte_161942 = sub32(zm_lhs_161941, 1);
                        int64_t whichByte_161944 = sext_i32_i64(whichByte_161942);
                        bool x_161945 = sle64((int64_t) 0, whichByte_161944);
                        bool y_161946 = slt64(whichByte_161944, b_129493);
                        bool bounds_check_161947 = x_161945 && y_161946;
                        bool index_certs_161948;
                        
                        if (!bounds_check_161947) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_161944, "] out of bounds for array of shape [", (long long) b_129493, "].", "-> #0  ftHashJoin.fut:18:6-18\n   #1  ftRelational.fut:217:7-99\n   #2  ftRelational.fut:206:3-218:32\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_161943 = smod32(get_bit_arg0_154532, 8);
                        int8_t zbzg_lhs_161949 = ((int8_t *) mem_param_171312.mem)[ctx_param_ext_171309 + (i_171003 * b_129493 + whichByte_161944)];
                        int8_t unsign_arg0_161950 = zext_i32_i8(whichBit_161943);
                        int8_t unsign_arg0_161951 = ashr8(zbzg_lhs_161949, unsign_arg0_161950);
                        int8_t unsign_arg0_161952 = (int8_t) 1 & unsign_arg0_161951;
                        int32_t to_i32_res_161953 = zext_i8_i32(unsign_arg0_161952);
                        int8_t loopres_154534;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_154534, binop_x_154531, y_154530, to_i32_res_161953) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_171988 = loopres_154534;
                        
                        y_154530 = y_tmp_171988;
                    }
                    defunc_0_f_res_154528 = y_154530;
                    ((int8_t *) mem_171321)[i_171003] = defunc_0_f_res_154528;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_154539;
                int64_t offs_154542;
                
                if (memblock_set(ctx, &mem_param_171330, &mem_171308, "mem_171308") != 0)
                    return 1;
                offs_154542 = (int64_t) 0;
                for (int64_t i_154541 = 0; i_154541 < up_to_154535; i_154541++) {
                    int32_t binop_x_154544 = sext_i64_i32(i_154541);
                    int8_t index_primexp_154545 = zext_i32_i8(binop_x_154544);
                    
                    if (memblock_alloc(ctx, &mem_171332, bytes_171307, "mem_171332")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_162374;
                    int64_t defunc_0_reduce_res_162375;
                    int64_t inpacc_162204;
                    int64_t inpacc_162205;
                    
                    inpacc_162204 = (int64_t) 0;
                    inpacc_162205 = (int64_t) 0;
                    for (int64_t i_171021 = 0; i_171021 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433; i_171021++) {
                        int8_t eta_p_171252 = ((int8_t *) mem_171321)[i_171021];
                        bool lifted_lambda_res_171253 = eta_p_171252 == index_primexp_154545;
                        int64_t bool_res_171254 = btoi_bool_i64(lifted_lambda_res_171253);
                        int64_t eta_p_171267 = ((int64_t *) mem_param_171330.mem)[i_171021];
                        int64_t defunc_0_op_res_171268 = add64(inpacc_162204, bool_res_171254);
                        int64_t zm_lhs_171269 = add64(offs_154542, defunc_0_op_res_171268);
                        int64_t lifted_lambda_res_171270 = sub64(zm_lhs_171269, (int64_t) 1);
                        int64_t defunc_0_f_res_171271 = mul64(bool_res_171254, lifted_lambda_res_171270);
                        int64_t defunc_0_f_res_171272 = add64(eta_p_171267, defunc_0_f_res_171271);
                        int64_t defunc_0_op_res_162253 = add64(inpacc_162205, bool_res_171254);
                        
                        ((int64_t *) mem_171332.mem)[i_171021] = defunc_0_f_res_171272;
                        
                        int64_t inpacc_tmp_171992 = defunc_0_op_res_171268;
                        int64_t inpacc_tmp_171993 = defunc_0_op_res_162253;
                        
                        inpacc_162204 = inpacc_tmp_171992;
                        inpacc_162205 = inpacc_tmp_171993;
                    }
                    inpacc_162374 = inpacc_162204;
                    defunc_0_reduce_res_162375 = inpacc_162205;
                    
                    int64_t tmp_154570 = add64(offs_154542, defunc_0_reduce_res_162375);
                    
                    if (memblock_set(ctx, &mem_param_tmp_171989, &mem_171332, "mem_171332") != 0)
                        return 1;
                    
                    int64_t offs_tmp_171990 = tmp_154570;
                    
                    if (memblock_set(ctx, &mem_param_171330, &mem_param_tmp_171989, "mem_param_tmp_171989") != 0)
                        return 1;
                    offs_154542 = offs_tmp_171990;
                }
                if (memblock_set(ctx, &ext_mem_171341, &mem_param_171330, "mem_param_171330") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_154539 = offs_154542;
                if (memblock_alloc(ctx, &mem_171343, bytes_171342, "mem_171343")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_171343.mem, (int64_t) 0, (int64_t []) {b_129493, (int64_t) 1}, (uint8_t *) mem_param_171312.mem, ctx_param_ext_171309, (int64_t []) {b_129493, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, b_129493});
                if (memblock_alloc(ctx, &mem_171345, bytes_171344, "mem_171345")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_171345.mem, (int64_t) 0, (int64_t []) {pL_b_129494, (int64_t) 1}, (uint8_t *) mem_param_171316.mem, ctx_param_ext_171313, (int64_t []) {pL_b_129494, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, pL_b_129494});
                for (int64_t i_154579 = 0; i_154579 < max_iter_154502; i_154579++) {
                    int64_t inf_154582 = mul64(psizze__154495, i_154579);
                    int64_t min_arg1_154583 = add64(psizze__154495, inf_154582);
                    int64_t min_res_154584 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, min_arg1_154583);
                    bool zzero_lte_i_154594 = sle64((int64_t) 0, inf_154582);
                    int64_t j_m_i_154588 = sub64(min_res_154584, inf_154582);
                    int64_t m_154590 = sub64(j_m_i_154588, (int64_t) 1);
                    int64_t i_p_m_t_s_154591 = add64(inf_154582, m_154590);
                    bool i_p_m_t_s_leq_w_154593 = slt64(i_p_m_t_s_154591, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433);
                    bool y_154596 = i_p_m_t_s_leq_w_154593 && zzero_lte_i_154594;
                    bool zzero_leq_i_p_m_t_s_154592 = sle64((int64_t) 0, i_p_m_t_s_154591);
                    bool y_154597 = zzero_leq_i_p_m_t_s_154592 && y_154596;
                    bool i_lte_j_154595 = sle64(inf_154582, min_res_154584);
                    bool forwards_ok_154598 = i_lte_j_154595 && y_154597;
                    bool empty_slice_154589 = j_m_i_154588 == (int64_t) 0;
                    bool ok_or_empty_154599 = empty_slice_154589 || forwards_ok_154598;
                    bool index_certs_154600;
                    
                    if (!ok_or_empty_154599) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154582, ":", (long long) min_res_154584, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:217:7-99\n   #5  ftRelational.fut:206:3-218:32\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_171354 = pL_b_129494 * j_m_i_154588;
                    int64_t bytes_171356 = b_129493 * j_m_i_154588;
                    
                    if (mem_171355_cached_sizze_172476 < bytes_171354) {
                        err = lexical_realloc(ctx, &mem_171355, &mem_171355_cached_sizze_172476, bytes_171354);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171355, (int64_t) 0, (int64_t []) {pL_b_129494, (int64_t) 1}, (uint8_t *) mem_171345.mem, (int64_t) 0 + pL_b_129494 * inf_154582, (int64_t []) {pL_b_129494, (int64_t) 1}, (int64_t []) {j_m_i_154588, pL_b_129494});
                    if (mem_171357_cached_sizze_172477 < bytes_171356) {
                        err = lexical_realloc(ctx, &mem_171357, &mem_171357_cached_sizze_172477, bytes_171356);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171357, (int64_t) 0, (int64_t []) {b_129493, (int64_t) 1}, (uint8_t *) mem_171343.mem, (int64_t) 0 + b_129493 * inf_154582, (int64_t []) {b_129493, (int64_t) 1}, (int64_t []) {j_m_i_154588, b_129493});
                    for (int64_t write_iter_171023 = 0; write_iter_171023 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433; write_iter_171023++) {
                        int64_t write_iv_171026 = ((int64_t *) ext_mem_171341.mem)[write_iter_171023];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171366, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171312.mem, ctx_param_ext_171309 + write_iter_171023 * b_129493, (int64_t []) {(int64_t) 1}, (int64_t []) {b_129493});
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171367, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171316.mem, ctx_param_ext_171313 + write_iter_171023 * pL_b_129494, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_129494});
                        
                        int64_t lifted_lambda_res_162296 = sub64(write_iv_171026, inf_154582);
                        
                        if ((sle64((int64_t) 0, lifted_lambda_res_162296) && slt64(lifted_lambda_res_162296, j_m_i_154588)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_129493 - (int64_t) 1, b_129493))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171357, lifted_lambda_res_162296 * b_129493, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171366, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_129493});
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_162296) && slt64(lifted_lambda_res_162296, j_m_i_154588)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(pL_b_129494 - (int64_t) 1, pL_b_129494))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171355, lifted_lambda_res_162296 * pL_b_129494, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171367, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_129494});
                        }
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171343.mem, b_129493 * inf_154582, (int64_t []) {b_129493, (int64_t) 1}, (uint8_t *) mem_171357, (int64_t) 0, (int64_t []) {b_129493, (int64_t) 1}, (int64_t []) {j_m_i_154588, b_129493});
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171345.mem, pL_b_129494 * inf_154582, (int64_t []) {pL_b_129494, (int64_t) 1}, (uint8_t *) mem_171355, (int64_t) 0, (int64_t []) {pL_b_129494, (int64_t) 1}, (int64_t []) {j_m_i_154588, pL_b_129494});
                }
                if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_171981, &mem_171343, "mem_171343") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_171982, &mem_171345, "mem_171345") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_171983 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_171984 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_171312, &mem_param_tmp_171981, "mem_param_tmp_171981") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171316, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
                    return 1;
                ctx_param_ext_171309 = ctx_param_ext_tmp_171983;
                ctx_param_ext_171313 = ctx_param_ext_tmp_171984;
            }
            if (memblock_set(ctx, &ext_mem_171391, &mem_param_171312, "mem_param_171312") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171390, &mem_param_171316, "mem_param_171316") != 0)
                return 1;
            ext_171389 = ctx_param_ext_171309;
            ext_171386 = ctx_param_ext_171313;
            if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171393, bytes_171342, "mem_171393")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171393.mem, (int64_t) 0, (int64_t []) {b_129493, (int64_t) 1}, (uint8_t *) ext_mem_171391.mem, ext_171389, (int64_t []) {b_129493, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, b_129493});
            
            int64_t deepen_step_res_154612;
            int64_t deepen_step_res_154613;
            int32_t deepen_step_res_154616;
            
            if (futrts_getPartitionBounds_16843(ctx, &ext_mem_171396, &ext_mem_171395, &deepen_step_res_154612, &deepen_step_res_154613, &deepen_step_res_154616, mem_171393, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, b_129493, newDepth_154451, new_i_154452, new_j_154454) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_171393, "mem_171393") != 0)
                return 1;
            
            int64_t zl_rhs_161783 = sub64(deepen_step_res_154612, (int64_t) 1);
            int64_t bytes_171397 = (int64_t) 8 * deepen_step_res_154612;
            
            if (mem_171398_cached_sizze_172480 < bytes_171397) {
                err = lexical_realloc(ctx, &mem_171398, &mem_171398_cached_sizze_172480, bytes_171397);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171400_cached_sizze_172481 < bytes_171397) {
                err = lexical_realloc(ctx, &mem_171400, &mem_171400_cached_sizze_172481, bytes_171397);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171402_cached_sizze_172482 < bytes_171397) {
                err = lexical_realloc(ctx, &mem_171402, &mem_171402_cached_sizze_172482, bytes_171397);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171404_cached_sizze_172483 < bytes_171397) {
                err = lexical_realloc(ctx, &mem_171404, &mem_171404_cached_sizze_172483, bytes_171397);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171045;
            int64_t scanacc_171035 = (int64_t) 0;
            
            for (int64_t i_171040 = 0; i_171040 < deepen_step_res_154612; i_171040++) {
                int64_t tmp_161993 = ((int64_t *) ext_mem_171396.mem)[i_171040];
                bool cond_161994 = slt64(i_171040, zl_rhs_161783);
                int64_t tmp_161995;
                
                if (cond_161994) {
                    int64_t tmp_162380 = add64((int64_t) 1, i_171040);
                    bool x_162381 = sle64((int64_t) 0, tmp_162380);
                    bool y_162382 = slt64(tmp_162380, deepen_step_res_154612);
                    bool bounds_check_162383 = x_162381 && y_162382;
                    bool index_certs_162384;
                    
                    if (!bounds_check_162383) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162380, "] out of bounds for array of shape [", (long long) deepen_step_res_154612, "].", "-> #0  ftHashJoin.fut:276:67-81\n   #1  ftRelational.fut:217:7-99\n   #2  ftRelational.fut:206:3-218:32\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_162385 = ((int64_t *) ext_mem_171396.mem)[tmp_162380];
                    
                    tmp_161995 = tmp_t_res_162385;
                } else {
                    tmp_161995 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433;
                }
                
                int64_t zg_lhs_162004 = sub64(tmp_161995, tmp_161993);
                bool lifted_lambda_res_162005 = slt64(sizze_thresh_129500, zg_lhs_162004);
                int64_t defunc_0_f_res_162006 = btoi_bool_i64(lifted_lambda_res_162005);
                int64_t defunc_0_op_res_154633 = add64(defunc_0_f_res_162006, scanacc_171035);
                
                ((int64_t *) mem_171398)[i_171040] = defunc_0_op_res_154633;
                ((int64_t *) mem_171400)[i_171040] = defunc_0_f_res_162006;
                ((int64_t *) mem_171402)[i_171040] = tmp_161993;
                ((int64_t *) mem_171404)[i_171040] = tmp_161995;
                
                int64_t scanacc_tmp_171999 = defunc_0_op_res_154633;
                
                scanacc_171035 = scanacc_tmp_171999;
            }
            discard_171045 = scanacc_171035;
            if (memblock_unref(ctx, &ext_mem_171396, "ext_mem_171396") != 0)
                return 1;
            
            bool cond_154634 = deepen_step_res_154612 == (int64_t) 0;
            bool x_154635 = !cond_154634;
            bool x_154637 = sle64((int64_t) 0, zl_rhs_161783);
            bool y_154638 = slt64(zl_rhs_161783, deepen_step_res_154612);
            bool bounds_check_154639 = x_154637 && y_154638;
            bool protect_assert_disj_154640 = cond_154634 || bounds_check_154639;
            bool index_certs_154641;
            
            if (!protect_assert_disj_154640) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_161783, "] out of bounds for array of shape [", (long long) deepen_step_res_154612, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:277:8-49\n   #3  ftRelational.fut:217:7-99\n   #4  ftRelational.fut:206:3-218:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_154642;
            
            if (x_154635) {
                int64_t x_162386 = ((int64_t *) mem_171398)[zl_rhs_161783];
                
                m_f_res_154642 = x_162386;
            } else {
                m_f_res_154642 = (int64_t) 0;
            }
            
            int64_t m_154644;
            
            if (cond_154634) {
                m_154644 = (int64_t) 0;
            } else {
                m_154644 = m_f_res_154642;
            }
            
            int64_t m_154654 = sub64(m_154644, (int64_t) 1);
            bool i_p_m_t_s_leq_w_154656 = slt64(m_154654, deepen_step_res_154612);
            bool zzero_leq_i_p_m_t_s_154655 = sle64((int64_t) 0, m_154654);
            bool y_154658 = zzero_leq_i_p_m_t_s_154655 && i_p_m_t_s_leq_w_154656;
            bool i_lte_j_154657 = sle64((int64_t) 0, m_154644);
            bool forwards_ok_154659 = i_lte_j_154657 && y_154658;
            bool eq_x_zz_154651 = (int64_t) 0 == m_f_res_154642;
            bool p_and_eq_x_y_154652 = x_154635 && eq_x_zz_154651;
            bool empty_slice_154653 = cond_154634 || p_and_eq_x_y_154652;
            bool ok_or_empty_154660 = empty_slice_154653 || forwards_ok_154659;
            bool index_certs_154661;
            
            if (!ok_or_empty_154660) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154644, "] out of bounds for array of shape [", (long long) deepen_step_res_154612, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:277:8-49\n   #3  ftRelational.fut:217:7-99\n   #4  ftRelational.fut:206:3-218:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171429 = (int64_t) 8 * m_154644;
            int64_t conc_tmp_154683 = loop_dz2081Uz2089U_154426 + m_154644;
            int64_t bytes_171465 = (int64_t) 8 * conc_tmp_154683;
            
            if (mem_171430_cached_sizze_172484 < bytes_171429) {
                err = lexical_realloc(ctx, &mem_171430, &mem_171430_cached_sizze_172484, bytes_171429);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171430, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171404, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154644});
            if (mem_171432_cached_sizze_172485 < bytes_171429) {
                err = lexical_realloc(ctx, &mem_171432, &mem_171432_cached_sizze_172485, bytes_171429);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171432, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171402, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154644});
            for (int64_t write_iter_171046 = 0; write_iter_171046 < deepen_step_res_154612; write_iter_171046++) {
                int64_t write_iv_171049 = ((int64_t *) mem_171400)[write_iter_171046];
                int64_t write_iv_171050 = ((int64_t *) mem_171398)[write_iter_171046];
                int64_t write_iv_171051 = ((int64_t *) mem_171402)[write_iter_171046];
                int64_t write_iv_171052 = ((int64_t *) mem_171404)[write_iter_171046];
                bool cond_161975 = write_iv_171049 == (int64_t) 1;
                int64_t lifted_lambda_res_161976;
                
                if (cond_161975) {
                    int64_t lifted_lambda_res_t_res_162387 = sub64(write_iv_171050, (int64_t) 1);
                    
                    lifted_lambda_res_161976 = lifted_lambda_res_t_res_162387;
                } else {
                    lifted_lambda_res_161976 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_161976) && slt64(lifted_lambda_res_161976, m_154644)) {
                    ((int64_t *) mem_171432)[lifted_lambda_res_161976] = write_iv_171051;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_161976) && slt64(lifted_lambda_res_161976, m_154644)) {
                    ((int64_t *) mem_171430)[lifted_lambda_res_161976] = write_iv_171052;
                }
            }
            if (memblock_alloc(ctx, &mem_171446, bytes_171445, "mem_171446")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171446.mem, (int64_t) 0, (int64_t []) {b_129493, (int64_t) 1}, (uint8_t *) mem_param_171306.mem, (int64_t) 0, (int64_t []) {b_129493, (int64_t) 1}, (int64_t []) {n_129492, b_129493});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171446.mem, b_129493 * bounds_154431, (int64_t []) {b_129493, (int64_t) 1}, (uint8_t *) ext_mem_171391.mem, ext_171389, (int64_t []) {b_129493, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, b_129493});
            if (memblock_unref(ctx, &ext_mem_171391, "ext_mem_171391") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171448, bytes_171447, "mem_171448")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171448.mem, (int64_t) 0, (int64_t []) {pL_b_129494, (int64_t) 1}, (uint8_t *) mem_param_171302.mem, (int64_t) 0, (int64_t []) {pL_b_129494, (int64_t) 1}, (int64_t []) {n_129492, pL_b_129494});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171448.mem, pL_b_129494 * bounds_154431, (int64_t []) {pL_b_129494, (int64_t) 1}, (uint8_t *) ext_mem_171390.mem, ext_171386, (int64_t []) {pL_b_129494, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154433, pL_b_129494});
            if (memblock_unref(ctx, &ext_mem_171390, "ext_mem_171390") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171466, bytes_171465, "mem_171466")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_171468, bytes_171465, "mem_171468")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171059 = 0; i_171059 < m_154644; i_171059++) {
                int64_t eta_p_154679 = ((int64_t *) mem_171432)[i_171059];
                int64_t eta_p_154680 = ((int64_t *) mem_171430)[i_171059];
                int64_t tmp_154681 = add64(bounds_154431, eta_p_154679);
                int64_t tmp_154682 = add64(bounds_154431, eta_p_154680);
                
                ((int64_t *) mem_171466.mem)[loop_dz2081Uz2089U_154426 + i_171059] = tmp_154681;
                ((int64_t *) mem_171468.mem)[loop_dz2081Uz2089U_154426 + i_171059] = tmp_154682;
            }
            
            int64_t tmp_offs_172008 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171466.mem, tmp_offs_172008, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171295.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154426});
            tmp_offs_172008 += loop_dz2081Uz2089U_154426;
            if (!(tmp_offs_172008 == loop_dz2081Uz2089U_154426)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171466.mem, tmp_offs_172008, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171466.mem, loop_dz2081Uz2089U_154426, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154644});
            }
            tmp_offs_172008 += m_154644;
            
            int64_t tmp_offs_172009 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171468.mem, tmp_offs_172009, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171298.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154426});
            tmp_offs_172009 += loop_dz2081Uz2089U_154426;
            if (!(tmp_offs_172009 == loop_dz2081Uz2089U_154426)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171468.mem, tmp_offs_172009, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171468.mem, loop_dz2081Uz2089U_154426, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154644});
            }
            tmp_offs_172009 += m_154644;
            if (memblock_set(ctx, &mem_param_tmp_171971, &mem_171466, "mem_171466") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171972, &mem_171468, "mem_171468") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171973, &mem_171448, "mem_171448") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171446, "mem_171446") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_171975 = conc_tmp_154683;
            
            if (memblock_set(ctx, &mem_param_171295, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171298, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171302, &mem_param_tmp_171973, "mem_param_tmp_171973") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171306, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            loop_dz2081Uz2089U_154426 = loop_dz2081Uz2089U_tmp_171975;
        }
        if (memblock_set(ctx, &ext_mem_171482, &mem_param_171295, "mem_param_171295") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171481, &mem_param_171298, "mem_param_171298") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171480, &mem_param_171302, "mem_param_171302") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171479, &mem_param_171306, "mem_param_171306") != 0)
            return 1;
        loopres_154420 = loop_dz2081Uz2089U_154426;
        
        bool cond_154687 = slt64((int64_t) 0, loopres_154420);
        bool loop_cond_t_res_154688 = slt32(newDepth_154451, max_depth_129501);
        bool x_154689 = cond_154687 && loop_cond_t_res_154688;
        
        if (memblock_set(ctx, &mem_param_tmp_171960, &ext_mem_171480, "ext_mem_171480") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171961, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171962, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &ext_mem_171481, "ext_mem_171481") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_171964 = loopres_154420;
        bool loop_while_tmp_171965 = x_154689;
        int32_t p_tmp_171966 = newDepth_154451;
        
        if (memblock_set(ctx, &mem_param_171282, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171961, "mem_param_tmp_171961") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171289, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171292, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        loop_dz2087U_154413 = loop_dz2087U_tmp_171964;
        loop_while_154414 = loop_while_tmp_171965;
        p_154415 = p_tmp_171966;
    }
    if (memblock_set(ctx, &ext_mem_171496, &mem_param_171282, "mem_param_171282") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171495, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171494, &mem_param_171289, "mem_param_171289") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171493, &mem_param_171292, "mem_param_171292") != 0)
        return 1;
    partition_and_deepen_res_154406 = loop_dz2087U_154413;
    partition_and_deepen_res_154407 = loop_while_154414;
    partition_and_deepen_res_154408 = p_154415;
    if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171495, "ext_mem_171495") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171496, "ext_mem_171496") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172473, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172474, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171321);
        free(mem_171355);
        free(mem_171357);
        free(mem_171366);
        free(mem_171367);
        free(mem_171398);
        free(mem_171400);
        free(mem_171402);
        free(mem_171404);
        free(mem_171430);
        free(mem_171432);
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171961, "mem_param_tmp_171961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171973, "mem_param_tmp_171973") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171972, "mem_param_tmp_171972") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171971, "mem_param_tmp_171971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171468, "mem_171468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171466, "mem_171466") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171448, "mem_171448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171446, "mem_171446") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171395, "ext_mem_171395") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171396, "ext_mem_171396") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171393, "mem_171393") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171982, "mem_param_tmp_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171981, "mem_param_tmp_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171345, "mem_171345") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171343, "mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171989, "mem_param_tmp_171989") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171332, "mem_171332") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171330, "mem_param_171330") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171316, "mem_param_171316") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171312, "mem_param_171312") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171390, "ext_mem_171390") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171391, "ext_mem_171391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171306, "mem_param_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171302, "mem_param_171302") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171298, "mem_param_171298") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171295, "mem_param_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171479, "ext_mem_171479") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171480, "ext_mem_171480") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171481, "ext_mem_171481") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171482, "ext_mem_171482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171292, "mem_param_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171289, "mem_param_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171282, "mem_param_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171493, "ext_mem_171493") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171494, "ext_mem_171494") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171495, "ext_mem_171495") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171496, "ext_mem_171496") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172486, struct memblock *mem_out_p_172487, struct memblock xs_mem_171274, int64_t n_130862, int64_t b_130863, int16_t block_sizze_130864, int64_t gather_psizze_130865, int32_t radix_sizze_130866, int64_t offset_130868, int64_t sizze_thresh_130869, int32_t max_depth_130870, int32_t bit_step_130871)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171319_cached_sizze_172488 = 0;
    unsigned char *mem_171319 = NULL;
    int64_t mem_171352_cached_sizze_172489 = 0;
    unsigned char *mem_171352 = NULL;
    int64_t mem_171354_cached_sizze_172490 = 0;
    unsigned char *mem_171354 = NULL;
    int64_t mem_171362_cached_sizze_172491 = 0;
    unsigned char *mem_171362 = NULL;
    int64_t mem_171390_cached_sizze_172492 = 0;
    unsigned char *mem_171390 = NULL;
    int64_t mem_171392_cached_sizze_172493 = 0;
    unsigned char *mem_171392 = NULL;
    int64_t mem_171394_cached_sizze_172494 = 0;
    unsigned char *mem_171394 = NULL;
    int64_t mem_171396_cached_sizze_172495 = 0;
    unsigned char *mem_171396 = NULL;
    int64_t mem_171422_cached_sizze_172496 = 0;
    unsigned char *mem_171422 = NULL;
    int64_t mem_171424_cached_sizze_172497 = 0;
    unsigned char *mem_171424 = NULL;
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_param_tmp_171964;
    
    mem_param_tmp_171964.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_param_tmp_171962;
    
    mem_param_tmp_171962.references = NULL;
    
    struct memblock mem_param_tmp_171976;
    
    mem_param_tmp_171976.references = NULL;
    
    struct memblock mem_param_tmp_171975;
    
    mem_param_tmp_171975.references = NULL;
    
    struct memblock mem_param_tmp_171974;
    
    mem_param_tmp_171974.references = NULL;
    
    struct memblock mem_param_tmp_171973;
    
    mem_param_tmp_171973.references = NULL;
    
    struct memblock mem_171460;
    
    mem_171460.references = NULL;
    
    struct memblock mem_171458;
    
    mem_171458.references = NULL;
    
    struct memblock mem_171440;
    
    mem_171440.references = NULL;
    
    struct memblock mem_171438;
    
    mem_171438.references = NULL;
    
    struct memblock ext_mem_171387;
    
    ext_mem_171387.references = NULL;
    
    struct memblock ext_mem_171388;
    
    ext_mem_171388.references = NULL;
    
    struct memblock mem_171385;
    
    mem_171385.references = NULL;
    
    struct memblock mem_param_tmp_171984;
    
    mem_param_tmp_171984.references = NULL;
    
    struct memblock mem_param_tmp_171983;
    
    mem_param_tmp_171983.references = NULL;
    
    struct memblock mem_171343;
    
    mem_171343.references = NULL;
    
    struct memblock mem_171341;
    
    mem_171341.references = NULL;
    
    struct memblock mem_param_tmp_171991;
    
    mem_param_tmp_171991.references = NULL;
    
    struct memblock mem_171330;
    
    mem_171330.references = NULL;
    
    struct memblock mem_param_171328;
    
    mem_param_171328.references = NULL;
    
    struct memblock ext_mem_171339;
    
    ext_mem_171339.references = NULL;
    
    struct memblock mem_param_171314;
    
    mem_param_171314.references = NULL;
    
    struct memblock mem_param_171311;
    
    mem_param_171311.references = NULL;
    
    struct memblock ext_mem_171382;
    
    ext_mem_171382.references = NULL;
    
    struct memblock ext_mem_171383;
    
    ext_mem_171383.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_171305;
    
    mem_param_171305.references = NULL;
    
    struct memblock mem_param_171301;
    
    mem_param_171301.references = NULL;
    
    struct memblock mem_param_171298;
    
    mem_param_171298.references = NULL;
    
    struct memblock mem_param_171295;
    
    mem_param_171295.references = NULL;
    
    struct memblock ext_mem_171470;
    
    ext_mem_171470.references = NULL;
    
    struct memblock ext_mem_171471;
    
    ext_mem_171471.references = NULL;
    
    struct memblock ext_mem_171472;
    
    ext_mem_171472.references = NULL;
    
    struct memblock ext_mem_171473;
    
    ext_mem_171473.references = NULL;
    
    struct memblock mem_param_171292;
    
    mem_param_171292.references = NULL;
    
    struct memblock mem_param_171289;
    
    mem_param_171289.references = NULL;
    
    struct memblock mem_param_171286;
    
    mem_param_171286.references = NULL;
    
    struct memblock mem_param_171282;
    
    mem_param_171282.references = NULL;
    
    struct memblock ext_mem_171483;
    
    ext_mem_171483.references = NULL;
    
    struct memblock ext_mem_171484;
    
    ext_mem_171484.references = NULL;
    
    struct memblock ext_mem_171485;
    
    ext_mem_171485.references = NULL;
    
    struct memblock ext_mem_171486;
    
    ext_mem_171486.references = NULL;
    
    struct memblock mem_171279;
    
    mem_171279.references = NULL;
    
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t is_154401 = add64(n_130862, offset_130868);
    bool bounds_invalid_upwards_154402 = slt64(is_154401, offset_130868);
    bool valid_154403 = !bounds_invalid_upwards_154402;
    bool range_valid_c_154404;
    
    if (!valid_154403) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) offset_130868, "..<", (long long) is_154401, " is invalid.", "-> #0  ftRelational.fut:230:15-34\n   #1  ftRelational.fut:220:3-233:33\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * n_130862;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171958 = 0; i_171958 < n_130862; i_171958++) {
        int64_t x_171959 = offset_130868 + i_171958 * (int64_t) 1;
        
        ((int64_t *) mem_171276.mem)[i_171958] = x_171959;
    }
    if (memblock_alloc(ctx, &mem_171277, (int64_t) 8, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171960 = 0; nest_i_171960 < (int64_t) 1; nest_i_171960++) {
        ((int64_t *) mem_171277.mem)[nest_i_171960] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171278, (int64_t) 8, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171961 = 0; nest_i_171961 < (int64_t) 1; nest_i_171961++) {
        ((int64_t *) mem_171278.mem)[nest_i_171961] = n_130862;
    }
    
    bool loop_cond_t_res_154408 = slt32(0, max_depth_130870);
    
    if (memblock_alloc(ctx, &mem_171279, (int64_t) 0, "mem_171279")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_154459 = sext_i64_i32(b_130863);
    int32_t zm_lhs_154460 = mul32(8, i64_res_154459);
    int32_t min_arg1_154461 = sub32(zm_lhs_154460, 1);
    int32_t s_sign_154468 = (bit_step_130871 > 0 ? 1 : 0) - (bit_step_130871 < 0 ? 1 : 0);
    int64_t s_sign_154469 = sext_i32_i64(s_sign_154468);
    bool downwards_154472 = s_sign_154468 == -1;
    bool x_154476 = !downwards_154472;
    int64_t subtracted_step_154485 = sext_i32_i64(bit_step_130871);
    int64_t pos_step_154486 = mul64(s_sign_154469, subtracted_step_154485);
    int32_t zm_lhs_154490 = add32(8, zm_lhs_154460);
    int32_t zs_lhs_154491 = sub32(zm_lhs_154490, 1);
    int32_t i32_arg0_154492 = sdiv32(zs_lhs_154491, 8);
    int64_t i32_res_154493 = sext_i32_i64(i32_arg0_154492);
    bool zzero_154494 = i32_res_154493 == (int64_t) 0;
    bool nonzzero_154495 = !zzero_154494;
    int64_t bytes_171437 = n_130862 * b_130863;
    
    if (mem_171362_cached_sizze_172491 < b_130863) {
        err = lexical_realloc(ctx, &mem_171362, &mem_171362_cached_sizze_172491, b_130863);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_154410;
    bool partition_and_deepen_res_154411;
    int32_t partition_and_deepen_res_154412;
    int64_t loop_dz2087U_154417;
    bool loop_while_154418;
    int32_t p_154419;
    
    if (memblock_set(ctx, &mem_param_171282, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171286, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171289, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171292, &mem_171278, "mem_171278") != 0)
        return 1;
    loop_dz2087U_154417 = (int64_t) 1;
    loop_while_154418 = loop_cond_t_res_154408;
    p_154419 = 0;
    while (loop_while_154418) {
        bool loop_nonempty_161767 = slt64((int64_t) 0, loop_dz2087U_154417);
        int32_t newDepth_154455 = add32(1, p_154419);
        int32_t new_i_154456 = mul32(radix_sizze_130866, p_154419);
        int32_t zm_lhs_154457 = mul32(radix_sizze_130866, newDepth_154455);
        int32_t new_j_154458 = sub32(zm_lhs_154457, 1);
        int32_t min_res_154462 = smin32(new_j_154458, min_arg1_154461);
        int32_t tmp_154463 = add32(bit_step_130871, new_i_154456);
        int64_t i_154464 = sext_i32_i64(new_i_154456);
        int64_t j__154465 = sext_i32_i64(min_res_154462);
        int64_t tmp_154466 = sext_i32_i64(tmp_154463);
        bool step_zzero_154467 = new_i_154456 == tmp_154463;
        bool bounds_invalid_downwards_154470 = slt32(new_i_154456, min_res_154462);
        bool bounds_invalid_upwards_154471 = slt32(min_res_154462, new_i_154456);
        int32_t distance_downwards_exclusive_154473 = sub32(new_i_154456, min_res_154462);
        int32_t distance_upwards_exclusive_154474 = sub32(min_res_154462, new_i_154456);
        bool x_154475 = bounds_invalid_downwards_154470 && downwards_154472;
        bool y_154477 = bounds_invalid_upwards_154471 && x_154476;
        bool bounds_invalid_154478 = x_154475 || y_154477;
        int32_t distance_exclusive_154479;
        
        if (downwards_154472) {
            distance_exclusive_154479 = distance_downwards_exclusive_154473;
        } else {
            distance_exclusive_154479 = distance_upwards_exclusive_154474;
        }
        
        int64_t distance_exclusive_154480 = sext_i32_i64(distance_exclusive_154479);
        int64_t distance_154481 = add64((int64_t) 1, distance_exclusive_154480);
        bool range_invalid_154482 = step_zzero_154467 || bounds_invalid_154478;
        bool valid_154483 = !range_invalid_154482;
        bool loop_not_taken_161768 = !loop_nonempty_161767;
        bool protect_assert_disj_161769 = valid_154483 || loop_not_taken_161768;
        bool range_valid_c_154484;
        
        if (!protect_assert_disj_161769) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_154464, "..", (long long) tmp_154466, "...", (long long) j__154465, " is invalid.", "-> #0  ftHashJoin.fut:223:15-37\n   #1  ftHashJoin.fut:266:20-272:13\n   #2  ftRelational.fut:232:7-99\n   #3  ftRelational.fut:220:3-233:33\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_154487 = sdiv_up_safe64(distance_154481, pos_step_154486);
        bool loop_nonempty_154488 = slt64((int64_t) 0, num_elems_154487);
        bool loop_not_taken_154496 = !loop_nonempty_154488;
        bool protect_assert_disj_154497 = nonzzero_154495 || loop_not_taken_154496;
        bool protect_assert_disj_161771 = protect_assert_disj_154497 || loop_not_taken_161768;
        bool nonzzero_cert_154498;
        
        if (!protect_assert_disj_161771) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:220:3-233:33\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154499 = sdiv_safe64(gather_psizze_130865, i32_res_154493);
        bool zzero_154502 = psizze__154499 == (int64_t) 0;
        bool nonzzero_154503 = !zzero_154502;
        bool protect_assert_disj_154504 = loop_not_taken_154496 || nonzzero_154503;
        bool protect_assert_disj_161773 = protect_assert_disj_154504 || loop_not_taken_161768;
        bool nonzzero_cert_154505;
        
        if (!protect_assert_disj_161773) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:220:3-233:33\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_154424;
        int64_t loop_dz2081Uz2089U_154430;
        
        if (memblock_set(ctx, &mem_param_171295, &mem_171279, "mem_171279") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171298, &mem_171279, "mem_171279") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171301, &mem_param_171282, "mem_param_171282") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171305, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        loop_dz2081Uz2089U_154430 = (int64_t) 0;
        for (int64_t i_154429 = 0; i_154429 < loop_dz2087U_154417; i_154429++) {
            int64_t bounds_154435 = ((int64_t *) mem_param_171289.mem)[i_154429];
            int64_t bounds_154436 = ((int64_t *) mem_param_171292.mem)[i_154429];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437 = sub64(bounds_154436, bounds_154435);
            bool empty_slice_154438 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437 == (int64_t) 0;
            int64_t m_154439 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, (int64_t) 1);
            int64_t i_p_m_t_s_154440 = add64(bounds_154435, m_154439);
            bool zzero_leq_i_p_m_t_s_154441 = sle64((int64_t) 0, i_p_m_t_s_154440);
            bool i_p_m_t_s_leq_w_154442 = slt64(i_p_m_t_s_154440, n_130862);
            bool zzero_lte_i_154443 = sle64((int64_t) 0, bounds_154435);
            bool i_lte_j_154444 = sle64(bounds_154435, bounds_154436);
            bool y_154445 = i_p_m_t_s_leq_w_154442 && zzero_lte_i_154443;
            bool y_154446 = zzero_leq_i_p_m_t_s_154441 && y_154445;
            bool forwards_ok_154447 = i_lte_j_154444 && y_154446;
            bool ok_or_empty_154448 = empty_slice_154438 || forwards_ok_154447;
            bool index_certs_154449;
            
            if (!ok_or_empty_154448) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_154435, ":", (long long) bounds_154436, "] out of bounds for array of shape [", (long long) n_130862, "].", "-> #0  ftHashJoin.fut:300:21-47\n   #1  ftRelational.fut:232:7-99\n   #2  ftRelational.fut:220:3-233:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171306 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437;
            
            if (memblock_alloc(ctx, &mem_171307, bytes_171306, "mem_171307")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_171982 = 0; nest_i_171982 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437; nest_i_171982++) {
                ((int64_t *) mem_171307.mem)[nest_i_171982] = (int64_t) 0;
            }
            
            int64_t zm_lhs_154500 = add64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, psizze__154499);
            int64_t zs_lhs_154501 = sub64(zm_lhs_154500, (int64_t) 1);
            int64_t max_iter_154506 = sdiv_safe64(zs_lhs_154501, psizze__154499);
            bool bounds_invalid_upwards_154507 = slt64(max_iter_154506, (int64_t) 0);
            bool valid_154508 = !bounds_invalid_upwards_154507;
            bool protect_assert_disj_154509 = loop_not_taken_154496 || valid_154508;
            bool range_valid_c_154510;
            
            if (!protect_assert_disj_154509) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154506, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftHashJoin.fut:210:83-86\n   #3  ftHashJoin.fut:224:6-71\n   #4  ftHashJoin.fut:266:20-272:13\n   #5  ftRelational.fut:232:7-99\n   #6  ftRelational.fut:220:3-233:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_y_171315 = b_130863 * bounds_154435;
            int64_t bytes_171340 = b_130863 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437;
            
            if (mem_171319_cached_sizze_172488 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437) {
                err = lexical_realloc(ctx, &mem_171319, &mem_171319_cached_sizze_172488, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_171381;
            int64_t ext_171378;
            int64_t ctx_param_ext_171308;
            int64_t ctx_param_ext_171312;
            
            if (memblock_set(ctx, &mem_param_171311, &mem_param_171305, "mem_param_171305") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171314, &mem_param_171301, "mem_param_171301") != 0)
                return 1;
            ctx_param_ext_171308 = binop_y_171315;
            ctx_param_ext_171312 = bounds_154435;
            for (int64_t i_154513 = 0; i_154513 < num_elems_154487; i_154513++) {
                int32_t binop_x_154516 = sext_i64_i32(i_154513);
                int32_t binop_x_154517 = mul32(bit_step_130871, binop_x_154516);
                int32_t index_primexp_154518 = add32(new_i_154456, binop_x_154517);
                int32_t zm_lhs_154519 = add32(bit_step_130871, index_primexp_154518);
                int32_t min_arg1_154520 = sub32(zm_lhs_154519, 1);
                int32_t min_res_154521 = smin32(min_res_154462, min_arg1_154520);
                int32_t zp_lhs_154522 = sub32(min_res_154521, index_primexp_154518);
                int32_t ij_bits_154523 = add32(1, zp_lhs_154522);
                int32_t up_to_154524 = shl32(1, ij_bits_154523);
                int64_t tmp_154525 = sext_i32_i64(zp_lhs_154522);
                bool bounds_invalid_upwards_154526 = slt32(zp_lhs_154522, 0);
                bool valid_154528 = !bounds_invalid_upwards_154526;
                bool range_valid_c_154529;
                
                if (!valid_154528) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154525, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:210:83-86\n   #3  ftHashJoin.fut:224:6-71\n   #4  ftHashJoin.fut:266:20-272:13\n   #5  ftRelational.fut:232:7-99\n   #6  ftRelational.fut:220:3-233:33\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_154539 = sext_i32_i64(up_to_154524);
                bool bounds_invalid_upwards_154540 = slt32(up_to_154524, 0);
                bool valid_154541 = !bounds_invalid_upwards_154540;
                bool range_valid_c_154542;
                
                if (!valid_154541) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154539, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:220:3-233:33\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_154527 = add64((int64_t) 1, tmp_154525);
                
                for (int64_t i_171003 = 0; i_171003 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437; i_171003++) {
                    int8_t defunc_0_f_res_154532;
                    int8_t y_154534 = (int8_t) 0;
                    
                    for (int64_t i_154533 = 0; i_154533 < distance_154527; i_154533++) {
                        int32_t binop_x_154535 = sext_i64_i32(i_154533);
                        int32_t get_bit_arg0_154536 = add32(index_primexp_154518, binop_x_154535);
                        int32_t zm_rhs_161940 = sdiv32(get_bit_arg0_154536, 8);
                        int32_t zm_lhs_161941 = sub32(i64_res_154459, zm_rhs_161940);
                        int32_t whichByte_161942 = sub32(zm_lhs_161941, 1);
                        int64_t whichByte_161944 = sext_i32_i64(whichByte_161942);
                        bool x_161945 = sle64((int64_t) 0, whichByte_161944);
                        bool y_161946 = slt64(whichByte_161944, b_130863);
                        bool bounds_check_161947 = x_161945 && y_161946;
                        bool index_certs_161948;
                        
                        if (!bounds_check_161947) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_161944, "] out of bounds for array of shape [", (long long) b_130863, "].", "-> #0  ftHashJoin.fut:18:6-18\n   #1  ftRelational.fut:232:7-99\n   #2  ftRelational.fut:220:3-233:33\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_161943 = smod32(get_bit_arg0_154536, 8);
                        int8_t zbzg_lhs_161949 = ((int8_t *) mem_param_171311.mem)[ctx_param_ext_171308 + (i_171003 * b_130863 + whichByte_161944)];
                        int8_t unsign_arg0_161950 = zext_i32_i8(whichBit_161943);
                        int8_t unsign_arg0_161951 = ashr8(zbzg_lhs_161949, unsign_arg0_161950);
                        int8_t unsign_arg0_161952 = (int8_t) 1 & unsign_arg0_161951;
                        int32_t to_i32_res_161953 = zext_i8_i32(unsign_arg0_161952);
                        int8_t loopres_154538;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_154538, binop_x_154535, y_154534, to_i32_res_161953) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_171990 = loopres_154538;
                        
                        y_154534 = y_tmp_171990;
                    }
                    defunc_0_f_res_154532 = y_154534;
                    ((int8_t *) mem_171319)[i_171003] = defunc_0_f_res_154532;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_154543;
                int64_t offs_154546;
                
                if (memblock_set(ctx, &mem_param_171328, &mem_171307, "mem_171307") != 0)
                    return 1;
                offs_154546 = (int64_t) 0;
                for (int64_t i_154545 = 0; i_154545 < up_to_154539; i_154545++) {
                    int32_t binop_x_154548 = sext_i64_i32(i_154545);
                    int8_t index_primexp_154549 = zext_i32_i8(binop_x_154548);
                    
                    if (memblock_alloc(ctx, &mem_171330, bytes_171306, "mem_171330")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_162374;
                    int64_t defunc_0_reduce_res_162375;
                    int64_t inpacc_162204;
                    int64_t inpacc_162205;
                    
                    inpacc_162204 = (int64_t) 0;
                    inpacc_162205 = (int64_t) 0;
                    for (int64_t i_171021 = 0; i_171021 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437; i_171021++) {
                        int8_t eta_p_171252 = ((int8_t *) mem_171319)[i_171021];
                        bool lifted_lambda_res_171253 = eta_p_171252 == index_primexp_154549;
                        int64_t bool_res_171254 = btoi_bool_i64(lifted_lambda_res_171253);
                        int64_t eta_p_171267 = ((int64_t *) mem_param_171328.mem)[i_171021];
                        int64_t defunc_0_op_res_171268 = add64(inpacc_162204, bool_res_171254);
                        int64_t zm_lhs_171269 = add64(offs_154546, defunc_0_op_res_171268);
                        int64_t lifted_lambda_res_171270 = sub64(zm_lhs_171269, (int64_t) 1);
                        int64_t defunc_0_f_res_171271 = mul64(bool_res_171254, lifted_lambda_res_171270);
                        int64_t defunc_0_f_res_171272 = add64(eta_p_171267, defunc_0_f_res_171271);
                        int64_t defunc_0_op_res_162253 = add64(inpacc_162205, bool_res_171254);
                        
                        ((int64_t *) mem_171330.mem)[i_171021] = defunc_0_f_res_171272;
                        
                        int64_t inpacc_tmp_171994 = defunc_0_op_res_171268;
                        int64_t inpacc_tmp_171995 = defunc_0_op_res_162253;
                        
                        inpacc_162204 = inpacc_tmp_171994;
                        inpacc_162205 = inpacc_tmp_171995;
                    }
                    inpacc_162374 = inpacc_162204;
                    defunc_0_reduce_res_162375 = inpacc_162205;
                    
                    int64_t tmp_154574 = add64(offs_154546, defunc_0_reduce_res_162375);
                    
                    if (memblock_set(ctx, &mem_param_tmp_171991, &mem_171330, "mem_171330") != 0)
                        return 1;
                    
                    int64_t offs_tmp_171992 = tmp_154574;
                    
                    if (memblock_set(ctx, &mem_param_171328, &mem_param_tmp_171991, "mem_param_tmp_171991") != 0)
                        return 1;
                    offs_154546 = offs_tmp_171992;
                }
                if (memblock_set(ctx, &ext_mem_171339, &mem_param_171328, "mem_param_171328") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_154543 = offs_154546;
                if (memblock_alloc(ctx, &mem_171341, bytes_171340, "mem_171341")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_171341.mem, (int64_t) 0, (int64_t []) {b_130863, (int64_t) 1}, (uint8_t *) mem_param_171311.mem, ctx_param_ext_171308, (int64_t []) {b_130863, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, b_130863});
                if (memblock_alloc(ctx, &mem_171343, bytes_171306, "mem_171343")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171343.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171314.mem, ctx_param_ext_171312, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437});
                for (int64_t i_154583 = 0; i_154583 < max_iter_154506; i_154583++) {
                    int64_t inf_154586 = mul64(psizze__154499, i_154583);
                    int64_t min_arg1_154587 = add64(psizze__154499, inf_154586);
                    int64_t min_res_154588 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, min_arg1_154587);
                    bool zzero_lte_i_154598 = sle64((int64_t) 0, inf_154586);
                    int64_t j_m_i_154592 = sub64(min_res_154588, inf_154586);
                    int64_t m_154594 = sub64(j_m_i_154592, (int64_t) 1);
                    int64_t i_p_m_t_s_154595 = add64(inf_154586, m_154594);
                    bool i_p_m_t_s_leq_w_154597 = slt64(i_p_m_t_s_154595, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437);
                    bool y_154600 = i_p_m_t_s_leq_w_154597 && zzero_lte_i_154598;
                    bool zzero_leq_i_p_m_t_s_154596 = sle64((int64_t) 0, i_p_m_t_s_154595);
                    bool y_154601 = zzero_leq_i_p_m_t_s_154596 && y_154600;
                    bool i_lte_j_154599 = sle64(inf_154586, min_res_154588);
                    bool forwards_ok_154602 = i_lte_j_154599 && y_154601;
                    bool empty_slice_154593 = j_m_i_154592 == (int64_t) 0;
                    bool ok_or_empty_154603 = empty_slice_154593 || forwards_ok_154602;
                    bool index_certs_154604;
                    
                    if (!ok_or_empty_154603) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154586, ":", (long long) min_res_154588, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftHashJoin.fut:210:83-86\n   #2  ftHashJoin.fut:224:6-71\n   #3  ftHashJoin.fut:266:20-272:13\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:220:3-233:33\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_171351 = (int64_t) 8 * j_m_i_154592;
                    int64_t bytes_171353 = b_130863 * j_m_i_154592;
                    
                    if (mem_171352_cached_sizze_172489 < bytes_171351) {
                        err = lexical_realloc(ctx, &mem_171352, &mem_171352_cached_sizze_172489, bytes_171351);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171352, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171343.mem, (int64_t) 0 + (int64_t) 1 * inf_154586, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154592});
                    if (mem_171354_cached_sizze_172490 < bytes_171353) {
                        err = lexical_realloc(ctx, &mem_171354, &mem_171354_cached_sizze_172490, bytes_171353);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171354, (int64_t) 0, (int64_t []) {b_130863, (int64_t) 1}, (uint8_t *) mem_171341.mem, (int64_t) 0 + b_130863 * inf_154586, (int64_t []) {b_130863, (int64_t) 1}, (int64_t []) {j_m_i_154592, b_130863});
                    for (int64_t write_iter_171023 = 0; write_iter_171023 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437; write_iter_171023++) {
                        int64_t write_iv_171026 = ((int64_t *) ext_mem_171339.mem)[write_iter_171023];
                        int64_t write_iv_171028 = ((int64_t *) mem_param_171314.mem)[ctx_param_ext_171312 + write_iter_171023];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171311.mem, ctx_param_ext_171308 + write_iter_171023 * b_130863, (int64_t []) {(int64_t) 1}, (int64_t []) {b_130863});
                        
                        int64_t lifted_lambda_res_162296 = sub64(write_iv_171026, inf_154586);
                        
                        if ((sle64((int64_t) 0, lifted_lambda_res_162296) && slt64(lifted_lambda_res_162296, j_m_i_154592)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_130863 - (int64_t) 1, b_130863))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171354, lifted_lambda_res_162296 * b_130863, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_130863});
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_162296) && slt64(lifted_lambda_res_162296, j_m_i_154592)) {
                            ((int64_t *) mem_171352)[lifted_lambda_res_162296] = write_iv_171028;
                        }
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171341.mem, b_130863 * inf_154586, (int64_t []) {b_130863, (int64_t) 1}, (uint8_t *) mem_171354, (int64_t) 0, (int64_t []) {b_130863, (int64_t) 1}, (int64_t []) {j_m_i_154592, b_130863});
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171343.mem, inf_154586, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171352, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154592});
                }
                if (memblock_unref(ctx, &ext_mem_171339, "ext_mem_171339") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_171983, &mem_171341, "mem_171341") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_171984, &mem_171343, "mem_171343") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_171985 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_171986 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_171311, &mem_param_tmp_171983, "mem_param_tmp_171983") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171314, &mem_param_tmp_171984, "mem_param_tmp_171984") != 0)
                    return 1;
                ctx_param_ext_171308 = ctx_param_ext_tmp_171985;
                ctx_param_ext_171312 = ctx_param_ext_tmp_171986;
            }
            if (memblock_set(ctx, &ext_mem_171383, &mem_param_171311, "mem_param_171311") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171382, &mem_param_171314, "mem_param_171314") != 0)
                return 1;
            ext_171381 = ctx_param_ext_171308;
            ext_171378 = ctx_param_ext_171312;
            if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171385, bytes_171340, "mem_171385")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171385.mem, (int64_t) 0, (int64_t []) {b_130863, (int64_t) 1}, (uint8_t *) ext_mem_171383.mem, ext_171381, (int64_t []) {b_130863, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, b_130863});
            
            int64_t deepen_step_res_154616;
            int64_t deepen_step_res_154617;
            int32_t deepen_step_res_154620;
            
            if (futrts_getPartitionBounds_16843(ctx, &ext_mem_171388, &ext_mem_171387, &deepen_step_res_154616, &deepen_step_res_154617, &deepen_step_res_154620, mem_171385, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, b_130863, newDepth_154455, new_i_154456, new_j_154458) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_171385, "mem_171385") != 0)
                return 1;
            
            int64_t zl_rhs_161783 = sub64(deepen_step_res_154616, (int64_t) 1);
            int64_t bytes_171389 = (int64_t) 8 * deepen_step_res_154616;
            
            if (mem_171390_cached_sizze_172492 < bytes_171389) {
                err = lexical_realloc(ctx, &mem_171390, &mem_171390_cached_sizze_172492, bytes_171389);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171392_cached_sizze_172493 < bytes_171389) {
                err = lexical_realloc(ctx, &mem_171392, &mem_171392_cached_sizze_172493, bytes_171389);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171394_cached_sizze_172494 < bytes_171389) {
                err = lexical_realloc(ctx, &mem_171394, &mem_171394_cached_sizze_172494, bytes_171389);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171396_cached_sizze_172495 < bytes_171389) {
                err = lexical_realloc(ctx, &mem_171396, &mem_171396_cached_sizze_172495, bytes_171389);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171045;
            int64_t scanacc_171035 = (int64_t) 0;
            
            for (int64_t i_171040 = 0; i_171040 < deepen_step_res_154616; i_171040++) {
                int64_t tmp_161993 = ((int64_t *) ext_mem_171388.mem)[i_171040];
                bool cond_161994 = slt64(i_171040, zl_rhs_161783);
                int64_t tmp_161995;
                
                if (cond_161994) {
                    int64_t tmp_162380 = add64((int64_t) 1, i_171040);
                    bool x_162381 = sle64((int64_t) 0, tmp_162380);
                    bool y_162382 = slt64(tmp_162380, deepen_step_res_154616);
                    bool bounds_check_162383 = x_162381 && y_162382;
                    bool index_certs_162384;
                    
                    if (!bounds_check_162383) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162380, "] out of bounds for array of shape [", (long long) deepen_step_res_154616, "].", "-> #0  ftHashJoin.fut:276:67-81\n   #1  ftRelational.fut:232:7-99\n   #2  ftRelational.fut:220:3-233:33\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_162385 = ((int64_t *) ext_mem_171388.mem)[tmp_162380];
                    
                    tmp_161995 = tmp_t_res_162385;
                } else {
                    tmp_161995 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437;
                }
                
                int64_t zg_lhs_162004 = sub64(tmp_161995, tmp_161993);
                bool lifted_lambda_res_162005 = slt64(sizze_thresh_130869, zg_lhs_162004);
                int64_t defunc_0_f_res_162006 = btoi_bool_i64(lifted_lambda_res_162005);
                int64_t defunc_0_op_res_154637 = add64(defunc_0_f_res_162006, scanacc_171035);
                
                ((int64_t *) mem_171390)[i_171040] = defunc_0_op_res_154637;
                ((int64_t *) mem_171392)[i_171040] = defunc_0_f_res_162006;
                ((int64_t *) mem_171394)[i_171040] = tmp_161993;
                ((int64_t *) mem_171396)[i_171040] = tmp_161995;
                
                int64_t scanacc_tmp_172001 = defunc_0_op_res_154637;
                
                scanacc_171035 = scanacc_tmp_172001;
            }
            discard_171045 = scanacc_171035;
            if (memblock_unref(ctx, &ext_mem_171388, "ext_mem_171388") != 0)
                return 1;
            
            bool cond_154638 = deepen_step_res_154616 == (int64_t) 0;
            bool x_154639 = !cond_154638;
            bool x_154641 = sle64((int64_t) 0, zl_rhs_161783);
            bool y_154642 = slt64(zl_rhs_161783, deepen_step_res_154616);
            bool bounds_check_154643 = x_154641 && y_154642;
            bool protect_assert_disj_154644 = cond_154638 || bounds_check_154643;
            bool index_certs_154645;
            
            if (!protect_assert_disj_154644) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_161783, "] out of bounds for array of shape [", (long long) deepen_step_res_154616, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:277:8-49\n   #3  ftRelational.fut:232:7-99\n   #4  ftRelational.fut:220:3-233:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_154646;
            
            if (x_154639) {
                int64_t x_162386 = ((int64_t *) mem_171390)[zl_rhs_161783];
                
                m_f_res_154646 = x_162386;
            } else {
                m_f_res_154646 = (int64_t) 0;
            }
            
            int64_t m_154648;
            
            if (cond_154638) {
                m_154648 = (int64_t) 0;
            } else {
                m_154648 = m_f_res_154646;
            }
            
            int64_t m_154658 = sub64(m_154648, (int64_t) 1);
            bool i_p_m_t_s_leq_w_154660 = slt64(m_154658, deepen_step_res_154616);
            bool zzero_leq_i_p_m_t_s_154659 = sle64((int64_t) 0, m_154658);
            bool y_154662 = zzero_leq_i_p_m_t_s_154659 && i_p_m_t_s_leq_w_154660;
            bool i_lte_j_154661 = sle64((int64_t) 0, m_154648);
            bool forwards_ok_154663 = i_lte_j_154661 && y_154662;
            bool eq_x_zz_154655 = (int64_t) 0 == m_f_res_154646;
            bool p_and_eq_x_y_154656 = x_154639 && eq_x_zz_154655;
            bool empty_slice_154657 = cond_154638 || p_and_eq_x_y_154656;
            bool ok_or_empty_154664 = empty_slice_154657 || forwards_ok_154663;
            bool index_certs_154665;
            
            if (!ok_or_empty_154664) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154648, "] out of bounds for array of shape [", (long long) deepen_step_res_154616, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:277:8-49\n   #3  ftRelational.fut:232:7-99\n   #4  ftRelational.fut:220:3-233:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171421 = (int64_t) 8 * m_154648;
            int64_t conc_tmp_154687 = loop_dz2081Uz2089U_154430 + m_154648;
            int64_t bytes_171457 = (int64_t) 8 * conc_tmp_154687;
            
            if (mem_171422_cached_sizze_172496 < bytes_171421) {
                err = lexical_realloc(ctx, &mem_171422, &mem_171422_cached_sizze_172496, bytes_171421);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171422, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171396, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154648});
            if (mem_171424_cached_sizze_172497 < bytes_171421) {
                err = lexical_realloc(ctx, &mem_171424, &mem_171424_cached_sizze_172497, bytes_171421);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171424, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171394, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154648});
            for (int64_t write_iter_171046 = 0; write_iter_171046 < deepen_step_res_154616; write_iter_171046++) {
                int64_t write_iv_171049 = ((int64_t *) mem_171392)[write_iter_171046];
                int64_t write_iv_171050 = ((int64_t *) mem_171390)[write_iter_171046];
                int64_t write_iv_171051 = ((int64_t *) mem_171394)[write_iter_171046];
                int64_t write_iv_171052 = ((int64_t *) mem_171396)[write_iter_171046];
                bool cond_161975 = write_iv_171049 == (int64_t) 1;
                int64_t lifted_lambda_res_161976;
                
                if (cond_161975) {
                    int64_t lifted_lambda_res_t_res_162387 = sub64(write_iv_171050, (int64_t) 1);
                    
                    lifted_lambda_res_161976 = lifted_lambda_res_t_res_162387;
                } else {
                    lifted_lambda_res_161976 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_161976) && slt64(lifted_lambda_res_161976, m_154648)) {
                    ((int64_t *) mem_171424)[lifted_lambda_res_161976] = write_iv_171051;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_161976) && slt64(lifted_lambda_res_161976, m_154648)) {
                    ((int64_t *) mem_171422)[lifted_lambda_res_161976] = write_iv_171052;
                }
            }
            if (memblock_alloc(ctx, &mem_171438, bytes_171437, "mem_171438")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171438.mem, (int64_t) 0, (int64_t []) {b_130863, (int64_t) 1}, (uint8_t *) mem_param_171305.mem, (int64_t) 0, (int64_t []) {b_130863, (int64_t) 1}, (int64_t []) {n_130862, b_130863});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171438.mem, b_130863 * bounds_154435, (int64_t []) {b_130863, (int64_t) 1}, (uint8_t *) ext_mem_171383.mem, ext_171381, (int64_t []) {b_130863, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437, b_130863});
            if (memblock_unref(ctx, &ext_mem_171383, "ext_mem_171383") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171440, bytes_171275, "mem_171440")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171440.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171301.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_130862});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171440.mem, bounds_154435, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171382.mem, ext_171378, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154437});
            if (memblock_unref(ctx, &ext_mem_171382, "ext_mem_171382") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171458, bytes_171457, "mem_171458")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_171460, bytes_171457, "mem_171460")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171059 = 0; i_171059 < m_154648; i_171059++) {
                int64_t eta_p_154683 = ((int64_t *) mem_171424)[i_171059];
                int64_t eta_p_154684 = ((int64_t *) mem_171422)[i_171059];
                int64_t tmp_154685 = add64(bounds_154435, eta_p_154683);
                int64_t tmp_154686 = add64(bounds_154435, eta_p_154684);
                
                ((int64_t *) mem_171458.mem)[loop_dz2081Uz2089U_154430 + i_171059] = tmp_154685;
                ((int64_t *) mem_171460.mem)[loop_dz2081Uz2089U_154430 + i_171059] = tmp_154686;
            }
            
            int64_t tmp_offs_172010 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458.mem, tmp_offs_172010, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171295.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154430});
            tmp_offs_172010 += loop_dz2081Uz2089U_154430;
            if (!(tmp_offs_172010 == loop_dz2081Uz2089U_154430)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171458.mem, tmp_offs_172010, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171458.mem, loop_dz2081Uz2089U_154430, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154648});
            }
            tmp_offs_172010 += m_154648;
            
            int64_t tmp_offs_172011 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171460.mem, tmp_offs_172011, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171298.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154430});
            tmp_offs_172011 += loop_dz2081Uz2089U_154430;
            if (!(tmp_offs_172011 == loop_dz2081Uz2089U_154430)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171460.mem, tmp_offs_172011, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171460.mem, loop_dz2081Uz2089U_154430, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154648});
            }
            tmp_offs_172011 += m_154648;
            if (memblock_set(ctx, &mem_param_tmp_171973, &mem_171458, "mem_171458") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171974, &mem_171460, "mem_171460") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171975, &mem_171440, "mem_171440") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_171976, &mem_171438, "mem_171438") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_171977 = conc_tmp_154687;
            
            if (memblock_set(ctx, &mem_param_171295, &mem_param_tmp_171973, "mem_param_tmp_171973") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171298, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171301, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171305, &mem_param_tmp_171976, "mem_param_tmp_171976") != 0)
                return 1;
            loop_dz2081Uz2089U_154430 = loop_dz2081Uz2089U_tmp_171977;
        }
        if (memblock_set(ctx, &ext_mem_171473, &mem_param_171295, "mem_param_171295") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171472, &mem_param_171298, "mem_param_171298") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171471, &mem_param_171301, "mem_param_171301") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171470, &mem_param_171305, "mem_param_171305") != 0)
            return 1;
        loopres_154424 = loop_dz2081Uz2089U_154430;
        
        bool cond_154691 = slt64((int64_t) 0, loopres_154424);
        bool loop_cond_t_res_154692 = slt32(newDepth_154455, max_depth_130870);
        bool x_154693 = cond_154691 && loop_cond_t_res_154692;
        
        if (memblock_set(ctx, &mem_param_tmp_171962, &ext_mem_171471, "ext_mem_171471") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171963, &ext_mem_171470, "ext_mem_171470") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171964, &ext_mem_171473, "ext_mem_171473") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171965, &ext_mem_171472, "ext_mem_171472") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_171966 = loopres_154424;
        bool loop_while_tmp_171967 = x_154693;
        int32_t p_tmp_171968 = newDepth_154455;
        
        if (memblock_set(ctx, &mem_param_171282, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171286, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171289, &mem_param_tmp_171964, "mem_param_tmp_171964") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171292, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        loop_dz2087U_154417 = loop_dz2087U_tmp_171966;
        loop_while_154418 = loop_while_tmp_171967;
        p_154419 = p_tmp_171968;
    }
    if (memblock_set(ctx, &ext_mem_171486, &mem_param_171282, "mem_param_171282") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171485, &mem_param_171286, "mem_param_171286") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171484, &mem_param_171289, "mem_param_171289") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171483, &mem_param_171292, "mem_param_171292") != 0)
        return 1;
    partition_and_deepen_res_154410 = loop_dz2087U_154417;
    partition_and_deepen_res_154411 = loop_while_154418;
    partition_and_deepen_res_154412 = p_154419;
    if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171279, "mem_171279") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171486, "ext_mem_171486") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171485, "ext_mem_171485") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172486, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172487, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171319);
        free(mem_171352);
        free(mem_171354);
        free(mem_171362);
        free(mem_171390);
        free(mem_171392);
        free(mem_171394);
        free(mem_171396);
        free(mem_171422);
        free(mem_171424);
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171964, "mem_param_tmp_171964") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171962, "mem_param_tmp_171962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171976, "mem_param_tmp_171976") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171975, "mem_param_tmp_171975") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171974, "mem_param_tmp_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171973, "mem_param_tmp_171973") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171460, "mem_171460") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171458, "mem_171458") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171440, "mem_171440") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171438, "mem_171438") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171387, "ext_mem_171387") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171388, "ext_mem_171388") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171385, "mem_171385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171984, "mem_param_tmp_171984") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171983, "mem_param_tmp_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171343, "mem_171343") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171341, "mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171991, "mem_param_tmp_171991") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171330, "mem_171330") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171328, "mem_param_171328") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171339, "ext_mem_171339") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171314, "mem_param_171314") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171311, "mem_param_171311") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171382, "ext_mem_171382") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171383, "ext_mem_171383") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171305, "mem_param_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171301, "mem_param_171301") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171298, "mem_param_171298") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171295, "mem_param_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171470, "ext_mem_171470") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171471, "ext_mem_171471") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171472, "ext_mem_171472") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171473, "ext_mem_171473") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171292, "mem_param_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171289, "mem_param_171289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171286, "mem_param_171286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171282, "mem_param_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171483, "ext_mem_171483") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171484, "ext_mem_171484") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171485, "ext_mem_171485") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171486, "ext_mem_171486") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171279, "mem_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_172498, struct memblock *mem_out_p_172499, struct memblock xs_mem_171274, int64_t n_102646, int64_t incr_102647, int64_t block_sizze_102648)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171284_cached_sizze_172500 = 0;
    unsigned char *mem_171284 = NULL;
    int64_t mem_171316_cached_sizze_172501 = 0;
    unsigned char *mem_171316 = NULL;
    int64_t mem_171318_cached_sizze_172502 = 0;
    unsigned char *mem_171318 = NULL;
    struct memblock mem_171346;
    
    mem_171346.references = NULL;
    
    struct memblock mem_171344;
    
    mem_171344.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171308;
    
    mem_171308.references = NULL;
    
    struct memblock mem_171306;
    
    mem_171306.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171295;
    
    mem_171295.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171304;
    
    ext_mem_171304.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171341;
    
    ext_mem_171341.references = NULL;
    
    struct memblock ext_mem_171342;
    
    ext_mem_171342.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_102646;
    
    if (futrts_indicesWithIncrement_16342(ctx, &ext_mem_171275, xs_mem_171274, n_102646, incr_102647) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_102646; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171284_cached_sizze_172500 < n_102646) {
        err = lexical_realloc(ctx, &mem_171284, &mem_171284_cached_sizze_172500, n_102646);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171283, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    for (int64_t i_155969 = 0; i_155969 < (int64_t) 32; i_155969++) {
        int32_t binop_x_155972 = sext_i64_i32(i_155969);
        int32_t binop_x_155973 = mul32(2, binop_x_155972);
        int32_t zm_lhs_155974 = add32(2, binop_x_155973);
        int32_t min_arg1_155975 = sub32(zm_lhs_155974, 1);
        int32_t min_res_155976 = smin32(64, min_arg1_155975);
        int32_t zp_lhs_155977 = sub32(64, binop_x_155973);
        int32_t ij_bits_155978 = add32(1, zp_lhs_155977);
        int32_t up_to_155979 = shl32(1, ij_bits_155978);
        int64_t tmp_155980 = sext_i32_i64(zp_lhs_155977);
        bool bounds_invalid_upwards_155981 = slt32(zp_lhs_155977, 0);
        bool valid_155983 = !bounds_invalid_upwards_155981;
        bool range_valid_c_155984;
        
        if (!valid_155983) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_155980, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:133:71-82\n   #6  ftRelational.fut:132:5-133:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156008 = sext_i32_i64(up_to_155979);
        bool bounds_invalid_upwards_156009 = slt32(up_to_155979, 0);
        bool valid_156010 = !bounds_invalid_upwards_156009;
        bool range_valid_c_156011;
        
        if (!valid_156010) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156008, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:133:71-82\n   #5  ftRelational.fut:132:5-133:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156050 = add32(8, min_res_155976);
        int32_t zs_lhs_156051 = sub32(zm_lhs_156050, 1);
        int32_t i32_arg0_156052 = sdiv32(zs_lhs_156051, 8);
        int64_t i32_res_156053 = sext_i32_i64(i32_arg0_156052);
        bool zzero_156054 = i32_res_156053 == (int64_t) 0;
        bool nonzzero_156055 = !zzero_156054;
        bool nonzzero_cert_156056;
        
        if (!nonzzero_156055) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:133:71-82\n   #5  ftRelational.fut:132:5-133:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156057 = sdiv64(block_sizze_102648, i32_res_156053);
        int64_t zm_lhs_156058 = add64(n_102646, psizze__156057);
        int64_t zs_lhs_156059 = sub64(zm_lhs_156058, (int64_t) 1);
        bool zzero_156060 = psizze__156057 == (int64_t) 0;
        bool nonzzero_156061 = !zzero_156060;
        bool nonzzero_cert_156062;
        
        if (!nonzzero_156061) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:133:71-82\n   #5  ftRelational.fut:132:5-133:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156063 = sdiv64(zs_lhs_156059, psizze__156057);
        bool bounds_invalid_upwards_156064 = slt64(max_iter_156063, (int64_t) 0);
        bool valid_156065 = !bounds_invalid_upwards_156064;
        bool range_valid_c_156066;
        
        if (!valid_156065) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156063, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:133:71-82\n   #6  ftRelational.fut:132:5-133:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_155982 = add64((int64_t) 1, tmp_155980);
        
        for (int64_t i_171003 = 0; i_171003 < n_102646; i_171003++) {
            double eta_p_155986 = ((double *) mem_param_171283.mem)[i_171003];
            int64_t i64_arg0_155987 = futrts_to_bits64(eta_p_155986);
            int64_t unsign_arg0_155988 = ashr64(i64_arg0_155987, (int64_t) 63);
            int64_t unsign_arg0_155989 = (int64_t) 1 & unsign_arg0_155988;
            int32_t to_i32_res_155990 = zext_i64_i32(unsign_arg0_155989);
            bool cond_155991 = to_i32_res_155990 == 1;
            bool x_155992 = !cond_155991;
            int8_t defunc_0_f_res_155993;
            int8_t y_155995 = (int8_t) 0;
            
            for (int64_t i_155994 = 0; i_155994 < distance_155982; i_155994++) {
                int32_t binop_x_155996 = sext_i64_i32(i_155994);
                int32_t get_bit_arg0_155997 = add32(binop_x_155973, binop_x_155996);
                int64_t unsign_arg0_155998 = zext_i32_i64(get_bit_arg0_155997);
                int64_t unsign_arg0_155999 = ashr64(i64_arg0_155987, unsign_arg0_155998);
                int64_t unsign_arg0_156000 = (int64_t) 1 & unsign_arg0_155999;
                int32_t to_i32_res_156001 = zext_i64_i32(unsign_arg0_156000);
                bool cond_f_res_156002 = get_bit_arg0_155997 == 63;
                bool y_156003 = x_155992 && cond_f_res_156002;
                bool cond_156004 = cond_155991 || y_156003;
                int32_t defunc_0_get_bit_res_156005;
                
                if (cond_156004) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ to_i32_res_156001;
                    
                    defunc_0_get_bit_res_156005 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_156005 = to_i32_res_156001;
                }
                
                int8_t loopres_156007;
                
                if (futrts_set_bit_2464(ctx, &loopres_156007, binop_x_155996, y_155995, defunc_0_get_bit_res_156005) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_156007;
                
                y_155995 = y_tmp_171964;
            }
            defunc_0_f_res_155993 = y_155995;
            ((int8_t *) mem_171284)[i_171003] = defunc_0_f_res_155993;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156012;
        int64_t offs_156015;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_156015 = (int64_t) 0;
        for (int64_t i_156014 = 0; i_156014 < up_to_156008; i_156014++) {
            int32_t binop_x_156017 = sext_i64_i32(i_156014);
            int8_t index_primexp_156018 = zext_i32_i8(binop_x_156017);
            
            if (memblock_alloc(ctx, &mem_171295, bytes_171276, "mem_171295")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_102646; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171284)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_156018;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171293.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_156015, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171295.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_156043 = add64(offs_156015, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171295, "mem_171295") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_156043;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_156015 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171304, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156012 = offs_156015;
        if (memblock_alloc(ctx, &mem_171306, bytes_171276, "mem_171306")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102646});
        if (memblock_alloc(ctx, &mem_171308, bytes_171276, "mem_171308")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171308.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102646});
        for (int64_t i_156069 = 0; i_156069 < max_iter_156063; i_156069++) {
            int64_t inf_156072 = mul64(psizze__156057, i_156069);
            int64_t min_arg1_156073 = add64(psizze__156057, inf_156072);
            int64_t min_res_156074 = smin64(n_102646, min_arg1_156073);
            bool zzero_lte_i_156084 = sle64((int64_t) 0, inf_156072);
            int64_t j_m_i_156078 = sub64(min_res_156074, inf_156072);
            int64_t m_156080 = sub64(j_m_i_156078, (int64_t) 1);
            int64_t i_p_m_t_s_156081 = add64(inf_156072, m_156080);
            bool i_p_m_t_s_leq_w_156083 = slt64(i_p_m_t_s_156081, n_102646);
            bool y_156086 = i_p_m_t_s_leq_w_156083 && zzero_lte_i_156084;
            bool zzero_leq_i_p_m_t_s_156082 = sle64((int64_t) 0, i_p_m_t_s_156081);
            bool y_156087 = zzero_leq_i_p_m_t_s_156082 && y_156086;
            bool i_lte_j_156085 = sle64(inf_156072, min_res_156074);
            bool forwards_ok_156088 = i_lte_j_156085 && y_156087;
            bool empty_slice_156079 = j_m_i_156078 == (int64_t) 0;
            bool ok_or_empty_156089 = empty_slice_156079 || forwards_ok_156088;
            bool index_certs_156090;
            
            if (!ok_or_empty_156089) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156072, ":", (long long) min_res_156074, "] out of bounds for array of shape [", (long long) n_102646, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:133:71-82\n   #5  ftRelational.fut:132:5-133:83\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171315 = (int64_t) 8 * j_m_i_156078;
            
            if (mem_171316_cached_sizze_172501 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171316, &mem_171316_cached_sizze_172501, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171308.mem, (int64_t) 0 + (int64_t) 1 * inf_156072, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156078});
            if (mem_171318_cached_sizze_172502 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172502, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171306.mem, (int64_t) 0 + (int64_t) 1 * inf_156072, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156078});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_102646; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171304.mem)[write_iter_171023];
                int64_t write_iv_171027 = ((int64_t *) mem_param_171280.mem)[write_iter_171023];
                double write_iv_171028 = ((double *) mem_param_171283.mem)[write_iter_171023];
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_156072);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156078)) {
                    ((int64_t *) mem_171318)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156078)) {
                    ((double *) mem_171316)[lifted_lambda_res_162259] = write_iv_171028;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, inf_156072, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156078});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171308.mem, inf_156072, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156078});
        }
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171342, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171341, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171344, bytes_171276, "mem_171344")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171342.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102646});
    if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171346, bytes_171276, "mem_171346")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171346.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102646});
    if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171344, "mem_171344") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171346, "mem_171346") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172498, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172499, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171284);
        free(mem_171316);
        free(mem_171318);
        if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171344, "mem_171344") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171295, "mem_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_172503, struct memblock *mem_out_p_172504, struct memblock xs_mem_171274, int64_t n_101764, int64_t incr_101765, int64_t block_sizze_101766)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171284_cached_sizze_172505 = 0;
    unsigned char *mem_171284 = NULL;
    int64_t mem_171316_cached_sizze_172506 = 0;
    unsigned char *mem_171316 = NULL;
    int64_t mem_171318_cached_sizze_172507 = 0;
    unsigned char *mem_171318 = NULL;
    struct memblock mem_171346;
    
    mem_171346.references = NULL;
    
    struct memblock mem_171344;
    
    mem_171344.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171308;
    
    mem_171308.references = NULL;
    
    struct memblock mem_171306;
    
    mem_171306.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171295;
    
    mem_171295.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171304;
    
    ext_mem_171304.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171341;
    
    ext_mem_171341.references = NULL;
    
    struct memblock ext_mem_171342;
    
    ext_mem_171342.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_101764;
    int64_t bytes_171345 = (int64_t) 4 * n_101764;
    
    if (futrts_indicesWithIncrement_16321(ctx, &ext_mem_171275, xs_mem_171274, n_101764, incr_101765) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_101764; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171284_cached_sizze_172505 < n_101764) {
        err = lexical_realloc(ctx, &mem_171284, &mem_171284_cached_sizze_172505, n_101764);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171283, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    for (int64_t i_155968 = 0; i_155968 < (int64_t) 16; i_155968++) {
        int32_t binop_x_155971 = sext_i64_i32(i_155968);
        int32_t binop_x_155972 = mul32(2, binop_x_155971);
        int32_t zm_lhs_155973 = add32(2, binop_x_155972);
        int32_t min_arg1_155974 = sub32(zm_lhs_155973, 1);
        int32_t min_res_155975 = smin32(32, min_arg1_155974);
        int32_t zp_lhs_155976 = sub32(32, binop_x_155972);
        int32_t ij_bits_155977 = add32(1, zp_lhs_155976);
        int32_t up_to_155978 = shl32(1, ij_bits_155977);
        int64_t tmp_155979 = sext_i32_i64(zp_lhs_155976);
        bool bounds_invalid_upwards_155980 = slt32(zp_lhs_155976, 0);
        bool valid_155982 = !bounds_invalid_upwards_155980;
        bool range_valid_c_155983;
        
        if (!valid_155982) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_155979, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:131:71-82\n   #6  ftRelational.fut:130:5-131:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156004 = sext_i32_i64(up_to_155978);
        bool bounds_invalid_upwards_156005 = slt32(up_to_155978, 0);
        bool valid_156006 = !bounds_invalid_upwards_156005;
        bool range_valid_c_156007;
        
        if (!valid_156006) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156004, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:131:71-82\n   #5  ftRelational.fut:130:5-131:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156046 = add32(8, min_res_155975);
        int32_t zs_lhs_156047 = sub32(zm_lhs_156046, 1);
        int32_t i32_arg0_156048 = sdiv32(zs_lhs_156047, 8);
        int64_t i32_res_156049 = sext_i32_i64(i32_arg0_156048);
        bool zzero_156050 = i32_res_156049 == (int64_t) 0;
        bool nonzzero_156051 = !zzero_156050;
        bool nonzzero_cert_156052;
        
        if (!nonzzero_156051) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:131:71-82\n   #5  ftRelational.fut:130:5-131:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156053 = sdiv64(block_sizze_101766, i32_res_156049);
        int64_t zm_lhs_156054 = add64(n_101764, psizze__156053);
        int64_t zs_lhs_156055 = sub64(zm_lhs_156054, (int64_t) 1);
        bool zzero_156056 = psizze__156053 == (int64_t) 0;
        bool nonzzero_156057 = !zzero_156056;
        bool nonzzero_cert_156058;
        
        if (!nonzzero_156057) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:131:71-82\n   #5  ftRelational.fut:130:5-131:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156059 = sdiv64(zs_lhs_156055, psizze__156053);
        bool bounds_invalid_upwards_156060 = slt64(max_iter_156059, (int64_t) 0);
        bool valid_156061 = !bounds_invalid_upwards_156060;
        bool range_valid_c_156062;
        
        if (!valid_156061) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156059, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:131:71-82\n   #6  ftRelational.fut:130:5-131:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_155981 = add64((int64_t) 1, tmp_155979);
        
        for (int64_t i_171003 = 0; i_171003 < n_101764; i_171003++) {
            float eta_p_155985 = ((float *) mem_param_171283.mem)[i_171003];
            int32_t i32_arg0_155986 = futrts_to_bits32(eta_p_155985);
            int32_t unsign_arg0_155987 = ashr32(i32_arg0_155986, 31);
            int32_t unsign_arg0_155988 = 1 & unsign_arg0_155987;
            bool cond_155989 = unsign_arg0_155988 == 1;
            bool x_155990 = !cond_155989;
            int8_t defunc_0_f_res_155991;
            int8_t y_155993 = (int8_t) 0;
            
            for (int64_t i_155992 = 0; i_155992 < distance_155981; i_155992++) {
                int32_t binop_x_155994 = sext_i64_i32(i_155992);
                int32_t get_bit_arg0_155995 = add32(binop_x_155972, binop_x_155994);
                int32_t unsign_arg0_155996 = ashr32(i32_arg0_155986, get_bit_arg0_155995);
                int32_t unsign_arg0_155997 = 1 & unsign_arg0_155996;
                bool cond_f_res_155998 = get_bit_arg0_155995 == 31;
                bool y_155999 = x_155990 && cond_f_res_155998;
                bool cond_156000 = cond_155989 || y_155999;
                int32_t defunc_0_get_bit_res_156001;
                
                if (cond_156000) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ unsign_arg0_155997;
                    
                    defunc_0_get_bit_res_156001 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_156001 = unsign_arg0_155997;
                }
                
                int8_t loopres_156003;
                
                if (futrts_set_bit_2464(ctx, &loopres_156003, binop_x_155994, y_155993, defunc_0_get_bit_res_156001) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_156003;
                
                y_155993 = y_tmp_171964;
            }
            defunc_0_f_res_155991 = y_155993;
            ((int8_t *) mem_171284)[i_171003] = defunc_0_f_res_155991;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156008;
        int64_t offs_156011;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_156011 = (int64_t) 0;
        for (int64_t i_156010 = 0; i_156010 < up_to_156004; i_156010++) {
            int32_t binop_x_156013 = sext_i64_i32(i_156010);
            int8_t index_primexp_156014 = zext_i32_i8(binop_x_156013);
            
            if (memblock_alloc(ctx, &mem_171295, bytes_171276, "mem_171295")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_101764; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171284)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_156014;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171293.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_156011, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171295.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_156039 = add64(offs_156011, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171295, "mem_171295") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_156039;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_156011 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171304, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156008 = offs_156011;
        if (memblock_alloc(ctx, &mem_171306, bytes_171276, "mem_171306")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101764});
        if (memblock_alloc(ctx, &mem_171308, bytes_171345, "mem_171308")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171308.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101764});
        for (int64_t i_156065 = 0; i_156065 < max_iter_156059; i_156065++) {
            int64_t inf_156068 = mul64(psizze__156053, i_156065);
            int64_t min_arg1_156069 = add64(psizze__156053, inf_156068);
            int64_t min_res_156070 = smin64(n_101764, min_arg1_156069);
            bool zzero_lte_i_156080 = sle64((int64_t) 0, inf_156068);
            int64_t j_m_i_156074 = sub64(min_res_156070, inf_156068);
            int64_t m_156076 = sub64(j_m_i_156074, (int64_t) 1);
            int64_t i_p_m_t_s_156077 = add64(inf_156068, m_156076);
            bool i_p_m_t_s_leq_w_156079 = slt64(i_p_m_t_s_156077, n_101764);
            bool y_156082 = i_p_m_t_s_leq_w_156079 && zzero_lte_i_156080;
            bool zzero_leq_i_p_m_t_s_156078 = sle64((int64_t) 0, i_p_m_t_s_156077);
            bool y_156083 = zzero_leq_i_p_m_t_s_156078 && y_156082;
            bool i_lte_j_156081 = sle64(inf_156068, min_res_156070);
            bool forwards_ok_156084 = i_lte_j_156081 && y_156083;
            bool empty_slice_156075 = j_m_i_156074 == (int64_t) 0;
            bool ok_or_empty_156085 = empty_slice_156075 || forwards_ok_156084;
            bool index_certs_156086;
            
            if (!ok_or_empty_156085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156068, ":", (long long) min_res_156070, "] out of bounds for array of shape [", (long long) n_101764, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:131:71-82\n   #5  ftRelational.fut:130:5-131:83\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171315 = (int64_t) 4 * j_m_i_156074;
            int64_t bytes_171317 = (int64_t) 8 * j_m_i_156074;
            
            if (mem_171316_cached_sizze_172506 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171316, &mem_171316_cached_sizze_172506, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171308.mem, (int64_t) 0 + (int64_t) 1 * inf_156068, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156074});
            if (mem_171318_cached_sizze_172507 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172507, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171306.mem, (int64_t) 0 + (int64_t) 1 * inf_156068, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156074});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_101764; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171304.mem)[write_iter_171023];
                int64_t write_iv_171027 = ((int64_t *) mem_param_171280.mem)[write_iter_171023];
                float write_iv_171028 = ((float *) mem_param_171283.mem)[write_iter_171023];
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_156068);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156074)) {
                    ((int64_t *) mem_171318)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156074)) {
                    ((float *) mem_171316)[lifted_lambda_res_162259] = write_iv_171028;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, inf_156068, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156074});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171308.mem, inf_156068, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156074});
        }
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171342, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171341, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171344, bytes_171276, "mem_171344")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171342.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101764});
    if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171346, bytes_171345, "mem_171346")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171346.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101764});
    if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171344, "mem_171344") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171346, "mem_171346") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172503, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172504, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171284);
        free(mem_171316);
        free(mem_171318);
        if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171344, "mem_171344") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171295, "mem_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_172508, struct memblock *mem_out_p_172509, struct memblock xs_mem_171274, int64_t n_100021, int64_t incr_100022, int64_t block_sizze_100023)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171284_cached_sizze_172510 = 0;
    unsigned char *mem_171284 = NULL;
    int64_t mem_171316_cached_sizze_172511 = 0;
    unsigned char *mem_171316 = NULL;
    int64_t mem_171318_cached_sizze_172512 = 0;
    unsigned char *mem_171318 = NULL;
    struct memblock mem_171346;
    
    mem_171346.references = NULL;
    
    struct memblock mem_171344;
    
    mem_171344.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171308;
    
    mem_171308.references = NULL;
    
    struct memblock mem_171306;
    
    mem_171306.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171295;
    
    mem_171295.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171304;
    
    ext_mem_171304.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171341;
    
    ext_mem_171341.references = NULL;
    
    struct memblock ext_mem_171342;
    
    ext_mem_171342.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_100021;
    int64_t bytes_171345 = (int64_t) 4 * n_100021;
    
    if (futrts_indicesWithIncrement_16277(ctx, &ext_mem_171275, xs_mem_171274, n_100021, incr_100022) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_100021; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171284_cached_sizze_172510 < n_100021) {
        err = lexical_realloc(ctx, &mem_171284, &mem_171284_cached_sizze_172510, n_100021);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171283, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    for (int64_t i_154421 = 0; i_154421 < (int64_t) 16; i_154421++) {
        int32_t binop_x_154424 = sext_i64_i32(i_154421);
        int32_t binop_x_154425 = mul32(2, binop_x_154424);
        int32_t zm_lhs_154426 = add32(2, binop_x_154425);
        int32_t min_arg1_154427 = sub32(zm_lhs_154426, 1);
        int32_t min_res_154428 = smin32(32, min_arg1_154427);
        int32_t zp_lhs_154429 = sub32(32, binop_x_154425);
        int32_t ij_bits_154430 = add32(1, zp_lhs_154429);
        int32_t up_to_154431 = shl32(1, ij_bits_154430);
        int64_t tmp_154432 = sext_i32_i64(zp_lhs_154429);
        bool bounds_invalid_upwards_154433 = slt32(zp_lhs_154429, 0);
        bool valid_154435 = !bounds_invalid_upwards_154433;
        bool range_valid_c_154436;
        
        if (!valid_154435) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154432, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:127:74-85\n   #6  ftRelational.fut:126:5-127:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154449 = sext_i32_i64(up_to_154431);
        bool bounds_invalid_upwards_154450 = slt32(up_to_154431, 0);
        bool valid_154451 = !bounds_invalid_upwards_154450;
        bool range_valid_c_154452;
        
        if (!valid_154451) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154449, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:127:74-85\n   #5  ftRelational.fut:126:5-127:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_154491 = add32(8, min_res_154428);
        int32_t zs_lhs_154492 = sub32(zm_lhs_154491, 1);
        int32_t i32_arg0_154493 = sdiv32(zs_lhs_154492, 8);
        int64_t i32_res_154494 = sext_i32_i64(i32_arg0_154493);
        bool zzero_154495 = i32_res_154494 == (int64_t) 0;
        bool nonzzero_154496 = !zzero_154495;
        bool nonzzero_cert_154497;
        
        if (!nonzzero_154496) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:127:74-85\n   #5  ftRelational.fut:126:5-127:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154498 = sdiv64(block_sizze_100023, i32_res_154494);
        int64_t zm_lhs_154499 = add64(n_100021, psizze__154498);
        int64_t zs_lhs_154500 = sub64(zm_lhs_154499, (int64_t) 1);
        bool zzero_154501 = psizze__154498 == (int64_t) 0;
        bool nonzzero_154502 = !zzero_154501;
        bool nonzzero_cert_154503;
        
        if (!nonzzero_154502) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:127:74-85\n   #5  ftRelational.fut:126:5-127:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_154504 = sdiv64(zs_lhs_154500, psizze__154498);
        bool bounds_invalid_upwards_154505 = slt64(max_iter_154504, (int64_t) 0);
        bool valid_154506 = !bounds_invalid_upwards_154505;
        bool range_valid_c_154507;
        
        if (!valid_154506) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154504, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:127:74-85\n   #6  ftRelational.fut:126:5-127:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154434 = add64((int64_t) 1, tmp_154432);
        
        for (int64_t i_171003 = 0; i_171003 < n_100021; i_171003++) {
            int32_t eta_p_154438 = ((int32_t *) mem_param_171283.mem)[i_171003];
            int8_t defunc_0_f_res_154439;
            int8_t y_154441 = (int8_t) 0;
            
            for (int64_t i_154440 = 0; i_154440 < distance_154434; i_154440++) {
                int32_t binop_x_154442 = sext_i64_i32(i_154440);
                int32_t get_bit_arg0_154443 = add32(binop_x_154425, binop_x_154442);
                int32_t zgzg_res_161776 = ashr32(eta_p_154438, get_bit_arg0_154443);
                int32_t za_res_161777 = 1 & zgzg_res_161776;
                bool cond_154445 = get_bit_arg0_154443 == 31;
                int32_t defunc_0_get_bit_res_154446;
                
                if (cond_154445) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ za_res_161777;
                    
                    defunc_0_get_bit_res_154446 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_154446 = za_res_161777;
                }
                
                int8_t loopres_154448;
                
                if (futrts_set_bit_2464(ctx, &loopres_154448, binop_x_154442, y_154441, defunc_0_get_bit_res_154446) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_154448;
                
                y_154441 = y_tmp_171964;
            }
            defunc_0_f_res_154439 = y_154441;
            ((int8_t *) mem_171284)[i_171003] = defunc_0_f_res_154439;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154453;
        int64_t offs_154456;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_154456 = (int64_t) 0;
        for (int64_t i_154455 = 0; i_154455 < up_to_154449; i_154455++) {
            int32_t binop_x_154458 = sext_i64_i32(i_154455);
            int8_t index_primexp_154459 = zext_i32_i8(binop_x_154458);
            
            if (memblock_alloc(ctx, &mem_171295, bytes_171276, "mem_171295")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_100021; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171284)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_154459;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171293.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_154456, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171295.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_154484 = add64(offs_154456, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171295, "mem_171295") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_154484;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_154456 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171304, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154453 = offs_154456;
        if (memblock_alloc(ctx, &mem_171306, bytes_171276, "mem_171306")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100021});
        if (memblock_alloc(ctx, &mem_171308, bytes_171345, "mem_171308")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171308.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100021});
        for (int64_t i_154510 = 0; i_154510 < max_iter_154504; i_154510++) {
            int64_t inf_154513 = mul64(psizze__154498, i_154510);
            int64_t min_arg1_154514 = add64(psizze__154498, inf_154513);
            int64_t min_res_154515 = smin64(n_100021, min_arg1_154514);
            bool zzero_lte_i_154525 = sle64((int64_t) 0, inf_154513);
            int64_t j_m_i_154519 = sub64(min_res_154515, inf_154513);
            int64_t m_154521 = sub64(j_m_i_154519, (int64_t) 1);
            int64_t i_p_m_t_s_154522 = add64(inf_154513, m_154521);
            bool i_p_m_t_s_leq_w_154524 = slt64(i_p_m_t_s_154522, n_100021);
            bool y_154527 = i_p_m_t_s_leq_w_154524 && zzero_lte_i_154525;
            bool zzero_leq_i_p_m_t_s_154523 = sle64((int64_t) 0, i_p_m_t_s_154522);
            bool y_154528 = zzero_leq_i_p_m_t_s_154523 && y_154527;
            bool i_lte_j_154526 = sle64(inf_154513, min_res_154515);
            bool forwards_ok_154529 = i_lte_j_154526 && y_154528;
            bool empty_slice_154520 = j_m_i_154519 == (int64_t) 0;
            bool ok_or_empty_154530 = empty_slice_154520 || forwards_ok_154529;
            bool index_certs_154531;
            
            if (!ok_or_empty_154530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154513, ":", (long long) min_res_154515, "] out of bounds for array of shape [", (long long) n_100021, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:127:74-85\n   #5  ftRelational.fut:126:5-127:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171315 = (int64_t) 4 * j_m_i_154519;
            int64_t bytes_171317 = (int64_t) 8 * j_m_i_154519;
            
            if (mem_171316_cached_sizze_172511 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171316, &mem_171316_cached_sizze_172511, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171308.mem, (int64_t) 0 + (int64_t) 1 * inf_154513, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            if (mem_171318_cached_sizze_172512 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172512, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171306.mem, (int64_t) 0 + (int64_t) 1 * inf_154513, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_100021; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171304.mem)[write_iter_171023];
                int64_t write_iv_171027 = ((int64_t *) mem_param_171280.mem)[write_iter_171023];
                int32_t write_iv_171028 = ((int32_t *) mem_param_171283.mem)[write_iter_171023];
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_154513);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154519)) {
                    ((int64_t *) mem_171318)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154519)) {
                    ((int32_t *) mem_171316)[lifted_lambda_res_162259] = write_iv_171028;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, inf_154513, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171308.mem, inf_154513, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
        }
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171342, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171341, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171344, bytes_171276, "mem_171344")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171342.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100021});
    if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171346, bytes_171345, "mem_171346")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171346.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100021});
    if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171344, "mem_171344") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171346, "mem_171346") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172508, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172509, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171284);
        free(mem_171316);
        free(mem_171318);
        if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171344, "mem_171344") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171295, "mem_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_172513, struct memblock *mem_out_p_172514, struct memblock xs_mem_171274, int64_t n_100882, int64_t incr_100883, int64_t block_sizze_100884)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171284_cached_sizze_172515 = 0;
    unsigned char *mem_171284 = NULL;
    int64_t mem_171316_cached_sizze_172516 = 0;
    unsigned char *mem_171316 = NULL;
    int64_t mem_171318_cached_sizze_172517 = 0;
    unsigned char *mem_171318 = NULL;
    struct memblock mem_171346;
    
    mem_171346.references = NULL;
    
    struct memblock mem_171344;
    
    mem_171344.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171308;
    
    mem_171308.references = NULL;
    
    struct memblock mem_171306;
    
    mem_171306.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171295;
    
    mem_171295.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171304;
    
    ext_mem_171304.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171341;
    
    ext_mem_171341.references = NULL;
    
    struct memblock ext_mem_171342;
    
    ext_mem_171342.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_100882;
    
    if (futrts_indicesWithIncrement_16299(ctx, &ext_mem_171275, xs_mem_171274, n_100882, incr_100883) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_100882; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171284_cached_sizze_172515 < n_100882) {
        err = lexical_realloc(ctx, &mem_171284, &mem_171284_cached_sizze_172515, n_100882);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171283, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    for (int64_t i_154421 = 0; i_154421 < (int64_t) 32; i_154421++) {
        int32_t binop_x_154424 = sext_i64_i32(i_154421);
        int32_t binop_x_154425 = mul32(2, binop_x_154424);
        int32_t zm_lhs_154426 = add32(2, binop_x_154425);
        int32_t min_arg1_154427 = sub32(zm_lhs_154426, 1);
        int32_t min_res_154428 = smin32(64, min_arg1_154427);
        int32_t zp_lhs_154429 = sub32(64, binop_x_154425);
        int32_t ij_bits_154430 = add32(1, zp_lhs_154429);
        int32_t up_to_154431 = shl32(1, ij_bits_154430);
        int64_t tmp_154432 = sext_i32_i64(zp_lhs_154429);
        bool bounds_invalid_upwards_154433 = slt32(zp_lhs_154429, 0);
        bool valid_154435 = !bounds_invalid_upwards_154433;
        bool range_valid_c_154436;
        
        if (!valid_154435) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154432, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:129:74-85\n   #6  ftRelational.fut:128:5-129:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154449 = sext_i32_i64(up_to_154431);
        bool bounds_invalid_upwards_154450 = slt32(up_to_154431, 0);
        bool valid_154451 = !bounds_invalid_upwards_154450;
        bool range_valid_c_154452;
        
        if (!valid_154451) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154449, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:129:74-85\n   #5  ftRelational.fut:128:5-129:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_154491 = add32(8, min_res_154428);
        int32_t zs_lhs_154492 = sub32(zm_lhs_154491, 1);
        int32_t i32_arg0_154493 = sdiv32(zs_lhs_154492, 8);
        int64_t i32_res_154494 = sext_i32_i64(i32_arg0_154493);
        bool zzero_154495 = i32_res_154494 == (int64_t) 0;
        bool nonzzero_154496 = !zzero_154495;
        bool nonzzero_cert_154497;
        
        if (!nonzzero_154496) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:129:74-85\n   #5  ftRelational.fut:128:5-129:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154498 = sdiv64(block_sizze_100884, i32_res_154494);
        int64_t zm_lhs_154499 = add64(n_100882, psizze__154498);
        int64_t zs_lhs_154500 = sub64(zm_lhs_154499, (int64_t) 1);
        bool zzero_154501 = psizze__154498 == (int64_t) 0;
        bool nonzzero_154502 = !zzero_154501;
        bool nonzzero_cert_154503;
        
        if (!nonzzero_154502) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:129:74-85\n   #5  ftRelational.fut:128:5-129:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_154504 = sdiv64(zs_lhs_154500, psizze__154498);
        bool bounds_invalid_upwards_154505 = slt64(max_iter_154504, (int64_t) 0);
        bool valid_154506 = !bounds_invalid_upwards_154505;
        bool range_valid_c_154507;
        
        if (!valid_154506) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154504, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:129:74-85\n   #6  ftRelational.fut:128:5-129:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154434 = add64((int64_t) 1, tmp_154432);
        
        for (int64_t i_171003 = 0; i_171003 < n_100882; i_171003++) {
            int64_t eta_p_154438 = ((int64_t *) mem_param_171283.mem)[i_171003];
            int8_t defunc_0_f_res_154439;
            int8_t y_154441 = (int8_t) 0;
            
            for (int64_t i_154440 = 0; i_154440 < distance_154434; i_154440++) {
                int32_t binop_x_154442 = sext_i64_i32(i_154440);
                int32_t get_bit_arg0_154443 = add32(binop_x_154425, binop_x_154442);
                int32_t defunc_0_get_bit_res_154444;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_154444, get_bit_arg0_154443, eta_p_154438) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154445 = get_bit_arg0_154443 == 63;
                int32_t defunc_0_get_bit_res_154446;
                
                if (cond_154445) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ defunc_0_get_bit_res_154444;
                    
                    defunc_0_get_bit_res_154446 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_154446 = defunc_0_get_bit_res_154444;
                }
                
                int8_t loopres_154448;
                
                if (futrts_set_bit_2464(ctx, &loopres_154448, binop_x_154442, y_154441, defunc_0_get_bit_res_154446) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_154448;
                
                y_154441 = y_tmp_171964;
            }
            defunc_0_f_res_154439 = y_154441;
            ((int8_t *) mem_171284)[i_171003] = defunc_0_f_res_154439;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154453;
        int64_t offs_154456;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_154456 = (int64_t) 0;
        for (int64_t i_154455 = 0; i_154455 < up_to_154449; i_154455++) {
            int32_t binop_x_154458 = sext_i64_i32(i_154455);
            int8_t index_primexp_154459 = zext_i32_i8(binop_x_154458);
            
            if (memblock_alloc(ctx, &mem_171295, bytes_171276, "mem_171295")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_100882; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171284)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_154459;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171293.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_154456, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171295.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_154484 = add64(offs_154456, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171295, "mem_171295") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_154484;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_154456 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171304, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154453 = offs_154456;
        if (memblock_alloc(ctx, &mem_171306, bytes_171276, "mem_171306")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100882});
        if (memblock_alloc(ctx, &mem_171308, bytes_171276, "mem_171308")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171308.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100882});
        for (int64_t i_154510 = 0; i_154510 < max_iter_154504; i_154510++) {
            int64_t inf_154513 = mul64(psizze__154498, i_154510);
            int64_t min_arg1_154514 = add64(psizze__154498, inf_154513);
            int64_t min_res_154515 = smin64(n_100882, min_arg1_154514);
            bool zzero_lte_i_154525 = sle64((int64_t) 0, inf_154513);
            int64_t j_m_i_154519 = sub64(min_res_154515, inf_154513);
            int64_t m_154521 = sub64(j_m_i_154519, (int64_t) 1);
            int64_t i_p_m_t_s_154522 = add64(inf_154513, m_154521);
            bool i_p_m_t_s_leq_w_154524 = slt64(i_p_m_t_s_154522, n_100882);
            bool y_154527 = i_p_m_t_s_leq_w_154524 && zzero_lte_i_154525;
            bool zzero_leq_i_p_m_t_s_154523 = sle64((int64_t) 0, i_p_m_t_s_154522);
            bool y_154528 = zzero_leq_i_p_m_t_s_154523 && y_154527;
            bool i_lte_j_154526 = sle64(inf_154513, min_res_154515);
            bool forwards_ok_154529 = i_lte_j_154526 && y_154528;
            bool empty_slice_154520 = j_m_i_154519 == (int64_t) 0;
            bool ok_or_empty_154530 = empty_slice_154520 || forwards_ok_154529;
            bool index_certs_154531;
            
            if (!ok_or_empty_154530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154513, ":", (long long) min_res_154515, "] out of bounds for array of shape [", (long long) n_100882, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:129:74-85\n   #5  ftRelational.fut:128:5-129:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171315 = (int64_t) 8 * j_m_i_154519;
            
            if (mem_171316_cached_sizze_172516 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171316, &mem_171316_cached_sizze_172516, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171308.mem, (int64_t) 0 + (int64_t) 1 * inf_154513, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            if (mem_171318_cached_sizze_172517 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172517, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171306.mem, (int64_t) 0 + (int64_t) 1 * inf_154513, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_100882; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171304.mem)[write_iter_171023];
                int64_t write_iv_171027 = ((int64_t *) mem_param_171280.mem)[write_iter_171023];
                int64_t write_iv_171028 = ((int64_t *) mem_param_171283.mem)[write_iter_171023];
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_154513);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154519)) {
                    ((int64_t *) mem_171318)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154519)) {
                    ((int64_t *) mem_171316)[lifted_lambda_res_162259] = write_iv_171028;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, inf_154513, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171308.mem, inf_154513, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
        }
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171342, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171341, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171344, bytes_171276, "mem_171344")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171342.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100882});
    if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171346, bytes_171276, "mem_171346")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171346.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100882});
    if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171344, "mem_171344") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171346, "mem_171346") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172513, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172514, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171284);
        free(mem_171316);
        free(mem_171318);
        if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171344, "mem_171344") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171295, "mem_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_172518, struct memblock *mem_out_p_172519, struct memblock xs_mem_171274, int64_t n_99160, int64_t incr_99161, int64_t block_sizze_99162)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171284_cached_sizze_172520 = 0;
    unsigned char *mem_171284 = NULL;
    int64_t mem_171316_cached_sizze_172521 = 0;
    unsigned char *mem_171316 = NULL;
    int64_t mem_171318_cached_sizze_172522 = 0;
    unsigned char *mem_171318 = NULL;
    struct memblock mem_171346;
    
    mem_171346.references = NULL;
    
    struct memblock mem_171344;
    
    mem_171344.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171308;
    
    mem_171308.references = NULL;
    
    struct memblock mem_171306;
    
    mem_171306.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171295;
    
    mem_171295.references = NULL;
    
    struct memblock mem_param_171293;
    
    mem_param_171293.references = NULL;
    
    struct memblock ext_mem_171304;
    
    ext_mem_171304.references = NULL;
    
    struct memblock mem_param_171283;
    
    mem_param_171283.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171341;
    
    ext_mem_171341.references = NULL;
    
    struct memblock ext_mem_171342;
    
    ext_mem_171342.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock ext_mem_171275;
    
    ext_mem_171275.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_99160;
    int64_t bytes_171345 = (int64_t) 2 * n_99160;
    
    if (futrts_indicesWithIncrement_16256(ctx, &ext_mem_171275, xs_mem_171274, n_99160, incr_99161) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_99160; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171284_cached_sizze_172520 < n_99160) {
        err = lexical_realloc(ctx, &mem_171284, &mem_171284_cached_sizze_172520, n_99160);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171283, &xs_mem_171274, "xs_mem_171274") != 0)
        return 1;
    for (int64_t i_154421 = 0; i_154421 < (int64_t) 8; i_154421++) {
        int32_t binop_x_154424 = sext_i64_i32(i_154421);
        int32_t binop_x_154425 = mul32(2, binop_x_154424);
        int32_t zm_lhs_154426 = add32(2, binop_x_154425);
        int32_t min_arg1_154427 = sub32(zm_lhs_154426, 1);
        int32_t min_res_154428 = smin32(16, min_arg1_154427);
        int32_t zp_lhs_154429 = sub32(16, binop_x_154425);
        int32_t ij_bits_154430 = add32(1, zp_lhs_154429);
        int32_t up_to_154431 = shl32(1, ij_bits_154430);
        int64_t tmp_154432 = sext_i32_i64(zp_lhs_154429);
        bool bounds_invalid_upwards_154433 = slt32(zp_lhs_154429, 0);
        bool valid_154435 = !bounds_invalid_upwards_154433;
        bool range_valid_c_154436;
        
        if (!valid_154435) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154432, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:125:74-85\n   #6  ftRelational.fut:124:5-125:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154449 = sext_i32_i64(up_to_154431);
        bool bounds_invalid_upwards_154450 = slt32(up_to_154431, 0);
        bool valid_154451 = !bounds_invalid_upwards_154450;
        bool range_valid_c_154452;
        
        if (!valid_154451) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154449, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:125:74-85\n   #5  ftRelational.fut:124:5-125:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_154491 = add32(8, min_res_154428);
        int32_t zs_lhs_154492 = sub32(zm_lhs_154491, 1);
        int32_t i32_arg0_154493 = sdiv32(zs_lhs_154492, 8);
        int64_t i32_res_154494 = sext_i32_i64(i32_arg0_154493);
        bool zzero_154495 = i32_res_154494 == (int64_t) 0;
        bool nonzzero_154496 = !zzero_154495;
        bool nonzzero_cert_154497;
        
        if (!nonzzero_154496) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:125:74-85\n   #5  ftRelational.fut:124:5-125:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154498 = sdiv64(block_sizze_99162, i32_res_154494);
        int64_t zm_lhs_154499 = add64(n_99160, psizze__154498);
        int64_t zs_lhs_154500 = sub64(zm_lhs_154499, (int64_t) 1);
        bool zzero_154501 = psizze__154498 == (int64_t) 0;
        bool nonzzero_154502 = !zzero_154501;
        bool nonzzero_cert_154503;
        
        if (!nonzzero_154502) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:125:74-85\n   #5  ftRelational.fut:124:5-125:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_154504 = sdiv64(zs_lhs_154500, psizze__154498);
        bool bounds_invalid_upwards_154505 = slt64(max_iter_154504, (int64_t) 0);
        bool valid_154506 = !bounds_invalid_upwards_154505;
        bool range_valid_c_154507;
        
        if (!valid_154506) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154504, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:125:74-85\n   #6  ftRelational.fut:124:5-125:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154434 = add64((int64_t) 1, tmp_154432);
        
        for (int64_t i_171003 = 0; i_171003 < n_99160; i_171003++) {
            int16_t eta_p_154438 = ((int16_t *) mem_param_171283.mem)[i_171003];
            int8_t defunc_0_f_res_154439;
            int8_t y_154441 = (int8_t) 0;
            
            for (int64_t i_154440 = 0; i_154440 < distance_154434; i_154440++) {
                int32_t binop_x_154442 = sext_i64_i32(i_154440);
                int32_t get_bit_arg0_154443 = add32(binop_x_154425, binop_x_154442);
                int32_t defunc_0_get_bit_res_154444;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_154444, get_bit_arg0_154443, eta_p_154438) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154445 = get_bit_arg0_154443 == 15;
                int32_t defunc_0_get_bit_res_154446;
                
                if (cond_154445) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ defunc_0_get_bit_res_154444;
                    
                    defunc_0_get_bit_res_154446 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_154446 = defunc_0_get_bit_res_154444;
                }
                
                int8_t loopres_154448;
                
                if (futrts_set_bit_2464(ctx, &loopres_154448, binop_x_154442, y_154441, defunc_0_get_bit_res_154446) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_154448;
                
                y_154441 = y_tmp_171964;
            }
            defunc_0_f_res_154439 = y_154441;
            ((int8_t *) mem_171284)[i_171003] = defunc_0_f_res_154439;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154453;
        int64_t offs_154456;
        
        if (memblock_set(ctx, &mem_param_171293, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_154456 = (int64_t) 0;
        for (int64_t i_154455 = 0; i_154455 < up_to_154449; i_154455++) {
            int32_t binop_x_154458 = sext_i64_i32(i_154455);
            int8_t index_primexp_154459 = zext_i32_i8(binop_x_154458);
            
            if (memblock_alloc(ctx, &mem_171295, bytes_171276, "mem_171295")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_99160; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171284)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_154459;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171293.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_154456, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171295.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_154484 = add64(offs_154456, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171295, "mem_171295") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_154484;
            
            if (memblock_set(ctx, &mem_param_171293, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_154456 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171304, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154453 = offs_154456;
        if (memblock_alloc(ctx, &mem_171306, bytes_171276, "mem_171306")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99160});
        if (memblock_alloc(ctx, &mem_171308, bytes_171345, "mem_171308")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_171308.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_171283.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99160});
        for (int64_t i_154510 = 0; i_154510 < max_iter_154504; i_154510++) {
            int64_t inf_154513 = mul64(psizze__154498, i_154510);
            int64_t min_arg1_154514 = add64(psizze__154498, inf_154513);
            int64_t min_res_154515 = smin64(n_99160, min_arg1_154514);
            bool zzero_lte_i_154525 = sle64((int64_t) 0, inf_154513);
            int64_t j_m_i_154519 = sub64(min_res_154515, inf_154513);
            int64_t m_154521 = sub64(j_m_i_154519, (int64_t) 1);
            int64_t i_p_m_t_s_154522 = add64(inf_154513, m_154521);
            bool i_p_m_t_s_leq_w_154524 = slt64(i_p_m_t_s_154522, n_99160);
            bool y_154527 = i_p_m_t_s_leq_w_154524 && zzero_lte_i_154525;
            bool zzero_leq_i_p_m_t_s_154523 = sle64((int64_t) 0, i_p_m_t_s_154522);
            bool y_154528 = zzero_leq_i_p_m_t_s_154523 && y_154527;
            bool i_lte_j_154526 = sle64(inf_154513, min_res_154515);
            bool forwards_ok_154529 = i_lte_j_154526 && y_154528;
            bool empty_slice_154520 = j_m_i_154519 == (int64_t) 0;
            bool ok_or_empty_154530 = empty_slice_154520 || forwards_ok_154529;
            bool index_certs_154531;
            
            if (!ok_or_empty_154530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154513, ":", (long long) min_res_154515, "] out of bounds for array of shape [", (long long) n_99160, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:125:74-85\n   #5  ftRelational.fut:124:5-125:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171315 = (int64_t) 2 * j_m_i_154519;
            int64_t bytes_171317 = (int64_t) 8 * j_m_i_154519;
            
            if (mem_171316_cached_sizze_172521 < bytes_171315) {
                err = lexical_realloc(ctx, &mem_171316, &mem_171316_cached_sizze_172521, bytes_171315);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171308.mem, (int64_t) 0 + (int64_t) 1 * inf_154513, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            if (mem_171318_cached_sizze_172522 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172522, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171306.mem, (int64_t) 0 + (int64_t) 1 * inf_154513, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_99160; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171304.mem)[write_iter_171023];
                int64_t write_iv_171027 = ((int64_t *) mem_param_171280.mem)[write_iter_171023];
                int16_t write_iv_171028 = ((int16_t *) mem_param_171283.mem)[write_iter_171023];
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_154513);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154519)) {
                    ((int64_t *) mem_171318)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154519)) {
                    ((int16_t *) mem_171316)[lifted_lambda_res_162259] = write_iv_171028;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171306.mem, inf_154513, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171318, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171308.mem, inf_154513, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171316, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154519});
        }
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171283, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171342, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171341, &mem_param_171283, "mem_param_171283") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171344, bytes_171276, "mem_171344")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171342.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99160});
    if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171346, bytes_171345, "mem_171346")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_171346.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99160});
    if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171344, "mem_171344") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171346, "mem_171346") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172518, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172519, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171284);
        free(mem_171316);
        free(mem_171318);
        if (memblock_unref(ctx, &mem_171346, "mem_171346") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171344, "mem_171344") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171308, "mem_171308") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171306, "mem_171306") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171295, "mem_171295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171293, "mem_param_171293") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171304, "ext_mem_171304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171283, "mem_param_171283") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171341, "ext_mem_171341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171342, "ext_mem_171342") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171275, "ext_mem_171275") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_172523, struct memblock *mem_out_p_172524, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_86374, int64_t b_86375, int64_t block_sizze_86376)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171285_cached_sizze_172525 = 0;
    unsigned char *mem_171285 = NULL;
    int64_t mem_171318_cached_sizze_172526 = 0;
    unsigned char *mem_171318 = NULL;
    int64_t mem_171320_cached_sizze_172527 = 0;
    unsigned char *mem_171320 = NULL;
    int64_t mem_171328_cached_sizze_172528 = 0;
    unsigned char *mem_171328 = NULL;
    struct memblock mem_171353;
    
    mem_171353.references = NULL;
    
    struct memblock mem_171351;
    
    mem_171351.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171309;
    
    mem_171309.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_171284;
    
    mem_param_171284.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171348;
    
    ext_mem_171348.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_86374;
    int64_t bytes_171352 = n_86374 * b_86375;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_86374; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171285_cached_sizze_172525 < n_86374) {
        err = lexical_realloc(ctx, &mem_171285, &mem_171285_cached_sizze_172525, n_86374);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171328_cached_sizze_172528 < b_86375) {
        err = lexical_realloc(ctx, &mem_171328, &mem_171328_cached_sizze_172528, b_86375);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &k_mem_171274, "k_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171284, &pL_mem_171275, "pL_mem_171275") != 0)
        return 1;
    for (int64_t i_155963 = 0; i_155963 < (int64_t) 32; i_155963++) {
        int32_t binop_x_155966 = sext_i64_i32(i_155963);
        int32_t binop_x_155967 = mul32(2, binop_x_155966);
        int32_t zm_lhs_155968 = add32(2, binop_x_155967);
        int32_t min_arg1_155969 = sub32(zm_lhs_155968, 1);
        int32_t min_res_155970 = smin32(64, min_arg1_155969);
        int32_t zp_lhs_155971 = sub32(64, binop_x_155967);
        int32_t ij_bits_155972 = add32(1, zp_lhs_155971);
        int32_t up_to_155973 = shl32(1, ij_bits_155972);
        int64_t tmp_155974 = sext_i32_i64(zp_lhs_155971);
        bool bounds_invalid_upwards_155975 = slt32(zp_lhs_155971, 0);
        bool valid_155977 = !bounds_invalid_upwards_155975;
        bool range_valid_c_155978;
        
        if (!valid_155977) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_155974, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:97:74-85\n   #6  ftRelational.fut:93:5-97:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156002 = sext_i32_i64(up_to_155973);
        bool bounds_invalid_upwards_156003 = slt32(up_to_155973, 0);
        bool valid_156004 = !bounds_invalid_upwards_156003;
        bool range_valid_c_156005;
        
        if (!valid_156004) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156002, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:97:74-85\n   #5  ftRelational.fut:93:5-97:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156044 = add32(8, min_res_155970);
        int32_t zs_lhs_156045 = sub32(zm_lhs_156044, 1);
        int32_t i32_arg0_156046 = sdiv32(zs_lhs_156045, 8);
        int64_t i32_res_156047 = sext_i32_i64(i32_arg0_156046);
        bool zzero_156048 = i32_res_156047 == (int64_t) 0;
        bool nonzzero_156049 = !zzero_156048;
        bool nonzzero_cert_156050;
        
        if (!nonzzero_156049) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:97:74-85\n   #5  ftRelational.fut:93:5-97:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156051 = sdiv64(block_sizze_86376, i32_res_156047);
        int64_t zm_lhs_156052 = add64(n_86374, psizze__156051);
        int64_t zs_lhs_156053 = sub64(zm_lhs_156052, (int64_t) 1);
        bool zzero_156054 = psizze__156051 == (int64_t) 0;
        bool nonzzero_156055 = !zzero_156054;
        bool nonzzero_cert_156056;
        
        if (!nonzzero_156055) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:97:74-85\n   #5  ftRelational.fut:93:5-97:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156057 = sdiv64(zs_lhs_156053, psizze__156051);
        bool bounds_invalid_upwards_156058 = slt64(max_iter_156057, (int64_t) 0);
        bool valid_156059 = !bounds_invalid_upwards_156058;
        bool range_valid_c_156060;
        
        if (!valid_156059) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156057, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:97:74-85\n   #6  ftRelational.fut:93:5-97:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_155976 = add64((int64_t) 1, tmp_155974);
        
        for (int64_t i_171003 = 0; i_171003 < n_86374; i_171003++) {
            double eta_p_155980 = ((double *) mem_param_171280.mem)[i_171003];
            int64_t i64_arg0_155981 = futrts_to_bits64(eta_p_155980);
            int64_t unsign_arg0_155982 = ashr64(i64_arg0_155981, (int64_t) 63);
            int64_t unsign_arg0_155983 = (int64_t) 1 & unsign_arg0_155982;
            int32_t to_i32_res_155984 = zext_i64_i32(unsign_arg0_155983);
            bool cond_155985 = to_i32_res_155984 == 1;
            bool x_155986 = !cond_155985;
            int8_t defunc_0_f_res_155987;
            int8_t y_155989 = (int8_t) 0;
            
            for (int64_t i_155988 = 0; i_155988 < distance_155976; i_155988++) {
                int32_t binop_x_155990 = sext_i64_i32(i_155988);
                int32_t get_bit_arg0_155991 = add32(binop_x_155967, binop_x_155990);
                int64_t unsign_arg0_155992 = zext_i32_i64(get_bit_arg0_155991);
                int64_t unsign_arg0_155993 = ashr64(i64_arg0_155981, unsign_arg0_155992);
                int64_t unsign_arg0_155994 = (int64_t) 1 & unsign_arg0_155993;
                int32_t to_i32_res_155995 = zext_i64_i32(unsign_arg0_155994);
                bool cond_f_res_155996 = get_bit_arg0_155991 == 63;
                bool y_155997 = x_155986 && cond_f_res_155996;
                bool cond_155998 = cond_155985 || y_155997;
                int32_t defunc_0_get_bit_res_155999;
                
                if (cond_155998) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ to_i32_res_155995;
                    
                    defunc_0_get_bit_res_155999 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_155999 = to_i32_res_155995;
                }
                
                int8_t loopres_156001;
                
                if (futrts_set_bit_2464(ctx, &loopres_156001, binop_x_155990, y_155989, defunc_0_get_bit_res_155999) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_156001;
                
                y_155989 = y_tmp_171964;
            }
            defunc_0_f_res_155987 = y_155989;
            ((int8_t *) mem_171285)[i_171003] = defunc_0_f_res_155987;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156006;
        int64_t offs_156009;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_156009 = (int64_t) 0;
        for (int64_t i_156008 = 0; i_156008 < up_to_156002; i_156008++) {
            int32_t binop_x_156011 = sext_i64_i32(i_156008);
            int8_t index_primexp_156012 = zext_i32_i8(binop_x_156011);
            
            if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_86374; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171285)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_156012;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171294.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_156009, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171296.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_156037 = add64(offs_156009, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171296, "mem_171296") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_156037;
            
            if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_156009 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156006 = offs_156009;
        if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171307.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86374});
        if (memblock_alloc(ctx, &mem_171309, bytes_171352, "mem_171309")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, (int64_t) 0, (int64_t []) {b_86375, (int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0, (int64_t []) {b_86375, (int64_t) 1}, (int64_t []) {n_86374, b_86375});
        for (int64_t i_156063 = 0; i_156063 < max_iter_156057; i_156063++) {
            int64_t inf_156066 = mul64(psizze__156051, i_156063);
            int64_t min_arg1_156067 = add64(psizze__156051, inf_156066);
            int64_t min_res_156068 = smin64(n_86374, min_arg1_156067);
            bool zzero_lte_i_156078 = sle64((int64_t) 0, inf_156066);
            int64_t j_m_i_156072 = sub64(min_res_156068, inf_156066);
            int64_t m_156074 = sub64(j_m_i_156072, (int64_t) 1);
            int64_t i_p_m_t_s_156075 = add64(inf_156066, m_156074);
            bool i_p_m_t_s_leq_w_156077 = slt64(i_p_m_t_s_156075, n_86374);
            bool y_156080 = i_p_m_t_s_leq_w_156077 && zzero_lte_i_156078;
            bool zzero_leq_i_p_m_t_s_156076 = sle64((int64_t) 0, i_p_m_t_s_156075);
            bool y_156081 = zzero_leq_i_p_m_t_s_156076 && y_156080;
            bool i_lte_j_156079 = sle64(inf_156066, min_res_156068);
            bool forwards_ok_156082 = i_lte_j_156079 && y_156081;
            bool empty_slice_156073 = j_m_i_156072 == (int64_t) 0;
            bool ok_or_empty_156083 = empty_slice_156073 || forwards_ok_156082;
            bool index_certs_156084;
            
            if (!ok_or_empty_156083) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156066, ":", (long long) min_res_156068, "] out of bounds for array of shape [", (long long) n_86374, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:97:74-85\n   #5  ftRelational.fut:93:5-97:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171317 = b_86375 * j_m_i_156072;
            int64_t bytes_171319 = (int64_t) 8 * j_m_i_156072;
            
            if (mem_171318_cached_sizze_172526 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172526, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_86375, (int64_t) 1}, (uint8_t *) mem_171309.mem, (int64_t) 0 + b_86375 * inf_156066, (int64_t []) {b_86375, (int64_t) 1}, (int64_t []) {j_m_i_156072, b_86375});
            if (mem_171320_cached_sizze_172527 < bytes_171319) {
                err = lexical_realloc(ctx, &mem_171320, &mem_171320_cached_sizze_172527, bytes_171319);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171307.mem, (int64_t) 0 + (int64_t) 1 * inf_156066, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156072});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_86374; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171305.mem)[write_iter_171023];
                double write_iv_171027 = ((double *) mem_param_171280.mem)[write_iter_171023];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0 + write_iter_171023 * b_86375, (int64_t []) {(int64_t) 1}, (int64_t []) {b_86375});
                
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_156066);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156072)) {
                    ((double *) mem_171320)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156072)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_86375 - (int64_t) 1, b_86375))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171318, lifted_lambda_res_162259 * b_86375, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_86375});
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171307.mem, inf_156066, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156072});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, b_86375 * inf_156066, (int64_t []) {b_86375, (int64_t) 1}, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_86375, (int64_t) 1}, (int64_t []) {j_m_i_156072, b_86375});
        }
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171284, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171349, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171348, &mem_param_171284, "mem_param_171284") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171351, bytes_171276, "mem_171351")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171349.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86374});
    if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171353, bytes_171352, "mem_171353")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171353.mem, (int64_t) 0, (int64_t []) {b_86375, (int64_t) 1}, (uint8_t *) ext_mem_171348.mem, (int64_t) 0, (int64_t []) {b_86375, (int64_t) 1}, (int64_t []) {n_86374, b_86375});
    if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171351, "mem_171351") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171353, "mem_171353") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172523, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172524, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171285);
        free(mem_171318);
        free(mem_171320);
        free(mem_171328);
        if (memblock_unref(ctx, &mem_171353, "mem_171353") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171351, "mem_171351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171284, "mem_param_171284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_172529, struct memblock *mem_out_p_172530, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_85431, int64_t b_85432, int64_t block_sizze_85433)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171285_cached_sizze_172531 = 0;
    unsigned char *mem_171285 = NULL;
    int64_t mem_171318_cached_sizze_172532 = 0;
    unsigned char *mem_171318 = NULL;
    int64_t mem_171320_cached_sizze_172533 = 0;
    unsigned char *mem_171320 = NULL;
    int64_t mem_171328_cached_sizze_172534 = 0;
    unsigned char *mem_171328 = NULL;
    struct memblock mem_171353;
    
    mem_171353.references = NULL;
    
    struct memblock mem_171351;
    
    mem_171351.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171309;
    
    mem_171309.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_171284;
    
    mem_param_171284.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171348;
    
    ext_mem_171348.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_85431;
    int64_t bytes_171350 = (int64_t) 4 * n_85431;
    int64_t bytes_171352 = n_85431 * b_85432;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_85431; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171285_cached_sizze_172531 < n_85431) {
        err = lexical_realloc(ctx, &mem_171285, &mem_171285_cached_sizze_172531, n_85431);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171328_cached_sizze_172534 < b_85432) {
        err = lexical_realloc(ctx, &mem_171328, &mem_171328_cached_sizze_172534, b_85432);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &k_mem_171274, "k_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171284, &pL_mem_171275, "pL_mem_171275") != 0)
        return 1;
    for (int64_t i_155962 = 0; i_155962 < (int64_t) 16; i_155962++) {
        int32_t binop_x_155965 = sext_i64_i32(i_155962);
        int32_t binop_x_155966 = mul32(2, binop_x_155965);
        int32_t zm_lhs_155967 = add32(2, binop_x_155966);
        int32_t min_arg1_155968 = sub32(zm_lhs_155967, 1);
        int32_t min_res_155969 = smin32(32, min_arg1_155968);
        int32_t zp_lhs_155970 = sub32(32, binop_x_155966);
        int32_t ij_bits_155971 = add32(1, zp_lhs_155970);
        int32_t up_to_155972 = shl32(1, ij_bits_155971);
        int64_t tmp_155973 = sext_i32_i64(zp_lhs_155970);
        bool bounds_invalid_upwards_155974 = slt32(zp_lhs_155970, 0);
        bool valid_155976 = !bounds_invalid_upwards_155974;
        bool range_valid_c_155977;
        
        if (!valid_155976) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_155973, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:92:74-85\n   #6  ftRelational.fut:88:5-92:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_155998 = sext_i32_i64(up_to_155972);
        bool bounds_invalid_upwards_155999 = slt32(up_to_155972, 0);
        bool valid_156000 = !bounds_invalid_upwards_155999;
        bool range_valid_c_156001;
        
        if (!valid_156000) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_155998, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:92:74-85\n   #5  ftRelational.fut:88:5-92:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156040 = add32(8, min_res_155969);
        int32_t zs_lhs_156041 = sub32(zm_lhs_156040, 1);
        int32_t i32_arg0_156042 = sdiv32(zs_lhs_156041, 8);
        int64_t i32_res_156043 = sext_i32_i64(i32_arg0_156042);
        bool zzero_156044 = i32_res_156043 == (int64_t) 0;
        bool nonzzero_156045 = !zzero_156044;
        bool nonzzero_cert_156046;
        
        if (!nonzzero_156045) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:92:74-85\n   #5  ftRelational.fut:88:5-92:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156047 = sdiv64(block_sizze_85433, i32_res_156043);
        int64_t zm_lhs_156048 = add64(n_85431, psizze__156047);
        int64_t zs_lhs_156049 = sub64(zm_lhs_156048, (int64_t) 1);
        bool zzero_156050 = psizze__156047 == (int64_t) 0;
        bool nonzzero_156051 = !zzero_156050;
        bool nonzzero_cert_156052;
        
        if (!nonzzero_156051) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:92:74-85\n   #5  ftRelational.fut:88:5-92:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156053 = sdiv64(zs_lhs_156049, psizze__156047);
        bool bounds_invalid_upwards_156054 = slt64(max_iter_156053, (int64_t) 0);
        bool valid_156055 = !bounds_invalid_upwards_156054;
        bool range_valid_c_156056;
        
        if (!valid_156055) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156053, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:92:74-85\n   #6  ftRelational.fut:88:5-92:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_155975 = add64((int64_t) 1, tmp_155973);
        
        for (int64_t i_171003 = 0; i_171003 < n_85431; i_171003++) {
            float eta_p_155979 = ((float *) mem_param_171280.mem)[i_171003];
            int32_t i32_arg0_155980 = futrts_to_bits32(eta_p_155979);
            int32_t unsign_arg0_155981 = ashr32(i32_arg0_155980, 31);
            int32_t unsign_arg0_155982 = 1 & unsign_arg0_155981;
            bool cond_155983 = unsign_arg0_155982 == 1;
            bool x_155984 = !cond_155983;
            int8_t defunc_0_f_res_155985;
            int8_t y_155987 = (int8_t) 0;
            
            for (int64_t i_155986 = 0; i_155986 < distance_155975; i_155986++) {
                int32_t binop_x_155988 = sext_i64_i32(i_155986);
                int32_t get_bit_arg0_155989 = add32(binop_x_155966, binop_x_155988);
                int32_t unsign_arg0_155990 = ashr32(i32_arg0_155980, get_bit_arg0_155989);
                int32_t unsign_arg0_155991 = 1 & unsign_arg0_155990;
                bool cond_f_res_155992 = get_bit_arg0_155989 == 31;
                bool y_155993 = x_155984 && cond_f_res_155992;
                bool cond_155994 = cond_155983 || y_155993;
                int32_t defunc_0_get_bit_res_155995;
                
                if (cond_155994) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ unsign_arg0_155991;
                    
                    defunc_0_get_bit_res_155995 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_155995 = unsign_arg0_155991;
                }
                
                int8_t loopres_155997;
                
                if (futrts_set_bit_2464(ctx, &loopres_155997, binop_x_155988, y_155987, defunc_0_get_bit_res_155995) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_155997;
                
                y_155987 = y_tmp_171964;
            }
            defunc_0_f_res_155985 = y_155987;
            ((int8_t *) mem_171285)[i_171003] = defunc_0_f_res_155985;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156002;
        int64_t offs_156005;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_156005 = (int64_t) 0;
        for (int64_t i_156004 = 0; i_156004 < up_to_155998; i_156004++) {
            int32_t binop_x_156007 = sext_i64_i32(i_156004);
            int8_t index_primexp_156008 = zext_i32_i8(binop_x_156007);
            
            if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_85431; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171285)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_156008;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171294.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_156005, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171296.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_156033 = add64(offs_156005, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171296, "mem_171296") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_156033;
            
            if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_156005 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156002 = offs_156005;
        if (memblock_alloc(ctx, &mem_171307, bytes_171350, "mem_171307")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171307.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85431});
        if (memblock_alloc(ctx, &mem_171309, bytes_171352, "mem_171309")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, (int64_t) 0, (int64_t []) {b_85432, (int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0, (int64_t []) {b_85432, (int64_t) 1}, (int64_t []) {n_85431, b_85432});
        for (int64_t i_156059 = 0; i_156059 < max_iter_156053; i_156059++) {
            int64_t inf_156062 = mul64(psizze__156047, i_156059);
            int64_t min_arg1_156063 = add64(psizze__156047, inf_156062);
            int64_t min_res_156064 = smin64(n_85431, min_arg1_156063);
            bool zzero_lte_i_156074 = sle64((int64_t) 0, inf_156062);
            int64_t j_m_i_156068 = sub64(min_res_156064, inf_156062);
            int64_t m_156070 = sub64(j_m_i_156068, (int64_t) 1);
            int64_t i_p_m_t_s_156071 = add64(inf_156062, m_156070);
            bool i_p_m_t_s_leq_w_156073 = slt64(i_p_m_t_s_156071, n_85431);
            bool y_156076 = i_p_m_t_s_leq_w_156073 && zzero_lte_i_156074;
            bool zzero_leq_i_p_m_t_s_156072 = sle64((int64_t) 0, i_p_m_t_s_156071);
            bool y_156077 = zzero_leq_i_p_m_t_s_156072 && y_156076;
            bool i_lte_j_156075 = sle64(inf_156062, min_res_156064);
            bool forwards_ok_156078 = i_lte_j_156075 && y_156077;
            bool empty_slice_156069 = j_m_i_156068 == (int64_t) 0;
            bool ok_or_empty_156079 = empty_slice_156069 || forwards_ok_156078;
            bool index_certs_156080;
            
            if (!ok_or_empty_156079) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156062, ":", (long long) min_res_156064, "] out of bounds for array of shape [", (long long) n_85431, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:92:74-85\n   #5  ftRelational.fut:88:5-92:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171317 = b_85432 * j_m_i_156068;
            int64_t bytes_171319 = (int64_t) 4 * j_m_i_156068;
            
            if (mem_171318_cached_sizze_172532 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172532, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_85432, (int64_t) 1}, (uint8_t *) mem_171309.mem, (int64_t) 0 + b_85432 * inf_156062, (int64_t []) {b_85432, (int64_t) 1}, (int64_t []) {j_m_i_156068, b_85432});
            if (mem_171320_cached_sizze_172533 < bytes_171319) {
                err = lexical_realloc(ctx, &mem_171320, &mem_171320_cached_sizze_172533, bytes_171319);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171307.mem, (int64_t) 0 + (int64_t) 1 * inf_156062, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156068});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_85431; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171305.mem)[write_iter_171023];
                float write_iv_171027 = ((float *) mem_param_171280.mem)[write_iter_171023];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0 + write_iter_171023 * b_85432, (int64_t []) {(int64_t) 1}, (int64_t []) {b_85432});
                
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_156062);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156068)) {
                    ((float *) mem_171320)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_156068)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_85432 - (int64_t) 1, b_85432))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171318, lifted_lambda_res_162259 * b_85432, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_85432});
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171307.mem, inf_156062, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156068});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, b_85432 * inf_156062, (int64_t []) {b_85432, (int64_t) 1}, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_85432, (int64_t) 1}, (int64_t []) {j_m_i_156068, b_85432});
        }
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171284, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171349, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171348, &mem_param_171284, "mem_param_171284") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171351, bytes_171350, "mem_171351")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171349.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85431});
    if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171353, bytes_171352, "mem_171353")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171353.mem, (int64_t) 0, (int64_t []) {b_85432, (int64_t) 1}, (uint8_t *) ext_mem_171348.mem, (int64_t) 0, (int64_t []) {b_85432, (int64_t) 1}, (int64_t []) {n_85431, b_85432});
    if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171351, "mem_171351") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171353, "mem_171353") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172529, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172530, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171285);
        free(mem_171318);
        free(mem_171320);
        free(mem_171328);
        if (memblock_unref(ctx, &mem_171353, "mem_171353") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171351, "mem_171351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171284, "mem_param_171284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_172535, struct memblock *mem_out_p_172536, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_83613, int64_t b_83614, int64_t block_sizze_83615)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171285_cached_sizze_172537 = 0;
    unsigned char *mem_171285 = NULL;
    int64_t mem_171318_cached_sizze_172538 = 0;
    unsigned char *mem_171318 = NULL;
    int64_t mem_171320_cached_sizze_172539 = 0;
    unsigned char *mem_171320 = NULL;
    int64_t mem_171328_cached_sizze_172540 = 0;
    unsigned char *mem_171328 = NULL;
    struct memblock mem_171353;
    
    mem_171353.references = NULL;
    
    struct memblock mem_171351;
    
    mem_171351.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171309;
    
    mem_171309.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_171284;
    
    mem_param_171284.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171348;
    
    ext_mem_171348.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_83613;
    int64_t bytes_171350 = (int64_t) 4 * n_83613;
    int64_t bytes_171352 = n_83613 * b_83614;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_83613; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171285_cached_sizze_172537 < n_83613) {
        err = lexical_realloc(ctx, &mem_171285, &mem_171285_cached_sizze_172537, n_83613);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171328_cached_sizze_172540 < b_83614) {
        err = lexical_realloc(ctx, &mem_171328, &mem_171328_cached_sizze_172540, b_83614);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &k_mem_171274, "k_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171284, &pL_mem_171275, "pL_mem_171275") != 0)
        return 1;
    for (int64_t i_154415 = 0; i_154415 < (int64_t) 16; i_154415++) {
        int32_t binop_x_154418 = sext_i64_i32(i_154415);
        int32_t binop_x_154419 = mul32(2, binop_x_154418);
        int32_t zm_lhs_154420 = add32(2, binop_x_154419);
        int32_t min_arg1_154421 = sub32(zm_lhs_154420, 1);
        int32_t min_res_154422 = smin32(32, min_arg1_154421);
        int32_t zp_lhs_154423 = sub32(32, binop_x_154419);
        int32_t ij_bits_154424 = add32(1, zp_lhs_154423);
        int32_t up_to_154425 = shl32(1, ij_bits_154424);
        int64_t tmp_154426 = sext_i32_i64(zp_lhs_154423);
        bool bounds_invalid_upwards_154427 = slt32(zp_lhs_154423, 0);
        bool valid_154429 = !bounds_invalid_upwards_154427;
        bool range_valid_c_154430;
        
        if (!valid_154429) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154426, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:82:77-88\n   #6  ftRelational.fut:78:5-82:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154443 = sext_i32_i64(up_to_154425);
        bool bounds_invalid_upwards_154444 = slt32(up_to_154425, 0);
        bool valid_154445 = !bounds_invalid_upwards_154444;
        bool range_valid_c_154446;
        
        if (!valid_154445) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154443, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:82:77-88\n   #5  ftRelational.fut:78:5-82:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_154485 = add32(8, min_res_154422);
        int32_t zs_lhs_154486 = sub32(zm_lhs_154485, 1);
        int32_t i32_arg0_154487 = sdiv32(zs_lhs_154486, 8);
        int64_t i32_res_154488 = sext_i32_i64(i32_arg0_154487);
        bool zzero_154489 = i32_res_154488 == (int64_t) 0;
        bool nonzzero_154490 = !zzero_154489;
        bool nonzzero_cert_154491;
        
        if (!nonzzero_154490) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:82:77-88\n   #5  ftRelational.fut:78:5-82:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154492 = sdiv64(block_sizze_83615, i32_res_154488);
        int64_t zm_lhs_154493 = add64(n_83613, psizze__154492);
        int64_t zs_lhs_154494 = sub64(zm_lhs_154493, (int64_t) 1);
        bool zzero_154495 = psizze__154492 == (int64_t) 0;
        bool nonzzero_154496 = !zzero_154495;
        bool nonzzero_cert_154497;
        
        if (!nonzzero_154496) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:82:77-88\n   #5  ftRelational.fut:78:5-82:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_154498 = sdiv64(zs_lhs_154494, psizze__154492);
        bool bounds_invalid_upwards_154499 = slt64(max_iter_154498, (int64_t) 0);
        bool valid_154500 = !bounds_invalid_upwards_154499;
        bool range_valid_c_154501;
        
        if (!valid_154500) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154498, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:82:77-88\n   #6  ftRelational.fut:78:5-82:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154428 = add64((int64_t) 1, tmp_154426);
        
        for (int64_t i_171003 = 0; i_171003 < n_83613; i_171003++) {
            int32_t eta_p_154432 = ((int32_t *) mem_param_171280.mem)[i_171003];
            int8_t defunc_0_f_res_154433;
            int8_t y_154435 = (int8_t) 0;
            
            for (int64_t i_154434 = 0; i_154434 < distance_154428; i_154434++) {
                int32_t binop_x_154436 = sext_i64_i32(i_154434);
                int32_t get_bit_arg0_154437 = add32(binop_x_154419, binop_x_154436);
                int32_t zgzg_res_161776 = ashr32(eta_p_154432, get_bit_arg0_154437);
                int32_t za_res_161777 = 1 & zgzg_res_161776;
                bool cond_154439 = get_bit_arg0_154437 == 31;
                int32_t defunc_0_get_bit_res_154440;
                
                if (cond_154439) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ za_res_161777;
                    
                    defunc_0_get_bit_res_154440 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_154440 = za_res_161777;
                }
                
                int8_t loopres_154442;
                
                if (futrts_set_bit_2464(ctx, &loopres_154442, binop_x_154436, y_154435, defunc_0_get_bit_res_154440) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_154442;
                
                y_154435 = y_tmp_171964;
            }
            defunc_0_f_res_154433 = y_154435;
            ((int8_t *) mem_171285)[i_171003] = defunc_0_f_res_154433;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154447;
        int64_t offs_154450;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_154450 = (int64_t) 0;
        for (int64_t i_154449 = 0; i_154449 < up_to_154443; i_154449++) {
            int32_t binop_x_154452 = sext_i64_i32(i_154449);
            int8_t index_primexp_154453 = zext_i32_i8(binop_x_154452);
            
            if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_83613; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171285)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_154453;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171294.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_154450, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171296.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_154478 = add64(offs_154450, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171296, "mem_171296") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_154478;
            
            if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_154450 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154447 = offs_154450;
        if (memblock_alloc(ctx, &mem_171307, bytes_171350, "mem_171307")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171307.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_83613});
        if (memblock_alloc(ctx, &mem_171309, bytes_171352, "mem_171309")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, (int64_t) 0, (int64_t []) {b_83614, (int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0, (int64_t []) {b_83614, (int64_t) 1}, (int64_t []) {n_83613, b_83614});
        for (int64_t i_154504 = 0; i_154504 < max_iter_154498; i_154504++) {
            int64_t inf_154507 = mul64(psizze__154492, i_154504);
            int64_t min_arg1_154508 = add64(psizze__154492, inf_154507);
            int64_t min_res_154509 = smin64(n_83613, min_arg1_154508);
            bool zzero_lte_i_154519 = sle64((int64_t) 0, inf_154507);
            int64_t j_m_i_154513 = sub64(min_res_154509, inf_154507);
            int64_t m_154515 = sub64(j_m_i_154513, (int64_t) 1);
            int64_t i_p_m_t_s_154516 = add64(inf_154507, m_154515);
            bool i_p_m_t_s_leq_w_154518 = slt64(i_p_m_t_s_154516, n_83613);
            bool y_154521 = i_p_m_t_s_leq_w_154518 && zzero_lte_i_154519;
            bool zzero_leq_i_p_m_t_s_154517 = sle64((int64_t) 0, i_p_m_t_s_154516);
            bool y_154522 = zzero_leq_i_p_m_t_s_154517 && y_154521;
            bool i_lte_j_154520 = sle64(inf_154507, min_res_154509);
            bool forwards_ok_154523 = i_lte_j_154520 && y_154522;
            bool empty_slice_154514 = j_m_i_154513 == (int64_t) 0;
            bool ok_or_empty_154524 = empty_slice_154514 || forwards_ok_154523;
            bool index_certs_154525;
            
            if (!ok_or_empty_154524) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154507, ":", (long long) min_res_154509, "] out of bounds for array of shape [", (long long) n_83613, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:82:77-88\n   #5  ftRelational.fut:78:5-82:89\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171317 = b_83614 * j_m_i_154513;
            int64_t bytes_171319 = (int64_t) 4 * j_m_i_154513;
            
            if (mem_171318_cached_sizze_172538 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172538, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_83614, (int64_t) 1}, (uint8_t *) mem_171309.mem, (int64_t) 0 + b_83614 * inf_154507, (int64_t []) {b_83614, (int64_t) 1}, (int64_t []) {j_m_i_154513, b_83614});
            if (mem_171320_cached_sizze_172539 < bytes_171319) {
                err = lexical_realloc(ctx, &mem_171320, &mem_171320_cached_sizze_172539, bytes_171319);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171307.mem, (int64_t) 0 + (int64_t) 1 * inf_154507, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154513});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_83613; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171305.mem)[write_iter_171023];
                int32_t write_iv_171027 = ((int32_t *) mem_param_171280.mem)[write_iter_171023];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0 + write_iter_171023 * b_83614, (int64_t []) {(int64_t) 1}, (int64_t []) {b_83614});
                
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_154507);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154513)) {
                    ((int32_t *) mem_171320)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154513)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_83614 - (int64_t) 1, b_83614))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171318, lifted_lambda_res_162259 * b_83614, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_83614});
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171307.mem, inf_154507, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154513});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, b_83614 * inf_154507, (int64_t []) {b_83614, (int64_t) 1}, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_83614, (int64_t) 1}, (int64_t []) {j_m_i_154513, b_83614});
        }
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171284, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171349, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171348, &mem_param_171284, "mem_param_171284") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171351, bytes_171350, "mem_171351")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171349.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_83613});
    if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171353, bytes_171352, "mem_171353")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171353.mem, (int64_t) 0, (int64_t []) {b_83614, (int64_t) 1}, (uint8_t *) ext_mem_171348.mem, (int64_t) 0, (int64_t []) {b_83614, (int64_t) 1}, (int64_t []) {n_83613, b_83614});
    if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171351, "mem_171351") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171353, "mem_171353") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172535, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172536, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171285);
        free(mem_171318);
        free(mem_171320);
        free(mem_171328);
        if (memblock_unref(ctx, &mem_171353, "mem_171353") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171351, "mem_171351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171284, "mem_param_171284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_172541, struct memblock *mem_out_p_172542, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_84492, int64_t b_84493, int64_t block_sizze_84494)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171285_cached_sizze_172543 = 0;
    unsigned char *mem_171285 = NULL;
    int64_t mem_171318_cached_sizze_172544 = 0;
    unsigned char *mem_171318 = NULL;
    int64_t mem_171320_cached_sizze_172545 = 0;
    unsigned char *mem_171320 = NULL;
    int64_t mem_171328_cached_sizze_172546 = 0;
    unsigned char *mem_171328 = NULL;
    struct memblock mem_171353;
    
    mem_171353.references = NULL;
    
    struct memblock mem_171351;
    
    mem_171351.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171309;
    
    mem_171309.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_171284;
    
    mem_param_171284.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171348;
    
    ext_mem_171348.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_84492;
    int64_t bytes_171352 = n_84492 * b_84493;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_84492; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171285_cached_sizze_172543 < n_84492) {
        err = lexical_realloc(ctx, &mem_171285, &mem_171285_cached_sizze_172543, n_84492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171328_cached_sizze_172546 < b_84493) {
        err = lexical_realloc(ctx, &mem_171328, &mem_171328_cached_sizze_172546, b_84493);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &k_mem_171274, "k_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171284, &pL_mem_171275, "pL_mem_171275") != 0)
        return 1;
    for (int64_t i_154415 = 0; i_154415 < (int64_t) 32; i_154415++) {
        int32_t binop_x_154418 = sext_i64_i32(i_154415);
        int32_t binop_x_154419 = mul32(2, binop_x_154418);
        int32_t zm_lhs_154420 = add32(2, binop_x_154419);
        int32_t min_arg1_154421 = sub32(zm_lhs_154420, 1);
        int32_t min_res_154422 = smin32(64, min_arg1_154421);
        int32_t zp_lhs_154423 = sub32(64, binop_x_154419);
        int32_t ij_bits_154424 = add32(1, zp_lhs_154423);
        int32_t up_to_154425 = shl32(1, ij_bits_154424);
        int64_t tmp_154426 = sext_i32_i64(zp_lhs_154423);
        bool bounds_invalid_upwards_154427 = slt32(zp_lhs_154423, 0);
        bool valid_154429 = !bounds_invalid_upwards_154427;
        bool range_valid_c_154430;
        
        if (!valid_154429) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154426, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:87:77-88\n   #6  ftRelational.fut:83:5-87:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154443 = sext_i32_i64(up_to_154425);
        bool bounds_invalid_upwards_154444 = slt32(up_to_154425, 0);
        bool valid_154445 = !bounds_invalid_upwards_154444;
        bool range_valid_c_154446;
        
        if (!valid_154445) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154443, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:87:77-88\n   #5  ftRelational.fut:83:5-87:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_154485 = add32(8, min_res_154422);
        int32_t zs_lhs_154486 = sub32(zm_lhs_154485, 1);
        int32_t i32_arg0_154487 = sdiv32(zs_lhs_154486, 8);
        int64_t i32_res_154488 = sext_i32_i64(i32_arg0_154487);
        bool zzero_154489 = i32_res_154488 == (int64_t) 0;
        bool nonzzero_154490 = !zzero_154489;
        bool nonzzero_cert_154491;
        
        if (!nonzzero_154490) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:87:77-88\n   #5  ftRelational.fut:83:5-87:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154492 = sdiv64(block_sizze_84494, i32_res_154488);
        int64_t zm_lhs_154493 = add64(n_84492, psizze__154492);
        int64_t zs_lhs_154494 = sub64(zm_lhs_154493, (int64_t) 1);
        bool zzero_154495 = psizze__154492 == (int64_t) 0;
        bool nonzzero_154496 = !zzero_154495;
        bool nonzzero_cert_154497;
        
        if (!nonzzero_154496) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:87:77-88\n   #5  ftRelational.fut:83:5-87:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_154498 = sdiv64(zs_lhs_154494, psizze__154492);
        bool bounds_invalid_upwards_154499 = slt64(max_iter_154498, (int64_t) 0);
        bool valid_154500 = !bounds_invalid_upwards_154499;
        bool range_valid_c_154501;
        
        if (!valid_154500) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154498, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:87:77-88\n   #6  ftRelational.fut:83:5-87:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154428 = add64((int64_t) 1, tmp_154426);
        
        for (int64_t i_171003 = 0; i_171003 < n_84492; i_171003++) {
            int64_t eta_p_154432 = ((int64_t *) mem_param_171280.mem)[i_171003];
            int8_t defunc_0_f_res_154433;
            int8_t y_154435 = (int8_t) 0;
            
            for (int64_t i_154434 = 0; i_154434 < distance_154428; i_154434++) {
                int32_t binop_x_154436 = sext_i64_i32(i_154434);
                int32_t get_bit_arg0_154437 = add32(binop_x_154419, binop_x_154436);
                int32_t defunc_0_get_bit_res_154438;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_154438, get_bit_arg0_154437, eta_p_154432) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154439 = get_bit_arg0_154437 == 63;
                int32_t defunc_0_get_bit_res_154440;
                
                if (cond_154439) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ defunc_0_get_bit_res_154438;
                    
                    defunc_0_get_bit_res_154440 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_154440 = defunc_0_get_bit_res_154438;
                }
                
                int8_t loopres_154442;
                
                if (futrts_set_bit_2464(ctx, &loopres_154442, binop_x_154436, y_154435, defunc_0_get_bit_res_154440) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_154442;
                
                y_154435 = y_tmp_171964;
            }
            defunc_0_f_res_154433 = y_154435;
            ((int8_t *) mem_171285)[i_171003] = defunc_0_f_res_154433;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154447;
        int64_t offs_154450;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_154450 = (int64_t) 0;
        for (int64_t i_154449 = 0; i_154449 < up_to_154443; i_154449++) {
            int32_t binop_x_154452 = sext_i64_i32(i_154449);
            int8_t index_primexp_154453 = zext_i32_i8(binop_x_154452);
            
            if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_84492; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171285)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_154453;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171294.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_154450, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171296.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_154478 = add64(offs_154450, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171296, "mem_171296") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_154478;
            
            if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_154450 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154447 = offs_154450;
        if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171307.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_84492});
        if (memblock_alloc(ctx, &mem_171309, bytes_171352, "mem_171309")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, (int64_t) 0, (int64_t []) {b_84493, (int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0, (int64_t []) {b_84493, (int64_t) 1}, (int64_t []) {n_84492, b_84493});
        for (int64_t i_154504 = 0; i_154504 < max_iter_154498; i_154504++) {
            int64_t inf_154507 = mul64(psizze__154492, i_154504);
            int64_t min_arg1_154508 = add64(psizze__154492, inf_154507);
            int64_t min_res_154509 = smin64(n_84492, min_arg1_154508);
            bool zzero_lte_i_154519 = sle64((int64_t) 0, inf_154507);
            int64_t j_m_i_154513 = sub64(min_res_154509, inf_154507);
            int64_t m_154515 = sub64(j_m_i_154513, (int64_t) 1);
            int64_t i_p_m_t_s_154516 = add64(inf_154507, m_154515);
            bool i_p_m_t_s_leq_w_154518 = slt64(i_p_m_t_s_154516, n_84492);
            bool y_154521 = i_p_m_t_s_leq_w_154518 && zzero_lte_i_154519;
            bool zzero_leq_i_p_m_t_s_154517 = sle64((int64_t) 0, i_p_m_t_s_154516);
            bool y_154522 = zzero_leq_i_p_m_t_s_154517 && y_154521;
            bool i_lte_j_154520 = sle64(inf_154507, min_res_154509);
            bool forwards_ok_154523 = i_lte_j_154520 && y_154522;
            bool empty_slice_154514 = j_m_i_154513 == (int64_t) 0;
            bool ok_or_empty_154524 = empty_slice_154514 || forwards_ok_154523;
            bool index_certs_154525;
            
            if (!ok_or_empty_154524) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154507, ":", (long long) min_res_154509, "] out of bounds for array of shape [", (long long) n_84492, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:87:77-88\n   #5  ftRelational.fut:83:5-87:89\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171317 = b_84493 * j_m_i_154513;
            int64_t bytes_171319 = (int64_t) 8 * j_m_i_154513;
            
            if (mem_171318_cached_sizze_172544 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172544, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_84493, (int64_t) 1}, (uint8_t *) mem_171309.mem, (int64_t) 0 + b_84493 * inf_154507, (int64_t []) {b_84493, (int64_t) 1}, (int64_t []) {j_m_i_154513, b_84493});
            if (mem_171320_cached_sizze_172545 < bytes_171319) {
                err = lexical_realloc(ctx, &mem_171320, &mem_171320_cached_sizze_172545, bytes_171319);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171307.mem, (int64_t) 0 + (int64_t) 1 * inf_154507, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154513});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_84492; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171305.mem)[write_iter_171023];
                int64_t write_iv_171027 = ((int64_t *) mem_param_171280.mem)[write_iter_171023];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0 + write_iter_171023 * b_84493, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84493});
                
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_154507);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154513)) {
                    ((int64_t *) mem_171320)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154513)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_84493 - (int64_t) 1, b_84493))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171318, lifted_lambda_res_162259 * b_84493, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84493});
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171307.mem, inf_154507, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154513});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, b_84493 * inf_154507, (int64_t []) {b_84493, (int64_t) 1}, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_84493, (int64_t) 1}, (int64_t []) {j_m_i_154513, b_84493});
        }
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171284, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171349, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171348, &mem_param_171284, "mem_param_171284") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171351, bytes_171276, "mem_171351")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171349.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_84492});
    if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171353, bytes_171352, "mem_171353")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171353.mem, (int64_t) 0, (int64_t []) {b_84493, (int64_t) 1}, (uint8_t *) ext_mem_171348.mem, (int64_t) 0, (int64_t []) {b_84493, (int64_t) 1}, (int64_t []) {n_84492, b_84493});
    if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171351, "mem_171351") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171353, "mem_171353") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172541, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172542, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171285);
        free(mem_171318);
        free(mem_171320);
        free(mem_171328);
        if (memblock_unref(ctx, &mem_171353, "mem_171353") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171351, "mem_171351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171284, "mem_param_171284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_172547, struct memblock *mem_out_p_172548, struct memblock k_mem_171274, struct memblock pL_mem_171275, int64_t n_82726, int64_t b_82727, int64_t block_sizze_82728)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171285_cached_sizze_172549 = 0;
    unsigned char *mem_171285 = NULL;
    int64_t mem_171318_cached_sizze_172550 = 0;
    unsigned char *mem_171318 = NULL;
    int64_t mem_171320_cached_sizze_172551 = 0;
    unsigned char *mem_171320 = NULL;
    int64_t mem_171328_cached_sizze_172552 = 0;
    unsigned char *mem_171328 = NULL;
    struct memblock mem_171353;
    
    mem_171353.references = NULL;
    
    struct memblock mem_171351;
    
    mem_171351.references = NULL;
    
    struct memblock mem_param_tmp_171960;
    
    mem_param_tmp_171960.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171309;
    
    mem_171309.references = NULL;
    
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171965;
    
    mem_param_tmp_171965.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_171284;
    
    mem_param_171284.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171348;
    
    ext_mem_171348.references = NULL;
    
    struct memblock ext_mem_171349;
    
    ext_mem_171349.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * n_82726;
    int64_t bytes_171350 = (int64_t) 2 * n_82726;
    int64_t bytes_171352 = n_82726 * b_82727;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < n_82726; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    if (mem_171285_cached_sizze_172549 < n_82726) {
        err = lexical_realloc(ctx, &mem_171285, &mem_171285_cached_sizze_172549, n_82726);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171328_cached_sizze_172552 < b_82727) {
        err = lexical_realloc(ctx, &mem_171328, &mem_171328_cached_sizze_172552, b_82727);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171280, &k_mem_171274, "k_mem_171274") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171284, &pL_mem_171275, "pL_mem_171275") != 0)
        return 1;
    for (int64_t i_154415 = 0; i_154415 < (int64_t) 8; i_154415++) {
        int32_t binop_x_154418 = sext_i64_i32(i_154415);
        int32_t binop_x_154419 = mul32(2, binop_x_154418);
        int32_t zm_lhs_154420 = add32(2, binop_x_154419);
        int32_t min_arg1_154421 = sub32(zm_lhs_154420, 1);
        int32_t min_res_154422 = smin32(16, min_arg1_154421);
        int32_t zp_lhs_154423 = sub32(16, binop_x_154419);
        int32_t ij_bits_154424 = add32(1, zp_lhs_154423);
        int32_t up_to_154425 = shl32(1, ij_bits_154424);
        int64_t tmp_154426 = sext_i32_i64(zp_lhs_154423);
        bool bounds_invalid_upwards_154427 = slt32(zp_lhs_154423, 0);
        bool valid_154429 = !bounds_invalid_upwards_154427;
        bool range_valid_c_154430;
        
        if (!valid_154429) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154426, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:77:77-88\n   #6  ftRelational.fut:73:5-77:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154443 = sext_i32_i64(up_to_154425);
        bool bounds_invalid_upwards_154444 = slt32(up_to_154425, 0);
        bool valid_154445 = !bounds_invalid_upwards_154444;
        bool range_valid_c_154446;
        
        if (!valid_154445) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154443, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:77:77-88\n   #5  ftRelational.fut:73:5-77:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_154485 = add32(8, min_res_154422);
        int32_t zs_lhs_154486 = sub32(zm_lhs_154485, 1);
        int32_t i32_arg0_154487 = sdiv32(zs_lhs_154486, 8);
        int64_t i32_res_154488 = sext_i32_i64(i32_arg0_154487);
        bool zzero_154489 = i32_res_154488 == (int64_t) 0;
        bool nonzzero_154490 = !zzero_154489;
        bool nonzzero_cert_154491;
        
        if (!nonzzero_154490) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:77:77-88\n   #5  ftRelational.fut:73:5-77:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__154492 = sdiv64(block_sizze_82728, i32_res_154488);
        int64_t zm_lhs_154493 = add64(n_82726, psizze__154492);
        int64_t zs_lhs_154494 = sub64(zm_lhs_154493, (int64_t) 1);
        bool zzero_154495 = psizze__154492 == (int64_t) 0;
        bool nonzzero_154496 = !zzero_154495;
        bool nonzzero_cert_154497;
        
        if (!nonzzero_154496) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:77:77-88\n   #5  ftRelational.fut:73:5-77:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_154498 = sdiv64(zs_lhs_154494, psizze__154492);
        bool bounds_invalid_upwards_154499 = slt64(max_iter_154498, (int64_t) 0);
        bool valid_154500 = !bounds_invalid_upwards_154499;
        bool range_valid_c_154501;
        
        if (!valid_154500) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_154498, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:77:77-88\n   #6  ftRelational.fut:73:5-77:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154428 = add64((int64_t) 1, tmp_154426);
        
        for (int64_t i_171003 = 0; i_171003 < n_82726; i_171003++) {
            int16_t eta_p_154432 = ((int16_t *) mem_param_171280.mem)[i_171003];
            int8_t defunc_0_f_res_154433;
            int8_t y_154435 = (int8_t) 0;
            
            for (int64_t i_154434 = 0; i_154434 < distance_154428; i_154434++) {
                int32_t binop_x_154436 = sext_i64_i32(i_154434);
                int32_t get_bit_arg0_154437 = add32(binop_x_154419, binop_x_154436);
                int32_t defunc_0_get_bit_res_154438;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_154438, get_bit_arg0_154437, eta_p_154432) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154439 = get_bit_arg0_154437 == 15;
                int32_t defunc_0_get_bit_res_154440;
                
                if (cond_154439) {
                    int32_t defunc_0_get_bit_res_t_res_162274 = 1 ^ defunc_0_get_bit_res_154438;
                    
                    defunc_0_get_bit_res_154440 = defunc_0_get_bit_res_t_res_162274;
                } else {
                    defunc_0_get_bit_res_154440 = defunc_0_get_bit_res_154438;
                }
                
                int8_t loopres_154442;
                
                if (futrts_set_bit_2464(ctx, &loopres_154442, binop_x_154436, y_154435, defunc_0_get_bit_res_154440) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_171964 = loopres_154442;
                
                y_154435 = y_tmp_171964;
            }
            defunc_0_f_res_154433 = y_154435;
            ((int8_t *) mem_171285)[i_171003] = defunc_0_f_res_154433;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154447;
        int64_t offs_154450;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_171277, "mem_171277") != 0)
            return 1;
        offs_154450 = (int64_t) 0;
        for (int64_t i_154449 = 0; i_154449 < up_to_154443; i_154449++) {
            int32_t binop_x_154452 = sext_i64_i32(i_154449);
            int8_t index_primexp_154453 = zext_i32_i8(binop_x_154452);
            
            if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162279;
            int64_t defunc_0_reduce_res_162280;
            int64_t inpacc_162167;
            int64_t inpacc_162168;
            
            inpacc_162167 = (int64_t) 0;
            inpacc_162168 = (int64_t) 0;
            for (int64_t i_171021 = 0; i_171021 < n_82726; i_171021++) {
                int8_t eta_p_171250 = ((int8_t *) mem_171285)[i_171021];
                bool lifted_lambda_res_171251 = eta_p_171250 == index_primexp_154453;
                int64_t bool_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                int64_t eta_p_171265 = ((int64_t *) mem_param_171294.mem)[i_171021];
                int64_t defunc_0_op_res_171266 = add64(inpacc_162167, bool_res_171252);
                int64_t zm_lhs_171267 = add64(offs_154450, defunc_0_op_res_171266);
                int64_t lifted_lambda_res_171268 = sub64(zm_lhs_171267, (int64_t) 1);
                int64_t defunc_0_f_res_171269 = mul64(bool_res_171252, lifted_lambda_res_171268);
                int64_t defunc_0_f_res_171270 = add64(eta_p_171265, defunc_0_f_res_171269);
                int64_t defunc_0_op_res_162216 = add64(inpacc_162168, bool_res_171252);
                
                ((int64_t *) mem_171296.mem)[i_171021] = defunc_0_f_res_171270;
                
                int64_t inpacc_tmp_171968 = defunc_0_op_res_171266;
                int64_t inpacc_tmp_171969 = defunc_0_op_res_162216;
                
                inpacc_162167 = inpacc_tmp_171968;
                inpacc_162168 = inpacc_tmp_171969;
            }
            inpacc_162279 = inpacc_162167;
            defunc_0_reduce_res_162280 = inpacc_162168;
            
            int64_t tmp_154478 = add64(offs_154450, defunc_0_reduce_res_162280);
            
            if (memblock_set(ctx, &mem_param_tmp_171965, &mem_171296, "mem_171296") != 0)
                return 1;
            
            int64_t offs_tmp_171966 = tmp_154478;
            
            if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
                return 1;
            offs_154450 = offs_tmp_171966;
        }
        if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154447 = offs_154450;
        if (memblock_alloc(ctx, &mem_171307, bytes_171350, "mem_171307")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_171307.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_171280.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_82726});
        if (memblock_alloc(ctx, &mem_171309, bytes_171352, "mem_171309")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, (int64_t) 0, (int64_t []) {b_82727, (int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0, (int64_t []) {b_82727, (int64_t) 1}, (int64_t []) {n_82726, b_82727});
        for (int64_t i_154504 = 0; i_154504 < max_iter_154498; i_154504++) {
            int64_t inf_154507 = mul64(psizze__154492, i_154504);
            int64_t min_arg1_154508 = add64(psizze__154492, inf_154507);
            int64_t min_res_154509 = smin64(n_82726, min_arg1_154508);
            bool zzero_lte_i_154519 = sle64((int64_t) 0, inf_154507);
            int64_t j_m_i_154513 = sub64(min_res_154509, inf_154507);
            int64_t m_154515 = sub64(j_m_i_154513, (int64_t) 1);
            int64_t i_p_m_t_s_154516 = add64(inf_154507, m_154515);
            bool i_p_m_t_s_leq_w_154518 = slt64(i_p_m_t_s_154516, n_82726);
            bool y_154521 = i_p_m_t_s_leq_w_154518 && zzero_lte_i_154519;
            bool zzero_leq_i_p_m_t_s_154517 = sle64((int64_t) 0, i_p_m_t_s_154516);
            bool y_154522 = zzero_leq_i_p_m_t_s_154517 && y_154521;
            bool i_lte_j_154520 = sle64(inf_154507, min_res_154509);
            bool forwards_ok_154523 = i_lte_j_154520 && y_154522;
            bool empty_slice_154514 = j_m_i_154513 == (int64_t) 0;
            bool ok_or_empty_154524 = empty_slice_154514 || forwards_ok_154523;
            bool index_certs_154525;
            
            if (!ok_or_empty_154524) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_154507, ":", (long long) min_res_154509, "] out of bounds for array of shape [", (long long) n_82726, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:77:77-88\n   #5  ftRelational.fut:73:5-77:89\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171317 = b_82727 * j_m_i_154513;
            int64_t bytes_171319 = (int64_t) 2 * j_m_i_154513;
            
            if (mem_171318_cached_sizze_172550 < bytes_171317) {
                err = lexical_realloc(ctx, &mem_171318, &mem_171318_cached_sizze_172550, bytes_171317);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_82727, (int64_t) 1}, (uint8_t *) mem_171309.mem, (int64_t) 0 + b_82727 * inf_154507, (int64_t []) {b_82727, (int64_t) 1}, (int64_t []) {j_m_i_154513, b_82727});
            if (mem_171320_cached_sizze_172551 < bytes_171319) {
                err = lexical_realloc(ctx, &mem_171320, &mem_171320_cached_sizze_172551, bytes_171319);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171307.mem, (int64_t) 0 + (int64_t) 1 * inf_154507, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154513});
            for (int64_t write_iter_171023 = 0; write_iter_171023 < n_82726; write_iter_171023++) {
                int64_t write_iv_171026 = ((int64_t *) ext_mem_171305.mem)[write_iter_171023];
                int16_t write_iv_171027 = ((int16_t *) mem_param_171280.mem)[write_iter_171023];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171284.mem, (int64_t) 0 + write_iter_171023 * b_82727, (int64_t []) {(int64_t) 1}, (int64_t []) {b_82727});
                
                int64_t lifted_lambda_res_162259 = sub64(write_iv_171026, inf_154507);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154513)) {
                    ((int16_t *) mem_171320)[lifted_lambda_res_162259] = write_iv_171027;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162259) && slt64(lifted_lambda_res_162259, j_m_i_154513)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_82727 - (int64_t) 1, b_82727))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171318, lifted_lambda_res_162259 * b_82727, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171328, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_82727});
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171307.mem, inf_154507, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171320, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154513});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171309.mem, b_82727 * inf_154507, (int64_t []) {b_82727, (int64_t) 1}, (uint8_t *) mem_171318, (int64_t) 0, (int64_t []) {b_82727, (int64_t) 1}, (int64_t []) {j_m_i_154513, b_82727});
        }
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_171960, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171284, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171349, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171348, &mem_param_171284, "mem_param_171284") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171351, bytes_171350, "mem_171351")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_171351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171349.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_82726});
    if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171353, bytes_171352, "mem_171353")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171353.mem, (int64_t) 0, (int64_t []) {b_82727, (int64_t) 1}, (uint8_t *) ext_mem_171348.mem, (int64_t) 0, (int64_t []) {b_82727, (int64_t) 1}, (int64_t []) {n_82726, b_82727});
    if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171351, "mem_171351") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171353, "mem_171353") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172547, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172548, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171285);
        free(mem_171318);
        free(mem_171320);
        free(mem_171328);
        if (memblock_unref(ctx, &mem_171353, "mem_171353") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171351, "mem_171351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171960, "mem_param_tmp_171960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171309, "mem_171309") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171965, "mem_param_tmp_171965") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171284, "mem_param_171284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171348, "ext_mem_171348") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171349, "ext_mem_171349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172553, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, int64_t nz2080U_149025, int64_t group_no_149026)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    bool bounds_invalid_upwards_161778 = slt64(group_no_149026, (int64_t) 0);
    bool valid_161779 = !bounds_invalid_upwards_161778;
    bool range_valid_c_161780;
    
    if (!valid_161779) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149026, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:41-43\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:322:23-50\n   #4  ftRelational.fut:322:5-50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171276 = (int64_t) 2 * group_no_149026;
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149026; nest_i_171957++) {
        ((int16_t *) mem_171277.mem)[nest_i_171957] = (int16_t) 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149025; iter_171001++) {
        int64_t pixel_171003 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        int16_t pixel_171004 = ((int16_t *) eta_p_mem_171275.mem)[iter_171001];
        bool less_than_zzero_171005 = slt64(pixel_171003, (int64_t) 0);
        bool greater_than_sizze_171006 = sle64(group_no_149026, pixel_171003);
        bool outside_bounds_dim_171007 = less_than_zzero_171005 || greater_than_sizze_171006;
        
        if (!outside_bounds_dim_171007) {
            int16_t read_hist_171009 = ((int16_t *) mem_171277.mem)[pixel_171003];
            int16_t zp_res_161785 = add16(pixel_171004, read_hist_171009);
            
            ((int16_t *) mem_171277.mem)[pixel_171003] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171277, "mem_171277") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172553, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172554, struct memblock eta_p_mem_171274, struct memblock eta_p_mem_171275, struct memblock eta_p_mem_171276, int64_t nz2080U_149102, int64_t group_no_149103)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171278;
    
    mem_171278.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171277 = (int64_t) 2 * group_no_149103;
    
    if (memblock_alloc(ctx, &mem_171278, bytes_171277, "mem_171278")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171957 = 0; nest_i_171957 < group_no_149103; nest_i_171957++) {
        ((int16_t *) mem_171278.mem)[nest_i_171957] = (int16_t) 0;
    }
    for (int64_t iter_171001 = 0; iter_171001 < nz2080U_149102; iter_171001++) {
        int16_t pixel_171003 = ((int16_t *) eta_p_mem_171275.mem)[iter_171001];
        int16_t pixel_171004 = ((int16_t *) eta_p_mem_171276.mem)[iter_171001];
        int64_t pixel_171005 = ((int64_t *) eta_p_mem_171274.mem)[iter_171001];
        int16_t zt_res_161974 = mul16(pixel_171003, pixel_171004);
        bool less_than_zzero_171006 = slt64(pixel_171005, (int64_t) 0);
        bool greater_than_sizze_171007 = sle64(group_no_149103, pixel_171005);
        bool outside_bounds_dim_171008 = less_than_zzero_171006 || greater_than_sizze_171007;
        
        if (!outside_bounds_dim_171008) {
            int16_t read_hist_171010 = ((int16_t *) mem_171278.mem)[pixel_171005];
            int16_t zp_res_161785 = add16(zt_res_161974, read_hist_171010);
            
            ((int16_t *) mem_171278.mem)[pixel_171005] = zp_res_161785;
        }
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171278, "mem_171278") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172554, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171278, "mem_171278") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_172555, struct memblock *mem_out_p_172556, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_147112, int64_t dz2081U_147113)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171282;
    
    mem_171282.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171291;
    
    ext_mem_171291.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * dz2080U_147112;
    double i64_res_152983 = sitofp_i64_f64(dz2081U_147113);
    double log2_res_152984 = futrts_log2_64(i64_res_152983);
    double ceil_res_152985 = futrts_ceil64(log2_res_152984);
    int64_t f64_res_152986 = fptosi_f64_i64(ceil_res_152985);
    int64_t num_iter_152987 = add64((int64_t) 1, f64_res_152986);
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < dz2080U_147112; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_152989 = sub64(dz2081U_147113, (int64_t) 1);
    int64_t bsearch_first_152991;
    int64_t last_step_152994;
    
    if (memblock_set(ctx, &mem_param_171280, &mem_171277, "mem_171277") != 0)
        return 1;
    last_step_152994 = dz2081U_147113;
    for (int64_t i_152992 = 0; i_152992 < num_iter_152987; i_152992++) {
        int64_t zs_lhs_152995 = add64((int64_t) 1, last_step_152994);
        int64_t this_step_152996 = sdiv64(zs_lhs_152995, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171282, bytes_171276, "mem_171282")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < dz2080U_147112; i_171003++) {
            int64_t eta_p_161973 = ((int64_t *) mem_param_171280.mem)[i_171003];
            double eta_p_161974 = ((double *) k_ids_mem_171274.mem)[i_171003];
            bool cond_161976 = sle64(eta_p_161973, (int64_t) 0);
            double prev_elem_161977;
            
            if (cond_161976) {
                bool y_162166 = slt64((int64_t) 0, dz2081U_147113);
                bool index_certs_162167;
                
                if (!y_162166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:55:70-82\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double prev_elem_t_res_162168 = ((double *) ks_mem_171275.mem)[(int64_t) 0];
                
                prev_elem_161977 = prev_elem_t_res_162168;
            } else {
                int64_t tmp_161981 = sub64(eta_p_161973, (int64_t) 1);
                bool x_161982 = sle64((int64_t) 0, tmp_161981);
                bool y_161983 = slt64(tmp_161981, dz2081U_147113);
                bool bounds_check_161984 = x_161982 && y_161983;
                bool index_certs_161985;
                
                if (!bounds_check_161984) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161981, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:55:88-102\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double prev_elem_f_res_161986 = ((double *) ks_mem_171275.mem)[tmp_161981];
                
                prev_elem_161977 = prev_elem_f_res_161986;
            }
            
            bool cond_161987 = slt64(eta_p_161973, (int64_t) 0);
            double cur_elem_161988;
            
            if (cond_161987) {
                bool y_162169 = slt64((int64_t) 0, dz2081U_147113);
                bool index_certs_162170;
                
                if (!y_162169) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:56:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_t_res_162171 = ((double *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_161988 = cur_elem_t_res_162171;
            } else {
                bool x_161992 = sle64((int64_t) 0, eta_p_161973);
                bool y_161993 = slt64(eta_p_161973, dz2081U_147113);
                bool bounds_check_161994 = x_161992 && y_161993;
                bool index_certs_161995;
                
                if (!bounds_check_161994) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161973, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:56:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_f_res_161996 = ((double *) ks_mem_171275.mem)[eta_p_161973];
                
                cur_elem_161988 = cur_elem_f_res_161996;
            }
            
            bool cond_161997 = sle64(zgze_rhs_152989, eta_p_161973);
            double next_elem_161998;
            
            if (cond_161997) {
                bool x_162173 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162174 = slt64(zgze_rhs_152989, dz2081U_147113);
                bool bounds_check_162175 = x_162173 && y_162174;
                bool index_certs_162176;
                
                if (!bounds_check_162175) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:57:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_t_res_162177 = ((double *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_161998 = next_elem_t_res_162177;
            } else {
                int64_t tmp_162005 = add64((int64_t) 1, eta_p_161973);
                bool x_162006 = sle64((int64_t) 0, tmp_162005);
                bool y_162007 = slt64(tmp_162005, dz2081U_147113);
                bool bounds_check_162008 = x_162006 && y_162007;
                bool index_certs_162009;
                
                if (!bounds_check_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162005, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:57:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_f_res_162010 = ((double *) ks_mem_171275.mem)[tmp_162005];
                
                next_elem_161998 = next_elem_f_res_162010;
            }
            
            int64_t defunc_0_f_res_162015;
            
            if (cond_161987) {
                defunc_0_f_res_162015 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162016 = eta_p_161974 == cur_elem_161988;
                bool cond_162017 = eta_p_161973 == (int64_t) 0;
                bool defunc_0_gt_res_162018 = prev_elem_161977 < eta_p_161974;
                bool x_162019 = !cond_162017;
                bool y_162020 = defunc_0_gt_res_162018 && x_162019;
                bool cond_t_res_162021 = cond_162017 || y_162020;
                bool x_162022 = defunc_0_eq_res_162016 && cond_t_res_162021;
                int64_t defunc_0_f_res_f_res_162023;
                
                if (x_162022) {
                    defunc_0_f_res_f_res_162023 = eta_p_161973;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162024;
                    
                    if (defunc_0_eq_res_162016) {
                        int64_t max_arg1_162178 = sub64(eta_p_161973, this_step_152996);
                        int64_t max_res_162179 = smax64((int64_t) 0, max_arg1_162178);
                        
                        defunc_0_f_res_f_res_f_res_162024 = max_res_162179;
                    } else {
                        bool defunc_0_gt_res_162027 = cur_elem_161988 < eta_p_161974;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162028;
                        
                        if (defunc_0_gt_res_162027) {
                            bool cond_162181 = eta_p_161973 == zgze_rhs_152989;
                            bool defunc_0_gt_res_162182 = eta_p_161974 < next_elem_161998;
                            bool x_162183 = !cond_162181;
                            bool y_162184 = defunc_0_gt_res_162182 && x_162183;
                            bool cond_162185 = cond_162181 || y_162184;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                            
                            if (cond_162185) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162187 = add64(this_step_152996, eta_p_161973);
                                int64_t min_res_162188 = smin64(zgze_rhs_152989, min_arg1_162187);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = min_res_162188;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                            
                            if (cond_t_res_162021) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162039 = sub64(eta_p_161973, this_step_152996);
                                int64_t max_res_162040 = smax64((int64_t) 0, max_arg1_162039);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = max_res_162040;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                        }
                        defunc_0_f_res_f_res_f_res_162024 = defunc_0_f_res_f_res_f_res_f_res_162028;
                    }
                    defunc_0_f_res_f_res_162023 = defunc_0_f_res_f_res_f_res_162024;
                }
                defunc_0_f_res_162015 = defunc_0_f_res_f_res_162023;
            }
            ((int64_t *) mem_171282.mem)[i_171003] = defunc_0_f_res_162015;
        }
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171282, "mem_171282") != 0)
            return 1;
        
        int64_t last_step_tmp_171961 = this_step_152996;
        
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        last_step_152994 = last_step_tmp_171961;
    }
    if (memblock_set(ctx, &ext_mem_171291, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    bsearch_first_152991 = last_step_152994;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    
    int64_t bsearch_last_153070;
    int64_t last_step_153073;
    
    if (memblock_set(ctx, &mem_param_171294, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    last_step_153073 = dz2081U_147113;
    for (int64_t i_153071 = 0; i_153071 < num_iter_152987; i_153071++) {
        int64_t zs_lhs_153074 = add64((int64_t) 1, last_step_153073);
        int64_t max_arg1_153075 = sdiv64(zs_lhs_153074, (int64_t) 2);
        int64_t max_res_153076 = smax64((int64_t) 1, max_arg1_153075);
        
        if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171007 = 0; i_171007 < dz2080U_147112; i_171007++) {
            int64_t eta_p_162090 = ((int64_t *) mem_param_171294.mem)[i_171007];
            double eta_p_162091 = ((double *) k_ids_mem_171274.mem)[i_171007];
            bool cond_162093 = slt64(eta_p_162090, (int64_t) 0);
            double cur_elem_162094;
            
            if (cond_162093) {
                bool y_162190 = slt64((int64_t) 0, dz2081U_147113);
                bool index_certs_162191;
                
                if (!y_162190) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:81:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_t_res_162192 = ((double *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_162094 = cur_elem_t_res_162192;
            } else {
                bool x_162098 = sle64((int64_t) 0, eta_p_162090);
                bool y_162099 = slt64(eta_p_162090, dz2081U_147113);
                bool bounds_check_162100 = x_162098 && y_162099;
                bool index_certs_162101;
                
                if (!bounds_check_162100) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162090, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:81:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_f_res_162102 = ((double *) ks_mem_171275.mem)[eta_p_162090];
                
                cur_elem_162094 = cur_elem_f_res_162102;
            }
            
            bool cond_162103 = sle64(zgze_rhs_152989, eta_p_162090);
            double next_elem_162104;
            
            if (cond_162103) {
                bool x_162194 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162195 = slt64(zgze_rhs_152989, dz2081U_147113);
                bool bounds_check_162196 = x_162194 && y_162195;
                bool index_certs_162197;
                
                if (!bounds_check_162196) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:82:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_t_res_162198 = ((double *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_162104 = next_elem_t_res_162198;
            } else {
                int64_t tmp_162111 = add64((int64_t) 1, eta_p_162090);
                bool x_162112 = sle64((int64_t) 0, tmp_162111);
                bool y_162113 = slt64(tmp_162111, dz2081U_147113);
                bool bounds_check_162114 = x_162112 && y_162113;
                bool index_certs_162115;
                
                if (!bounds_check_162114) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162111, "] out of bounds for array of shape [", (long long) dz2081U_147113, "].", "-> #0  ft_SortGroupBy.fut:82:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:296:73-76\n   #4  ftRelational.fut:294:5-297:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_f_res_162116 = ((double *) ks_mem_171275.mem)[tmp_162111];
                
                next_elem_162104 = next_elem_f_res_162116;
            }
            
            int64_t defunc_0_f_res_162120;
            
            if (cond_162093) {
                defunc_0_f_res_162120 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162121 = eta_p_162091 == cur_elem_162094;
                bool cond_162123 = eta_p_162090 == zgze_rhs_152989;
                bool defunc_0_gt_res_162124 = eta_p_162091 < next_elem_162104;
                bool x_162125 = !cond_162123;
                bool y_162126 = defunc_0_gt_res_162124 && x_162125;
                bool cond_t_res_162127 = cond_162123 || y_162126;
                bool x_162128 = defunc_0_eq_res_162121 && cond_t_res_162127;
                int64_t defunc_0_f_res_f_res_162129;
                
                if (x_162128) {
                    defunc_0_f_res_f_res_162129 = eta_p_162090;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162130;
                    
                    if (defunc_0_eq_res_162121) {
                        int64_t min_arg1_162199 = add64(max_res_153076, eta_p_162090);
                        int64_t min_res_162200 = smin64(zgze_rhs_152989, min_arg1_162199);
                        
                        defunc_0_f_res_f_res_f_res_162130 = min_res_162200;
                    } else {
                        bool defunc_0_gt_res_162133 = cur_elem_162094 < eta_p_162091;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162134;
                        
                        if (defunc_0_gt_res_162133) {
                            int64_t min_arg1_162201 = add64(max_res_153076, eta_p_162090);
                            int64_t min_res_162202 = smin64(zgze_rhs_152989, min_arg1_162201);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = min_res_162202;
                        } else {
                            int64_t max_arg1_162137 = sub64(eta_p_162090, max_res_153076);
                            int64_t max_res_162138 = smax64((int64_t) 0, max_arg1_162137);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = max_res_162138;
                        }
                        defunc_0_f_res_f_res_f_res_162130 = defunc_0_f_res_f_res_f_res_f_res_162134;
                    }
                    defunc_0_f_res_f_res_162129 = defunc_0_f_res_f_res_f_res_162130;
                }
                defunc_0_f_res_162120 = defunc_0_f_res_f_res_162129;
            }
            ((int64_t *) mem_171296.mem)[i_171007] = defunc_0_f_res_162120;
        }
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171296, "mem_171296") != 0)
            return 1;
        
        int64_t last_step_tmp_171965 = max_res_153076;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        last_step_153073 = last_step_tmp_171965;
    }
    if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
        return 1;
    bsearch_last_153070 = last_step_153073;
    if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < dz2080U_147112; i_171011++) {
        int64_t eta_p_153130 = ((int64_t *) ext_mem_171291.mem)[i_171011];
        int64_t eta_p_153131 = ((int64_t *) ext_mem_171305.mem)[i_171011];
        bool cond_153132 = slt64(eta_p_153130, (int64_t) 0);
        int64_t lifted_lambda_res_153133;
        
        if (cond_153132) {
            lifted_lambda_res_153133 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153134 = sub64(eta_p_153131, eta_p_153130);
            int64_t lifted_lambda_res_f_res_153135 = add64((int64_t) 1, zp_lhs_153134);
            
            lifted_lambda_res_153133 = lifted_lambda_res_f_res_153135;
        }
        ((int64_t *) mem_171307.mem)[i_171011] = lifted_lambda_res_153133;
    }
    if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171307, "mem_171307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172555, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172556, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171282, "mem_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171291, "ext_mem_171291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_172557, struct memblock *mem_out_p_172558, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_146322, int64_t dz2081U_146323)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171282;
    
    mem_171282.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171291;
    
    ext_mem_171291.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * dz2080U_146322;
    double i64_res_152983 = sitofp_i64_f64(dz2081U_146323);
    double log2_res_152984 = futrts_log2_64(i64_res_152983);
    double ceil_res_152985 = futrts_ceil64(log2_res_152984);
    int64_t f64_res_152986 = fptosi_f64_i64(ceil_res_152985);
    int64_t num_iter_152987 = add64((int64_t) 1, f64_res_152986);
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < dz2080U_146322; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_152989 = sub64(dz2081U_146323, (int64_t) 1);
    int64_t bsearch_first_152991;
    int64_t last_step_152994;
    
    if (memblock_set(ctx, &mem_param_171280, &mem_171277, "mem_171277") != 0)
        return 1;
    last_step_152994 = dz2081U_146323;
    for (int64_t i_152992 = 0; i_152992 < num_iter_152987; i_152992++) {
        int64_t zs_lhs_152995 = add64((int64_t) 1, last_step_152994);
        int64_t this_step_152996 = sdiv64(zs_lhs_152995, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171282, bytes_171276, "mem_171282")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < dz2080U_146322; i_171003++) {
            int64_t eta_p_161973 = ((int64_t *) mem_param_171280.mem)[i_171003];
            float eta_p_161974 = ((float *) k_ids_mem_171274.mem)[i_171003];
            bool cond_161976 = sle64(eta_p_161973, (int64_t) 0);
            float prev_elem_161977;
            
            if (cond_161976) {
                bool y_162166 = slt64((int64_t) 0, dz2081U_146323);
                bool index_certs_162167;
                
                if (!y_162166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:55:70-82\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float prev_elem_t_res_162168 = ((float *) ks_mem_171275.mem)[(int64_t) 0];
                
                prev_elem_161977 = prev_elem_t_res_162168;
            } else {
                int64_t tmp_161981 = sub64(eta_p_161973, (int64_t) 1);
                bool x_161982 = sle64((int64_t) 0, tmp_161981);
                bool y_161983 = slt64(tmp_161981, dz2081U_146323);
                bool bounds_check_161984 = x_161982 && y_161983;
                bool index_certs_161985;
                
                if (!bounds_check_161984) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161981, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:55:88-102\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float prev_elem_f_res_161986 = ((float *) ks_mem_171275.mem)[tmp_161981];
                
                prev_elem_161977 = prev_elem_f_res_161986;
            }
            
            bool cond_161987 = slt64(eta_p_161973, (int64_t) 0);
            float cur_elem_161988;
            
            if (cond_161987) {
                bool y_162169 = slt64((int64_t) 0, dz2081U_146323);
                bool index_certs_162170;
                
                if (!y_162169) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:56:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_t_res_162171 = ((float *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_161988 = cur_elem_t_res_162171;
            } else {
                bool x_161992 = sle64((int64_t) 0, eta_p_161973);
                bool y_161993 = slt64(eta_p_161973, dz2081U_146323);
                bool bounds_check_161994 = x_161992 && y_161993;
                bool index_certs_161995;
                
                if (!bounds_check_161994) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161973, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:56:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_f_res_161996 = ((float *) ks_mem_171275.mem)[eta_p_161973];
                
                cur_elem_161988 = cur_elem_f_res_161996;
            }
            
            bool cond_161997 = sle64(zgze_rhs_152989, eta_p_161973);
            float next_elem_161998;
            
            if (cond_161997) {
                bool x_162173 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162174 = slt64(zgze_rhs_152989, dz2081U_146323);
                bool bounds_check_162175 = x_162173 && y_162174;
                bool index_certs_162176;
                
                if (!bounds_check_162175) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:57:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_t_res_162177 = ((float *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_161998 = next_elem_t_res_162177;
            } else {
                int64_t tmp_162005 = add64((int64_t) 1, eta_p_161973);
                bool x_162006 = sle64((int64_t) 0, tmp_162005);
                bool y_162007 = slt64(tmp_162005, dz2081U_146323);
                bool bounds_check_162008 = x_162006 && y_162007;
                bool index_certs_162009;
                
                if (!bounds_check_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162005, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:57:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_f_res_162010 = ((float *) ks_mem_171275.mem)[tmp_162005];
                
                next_elem_161998 = next_elem_f_res_162010;
            }
            
            int64_t defunc_0_f_res_162015;
            
            if (cond_161987) {
                defunc_0_f_res_162015 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162016 = eta_p_161974 == cur_elem_161988;
                bool cond_162017 = eta_p_161973 == (int64_t) 0;
                bool defunc_0_gt_res_162018 = prev_elem_161977 < eta_p_161974;
                bool x_162019 = !cond_162017;
                bool y_162020 = defunc_0_gt_res_162018 && x_162019;
                bool cond_t_res_162021 = cond_162017 || y_162020;
                bool x_162022 = defunc_0_eq_res_162016 && cond_t_res_162021;
                int64_t defunc_0_f_res_f_res_162023;
                
                if (x_162022) {
                    defunc_0_f_res_f_res_162023 = eta_p_161973;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162024;
                    
                    if (defunc_0_eq_res_162016) {
                        int64_t max_arg1_162178 = sub64(eta_p_161973, this_step_152996);
                        int64_t max_res_162179 = smax64((int64_t) 0, max_arg1_162178);
                        
                        defunc_0_f_res_f_res_f_res_162024 = max_res_162179;
                    } else {
                        bool defunc_0_gt_res_162027 = cur_elem_161988 < eta_p_161974;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162028;
                        
                        if (defunc_0_gt_res_162027) {
                            bool cond_162181 = eta_p_161973 == zgze_rhs_152989;
                            bool defunc_0_gt_res_162182 = eta_p_161974 < next_elem_161998;
                            bool x_162183 = !cond_162181;
                            bool y_162184 = defunc_0_gt_res_162182 && x_162183;
                            bool cond_162185 = cond_162181 || y_162184;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                            
                            if (cond_162185) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162187 = add64(this_step_152996, eta_p_161973);
                                int64_t min_res_162188 = smin64(zgze_rhs_152989, min_arg1_162187);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = min_res_162188;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                            
                            if (cond_t_res_162021) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162039 = sub64(eta_p_161973, this_step_152996);
                                int64_t max_res_162040 = smax64((int64_t) 0, max_arg1_162039);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = max_res_162040;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                        }
                        defunc_0_f_res_f_res_f_res_162024 = defunc_0_f_res_f_res_f_res_f_res_162028;
                    }
                    defunc_0_f_res_f_res_162023 = defunc_0_f_res_f_res_f_res_162024;
                }
                defunc_0_f_res_162015 = defunc_0_f_res_f_res_162023;
            }
            ((int64_t *) mem_171282.mem)[i_171003] = defunc_0_f_res_162015;
        }
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171282, "mem_171282") != 0)
            return 1;
        
        int64_t last_step_tmp_171961 = this_step_152996;
        
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        last_step_152994 = last_step_tmp_171961;
    }
    if (memblock_set(ctx, &ext_mem_171291, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    bsearch_first_152991 = last_step_152994;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    
    int64_t bsearch_last_153070;
    int64_t last_step_153073;
    
    if (memblock_set(ctx, &mem_param_171294, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    last_step_153073 = dz2081U_146323;
    for (int64_t i_153071 = 0; i_153071 < num_iter_152987; i_153071++) {
        int64_t zs_lhs_153074 = add64((int64_t) 1, last_step_153073);
        int64_t max_arg1_153075 = sdiv64(zs_lhs_153074, (int64_t) 2);
        int64_t max_res_153076 = smax64((int64_t) 1, max_arg1_153075);
        
        if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171007 = 0; i_171007 < dz2080U_146322; i_171007++) {
            int64_t eta_p_162090 = ((int64_t *) mem_param_171294.mem)[i_171007];
            float eta_p_162091 = ((float *) k_ids_mem_171274.mem)[i_171007];
            bool cond_162093 = slt64(eta_p_162090, (int64_t) 0);
            float cur_elem_162094;
            
            if (cond_162093) {
                bool y_162190 = slt64((int64_t) 0, dz2081U_146323);
                bool index_certs_162191;
                
                if (!y_162190) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:81:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_t_res_162192 = ((float *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_162094 = cur_elem_t_res_162192;
            } else {
                bool x_162098 = sle64((int64_t) 0, eta_p_162090);
                bool y_162099 = slt64(eta_p_162090, dz2081U_146323);
                bool bounds_check_162100 = x_162098 && y_162099;
                bool index_certs_162101;
                
                if (!bounds_check_162100) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162090, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:81:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_f_res_162102 = ((float *) ks_mem_171275.mem)[eta_p_162090];
                
                cur_elem_162094 = cur_elem_f_res_162102;
            }
            
            bool cond_162103 = sle64(zgze_rhs_152989, eta_p_162090);
            float next_elem_162104;
            
            if (cond_162103) {
                bool x_162194 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162195 = slt64(zgze_rhs_152989, dz2081U_146323);
                bool bounds_check_162196 = x_162194 && y_162195;
                bool index_certs_162197;
                
                if (!bounds_check_162196) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:82:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_t_res_162198 = ((float *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_162104 = next_elem_t_res_162198;
            } else {
                int64_t tmp_162111 = add64((int64_t) 1, eta_p_162090);
                bool x_162112 = sle64((int64_t) 0, tmp_162111);
                bool y_162113 = slt64(tmp_162111, dz2081U_146323);
                bool bounds_check_162114 = x_162112 && y_162113;
                bool index_certs_162115;
                
                if (!bounds_check_162114) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162111, "] out of bounds for array of shape [", (long long) dz2081U_146323, "].", "-> #0  ft_SortGroupBy.fut:82:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:292:73-76\n   #4  ftRelational.fut:290:5-293:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_f_res_162116 = ((float *) ks_mem_171275.mem)[tmp_162111];
                
                next_elem_162104 = next_elem_f_res_162116;
            }
            
            int64_t defunc_0_f_res_162120;
            
            if (cond_162093) {
                defunc_0_f_res_162120 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162121 = eta_p_162091 == cur_elem_162094;
                bool cond_162123 = eta_p_162090 == zgze_rhs_152989;
                bool defunc_0_gt_res_162124 = eta_p_162091 < next_elem_162104;
                bool x_162125 = !cond_162123;
                bool y_162126 = defunc_0_gt_res_162124 && x_162125;
                bool cond_t_res_162127 = cond_162123 || y_162126;
                bool x_162128 = defunc_0_eq_res_162121 && cond_t_res_162127;
                int64_t defunc_0_f_res_f_res_162129;
                
                if (x_162128) {
                    defunc_0_f_res_f_res_162129 = eta_p_162090;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162130;
                    
                    if (defunc_0_eq_res_162121) {
                        int64_t min_arg1_162199 = add64(max_res_153076, eta_p_162090);
                        int64_t min_res_162200 = smin64(zgze_rhs_152989, min_arg1_162199);
                        
                        defunc_0_f_res_f_res_f_res_162130 = min_res_162200;
                    } else {
                        bool defunc_0_gt_res_162133 = cur_elem_162094 < eta_p_162091;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162134;
                        
                        if (defunc_0_gt_res_162133) {
                            int64_t min_arg1_162201 = add64(max_res_153076, eta_p_162090);
                            int64_t min_res_162202 = smin64(zgze_rhs_152989, min_arg1_162201);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = min_res_162202;
                        } else {
                            int64_t max_arg1_162137 = sub64(eta_p_162090, max_res_153076);
                            int64_t max_res_162138 = smax64((int64_t) 0, max_arg1_162137);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = max_res_162138;
                        }
                        defunc_0_f_res_f_res_f_res_162130 = defunc_0_f_res_f_res_f_res_f_res_162134;
                    }
                    defunc_0_f_res_f_res_162129 = defunc_0_f_res_f_res_f_res_162130;
                }
                defunc_0_f_res_162120 = defunc_0_f_res_f_res_162129;
            }
            ((int64_t *) mem_171296.mem)[i_171007] = defunc_0_f_res_162120;
        }
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171296, "mem_171296") != 0)
            return 1;
        
        int64_t last_step_tmp_171965 = max_res_153076;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        last_step_153073 = last_step_tmp_171965;
    }
    if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
        return 1;
    bsearch_last_153070 = last_step_153073;
    if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < dz2080U_146322; i_171011++) {
        int64_t eta_p_153130 = ((int64_t *) ext_mem_171291.mem)[i_171011];
        int64_t eta_p_153131 = ((int64_t *) ext_mem_171305.mem)[i_171011];
        bool cond_153132 = slt64(eta_p_153130, (int64_t) 0);
        int64_t lifted_lambda_res_153133;
        
        if (cond_153132) {
            lifted_lambda_res_153133 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153134 = sub64(eta_p_153131, eta_p_153130);
            int64_t lifted_lambda_res_f_res_153135 = add64((int64_t) 1, zp_lhs_153134);
            
            lifted_lambda_res_153133 = lifted_lambda_res_f_res_153135;
        }
        ((int64_t *) mem_171307.mem)[i_171011] = lifted_lambda_res_153133;
    }
    if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171307, "mem_171307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172557, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172558, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171282, "mem_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171291, "ext_mem_171291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_172559, struct memblock *mem_out_p_172560, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_144742, int64_t dz2081U_144743)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171282;
    
    mem_171282.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171291;
    
    ext_mem_171291.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * dz2080U_144742;
    double i64_res_152983 = sitofp_i64_f64(dz2081U_144743);
    double log2_res_152984 = futrts_log2_64(i64_res_152983);
    double ceil_res_152985 = futrts_ceil64(log2_res_152984);
    int64_t f64_res_152986 = fptosi_f64_i64(ceil_res_152985);
    int64_t num_iter_152987 = add64((int64_t) 1, f64_res_152986);
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < dz2080U_144742; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_152989 = sub64(dz2081U_144743, (int64_t) 1);
    int64_t bsearch_first_152991;
    int64_t last_step_152994;
    
    if (memblock_set(ctx, &mem_param_171280, &mem_171277, "mem_171277") != 0)
        return 1;
    last_step_152994 = dz2081U_144743;
    for (int64_t i_152992 = 0; i_152992 < num_iter_152987; i_152992++) {
        int64_t zs_lhs_152995 = add64((int64_t) 1, last_step_152994);
        int64_t this_step_152996 = sdiv64(zs_lhs_152995, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171282, bytes_171276, "mem_171282")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < dz2080U_144742; i_171003++) {
            int64_t eta_p_161973 = ((int64_t *) mem_param_171280.mem)[i_171003];
            int32_t eta_p_161974 = ((int32_t *) k_ids_mem_171274.mem)[i_171003];
            bool cond_161976 = sle64(eta_p_161973, (int64_t) 0);
            int32_t prev_elem_161977;
            
            if (cond_161976) {
                bool y_162166 = slt64((int64_t) 0, dz2081U_144743);
                bool index_certs_162167;
                
                if (!y_162166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:55:70-82\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t prev_elem_t_res_162168 = ((int32_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                prev_elem_161977 = prev_elem_t_res_162168;
            } else {
                int64_t tmp_161981 = sub64(eta_p_161973, (int64_t) 1);
                bool x_161982 = sle64((int64_t) 0, tmp_161981);
                bool y_161983 = slt64(tmp_161981, dz2081U_144743);
                bool bounds_check_161984 = x_161982 && y_161983;
                bool index_certs_161985;
                
                if (!bounds_check_161984) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161981, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:55:88-102\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t prev_elem_f_res_161986 = ((int32_t *) ks_mem_171275.mem)[tmp_161981];
                
                prev_elem_161977 = prev_elem_f_res_161986;
            }
            
            bool cond_161987 = slt64(eta_p_161973, (int64_t) 0);
            int32_t cur_elem_161988;
            
            if (cond_161987) {
                bool y_162169 = slt64((int64_t) 0, dz2081U_144743);
                bool index_certs_162170;
                
                if (!y_162169) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:56:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_t_res_162171 = ((int32_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_161988 = cur_elem_t_res_162171;
            } else {
                bool x_161992 = sle64((int64_t) 0, eta_p_161973);
                bool y_161993 = slt64(eta_p_161973, dz2081U_144743);
                bool bounds_check_161994 = x_161992 && y_161993;
                bool index_certs_161995;
                
                if (!bounds_check_161994) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161973, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:56:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_f_res_161996 = ((int32_t *) ks_mem_171275.mem)[eta_p_161973];
                
                cur_elem_161988 = cur_elem_f_res_161996;
            }
            
            bool cond_161997 = sle64(zgze_rhs_152989, eta_p_161973);
            int32_t next_elem_161998;
            
            if (cond_161997) {
                bool x_162173 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162174 = slt64(zgze_rhs_152989, dz2081U_144743);
                bool bounds_check_162175 = x_162173 && y_162174;
                bool index_certs_162176;
                
                if (!bounds_check_162175) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:57:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_t_res_162177 = ((int32_t *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_161998 = next_elem_t_res_162177;
            } else {
                int64_t tmp_162005 = add64((int64_t) 1, eta_p_161973);
                bool x_162006 = sle64((int64_t) 0, tmp_162005);
                bool y_162007 = slt64(tmp_162005, dz2081U_144743);
                bool bounds_check_162008 = x_162006 && y_162007;
                bool index_certs_162009;
                
                if (!bounds_check_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162005, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:57:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_f_res_162010 = ((int32_t *) ks_mem_171275.mem)[tmp_162005];
                
                next_elem_161998 = next_elem_f_res_162010;
            }
            
            int64_t defunc_0_f_res_162015;
            
            if (cond_161987) {
                defunc_0_f_res_162015 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162016 = eta_p_161974 == cur_elem_161988;
                bool cond_162017 = eta_p_161973 == (int64_t) 0;
                bool defunc_0_gt_res_162018 = slt32(prev_elem_161977, eta_p_161974);
                bool x_162019 = !cond_162017;
                bool y_162020 = defunc_0_gt_res_162018 && x_162019;
                bool cond_t_res_162021 = cond_162017 || y_162020;
                bool x_162022 = defunc_0_eq_res_162016 && cond_t_res_162021;
                int64_t defunc_0_f_res_f_res_162023;
                
                if (x_162022) {
                    defunc_0_f_res_f_res_162023 = eta_p_161973;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162024;
                    
                    if (defunc_0_eq_res_162016) {
                        int64_t max_arg1_162178 = sub64(eta_p_161973, this_step_152996);
                        int64_t max_res_162179 = smax64((int64_t) 0, max_arg1_162178);
                        
                        defunc_0_f_res_f_res_f_res_162024 = max_res_162179;
                    } else {
                        bool defunc_0_gt_res_162027 = slt32(cur_elem_161988, eta_p_161974);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162028;
                        
                        if (defunc_0_gt_res_162027) {
                            bool cond_162181 = eta_p_161973 == zgze_rhs_152989;
                            bool defunc_0_gt_res_162182 = slt32(eta_p_161974, next_elem_161998);
                            bool x_162183 = !cond_162181;
                            bool y_162184 = defunc_0_gt_res_162182 && x_162183;
                            bool cond_162185 = cond_162181 || y_162184;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                            
                            if (cond_162185) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162187 = add64(this_step_152996, eta_p_161973);
                                int64_t min_res_162188 = smin64(zgze_rhs_152989, min_arg1_162187);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = min_res_162188;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                            
                            if (cond_t_res_162021) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162039 = sub64(eta_p_161973, this_step_152996);
                                int64_t max_res_162040 = smax64((int64_t) 0, max_arg1_162039);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = max_res_162040;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                        }
                        defunc_0_f_res_f_res_f_res_162024 = defunc_0_f_res_f_res_f_res_f_res_162028;
                    }
                    defunc_0_f_res_f_res_162023 = defunc_0_f_res_f_res_f_res_162024;
                }
                defunc_0_f_res_162015 = defunc_0_f_res_f_res_162023;
            }
            ((int64_t *) mem_171282.mem)[i_171003] = defunc_0_f_res_162015;
        }
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171282, "mem_171282") != 0)
            return 1;
        
        int64_t last_step_tmp_171961 = this_step_152996;
        
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        last_step_152994 = last_step_tmp_171961;
    }
    if (memblock_set(ctx, &ext_mem_171291, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    bsearch_first_152991 = last_step_152994;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    
    int64_t bsearch_last_153070;
    int64_t last_step_153073;
    
    if (memblock_set(ctx, &mem_param_171294, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    last_step_153073 = dz2081U_144743;
    for (int64_t i_153071 = 0; i_153071 < num_iter_152987; i_153071++) {
        int64_t zs_lhs_153074 = add64((int64_t) 1, last_step_153073);
        int64_t max_arg1_153075 = sdiv64(zs_lhs_153074, (int64_t) 2);
        int64_t max_res_153076 = smax64((int64_t) 1, max_arg1_153075);
        
        if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171007 = 0; i_171007 < dz2080U_144742; i_171007++) {
            int64_t eta_p_162090 = ((int64_t *) mem_param_171294.mem)[i_171007];
            int32_t eta_p_162091 = ((int32_t *) k_ids_mem_171274.mem)[i_171007];
            bool cond_162093 = slt64(eta_p_162090, (int64_t) 0);
            int32_t cur_elem_162094;
            
            if (cond_162093) {
                bool y_162190 = slt64((int64_t) 0, dz2081U_144743);
                bool index_certs_162191;
                
                if (!y_162190) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:81:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_t_res_162192 = ((int32_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_162094 = cur_elem_t_res_162192;
            } else {
                bool x_162098 = sle64((int64_t) 0, eta_p_162090);
                bool y_162099 = slt64(eta_p_162090, dz2081U_144743);
                bool bounds_check_162100 = x_162098 && y_162099;
                bool index_certs_162101;
                
                if (!bounds_check_162100) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162090, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:81:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_f_res_162102 = ((int32_t *) ks_mem_171275.mem)[eta_p_162090];
                
                cur_elem_162094 = cur_elem_f_res_162102;
            }
            
            bool cond_162103 = sle64(zgze_rhs_152989, eta_p_162090);
            int32_t next_elem_162104;
            
            if (cond_162103) {
                bool x_162194 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162195 = slt64(zgze_rhs_152989, dz2081U_144743);
                bool bounds_check_162196 = x_162194 && y_162195;
                bool index_certs_162197;
                
                if (!bounds_check_162196) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:82:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_t_res_162198 = ((int32_t *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_162104 = next_elem_t_res_162198;
            } else {
                int64_t tmp_162111 = add64((int64_t) 1, eta_p_162090);
                bool x_162112 = sle64((int64_t) 0, tmp_162111);
                bool y_162113 = slt64(tmp_162111, dz2081U_144743);
                bool bounds_check_162114 = x_162112 && y_162113;
                bool index_certs_162115;
                
                if (!bounds_check_162114) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162111, "] out of bounds for array of shape [", (long long) dz2081U_144743, "].", "-> #0  ft_SortGroupBy.fut:82:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:284:73-76\n   #4  ftRelational.fut:282:5-285:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_f_res_162116 = ((int32_t *) ks_mem_171275.mem)[tmp_162111];
                
                next_elem_162104 = next_elem_f_res_162116;
            }
            
            int64_t defunc_0_f_res_162120;
            
            if (cond_162093) {
                defunc_0_f_res_162120 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162121 = eta_p_162091 == cur_elem_162094;
                bool cond_162123 = eta_p_162090 == zgze_rhs_152989;
                bool defunc_0_gt_res_162124 = slt32(eta_p_162091, next_elem_162104);
                bool x_162125 = !cond_162123;
                bool y_162126 = defunc_0_gt_res_162124 && x_162125;
                bool cond_t_res_162127 = cond_162123 || y_162126;
                bool x_162128 = defunc_0_eq_res_162121 && cond_t_res_162127;
                int64_t defunc_0_f_res_f_res_162129;
                
                if (x_162128) {
                    defunc_0_f_res_f_res_162129 = eta_p_162090;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162130;
                    
                    if (defunc_0_eq_res_162121) {
                        int64_t min_arg1_162199 = add64(max_res_153076, eta_p_162090);
                        int64_t min_res_162200 = smin64(zgze_rhs_152989, min_arg1_162199);
                        
                        defunc_0_f_res_f_res_f_res_162130 = min_res_162200;
                    } else {
                        bool defunc_0_gt_res_162133 = slt32(cur_elem_162094, eta_p_162091);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162134;
                        
                        if (defunc_0_gt_res_162133) {
                            int64_t min_arg1_162201 = add64(max_res_153076, eta_p_162090);
                            int64_t min_res_162202 = smin64(zgze_rhs_152989, min_arg1_162201);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = min_res_162202;
                        } else {
                            int64_t max_arg1_162137 = sub64(eta_p_162090, max_res_153076);
                            int64_t max_res_162138 = smax64((int64_t) 0, max_arg1_162137);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = max_res_162138;
                        }
                        defunc_0_f_res_f_res_f_res_162130 = defunc_0_f_res_f_res_f_res_f_res_162134;
                    }
                    defunc_0_f_res_f_res_162129 = defunc_0_f_res_f_res_f_res_162130;
                }
                defunc_0_f_res_162120 = defunc_0_f_res_f_res_162129;
            }
            ((int64_t *) mem_171296.mem)[i_171007] = defunc_0_f_res_162120;
        }
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171296, "mem_171296") != 0)
            return 1;
        
        int64_t last_step_tmp_171965 = max_res_153076;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        last_step_153073 = last_step_tmp_171965;
    }
    if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
        return 1;
    bsearch_last_153070 = last_step_153073;
    if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < dz2080U_144742; i_171011++) {
        int64_t eta_p_153130 = ((int64_t *) ext_mem_171291.mem)[i_171011];
        int64_t eta_p_153131 = ((int64_t *) ext_mem_171305.mem)[i_171011];
        bool cond_153132 = slt64(eta_p_153130, (int64_t) 0);
        int64_t lifted_lambda_res_153133;
        
        if (cond_153132) {
            lifted_lambda_res_153133 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153134 = sub64(eta_p_153131, eta_p_153130);
            int64_t lifted_lambda_res_f_res_153135 = add64((int64_t) 1, zp_lhs_153134);
            
            lifted_lambda_res_153133 = lifted_lambda_res_f_res_153135;
        }
        ((int64_t *) mem_171307.mem)[i_171011] = lifted_lambda_res_153133;
    }
    if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171307, "mem_171307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172559, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172560, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171282, "mem_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171291, "ext_mem_171291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172561, struct memblock *mem_out_p_172562, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_145532, int64_t dz2081U_145533)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171282;
    
    mem_171282.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171291;
    
    ext_mem_171291.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * dz2080U_145532;
    double i64_res_152983 = sitofp_i64_f64(dz2081U_145533);
    double log2_res_152984 = futrts_log2_64(i64_res_152983);
    double ceil_res_152985 = futrts_ceil64(log2_res_152984);
    int64_t f64_res_152986 = fptosi_f64_i64(ceil_res_152985);
    int64_t num_iter_152987 = add64((int64_t) 1, f64_res_152986);
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < dz2080U_145532; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_152989 = sub64(dz2081U_145533, (int64_t) 1);
    int64_t bsearch_first_152991;
    int64_t last_step_152994;
    
    if (memblock_set(ctx, &mem_param_171280, &mem_171277, "mem_171277") != 0)
        return 1;
    last_step_152994 = dz2081U_145533;
    for (int64_t i_152992 = 0; i_152992 < num_iter_152987; i_152992++) {
        int64_t zs_lhs_152995 = add64((int64_t) 1, last_step_152994);
        int64_t this_step_152996 = sdiv64(zs_lhs_152995, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171282, bytes_171276, "mem_171282")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < dz2080U_145532; i_171003++) {
            int64_t eta_p_161973 = ((int64_t *) mem_param_171280.mem)[i_171003];
            int64_t eta_p_161974 = ((int64_t *) k_ids_mem_171274.mem)[i_171003];
            bool cond_161976 = sle64(eta_p_161973, (int64_t) 0);
            int64_t prev_elem_161977;
            
            if (cond_161976) {
                bool y_162166 = slt64((int64_t) 0, dz2081U_145533);
                bool index_certs_162167;
                
                if (!y_162166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:55:70-82\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t prev_elem_t_res_162168 = ((int64_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                prev_elem_161977 = prev_elem_t_res_162168;
            } else {
                int64_t tmp_161981 = sub64(eta_p_161973, (int64_t) 1);
                bool x_161982 = sle64((int64_t) 0, tmp_161981);
                bool y_161983 = slt64(tmp_161981, dz2081U_145533);
                bool bounds_check_161984 = x_161982 && y_161983;
                bool index_certs_161985;
                
                if (!bounds_check_161984) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161981, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:55:88-102\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t prev_elem_f_res_161986 = ((int64_t *) ks_mem_171275.mem)[tmp_161981];
                
                prev_elem_161977 = prev_elem_f_res_161986;
            }
            
            bool cond_161987 = slt64(eta_p_161973, (int64_t) 0);
            int64_t cur_elem_161988;
            
            if (cond_161987) {
                bool y_162169 = slt64((int64_t) 0, dz2081U_145533);
                bool index_certs_162170;
                
                if (!y_162169) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:56:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_t_res_162171 = ((int64_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_161988 = cur_elem_t_res_162171;
            } else {
                bool x_161992 = sle64((int64_t) 0, eta_p_161973);
                bool y_161993 = slt64(eta_p_161973, dz2081U_145533);
                bool bounds_check_161994 = x_161992 && y_161993;
                bool index_certs_161995;
                
                if (!bounds_check_161994) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161973, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:56:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_f_res_161996 = ((int64_t *) ks_mem_171275.mem)[eta_p_161973];
                
                cur_elem_161988 = cur_elem_f_res_161996;
            }
            
            bool cond_161997 = sle64(zgze_rhs_152989, eta_p_161973);
            int64_t next_elem_161998;
            
            if (cond_161997) {
                bool x_162173 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162174 = slt64(zgze_rhs_152989, dz2081U_145533);
                bool bounds_check_162175 = x_162173 && y_162174;
                bool index_certs_162176;
                
                if (!bounds_check_162175) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:57:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_t_res_162177 = ((int64_t *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_161998 = next_elem_t_res_162177;
            } else {
                int64_t tmp_162005 = add64((int64_t) 1, eta_p_161973);
                bool x_162006 = sle64((int64_t) 0, tmp_162005);
                bool y_162007 = slt64(tmp_162005, dz2081U_145533);
                bool bounds_check_162008 = x_162006 && y_162007;
                bool index_certs_162009;
                
                if (!bounds_check_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162005, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:57:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_f_res_162010 = ((int64_t *) ks_mem_171275.mem)[tmp_162005];
                
                next_elem_161998 = next_elem_f_res_162010;
            }
            
            int64_t defunc_0_f_res_162015;
            
            if (cond_161987) {
                defunc_0_f_res_162015 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162016 = eta_p_161974 == cur_elem_161988;
                bool cond_162017 = eta_p_161973 == (int64_t) 0;
                bool defunc_0_gt_res_162018 = slt64(prev_elem_161977, eta_p_161974);
                bool x_162019 = !cond_162017;
                bool y_162020 = defunc_0_gt_res_162018 && x_162019;
                bool cond_t_res_162021 = cond_162017 || y_162020;
                bool x_162022 = defunc_0_eq_res_162016 && cond_t_res_162021;
                int64_t defunc_0_f_res_f_res_162023;
                
                if (x_162022) {
                    defunc_0_f_res_f_res_162023 = eta_p_161973;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162024;
                    
                    if (defunc_0_eq_res_162016) {
                        int64_t max_arg1_162178 = sub64(eta_p_161973, this_step_152996);
                        int64_t max_res_162179 = smax64((int64_t) 0, max_arg1_162178);
                        
                        defunc_0_f_res_f_res_f_res_162024 = max_res_162179;
                    } else {
                        bool defunc_0_gt_res_162027 = slt64(cur_elem_161988, eta_p_161974);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162028;
                        
                        if (defunc_0_gt_res_162027) {
                            bool cond_162181 = eta_p_161973 == zgze_rhs_152989;
                            bool defunc_0_gt_res_162182 = slt64(eta_p_161974, next_elem_161998);
                            bool x_162183 = !cond_162181;
                            bool y_162184 = defunc_0_gt_res_162182 && x_162183;
                            bool cond_162185 = cond_162181 || y_162184;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                            
                            if (cond_162185) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162187 = add64(this_step_152996, eta_p_161973);
                                int64_t min_res_162188 = smin64(zgze_rhs_152989, min_arg1_162187);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = min_res_162188;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                            
                            if (cond_t_res_162021) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162039 = sub64(eta_p_161973, this_step_152996);
                                int64_t max_res_162040 = smax64((int64_t) 0, max_arg1_162039);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = max_res_162040;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                        }
                        defunc_0_f_res_f_res_f_res_162024 = defunc_0_f_res_f_res_f_res_f_res_162028;
                    }
                    defunc_0_f_res_f_res_162023 = defunc_0_f_res_f_res_f_res_162024;
                }
                defunc_0_f_res_162015 = defunc_0_f_res_f_res_162023;
            }
            ((int64_t *) mem_171282.mem)[i_171003] = defunc_0_f_res_162015;
        }
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171282, "mem_171282") != 0)
            return 1;
        
        int64_t last_step_tmp_171961 = this_step_152996;
        
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        last_step_152994 = last_step_tmp_171961;
    }
    if (memblock_set(ctx, &ext_mem_171291, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    bsearch_first_152991 = last_step_152994;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    
    int64_t bsearch_last_153070;
    int64_t last_step_153073;
    
    if (memblock_set(ctx, &mem_param_171294, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    last_step_153073 = dz2081U_145533;
    for (int64_t i_153071 = 0; i_153071 < num_iter_152987; i_153071++) {
        int64_t zs_lhs_153074 = add64((int64_t) 1, last_step_153073);
        int64_t max_arg1_153075 = sdiv64(zs_lhs_153074, (int64_t) 2);
        int64_t max_res_153076 = smax64((int64_t) 1, max_arg1_153075);
        
        if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171007 = 0; i_171007 < dz2080U_145532; i_171007++) {
            int64_t eta_p_162090 = ((int64_t *) mem_param_171294.mem)[i_171007];
            int64_t eta_p_162091 = ((int64_t *) k_ids_mem_171274.mem)[i_171007];
            bool cond_162093 = slt64(eta_p_162090, (int64_t) 0);
            int64_t cur_elem_162094;
            
            if (cond_162093) {
                bool y_162190 = slt64((int64_t) 0, dz2081U_145533);
                bool index_certs_162191;
                
                if (!y_162190) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:81:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_t_res_162192 = ((int64_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_162094 = cur_elem_t_res_162192;
            } else {
                bool x_162098 = sle64((int64_t) 0, eta_p_162090);
                bool y_162099 = slt64(eta_p_162090, dz2081U_145533);
                bool bounds_check_162100 = x_162098 && y_162099;
                bool index_certs_162101;
                
                if (!bounds_check_162100) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162090, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:81:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_f_res_162102 = ((int64_t *) ks_mem_171275.mem)[eta_p_162090];
                
                cur_elem_162094 = cur_elem_f_res_162102;
            }
            
            bool cond_162103 = sle64(zgze_rhs_152989, eta_p_162090);
            int64_t next_elem_162104;
            
            if (cond_162103) {
                bool x_162194 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162195 = slt64(zgze_rhs_152989, dz2081U_145533);
                bool bounds_check_162196 = x_162194 && y_162195;
                bool index_certs_162197;
                
                if (!bounds_check_162196) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:82:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_t_res_162198 = ((int64_t *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_162104 = next_elem_t_res_162198;
            } else {
                int64_t tmp_162111 = add64((int64_t) 1, eta_p_162090);
                bool x_162112 = sle64((int64_t) 0, tmp_162111);
                bool y_162113 = slt64(tmp_162111, dz2081U_145533);
                bool bounds_check_162114 = x_162112 && y_162113;
                bool index_certs_162115;
                
                if (!bounds_check_162114) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162111, "] out of bounds for array of shape [", (long long) dz2081U_145533, "].", "-> #0  ft_SortGroupBy.fut:82:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:288:73-76\n   #4  ftRelational.fut:286:5-289:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_f_res_162116 = ((int64_t *) ks_mem_171275.mem)[tmp_162111];
                
                next_elem_162104 = next_elem_f_res_162116;
            }
            
            int64_t defunc_0_f_res_162120;
            
            if (cond_162093) {
                defunc_0_f_res_162120 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162121 = eta_p_162091 == cur_elem_162094;
                bool cond_162123 = eta_p_162090 == zgze_rhs_152989;
                bool defunc_0_gt_res_162124 = slt64(eta_p_162091, next_elem_162104);
                bool x_162125 = !cond_162123;
                bool y_162126 = defunc_0_gt_res_162124 && x_162125;
                bool cond_t_res_162127 = cond_162123 || y_162126;
                bool x_162128 = defunc_0_eq_res_162121 && cond_t_res_162127;
                int64_t defunc_0_f_res_f_res_162129;
                
                if (x_162128) {
                    defunc_0_f_res_f_res_162129 = eta_p_162090;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162130;
                    
                    if (defunc_0_eq_res_162121) {
                        int64_t min_arg1_162199 = add64(max_res_153076, eta_p_162090);
                        int64_t min_res_162200 = smin64(zgze_rhs_152989, min_arg1_162199);
                        
                        defunc_0_f_res_f_res_f_res_162130 = min_res_162200;
                    } else {
                        bool defunc_0_gt_res_162133 = slt64(cur_elem_162094, eta_p_162091);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162134;
                        
                        if (defunc_0_gt_res_162133) {
                            int64_t min_arg1_162201 = add64(max_res_153076, eta_p_162090);
                            int64_t min_res_162202 = smin64(zgze_rhs_152989, min_arg1_162201);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = min_res_162202;
                        } else {
                            int64_t max_arg1_162137 = sub64(eta_p_162090, max_res_153076);
                            int64_t max_res_162138 = smax64((int64_t) 0, max_arg1_162137);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = max_res_162138;
                        }
                        defunc_0_f_res_f_res_f_res_162130 = defunc_0_f_res_f_res_f_res_f_res_162134;
                    }
                    defunc_0_f_res_f_res_162129 = defunc_0_f_res_f_res_f_res_162130;
                }
                defunc_0_f_res_162120 = defunc_0_f_res_f_res_162129;
            }
            ((int64_t *) mem_171296.mem)[i_171007] = defunc_0_f_res_162120;
        }
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171296, "mem_171296") != 0)
            return 1;
        
        int64_t last_step_tmp_171965 = max_res_153076;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        last_step_153073 = last_step_tmp_171965;
    }
    if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
        return 1;
    bsearch_last_153070 = last_step_153073;
    if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < dz2080U_145532; i_171011++) {
        int64_t eta_p_153130 = ((int64_t *) ext_mem_171291.mem)[i_171011];
        int64_t eta_p_153131 = ((int64_t *) ext_mem_171305.mem)[i_171011];
        bool cond_153132 = slt64(eta_p_153130, (int64_t) 0);
        int64_t lifted_lambda_res_153133;
        
        if (cond_153132) {
            lifted_lambda_res_153133 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153134 = sub64(eta_p_153131, eta_p_153130);
            int64_t lifted_lambda_res_f_res_153135 = add64((int64_t) 1, zp_lhs_153134);
            
            lifted_lambda_res_153133 = lifted_lambda_res_f_res_153135;
        }
        ((int64_t *) mem_171307.mem)[i_171011] = lifted_lambda_res_153133;
    }
    if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171307, "mem_171307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172561, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172562, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171282, "mem_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171291, "ext_mem_171291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_172563, struct memblock *mem_out_p_172564, struct memblock k_ids_mem_171274, struct memblock ks_mem_171275, int64_t dz2080U_143952, int64_t dz2081U_143953)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171307;
    
    mem_171307.references = NULL;
    
    struct memblock mem_param_tmp_171963;
    
    mem_param_tmp_171963.references = NULL;
    
    struct memblock mem_171296;
    
    mem_171296.references = NULL;
    
    struct memblock mem_param_171294;
    
    mem_param_171294.references = NULL;
    
    struct memblock ext_mem_171305;
    
    ext_mem_171305.references = NULL;
    
    struct memblock mem_param_tmp_171959;
    
    mem_param_tmp_171959.references = NULL;
    
    struct memblock mem_171282;
    
    mem_171282.references = NULL;
    
    struct memblock mem_param_171280;
    
    mem_param_171280.references = NULL;
    
    struct memblock ext_mem_171291;
    
    ext_mem_171291.references = NULL;
    
    struct memblock mem_171277;
    
    mem_171277.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t bytes_171276 = (int64_t) 8 * dz2080U_143952;
    double i64_res_152983 = sitofp_i64_f64(dz2081U_143953);
    double log2_res_152984 = futrts_log2_64(i64_res_152983);
    double ceil_res_152985 = futrts_ceil64(log2_res_152984);
    int64_t f64_res_152986 = fptosi_f64_i64(ceil_res_152985);
    int64_t num_iter_152987 = add64((int64_t) 1, f64_res_152986);
    
    if (memblock_alloc(ctx, &mem_171277, bytes_171276, "mem_171277")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171958 = 0; nest_i_171958 < dz2080U_143952; nest_i_171958++) {
        ((int64_t *) mem_171277.mem)[nest_i_171958] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_152989 = sub64(dz2081U_143953, (int64_t) 1);
    int64_t bsearch_first_152991;
    int64_t last_step_152994;
    
    if (memblock_set(ctx, &mem_param_171280, &mem_171277, "mem_171277") != 0)
        return 1;
    last_step_152994 = dz2081U_143953;
    for (int64_t i_152992 = 0; i_152992 < num_iter_152987; i_152992++) {
        int64_t zs_lhs_152995 = add64((int64_t) 1, last_step_152994);
        int64_t this_step_152996 = sdiv64(zs_lhs_152995, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171282, bytes_171276, "mem_171282")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < dz2080U_143952; i_171003++) {
            int64_t eta_p_161973 = ((int64_t *) mem_param_171280.mem)[i_171003];
            int16_t eta_p_161974 = ((int16_t *) k_ids_mem_171274.mem)[i_171003];
            bool cond_161976 = sle64(eta_p_161973, (int64_t) 0);
            int16_t prev_elem_161977;
            
            if (cond_161976) {
                bool y_162166 = slt64((int64_t) 0, dz2081U_143953);
                bool index_certs_162167;
                
                if (!y_162166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:55:70-82\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t prev_elem_t_res_162168 = ((int16_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                prev_elem_161977 = prev_elem_t_res_162168;
            } else {
                int64_t tmp_161981 = sub64(eta_p_161973, (int64_t) 1);
                bool x_161982 = sle64((int64_t) 0, tmp_161981);
                bool y_161983 = slt64(tmp_161981, dz2081U_143953);
                bool bounds_check_161984 = x_161982 && y_161983;
                bool index_certs_161985;
                
                if (!bounds_check_161984) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161981, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:55:88-102\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t prev_elem_f_res_161986 = ((int16_t *) ks_mem_171275.mem)[tmp_161981];
                
                prev_elem_161977 = prev_elem_f_res_161986;
            }
            
            bool cond_161987 = slt64(eta_p_161973, (int64_t) 0);
            int16_t cur_elem_161988;
            
            if (cond_161987) {
                bool y_162169 = slt64((int64_t) 0, dz2081U_143953);
                bool index_certs_162170;
                
                if (!y_162169) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:56:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_t_res_162171 = ((int16_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_161988 = cur_elem_t_res_162171;
            } else {
                bool x_161992 = sle64((int64_t) 0, eta_p_161973);
                bool y_161993 = slt64(eta_p_161973, dz2081U_143953);
                bool bounds_check_161994 = x_161992 && y_161993;
                bool index_certs_161995;
                
                if (!bounds_check_161994) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_161973, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:56:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_f_res_161996 = ((int16_t *) ks_mem_171275.mem)[eta_p_161973];
                
                cur_elem_161988 = cur_elem_f_res_161996;
            }
            
            bool cond_161997 = sle64(zgze_rhs_152989, eta_p_161973);
            int16_t next_elem_161998;
            
            if (cond_161997) {
                bool x_162173 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162174 = slt64(zgze_rhs_152989, dz2081U_143953);
                bool bounds_check_162175 = x_162173 && y_162174;
                bool index_certs_162176;
                
                if (!bounds_check_162175) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:57:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_t_res_162177 = ((int16_t *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_161998 = next_elem_t_res_162177;
            } else {
                int64_t tmp_162005 = add64((int64_t) 1, eta_p_161973);
                bool x_162006 = sle64((int64_t) 0, tmp_162005);
                bool y_162007 = slt64(tmp_162005, dz2081U_143953);
                bool bounds_check_162008 = x_162006 && y_162007;
                bool index_certs_162009;
                
                if (!bounds_check_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162005, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:57:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:36-59:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_f_res_162010 = ((int16_t *) ks_mem_171275.mem)[tmp_162005];
                
                next_elem_161998 = next_elem_f_res_162010;
            }
            
            int64_t defunc_0_f_res_162015;
            
            if (cond_161987) {
                defunc_0_f_res_162015 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162016 = eta_p_161974 == cur_elem_161988;
                bool cond_162017 = eta_p_161973 == (int64_t) 0;
                bool defunc_0_gt_res_162018 = slt16(prev_elem_161977, eta_p_161974);
                bool x_162019 = !cond_162017;
                bool y_162020 = defunc_0_gt_res_162018 && x_162019;
                bool cond_t_res_162021 = cond_162017 || y_162020;
                bool x_162022 = defunc_0_eq_res_162016 && cond_t_res_162021;
                int64_t defunc_0_f_res_f_res_162023;
                
                if (x_162022) {
                    defunc_0_f_res_f_res_162023 = eta_p_161973;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162024;
                    
                    if (defunc_0_eq_res_162016) {
                        int64_t max_arg1_162178 = sub64(eta_p_161973, this_step_152996);
                        int64_t max_res_162179 = smax64((int64_t) 0, max_arg1_162178);
                        
                        defunc_0_f_res_f_res_f_res_162024 = max_res_162179;
                    } else {
                        bool defunc_0_gt_res_162027 = slt16(cur_elem_161988, eta_p_161974);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162028;
                        
                        if (defunc_0_gt_res_162027) {
                            bool cond_162181 = eta_p_161973 == zgze_rhs_152989;
                            bool defunc_0_gt_res_162182 = slt16(eta_p_161974, next_elem_161998);
                            bool x_162183 = !cond_162181;
                            bool y_162184 = defunc_0_gt_res_162182 && x_162183;
                            bool cond_162185 = cond_162181 || y_162184;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                            
                            if (cond_162185) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162187 = add64(this_step_152996, eta_p_161973);
                                int64_t min_res_162188 = smin64(zgze_rhs_152989, min_arg1_162187);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162186 = min_res_162188;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_t_res_162186;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                            
                            if (cond_t_res_162021) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162039 = sub64(eta_p_161973, this_step_152996);
                                int64_t max_res_162040 = smax64((int64_t) 0, max_arg1_162039);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162038 = max_res_162040;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162028 = defunc_0_f_res_f_res_f_res_f_res_f_res_162038;
                        }
                        defunc_0_f_res_f_res_f_res_162024 = defunc_0_f_res_f_res_f_res_f_res_162028;
                    }
                    defunc_0_f_res_f_res_162023 = defunc_0_f_res_f_res_f_res_162024;
                }
                defunc_0_f_res_162015 = defunc_0_f_res_f_res_162023;
            }
            ((int64_t *) mem_171282.mem)[i_171003] = defunc_0_f_res_162015;
        }
        if (memblock_set(ctx, &mem_param_tmp_171959, &mem_171282, "mem_171282") != 0)
            return 1;
        
        int64_t last_step_tmp_171961 = this_step_152996;
        
        if (memblock_set(ctx, &mem_param_171280, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        last_step_152994 = last_step_tmp_171961;
    }
    if (memblock_set(ctx, &ext_mem_171291, &mem_param_171280, "mem_param_171280") != 0)
        return 1;
    bsearch_first_152991 = last_step_152994;
    if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
        return 1;
    
    int64_t bsearch_last_153070;
    int64_t last_step_153073;
    
    if (memblock_set(ctx, &mem_param_171294, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    last_step_153073 = dz2081U_143953;
    for (int64_t i_153071 = 0; i_153071 < num_iter_152987; i_153071++) {
        int64_t zs_lhs_153074 = add64((int64_t) 1, last_step_153073);
        int64_t max_arg1_153075 = sdiv64(zs_lhs_153074, (int64_t) 2);
        int64_t max_res_153076 = smax64((int64_t) 1, max_arg1_153075);
        
        if (memblock_alloc(ctx, &mem_171296, bytes_171276, "mem_171296")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171007 = 0; i_171007 < dz2080U_143952; i_171007++) {
            int64_t eta_p_162090 = ((int64_t *) mem_param_171294.mem)[i_171007];
            int16_t eta_p_162091 = ((int16_t *) k_ids_mem_171274.mem)[i_171007];
            bool cond_162093 = slt64(eta_p_162090, (int64_t) 0);
            int16_t cur_elem_162094;
            
            if (cond_162093) {
                bool y_162190 = slt64((int64_t) 0, dz2081U_143953);
                bool index_certs_162191;
                
                if (!y_162190) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:81:68-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_t_res_162192 = ((int16_t *) ks_mem_171275.mem)[(int64_t) 0];
                
                cur_elem_162094 = cur_elem_t_res_162192;
            } else {
                bool x_162098 = sle64((int64_t) 0, eta_p_162090);
                bool y_162099 = slt64(eta_p_162090, dz2081U_143953);
                bool bounds_check_162100 = x_162098 && y_162099;
                bool index_certs_162101;
                
                if (!bounds_check_162100) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162090, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:81:86-98\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_f_res_162102 = ((int16_t *) ks_mem_171275.mem)[eta_p_162090];
                
                cur_elem_162094 = cur_elem_f_res_162102;
            }
            
            bool cond_162103 = sle64(zgze_rhs_152989, eta_p_162090);
            int16_t next_elem_162104;
            
            if (cond_162103) {
                bool x_162194 = sle64((int64_t) 0, zgze_rhs_152989);
                bool y_162195 = slt64(zgze_rhs_152989, dz2081U_143953);
                bool bounds_check_162196 = x_162194 && y_162195;
                bool index_certs_162197;
                
                if (!bounds_check_162196) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_152989, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:82:74-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_t_res_162198 = ((int16_t *) ks_mem_171275.mem)[zgze_rhs_152989];
                
                next_elem_162104 = next_elem_t_res_162198;
            } else {
                int64_t tmp_162111 = add64((int64_t) 1, eta_p_162090);
                bool x_162112 = sle64((int64_t) 0, tmp_162111);
                bool y_162113 = slt64(tmp_162111, dz2081U_143953);
                bool bounds_check_162114 = x_162112 && y_162113;
                bool index_certs_162115;
                
                if (!bounds_check_162114) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162111, "] out of bounds for array of shape [", (long long) dz2081U_143953, "].", "-> #0  ft_SortGroupBy.fut:82:94-108\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:36-84:34\n   #3  ftRelational.fut:280:73-76\n   #4  ftRelational.fut:278:5-281:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_f_res_162116 = ((int16_t *) ks_mem_171275.mem)[tmp_162111];
                
                next_elem_162104 = next_elem_f_res_162116;
            }
            
            int64_t defunc_0_f_res_162120;
            
            if (cond_162093) {
                defunc_0_f_res_162120 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162121 = eta_p_162091 == cur_elem_162094;
                bool cond_162123 = eta_p_162090 == zgze_rhs_152989;
                bool defunc_0_gt_res_162124 = slt16(eta_p_162091, next_elem_162104);
                bool x_162125 = !cond_162123;
                bool y_162126 = defunc_0_gt_res_162124 && x_162125;
                bool cond_t_res_162127 = cond_162123 || y_162126;
                bool x_162128 = defunc_0_eq_res_162121 && cond_t_res_162127;
                int64_t defunc_0_f_res_f_res_162129;
                
                if (x_162128) {
                    defunc_0_f_res_f_res_162129 = eta_p_162090;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162130;
                    
                    if (defunc_0_eq_res_162121) {
                        int64_t min_arg1_162199 = add64(max_res_153076, eta_p_162090);
                        int64_t min_res_162200 = smin64(zgze_rhs_152989, min_arg1_162199);
                        
                        defunc_0_f_res_f_res_f_res_162130 = min_res_162200;
                    } else {
                        bool defunc_0_gt_res_162133 = slt16(cur_elem_162094, eta_p_162091);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162134;
                        
                        if (defunc_0_gt_res_162133) {
                            int64_t min_arg1_162201 = add64(max_res_153076, eta_p_162090);
                            int64_t min_res_162202 = smin64(zgze_rhs_152989, min_arg1_162201);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = min_res_162202;
                        } else {
                            int64_t max_arg1_162137 = sub64(eta_p_162090, max_res_153076);
                            int64_t max_res_162138 = smax64((int64_t) 0, max_arg1_162137);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162134 = max_res_162138;
                        }
                        defunc_0_f_res_f_res_f_res_162130 = defunc_0_f_res_f_res_f_res_f_res_162134;
                    }
                    defunc_0_f_res_f_res_162129 = defunc_0_f_res_f_res_f_res_162130;
                }
                defunc_0_f_res_162120 = defunc_0_f_res_f_res_162129;
            }
            ((int64_t *) mem_171296.mem)[i_171007] = defunc_0_f_res_162120;
        }
        if (memblock_set(ctx, &mem_param_tmp_171963, &mem_171296, "mem_171296") != 0)
            return 1;
        
        int64_t last_step_tmp_171965 = max_res_153076;
        
        if (memblock_set(ctx, &mem_param_171294, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        last_step_153073 = last_step_tmp_171965;
    }
    if (memblock_set(ctx, &ext_mem_171305, &mem_param_171294, "mem_param_171294") != 0)
        return 1;
    bsearch_last_153070 = last_step_153073;
    if (memblock_alloc(ctx, &mem_171307, bytes_171276, "mem_171307")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171011 = 0; i_171011 < dz2080U_143952; i_171011++) {
        int64_t eta_p_153130 = ((int64_t *) ext_mem_171291.mem)[i_171011];
        int64_t eta_p_153131 = ((int64_t *) ext_mem_171305.mem)[i_171011];
        bool cond_153132 = slt64(eta_p_153130, (int64_t) 0);
        int64_t lifted_lambda_res_153133;
        
        if (cond_153132) {
            lifted_lambda_res_153133 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153134 = sub64(eta_p_153131, eta_p_153130);
            int64_t lifted_lambda_res_f_res_153135 = add64((int64_t) 1, zp_lhs_153134);
            
            lifted_lambda_res_153133 = lifted_lambda_res_f_res_153135;
        }
        ((int64_t *) mem_171307.mem)[i_171011] = lifted_lambda_res_153133;
    }
    if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &mem_171307, "mem_171307") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &ext_mem_171291, "ext_mem_171291") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172563, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172564, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171307, "mem_171307") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171963, "mem_param_tmp_171963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171296, "mem_171296") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171294, "mem_param_171294") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171305, "ext_mem_171305") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_171959, "mem_param_tmp_171959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171282, "mem_171282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171280, "mem_param_171280") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171291, "ext_mem_171291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171277, "mem_171277") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_172565, struct memblock *mem_out_p_172566, int64_t *out_prim_out_172567, struct memblock ks_mem_171274, int64_t dz2080U_148890)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171276_cached_sizze_172568 = 0;
    unsigned char *mem_171276 = NULL;
    int64_t mem_171278_cached_sizze_172569 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock mem_171300;
    
    mem_171300.references = NULL;
    
    struct memblock mem_171292;
    
    mem_171292.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t bytes_171275 = (int64_t) 8 * dz2080U_148890;
    
    if (mem_171276_cached_sizze_172568 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171276, &mem_171276_cached_sizze_172568, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171278_cached_sizze_172569 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172569, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171010;
    int64_t defunc_res_162058;
    int64_t scanacc_171003;
    int64_t redout_171005;
    
    scanacc_171003 = (int64_t) 0;
    redout_171005 = (int64_t) 0;
    for (int64_t i_171007 = 0; i_171007 < dz2080U_148890; i_171007++) {
        bool cond_162022 = i_171007 == (int64_t) 0;
        int64_t defunc_0_f_res_162023;
        
        if (cond_162022) {
            defunc_0_f_res_162023 = (int64_t) 0;
        } else {
            int64_t prev_k_162029 = sub64(i_171007, (int64_t) 1);
            bool x_162030 = sle64((int64_t) 0, prev_k_162029);
            bool y_162031 = slt64(prev_k_162029, dz2080U_148890);
            bool bounds_check_162032 = x_162030 && y_162031;
            bool index_certs_162033;
            
            if (!bounds_check_162032) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162029, "] out of bounds for array of shape [", (long long) dz2080U_148890, "].", "-> #0  ft_SortGroupBy.fut:108:38-52\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:20-113:18\n   #3  ftRelational.fut:317:64-68\n   #4  ftRelational.fut:315:5-318:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double this_k_162028 = ((double *) ks_mem_171274.mem)[i_171007];
            double prev_k_162034 = ((double *) ks_mem_171274.mem)[prev_k_162029];
            bool defunc_0_eq_res_162035 = this_k_162028 == prev_k_162034;
            int64_t defunc_0_f_res_f_res_162036;
            
            if (defunc_0_eq_res_162035) {
                defunc_0_f_res_f_res_162036 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162036 = i_171007;
            }
            defunc_0_f_res_162023 = defunc_0_f_res_f_res_162036;
        }
        
        bool lifted_lambda_res_162038 = sle64((int64_t) 0, defunc_0_f_res_162023);
        int64_t bool_res_162039 = btoi_bool_i64(lifted_lambda_res_162038);
        int64_t defunc_0_op_res_153988 = add64(bool_res_162039, scanacc_171003);
        int64_t zp_res_153979 = add64(bool_res_162039, redout_171005);
        
        ((int64_t *) mem_171276)[i_171007] = defunc_0_op_res_153988;
        ((int64_t *) mem_171278)[i_171007] = defunc_0_f_res_162023;
        
        int64_t scanacc_tmp_171959 = defunc_0_op_res_153988;
        int64_t redout_tmp_171961 = zp_res_153979;
        
        scanacc_171003 = scanacc_tmp_171959;
        redout_171005 = redout_tmp_171961;
    }
    discard_171010 = scanacc_171003;
    defunc_res_162058 = redout_171005;
    
    int64_t bytes_171291 = (int64_t) 8 * defunc_res_162058;
    
    if (memblock_alloc(ctx, &mem_171292, bytes_171291, "mem_171292")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171963 = 0; nest_i_171963 < defunc_res_162058; nest_i_171963++) {
        ((int64_t *) mem_171292.mem)[nest_i_171963] = (int64_t) -1;
    }
    for (int64_t write_iter_171011 = 0; write_iter_171011 < dz2080U_148890; write_iter_171011++) {
        int64_t write_iv_171014 = ((int64_t *) mem_171278)[write_iter_171011];
        int64_t zv_lhs_161981 = add64((int64_t) -1, write_iter_171011);
        int64_t tmp_161982 = smod64(zv_lhs_161981, dz2080U_148890);
        int64_t lifted_lambda_res_161983 = ((int64_t *) mem_171276)[tmp_161982];
        bool cond_161985 = write_iter_171011 == (int64_t) 0;
        int64_t lifted_lambda_res_161986;
        
        if (cond_161985) {
            lifted_lambda_res_161986 = (int64_t) 0;
        } else {
            lifted_lambda_res_161986 = lifted_lambda_res_161983;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161986) && slt64(lifted_lambda_res_161986, defunc_res_162058)) {
            ((int64_t *) mem_171292.mem)[lifted_lambda_res_161986] = write_iv_171014;
        }
    }
    
    int64_t zeze_rhs_154004 = sub64(defunc_res_162058, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171300, bytes_171291, "mem_171300")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171018 = 0; i_171018 < defunc_res_162058; i_171018++) {
        bool cond_154007 = i_171018 == zeze_rhs_154004;
        int64_t lifted_lambda_res_154008;
        
        if (cond_154007) {
            int64_t zm_rhs_162055 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t lifted_lambda_res_t_res_162056 = sub64(dz2080U_148890, zm_rhs_162055);
            
            lifted_lambda_res_154008 = lifted_lambda_res_t_res_162056;
        } else {
            int64_t next_ind_154020 = add64((int64_t) 1, i_171018);
            bool x_154021 = sle64((int64_t) 0, next_ind_154020);
            bool y_154022 = slt64(next_ind_154020, defunc_res_162058);
            bool bounds_check_154023 = x_154021 && y_154022;
            bool index_certs_154024;
            
            if (!bounds_check_154023) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154020, "] out of bounds for array of shape [", (long long) defunc_res_162058, "].", "-> #0  ft_SortGroupBy.fut:121:40-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:317:64-68\n   #3  ftRelational.fut:315:5-318:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154019 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t next_ind_154025 = ((int64_t *) mem_171292.mem)[next_ind_154020];
            int64_t lifted_lambda_res_f_res_154026 = sub64(next_ind_154025, this_ind_154019);
            
            lifted_lambda_res_154008 = lifted_lambda_res_f_res_154026;
        }
        ((int64_t *) mem_171300.mem)[i_171018] = lifted_lambda_res_154008;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171300, "mem_171300") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171292, "mem_171292") != 0)
        return 1;
    prim_out_171958 = defunc_res_162058;
    if (memblock_set(ctx, &*mem_out_p_172565, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172566, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172567 = prim_out_171958;
    
  cleanup:
    {
        free(mem_171276);
        free(mem_171278);
        if (memblock_unref(ctx, &mem_171300, "mem_171300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_172570, struct memblock *mem_out_p_172571, int64_t *out_prim_out_172572, struct memblock ks_mem_171274, int64_t dz2080U_148542)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171276_cached_sizze_172573 = 0;
    unsigned char *mem_171276 = NULL;
    int64_t mem_171278_cached_sizze_172574 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock mem_171300;
    
    mem_171300.references = NULL;
    
    struct memblock mem_171292;
    
    mem_171292.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t bytes_171275 = (int64_t) 8 * dz2080U_148542;
    
    if (mem_171276_cached_sizze_172573 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171276, &mem_171276_cached_sizze_172573, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171278_cached_sizze_172574 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172574, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171010;
    int64_t defunc_res_162058;
    int64_t scanacc_171003;
    int64_t redout_171005;
    
    scanacc_171003 = (int64_t) 0;
    redout_171005 = (int64_t) 0;
    for (int64_t i_171007 = 0; i_171007 < dz2080U_148542; i_171007++) {
        bool cond_162022 = i_171007 == (int64_t) 0;
        int64_t defunc_0_f_res_162023;
        
        if (cond_162022) {
            defunc_0_f_res_162023 = (int64_t) 0;
        } else {
            int64_t prev_k_162029 = sub64(i_171007, (int64_t) 1);
            bool x_162030 = sle64((int64_t) 0, prev_k_162029);
            bool y_162031 = slt64(prev_k_162029, dz2080U_148542);
            bool bounds_check_162032 = x_162030 && y_162031;
            bool index_certs_162033;
            
            if (!bounds_check_162032) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162029, "] out of bounds for array of shape [", (long long) dz2080U_148542, "].", "-> #0  ft_SortGroupBy.fut:108:38-52\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:20-113:18\n   #3  ftRelational.fut:313:64-68\n   #4  ftRelational.fut:311:5-314:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float this_k_162028 = ((float *) ks_mem_171274.mem)[i_171007];
            float prev_k_162034 = ((float *) ks_mem_171274.mem)[prev_k_162029];
            bool defunc_0_eq_res_162035 = this_k_162028 == prev_k_162034;
            int64_t defunc_0_f_res_f_res_162036;
            
            if (defunc_0_eq_res_162035) {
                defunc_0_f_res_f_res_162036 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162036 = i_171007;
            }
            defunc_0_f_res_162023 = defunc_0_f_res_f_res_162036;
        }
        
        bool lifted_lambda_res_162038 = sle64((int64_t) 0, defunc_0_f_res_162023);
        int64_t bool_res_162039 = btoi_bool_i64(lifted_lambda_res_162038);
        int64_t defunc_0_op_res_153988 = add64(bool_res_162039, scanacc_171003);
        int64_t zp_res_153979 = add64(bool_res_162039, redout_171005);
        
        ((int64_t *) mem_171276)[i_171007] = defunc_0_op_res_153988;
        ((int64_t *) mem_171278)[i_171007] = defunc_0_f_res_162023;
        
        int64_t scanacc_tmp_171959 = defunc_0_op_res_153988;
        int64_t redout_tmp_171961 = zp_res_153979;
        
        scanacc_171003 = scanacc_tmp_171959;
        redout_171005 = redout_tmp_171961;
    }
    discard_171010 = scanacc_171003;
    defunc_res_162058 = redout_171005;
    
    int64_t bytes_171291 = (int64_t) 8 * defunc_res_162058;
    
    if (memblock_alloc(ctx, &mem_171292, bytes_171291, "mem_171292")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171963 = 0; nest_i_171963 < defunc_res_162058; nest_i_171963++) {
        ((int64_t *) mem_171292.mem)[nest_i_171963] = (int64_t) -1;
    }
    for (int64_t write_iter_171011 = 0; write_iter_171011 < dz2080U_148542; write_iter_171011++) {
        int64_t write_iv_171014 = ((int64_t *) mem_171278)[write_iter_171011];
        int64_t zv_lhs_161981 = add64((int64_t) -1, write_iter_171011);
        int64_t tmp_161982 = smod64(zv_lhs_161981, dz2080U_148542);
        int64_t lifted_lambda_res_161983 = ((int64_t *) mem_171276)[tmp_161982];
        bool cond_161985 = write_iter_171011 == (int64_t) 0;
        int64_t lifted_lambda_res_161986;
        
        if (cond_161985) {
            lifted_lambda_res_161986 = (int64_t) 0;
        } else {
            lifted_lambda_res_161986 = lifted_lambda_res_161983;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161986) && slt64(lifted_lambda_res_161986, defunc_res_162058)) {
            ((int64_t *) mem_171292.mem)[lifted_lambda_res_161986] = write_iv_171014;
        }
    }
    
    int64_t zeze_rhs_154004 = sub64(defunc_res_162058, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171300, bytes_171291, "mem_171300")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171018 = 0; i_171018 < defunc_res_162058; i_171018++) {
        bool cond_154007 = i_171018 == zeze_rhs_154004;
        int64_t lifted_lambda_res_154008;
        
        if (cond_154007) {
            int64_t zm_rhs_162055 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t lifted_lambda_res_t_res_162056 = sub64(dz2080U_148542, zm_rhs_162055);
            
            lifted_lambda_res_154008 = lifted_lambda_res_t_res_162056;
        } else {
            int64_t next_ind_154020 = add64((int64_t) 1, i_171018);
            bool x_154021 = sle64((int64_t) 0, next_ind_154020);
            bool y_154022 = slt64(next_ind_154020, defunc_res_162058);
            bool bounds_check_154023 = x_154021 && y_154022;
            bool index_certs_154024;
            
            if (!bounds_check_154023) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154020, "] out of bounds for array of shape [", (long long) defunc_res_162058, "].", "-> #0  ft_SortGroupBy.fut:121:40-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:313:64-68\n   #3  ftRelational.fut:311:5-314:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154019 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t next_ind_154025 = ((int64_t *) mem_171292.mem)[next_ind_154020];
            int64_t lifted_lambda_res_f_res_154026 = sub64(next_ind_154025, this_ind_154019);
            
            lifted_lambda_res_154008 = lifted_lambda_res_f_res_154026;
        }
        ((int64_t *) mem_171300.mem)[i_171018] = lifted_lambda_res_154008;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171300, "mem_171300") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171292, "mem_171292") != 0)
        return 1;
    prim_out_171958 = defunc_res_162058;
    if (memblock_set(ctx, &*mem_out_p_172570, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172571, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172572 = prim_out_171958;
    
  cleanup:
    {
        free(mem_171276);
        free(mem_171278);
        if (memblock_unref(ctx, &mem_171300, "mem_171300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_172575, struct memblock *mem_out_p_172576, int64_t *out_prim_out_172577, struct memblock ks_mem_171274, int64_t dz2080U_147846)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171276_cached_sizze_172578 = 0;
    unsigned char *mem_171276 = NULL;
    int64_t mem_171278_cached_sizze_172579 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock mem_171300;
    
    mem_171300.references = NULL;
    
    struct memblock mem_171292;
    
    mem_171292.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t bytes_171275 = (int64_t) 8 * dz2080U_147846;
    
    if (mem_171276_cached_sizze_172578 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171276, &mem_171276_cached_sizze_172578, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171278_cached_sizze_172579 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172579, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171010;
    int64_t defunc_res_162058;
    int64_t scanacc_171003;
    int64_t redout_171005;
    
    scanacc_171003 = (int64_t) 0;
    redout_171005 = (int64_t) 0;
    for (int64_t i_171007 = 0; i_171007 < dz2080U_147846; i_171007++) {
        bool cond_162022 = i_171007 == (int64_t) 0;
        int64_t defunc_0_f_res_162023;
        
        if (cond_162022) {
            defunc_0_f_res_162023 = (int64_t) 0;
        } else {
            int64_t prev_k_162029 = sub64(i_171007, (int64_t) 1);
            bool x_162030 = sle64((int64_t) 0, prev_k_162029);
            bool y_162031 = slt64(prev_k_162029, dz2080U_147846);
            bool bounds_check_162032 = x_162030 && y_162031;
            bool index_certs_162033;
            
            if (!bounds_check_162032) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162029, "] out of bounds for array of shape [", (long long) dz2080U_147846, "].", "-> #0  ft_SortGroupBy.fut:108:38-52\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:20-113:18\n   #3  ftRelational.fut:305:64-68\n   #4  ftRelational.fut:303:5-306:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t this_k_162028 = ((int32_t *) ks_mem_171274.mem)[i_171007];
            int32_t prev_k_162034 = ((int32_t *) ks_mem_171274.mem)[prev_k_162029];
            bool defunc_0_eq_res_162035 = this_k_162028 == prev_k_162034;
            int64_t defunc_0_f_res_f_res_162036;
            
            if (defunc_0_eq_res_162035) {
                defunc_0_f_res_f_res_162036 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162036 = i_171007;
            }
            defunc_0_f_res_162023 = defunc_0_f_res_f_res_162036;
        }
        
        bool lifted_lambda_res_162038 = sle64((int64_t) 0, defunc_0_f_res_162023);
        int64_t bool_res_162039 = btoi_bool_i64(lifted_lambda_res_162038);
        int64_t defunc_0_op_res_153988 = add64(bool_res_162039, scanacc_171003);
        int64_t zp_res_153979 = add64(bool_res_162039, redout_171005);
        
        ((int64_t *) mem_171276)[i_171007] = defunc_0_op_res_153988;
        ((int64_t *) mem_171278)[i_171007] = defunc_0_f_res_162023;
        
        int64_t scanacc_tmp_171959 = defunc_0_op_res_153988;
        int64_t redout_tmp_171961 = zp_res_153979;
        
        scanacc_171003 = scanacc_tmp_171959;
        redout_171005 = redout_tmp_171961;
    }
    discard_171010 = scanacc_171003;
    defunc_res_162058 = redout_171005;
    
    int64_t bytes_171291 = (int64_t) 8 * defunc_res_162058;
    
    if (memblock_alloc(ctx, &mem_171292, bytes_171291, "mem_171292")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171963 = 0; nest_i_171963 < defunc_res_162058; nest_i_171963++) {
        ((int64_t *) mem_171292.mem)[nest_i_171963] = (int64_t) -1;
    }
    for (int64_t write_iter_171011 = 0; write_iter_171011 < dz2080U_147846; write_iter_171011++) {
        int64_t write_iv_171014 = ((int64_t *) mem_171278)[write_iter_171011];
        int64_t zv_lhs_161981 = add64((int64_t) -1, write_iter_171011);
        int64_t tmp_161982 = smod64(zv_lhs_161981, dz2080U_147846);
        int64_t lifted_lambda_res_161983 = ((int64_t *) mem_171276)[tmp_161982];
        bool cond_161985 = write_iter_171011 == (int64_t) 0;
        int64_t lifted_lambda_res_161986;
        
        if (cond_161985) {
            lifted_lambda_res_161986 = (int64_t) 0;
        } else {
            lifted_lambda_res_161986 = lifted_lambda_res_161983;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161986) && slt64(lifted_lambda_res_161986, defunc_res_162058)) {
            ((int64_t *) mem_171292.mem)[lifted_lambda_res_161986] = write_iv_171014;
        }
    }
    
    int64_t zeze_rhs_154004 = sub64(defunc_res_162058, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171300, bytes_171291, "mem_171300")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171018 = 0; i_171018 < defunc_res_162058; i_171018++) {
        bool cond_154007 = i_171018 == zeze_rhs_154004;
        int64_t lifted_lambda_res_154008;
        
        if (cond_154007) {
            int64_t zm_rhs_162055 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t lifted_lambda_res_t_res_162056 = sub64(dz2080U_147846, zm_rhs_162055);
            
            lifted_lambda_res_154008 = lifted_lambda_res_t_res_162056;
        } else {
            int64_t next_ind_154020 = add64((int64_t) 1, i_171018);
            bool x_154021 = sle64((int64_t) 0, next_ind_154020);
            bool y_154022 = slt64(next_ind_154020, defunc_res_162058);
            bool bounds_check_154023 = x_154021 && y_154022;
            bool index_certs_154024;
            
            if (!bounds_check_154023) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154020, "] out of bounds for array of shape [", (long long) defunc_res_162058, "].", "-> #0  ft_SortGroupBy.fut:121:40-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:305:64-68\n   #3  ftRelational.fut:303:5-306:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154019 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t next_ind_154025 = ((int64_t *) mem_171292.mem)[next_ind_154020];
            int64_t lifted_lambda_res_f_res_154026 = sub64(next_ind_154025, this_ind_154019);
            
            lifted_lambda_res_154008 = lifted_lambda_res_f_res_154026;
        }
        ((int64_t *) mem_171300.mem)[i_171018] = lifted_lambda_res_154008;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171300, "mem_171300") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171292, "mem_171292") != 0)
        return 1;
    prim_out_171958 = defunc_res_162058;
    if (memblock_set(ctx, &*mem_out_p_172575, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172576, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172577 = prim_out_171958;
    
  cleanup:
    {
        free(mem_171276);
        free(mem_171278);
        if (memblock_unref(ctx, &mem_171300, "mem_171300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172580, struct memblock *mem_out_p_172581, int64_t *out_prim_out_172582, struct memblock ks_mem_171274, int64_t dz2080U_148194)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171276_cached_sizze_172583 = 0;
    unsigned char *mem_171276 = NULL;
    int64_t mem_171278_cached_sizze_172584 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock mem_171300;
    
    mem_171300.references = NULL;
    
    struct memblock mem_171292;
    
    mem_171292.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t bytes_171275 = (int64_t) 8 * dz2080U_148194;
    
    if (mem_171276_cached_sizze_172583 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171276, &mem_171276_cached_sizze_172583, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171278_cached_sizze_172584 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172584, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171010;
    int64_t defunc_res_162058;
    int64_t scanacc_171003;
    int64_t redout_171005;
    
    scanacc_171003 = (int64_t) 0;
    redout_171005 = (int64_t) 0;
    for (int64_t i_171007 = 0; i_171007 < dz2080U_148194; i_171007++) {
        bool cond_162022 = i_171007 == (int64_t) 0;
        int64_t defunc_0_f_res_162023;
        
        if (cond_162022) {
            defunc_0_f_res_162023 = (int64_t) 0;
        } else {
            int64_t prev_k_162029 = sub64(i_171007, (int64_t) 1);
            bool x_162030 = sle64((int64_t) 0, prev_k_162029);
            bool y_162031 = slt64(prev_k_162029, dz2080U_148194);
            bool bounds_check_162032 = x_162030 && y_162031;
            bool index_certs_162033;
            
            if (!bounds_check_162032) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162029, "] out of bounds for array of shape [", (long long) dz2080U_148194, "].", "-> #0  ft_SortGroupBy.fut:108:38-52\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:20-113:18\n   #3  ftRelational.fut:309:64-68\n   #4  ftRelational.fut:307:5-310:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_k_162028 = ((int64_t *) ks_mem_171274.mem)[i_171007];
            int64_t prev_k_162034 = ((int64_t *) ks_mem_171274.mem)[prev_k_162029];
            bool defunc_0_eq_res_162035 = this_k_162028 == prev_k_162034;
            int64_t defunc_0_f_res_f_res_162036;
            
            if (defunc_0_eq_res_162035) {
                defunc_0_f_res_f_res_162036 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162036 = i_171007;
            }
            defunc_0_f_res_162023 = defunc_0_f_res_f_res_162036;
        }
        
        bool lifted_lambda_res_162038 = sle64((int64_t) 0, defunc_0_f_res_162023);
        int64_t bool_res_162039 = btoi_bool_i64(lifted_lambda_res_162038);
        int64_t defunc_0_op_res_153988 = add64(bool_res_162039, scanacc_171003);
        int64_t zp_res_153979 = add64(bool_res_162039, redout_171005);
        
        ((int64_t *) mem_171276)[i_171007] = defunc_0_op_res_153988;
        ((int64_t *) mem_171278)[i_171007] = defunc_0_f_res_162023;
        
        int64_t scanacc_tmp_171959 = defunc_0_op_res_153988;
        int64_t redout_tmp_171961 = zp_res_153979;
        
        scanacc_171003 = scanacc_tmp_171959;
        redout_171005 = redout_tmp_171961;
    }
    discard_171010 = scanacc_171003;
    defunc_res_162058 = redout_171005;
    
    int64_t bytes_171291 = (int64_t) 8 * defunc_res_162058;
    
    if (memblock_alloc(ctx, &mem_171292, bytes_171291, "mem_171292")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171963 = 0; nest_i_171963 < defunc_res_162058; nest_i_171963++) {
        ((int64_t *) mem_171292.mem)[nest_i_171963] = (int64_t) -1;
    }
    for (int64_t write_iter_171011 = 0; write_iter_171011 < dz2080U_148194; write_iter_171011++) {
        int64_t write_iv_171014 = ((int64_t *) mem_171278)[write_iter_171011];
        int64_t zv_lhs_161981 = add64((int64_t) -1, write_iter_171011);
        int64_t tmp_161982 = smod64(zv_lhs_161981, dz2080U_148194);
        int64_t lifted_lambda_res_161983 = ((int64_t *) mem_171276)[tmp_161982];
        bool cond_161985 = write_iter_171011 == (int64_t) 0;
        int64_t lifted_lambda_res_161986;
        
        if (cond_161985) {
            lifted_lambda_res_161986 = (int64_t) 0;
        } else {
            lifted_lambda_res_161986 = lifted_lambda_res_161983;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161986) && slt64(lifted_lambda_res_161986, defunc_res_162058)) {
            ((int64_t *) mem_171292.mem)[lifted_lambda_res_161986] = write_iv_171014;
        }
    }
    
    int64_t zeze_rhs_154004 = sub64(defunc_res_162058, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171300, bytes_171291, "mem_171300")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171018 = 0; i_171018 < defunc_res_162058; i_171018++) {
        bool cond_154007 = i_171018 == zeze_rhs_154004;
        int64_t lifted_lambda_res_154008;
        
        if (cond_154007) {
            int64_t zm_rhs_162055 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t lifted_lambda_res_t_res_162056 = sub64(dz2080U_148194, zm_rhs_162055);
            
            lifted_lambda_res_154008 = lifted_lambda_res_t_res_162056;
        } else {
            int64_t next_ind_154020 = add64((int64_t) 1, i_171018);
            bool x_154021 = sle64((int64_t) 0, next_ind_154020);
            bool y_154022 = slt64(next_ind_154020, defunc_res_162058);
            bool bounds_check_154023 = x_154021 && y_154022;
            bool index_certs_154024;
            
            if (!bounds_check_154023) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154020, "] out of bounds for array of shape [", (long long) defunc_res_162058, "].", "-> #0  ft_SortGroupBy.fut:121:40-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:309:64-68\n   #3  ftRelational.fut:307:5-310:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154019 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t next_ind_154025 = ((int64_t *) mem_171292.mem)[next_ind_154020];
            int64_t lifted_lambda_res_f_res_154026 = sub64(next_ind_154025, this_ind_154019);
            
            lifted_lambda_res_154008 = lifted_lambda_res_f_res_154026;
        }
        ((int64_t *) mem_171300.mem)[i_171018] = lifted_lambda_res_154008;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171300, "mem_171300") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171292, "mem_171292") != 0)
        return 1;
    prim_out_171958 = defunc_res_162058;
    if (memblock_set(ctx, &*mem_out_p_172580, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172581, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172582 = prim_out_171958;
    
  cleanup:
    {
        free(mem_171276);
        free(mem_171278);
        if (memblock_unref(ctx, &mem_171300, "mem_171300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_172585, struct memblock *mem_out_p_172586, int64_t *out_prim_out_172587, struct memblock ks_mem_171274, int64_t dz2080U_147498)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171276_cached_sizze_172588 = 0;
    unsigned char *mem_171276 = NULL;
    int64_t mem_171278_cached_sizze_172589 = 0;
    unsigned char *mem_171278 = NULL;
    struct memblock mem_171300;
    
    mem_171300.references = NULL;
    
    struct memblock mem_171292;
    
    mem_171292.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t bytes_171275 = (int64_t) 8 * dz2080U_147498;
    
    if (mem_171276_cached_sizze_172588 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171276, &mem_171276_cached_sizze_172588, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171278_cached_sizze_172589 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172589, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171010;
    int64_t defunc_res_162058;
    int64_t scanacc_171003;
    int64_t redout_171005;
    
    scanacc_171003 = (int64_t) 0;
    redout_171005 = (int64_t) 0;
    for (int64_t i_171007 = 0; i_171007 < dz2080U_147498; i_171007++) {
        bool cond_162022 = i_171007 == (int64_t) 0;
        int64_t defunc_0_f_res_162023;
        
        if (cond_162022) {
            defunc_0_f_res_162023 = (int64_t) 0;
        } else {
            int64_t prev_k_162029 = sub64(i_171007, (int64_t) 1);
            bool x_162030 = sle64((int64_t) 0, prev_k_162029);
            bool y_162031 = slt64(prev_k_162029, dz2080U_147498);
            bool bounds_check_162032 = x_162030 && y_162031;
            bool index_certs_162033;
            
            if (!bounds_check_162032) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162029, "] out of bounds for array of shape [", (long long) dz2080U_147498, "].", "-> #0  ft_SortGroupBy.fut:108:38-52\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:20-113:18\n   #3  ftRelational.fut:301:64-68\n   #4  ftRelational.fut:299:5-302:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t this_k_162028 = ((int16_t *) ks_mem_171274.mem)[i_171007];
            int16_t prev_k_162034 = ((int16_t *) ks_mem_171274.mem)[prev_k_162029];
            bool defunc_0_eq_res_162035 = this_k_162028 == prev_k_162034;
            int64_t defunc_0_f_res_f_res_162036;
            
            if (defunc_0_eq_res_162035) {
                defunc_0_f_res_f_res_162036 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162036 = i_171007;
            }
            defunc_0_f_res_162023 = defunc_0_f_res_f_res_162036;
        }
        
        bool lifted_lambda_res_162038 = sle64((int64_t) 0, defunc_0_f_res_162023);
        int64_t bool_res_162039 = btoi_bool_i64(lifted_lambda_res_162038);
        int64_t defunc_0_op_res_153988 = add64(bool_res_162039, scanacc_171003);
        int64_t zp_res_153979 = add64(bool_res_162039, redout_171005);
        
        ((int64_t *) mem_171276)[i_171007] = defunc_0_op_res_153988;
        ((int64_t *) mem_171278)[i_171007] = defunc_0_f_res_162023;
        
        int64_t scanacc_tmp_171959 = defunc_0_op_res_153988;
        int64_t redout_tmp_171961 = zp_res_153979;
        
        scanacc_171003 = scanacc_tmp_171959;
        redout_171005 = redout_tmp_171961;
    }
    discard_171010 = scanacc_171003;
    defunc_res_162058 = redout_171005;
    
    int64_t bytes_171291 = (int64_t) 8 * defunc_res_162058;
    
    if (memblock_alloc(ctx, &mem_171292, bytes_171291, "mem_171292")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171963 = 0; nest_i_171963 < defunc_res_162058; nest_i_171963++) {
        ((int64_t *) mem_171292.mem)[nest_i_171963] = (int64_t) -1;
    }
    for (int64_t write_iter_171011 = 0; write_iter_171011 < dz2080U_147498; write_iter_171011++) {
        int64_t write_iv_171014 = ((int64_t *) mem_171278)[write_iter_171011];
        int64_t zv_lhs_161981 = add64((int64_t) -1, write_iter_171011);
        int64_t tmp_161982 = smod64(zv_lhs_161981, dz2080U_147498);
        int64_t lifted_lambda_res_161983 = ((int64_t *) mem_171276)[tmp_161982];
        bool cond_161985 = write_iter_171011 == (int64_t) 0;
        int64_t lifted_lambda_res_161986;
        
        if (cond_161985) {
            lifted_lambda_res_161986 = (int64_t) 0;
        } else {
            lifted_lambda_res_161986 = lifted_lambda_res_161983;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161986) && slt64(lifted_lambda_res_161986, defunc_res_162058)) {
            ((int64_t *) mem_171292.mem)[lifted_lambda_res_161986] = write_iv_171014;
        }
    }
    
    int64_t zeze_rhs_154004 = sub64(defunc_res_162058, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171300, bytes_171291, "mem_171300")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171018 = 0; i_171018 < defunc_res_162058; i_171018++) {
        bool cond_154007 = i_171018 == zeze_rhs_154004;
        int64_t lifted_lambda_res_154008;
        
        if (cond_154007) {
            int64_t zm_rhs_162055 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t lifted_lambda_res_t_res_162056 = sub64(dz2080U_147498, zm_rhs_162055);
            
            lifted_lambda_res_154008 = lifted_lambda_res_t_res_162056;
        } else {
            int64_t next_ind_154020 = add64((int64_t) 1, i_171018);
            bool x_154021 = sle64((int64_t) 0, next_ind_154020);
            bool y_154022 = slt64(next_ind_154020, defunc_res_162058);
            bool bounds_check_154023 = x_154021 && y_154022;
            bool index_certs_154024;
            
            if (!bounds_check_154023) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154020, "] out of bounds for array of shape [", (long long) defunc_res_162058, "].", "-> #0  ft_SortGroupBy.fut:121:40-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:301:64-68\n   #3  ftRelational.fut:299:5-302:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154019 = ((int64_t *) mem_171292.mem)[i_171018];
            int64_t next_ind_154025 = ((int64_t *) mem_171292.mem)[next_ind_154020];
            int64_t lifted_lambda_res_f_res_154026 = sub64(next_ind_154025, this_ind_154019);
            
            lifted_lambda_res_154008 = lifted_lambda_res_f_res_154026;
        }
        ((int64_t *) mem_171300.mem)[i_171018] = lifted_lambda_res_154008;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171300, "mem_171300") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171292, "mem_171292") != 0)
        return 1;
    prim_out_171958 = defunc_res_162058;
    if (memblock_set(ctx, &*mem_out_p_172585, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172586, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172587 = prim_out_171958;
    
  cleanup:
    {
        free(mem_171276);
        free(mem_171278);
        if (memblock_unref(ctx, &mem_171300, "mem_171300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171292, "mem_171292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_16843(struct futhark_context *ctx, struct memblock *mem_out_p_172590, struct memblock *mem_out_p_172591, int64_t *out_prim_out_172592, int64_t *out_prim_out_172593, int32_t *out_prim_out_172594, struct memblock pXs_mem_171274, int64_t n_128638, int64_t b_128639, int32_t curDepth_128640, int32_t i_128642, int32_t j_128643)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171276_cached_sizze_172595 = 0;
    unsigned char *mem_171276 = NULL;
    int64_t mem_171278_cached_sizze_172596 = 0;
    unsigned char *mem_171278 = NULL;
    int64_t mem_171285_cached_sizze_172597 = 0;
    unsigned char *mem_171285 = NULL;
    int64_t mem_171286_cached_sizze_172598 = 0;
    unsigned char *mem_171286 = NULL;
    int64_t mem_171299_cached_sizze_172599 = 0;
    unsigned char *mem_171299 = NULL;
    int64_t mem_171313_cached_sizze_172600 = 0;
    unsigned char *mem_171313 = NULL;
    struct memblock mem_171324;
    
    mem_171324.references = NULL;
    
    struct memblock mem_171322;
    
    mem_171322.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t prim_out_171958;
    int64_t prim_out_171959;
    int32_t prim_out_171960;
    int64_t dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644 = sub64(n_128638, (int64_t) 1);
    bool bounds_invalid_upwards_128648 = slt64(n_128638, (int64_t) 1);
    bool valid_128653 = !bounds_invalid_upwards_128648;
    bool range_valid_c_128654;
    
    if (!valid_128653) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) n_128638, " is invalid.", "-> #0  ftHashJoin.fut:232:23-28\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_161792 = mul64((int64_t) 8, b_128639);
    int64_t min_arg1_161793 = sub64(zm_lhs_161792, (int64_t) 1);
    int32_t i64_res_161778 = sext_i64_i32(b_128639);
    int32_t zm_lhs_161779 = mul32(8, i64_res_161778);
    int32_t min_arg1_161780 = sub32(zm_lhs_161779, 1);
    int32_t min_res_161781 = smin32(j_128643, min_arg1_161780);
    int32_t zm_rhs_161788 = sdiv32(min_res_161781, 8);
    int32_t zm_lhs_161789 = sub32(i64_res_161778, zm_rhs_161788);
    int32_t i32_arg0_161790 = sub32(zm_lhs_161789, 1);
    int64_t i32_res_161791 = sext_i32_i64(i32_arg0_161790);
    int64_t min_res_161794 = smin64(i32_res_161791, min_arg1_161793);
    bool y_161823 = slt64(min_res_161794, b_128639);
    bool x_161822 = sle64((int64_t) 0, min_res_161794);
    bool bounds_check_161824 = x_161822 && y_161823;
    bool index_certs_161825;
    
    if (!bounds_check_161824) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_161794, "] out of bounds for array of shape [", (long long) b_128639, "].", "-> #0  ftHashJoin.fut:33:38-54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_rhs_161783 = sdiv32(i_128642, 8);
    int32_t zm_lhs_161784 = sub32(i64_res_161778, zm_rhs_161783);
    int32_t i32_arg0_161785 = sub32(zm_lhs_161784, 1);
    int64_t i32_res_161786 = sext_i32_i64(i32_arg0_161785);
    bool y_161812 = slt64(i32_res_161786, b_128639);
    bool x_161811 = sle64((int64_t) 0, i32_res_161786);
    bool bounds_check_161813 = x_161811 && y_161812;
    bool index_certs_161814;
    
    if (!bounds_check_161813) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_161786, "] out of bounds for array of shape [", (long long) b_128639, "].", "-> #0  ftHashJoin.fut:32:48-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t lastBit_161796 = smod32(min_res_161781, 8);
    int32_t zm_lhs_161799 = sub32(8, lastBit_161796);
    int32_t i32_arg0_161800 = sub32(zm_lhs_161799, 1);
    int8_t unsign_arg0_161801 = zext_i32_i8(i32_arg0_161800);
    int8_t unsign_arg0_161802 = lshr8((int8_t) -1, unsign_arg0_161801);
    int32_t firstBit_161795 = smod32(i_128642, 8);
    int8_t unsign_arg0_161797 = zext_i32_i8(firstBit_161795);
    int8_t first_bitMask_161798 = shl8((int8_t) -1, unsign_arg0_161797);
    int64_t bytes_171275 = (int64_t) 8 * dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644;
    
    if (mem_171276_cached_sizze_172595 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171276, &mem_171276_cached_sizze_172595, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171278_cached_sizze_172596 < bytes_171275) {
        err = lexical_realloc(ctx, &mem_171278, &mem_171278_cached_sizze_172596, bytes_171275);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171285_cached_sizze_172597 < b_128639) {
        err = lexical_realloc(ctx, &mem_171285, &mem_171285_cached_sizze_172597, b_128639);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171286_cached_sizze_172598 < b_128639) {
        err = lexical_realloc(ctx, &mem_171286, &mem_171286_cached_sizze_172598, b_128639);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171299_cached_sizze_172599 < b_128639) {
        err = lexical_realloc(ctx, &mem_171299, &mem_171299_cached_sizze_172599, b_128639);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171020;
    int64_t scanacc_171014 = (int64_t) 0;
    
    for (int64_t i_171017 = 0; i_171017 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644; i_171017++) {
        int64_t index_primexp_171250 = add64((int64_t) 1, i_171017);
        bool x_162040 = sle64((int64_t) 0, index_primexp_171250);
        bool y_162041 = slt64(index_primexp_171250, n_128638);
        bool bounds_check_162042 = x_162040 && y_162041;
        bool index_certs_162043;
        
        if (!bounds_check_162042) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) index_primexp_171250, "] out of bounds for array of shape [", (long long) n_128638, "].", "-> #0  ftHashJoin.fut:233:22-30\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:233:8-44\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_162047 = slt64(i_171017, n_128638);
        bool index_certs_162049;
        
        if (!y_162047) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171017, "] out of bounds for array of shape [", (long long) n_128638, "].", "-> #0  ftHashJoin.fut:233:32-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:233:8-44\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_171005 = 0; i_171005 < b_128639; i_171005++) {
            int8_t eta_p_162095 = ((int8_t *) pXs_mem_171274.mem)[index_primexp_171250 * b_128639 + i_171005];
            int8_t eta_p_162096 = ((int8_t *) pXs_mem_171274.mem)[i_171017 * b_128639 + i_171005];
            bool cond_162098 = sle64(i_171005, i32_res_161786);
            bool cond_t_res_162099 = sle64(min_res_161794, i_171005);
            bool x_162100 = cond_162098 && cond_t_res_162099;
            int8_t lifted_lambda_res_162101;
            
            if (x_162100) {
                lifted_lambda_res_162101 = eta_p_162095;
            } else {
                lifted_lambda_res_162101 = (int8_t) 0;
            }
            
            int8_t lifted_lambda_res_162106;
            
            if (x_162100) {
                lifted_lambda_res_162106 = eta_p_162096;
            } else {
                lifted_lambda_res_162106 = (int8_t) 0;
            }
            ((int8_t *) mem_171285)[i_171005] = lifted_lambda_res_162106;
            ((int8_t *) mem_171286)[i_171005] = lifted_lambda_res_162101;
        }
        
        int8_t za_lhs_162060 = ((int8_t *) mem_171286)[i32_res_161786];
        int8_t mod1_x_162061 = first_bitMask_161798 & za_lhs_162060;
        
        ((int8_t *) mem_171286)[i32_res_161786] = mod1_x_162061;
        
        int8_t za_lhs_162063 = ((int8_t *) mem_171286)[min_res_161794];
        int8_t tmp_162064 = unsign_arg0_161802 & za_lhs_162063;
        
        ((int8_t *) mem_171286)[min_res_161794] = tmp_162064;
        
        int8_t za_lhs_162073 = ((int8_t *) mem_171285)[i32_res_161786];
        int8_t mod1_x_162074 = first_bitMask_161798 & za_lhs_162073;
        
        ((int8_t *) mem_171285)[i32_res_161786] = mod1_x_162074;
        
        int8_t za_lhs_162076 = ((int8_t *) mem_171285)[min_res_161794];
        int8_t tmp_162077 = unsign_arg0_161802 & za_lhs_162076;
        
        ((int8_t *) mem_171285)[min_res_161794] = tmp_162077;
        for (int64_t i_171010 = 0; i_171010 < b_128639; i_171010++) {
            int8_t eta_p_162082 = ((int8_t *) mem_171286)[i_171010];
            int8_t eta_p_162083 = ((int8_t *) mem_171285)[i_171010];
            bool lifted_lambda_res_162084 = eta_p_162082 == eta_p_162083;
            bool lifted_lambda_res_162085 = !lifted_lambda_res_162084;
            
            ((bool *) mem_171299)[i_171010] = lifted_lambda_res_162085;
        }
        
        bool defunc_0_foldl_res_162086;
        bool acc_162088 = 0;
        
        for (int64_t i_162087 = 0; i_162087 < b_128639; i_162087++) {
            bool b_162089 = ((bool *) mem_171299)[i_162087];
            bool defunc_0_f_res_162090 = acc_162088 || b_162089;
            bool acc_tmp_171967 = defunc_0_f_res_162090;
            
            acc_162088 = acc_tmp_171967;
        }
        defunc_0_foldl_res_162086 = acc_162088;
        
        int64_t defunc_0_f_res_162091 = btoi_bool_i64(defunc_0_foldl_res_162086);
        int64_t defunc_0_op_res_153976 = add64(defunc_0_f_res_162091, scanacc_171014);
        
        ((int64_t *) mem_171276)[i_171017] = defunc_0_op_res_153976;
        ((int64_t *) mem_171278)[i_171017] = defunc_0_f_res_162091;
        
        int64_t scanacc_tmp_171961 = defunc_0_op_res_153976;
        
        scanacc_171014 = scanacc_tmp_171961;
    }
    discard_171020 = scanacc_171014;
    
    bool cond_153977 = dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644 == (int64_t) 0;
    bool x_153978 = !cond_153977;
    int64_t tmp_153979 = sub64(dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644, (int64_t) 1);
    bool x_153980 = sle64((int64_t) 0, tmp_153979);
    bool y_153981 = slt64(tmp_153979, dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644);
    bool bounds_check_153982 = x_153980 && y_153981;
    bool protect_assert_disj_153983 = cond_153977 || bounds_check_153982;
    bool index_certs_153984;
    
    if (!protect_assert_disj_153983) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_153979, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_153985;
    
    if (x_153978) {
        int64_t x_162119 = ((int64_t *) mem_171276)[tmp_153979];
        
        m_f_res_153985 = x_162119;
    } else {
        m_f_res_153985 = (int64_t) 0;
    }
    
    int64_t m_153987;
    
    if (cond_153977) {
        m_153987 = (int64_t) 0;
    } else {
        m_153987 = m_f_res_153985;
    }
    
    int64_t m_153997 = sub64(m_153987, (int64_t) 1);
    bool i_p_m_t_s_leq_w_153999 = slt64(m_153997, dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644);
    bool zzero_leq_i_p_m_t_s_153998 = sle64((int64_t) 0, m_153997);
    bool y_154001 = zzero_leq_i_p_m_t_s_153998 && i_p_m_t_s_leq_w_153999;
    bool i_lte_j_154000 = sle64((int64_t) 0, m_153987);
    bool forwards_ok_154002 = i_lte_j_154000 && y_154001;
    bool eq_x_zz_153994 = (int64_t) 0 == m_f_res_153985;
    bool p_and_eq_x_y_153995 = x_153978 && eq_x_zz_153994;
    bool empty_slice_153996 = cond_153977 || p_and_eq_x_y_153995;
    bool ok_or_empty_154003 = empty_slice_153996 || forwards_ok_154002;
    bool index_certs_154004;
    
    if (!ok_or_empty_154003) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_153987, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171312 = (int64_t) 8 * m_153987;
    int64_t conc_tmp_152275 = (int64_t) 1 + m_153987;
    int64_t bytes_171321 = (int64_t) 8 * conc_tmp_152275;
    int64_t bytes_171323 = (int64_t) 4 * conc_tmp_152275;
    
    if (mem_171313_cached_sizze_172600 < bytes_171312) {
        err = lexical_realloc(ctx, &mem_171313, &mem_171313_cached_sizze_172600, bytes_171312);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171968 = 0; i_171968 < m_153987; i_171968++) {
        int64_t x_171969 = (int64_t) 1 + i_171968 * (int64_t) 1;
        
        ((int64_t *) mem_171313)[i_171968] = x_171969;
    }
    for (int64_t write_iter_171021 = 0; write_iter_171021 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_128644; write_iter_171021++) {
        int64_t write_iv_171023 = ((int64_t *) mem_171278)[write_iter_171021];
        int64_t write_iv_171024 = ((int64_t *) mem_171276)[write_iter_171021];
        int64_t index_primexp_171246 = add64((int64_t) 1, write_iter_171021);
        bool cond_161974 = write_iv_171023 == (int64_t) 1;
        int64_t lifted_lambda_res_161975;
        
        if (cond_161974) {
            int64_t lifted_lambda_res_t_res_162120 = sub64(write_iv_171024, (int64_t) 1);
            
            lifted_lambda_res_161975 = lifted_lambda_res_t_res_162120;
        } else {
            lifted_lambda_res_161975 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_161975) && slt64(lifted_lambda_res_161975, m_153987)) {
            ((int64_t *) mem_171313)[lifted_lambda_res_161975] = index_primexp_171246;
        }
    }
    if (memblock_alloc(ctx, &mem_171322, bytes_171321, "mem_171322")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171971 = 0; nest_i_171971 < (int64_t) 1; nest_i_171971++) {
        ((int64_t *) mem_171322.mem)[nest_i_171971] = (int64_t) 0;
    }
    
    int64_t tmp_offs_171972 = (int64_t) 0;
    
    if (!(tmp_offs_171972 == (int64_t) 0)) {
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171322.mem, tmp_offs_171972, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171322.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
    }
    tmp_offs_171972 += (int64_t) 1;
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171322.mem, tmp_offs_171972, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171313, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_153987});
    tmp_offs_171972 += m_153987;
    if (memblock_alloc(ctx, &mem_171324, bytes_171323, "mem_171324")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_171973 = 0; nest_i_171973 < conc_tmp_152275; nest_i_171973++) {
        ((int32_t *) mem_171324.mem)[nest_i_171973] = curDepth_128640;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171322, "mem_171322") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171957, &mem_171324, "mem_171324") != 0)
        return 1;
    prim_out_171958 = conc_tmp_152275;
    prim_out_171959 = conc_tmp_152275;
    prim_out_171960 = curDepth_128640;
    if (memblock_set(ctx, &*mem_out_p_172590, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172591, &mem_out_171957, "mem_out_171957") != 0)
        return 1;
    *out_prim_out_172592 = prim_out_171958;
    *out_prim_out_172593 = prim_out_171959;
    *out_prim_out_172594 = prim_out_171960;
    
  cleanup:
    {
        free(mem_171276);
        free(mem_171278);
        free(mem_171285);
        free(mem_171286);
        free(mem_171299);
        free(mem_171313);
        if (memblock_unref(ctx, &mem_171324, "mem_171324") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171322, "mem_171322") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171957, "mem_out_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_172601, int32_t bit_82102, int16_t x_82103)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_171956;
    int16_t i32_res_152192 = sext_i32_i16(bit_82102);
    int16_t zgzg_res_152195 = ashr16(x_82103, i32_res_152192);
    int16_t za_res_152200 = (int16_t) 1 & zgzg_res_152195;
    int32_t to_i32_res_152202 = sext_i16_i32(za_res_152200);
    
    prim_out_171956 = to_i32_res_152202;
    *out_prim_out_172601 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_172602, int32_t bit_83868, int64_t x_83869)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_171956;
    int64_t i32_res_152192 = sext_i32_i64(bit_83868);
    int64_t zgzg_res_152195 = ashr64(x_83869, i32_res_152192);
    int64_t za_res_152200 = (int64_t) 1 & zgzg_res_152195;
    int32_t to_i32_res_152202 = sext_i64_i32(za_res_152200);
    
    prim_out_171956 = to_i32_res_152202;
    *out_prim_out_172602 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5312(struct futhark_context *ctx, int64_t *out_prim_out_172603, int64_t upper_bound_86403, int64_t n_86404)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    bool upper_bound_86405 = sle64((int64_t) 1, upper_bound_86403);
    bool assert_c_86407;
    
    if (!upper_bound_86405) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (upper_bound >= 1)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:189:21-58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_86416 = slt64(upper_bound_86403, n_86404);
    bool d_86425;
    int64_t d_86426;
    bool loop_while_86427;
    int64_t d_86428;
    
    loop_while_86427 = cond_86416;
    d_86428 = (int64_t) 1;
    while (loop_while_86427) {
        int64_t loopres_86429 = add64((int64_t) 1, d_86428);
        bool zzero_86431 = loopres_86429 == (int64_t) 0;
        bool nonzzero_86432 = !zzero_86431;
        bool nonzzero_cert_86433;
        
        if (!nonzzero_86432) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:190:36-38\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t zg_lhs_86434 = sdiv64(n_86404, loopres_86429);
        bool cond_86436 = slt64(upper_bound_86403, zg_lhs_86434);
        bool loop_cond_86437;
        
        if (cond_86436) {
            loop_cond_86437 = 1;
        } else {
            int64_t znze_lhs_86441 = smod64(n_86404, loopres_86429);
            bool loop_cond_f_res_86443 = znze_lhs_86441 == (int64_t) 0;
            bool loop_cond_f_res_86444 = !loop_cond_f_res_86443;
            
            loop_cond_86437 = loop_cond_f_res_86444;
        }
        
        bool loop_while_tmp_171957 = loop_cond_86437;
        int64_t d_tmp_171958 = loopres_86429;
        
        loop_while_86427 = loop_while_tmp_171957;
        d_86428 = d_tmp_171958;
    }
    d_86425 = loop_while_86427;
    d_86426 = d_86428;
    
    bool zzero_86446 = d_86426 == (int64_t) 0;
    bool nonzzero_86447 = !zzero_86446;
    bool nonzzero_cert_86448;
    
    if (!nonzzero_86447) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:191:7-9\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t greatest_divisor_leq_than_res_86449 = sdiv64(n_86404, d_86426);
    
    prim_out_171956 = greatest_divisor_leq_than_res_86449;
    *out_prim_out_172603 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16256(struct futhark_context *ctx, struct memblock *mem_out_p_172604, struct memblock nameless_mem_171274, int64_t n_98324, int64_t incr_98325)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t rng_98330 = add64(n_98324, incr_98325);
    bool bounds_invalid_upwards_98334 = slt64(rng_98330, incr_98325);
    bool valid_98339 = !bounds_invalid_upwards_98334;
    bool range_valid_c_98340;
    
    if (!valid_98339) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_98325, "..<", (long long) rng_98330, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * n_98324;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171957 = 0; i_171957 < n_98324; i_171957++) {
        int64_t x_171958 = incr_98325 + i_171957 * (int64_t) 1;
        
        ((int64_t *) mem_171276.mem)[i_171957] = x_171958;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172604, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16277(struct futhark_context *ctx, struct memblock *mem_out_p_172605, struct memblock nameless_mem_171274, int64_t n_99185, int64_t incr_99186)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t rng_99191 = add64(n_99185, incr_99186);
    bool bounds_invalid_upwards_99195 = slt64(rng_99191, incr_99186);
    bool valid_99200 = !bounds_invalid_upwards_99195;
    bool range_valid_c_99201;
    
    if (!valid_99200) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_99186, "..<", (long long) rng_99191, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * n_99185;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171957 = 0; i_171957 < n_99185; i_171957++) {
        int64_t x_171958 = incr_99186 + i_171957 * (int64_t) 1;
        
        ((int64_t *) mem_171276.mem)[i_171957] = x_171958;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172605, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16299(struct futhark_context *ctx, struct memblock *mem_out_p_172606, struct memblock nameless_mem_171274, int64_t n_100046, int64_t incr_100047)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t rng_100052 = add64(n_100046, incr_100047);
    bool bounds_invalid_upwards_100056 = slt64(rng_100052, incr_100047);
    bool valid_100061 = !bounds_invalid_upwards_100056;
    bool range_valid_c_100062;
    
    if (!valid_100061) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_100047, "..<", (long long) rng_100052, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * n_100046;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171957 = 0; i_171957 < n_100046; i_171957++) {
        int64_t x_171958 = incr_100047 + i_171957 * (int64_t) 1;
        
        ((int64_t *) mem_171276.mem)[i_171957] = x_171958;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172606, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16321(struct futhark_context *ctx, struct memblock *mem_out_p_172607, struct memblock nameless_mem_171274, int64_t n_100907, int64_t incr_100908)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t rng_100913 = add64(n_100907, incr_100908);
    bool bounds_invalid_upwards_100917 = slt64(rng_100913, incr_100908);
    bool valid_100922 = !bounds_invalid_upwards_100917;
    bool range_valid_c_100923;
    
    if (!valid_100922) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_100908, "..<", (long long) rng_100913, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * n_100907;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171957 = 0; i_171957 < n_100907; i_171957++) {
        int64_t x_171958 = incr_100908 + i_171957 * (int64_t) 1;
        
        ((int64_t *) mem_171276.mem)[i_171957] = x_171958;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172607, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16342(struct futhark_context *ctx, struct memblock *mem_out_p_172608, struct memblock nameless_mem_171274, int64_t n_101789, int64_t incr_101790)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171276;
    
    mem_171276.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int64_t rng_101795 = add64(n_101789, incr_101790);
    bool bounds_invalid_upwards_101799 = slt64(rng_101795, incr_101790);
    bool valid_101804 = !bounds_invalid_upwards_101799;
    bool range_valid_c_101805;
    
    if (!valid_101804) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_101790, "..<", (long long) rng_101795, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171275 = (int64_t) 8 * n_101789;
    
    if (memblock_alloc(ctx, &mem_171276, bytes_171275, "mem_171276")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171957 = 0; i_171957 < n_101789; i_171957++) {
        int64_t x_171958 = incr_101790 + i_171957 * (int64_t) 1;
        
        ((int64_t *) mem_171276.mem)[i_171957] = x_171958;
    }
    if (memblock_set(ctx, &mem_out_171956, &mem_171276, "mem_171276") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172608, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171276, "mem_171276") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_15223(struct futhark_context *ctx, int64_t *out_prim_out_172609, int64_t *out_prim_out_172610, int64_t *out_prim_out_172611, int64_t *out_prim_out_172612, int64_t *out_prim_out_172613, int64_t slo_86633, int64_t shi_86634, int64_t tlo_86635, int64_t thi_86636, int64_t count_86637)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_171956;
    int64_t prim_out_171957;
    int64_t prim_out_171958;
    int64_t prim_out_171959;
    int64_t prim_out_171960;
    int64_t min_arg1_86640 = add64(slo_86633, count_86637);
    int64_t min_res_152193 = smin64(shi_86634, min_arg1_86640);
    int64_t min_arg1_86644 = add64(tlo_86635, count_86637);
    int64_t min_res_152196 = smin64(thi_86636, min_arg1_86644);
    int64_t zp_lhs_86648 = sub64(min_res_152193, slo_86633);
    int64_t zp_rhs_86650 = sub64(min_res_152196, tlo_86635);
    int64_t zm_lhs_86652 = add64(zp_lhs_86648, zp_rhs_86650);
    int64_t slack_86654 = sub64(zm_lhs_86652, count_86637);
    int64_t min_res_152199 = smin64(zp_lhs_86648, slack_86654);
    int64_t min_res_152202 = smin64(zp_rhs_86650, min_res_152199);
    int64_t max_arg1_86664 = sub64(min_res_152193, min_res_152202);
    int64_t max_res_152205 = smax64(slo_86633, max_arg1_86664);
    int64_t max_arg1_86668 = sub64(min_res_152196, min_res_152202);
    int64_t max_res_152208 = smax64(tlo_86635, max_arg1_86668);
    int64_t zm_rhs_86672 = sub64(max_res_152205, slo_86633);
    int64_t zm_lhs_86674 = sub64(count_86637, zm_rhs_86672);
    int64_t zm_rhs_86676 = sub64(max_res_152208, tlo_86635);
    int64_t count_86678 = sub64(zm_lhs_86674, zm_rhs_86676);
    
    prim_out_171956 = max_res_152205;
    prim_out_171957 = min_res_152193;
    prim_out_171958 = max_res_152208;
    prim_out_171959 = min_res_152196;
    prim_out_171960 = count_86678;
    *out_prim_out_172609 = prim_out_171956;
    *out_prim_out_172610 = prim_out_171957;
    *out_prim_out_172611 = prim_out_171958;
    *out_prim_out_172612 = prim_out_171959;
    *out_prim_out_172613 = prim_out_171960;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15578(struct futhark_context *ctx, struct memblock *mem_out_p_172614, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_79649, int64_t n_79650, int32_t n_bits_79651, int64_t psizze_79652)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_171957;
    
    mem_param_tmp_171957.references = NULL;
    
    struct memblock mem_171281;
    
    mem_171281.references = NULL;
    
    struct memblock mem_param_171279;
    
    mem_param_171279.references = NULL;
    
    struct memblock ext_mem_171290;
    
    ext_mem_171290.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int32_t zm_lhs_79656 = add32(8, n_bits_79651);
    int32_t zs_lhs_79658 = sub32(zm_lhs_79656, 1);
    int32_t i32_arg0_79663 = sdiv32(zs_lhs_79658, 8);
    int64_t i32_res_152192 = sext_i32_i64(i32_arg0_79663);
    bool zzero_79667 = i32_res_152192 == (int64_t) 0;
    bool nonzzero_79668 = !zzero_79667;
    bool nonzzero_cert_79669;
    
    if (!nonzzero_79668) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_79670 = sdiv64(psizze_79652, i32_res_152192);
    int64_t max_res_152195 = smax64((int64_t) 1, max_arg1_79670);
    int64_t zm_lhs_79674 = add64(n_79650, max_res_152195);
    int64_t zs_lhs_79676 = sub64(zm_lhs_79674, (int64_t) 1);
    bool zzero_79678 = max_res_152195 == (int64_t) 0;
    bool nonzzero_79679 = !zzero_79678;
    bool nonzzero_cert_79680;
    
    if (!nonzzero_79679) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_79681 = sdiv64(zs_lhs_79676, max_res_152195);
    bool bounds_invalid_upwards_152197 = slt64(max_iter_79681, (int64_t) 0);
    bool valid_152198 = !bounds_invalid_upwards_152197;
    bool range_valid_c_152199;
    
    if (!valid_152198) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_79681, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171280 = (int64_t) 2 * ni_79649;
    
    if (memblock_set(ctx, &mem_param_171279, &dest_mem_171274, "dest_mem_171274") != 0)
        return 1;
    for (int64_t i_79685 = 0; i_79685 < max_iter_79681; i_79685++) {
        int64_t inf_79688 = mul64(i_79685, max_res_152195);
        int64_t min_arg1_79690 = add64(inf_79688, max_res_152195);
        int64_t min_res_152433 = smin64(n_79650, min_arg1_79690);
        
        if (memblock_alloc(ctx, &mem_171281, bytes_171280, "mem_171281")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < ni_79649; i_171003++) {
            int64_t eta_p_152562 = ((int64_t *) is_mem_171276.mem)[i_171003];
            int16_t eta_p_152563 = ((int16_t *) mem_param_171279.mem)[i_171003];
            bool cond_152564 = sle64(inf_79688, eta_p_152562);
            bool cond_t_res_152565 = slt64(eta_p_152562, min_res_152433);
            bool x_152566 = cond_152564 && cond_t_res_152565;
            int16_t lifted_lambda_res_152567;
            
            if (x_152566) {
                bool x_161970 = sle64((int64_t) 0, eta_p_152562);
                bool y_161971 = slt64(eta_p_152562, n_79650);
                bool bounds_check_161972 = x_161970 && y_161971;
                bool index_certs_161973;
                
                if (!bounds_check_161972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_152562, "] out of bounds for array of shape [", (long long) n_79650, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t lifted_lambda_res_t_res_161974 = ((int16_t *) xs_mem_171275.mem)[eta_p_152562];
                
                lifted_lambda_res_152567 = lifted_lambda_res_t_res_161974;
            } else {
                lifted_lambda_res_152567 = eta_p_152563;
            }
            ((int16_t *) mem_171281.mem)[i_171003] = lifted_lambda_res_152567;
        }
        if (memblock_set(ctx, &mem_param_tmp_171957, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171279, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171290, &mem_param_171279, "mem_param_171279") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171290, "ext_mem_171290") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172614, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171290, "ext_mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15590(struct futhark_context *ctx, struct memblock *mem_out_p_172615, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_79901, int64_t n_79902, int32_t n_bits_79903, int64_t psizze_79904)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_171957;
    
    mem_param_tmp_171957.references = NULL;
    
    struct memblock mem_171281;
    
    mem_171281.references = NULL;
    
    struct memblock mem_param_171279;
    
    mem_param_171279.references = NULL;
    
    struct memblock ext_mem_171290;
    
    ext_mem_171290.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int32_t zm_lhs_79908 = add32(8, n_bits_79903);
    int32_t zs_lhs_79910 = sub32(zm_lhs_79908, 1);
    int32_t i32_arg0_79915 = sdiv32(zs_lhs_79910, 8);
    int64_t i32_res_152192 = sext_i32_i64(i32_arg0_79915);
    bool zzero_79919 = i32_res_152192 == (int64_t) 0;
    bool nonzzero_79920 = !zzero_79919;
    bool nonzzero_cert_79921;
    
    if (!nonzzero_79920) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_79922 = sdiv64(psizze_79904, i32_res_152192);
    int64_t max_res_152195 = smax64((int64_t) 1, max_arg1_79922);
    int64_t zm_lhs_79926 = add64(n_79902, max_res_152195);
    int64_t zs_lhs_79928 = sub64(zm_lhs_79926, (int64_t) 1);
    bool zzero_79930 = max_res_152195 == (int64_t) 0;
    bool nonzzero_79931 = !zzero_79930;
    bool nonzzero_cert_79932;
    
    if (!nonzzero_79931) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_79933 = sdiv64(zs_lhs_79928, max_res_152195);
    bool bounds_invalid_upwards_152197 = slt64(max_iter_79933, (int64_t) 0);
    bool valid_152198 = !bounds_invalid_upwards_152197;
    bool range_valid_c_152199;
    
    if (!valid_152198) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_79933, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171280 = (int64_t) 4 * ni_79901;
    
    if (memblock_set(ctx, &mem_param_171279, &dest_mem_171274, "dest_mem_171274") != 0)
        return 1;
    for (int64_t i_79937 = 0; i_79937 < max_iter_79933; i_79937++) {
        int64_t inf_79940 = mul64(i_79937, max_res_152195);
        int64_t min_arg1_79942 = add64(inf_79940, max_res_152195);
        int64_t min_res_152433 = smin64(n_79902, min_arg1_79942);
        
        if (memblock_alloc(ctx, &mem_171281, bytes_171280, "mem_171281")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < ni_79901; i_171003++) {
            int64_t eta_p_152562 = ((int64_t *) is_mem_171276.mem)[i_171003];
            int32_t eta_p_152563 = ((int32_t *) mem_param_171279.mem)[i_171003];
            bool cond_152564 = sle64(inf_79940, eta_p_152562);
            bool cond_t_res_152565 = slt64(eta_p_152562, min_res_152433);
            bool x_152566 = cond_152564 && cond_t_res_152565;
            int32_t lifted_lambda_res_152567;
            
            if (x_152566) {
                bool x_161970 = sle64((int64_t) 0, eta_p_152562);
                bool y_161971 = slt64(eta_p_152562, n_79902);
                bool bounds_check_161972 = x_161970 && y_161971;
                bool index_certs_161973;
                
                if (!bounds_check_161972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_152562, "] out of bounds for array of shape [", (long long) n_79902, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t lifted_lambda_res_t_res_161974 = ((int32_t *) xs_mem_171275.mem)[eta_p_152562];
                
                lifted_lambda_res_152567 = lifted_lambda_res_t_res_161974;
            } else {
                lifted_lambda_res_152567 = eta_p_152563;
            }
            ((int32_t *) mem_171281.mem)[i_171003] = lifted_lambda_res_152567;
        }
        if (memblock_set(ctx, &mem_param_tmp_171957, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171279, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171290, &mem_param_171279, "mem_param_171279") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171290, "ext_mem_171290") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172615, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171290, "ext_mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15601(struct futhark_context *ctx, struct memblock *mem_out_p_172616, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_80153, int64_t n_80154, int32_t n_bits_80155, int64_t psizze_80156)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_171957;
    
    mem_param_tmp_171957.references = NULL;
    
    struct memblock mem_171281;
    
    mem_171281.references = NULL;
    
    struct memblock mem_param_171279;
    
    mem_param_171279.references = NULL;
    
    struct memblock ext_mem_171290;
    
    ext_mem_171290.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int32_t zm_lhs_80160 = add32(8, n_bits_80155);
    int32_t zs_lhs_80162 = sub32(zm_lhs_80160, 1);
    int32_t i32_arg0_80167 = sdiv32(zs_lhs_80162, 8);
    int64_t i32_res_152192 = sext_i32_i64(i32_arg0_80167);
    bool zzero_80171 = i32_res_152192 == (int64_t) 0;
    bool nonzzero_80172 = !zzero_80171;
    bool nonzzero_cert_80173;
    
    if (!nonzzero_80172) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80174 = sdiv64(psizze_80156, i32_res_152192);
    int64_t max_res_152195 = smax64((int64_t) 1, max_arg1_80174);
    int64_t zm_lhs_80178 = add64(n_80154, max_res_152195);
    int64_t zs_lhs_80180 = sub64(zm_lhs_80178, (int64_t) 1);
    bool zzero_80182 = max_res_152195 == (int64_t) 0;
    bool nonzzero_80183 = !zzero_80182;
    bool nonzzero_cert_80184;
    
    if (!nonzzero_80183) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80185 = sdiv64(zs_lhs_80180, max_res_152195);
    bool bounds_invalid_upwards_152197 = slt64(max_iter_80185, (int64_t) 0);
    bool valid_152198 = !bounds_invalid_upwards_152197;
    bool range_valid_c_152199;
    
    if (!valid_152198) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80185, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171280 = (int64_t) 8 * ni_80153;
    
    if (memblock_set(ctx, &mem_param_171279, &dest_mem_171274, "dest_mem_171274") != 0)
        return 1;
    for (int64_t i_80189 = 0; i_80189 < max_iter_80185; i_80189++) {
        int64_t inf_80192 = mul64(i_80189, max_res_152195);
        int64_t min_arg1_80194 = add64(inf_80192, max_res_152195);
        int64_t min_res_152433 = smin64(n_80154, min_arg1_80194);
        
        if (memblock_alloc(ctx, &mem_171281, bytes_171280, "mem_171281")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < ni_80153; i_171003++) {
            int64_t eta_p_152562 = ((int64_t *) is_mem_171276.mem)[i_171003];
            int64_t eta_p_152563 = ((int64_t *) mem_param_171279.mem)[i_171003];
            bool cond_152564 = sle64(inf_80192, eta_p_152562);
            bool cond_t_res_152565 = slt64(eta_p_152562, min_res_152433);
            bool x_152566 = cond_152564 && cond_t_res_152565;
            int64_t lifted_lambda_res_152567;
            
            if (x_152566) {
                bool x_161970 = sle64((int64_t) 0, eta_p_152562);
                bool y_161971 = slt64(eta_p_152562, n_80154);
                bool bounds_check_161972 = x_161970 && y_161971;
                bool index_certs_161973;
                
                if (!bounds_check_161972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_152562, "] out of bounds for array of shape [", (long long) n_80154, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t lifted_lambda_res_t_res_161974 = ((int64_t *) xs_mem_171275.mem)[eta_p_152562];
                
                lifted_lambda_res_152567 = lifted_lambda_res_t_res_161974;
            } else {
                lifted_lambda_res_152567 = eta_p_152563;
            }
            ((int64_t *) mem_171281.mem)[i_171003] = lifted_lambda_res_152567;
        }
        if (memblock_set(ctx, &mem_param_tmp_171957, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171279, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171290, &mem_param_171279, "mem_param_171279") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171290, "ext_mem_171290") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172616, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171290, "ext_mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15613(struct futhark_context *ctx, struct memblock *mem_out_p_172617, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_80405, int64_t n_80406, int32_t n_bits_80407, int64_t psizze_80408)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_171957;
    
    mem_param_tmp_171957.references = NULL;
    
    struct memblock mem_171281;
    
    mem_171281.references = NULL;
    
    struct memblock mem_param_171279;
    
    mem_param_171279.references = NULL;
    
    struct memblock ext_mem_171290;
    
    ext_mem_171290.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int32_t zm_lhs_80412 = add32(8, n_bits_80407);
    int32_t zs_lhs_80414 = sub32(zm_lhs_80412, 1);
    int32_t i32_arg0_80419 = sdiv32(zs_lhs_80414, 8);
    int64_t i32_res_152192 = sext_i32_i64(i32_arg0_80419);
    bool zzero_80423 = i32_res_152192 == (int64_t) 0;
    bool nonzzero_80424 = !zzero_80423;
    bool nonzzero_cert_80425;
    
    if (!nonzzero_80424) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80426 = sdiv64(psizze_80408, i32_res_152192);
    int64_t max_res_152195 = smax64((int64_t) 1, max_arg1_80426);
    int64_t zm_lhs_80430 = add64(n_80406, max_res_152195);
    int64_t zs_lhs_80432 = sub64(zm_lhs_80430, (int64_t) 1);
    bool zzero_80434 = max_res_152195 == (int64_t) 0;
    bool nonzzero_80435 = !zzero_80434;
    bool nonzzero_cert_80436;
    
    if (!nonzzero_80435) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80437 = sdiv64(zs_lhs_80432, max_res_152195);
    bool bounds_invalid_upwards_152197 = slt64(max_iter_80437, (int64_t) 0);
    bool valid_152198 = !bounds_invalid_upwards_152197;
    bool range_valid_c_152199;
    
    if (!valid_152198) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80437, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171280 = (int64_t) 4 * ni_80405;
    
    if (memblock_set(ctx, &mem_param_171279, &dest_mem_171274, "dest_mem_171274") != 0)
        return 1;
    for (int64_t i_80441 = 0; i_80441 < max_iter_80437; i_80441++) {
        int64_t inf_80444 = mul64(i_80441, max_res_152195);
        int64_t min_arg1_80446 = add64(inf_80444, max_res_152195);
        int64_t min_res_152433 = smin64(n_80406, min_arg1_80446);
        
        if (memblock_alloc(ctx, &mem_171281, bytes_171280, "mem_171281")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < ni_80405; i_171003++) {
            int64_t eta_p_152562 = ((int64_t *) is_mem_171276.mem)[i_171003];
            float eta_p_152563 = ((float *) mem_param_171279.mem)[i_171003];
            bool cond_152564 = sle64(inf_80444, eta_p_152562);
            bool cond_t_res_152565 = slt64(eta_p_152562, min_res_152433);
            bool x_152566 = cond_152564 && cond_t_res_152565;
            float lifted_lambda_res_152567;
            
            if (x_152566) {
                bool x_161970 = sle64((int64_t) 0, eta_p_152562);
                bool y_161971 = slt64(eta_p_152562, n_80406);
                bool bounds_check_161972 = x_161970 && y_161971;
                bool index_certs_161973;
                
                if (!bounds_check_161972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_152562, "] out of bounds for array of shape [", (long long) n_80406, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float lifted_lambda_res_t_res_161974 = ((float *) xs_mem_171275.mem)[eta_p_152562];
                
                lifted_lambda_res_152567 = lifted_lambda_res_t_res_161974;
            } else {
                lifted_lambda_res_152567 = eta_p_152563;
            }
            ((float *) mem_171281.mem)[i_171003] = lifted_lambda_res_152567;
        }
        if (memblock_set(ctx, &mem_param_tmp_171957, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171279, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171290, &mem_param_171279, "mem_param_171279") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171290, "ext_mem_171290") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172617, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171290, "ext_mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15625(struct futhark_context *ctx, struct memblock *mem_out_p_172618, struct memblock dest_mem_171274, struct memblock xs_mem_171275, struct memblock is_mem_171276, int64_t ni_80657, int64_t n_80658, int32_t n_bits_80659, int64_t psizze_80660)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_171957;
    
    mem_param_tmp_171957.references = NULL;
    
    struct memblock mem_171281;
    
    mem_171281.references = NULL;
    
    struct memblock mem_param_171279;
    
    mem_param_171279.references = NULL;
    
    struct memblock ext_mem_171290;
    
    ext_mem_171290.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    int32_t zm_lhs_80664 = add32(8, n_bits_80659);
    int32_t zs_lhs_80666 = sub32(zm_lhs_80664, 1);
    int32_t i32_arg0_80671 = sdiv32(zs_lhs_80666, 8);
    int64_t i32_res_152192 = sext_i32_i64(i32_arg0_80671);
    bool zzero_80675 = i32_res_152192 == (int64_t) 0;
    bool nonzzero_80676 = !zzero_80675;
    bool nonzzero_cert_80677;
    
    if (!nonzzero_80676) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80678 = sdiv64(psizze_80660, i32_res_152192);
    int64_t max_res_152195 = smax64((int64_t) 1, max_arg1_80678);
    int64_t zm_lhs_80682 = add64(n_80658, max_res_152195);
    int64_t zs_lhs_80684 = sub64(zm_lhs_80682, (int64_t) 1);
    bool zzero_80686 = max_res_152195 == (int64_t) 0;
    bool nonzzero_80687 = !zzero_80686;
    bool nonzzero_cert_80688;
    
    if (!nonzzero_80687) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80689 = sdiv64(zs_lhs_80684, max_res_152195);
    bool bounds_invalid_upwards_152197 = slt64(max_iter_80689, (int64_t) 0);
    bool valid_152198 = !bounds_invalid_upwards_152197;
    bool range_valid_c_152199;
    
    if (!valid_152198) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80689, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171280 = (int64_t) 8 * ni_80657;
    
    if (memblock_set(ctx, &mem_param_171279, &dest_mem_171274, "dest_mem_171274") != 0)
        return 1;
    for (int64_t i_80693 = 0; i_80693 < max_iter_80689; i_80693++) {
        int64_t inf_80696 = mul64(i_80693, max_res_152195);
        int64_t min_arg1_80698 = add64(inf_80696, max_res_152195);
        int64_t min_res_152433 = smin64(n_80658, min_arg1_80698);
        
        if (memblock_alloc(ctx, &mem_171281, bytes_171280, "mem_171281")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171003 = 0; i_171003 < ni_80657; i_171003++) {
            int64_t eta_p_152562 = ((int64_t *) is_mem_171276.mem)[i_171003];
            double eta_p_152563 = ((double *) mem_param_171279.mem)[i_171003];
            bool cond_152564 = sle64(inf_80696, eta_p_152562);
            bool cond_t_res_152565 = slt64(eta_p_152562, min_res_152433);
            bool x_152566 = cond_152564 && cond_t_res_152565;
            double lifted_lambda_res_152567;
            
            if (x_152566) {
                bool x_161970 = sle64((int64_t) 0, eta_p_152562);
                bool y_161971 = slt64(eta_p_152562, n_80658);
                bool bounds_check_161972 = x_161970 && y_161971;
                bool index_certs_161973;
                
                if (!bounds_check_161972) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_152562, "] out of bounds for array of shape [", (long long) n_80658, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double lifted_lambda_res_t_res_161974 = ((double *) xs_mem_171275.mem)[eta_p_152562];
                
                lifted_lambda_res_152567 = lifted_lambda_res_t_res_161974;
            } else {
                lifted_lambda_res_152567 = eta_p_152563;
            }
            ((double *) mem_171281.mem)[i_171003] = lifted_lambda_res_152567;
        }
        if (memblock_set(ctx, &mem_param_tmp_171957, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171279, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171290, &mem_param_171279, "mem_param_171279") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_171956, &ext_mem_171290, "ext_mem_171290") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172618, &mem_out_171956, "mem_out_171956") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_171957, "mem_param_tmp_171957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171281, "mem_171281") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171279, "mem_param_171279") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171290, "ext_mem_171290") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_171956, "mem_out_171956") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_172619, int32_t bit_81811, int8_t x_81812, int32_t b_81813)
{
    (void) ctx;
    
    int err = 0;
    int8_t prim_out_171956;
    int32_t i32_arg0_81814 = shl32(1, bit_81811);
    int32_t i32_arg_81816 = ~i32_arg0_81814;
    int8_t unsign_arg0_152432 = zext_i32_i8(i32_arg_81816);
    int8_t unsign_arg0_161776 = x_81812 & unsign_arg0_152432;
    int32_t i32_arg0_81821 = shl32(b_81813, bit_81811);
    int8_t unsign_arg0_152434 = zext_i32_i8(i32_arg0_81821);
    int8_t unsign_arg0_161779 = unsign_arg0_152434 | unsign_arg0_161776;
    
    prim_out_171956 = unsign_arg0_161779;
    *out_prim_out_172619 = prim_out_171956;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4)
{
    int64_t nR_140576 = (int64_t) 0;
    int64_t b_140577 = (int64_t) 0;
    int64_t nS_140578 = (int64_t) 0;
    int64_t dz2081U_140579 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580 = (int64_t) 0;
    int32_t radix_sizze_140581 = 0;
    int32_t maxDepth_140586 = 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock last_info_idx_mem_171279;
    
    last_info_idx_mem_171279.references = NULL;
    
    struct memblock first_info_idx_mem_171278;
    
    first_info_idx_mem_171278.references = NULL;
    
    struct memblock depths_mem_171277;
    
    depths_mem_171277.references = NULL;
    
    struct memblock bounds_mem_171276;
    
    bounds_mem_171276.references = NULL;
    
    struct memblock pS_mem_171275;
    
    pS_mem_171275.references = NULL;
    
    struct memblock pR_mem_171274;
    
    pR_mem_171274.references = NULL;
    radix_sizze_140581 = in0;
    pR_mem_171274 = in1->mem;
    nR_140576 = in1->shape[0];
    b_140577 = in1->shape[1];
    pS_mem_171275 = in2->mem;
    nS_140578 = in2->shape[0];
    b_140577 = in2->shape[1];
    bounds_mem_171276 = in3->v0->mem;
    dz2081U_140579 = in3->v0->shape[0];
    depths_mem_171277 = in3->v1->mem;
    dz2081U_140579 = in3->v1->shape[0];
    maxDepth_140586 = in3->v2;
    first_info_idx_mem_171278 = in4->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580 = in4->v0->shape[0];
    last_info_idx_mem_171279 = in4->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580 = in4->v1->shape[0];
    if (!((nR_140576 == in1->shape[0] && b_140577 == in1->shape[1]) && ((nS_140578 == in2->shape[0] && b_140577 == in2->shape[1]) && ((dz2081U_140579 == in3->v0->shape[0] && dz2081U_140579 == in3->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580 == in4->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580 == in4->v1->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, pR_mem_171274, pS_mem_171275, bounds_mem_171276, depths_mem_171277, first_info_idx_mem_171278, last_info_idx_mem_171279, nR_140576, b_140577, nS_140578, dz2081U_140579, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_140580, radix_sizze_140581, maxDepth_140586);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
            (*out0)->v2->shape[1] = b_140577;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4)
{
    int64_t nR_143049 = (int64_t) 0;
    int64_t b_143050 = (int64_t) 0;
    int64_t nS_143051 = (int64_t) 0;
    int64_t dz2081U_143052 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053 = (int64_t) 0;
    int32_t radix_sizze_143054 = 0;
    int32_t maxDepth_143059 = 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock last_info_idx_mem_171279;
    
    last_info_idx_mem_171279.references = NULL;
    
    struct memblock first_info_idx_mem_171278;
    
    first_info_idx_mem_171278.references = NULL;
    
    struct memblock depths_mem_171277;
    
    depths_mem_171277.references = NULL;
    
    struct memblock bounds_mem_171276;
    
    bounds_mem_171276.references = NULL;
    
    struct memblock pS_mem_171275;
    
    pS_mem_171275.references = NULL;
    
    struct memblock pR_mem_171274;
    
    pR_mem_171274.references = NULL;
    radix_sizze_143054 = in0;
    pR_mem_171274 = in1->mem;
    nR_143049 = in1->shape[0];
    b_143050 = in1->shape[1];
    pS_mem_171275 = in2->mem;
    nS_143051 = in2->shape[0];
    b_143050 = in2->shape[1];
    bounds_mem_171276 = in3->v0->mem;
    dz2081U_143052 = in3->v0->shape[0];
    depths_mem_171277 = in3->v1->mem;
    dz2081U_143052 = in3->v1->shape[0];
    maxDepth_143059 = in3->v2;
    first_info_idx_mem_171278 = in4->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053 = in4->v0->shape[0];
    last_info_idx_mem_171279 = in4->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053 = in4->v1->shape[0];
    if (!((nR_143049 == in1->shape[0] && b_143050 == in1->shape[1]) && ((nS_143051 == in2->shape[0] && b_143050 == in2->shape[1]) && ((dz2081U_143052 == in3->v0->shape[0] && dz2081U_143052 == in3->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053 == in4->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053 == in4->v1->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, pR_mem_171274, pS_mem_171275, bounds_mem_171276, depths_mem_171277, first_info_idx_mem_171278, last_info_idx_mem_171279, nR_143049, b_143050, nS_143051, dz2081U_143052, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143053, radix_sizze_143054, maxDepth_143059);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
            (*out0)->v2->shape[1] = b_143050;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2)
{
    int64_t group_noz2081U_152052 = (int64_t) 0;
    int64_t nz2080U_152053 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_152052 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_152052 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_152053 = in2->shape[0];
    if (!(group_noz2081U_152052 == in0->shape[0] && (group_noz2081U_152052 == in1->shape[0] && nz2080U_152053 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_double_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, group_noz2081U_152052, nz2080U_152053);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_152052;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t group_noz2081U_152119 = (int64_t) 0;
    int64_t nz2080U_152120 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171277;
    
    eta_p_mem_171277.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_152119 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_152119 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_152120 = in2->shape[0];
    eta_p_mem_171277 = in3->mem;
    nz2080U_152120 = in3->shape[0];
    if (!(group_noz2081U_152119 == in0->shape[0] && (group_noz2081U_152119 == in1->shape[0] && (nz2080U_152120 == in2->shape[0] && nz2080U_152120 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_double_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, eta_p_mem_171277, group_noz2081U_152119, nz2080U_152120);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_152119;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2)
{
    int64_t group_noz2081U_151611 = (int64_t) 0;
    int64_t nz2080U_151612 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_151611 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_151611 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_151612 = in2->shape[0];
    if (!(group_noz2081U_151611 == in0->shape[0] && (group_noz2081U_151611 == in1->shape[0] && nz2080U_151612 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_float_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, group_noz2081U_151611, nz2080U_151612);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_151611;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t group_noz2081U_151678 = (int64_t) 0;
    int64_t nz2080U_151679 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171277;
    
    eta_p_mem_171277.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_151678 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_151678 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_151679 = in2->shape[0];
    eta_p_mem_171277 = in3->mem;
    nz2080U_151679 = in3->shape[0];
    if (!(group_noz2081U_151678 == in0->shape[0] && (group_noz2081U_151678 == in1->shape[0] && (nz2080U_151679 == in2->shape[0] && nz2080U_151679 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_float_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, eta_p_mem_171277, group_noz2081U_151678, nz2080U_151679);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_151678;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2)
{
    int64_t group_noz2081U_150738 = (int64_t) 0;
    int64_t nz2080U_150739 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_150738 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_150738 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_150739 = in2->shape[0];
    if (!(group_noz2081U_150738 == in0->shape[0] && (group_noz2081U_150738 == in1->shape[0] && nz2080U_150739 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_int_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, group_noz2081U_150738, nz2080U_150739);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_150738;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t group_noz2081U_150805 = (int64_t) 0;
    int64_t nz2080U_150806 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171277;
    
    eta_p_mem_171277.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_150805 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_150805 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_150806 = in2->shape[0];
    eta_p_mem_171277 = in3->mem;
    nz2080U_150806 = in3->shape[0];
    if (!(group_noz2081U_150805 == in0->shape[0] && (group_noz2081U_150805 == in1->shape[0] && (nz2080U_150806 == in2->shape[0] && nz2080U_150806 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_int_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, eta_p_mem_171277, group_noz2081U_150805, nz2080U_150806);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_150805;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2)
{
    int64_t group_noz2081U_151170 = (int64_t) 0;
    int64_t nz2080U_151171 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_151170 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_151170 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_151171 = in2->shape[0];
    if (!(group_noz2081U_151170 == in0->shape[0] && (group_noz2081U_151170 == in1->shape[0] && nz2080U_151171 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_long_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, group_noz2081U_151170, nz2080U_151171);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_151170;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t group_noz2081U_151237 = (int64_t) 0;
    int64_t nz2080U_151238 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171277;
    
    eta_p_mem_171277.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_151237 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_151237 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_151238 = in2->shape[0];
    eta_p_mem_171277 = in3->mem;
    nz2080U_151238 = in3->shape[0];
    if (!(group_noz2081U_151237 == in0->shape[0] && (group_noz2081U_151237 == in1->shape[0] && (nz2080U_151238 == in2->shape[0] && nz2080U_151238 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_long_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, eta_p_mem_171277, group_noz2081U_151237, nz2080U_151238);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_151237;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2)
{
    int64_t group_noz2081U_150306 = (int64_t) 0;
    int64_t nz2080U_150307 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_150306 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_150306 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_150307 = in2->shape[0];
    if (!(group_noz2081U_150306 == in0->shape[0] && (group_noz2081U_150306 == in1->shape[0] && nz2080U_150307 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_short_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, group_noz2081U_150306, nz2080U_150307);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_150306;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t group_noz2081U_150373 = (int64_t) 0;
    int64_t nz2080U_150374 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171277;
    
    eta_p_mem_171277.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    group_noz2081U_150373 = in0->shape[0];
    eta_p_mem_171275 = in1->mem;
    group_noz2081U_150373 = in1->shape[0];
    eta_p_mem_171276 = in2->mem;
    nz2080U_150374 = in2->shape[0];
    eta_p_mem_171277 = in3->mem;
    nz2080U_150374 = in3->shape[0];
    if (!(group_noz2081U_150373 == in0->shape[0] && (group_noz2081U_150373 == in1->shape[0] && (nz2080U_150374 == in2->shape[0] && nz2080U_150374 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_short_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, eta_p_mem_171277, group_noz2081U_150373, nz2080U_150374);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_noz2081U_150373;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0)
{
    int64_t n_79452 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    n_79452 = in0->shape[0];
    if (!(n_79452 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_double(ctx, &prim_out_171956, ks_mem_171274, n_79452);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0)
{
    int64_t n_79275 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    n_79275 = in0->shape[0];
    if (!(n_79275 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_float(ctx, &prim_out_171956, ks_mem_171274, n_79275);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t n_78924 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    n_78924 = in0->shape[0];
    if (!(n_78924 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_int(ctx, &prim_out_171956, ks_mem_171274, n_78924);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t n_79098 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    n_79098 = in0->shape[0];
    if (!(n_79098 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_long(ctx, &prim_out_171956, ks_mem_171274, n_79098);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t n_78750 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    n_78750 = in0->shape[0];
    if (!(n_78750 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_short(ctx, &prim_out_171956, ks_mem_171274, n_78750);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4)
{
    int64_t n_131688 = (int64_t) 0;
    int64_t b_131689 = (int64_t) 0;
    int32_t radix_sizze_131690 = 0;
    int64_t offset_131692 = (int64_t) 0;
    int64_t sizze_thresh_131693 = (int64_t) 0;
    int32_t max_depth_131694 = 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int32_t prim_out_171959 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pXs_mem_171274;
    
    pXs_mem_171274.references = NULL;
    radix_sizze_131690 = in0;
    pXs_mem_171274 = in1->mem;
    n_131688 = in1->shape[0];
    b_131689 = in1->shape[1];
    offset_131692 = in2;
    sizze_thresh_131693 = in3;
    max_depth_131694 = in4;
    if (!(n_131688 == in1->shape[0] && b_131689 == in1->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_partitions_from_partitioned_set(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, &prim_out_171959, pXs_mem_171274, n_131688, b_131689, radix_sizze_131690, offset_131692, sizze_thresh_131693, max_depth_131694);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionInfo *) malloc(sizeof(struct futhark_opaque_partitionInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
            (*out0)->v2 = prim_out_171959;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3)
{
    int64_t n_132270 = (int64_t) 0;
    int64_t b_132271 = (int64_t) 0;
    int64_t dz2080U_132272 = (int64_t) 0;
    int64_t dz2081U_132273 = (int64_t) 0;
    int32_t radix_sizze_132274 = 0;
    int32_t maxDepth_132278 = 0;
    int64_t scatter_psizze_132279 = (int64_t) 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock depths_mem_171276;
    
    depths_mem_171276.references = NULL;
    
    struct memblock bounds_mem_171275;
    
    bounds_mem_171275.references = NULL;
    
    struct memblock pXs_mem_171274;
    
    pXs_mem_171274.references = NULL;
    radix_sizze_132274 = in0;
    pXs_mem_171274 = in1->mem;
    n_132270 = in1->shape[0];
    b_132271 = in1->shape[1];
    bounds_mem_171275 = in2->v0->mem;
    dz2080U_132272 = in2->v0->shape[0];
    depths_mem_171276 = in2->v1->mem;
    dz2081U_132273 = in2->v1->shape[0];
    maxDepth_132278 = in2->v2;
    scatter_psizze_132279 = in3;
    if (!((n_132270 == in1->shape[0] && b_132271 == in1->shape[1]) && (dz2080U_132272 == in2->v0->shape[0] && dz2081U_132273 == in2->v1->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_create_hash_table_from_partitioned_set(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, pXs_mem_171274, bounds_mem_171275, depths_mem_171276, n_132270, b_132271, dz2080U_132272, dz2081U_132273, radix_sizze_132274, maxDepth_132278, scatter_psizze_132279);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_radix_hashTable *) malloc(sizeof(struct futhark_opaque_radix_hashTable))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2)
{
    int64_t nz2080U_149856 = (int64_t) 0;
    int64_t group_no_149857 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149857 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149856 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149856 = in2->shape[0];
    if (!(nz2080U_149856 == in1->shape[0] && nz2080U_149856 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_double_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, nz2080U_149856, group_no_149857);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149857;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t nz2080U_149933 = (int64_t) 0;
    int64_t group_no_149934 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149934 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149933 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149933 = in2->shape[0];
    eta_p_mem_171276 = in3->mem;
    nz2080U_149933 = in3->shape[0];
    if (!(nz2080U_149933 == in1->shape[0] && (nz2080U_149933 == in2->shape[0] && nz2080U_149933 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_double_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, nz2080U_149933, group_no_149934);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149934;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1)
{
    int64_t nz2082U_143157 = (int64_t) 0;
    int64_t key_no_143158 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    key_no_143158 = in0;
    ks_mem_171274 = in1->mem;
    nz2082U_143157 = in1->shape[0];
    if (!(nz2082U_143157 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_find_known_key_counts_long(ctx, &mem_out_171956, ks_mem_171274, nz2082U_143157, key_no_143158);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = key_no_143158;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2)
{
    int64_t nz2080U_149645 = (int64_t) 0;
    int64_t group_no_149646 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149646 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149645 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149645 = in2->shape[0];
    if (!(nz2080U_149645 == in1->shape[0] && nz2080U_149645 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_float_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, nz2080U_149645, group_no_149646);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149646;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t nz2080U_149722 = (int64_t) 0;
    int64_t group_no_149723 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149723 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149722 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149722 = in2->shape[0];
    eta_p_mem_171276 = in3->mem;
    nz2080U_149722 = in3->shape[0];
    if (!(nz2080U_149722 == in1->shape[0] && (nz2080U_149722 == in2->shape[0] && nz2080U_149722 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_float_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, nz2080U_149722, group_no_149723);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149723;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4)
{
    int64_t niz2084U_81485 = (int64_t) 0;
    int64_t dz2083U_81486 = (int64_t) 0;
    int64_t incr_81487 = (int64_t) 0;
    int64_t psizze_81488 = (int64_t) 0;
    int64_t pL_bytes_81490 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_81487 = in0;
    psizze_81488 = in1;
    is_mem_171274 = in2->mem;
    niz2084U_81485 = in2->shape[0];
    pL_bytes_81490 = in3;
    ys_mem_171275 = in4->mem;
    dz2083U_81486 = in4->shape[0];
    if (!(niz2084U_81485 == in2->shape[0] && (dz2083U_81486 == in4->shape[0] && pL_bytes_81490 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_GFTR(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, niz2084U_81485, dz2083U_81486, incr_81487, psizze_81488, pL_bytes_81490);
        if (ret == 0) {
            assert((*out0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = niz2084U_81485;
            (*out0)->shape[1] = pL_bytes_81490;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t niz2084U_81118 = (int64_t) 0;
    int64_t dz2083U_81119 = (int64_t) 0;
    int64_t incr_81120 = (int64_t) 0;
    int64_t psizze_81121 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_81120 = in0;
    psizze_81121 = in1;
    is_mem_171274 = in2->mem;
    niz2084U_81118 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    dz2083U_81119 = in3->shape[0];
    if (!(niz2084U_81118 == in2->shape[0] && dz2083U_81119 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, niz2084U_81118, dz2083U_81119, incr_81120, psizze_81121);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = niz2084U_81118;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4)
{
    int64_t ni_81773 = (int64_t) 0;
    int64_t n_81774 = (int64_t) 0;
    int64_t incr_81775 = (int64_t) 0;
    int64_t psizze_81776 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171276;
    
    ys_mem_171276.references = NULL;
    
    struct memblock is_mem_171275;
    
    is_mem_171275.references = NULL;
    
    struct memblock preVals_mem_171274;
    
    preVals_mem_171274.references = NULL;
    incr_81775 = in0;
    psizze_81776 = in1;
    preVals_mem_171274 = in2->mem;
    ni_81773 = in2->shape[0];
    is_mem_171275 = in3->mem;
    ni_81773 = in3->shape[0];
    ys_mem_171276 = in4->mem;
    n_81774 = in4->shape[0];
    if (!(ni_81773 == in2->shape[0] && (ni_81773 == in3->shape[0] && n_81774 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double_GFUR(ctx, &mem_out_171956, preVals_mem_171274, is_mem_171275, ys_mem_171276, ni_81773, n_81774, incr_81775, psizze_81776);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = ni_81773;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t niz2084U_81053 = (int64_t) 0;
    int64_t dz2083U_81054 = (int64_t) 0;
    int64_t incr_81055 = (int64_t) 0;
    int64_t psizze_81056 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_81055 = in0;
    psizze_81056 = in1;
    is_mem_171274 = in2->mem;
    niz2084U_81053 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    dz2083U_81054 = in3->shape[0];
    if (!(niz2084U_81053 == in2->shape[0] && dz2083U_81054 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, niz2084U_81053, dz2083U_81054, incr_81055, psizze_81056);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = niz2084U_81053;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4)
{
    int64_t ni_81716 = (int64_t) 0;
    int64_t n_81717 = (int64_t) 0;
    int64_t incr_81718 = (int64_t) 0;
    int64_t psizze_81719 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171276;
    
    ys_mem_171276.references = NULL;
    
    struct memblock is_mem_171275;
    
    is_mem_171275.references = NULL;
    
    struct memblock preVals_mem_171274;
    
    preVals_mem_171274.references = NULL;
    incr_81718 = in0;
    psizze_81719 = in1;
    preVals_mem_171274 = in2->mem;
    ni_81716 = in2->shape[0];
    is_mem_171275 = in3->mem;
    ni_81716 = in3->shape[0];
    ys_mem_171276 = in4->mem;
    n_81717 = in4->shape[0];
    if (!(ni_81716 == in2->shape[0] && (ni_81716 == in3->shape[0] && n_81717 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float_GFUR(ctx, &mem_out_171956, preVals_mem_171274, is_mem_171275, ys_mem_171276, ni_81716, n_81717, incr_81718, psizze_81719);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = ni_81716;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t niz2084U_80923 = (int64_t) 0;
    int64_t dz2083U_80924 = (int64_t) 0;
    int64_t incr_80925 = (int64_t) 0;
    int64_t psizze_80926 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80925 = in0;
    psizze_80926 = in1;
    is_mem_171274 = in2->mem;
    niz2084U_80923 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    dz2083U_80924 = in3->shape[0];
    if (!(niz2084U_80923 == in2->shape[0] && dz2083U_80924 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, niz2084U_80923, dz2083U_80924, incr_80925, psizze_80926);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = niz2084U_80923;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4)
{
    int64_t ni_81602 = (int64_t) 0;
    int64_t n_81603 = (int64_t) 0;
    int64_t incr_81604 = (int64_t) 0;
    int64_t psizze_81605 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171276;
    
    ys_mem_171276.references = NULL;
    
    struct memblock is_mem_171275;
    
    is_mem_171275.references = NULL;
    
    struct memblock preVals_mem_171274;
    
    preVals_mem_171274.references = NULL;
    incr_81604 = in0;
    psizze_81605 = in1;
    preVals_mem_171274 = in2->mem;
    ni_81602 = in2->shape[0];
    is_mem_171275 = in3->mem;
    ni_81602 = in3->shape[0];
    ys_mem_171276 = in4->mem;
    n_81603 = in4->shape[0];
    if (!(ni_81602 == in2->shape[0] && (ni_81602 == in3->shape[0] && n_81603 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int_GFUR(ctx, &mem_out_171956, preVals_mem_171274, is_mem_171275, ys_mem_171276, ni_81602, n_81603, incr_81604, psizze_81605);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = ni_81602;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t niz2084U_80988 = (int64_t) 0;
    int64_t dz2083U_80989 = (int64_t) 0;
    int64_t incr_80990 = (int64_t) 0;
    int64_t psizze_80991 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80990 = in0;
    psizze_80991 = in1;
    is_mem_171274 = in2->mem;
    niz2084U_80988 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    dz2083U_80989 = in3->shape[0];
    if (!(niz2084U_80988 == in2->shape[0] && dz2083U_80989 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, niz2084U_80988, dz2083U_80989, incr_80990, psizze_80991);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = niz2084U_80988;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4)
{
    int64_t ni_81659 = (int64_t) 0;
    int64_t n_81660 = (int64_t) 0;
    int64_t incr_81661 = (int64_t) 0;
    int64_t psizze_81662 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171276;
    
    ys_mem_171276.references = NULL;
    
    struct memblock is_mem_171275;
    
    is_mem_171275.references = NULL;
    
    struct memblock preVals_mem_171274;
    
    preVals_mem_171274.references = NULL;
    incr_81661 = in0;
    psizze_81662 = in1;
    preVals_mem_171274 = in2->mem;
    ni_81659 = in2->shape[0];
    is_mem_171275 = in3->mem;
    ni_81659 = in3->shape[0];
    ys_mem_171276 = in4->mem;
    n_81660 = in4->shape[0];
    if (!(ni_81659 == in2->shape[0] && (ni_81659 == in3->shape[0] && n_81660 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long_GFUR(ctx, &mem_out_171956, preVals_mem_171274, is_mem_171275, ys_mem_171276, ni_81659, n_81660, incr_81661, psizze_81662);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = ni_81659;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t niz2084U_80858 = (int64_t) 0;
    int64_t dz2083U_80859 = (int64_t) 0;
    int64_t incr_80860 = (int64_t) 0;
    int64_t psizze_80861 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80860 = in0;
    psizze_80861 = in1;
    is_mem_171274 = in2->mem;
    niz2084U_80858 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    dz2083U_80859 = in3->shape[0];
    if (!(niz2084U_80858 == in2->shape[0] && dz2083U_80859 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, niz2084U_80858, dz2083U_80859, incr_80860, psizze_80861);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = niz2084U_80858;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4)
{
    int64_t ni_81545 = (int64_t) 0;
    int64_t n_81546 = (int64_t) 0;
    int64_t incr_81547 = (int64_t) 0;
    int64_t psizze_81548 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171276;
    
    ys_mem_171276.references = NULL;
    
    struct memblock is_mem_171275;
    
    is_mem_171275.references = NULL;
    
    struct memblock preVals_mem_171274;
    
    preVals_mem_171274.references = NULL;
    incr_81547 = in0;
    psizze_81548 = in1;
    preVals_mem_171274 = in2->mem;
    ni_81545 = in2->shape[0];
    is_mem_171275 = in3->mem;
    ni_81545 = in3->shape[0];
    ys_mem_171276 = in4->mem;
    n_81546 = in4->shape[0];
    if (!(ni_81545 == in2->shape[0] && (ni_81545 == in3->shape[0] && n_81546 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short_GFUR(ctx, &mem_out_171956, preVals_mem_171274, is_mem_171275, ys_mem_171276, ni_81545, n_81546, incr_81547, psizze_81548);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = ni_81545;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_126913 = (int64_t) 0;
    int64_t nS_126914 = (int64_t) 0;
    int64_t offset_R_126917 = (int64_t) 0;
    int64_t offset_S_126918 = (int64_t) 0;
    int64_t partitionSizze_126919 = (int64_t) 0;
    int64_t scatter_psizze_126920 = (int64_t) 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock tS_mem_171275;
    
    tS_mem_171275.references = NULL;
    
    struct memblock tR_mem_171274;
    
    tR_mem_171274.references = NULL;
    tR_mem_171274 = in0->mem;
    nR_126913 = in0->shape[0];
    tS_mem_171275 = in1->mem;
    nS_126914 = in1->shape[0];
    offset_R_126917 = in2;
    offset_S_126918 = in3;
    partitionSizze_126919 = in4;
    scatter_psizze_126920 = in5;
    if (!(nR_126913 == in0->shape[0] && nS_126914 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_double(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, tR_mem_171274, tS_mem_171275, nR_126913, nS_126914, offset_R_126917, offset_S_126918, partitionSizze_126919, scatter_psizze_126920);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_double *) malloc(sizeof(struct futhark_opaque_joinPairs_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_124250 = (int64_t) 0;
    int64_t nS_124251 = (int64_t) 0;
    int64_t offset_R_124254 = (int64_t) 0;
    int64_t offset_S_124255 = (int64_t) 0;
    int64_t partitionSizze_124256 = (int64_t) 0;
    int64_t scatter_psizze_124257 = (int64_t) 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock tS_mem_171275;
    
    tS_mem_171275.references = NULL;
    
    struct memblock tR_mem_171274;
    
    tR_mem_171274.references = NULL;
    tR_mem_171274 = in0->mem;
    nR_124250 = in0->shape[0];
    tS_mem_171275 = in1->mem;
    nS_124251 = in1->shape[0];
    offset_R_124254 = in2;
    offset_S_124255 = in3;
    partitionSizze_124256 = in4;
    scatter_psizze_124257 = in5;
    if (!(nR_124250 == in0->shape[0] && nS_124251 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_float(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, tR_mem_171274, tS_mem_171275, nR_124250, nS_124251, offset_R_124254, offset_S_124255, partitionSizze_124256, scatter_psizze_124257);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_float *) malloc(sizeof(struct futhark_opaque_joinPairs_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_118936 = (int64_t) 0;
    int64_t nS_118937 = (int64_t) 0;
    int64_t offset_R_118940 = (int64_t) 0;
    int64_t offset_S_118941 = (int64_t) 0;
    int64_t partitionSizze_118942 = (int64_t) 0;
    int64_t scatter_psizze_118943 = (int64_t) 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock tS_mem_171275;
    
    tS_mem_171275.references = NULL;
    
    struct memblock tR_mem_171274;
    
    tR_mem_171274.references = NULL;
    tR_mem_171274 = in0->mem;
    nR_118936 = in0->shape[0];
    tS_mem_171275 = in1->mem;
    nS_118937 = in1->shape[0];
    offset_R_118940 = in2;
    offset_S_118941 = in3;
    partitionSizze_118942 = in4;
    scatter_psizze_118943 = in5;
    if (!(nR_118936 == in0->shape[0] && nS_118937 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_int(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, tR_mem_171274, tS_mem_171275, nR_118936, nS_118937, offset_R_118940, offset_S_118941, partitionSizze_118942, scatter_psizze_118943);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_int *) malloc(sizeof(struct futhark_opaque_joinPairs_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_121587 = (int64_t) 0;
    int64_t nS_121588 = (int64_t) 0;
    int64_t offset_R_121591 = (int64_t) 0;
    int64_t offset_S_121592 = (int64_t) 0;
    int64_t partitionSizze_121593 = (int64_t) 0;
    int64_t scatter_psizze_121594 = (int64_t) 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock tS_mem_171275;
    
    tS_mem_171275.references = NULL;
    
    struct memblock tR_mem_171274;
    
    tR_mem_171274.references = NULL;
    tR_mem_171274 = in0->mem;
    nR_121587 = in0->shape[0];
    tS_mem_171275 = in1->mem;
    nS_121588 = in1->shape[0];
    offset_R_121591 = in2;
    offset_S_121592 = in3;
    partitionSizze_121593 = in4;
    scatter_psizze_121594 = in5;
    if (!(nR_121587 == in0->shape[0] && nS_121588 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_long(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, tR_mem_171274, tS_mem_171275, nR_121587, nS_121588, offset_R_121591, offset_S_121592, partitionSizze_121593, scatter_psizze_121594);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_long *) malloc(sizeof(struct futhark_opaque_joinPairs_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_116273 = (int64_t) 0;
    int64_t nS_116274 = (int64_t) 0;
    int64_t offset_R_116277 = (int64_t) 0;
    int64_t offset_S_116278 = (int64_t) 0;
    int64_t partitionSizze_116279 = (int64_t) 0;
    int64_t scatter_psizze_116280 = (int64_t) 0;
    int64_t prim_out_171959 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171958;
    
    mem_out_171958.references = NULL;
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock tS_mem_171275;
    
    tS_mem_171275.references = NULL;
    
    struct memblock tR_mem_171274;
    
    tR_mem_171274.references = NULL;
    tR_mem_171274 = in0->mem;
    nR_116273 = in0->shape[0];
    tS_mem_171275 = in1->mem;
    nS_116274 = in1->shape[0];
    offset_R_116277 = in2;
    offset_S_116278 = in3;
    partitionSizze_116279 = in4;
    scatter_psizze_116280 = in5;
    if (!(nR_116273 == in0->shape[0] && nS_116274 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_short(ctx, &mem_out_171956, &mem_out_171957, &mem_out_171958, &prim_out_171959, tR_mem_171274, tS_mem_171275, nR_116273, nS_116274, offset_R_116277, offset_S_116278, partitionSizze_116279, scatter_psizze_116280);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_short *) malloc(sizeof(struct futhark_opaque_joinPairs_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171959;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171959;
            assert(((*out0)->v2 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v2->mem = mem_out_171958;
            (*out0)->v2->shape[0] = prim_out_171959;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2)
{
    int64_t nz2080U_149236 = (int64_t) 0;
    int64_t group_no_149237 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149237 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149236 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149236 = in2->shape[0];
    if (!(nz2080U_149236 == in1->shape[0] && nz2080U_149236 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_int_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, nz2080U_149236, group_no_149237);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149237;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t nz2080U_149313 = (int64_t) 0;
    int64_t group_no_149314 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149314 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149313 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149313 = in2->shape[0];
    eta_p_mem_171276 = in3->mem;
    nz2080U_149313 = in3->shape[0];
    if (!(nz2080U_149313 == in1->shape[0] && (nz2080U_149313 == in2->shape[0] && nz2080U_149313 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_int_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, nz2080U_149313, group_no_149314);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149314;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2)
{
    int64_t nz2080U_149442 = (int64_t) 0;
    int64_t group_no_149443 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149443 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149442 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149442 = in2->shape[0];
    if (!(nz2080U_149442 == in1->shape[0] && nz2080U_149442 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_long_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, nz2080U_149442, group_no_149443);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149443;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t nz2080U_149509 = (int64_t) 0;
    int64_t group_no_149510 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149510 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149509 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149509 = in2->shape[0];
    eta_p_mem_171276 = in3->mem;
    nz2080U_149509 = in3->shape[0];
    if (!(nz2080U_149509 == in1->shape[0] && (nz2080U_149509 == in2->shape[0] && nz2080U_149509 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_long_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, nz2080U_149509, group_no_149510);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149510;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_79529 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    nz2080U_79529 = in0->shape[0];
    if (!(nz2080U_79529 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_max_idx(ctx, &prim_out_171956, eta_p_mem_171274, nz2080U_79529);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1)
{
    int64_t n_113368 = (int64_t) 0;
    int64_t incr_113369 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_113369 = in0;
    xs_mem_171274 = in1->mem;
    n_113368 = in1->shape[0];
    if (!(n_113368 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_double(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_113368, incr_113369);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_113368;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_113368;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1)
{
    int64_t n_111223 = (int64_t) 0;
    int64_t incr_111224 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_111224 = in0;
    xs_mem_171274 = in1->mem;
    n_111223 = in1->shape[0];
    if (!(n_111223 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_float(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_111223, incr_111224);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_111223;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_111223;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1)
{
    int64_t n_106937 = (int64_t) 0;
    int64_t incr_106938 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_106938 = in0;
    xs_mem_171274 = in1->mem;
    n_106937 = in1->shape[0];
    if (!(n_106937 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_int(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_106937, incr_106938);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_106937;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_106937;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1)
{
    int64_t n_109078 = (int64_t) 0;
    int64_t incr_109079 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_109079 = in0;
    xs_mem_171274 = in1->mem;
    n_109078 = in1->shape[0];
    if (!(n_109078 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_long(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_109078, incr_109079);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_109078;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_109078;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1)
{
    int64_t n_104792 = (int64_t) 0;
    int64_t incr_104793 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_104793 = in0;
    xs_mem_171274 = in1->mem;
    n_104792 = in1->shape[0];
    if (!(n_104792 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_short(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_104792, incr_104793);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_104792;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_104792;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0)
{
    int64_t n_98299 = (int64_t) 0;
    int64_t b_98300 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    k_mem_171274 = in0->v0->mem;
    n_98299 = in0->v0->shape[0];
    pL_mem_171275 = in0->v1->mem;
    n_98299 = in0->v1->shape[0];
    b_98300 = in0->v1->shape[1];
    if (!(n_98299 == in0->v0->shape[0] && (n_98299 == in0->v1->shape[0] && b_98300 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_double(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_98299, b_98300);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_98299;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_98299;
            (*out0)->v1->shape[1] = b_98300;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0)
{
    int64_t n_95934 = (int64_t) 0;
    int64_t b_95935 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    k_mem_171274 = in0->v0->mem;
    n_95934 = in0->v0->shape[0];
    pL_mem_171275 = in0->v1->mem;
    n_95934 = in0->v1->shape[0];
    b_95935 = in0->v1->shape[1];
    if (!(n_95934 == in0->v0->shape[0] && (n_95934 == in0->v1->shape[0] && b_95935 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_float(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_95934, b_95935);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_95934;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_95934;
            (*out0)->v1->shape[1] = b_95935;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0)
{
    int64_t n_91210 = (int64_t) 0;
    int64_t b_91211 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    k_mem_171274 = in0->v0->mem;
    n_91210 = in0->v0->shape[0];
    pL_mem_171275 = in0->v1->mem;
    n_91210 = in0->v1->shape[0];
    b_91211 = in0->v1->shape[1];
    if (!(n_91210 == in0->v0->shape[0] && (n_91210 == in0->v1->shape[0] && b_91211 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_int(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_91210, b_91211);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_91210;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_91210;
            (*out0)->v1->shape[1] = b_91211;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0)
{
    int64_t n_93569 = (int64_t) 0;
    int64_t b_93570 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    k_mem_171274 = in0->v0->mem;
    n_93569 = in0->v0->shape[0];
    pL_mem_171275 = in0->v1->mem;
    n_93569 = in0->v1->shape[0];
    b_93570 = in0->v1->shape[1];
    if (!(n_93569 == in0->v0->shape[0] && (n_93569 == in0->v1->shape[0] && b_93570 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_long(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_93569, b_93570);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_93569;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_93569;
            (*out0)->v1->shape[1] = b_93570;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0)
{
    int64_t n_88845 = (int64_t) 0;
    int64_t b_88846 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    k_mem_171274 = in0->v0->mem;
    n_88845 = in0->v0->shape[0];
    pL_mem_171275 = in0->v1->mem;
    n_88845 = in0->v1->shape[0];
    b_88846 = in0->v1->shape[1];
    if (!(n_88845 == in0->v0->shape[0] && (n_88845 == in0->v1->shape[0] && b_88846 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_short(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_88845, b_88846);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_88845;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_88845;
            (*out0)->v1->shape[1] = b_88846;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_79489 = (int64_t) 0;
    int64_t prim_out_171956 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    eta_p_mem_171274 = in0->mem;
    nz2080U_79489 = in0->shape[0];
    if (!(nz2080U_79489 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_min_idx(ctx, &prim_out_171956, eta_p_mem_171274, nz2080U_79489);
        if (ret == 0) {
            *out0 = prim_out_171956;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t n_80791 = (int64_t) 0;
    int64_t incr_80792 = (int64_t) 0;
    int64_t block_sizze_80793 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80792 = in0;
    block_sizze_80793 = in1;
    is_mem_171274 = in2->mem;
    n_80791 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    n_80791 = in3->shape[0];
    if (!(n_80791 == in2->shape[0] && n_80791 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_double(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, n_80791, incr_80792, block_sizze_80793);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = n_80791;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t n_80539 = (int64_t) 0;
    int64_t incr_80540 = (int64_t) 0;
    int64_t block_sizze_80541 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80540 = in0;
    block_sizze_80541 = in1;
    is_mem_171274 = in2->mem;
    n_80539 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    n_80539 = in3->shape[0];
    if (!(n_80539 == in2->shape[0] && n_80539 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_float(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, n_80539, incr_80540, block_sizze_80541);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = n_80539;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t n_80035 = (int64_t) 0;
    int64_t incr_80036 = (int64_t) 0;
    int64_t block_sizze_80037 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80036 = in0;
    block_sizze_80037 = in1;
    is_mem_171274 = in2->mem;
    n_80035 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    n_80035 = in3->shape[0];
    if (!(n_80035 == in2->shape[0] && n_80035 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_int(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, n_80035, incr_80036, block_sizze_80037);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = n_80035;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t n_80287 = (int64_t) 0;
    int64_t incr_80288 = (int64_t) 0;
    int64_t block_sizze_80289 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_80288 = in0;
    block_sizze_80289 = in1;
    is_mem_171274 = in2->mem;
    n_80287 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    n_80287 = in3->shape[0];
    if (!(n_80287 == in2->shape[0] && n_80287 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_long(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, n_80287, incr_80288, block_sizze_80289);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = n_80287;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t n_79783 = (int64_t) 0;
    int64_t incr_79784 = (int64_t) 0;
    int64_t block_sizze_79785 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ys_mem_171275;
    
    ys_mem_171275.references = NULL;
    
    struct memblock is_mem_171274;
    
    is_mem_171274.references = NULL;
    incr_79784 = in0;
    block_sizze_79785 = in1;
    is_mem_171274 = in2->mem;
    n_79783 = in2->shape[0];
    ys_mem_171275 = in3->mem;
    n_79783 = in3->shape[0];
    if (!(n_79783 == in2->shape[0] && n_79783 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_short(ctx, &mem_out_171956, is_mem_171274, ys_mem_171275, n_79783, incr_79784, block_sizze_79785);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = n_79783;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6, const int32_t in7)
{
    int64_t n_129492 = (int64_t) 0;
    int64_t b_129493 = (int64_t) 0;
    int64_t pL_b_129494 = (int64_t) 0;
    int16_t block_sizze_129495 = (int16_t) 0;
    int64_t gather_psizze_129496 = (int64_t) 0;
    int32_t radix_sizze_129497 = 0;
    int64_t sizze_thresh_129500 = (int64_t) 0;
    int32_t max_depth_129501 = 0;
    int32_t bit_step_129502 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    block_sizze_129495 = in0;
    gather_psizze_129496 = in1;
    radix_sizze_129497 = in2;
    xs_mem_171274 = in3->mem;
    n_129492 = in3->shape[0];
    b_129493 = in3->shape[1];
    pL_mem_171275 = in4->mem;
    n_129492 = in4->shape[0];
    pL_b_129494 = in4->shape[1];
    sizze_thresh_129500 = in5;
    max_depth_129501 = in6;
    bit_step_129502 = in7;
    if (!((n_129492 == in3->shape[0] && b_129493 == in3->shape[1]) && (n_129492 == in4->shape[0] && pL_b_129494 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFTR(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, pL_mem_171275, n_129492, b_129493, pL_b_129494, block_sizze_129495, gather_psizze_129496, radix_sizze_129497, sizze_thresh_129500, max_depth_129501, bit_step_129502);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFTR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_129492;
            (*out0)->v0->shape[1] = b_129493;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_129492;
            (*out0)->v1->shape[1] = pL_b_129494;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6, const int32_t in7)
{
    int64_t n_130862 = (int64_t) 0;
    int64_t b_130863 = (int64_t) 0;
    int16_t block_sizze_130864 = (int16_t) 0;
    int64_t gather_psizze_130865 = (int64_t) 0;
    int32_t radix_sizze_130866 = 0;
    int64_t offset_130868 = (int64_t) 0;
    int64_t sizze_thresh_130869 = (int64_t) 0;
    int32_t max_depth_130870 = 0;
    int32_t bit_step_130871 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    block_sizze_130864 = in0;
    gather_psizze_130865 = in1;
    radix_sizze_130866 = in2;
    xs_mem_171274 = in3->mem;
    n_130862 = in3->shape[0];
    b_130863 = in3->shape[1];
    offset_130868 = in4;
    sizze_thresh_130869 = in5;
    max_depth_130870 = in6;
    bit_step_130871 = in7;
    if (!(n_130862 == in3->shape[0] && b_130863 == in3->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFUR(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_130862, b_130863, block_sizze_130864, gather_psizze_130865, radix_sizze_130866, offset_130868, sizze_thresh_130869, max_depth_130870, bit_step_130871);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFUR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_130862;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_130862;
            (*out0)->v1->shape[1] = b_130863;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2)
{
    int64_t n_102646 = (int64_t) 0;
    int64_t incr_102647 = (int64_t) 0;
    int64_t block_sizze_102648 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_102647 = in0;
    block_sizze_102648 = in1;
    xs_mem_171274 = in2->mem;
    n_102646 = in2->shape[0];
    if (!(n_102646 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_double(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_102646, incr_102647, block_sizze_102648);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_102646;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_102646;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2)
{
    int64_t n_101764 = (int64_t) 0;
    int64_t incr_101765 = (int64_t) 0;
    int64_t block_sizze_101766 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_101765 = in0;
    block_sizze_101766 = in1;
    xs_mem_171274 = in2->mem;
    n_101764 = in2->shape[0];
    if (!(n_101764 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_float(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_101764, incr_101765, block_sizze_101766);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_101764;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_101764;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2)
{
    int64_t n_100021 = (int64_t) 0;
    int64_t incr_100022 = (int64_t) 0;
    int64_t block_sizze_100023 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_100022 = in0;
    block_sizze_100023 = in1;
    xs_mem_171274 = in2->mem;
    n_100021 = in2->shape[0];
    if (!(n_100021 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_int(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_100021, incr_100022, block_sizze_100023);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_100021;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_100021;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2)
{
    int64_t n_100882 = (int64_t) 0;
    int64_t incr_100883 = (int64_t) 0;
    int64_t block_sizze_100884 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_100883 = in0;
    block_sizze_100884 = in1;
    xs_mem_171274 = in2->mem;
    n_100882 = in2->shape[0];
    if (!(n_100882 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_long(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_100882, incr_100883, block_sizze_100884);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_100882;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_100882;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2)
{
    int64_t n_99160 = (int64_t) 0;
    int64_t incr_99161 = (int64_t) 0;
    int64_t block_sizze_99162 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock xs_mem_171274;
    
    xs_mem_171274.references = NULL;
    incr_99161 = in0;
    block_sizze_99162 = in1;
    xs_mem_171274 = in2->mem;
    n_99160 = in2->shape[0];
    if (!(n_99160 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_short(ctx, &mem_out_171956, &mem_out_171957, xs_mem_171274, n_99160, incr_99161, block_sizze_99162);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_99160;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_99160;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int64_t in0, const struct futhark_opaque_sortStruct_double *in1)
{
    int64_t n_86374 = (int64_t) 0;
    int64_t b_86375 = (int64_t) 0;
    int64_t block_sizze_86376 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    block_sizze_86376 = in0;
    k_mem_171274 = in1->v0->mem;
    n_86374 = in1->v0->shape[0];
    pL_mem_171275 = in1->v1->mem;
    n_86374 = in1->v1->shape[0];
    b_86375 = in1->v1->shape[1];
    if (!(n_86374 == in1->v0->shape[0] && (n_86374 == in1->v1->shape[0] && b_86375 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_double(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_86374, b_86375, block_sizze_86376);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_86374;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_86374;
            (*out0)->v1->shape[1] = b_86375;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int64_t in0, const struct futhark_opaque_sortStruct_float *in1)
{
    int64_t n_85431 = (int64_t) 0;
    int64_t b_85432 = (int64_t) 0;
    int64_t block_sizze_85433 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    block_sizze_85433 = in0;
    k_mem_171274 = in1->v0->mem;
    n_85431 = in1->v0->shape[0];
    pL_mem_171275 = in1->v1->mem;
    n_85431 = in1->v1->shape[0];
    b_85432 = in1->v1->shape[1];
    if (!(n_85431 == in1->v0->shape[0] && (n_85431 == in1->v1->shape[0] && b_85432 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_float(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_85431, b_85432, block_sizze_85433);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_85431;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_85431;
            (*out0)->v1->shape[1] = b_85432;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int64_t in0, const struct futhark_opaque_sortStruct_int *in1)
{
    int64_t n_83613 = (int64_t) 0;
    int64_t b_83614 = (int64_t) 0;
    int64_t block_sizze_83615 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    block_sizze_83615 = in0;
    k_mem_171274 = in1->v0->mem;
    n_83613 = in1->v0->shape[0];
    pL_mem_171275 = in1->v1->mem;
    n_83613 = in1->v1->shape[0];
    b_83614 = in1->v1->shape[1];
    if (!(n_83613 == in1->v0->shape[0] && (n_83613 == in1->v1->shape[0] && b_83614 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_int(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_83613, b_83614, block_sizze_83615);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_83613;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_83613;
            (*out0)->v1->shape[1] = b_83614;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int64_t in0, const struct futhark_opaque_sortStruct_long *in1)
{
    int64_t n_84492 = (int64_t) 0;
    int64_t b_84493 = (int64_t) 0;
    int64_t block_sizze_84494 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    block_sizze_84494 = in0;
    k_mem_171274 = in1->v0->mem;
    n_84492 = in1->v0->shape[0];
    pL_mem_171275 = in1->v1->mem;
    n_84492 = in1->v1->shape[0];
    b_84493 = in1->v1->shape[1];
    if (!(n_84492 == in1->v0->shape[0] && (n_84492 == in1->v1->shape[0] && b_84493 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_long(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_84492, b_84493, block_sizze_84494);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_84492;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_84492;
            (*out0)->v1->shape[1] = b_84493;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int64_t in0, const struct futhark_opaque_sortStruct_short *in1)
{
    int64_t n_82726 = (int64_t) 0;
    int64_t b_82727 = (int64_t) 0;
    int64_t block_sizze_82728 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock pL_mem_171275;
    
    pL_mem_171275.references = NULL;
    
    struct memblock k_mem_171274;
    
    k_mem_171274.references = NULL;
    block_sizze_82728 = in0;
    k_mem_171274 = in1->v0->mem;
    n_82726 = in1->v0->shape[0];
    pL_mem_171275 = in1->v1->mem;
    n_82726 = in1->v1->shape[0];
    b_82727 = in1->v1->shape[1];
    if (!(n_82726 == in1->v0->shape[0] && (n_82726 == in1->v1->shape[0] && b_82727 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_short(ctx, &mem_out_171956, &mem_out_171957, k_mem_171274, pL_mem_171275, n_82726, b_82727, block_sizze_82728);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = n_82726;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = n_82726;
            (*out0)->v1->shape[1] = b_82727;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2)
{
    int64_t nz2080U_149025 = (int64_t) 0;
    int64_t group_no_149026 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149026 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149025 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149025 = in2->shape[0];
    if (!(nz2080U_149025 == in1->shape[0] && nz2080U_149025 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_short_sum(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, nz2080U_149025, group_no_149026);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149026;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t nz2080U_149102 = (int64_t) 0;
    int64_t group_no_149103 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock eta_p_mem_171276;
    
    eta_p_mem_171276.references = NULL;
    
    struct memblock eta_p_mem_171275;
    
    eta_p_mem_171275.references = NULL;
    
    struct memblock eta_p_mem_171274;
    
    eta_p_mem_171274.references = NULL;
    group_no_149103 = in0;
    eta_p_mem_171274 = in1->mem;
    nz2080U_149102 = in1->shape[0];
    eta_p_mem_171275 = in2->mem;
    nz2080U_149102 = in2->shape[0];
    eta_p_mem_171276 = in3->mem;
    nz2080U_149102 = in3->shape[0];
    if (!(nz2080U_149102 == in1->shape[0] && (nz2080U_149102 == in2->shape[0] && nz2080U_149102 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_short_sum_xy(ctx, &mem_out_171956, eta_p_mem_171274, eta_p_mem_171275, eta_p_mem_171276, nz2080U_149102, group_no_149103);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_171956;
            (*out0)->shape[0] = group_no_149103;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1)
{
    int64_t dz2080U_147112 = (int64_t) 0;
    int64_t dz2081U_147113 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171275;
    
    ks_mem_171275.references = NULL;
    
    struct memblock k_ids_mem_171274;
    
    k_ids_mem_171274.references = NULL;
    k_ids_mem_171274 = in0->mem;
    dz2080U_147112 = in0->shape[0];
    ks_mem_171275 = in1->mem;
    dz2081U_147113 = in1->shape[0];
    if (!(dz2080U_147112 == in0->shape[0] && dz2081U_147113 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_double(ctx, &mem_out_171956, &mem_out_171957, k_ids_mem_171274, ks_mem_171275, dz2080U_147112, dz2081U_147113);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = dz2080U_147112;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = dz2080U_147112;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1)
{
    int64_t dz2080U_146322 = (int64_t) 0;
    int64_t dz2081U_146323 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171275;
    
    ks_mem_171275.references = NULL;
    
    struct memblock k_ids_mem_171274;
    
    k_ids_mem_171274.references = NULL;
    k_ids_mem_171274 = in0->mem;
    dz2080U_146322 = in0->shape[0];
    ks_mem_171275 = in1->mem;
    dz2081U_146323 = in1->shape[0];
    if (!(dz2080U_146322 == in0->shape[0] && dz2081U_146323 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_float(ctx, &mem_out_171956, &mem_out_171957, k_ids_mem_171274, ks_mem_171275, dz2080U_146322, dz2081U_146323);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = dz2080U_146322;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = dz2080U_146322;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1)
{
    int64_t dz2080U_144742 = (int64_t) 0;
    int64_t dz2081U_144743 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171275;
    
    ks_mem_171275.references = NULL;
    
    struct memblock k_ids_mem_171274;
    
    k_ids_mem_171274.references = NULL;
    k_ids_mem_171274 = in0->mem;
    dz2080U_144742 = in0->shape[0];
    ks_mem_171275 = in1->mem;
    dz2081U_144743 = in1->shape[0];
    if (!(dz2080U_144742 == in0->shape[0] && dz2081U_144743 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_int(ctx, &mem_out_171956, &mem_out_171957, k_ids_mem_171274, ks_mem_171275, dz2080U_144742, dz2081U_144743);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = dz2080U_144742;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = dz2080U_144742;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1)
{
    int64_t dz2080U_145532 = (int64_t) 0;
    int64_t dz2081U_145533 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171275;
    
    ks_mem_171275.references = NULL;
    
    struct memblock k_ids_mem_171274;
    
    k_ids_mem_171274.references = NULL;
    k_ids_mem_171274 = in0->mem;
    dz2080U_145532 = in0->shape[0];
    ks_mem_171275 = in1->mem;
    dz2081U_145533 = in1->shape[0];
    if (!(dz2080U_145532 == in0->shape[0] && dz2081U_145533 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_long(ctx, &mem_out_171956, &mem_out_171957, k_ids_mem_171274, ks_mem_171275, dz2080U_145532, dz2081U_145533);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = dz2080U_145532;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = dz2080U_145532;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1)
{
    int64_t dz2080U_143952 = (int64_t) 0;
    int64_t dz2081U_143953 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171275;
    
    ks_mem_171275.references = NULL;
    
    struct memblock k_ids_mem_171274;
    
    k_ids_mem_171274.references = NULL;
    k_ids_mem_171274 = in0->mem;
    dz2080U_143952 = in0->shape[0];
    ks_mem_171275 = in1->mem;
    dz2081U_143953 = in1->shape[0];
    if (!(dz2080U_143952 == in0->shape[0] && dz2081U_143953 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_short(ctx, &mem_out_171956, &mem_out_171957, k_ids_mem_171274, ks_mem_171275, dz2080U_143952, dz2081U_143953);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = dz2080U_143952;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = dz2080U_143952;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0)
{
    int64_t dz2080U_148890 = (int64_t) 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    dz2080U_148890 = in0->shape[0];
    if (!(dz2080U_148890 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_double(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, ks_mem_171274, dz2080U_148890);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0)
{
    int64_t dz2080U_148542 = (int64_t) 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    dz2080U_148542 = in0->shape[0];
    if (!(dz2080U_148542 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_float(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, ks_mem_171274, dz2080U_148542);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0)
{
    int64_t dz2080U_147846 = (int64_t) 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    dz2080U_147846 = in0->shape[0];
    if (!(dz2080U_147846 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_int(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, ks_mem_171274, dz2080U_147846);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0)
{
    int64_t dz2080U_148194 = (int64_t) 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    dz2080U_148194 = in0->shape[0];
    if (!(dz2080U_148194 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_long(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, ks_mem_171274, dz2080U_148194);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0)
{
    int64_t dz2080U_147498 = (int64_t) 0;
    int64_t prim_out_171958 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_171957;
    
    mem_out_171957.references = NULL;
    
    struct memblock mem_out_171956;
    
    mem_out_171956.references = NULL;
    
    struct memblock ks_mem_171274;
    
    ks_mem_171274.references = NULL;
    ks_mem_171274 = in0->mem;
    dz2080U_147498 = in0->shape[0];
    if (!(dz2080U_147498 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_short(ctx, &mem_out_171956, &mem_out_171957, &prim_out_171958, ks_mem_171274, dz2080U_147498);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_171956;
            (*out0)->v0->shape[0] = prim_out_171958;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_171957;
            (*out0)->v1->shape[0] = prim_out_171958;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
