// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
struct futhark_u8_2d;
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1);
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1);
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data);
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1);
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);

// Opaque values
struct futhark_opaque_joinPairs_bsq;
struct futhark_opaque_joinPairs_double;
struct futhark_opaque_joinPairs_float;
struct futhark_opaque_joinPairs_int;
struct futhark_opaque_joinPairs_long;
struct futhark_opaque_joinPairs_short;
struct futhark_opaque_partitionInfo;
struct futhark_opaque_partitionedSet_GFTR;
struct futhark_opaque_partitionedSet_GFUR;
struct futhark_opaque_radix_hashTable;
struct futhark_opaque_sortInfo_double;
struct futhark_opaque_sortInfo_float;
struct futhark_opaque_sortInfo_int;
struct futhark_opaque_sortInfo_long;
struct futhark_opaque_sortInfo_short;
struct futhark_opaque_sortStruct_double;
struct futhark_opaque_sortStruct_float;
struct futhark_opaque_sortStruct_int;
struct futhark_opaque_sortStruct_long;
struct futhark_opaque_sortStruct_short;
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj);
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs);
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj);
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs);
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj);
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs);
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj);
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs);
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj);
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs);
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj);
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs);
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj);
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n);
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj);
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth);
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks);
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj);
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n);
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx);
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj);
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs);
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj);
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs);
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj);
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs);
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj);
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs);
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj);
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs);
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj);
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj);
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj);
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj);
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj);
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL);

// Entry points
int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_partitionInfo *in4, const struct futhark_opaque_radix_hashTable *in5, const int64_t in6);
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0);
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0);
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4);
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3);
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4);
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4);
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4);
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4);
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4);
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4);
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7);
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1);
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1);
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1);
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1);
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1);
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0);
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0);
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0);
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0);
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0);
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6);
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6);
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int16_t in1, const struct futhark_f64_1d *in2);
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int16_t in1, const struct futhark_f32_1d *in2);
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int16_t in1, const struct futhark_i32_1d *in2);
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int16_t in1, const struct futhark_i64_1d *in2);
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int16_t in1, const struct futhark_i16_1d *in2);
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int16_t in0, const struct futhark_opaque_sortStruct_double *in1);
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int16_t in0, const struct futhark_opaque_sortStruct_float *in1);
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int16_t in0, const struct futhark_opaque_sortStruct_int *in1);
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int16_t in0, const struct futhark_opaque_sortStruct_long *in1);
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int16_t in0, const struct futhark_opaque_sortStruct_short *in1);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_c
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
};
struct tuning_params {
    int dummy;
};
static const int num_tuning_params = 0;
static const char *tuning_param_names[] = {NULL};
static const char *tuning_param_vars[] = {NULL};
static const char *tuning_param_classes[] = {NULL};
static int64_t tuning_param_defaults[] = {0};
// Start of backends/c.h

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char *cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
};

static void backend_context_config_setup(struct futhark_context_config* cfg) {
  (void)cfg;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  (void)cfg;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config* cfg, const char *param_name, size_t param_value) {
  (void)cfg; (void)param_name; (void)param_value;
  return 1;
}

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
};

int backend_context_setup(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  (void)ctx;
}

int futhark_context_sync(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

// End of backends/c.h

struct program {
    int dummy;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_165914, struct memblock *mem_out_p_165915, struct memblock *mem_out_p_165916, int64_t *out_prim_out_165917, int64_t *out_prim_out_165918, int64_t *out_prim_out_165919, struct memblock pR_mem_164928, struct memblock pS_mem_164929, struct memblock bounds_mem_164930, struct memblock depths_mem_164931, struct memblock bounds_mem_164932, struct memblock depths_mem_164933, struct memblock first_info_idx_mem_164934, struct memblock last_info_idx_mem_164935, int64_t nR_144113, int64_t b_144114, int64_t nS_144115, int64_t dz2081U_144116, int64_t dz2081U_144117, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118, int32_t radix_sizze_144119, int32_t maxDepth_144124, int32_t maxDepth_144127, int64_t scatter_psizze_144130);
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_165955, struct memblock ks_mem_164928, int64_t n_74295);
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_165956, struct memblock ks_mem_164928, int64_t n_74118);
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_165957, struct memblock ks_mem_164928, int64_t n_73767);
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_165958, struct memblock ks_mem_164928, int64_t n_73941);
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_165959, struct memblock ks_mem_164928, int64_t n_73593);
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_165960, struct memblock *mem_out_p_165961, int64_t *out_prim_out_165962, int32_t *out_prim_out_165963, struct memblock pXs_mem_164928, int64_t n_140775, int64_t b_140776, int32_t radix_sizze_140777, int64_t offset_140779, int64_t sizze_thresh_140780, int32_t max_depth_140781);
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_165971, struct memblock *mem_out_p_165972, int64_t *out_prim_out_165973, struct memblock pXs_mem_164928, struct memblock bounds_mem_164929, struct memblock depths_mem_164930, int64_t n_141596, int64_t b_141597, int64_t dz2080U_141598, int64_t dz2081U_141599, int32_t radix_sizze_141600, int32_t maxDepth_141604, int64_t scatter_psizze_141605);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_165979, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_77908, int64_t dz2083U_77909, int64_t incr_77910, int64_t psizze_77911, int64_t pL_bytes_77913);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_165980, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_77444, int64_t dz2083U_77445, int64_t incr_77446, int64_t psizze_77447);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165981, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_79416, int64_t n_79417, int64_t incr_79418, int64_t psizze_79419);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_165982, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_77164, int64_t dz2083U_77165, int64_t incr_77166, int64_t psizze_77167);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165983, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_79115, int64_t n_79116, int64_t incr_79117, int64_t psizze_79118);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_165984, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_76604, int64_t dz2083U_76605, int64_t incr_76606, int64_t psizze_76607);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165985, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_78513, int64_t n_78514, int64_t incr_78515, int64_t psizze_78516);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_165986, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_76884, int64_t dz2083U_76885, int64_t incr_76886, int64_t psizze_76887);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165987, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_78814, int64_t n_78815, int64_t incr_78816, int64_t psizze_78817);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_165988, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_76324, int64_t dz2083U_76325, int64_t incr_76326, int64_t psizze_76327);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165989, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_78212, int64_t n_78213, int64_t incr_78214, int64_t psizze_78215);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_165990, struct memblock *mem_out_p_165991, struct memblock *mem_out_p_165992, int64_t *out_prim_out_165993, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_136036, int64_t nS_136037, int64_t offset_R_136040, int64_t offset_S_136041, int64_t partitionsPerWindow_136042, int64_t numberOfWindows_136043, int64_t extParallelism_136044, int64_t scatter_psizze_136045);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_166022, struct memblock *mem_out_p_166023, struct memblock *mem_out_p_166024, int64_t *out_prim_out_166025, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_131064, int64_t nS_131065, int64_t offset_R_131068, int64_t offset_S_131069, int64_t partitionsPerWindow_131070, int64_t numberOfWindows_131071, int64_t extParallelism_131072, int64_t scatter_psizze_131073);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_166054, struct memblock *mem_out_p_166055, struct memblock *mem_out_p_166056, int64_t *out_prim_out_166057, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_121202, int64_t nS_121203, int64_t offset_R_121206, int64_t offset_S_121207, int64_t partitionsPerWindow_121208, int64_t numberOfWindows_121209, int64_t extParallelism_121210, int64_t scatter_psizze_121211);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_166086, struct memblock *mem_out_p_166087, struct memblock *mem_out_p_166088, int64_t *out_prim_out_166089, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_126092, int64_t nS_126093, int64_t offset_R_126096, int64_t offset_S_126097, int64_t partitionsPerWindow_126098, int64_t numberOfWindows_126099, int64_t extParallelism_126100, int64_t scatter_psizze_126101);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_166118, struct memblock *mem_out_p_166119, struct memblock *mem_out_p_166120, int64_t *out_prim_out_166121, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_116230, int64_t nS_116231, int64_t offset_R_116234, int64_t offset_S_116235, int64_t partitionsPerWindow_116236, int64_t numberOfWindows_116237, int64_t extParallelism_116238, int64_t scatter_psizze_116239);
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_166150, struct memblock eta_p_mem_164928, int64_t nz2080U_74372);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_166151, struct memblock *mem_out_p_166152, struct memblock xs_mem_164928, int64_t n_111087, int64_t incr_111088);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_166163, struct memblock *mem_out_p_166164, struct memblock xs_mem_164928, int64_t n_108942, int64_t incr_108943);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_166175, struct memblock *mem_out_p_166176, struct memblock xs_mem_164928, int64_t n_104656, int64_t incr_104657);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_166187, struct memblock *mem_out_p_166188, struct memblock xs_mem_164928, int64_t n_106797, int64_t incr_106798);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_166199, struct memblock *mem_out_p_166200, struct memblock xs_mem_164928, int64_t n_102511, int64_t incr_102512);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_166211, struct memblock *mem_out_p_166212, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_95983, int64_t b_95984);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_166223, struct memblock *mem_out_p_166224, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_93618, int64_t b_93619);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_166235, struct memblock *mem_out_p_166236, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_88898, int64_t b_88899);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_166247, struct memblock *mem_out_p_166248, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_91253, int64_t b_91254);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_166259, struct memblock *mem_out_p_166260, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_86533, int64_t b_86534);
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_166271, struct memblock eta_p_mem_164928, int64_t nz2080U_74332);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_166272, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_76042, int64_t incr_76043, int64_t block_sizze_76044);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_166273, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_75708, int64_t incr_75709, int64_t block_sizze_75710);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_166274, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_75040, int64_t incr_75041, int64_t block_sizze_75042);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_166275, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_75374, int64_t incr_75375, int64_t block_sizze_75376);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_166276, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_74706, int64_t incr_74707, int64_t block_sizze_74708);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_166277, struct memblock *mem_out_p_166278, struct memblock xs_mem_164928, struct memblock pL_mem_164929, int64_t n_138594, int64_t b_138595, int64_t pL_b_138596, int16_t block_sizze_138597, int64_t gather_psizze_138598, int32_t radix_sizze_138599, int64_t sizze_thresh_138602, int32_t max_depth_138603);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_166290, struct memblock *mem_out_p_166291, struct memblock xs_mem_164928, int64_t n_139961, int64_t b_139962, int16_t block_sizze_139963, int64_t gather_psizze_139964, int32_t radix_sizze_139965, int64_t offset_139967, int64_t sizze_thresh_139968, int32_t max_depth_139969);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_166302, struct memblock *mem_out_p_166303, struct memblock xs_mem_164928, int64_t n_100365, int64_t incr_100366, int16_t block_sizze_100367);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_166307, struct memblock *mem_out_p_166308, struct memblock xs_mem_164928, int64_t n_99476, int64_t incr_99477, int16_t block_sizze_99478);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_166312, struct memblock *mem_out_p_166313, struct memblock xs_mem_164928, int64_t n_97719, int64_t incr_97720, int16_t block_sizze_97721);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_166317, struct memblock *mem_out_p_166318, struct memblock xs_mem_164928, int64_t n_98587, int64_t incr_98588, int16_t block_sizze_98589);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_166322, struct memblock *mem_out_p_166323, struct memblock xs_mem_164928, int64_t n_96851, int64_t incr_96852, int16_t block_sizze_96853);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_166327, struct memblock *mem_out_p_166328, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_84062, int64_t b_84063, int16_t block_sizze_84064);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_166333, struct memblock *mem_out_p_166334, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_83112, int64_t b_83113, int16_t block_sizze_83114);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_166339, struct memblock *mem_out_p_166340, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_81278, int64_t b_81279, int16_t block_sizze_81280);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_166345, struct memblock *mem_out_p_166346, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_82166, int64_t b_82167, int16_t block_sizze_82168);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_166351, struct memblock *mem_out_p_166352, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_80384, int64_t b_80385, int16_t block_sizze_80386);
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_12923(struct futhark_context *ctx, struct memblock *mem_out_p_166357, struct memblock *mem_out_p_166358, int64_t *out_prim_out_166359, int64_t *out_prim_out_166360, int32_t *out_prim_out_166361, struct memblock pXs_mem_164928, int64_t n_137755, int64_t b_137756, int32_t curDepth_137757, int32_t i_137759, int32_t j_137760);
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_166367, int32_t bit_79762, int16_t x_79763);
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_166368, int32_t bit_81544, int64_t x_81545);
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5624(struct futhark_context *ctx, int64_t *out_prim_out_166369, int64_t upper_bound_84091, int64_t n_84092);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12141(struct futhark_context *ctx, struct memblock *mem_out_p_166370, struct memblock nameless_mem_164928, int64_t n_96008, int64_t incr_96009);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12162(struct futhark_context *ctx, struct memblock *mem_out_p_166371, struct memblock nameless_mem_164928, int64_t n_96876, int64_t incr_96877);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12184(struct futhark_context *ctx, struct memblock *mem_out_p_166372, struct memblock nameless_mem_164928, int64_t n_97744, int64_t incr_97745);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12206(struct futhark_context *ctx, struct memblock *mem_out_p_166373, struct memblock nameless_mem_164928, int64_t n_98612, int64_t incr_98613);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12227(struct futhark_context *ctx, struct memblock *mem_out_p_166374, struct memblock nameless_mem_164928, int64_t n_99501, int64_t incr_99502);
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_11249(struct futhark_context *ctx, int64_t *out_prim_out_166375, int64_t *out_prim_out_166376, int64_t *out_prim_out_166377, int64_t *out_prim_out_166378, int64_t *out_prim_out_166379, int64_t slo_84321, int64_t shi_84322, int64_t tlo_84323, int64_t thi_84324, int64_t count_84325);
FUTHARK_FUN_ATTR int futrts_partitioned_scatter_13032(struct futhark_context *ctx, struct memblock *mem_out_p_166380, struct memblock dest_mem_164928, struct memblock is_mem_164929, struct memblock vs_mem_164930, int64_t nd_141122, int64_t n_141123, int64_t psizze_141124);
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_166382, int32_t bit_79456, int8_t x_79457, int32_t b_79458);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
struct futhark_u8_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 1 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) (dim0 * dim1) * 1);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 1 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] * arr->shape[1]) * 1);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        if (1 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 1 * (i0 * arr->shape[1] + i1 * 1), 1);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i16_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 2 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 2);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 2 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 2);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (2 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 2 * (i0 * 1), 2);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_sortStruct_short {
    struct futhark_i16_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_short *v = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i16_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_short *obj = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int16_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i16_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_int {
    struct futhark_i32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_int *v = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_int *obj = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int32_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_long {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_long *v = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_long *obj = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_float {
    struct futhark_f32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_float *v = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_float *obj = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(float);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_double {
    struct futhark_f64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_double *v = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_double *obj = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(double);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_short {
    struct futhark_i64_1d *v0;
    struct futhark_i16_1d *v1;
};
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs)
{
    struct futhark_opaque_sortInfo_short *v = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i16_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_short *obj = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i16_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_int {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
};
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_int *v = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_int *obj = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_long *v = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_long *obj = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_float {
    struct futhark_i64_1d *v0;
    struct futhark_f32_1d *v1;
};
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_float *v = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_float *obj = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_double {
    struct futhark_i64_1d *v0;
    struct futhark_f64_1d *v1;
};
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_double *v = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_double *obj = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_short {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i16_1d *v2;
};
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs)
{
    struct futhark_opaque_joinPairs_short *v = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i16_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_short *obj = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i16_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_int {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i32_1d *v2;
};
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_int *v = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_int *obj = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_long *v = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_long *obj = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_1d *v2;
};
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_float *v = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_float *obj = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
};
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_double *v = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_double *obj = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFTR {
    struct futhark_u8_2d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_partitionedSet_GFTR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_u8_2d));
        *v->v0 = *f_ks;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFTR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(int8_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_u8_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFUR {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks)
{
    struct futhark_opaque_partitionedSet_GFUR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_ks;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFUR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionInfo {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
    int32_t v2;
};
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int32_t v;
    
    v = obj->v2;
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth)
{
    struct futhark_opaque_partitionInfo *v = malloc(sizeof(struct futhark_opaque_partitionInfo));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_bounds;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_depths;
        (void) (*v->v1->mem.references)++;
    }
    v->v2 = f_maxDepth;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
    }
    return ret;
}
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionInfo *obj = malloc(sizeof(struct futhark_opaque_partitionInfo));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_radix_hashTable {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx)
{
    struct futhark_opaque_radix_hashTable *v = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_first_info_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_last_info_idx;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_radix_hashTable *obj = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_bsq {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_u8_2d *v2;
};
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v2, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs)
{
    struct futhark_opaque_joinPairs_bsq *v = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_u8_2d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_bsq *obj = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_u8_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_165914, struct memblock *mem_out_p_165915, struct memblock *mem_out_p_165916, int64_t *out_prim_out_165917, int64_t *out_prim_out_165918, int64_t *out_prim_out_165919, struct memblock pR_mem_164928, struct memblock pS_mem_164929, struct memblock bounds_mem_164930, struct memblock depths_mem_164931, struct memblock bounds_mem_164932, struct memblock depths_mem_164933, struct memblock first_info_idx_mem_164934, struct memblock last_info_idx_mem_164935, int64_t nR_144113, int64_t b_144114, int64_t nS_144115, int64_t dz2081U_144116, int64_t dz2081U_144117, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118, int32_t radix_sizze_144119, int32_t maxDepth_144124, int32_t maxDepth_144127, int64_t scatter_psizze_144130)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164937_cached_sizze_165920 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164945_cached_sizze_165921 = 0;
    unsigned char *mem_164945 = NULL;
    int64_t mem_164947_cached_sizze_165922 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_165923 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_164951_cached_sizze_165924 = 0;
    unsigned char *mem_164951 = NULL;
    int64_t mem_164964_cached_sizze_165925 = 0;
    unsigned char *mem_164964 = NULL;
    int64_t mem_164974_cached_sizze_165926 = 0;
    unsigned char *mem_164974 = NULL;
    int64_t mem_164975_cached_sizze_165927 = 0;
    unsigned char *mem_164975 = NULL;
    int64_t mem_164988_cached_sizze_165928 = 0;
    unsigned char *mem_164988 = NULL;
    int64_t mem_164989_cached_sizze_165929 = 0;
    unsigned char *mem_164989 = NULL;
    int64_t mem_165002_cached_sizze_165930 = 0;
    unsigned char *mem_165002 = NULL;
    int64_t mem_165003_cached_sizze_165931 = 0;
    unsigned char *mem_165003 = NULL;
    int64_t mem_165016_cached_sizze_165932 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165017_cached_sizze_165933 = 0;
    unsigned char *mem_165017 = NULL;
    int64_t mem_165033_cached_sizze_165934 = 0;
    unsigned char *mem_165033 = NULL;
    int64_t mem_165034_cached_sizze_165935 = 0;
    unsigned char *mem_165034 = NULL;
    int64_t mem_165047_cached_sizze_165936 = 0;
    unsigned char *mem_165047 = NULL;
    int64_t mem_165048_cached_sizze_165937 = 0;
    unsigned char *mem_165048 = NULL;
    int64_t mem_165064_cached_sizze_165938 = 0;
    unsigned char *mem_165064 = NULL;
    int64_t mem_165065_cached_sizze_165939 = 0;
    unsigned char *mem_165065 = NULL;
    int64_t mem_165078_cached_sizze_165940 = 0;
    unsigned char *mem_165078 = NULL;
    int64_t mem_165079_cached_sizze_165941 = 0;
    unsigned char *mem_165079 = NULL;
    int64_t mem_165095_cached_sizze_165942 = 0;
    unsigned char *mem_165095 = NULL;
    int64_t mem_165096_cached_sizze_165943 = 0;
    unsigned char *mem_165096 = NULL;
    int64_t mem_165109_cached_sizze_165944 = 0;
    unsigned char *mem_165109 = NULL;
    int64_t mem_165110_cached_sizze_165945 = 0;
    unsigned char *mem_165110 = NULL;
    int64_t mem_165136_cached_sizze_165946 = 0;
    unsigned char *mem_165136 = NULL;
    int64_t mem_165138_cached_sizze_165947 = 0;
    unsigned char *mem_165138 = NULL;
    int64_t mem_165140_cached_sizze_165948 = 0;
    unsigned char *mem_165140 = NULL;
    int64_t mem_165255_cached_sizze_165949 = 0;
    unsigned char *mem_165255 = NULL;
    int64_t mem_165256_cached_sizze_165950 = 0;
    unsigned char *mem_165256 = NULL;
    int64_t mem_165270_cached_sizze_165951 = 0;
    unsigned char *mem_165270 = NULL;
    int64_t mem_165400_cached_sizze_165952 = 0;
    unsigned char *mem_165400 = NULL;
    int64_t mem_165401_cached_sizze_165953 = 0;
    unsigned char *mem_165401 = NULL;
    int64_t mem_165415_cached_sizze_165954 = 0;
    unsigned char *mem_165415 = NULL;
    struct memblock mem_param_tmp_165798;
    
    mem_param_tmp_165798.references = NULL;
    
    struct memblock mem_param_tmp_165797;
    
    mem_param_tmp_165797.references = NULL;
    
    struct memblock mem_param_tmp_165796;
    
    mem_param_tmp_165796.references = NULL;
    
    struct memblock mem_165505;
    
    mem_165505.references = NULL;
    
    struct memblock mem_165503;
    
    mem_165503.references = NULL;
    
    struct memblock mem_165501;
    
    mem_165501.references = NULL;
    
    struct memblock mem_param_tmp_165807;
    
    mem_param_tmp_165807.references = NULL;
    
    struct memblock mem_param_tmp_165806;
    
    mem_param_tmp_165806.references = NULL;
    
    struct memblock mem_param_tmp_165805;
    
    mem_param_tmp_165805.references = NULL;
    
    struct memblock mem_165489;
    
    mem_165489.references = NULL;
    
    struct memblock mem_165487;
    
    mem_165487.references = NULL;
    
    struct memblock mem_165485;
    
    mem_165485.references = NULL;
    
    struct memblock mem_165235;
    
    mem_165235.references = NULL;
    
    struct memblock mem_165227;
    
    mem_165227.references = NULL;
    
    struct memblock mem_param_tmp_165888;
    
    mem_param_tmp_165888.references = NULL;
    
    struct memblock mem_param_tmp_165887;
    
    mem_param_tmp_165887.references = NULL;
    
    struct memblock mem_param_tmp_165886;
    
    mem_param_tmp_165886.references = NULL;
    
    struct memblock mem_165215;
    
    mem_165215.references = NULL;
    
    struct memblock mem_165213;
    
    mem_165213.references = NULL;
    
    struct memblock mem_165211;
    
    mem_165211.references = NULL;
    
    struct memblock mem_param_tmp_165895;
    
    mem_param_tmp_165895.references = NULL;
    
    struct memblock mem_165199;
    
    mem_165199.references = NULL;
    
    struct memblock ext_mem_165202;
    
    ext_mem_165202.references = NULL;
    
    struct memblock mem_param_165196;
    
    mem_param_165196.references = NULL;
    
    struct memblock ext_mem_165205;
    
    ext_mem_165205.references = NULL;
    
    struct memblock mem_param_165193;
    
    mem_param_165193.references = NULL;
    
    struct memblock mem_param_165190;
    
    mem_param_165190.references = NULL;
    
    struct memblock mem_param_165187;
    
    mem_param_165187.references = NULL;
    
    struct memblock ext_mem_165223;
    
    ext_mem_165223.references = NULL;
    
    struct memblock ext_mem_165224;
    
    ext_mem_165224.references = NULL;
    
    struct memblock ext_mem_165225;
    
    ext_mem_165225.references = NULL;
    
    struct memblock mem_165312;
    
    mem_165312.references = NULL;
    
    struct memblock mem_165304;
    
    mem_165304.references = NULL;
    
    struct memblock mem_param_tmp_165865;
    
    mem_param_tmp_165865.references = NULL;
    
    struct memblock mem_param_tmp_165864;
    
    mem_param_tmp_165864.references = NULL;
    
    struct memblock mem_param_tmp_165863;
    
    mem_param_tmp_165863.references = NULL;
    
    struct memblock mem_165290;
    
    mem_165290.references = NULL;
    
    struct memblock ext_mem_165286;
    
    ext_mem_165286.references = NULL;
    
    struct memblock mem_165282;
    
    mem_165282.references = NULL;
    
    struct memblock mem_165292;
    
    mem_165292.references = NULL;
    
    struct memblock mem_165288;
    
    mem_165288.references = NULL;
    
    struct memblock mem_param_165253;
    
    mem_param_165253.references = NULL;
    
    struct memblock mem_param_165250;
    
    mem_param_165250.references = NULL;
    
    struct memblock mem_param_165247;
    
    mem_param_165247.references = NULL;
    
    struct memblock ext_mem_165300;
    
    ext_mem_165300.references = NULL;
    
    struct memblock ext_mem_165301;
    
    ext_mem_165301.references = NULL;
    
    struct memblock ext_mem_165302;
    
    ext_mem_165302.references = NULL;
    
    struct memblock mem_165284;
    
    mem_165284.references = NULL;
    
    struct memblock mem_165243;
    
    mem_165243.references = NULL;
    
    struct memblock ext_mem_165322;
    
    ext_mem_165322.references = NULL;
    
    struct memblock ext_mem_165325;
    
    ext_mem_165325.references = NULL;
    
    struct memblock ext_mem_165328;
    
    ext_mem_165328.references = NULL;
    
    struct memblock mem_165380;
    
    mem_165380.references = NULL;
    
    struct memblock mem_165372;
    
    mem_165372.references = NULL;
    
    struct memblock mem_param_tmp_165841;
    
    mem_param_tmp_165841.references = NULL;
    
    struct memblock mem_param_tmp_165840;
    
    mem_param_tmp_165840.references = NULL;
    
    struct memblock mem_param_tmp_165839;
    
    mem_param_tmp_165839.references = NULL;
    
    struct memblock mem_165360;
    
    mem_165360.references = NULL;
    
    struct memblock mem_165358;
    
    mem_165358.references = NULL;
    
    struct memblock mem_165356;
    
    mem_165356.references = NULL;
    
    struct memblock mem_param_tmp_165848;
    
    mem_param_tmp_165848.references = NULL;
    
    struct memblock mem_165344;
    
    mem_165344.references = NULL;
    
    struct memblock ext_mem_165347;
    
    ext_mem_165347.references = NULL;
    
    struct memblock mem_param_165341;
    
    mem_param_165341.references = NULL;
    
    struct memblock ext_mem_165350;
    
    ext_mem_165350.references = NULL;
    
    struct memblock mem_param_165338;
    
    mem_param_165338.references = NULL;
    
    struct memblock mem_param_165335;
    
    mem_param_165335.references = NULL;
    
    struct memblock mem_param_165332;
    
    mem_param_165332.references = NULL;
    
    struct memblock ext_mem_165368;
    
    ext_mem_165368.references = NULL;
    
    struct memblock ext_mem_165369;
    
    ext_mem_165369.references = NULL;
    
    struct memblock ext_mem_165370;
    
    ext_mem_165370.references = NULL;
    
    struct memblock mem_165457;
    
    mem_165457.references = NULL;
    
    struct memblock mem_165449;
    
    mem_165449.references = NULL;
    
    struct memblock mem_param_tmp_165818;
    
    mem_param_tmp_165818.references = NULL;
    
    struct memblock mem_param_tmp_165817;
    
    mem_param_tmp_165817.references = NULL;
    
    struct memblock mem_param_tmp_165816;
    
    mem_param_tmp_165816.references = NULL;
    
    struct memblock mem_165435;
    
    mem_165435.references = NULL;
    
    struct memblock ext_mem_165431;
    
    ext_mem_165431.references = NULL;
    
    struct memblock mem_165427;
    
    mem_165427.references = NULL;
    
    struct memblock mem_165437;
    
    mem_165437.references = NULL;
    
    struct memblock mem_165433;
    
    mem_165433.references = NULL;
    
    struct memblock mem_param_165398;
    
    mem_param_165398.references = NULL;
    
    struct memblock mem_param_165395;
    
    mem_param_165395.references = NULL;
    
    struct memblock mem_param_165392;
    
    mem_param_165392.references = NULL;
    
    struct memblock ext_mem_165445;
    
    ext_mem_165445.references = NULL;
    
    struct memblock ext_mem_165446;
    
    ext_mem_165446.references = NULL;
    
    struct memblock ext_mem_165447;
    
    ext_mem_165447.references = NULL;
    
    struct memblock mem_165429;
    
    mem_165429.references = NULL;
    
    struct memblock mem_165388;
    
    mem_165388.references = NULL;
    
    struct memblock ext_mem_165467;
    
    ext_mem_165467.references = NULL;
    
    struct memblock ext_mem_165470;
    
    ext_mem_165470.references = NULL;
    
    struct memblock ext_mem_165473;
    
    ext_mem_165473.references = NULL;
    
    struct memblock ext_mem_165477;
    
    ext_mem_165477.references = NULL;
    
    struct memblock ext_mem_165480;
    
    ext_mem_165480.references = NULL;
    
    struct memblock ext_mem_165483;
    
    ext_mem_165483.references = NULL;
    
    struct memblock mem_param_165183;
    
    mem_param_165183.references = NULL;
    
    struct memblock mem_param_165179;
    
    mem_param_165179.references = NULL;
    
    struct memblock mem_param_165176;
    
    mem_param_165176.references = NULL;
    
    struct memblock ext_mem_165497;
    
    ext_mem_165497.references = NULL;
    
    struct memblock ext_mem_165498;
    
    ext_mem_165498.references = NULL;
    
    struct memblock ext_mem_165499;
    
    ext_mem_165499.references = NULL;
    
    struct memblock mem_param_165173;
    
    mem_param_165173.references = NULL;
    
    struct memblock mem_param_165169;
    
    mem_param_165169.references = NULL;
    
    struct memblock mem_param_165166;
    
    mem_param_165166.references = NULL;
    
    struct memblock ext_mem_165513;
    
    ext_mem_165513.references = NULL;
    
    struct memblock ext_mem_165514;
    
    ext_mem_165514.references = NULL;
    
    struct memblock ext_mem_165515;
    
    ext_mem_165515.references = NULL;
    
    struct memblock mem_165163;
    
    mem_165163.references = NULL;
    
    struct memblock mem_165162;
    
    mem_165162.references = NULL;
    
    struct memblock mem_165161;
    
    mem_165161.references = NULL;
    
    struct memblock mem_165160;
    
    mem_165160.references = NULL;
    
    struct memblock mem_165159;
    
    mem_165159.references = NULL;
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165696;
    int64_t prim_out_165697;
    int64_t prim_out_165698;
    int64_t i32_res_150407 = sext_i32_i64(radix_sizze_144119);
    bool nonnegative_150408 = sle64((int64_t) 0, i32_res_150407);
    bool nonzzero_cert_150409;
    
    if (!nonnegative_150408) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:7:47-318:53\n   #1  ftRelational.fut:312:1-330:70\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_150410 = shl64((int64_t) 1, i32_res_150407);
    bool assert_cond_150411 = arg_150410 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118;
    bool assert_c_150412;
    
    if (!assert_cond_150411) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftRelational.fut:312:1-330:70\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164936 = (int64_t) 8 * b_144114;
    
    if (mem_164937_cached_sizze_165920 < bytes_164936) {
        err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_165920, bytes_164936);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < b_144114; i_164713++) {
        int64_t zm_lhs_156629 = sub64(b_144114, i_164713);
        int64_t lifted_lambda_res_156630 = sub64(zm_lhs_156629, (int64_t) 1);
        
        ((int64_t *) mem_164937)[i_164713] = lifted_lambda_res_156630;
    }
    
    int32_t getRadix_arg1_156631 = sub32(radix_sizze_144119, 1);
    int32_t i64_res_156632 = sext_i64_i32(b_144114);
    int32_t zm_lhs_156633 = mul32(8, i64_res_156632);
    int32_t min_arg1_156634 = sub32(zm_lhs_156633, 1);
    int32_t min_res_156635 = smin32(getRadix_arg1_156631, min_arg1_156634);
    int32_t i32_arg0_156639 = sub32(i64_res_156632, 1);
    int64_t i32_res_156640 = sext_i32_i64(i32_arg0_156639);
    int32_t zm_rhs_156642 = sdiv32(min_res_156635, 8);
    int32_t zm_lhs_156643 = sub32(i64_res_156632, zm_rhs_156642);
    int32_t i32_arg0_156644 = sub32(zm_lhs_156643, 1);
    int64_t i32_res_156645 = sext_i32_i64(i32_arg0_156644);
    int64_t min_arg1_156647 = sub64(bytes_164936, (int64_t) 1);
    int64_t min_res_156648 = smin64(i32_res_156645, min_arg1_156647);
    int32_t lastBit_156650 = smod32(min_res_156635, 8);
    int32_t zm_lhs_156653 = sub32(8, lastBit_156650);
    int32_t i32_arg0_156654 = sub32(zm_lhs_156653, 1);
    int8_t unsign_arg0_156655 = zext_i32_i8(i32_arg0_156654);
    int8_t unsign_arg0_156656 = lshr8((int8_t) -1, unsign_arg0_156655);
    bool x_156665 = sle64((int64_t) 0, i32_res_156640);
    bool y_156666 = slt64(i32_res_156640, b_144114);
    bool bounds_check_156667 = x_156665 && y_156666;
    bool index_certs_156668;
    
    if (!bounds_check_156667) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_156640, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_156676 = sle64((int64_t) 0, min_res_156648);
    bool y_156677 = slt64(min_res_156648, b_144114);
    bool bounds_check_156678 = x_156676 && y_156677;
    bool index_certs_156679;
    
    if (!bounds_check_156678) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_156648, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164944 = (int64_t) 8 * dz2081U_144116;
    
    if (mem_164945_cached_sizze_165921 < bytes_164944) {
        err = lexical_realloc(ctx, &mem_164945, &mem_164945_cached_sizze_165921, bytes_164944);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164947_cached_sizze_165922 < bytes_164944) {
        err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_165922, bytes_164944);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164949_cached_sizze_165923 < bytes_164944) {
        err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_165923, bytes_164944);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164951_cached_sizze_165924 < bytes_164944) {
        err = lexical_realloc(ctx, &mem_164951, &mem_164951_cached_sizze_165924, bytes_164944);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164964_cached_sizze_165925 < b_144114) {
        err = lexical_realloc(ctx, &mem_164964, &mem_164964_cached_sizze_165925, b_144114);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164813;
    int64_t scanacc_164803 = (int64_t) 0;
    
    for (int64_t i_164808 = 0; i_164808 < dz2081U_144116; i_164808++) {
        int64_t radix_to_idx_arg1_157028 = ((int64_t *) bounds_mem_164930.mem)[i_164808];
        bool x_157029 = sle64((int64_t) 0, radix_to_idx_arg1_157028);
        bool y_157030 = slt64(radix_to_idx_arg1_157028, nR_144113);
        bool bounds_check_157031 = x_157029 && y_157030;
        bool index_certs_157032;
        
        if (!bounds_check_157031) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_arg1_157028, "] out of bounds for array of shape [", (long long) nR_144113, "].", "-> #0  ftHashJoin.fut:339:39-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < b_144114; i_164717++) {
            int8_t eta_p_157036 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164717];
            bool cond_157037 = sle64(i_164717, i32_res_156640);
            bool cond_t_res_157038 = sle64(min_res_156648, i_164717);
            bool x_157039 = cond_157037 && cond_t_res_157038;
            int8_t lifted_lambda_res_157040;
            
            if (x_157039) {
                lifted_lambda_res_157040 = eta_p_157036;
            } else {
                lifted_lambda_res_157040 = (int8_t) 0;
            }
            ((int8_t *) mem_164964)[i_164717] = lifted_lambda_res_157040;
        }
        
        int8_t za_lhs_157041 = ((int8_t *) mem_164964)[i32_res_156640];
        int8_t mod1_x_157042 = (int8_t) -1 & za_lhs_157041;
        
        ((int8_t *) mem_164964)[i32_res_156640] = mod1_x_157042;
        
        int8_t za_lhs_157044 = ((int8_t *) mem_164964)[min_res_156648];
        int8_t tmp_157045 = unsign_arg0_156656 & za_lhs_157044;
        
        ((int8_t *) mem_164964)[min_res_156648] = tmp_157045;
        
        int64_t defunc_res_164313;
        int64_t redout_164719 = (int64_t) 0;
        
        for (int64_t i_164720 = 0; i_164720 < b_144114; i_164720++) {
            int64_t eta_p_158160 = ((int64_t *) mem_164937)[i_164720];
            int64_t ztzt_rhs_158162 = mul64((int64_t) 8, eta_p_158160);
            bool nonnegative_158163 = sle64((int64_t) 0, ztzt_rhs_158162);
            bool nonzzero_cert_158164;
            
            if (!nonnegative_158163) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:37:39-68\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t eta_p_158159 = ((int8_t *) mem_164964)[i_164720];
            int64_t u8_res_158161 = zext_i8_i64(eta_p_158159);
            int64_t zt_rhs_158165 = shl64((int64_t) 1, ztzt_rhs_158162);
            int64_t lifted_lambda_res_158166 = mul64(u8_res_158161, zt_rhs_158165);
            int64_t zp_res_157060 = add64(lifted_lambda_res_158166, redout_164719);
            int64_t redout_tmp_165706 = zp_res_157060;
            
            redout_164719 = redout_tmp_165706;
        }
        defunc_res_164313 = redout_164719;
        
        bool x_157061 = sle64((int64_t) 0, defunc_res_164313);
        bool y_157062 = slt64(defunc_res_164313, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118);
        bool bounds_check_157063 = x_157061 && y_157062;
        bool index_certs_157064;
        
        if (!bounds_check_157063) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_164313, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118, "].", "-> #0  ftHashJoin.fut:341:19-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t spi_157065 = ((int64_t *) first_info_idx_mem_164934.mem)[defunc_res_164313];
        bool cond_157066 = spi_157065 == (int64_t) -1;
        int64_t lifted_lambda_res_157067;
        int64_t lifted_lambda_res_157068;
        
        if (cond_157066) {
            lifted_lambda_res_157067 = (int64_t) -1;
            lifted_lambda_res_157068 = (int64_t) -1;
        } else {
            int32_t zeze_lhs_157069 = ((int32_t *) depths_mem_164931.mem)[i_164808];
            bool cond_157070 = zeze_lhs_157069 == 1;
            bool cond_157071;
            
            if (cond_157070) {
                cond_157071 = 1;
            } else {
                bool x_157072 = sle64((int64_t) 0, spi_157065);
                bool y_157073 = slt64(spi_157065, dz2081U_144117);
                bool bounds_check_157074 = x_157072 && y_157073;
                bool index_certs_157075;
                
                if (!bounds_check_157074) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) spi_157065, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:347:42-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t zeze_lhs_157076 = ((int32_t *) depths_mem_164933.mem)[spi_157065];
                bool cond_f_res_157077 = zeze_lhs_157076 == 1;
                
                cond_157071 = cond_f_res_157077;
            }
            
            bool x_165575 = !cond_157071;
            int64_t last_potential_spi_157082;
            
            if (x_165575) {
                int64_t x_165577 = ((int64_t *) last_info_idx_mem_164935.mem)[defunc_res_164313];
                
                last_potential_spi_157082 = x_165577;
            } else {
                last_potential_spi_157082 = (int64_t) 0;
            }
            
            int64_t zs_lhs_157083 = sub64(last_potential_spi_157082, spi_157065);
            int64_t max_arg1_157084 = sdiv64(zs_lhs_157083, (int64_t) 2);
            int64_t max_res_157085 = smax64((int64_t) 1, max_arg1_157084);
            bool loop_cond_157086 = slt64((int64_t) 0, max_res_157085);
            int64_t lifted_lambda_res_f_res_157078;
            int64_t lifted_lambda_res_f_res_157079;
            
            if (cond_157071) {
                int64_t tmp_163839 = ((int64_t *) last_info_idx_mem_164935.mem)[defunc_res_164313];
                
                lifted_lambda_res_f_res_157078 = spi_157065;
                lifted_lambda_res_f_res_157079 = tmp_163839;
            } else {
                int64_t i32_res_157091 = sext_i32_i64(i32_arg0_156639);
                bool x_157095 = sle64((int64_t) 0, i32_res_157091);
                bool y_157096 = slt64(i32_res_157091, b_144114);
                bool bounds_check_157097 = x_157095 && y_157096;
                bool loop_not_taken_157098 = !loop_cond_157086;
                bool protect_assert_disj_157099 = bounds_check_157097 || loop_not_taken_157098;
                bool index_certs_157100;
                
                if (!protect_assert_disj_157099) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_157091, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t min_arg1_157089 = sub32(zm_lhs_156633, 1);
                
                if (mem_164974_cached_sizze_165926 < b_144114) {
                    err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_165926, b_144114);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_164975_cached_sizze_165927 < b_144114) {
                    err = lexical_realloc(ctx, &mem_164975, &mem_164975_cached_sizze_165927, b_144114);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                bool lifted_lambda_res_f_res_f_res_157101;
                int64_t lifted_lambda_res_f_res_f_res_157102;
                int64_t lifted_lambda_res_f_res_f_res_157103;
                bool loop_while_157104;
                int64_t first_spi_157105;
                int64_t step_157106;
                
                loop_while_157104 = loop_cond_157086;
                first_spi_157105 = spi_157065;
                step_157106 = max_res_157085;
                while (loop_while_157104) {
                    bool x_157107 = sle64((int64_t) 0, first_spi_157105);
                    bool y_157108 = slt64(first_spi_157105, dz2081U_144117);
                    bool bounds_check_157109 = x_157107 && y_157108;
                    bool index_certs_157110;
                    
                    if (!bounds_check_157109) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) first_spi_157105, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:358:32-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t cur_S_157111 = ((int64_t *) bounds_mem_164932.mem)[first_spi_157105];
                    bool x_157112 = sle64((int64_t) 0, cur_S_157111);
                    bool y_157113 = slt64(cur_S_157111, nS_144115);
                    bool bounds_check_157114 = x_157112 && y_157113;
                    bool index_certs_157115;
                    
                    if (!bounds_check_157114) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_157111, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:358:29-52\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t min_arg1_157117 = ((int32_t *) depths_mem_164933.mem)[first_spi_157105];
                    int32_t min_res_157118 = smin32(zeze_lhs_157069, min_arg1_157117);
                    bool cond_157119 = slt64(spi_157065, first_spi_157105);
                    int64_t tmp_163840 = sub64(first_spi_157105, (int64_t) 1);
                    bool x_163841 = sle64((int64_t) 0, tmp_163840);
                    bool y_163842 = slt64(tmp_163840, dz2081U_144117);
                    bool bounds_check_163843 = x_163841 && y_163842;
                    bool loop_not_taken_165569 = !cond_157119;
                    bool protect_assert_disj_165570 = bounds_check_163843 || loop_not_taken_165569;
                    bool index_certs_163844;
                    
                    if (!protect_assert_disj_165570) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_163840, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:360:59-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t zm_lhs_157161 = mul32(radix_sizze_144119, min_res_157118);
                    int32_t byteSeq_eq_arg1_157162 = sub32(zm_lhs_157161, 1);
                    int32_t min_res_157163 = smin32(min_arg1_157089, byteSeq_eq_arg1_157162);
                    int32_t zm_rhs_157164 = sdiv32(min_res_157163, 8);
                    int32_t zm_lhs_157165 = sub32(i64_res_156632, zm_rhs_157164);
                    int32_t i32_arg0_157166 = sub32(zm_lhs_157165, 1);
                    int64_t i32_res_157167 = sext_i32_i64(i32_arg0_157166);
                    int64_t min_res_157168 = smin64(min_arg1_156647, i32_res_157167);
                    bool y_157185 = slt64(min_res_157168, b_144114);
                    bool x_157184 = sle64((int64_t) 0, min_res_157168);
                    bool bounds_check_157186 = x_157184 && y_157185;
                    bool index_certs_157187;
                    
                    if (!bounds_check_157186) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157168, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lmad_ext_164971 = b_144114 * cur_S_157111;
                    int64_t tmp_163845;
                    
                    if (cond_157119) {
                        int64_t x_165571 = ((int64_t *) bounds_mem_164932.mem)[tmp_163840];
                        
                        tmp_163845 = x_165571;
                    } else {
                        tmp_163845 = (int64_t) 0;
                    }
                    
                    int64_t lmad_ext_164972 = b_144114 * tmp_163845;
                    int64_t ext_164973;
                    
                    if (cond_157119) {
                        ext_164973 = lmad_ext_164972;
                    } else {
                        ext_164973 = lmad_ext_164971;
                    }
                    if (cond_157119) {
                        bool x_163846 = sle64((int64_t) 0, tmp_163845);
                        bool y_163847 = slt64(tmp_163845, nS_144115);
                        bool bounds_check_163848 = x_163846 && y_163847;
                        bool index_certs_163849;
                        
                        if (!bounds_check_163848) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_163845, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:360:56-81\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                    }
                    
                    int32_t prev_depth_157132;
                    
                    if (cond_157119) {
                        bool index_certs_163855;
                        
                        if (!bounds_check_163843) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_163840, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:361:83-104\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t min_arg1_163856 = ((int32_t *) depths_mem_164933.mem)[tmp_163840];
                        int32_t min_res_163857 = smin32(zeze_lhs_157069, min_arg1_163856);
                        
                        prev_depth_157132 = min_res_163857;
                    } else {
                        prev_depth_157132 = min_res_157118;
                    }
                    
                    bool cond_157140 = slt64(first_spi_157105, last_potential_spi_157082);
                    
                    for (int64_t i_164725 = 0; i_164725 < b_144114; i_164725++) {
                        int8_t eta_p_158176 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164725];
                        int8_t eta_p_158177 = ((int8_t *) pS_mem_164929.mem)[cur_S_157111 * b_144114 + i_164725];
                        bool cond_158179 = sle64(i_164725, i32_res_157091);
                        bool cond_t_res_158180 = sle64(min_res_157168, i_164725);
                        bool x_158181 = cond_158179 && cond_t_res_158180;
                        int8_t lifted_lambda_res_158182;
                        
                        if (x_158181) {
                            lifted_lambda_res_158182 = eta_p_158176;
                        } else {
                            lifted_lambda_res_158182 = (int8_t) 0;
                        }
                        
                        int8_t lifted_lambda_res_158187;
                        
                        if (x_158181) {
                            lifted_lambda_res_158187 = eta_p_158177;
                        } else {
                            lifted_lambda_res_158187 = (int8_t) 0;
                        }
                        ((int8_t *) mem_164974)[i_164725] = lifted_lambda_res_158187;
                        ((int8_t *) mem_164975)[i_164725] = lifted_lambda_res_158182;
                    }
                    
                    int8_t za_lhs_157198 = ((int8_t *) mem_164974)[i32_res_157091];
                    int8_t mod1_x_157199 = (int8_t) -1 & za_lhs_157198;
                    
                    ((int8_t *) mem_164974)[i32_res_157091] = mod1_x_157199;
                    
                    int8_t za_lhs_157201 = ((int8_t *) mem_164974)[min_res_157168];
                    int32_t lastBit_157169 = smod32(min_res_157163, 8);
                    int32_t zm_lhs_157170 = sub32(8, lastBit_157169);
                    int32_t i32_arg0_157171 = sub32(zm_lhs_157170, 1);
                    int8_t unsign_arg0_157172 = zext_i32_i8(i32_arg0_157171);
                    int8_t unsign_arg0_157173 = lshr8((int8_t) -1, unsign_arg0_157172);
                    int8_t tmp_157202 = unsign_arg0_157173 & za_lhs_157201;
                    
                    ((int8_t *) mem_164974)[min_res_157168] = tmp_157202;
                    
                    int8_t za_lhs_157181 = ((int8_t *) mem_164975)[i32_res_157091];
                    int8_t mod1_x_157182 = (int8_t) -1 & za_lhs_157181;
                    
                    ((int8_t *) mem_164975)[i32_res_157091] = mod1_x_157182;
                    
                    int8_t za_lhs_157188 = ((int8_t *) mem_164975)[min_res_157168];
                    int8_t tmp_157189 = unsign_arg0_157173 & za_lhs_157188;
                    
                    ((int8_t *) mem_164975)[min_res_157168] = tmp_157189;
                    
                    bool defunc_0_reduce_res_164081;
                    bool redout_164728 = 1;
                    
                    for (int64_t i_164729 = 0; i_164729 < b_144114; i_164729++) {
                        int8_t eta_p_158170 = ((int8_t *) mem_164975)[i_164729];
                        int8_t eta_p_158171 = ((int8_t *) mem_164974)[i_164729];
                        bool defunc_0_f_res_158172 = eta_p_158170 == eta_p_158171;
                        bool x_157212 = defunc_0_f_res_158172 && redout_164728;
                        bool redout_tmp_165712 = x_157212;
                        
                        redout_164728 = redout_tmp_165712;
                    }
                    defunc_0_reduce_res_164081 = redout_164728;
                    
                    bool cond_157213;
                    
                    if (defunc_0_reduce_res_164081) {
                        bool cond_163861 = first_spi_157105 == spi_157065;
                        bool cond_t_res_163862;
                        
                        if (cond_163861) {
                            cond_t_res_163862 = 1;
                        } else {
                            int32_t zm_lhs_163863 = mul32(radix_sizze_144119, prev_depth_157132);
                            int32_t byteSeq_neq_arg1_163864 = sub32(zm_lhs_163863, 1);
                            int32_t min_res_163865 = smin32(min_arg1_157089, byteSeq_neq_arg1_163864);
                            int32_t zm_rhs_163866 = sdiv32(min_res_163865, 8);
                            int32_t zm_lhs_163867 = sub32(i64_res_156632, zm_rhs_163866);
                            int32_t i32_arg0_163868 = sub32(zm_lhs_163867, 1);
                            int64_t i32_res_163869 = sext_i32_i64(i32_arg0_163868);
                            int64_t min_res_163870 = smin64(min_arg1_156647, i32_res_163869);
                            bool index_certs_163891;
                            
                            if (!bounds_check_157097) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_157091, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool x_163895 = sle64((int64_t) 0, min_res_163870);
                            bool y_163896 = slt64(min_res_163870, b_144114);
                            bool bounds_check_163897 = x_163895 && y_163896;
                            bool index_certs_163898;
                            
                            if (!bounds_check_163897) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_163870, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t lastBit_163871 = smod32(min_res_163865, 8);
                            int32_t zm_lhs_163872 = sub32(8, lastBit_163871);
                            int32_t i32_arg0_163873 = sub32(zm_lhs_163872, 1);
                            int8_t unsign_arg0_163874 = zext_i32_i8(i32_arg0_163873);
                            int8_t unsign_arg0_163875 = lshr8((int8_t) -1, unsign_arg0_163874);
                            
                            if (mem_164988_cached_sizze_165928 < b_144114) {
                                err = lexical_realloc(ctx, &mem_164988, &mem_164988_cached_sizze_165928, b_144114);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_164989_cached_sizze_165929 < b_144114) {
                                err = lexical_realloc(ctx, &mem_164989, &mem_164989_cached_sizze_165929, b_144114);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164734 = 0; i_164734 < b_144114; i_164734++) {
                                int8_t eta_p_163879 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164734];
                                int8_t eta_p_163880 = ((int8_t *) pS_mem_164929.mem)[ext_164973 + i_164734];
                                bool cond_163881 = sle64(i_164734, i32_res_157091);
                                bool cond_t_res_163882 = sle64(min_res_163870, i_164734);
                                bool x_163883 = cond_163881 && cond_t_res_163882;
                                int8_t lifted_lambda_res_163884;
                                
                                if (x_163883) {
                                    lifted_lambda_res_163884 = eta_p_163879;
                                } else {
                                    lifted_lambda_res_163884 = (int8_t) 0;
                                }
                                
                                int8_t lifted_lambda_res_163888;
                                
                                if (x_163883) {
                                    lifted_lambda_res_163888 = eta_p_163880;
                                } else {
                                    lifted_lambda_res_163888 = (int8_t) 0;
                                }
                                ((int8_t *) mem_164988)[i_164734] = lifted_lambda_res_163888;
                                ((int8_t *) mem_164989)[i_164734] = lifted_lambda_res_163884;
                            }
                            
                            int8_t za_lhs_163892 = ((int8_t *) mem_164989)[i32_res_157091];
                            int8_t mod1_x_163893 = (int8_t) -1 & za_lhs_163892;
                            
                            ((int8_t *) mem_164989)[i32_res_157091] = mod1_x_163893;
                            
                            int8_t za_lhs_163899 = ((int8_t *) mem_164989)[min_res_163870];
                            int8_t tmp_163900 = unsign_arg0_163875 & za_lhs_163899;
                            
                            ((int8_t *) mem_164989)[min_res_163870] = tmp_163900;
                            
                            int8_t za_lhs_163902 = ((int8_t *) mem_164988)[i32_res_157091];
                            int8_t mod1_x_163903 = (int8_t) -1 & za_lhs_163902;
                            
                            ((int8_t *) mem_164988)[i32_res_157091] = mod1_x_163903;
                            
                            int8_t za_lhs_163905 = ((int8_t *) mem_164988)[min_res_163870];
                            int8_t tmp_163906 = unsign_arg0_163875 & za_lhs_163905;
                            
                            ((int8_t *) mem_164988)[min_res_163870] = tmp_163906;
                            
                            bool defunc_0_reduce_res_163908;
                            bool redout_164737 = 0;
                            
                            for (int64_t i_164738 = 0; i_164738 < b_144114; i_164738++) {
                                int8_t eta_p_163909 = ((int8_t *) mem_164989)[i_164738];
                                int8_t eta_p_163910 = ((int8_t *) mem_164988)[i_164738];
                                bool defunc_0_f_res_163911 = eta_p_163909 == eta_p_163910;
                                bool defunc_0_f_res_163912 = !defunc_0_f_res_163911;
                                bool defunc_0_op_res_163915 = defunc_0_f_res_163912 || redout_164737;
                                bool redout_tmp_165715 = defunc_0_op_res_163915;
                                
                                redout_164737 = redout_tmp_165715;
                            }
                            defunc_0_reduce_res_163908 = redout_164737;
                            cond_t_res_163862 = defunc_0_reduce_res_163908;
                        }
                        cond_157213 = cond_t_res_163862;
                    } else {
                        cond_157213 = 0;
                    }
                    
                    int32_t next_depth_157153;
                    
                    if (cond_157140) {
                        int64_t min_arg1_163917 = add64((int64_t) 1, first_spi_157105);
                        bool x_163918 = sle64((int64_t) 0, min_arg1_163917);
                        bool y_163919 = slt64(min_arg1_163917, dz2081U_144117);
                        bool bounds_check_163920 = x_163918 && y_163919;
                        bool index_certs_163921;
                        
                        if (!bounds_check_163920) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_arg1_163917, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:363:98-119\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t min_arg1_163922 = ((int32_t *) depths_mem_164933.mem)[min_arg1_163917];
                        int32_t min_res_163923 = smin32(zeze_lhs_157069, min_arg1_163922);
                        
                        next_depth_157153 = min_res_163923;
                    } else {
                        next_depth_157153 = min_res_157118;
                    }
                    
                    bool loop_cond_t_res_157272 = slt32(0, min_res_157118);
                    int64_t loopres_157270;
                    int64_t loopres_157271;
                    
                    if (cond_157213) {
                        loopres_157270 = first_spi_157105;
                        loopres_157271 = (int64_t) 0;
                    } else {
                        bool loop_cond_t_res_157273 = slt64((int64_t) 0, b_144114);
                        
                        if (mem_165002_cached_sizze_165930 < b_144114) {
                            err = lexical_realloc(ctx, &mem_165002, &mem_165002_cached_sizze_165930, b_144114);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_165003_cached_sizze_165931 < b_144114) {
                            err = lexical_realloc(ctx, &mem_165003, &mem_165003_cached_sizze_165931, b_144114);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        
                        bool radix_gt_res_157274;
                        int32_t radix_gt_res_157275;
                        bool radix_gt_res_157276;
                        bool loop_while_157277;
                        int32_t p_157278;
                        bool p_157279;
                        
                        loop_while_157277 = loop_cond_t_res_157272;
                        p_157278 = 0;
                        p_157279 = 0;
                        while (loop_while_157277) {
                            int32_t zt_rhs_157280 = add32(1, p_157278);
                            int32_t zm_lhs_157281 = mul32(radix_sizze_144119, zt_rhs_157280);
                            int32_t byteSeq_lt_arg1_157282 = sub32(zm_lhs_157281, 1);
                            int32_t byteSeq_lt_arg0_157283 = mul32(radix_sizze_144119, p_157278);
                            int32_t min_res_157284 = smin32(min_arg1_157089, byteSeq_lt_arg1_157282);
                            int32_t zm_rhs_157285 = sdiv32(byteSeq_lt_arg0_157283, 8);
                            int32_t zm_lhs_157286 = sub32(i64_res_156632, zm_rhs_157285);
                            int32_t i32_arg0_157287 = sub32(zm_lhs_157286, 1);
                            int64_t i32_res_157288 = sext_i32_i64(i32_arg0_157287);
                            int32_t zm_rhs_157289 = sdiv32(min_res_157284, 8);
                            int32_t zm_lhs_157290 = sub32(i64_res_156632, zm_rhs_157289);
                            int32_t i32_arg0_157291 = sub32(zm_lhs_157290, 1);
                            int64_t i32_res_157292 = sext_i32_i64(i32_arg0_157291);
                            int64_t min_res_157293 = smin64(min_arg1_156647, i32_res_157292);
                            bool x_157309 = sle64((int64_t) 0, i32_res_157288);
                            bool y_157310 = slt64(i32_res_157288, b_144114);
                            bool bounds_check_157311 = x_157309 && y_157310;
                            bool index_certs_157312;
                            
                            if (!bounds_check_157311) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_157288, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool x_157316 = sle64((int64_t) 0, min_res_157293);
                            bool y_157317 = slt64(min_res_157293, b_144114);
                            bool bounds_check_157318 = x_157316 && y_157317;
                            bool index_certs_157319;
                            
                            if (!bounds_check_157318) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157293, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t firstBit_157294 = smod32(byteSeq_lt_arg0_157283, 8);
                            int32_t lastBit_157295 = smod32(min_res_157284, 8);
                            int8_t unsign_arg0_157296 = zext_i32_i8(firstBit_157294);
                            int8_t first_bitMask_157297 = shl8((int8_t) -1, unsign_arg0_157296);
                            int32_t zm_lhs_157298 = sub32(8, lastBit_157295);
                            int32_t i32_arg0_157299 = sub32(zm_lhs_157298, 1);
                            int8_t unsign_arg0_157300 = zext_i32_i8(i32_arg0_157299);
                            int8_t unsign_arg0_157301 = lshr8((int8_t) -1, unsign_arg0_157300);
                            
                            for (int64_t i_164743 = 0; i_164743 < b_144114; i_164743++) {
                                int8_t eta_p_158536 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164743];
                                int8_t eta_p_158537 = ((int8_t *) pS_mem_164929.mem)[cur_S_157111 * b_144114 + i_164743];
                                bool cond_158539 = sle64(i_164743, i32_res_157288);
                                bool cond_t_res_158540 = sle64(min_res_157293, i_164743);
                                bool x_158541 = cond_158539 && cond_t_res_158540;
                                int8_t lifted_lambda_res_158542;
                                
                                if (x_158541) {
                                    lifted_lambda_res_158542 = eta_p_158536;
                                } else {
                                    lifted_lambda_res_158542 = (int8_t) 0;
                                }
                                
                                int8_t lifted_lambda_res_158547;
                                
                                if (x_158541) {
                                    lifted_lambda_res_158547 = eta_p_158537;
                                } else {
                                    lifted_lambda_res_158547 = (int8_t) 0;
                                }
                                ((int8_t *) mem_165002)[i_164743] = lifted_lambda_res_158547;
                                ((int8_t *) mem_165003)[i_164743] = lifted_lambda_res_158542;
                            }
                            
                            int8_t za_lhs_157313 = ((int8_t *) mem_165003)[i32_res_157288];
                            int8_t mod1_x_157314 = first_bitMask_157297 & za_lhs_157313;
                            
                            ((int8_t *) mem_165003)[i32_res_157288] = mod1_x_157314;
                            
                            int8_t za_lhs_157320 = ((int8_t *) mem_165003)[min_res_157293];
                            int8_t tmp_157321 = unsign_arg0_157301 & za_lhs_157320;
                            
                            ((int8_t *) mem_165003)[min_res_157293] = tmp_157321;
                            
                            int8_t za_lhs_157330 = ((int8_t *) mem_165002)[i32_res_157288];
                            int8_t mod1_x_157331 = first_bitMask_157297 & za_lhs_157330;
                            
                            ((int8_t *) mem_165002)[i32_res_157288] = mod1_x_157331;
                            
                            int8_t za_lhs_157333 = ((int8_t *) mem_165002)[min_res_157293];
                            int8_t tmp_157334 = unsign_arg0_157301 & za_lhs_157333;
                            
                            ((int8_t *) mem_165002)[min_res_157293] = tmp_157334;
                            
                            bool byteSeq_lt_res_157336;
                            int64_t byteSeq_lt_res_157337;
                            bool byteSeq_lt_res_157338;
                            bool loop_while_157339;
                            int64_t p_157340;
                            bool p_157341;
                            
                            loop_while_157339 = loop_cond_t_res_157273;
                            p_157340 = (int64_t) 0;
                            p_157341 = 0;
                            while (loop_while_157339) {
                                bool x_157342 = sle64((int64_t) 0, p_157340);
                                bool y_157343 = slt64(p_157340, b_144114);
                                bool bounds_check_157344 = x_157342 && y_157343;
                                bool index_certs_157345;
                                
                                if (!bounds_check_157344) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_157340, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:78:17-27\n   #1  ftHashJoin.fut:177:17-83\n   #2  ftHashJoin.fut:369:20-61\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int8_t zl_lhs_157346 = ((int8_t *) mem_165003)[p_157340];
                                int8_t zl_rhs_157347 = ((int8_t *) mem_165002)[p_157340];
                                bool dlt_157348 = ult8(zl_lhs_157346, zl_rhs_157347);
                                bool dgt_157349 = ult8(zl_rhs_157347, zl_lhs_157346);
                                bool tmp_157350 = dlt_157348 || dgt_157349;
                                bool cond_157351 = !tmp_157350;
                                int64_t tmp_157352;
                                
                                if (cond_157351) {
                                    int64_t tmp_t_res_163924 = add64((int64_t) 1, p_157340);
                                    
                                    tmp_157352 = tmp_t_res_163924;
                                } else {
                                    tmp_157352 = b_144114;
                                }
                                
                                bool cond_157354 = !dlt_157348;
                                bool loop_cond_t_res_157355 = slt64(tmp_157352, b_144114);
                                bool x_157356 = cond_157354 && loop_cond_t_res_157355;
                                bool loop_while_tmp_165721 = x_157356;
                                int64_t p_tmp_165722 = tmp_157352;
                                bool p_tmp_165723 = dlt_157348;
                                
                                loop_while_157339 = loop_while_tmp_165721;
                                p_157340 = p_tmp_165722;
                                p_157341 = p_tmp_165723;
                            }
                            byteSeq_lt_res_157336 = loop_while_157339;
                            byteSeq_lt_res_157337 = p_157340;
                            byteSeq_lt_res_157338 = p_157341;
                            
                            bool byteSeq_gt_res_157357;
                            int64_t byteSeq_gt_res_157358;
                            bool byteSeq_gt_res_157359;
                            bool loop_while_157360;
                            int64_t p_157361;
                            bool p_157362;
                            
                            loop_while_157360 = loop_cond_t_res_157273;
                            p_157361 = (int64_t) 0;
                            p_157362 = 0;
                            while (loop_while_157360) {
                                bool x_157363 = sle64((int64_t) 0, p_157361);
                                bool y_157364 = slt64(p_157361, b_144114);
                                bool bounds_check_157365 = x_157363 && y_157364;
                                bool index_certs_157366;
                                
                                if (!bounds_check_157365) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_157361, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:111:17-27\n   #1  ftHashJoin.fut:178:17-83\n   #2  ftHashJoin.fut:369:20-61\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int8_t zl_lhs_157367 = ((int8_t *) mem_165003)[p_157361];
                                int8_t zl_rhs_157368 = ((int8_t *) mem_165002)[p_157361];
                                bool dlt_157369 = ult8(zl_lhs_157367, zl_rhs_157368);
                                bool dgt_157370 = ult8(zl_rhs_157368, zl_lhs_157367);
                                bool tmp_157371 = dlt_157369 || dgt_157370;
                                bool cond_157372 = !tmp_157371;
                                int64_t tmp_157373;
                                
                                if (cond_157372) {
                                    int64_t tmp_t_res_163925 = add64((int64_t) 1, p_157361);
                                    
                                    tmp_157373 = tmp_t_res_163925;
                                } else {
                                    tmp_157373 = b_144114;
                                }
                                
                                bool cond_157375 = !dgt_157370;
                                bool loop_cond_t_res_157376 = slt64(tmp_157373, b_144114);
                                bool x_157377 = cond_157375 && loop_cond_t_res_157376;
                                bool loop_while_tmp_165724 = x_157377;
                                int64_t p_tmp_165725 = tmp_157373;
                                bool p_tmp_165726 = dgt_157370;
                                
                                loop_while_157360 = loop_while_tmp_165724;
                                p_157361 = p_tmp_165725;
                                p_157362 = p_tmp_165726;
                            }
                            byteSeq_gt_res_157357 = loop_while_157360;
                            byteSeq_gt_res_157358 = p_157361;
                            byteSeq_gt_res_157359 = p_157362;
                            
                            bool tmp_157378 = byteSeq_lt_res_157338 || byteSeq_gt_res_157359;
                            bool cond_157379 = !tmp_157378;
                            int32_t tmp_157380;
                            
                            if (cond_157379) {
                                tmp_157380 = zt_rhs_157280;
                            } else {
                                tmp_157380 = min_res_157118;
                            }
                            
                            bool cond_157381 = !byteSeq_gt_res_157359;
                            bool loop_cond_t_res_157382 = slt32(tmp_157380, min_res_157118);
                            bool x_157383 = cond_157381 && loop_cond_t_res_157382;
                            bool loop_while_tmp_165716 = x_157383;
                            int32_t p_tmp_165717 = tmp_157380;
                            bool p_tmp_165718 = byteSeq_gt_res_157359;
                            
                            loop_while_157277 = loop_while_tmp_165716;
                            p_157278 = p_tmp_165717;
                            p_157279 = p_tmp_165718;
                        }
                        radix_gt_res_157274 = loop_while_157277;
                        radix_gt_res_157275 = p_157278;
                        radix_gt_res_157276 = p_157279;
                        
                        int64_t loopres_f_res_157384;
                        int64_t loopres_f_res_157385;
                        
                        if (radix_gt_res_157276) {
                            bool cond_163943 = first_spi_157105 == last_potential_spi_157082;
                            int64_t tmp_163947 = add64((int64_t) 1, first_spi_157105);
                            bool x_163948 = sle64((int64_t) 0, tmp_163947);
                            bool y_163949 = slt64(tmp_163947, dz2081U_144117);
                            bool bounds_check_163950 = x_163948 && y_163949;
                            bool loop_not_taken_165559 = !cond_157140;
                            bool protect_assert_disj_165560 = bounds_check_163950 || loop_not_taken_165559;
                            bool protect_assert_disj_165591 = cond_163943 || protect_assert_disj_165560;
                            bool index_certs_163951;
                            
                            if (!protect_assert_disj_165591) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_163947, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:362:74-95\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_t_res_163958 = slt32(0, next_depth_157153);
                            bool x_165588 = !cond_163943;
                            bool protect_cond_conj_165592 = cond_157140 && x_165588;
                            int64_t tmp_163952;
                            
                            if (protect_cond_conj_165592) {
                                int64_t x_165561 = ((int64_t *) bounds_mem_164932.mem)[tmp_163947];
                                
                                tmp_163952 = x_165561;
                            } else {
                                tmp_163952 = (int64_t) 0;
                            }
                            
                            int64_t lmad_ext_165031 = b_144114 * tmp_163952;
                            int64_t ext_165032;
                            
                            if (cond_157140) {
                                ext_165032 = lmad_ext_165031;
                            } else {
                                ext_165032 = lmad_ext_164971;
                            }
                            
                            int64_t loopres_f_res_t_res_163944;
                            int64_t loopres_f_res_t_res_163945;
                            
                            if (cond_163943) {
                                loopres_f_res_t_res_163944 = (int64_t) -1;
                                loopres_f_res_t_res_163945 = (int64_t) 0;
                            } else {
                                if (cond_157140) {
                                    bool x_163953 = sle64((int64_t) 0, tmp_163952);
                                    bool y_163954 = slt64(tmp_163952, nS_144115);
                                    bool bounds_check_163955 = x_163953 && y_163954;
                                    bool index_certs_163956;
                                    
                                    if (!bounds_check_163955) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_163952, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:362:71-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                }
                                if (mem_165033_cached_sizze_165934 < b_144114) {
                                    err = lexical_realloc(ctx, &mem_165033, &mem_165033_cached_sizze_165934, b_144114);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (mem_165034_cached_sizze_165935 < b_144114) {
                                    err = lexical_realloc(ctx, &mem_165034, &mem_165034_cached_sizze_165935, b_144114);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                
                                bool radix_lt_res_163959;
                                int32_t radix_lt_res_163960;
                                bool radix_lt_res_163961;
                                bool loop_while_163962;
                                int32_t p_163963;
                                bool p_163964;
                                
                                loop_while_163962 = loop_cond_t_res_163958;
                                p_163963 = 0;
                                p_163964 = 0;
                                while (loop_while_163962) {
                                    int32_t zt_rhs_163965 = add32(1, p_163963);
                                    int32_t zm_lhs_163966 = mul32(radix_sizze_144119, zt_rhs_163965);
                                    int32_t byteSeq_lt_arg1_163967 = sub32(zm_lhs_163966, 1);
                                    int32_t byteSeq_lt_arg0_163968 = mul32(radix_sizze_144119, p_163963);
                                    int32_t min_res_163969 = smin32(min_arg1_157089, byteSeq_lt_arg1_163967);
                                    int32_t zm_rhs_163970 = sdiv32(byteSeq_lt_arg0_163968, 8);
                                    int32_t zm_lhs_163971 = sub32(i64_res_156632, zm_rhs_163970);
                                    int32_t i32_arg0_163972 = sub32(zm_lhs_163971, 1);
                                    int64_t i32_res_163973 = sext_i32_i64(i32_arg0_163972);
                                    int32_t zm_rhs_163974 = sdiv32(min_res_163969, 8);
                                    int32_t zm_lhs_163975 = sub32(i64_res_156632, zm_rhs_163974);
                                    int32_t i32_arg0_163976 = sub32(zm_lhs_163975, 1);
                                    int64_t i32_res_163977 = sext_i32_i64(i32_arg0_163976);
                                    int64_t min_res_163978 = smin64(min_arg1_156647, i32_res_163977);
                                    bool x_164002 = sle64((int64_t) 0, i32_res_163973);
                                    bool y_164003 = slt64(i32_res_163973, b_144114);
                                    bool bounds_check_164004 = x_164002 && y_164003;
                                    bool index_certs_164005;
                                    
                                    if (!bounds_check_164004) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_163973, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_164009 = sle64((int64_t) 0, min_res_163978);
                                    bool y_164010 = slt64(min_res_163978, b_144114);
                                    bool bounds_check_164011 = x_164009 && y_164010;
                                    bool index_certs_164012;
                                    
                                    if (!bounds_check_164011) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_163978, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t firstBit_163979 = smod32(byteSeq_lt_arg0_163968, 8);
                                    int32_t lastBit_163980 = smod32(min_res_163969, 8);
                                    int8_t unsign_arg0_163981 = zext_i32_i8(firstBit_163979);
                                    int8_t first_bitMask_163982 = shl8((int8_t) -1, unsign_arg0_163981);
                                    int32_t zm_lhs_163983 = sub32(8, lastBit_163980);
                                    int32_t i32_arg0_163984 = sub32(zm_lhs_163983, 1);
                                    int8_t unsign_arg0_163985 = zext_i32_i8(i32_arg0_163984);
                                    int8_t unsign_arg0_163986 = lshr8((int8_t) -1, unsign_arg0_163985);
                                    
                                    for (int64_t i_164750 = 0; i_164750 < b_144114; i_164750++) {
                                        int8_t eta_p_163990 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164750];
                                        int8_t eta_p_163991 = ((int8_t *) pS_mem_164929.mem)[ext_165032 + i_164750];
                                        bool cond_163992 = sle64(i_164750, i32_res_163973);
                                        bool cond_t_res_163993 = sle64(min_res_163978, i_164750);
                                        bool x_163994 = cond_163992 && cond_t_res_163993;
                                        int8_t lifted_lambda_res_163995;
                                        
                                        if (x_163994) {
                                            lifted_lambda_res_163995 = eta_p_163990;
                                        } else {
                                            lifted_lambda_res_163995 = (int8_t) 0;
                                        }
                                        
                                        int8_t lifted_lambda_res_163999;
                                        
                                        if (x_163994) {
                                            lifted_lambda_res_163999 = eta_p_163991;
                                        } else {
                                            lifted_lambda_res_163999 = (int8_t) 0;
                                        }
                                        ((int8_t *) mem_165033)[i_164750] = lifted_lambda_res_163999;
                                        ((int8_t *) mem_165034)[i_164750] = lifted_lambda_res_163995;
                                    }
                                    
                                    int8_t za_lhs_164006 = ((int8_t *) mem_165034)[i32_res_163973];
                                    int8_t mod1_x_164007 = first_bitMask_163982 & za_lhs_164006;
                                    
                                    ((int8_t *) mem_165034)[i32_res_163973] = mod1_x_164007;
                                    
                                    int8_t za_lhs_164013 = ((int8_t *) mem_165034)[min_res_163978];
                                    int8_t tmp_164014 = unsign_arg0_163986 & za_lhs_164013;
                                    
                                    ((int8_t *) mem_165034)[min_res_163978] = tmp_164014;
                                    
                                    int8_t za_lhs_164016 = ((int8_t *) mem_165033)[i32_res_163973];
                                    int8_t mod1_x_164017 = first_bitMask_163982 & za_lhs_164016;
                                    
                                    ((int8_t *) mem_165033)[i32_res_163973] = mod1_x_164017;
                                    
                                    int8_t za_lhs_164019 = ((int8_t *) mem_165033)[min_res_163978];
                                    int8_t tmp_164020 = unsign_arg0_163986 & za_lhs_164019;
                                    
                                    ((int8_t *) mem_165033)[min_res_163978] = tmp_164020;
                                    
                                    bool byteSeq_lt_res_164022;
                                    int64_t byteSeq_lt_res_164023;
                                    bool byteSeq_lt_res_164024;
                                    bool loop_while_164025;
                                    int64_t p_164026;
                                    bool p_164027;
                                    
                                    loop_while_164025 = loop_cond_t_res_157273;
                                    p_164026 = (int64_t) 0;
                                    p_164027 = 0;
                                    while (loop_while_164025) {
                                        bool x_164028 = sle64((int64_t) 0, p_164026);
                                        bool y_164029 = slt64(p_164026, b_144114);
                                        bool bounds_check_164030 = x_164028 && y_164029;
                                        bool index_certs_164031;
                                        
                                        if (!bounds_check_164030) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_164026, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:78:17-27\n   #1  ftHashJoin.fut:148:17-83\n   #2  ftHashJoin.fut:372:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int8_t zl_lhs_164032 = ((int8_t *) mem_165034)[p_164026];
                                        int8_t zl_rhs_164033 = ((int8_t *) mem_165033)[p_164026];
                                        bool dlt_164034 = ult8(zl_lhs_164032, zl_rhs_164033);
                                        bool dgt_164035 = ult8(zl_rhs_164033, zl_lhs_164032);
                                        bool tmp_164036 = dlt_164034 || dgt_164035;
                                        bool cond_164037 = !tmp_164036;
                                        int64_t tmp_164038;
                                        
                                        if (cond_164037) {
                                            int64_t tmp_t_res_164039 = add64((int64_t) 1, p_164026);
                                            
                                            tmp_164038 = tmp_t_res_164039;
                                        } else {
                                            tmp_164038 = b_144114;
                                        }
                                        
                                        bool cond_164040 = !dlt_164034;
                                        bool loop_cond_t_res_164041 = slt64(tmp_164038, b_144114);
                                        bool x_164042 = cond_164040 && loop_cond_t_res_164041;
                                        bool loop_while_tmp_165732 = x_164042;
                                        int64_t p_tmp_165733 = tmp_164038;
                                        bool p_tmp_165734 = dlt_164034;
                                        
                                        loop_while_164025 = loop_while_tmp_165732;
                                        p_164026 = p_tmp_165733;
                                        p_164027 = p_tmp_165734;
                                    }
                                    byteSeq_lt_res_164022 = loop_while_164025;
                                    byteSeq_lt_res_164023 = p_164026;
                                    byteSeq_lt_res_164024 = p_164027;
                                    
                                    bool byteSeq_gt_res_164043;
                                    int64_t byteSeq_gt_res_164044;
                                    bool byteSeq_gt_res_164045;
                                    bool loop_while_164046;
                                    int64_t p_164047;
                                    bool p_164048;
                                    
                                    loop_while_164046 = loop_cond_t_res_157273;
                                    p_164047 = (int64_t) 0;
                                    p_164048 = 0;
                                    while (loop_while_164046) {
                                        bool x_164049 = sle64((int64_t) 0, p_164047);
                                        bool y_164050 = slt64(p_164047, b_144114);
                                        bool bounds_check_164051 = x_164049 && y_164050;
                                        bool index_certs_164052;
                                        
                                        if (!bounds_check_164051) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_164047, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:111:17-27\n   #1  ftHashJoin.fut:149:17-83\n   #2  ftHashJoin.fut:372:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int8_t zl_lhs_164053 = ((int8_t *) mem_165034)[p_164047];
                                        int8_t zl_rhs_164054 = ((int8_t *) mem_165033)[p_164047];
                                        bool dlt_164055 = ult8(zl_lhs_164053, zl_rhs_164054);
                                        bool dgt_164056 = ult8(zl_rhs_164054, zl_lhs_164053);
                                        bool tmp_164057 = dlt_164055 || dgt_164056;
                                        bool cond_164058 = !tmp_164057;
                                        int64_t tmp_164059;
                                        
                                        if (cond_164058) {
                                            int64_t tmp_t_res_164060 = add64((int64_t) 1, p_164047);
                                            
                                            tmp_164059 = tmp_t_res_164060;
                                        } else {
                                            tmp_164059 = b_144114;
                                        }
                                        
                                        bool cond_164061 = !dgt_164056;
                                        bool loop_cond_t_res_164062 = slt64(tmp_164059, b_144114);
                                        bool x_164063 = cond_164061 && loop_cond_t_res_164062;
                                        bool loop_while_tmp_165735 = x_164063;
                                        int64_t p_tmp_165736 = tmp_164059;
                                        bool p_tmp_165737 = dgt_164056;
                                        
                                        loop_while_164046 = loop_while_tmp_165735;
                                        p_164047 = p_tmp_165736;
                                        p_164048 = p_tmp_165737;
                                    }
                                    byteSeq_gt_res_164043 = loop_while_164046;
                                    byteSeq_gt_res_164044 = p_164047;
                                    byteSeq_gt_res_164045 = p_164048;
                                    
                                    bool tmp_164064 = byteSeq_lt_res_164024 || byteSeq_gt_res_164045;
                                    bool cond_164065 = !tmp_164064;
                                    int32_t tmp_164066;
                                    
                                    if (cond_164065) {
                                        tmp_164066 = zt_rhs_163965;
                                    } else {
                                        tmp_164066 = next_depth_157153;
                                    }
                                    
                                    bool cond_164067 = !byteSeq_lt_res_164024;
                                    bool loop_cond_t_res_164068 = slt32(tmp_164066, next_depth_157153);
                                    bool x_164069 = cond_164067 && loop_cond_t_res_164068;
                                    bool loop_while_tmp_165727 = x_164069;
                                    int32_t p_tmp_165728 = tmp_164066;
                                    bool p_tmp_165729 = byteSeq_lt_res_164024;
                                    
                                    loop_while_163962 = loop_while_tmp_165727;
                                    p_163963 = p_tmp_165728;
                                    p_163964 = p_tmp_165729;
                                }
                                radix_lt_res_163959 = loop_while_163962;
                                radix_lt_res_163960 = p_163963;
                                radix_lt_res_163961 = p_163964;
                                
                                int64_t loopres_f_res_t_res_f_res_164070;
                                int64_t loopres_f_res_t_res_f_res_164071;
                                
                                if (radix_lt_res_163961) {
                                    loopres_f_res_t_res_f_res_164070 = (int64_t) -1;
                                    loopres_f_res_t_res_f_res_164071 = (int64_t) 0;
                                } else {
                                    int64_t tmp_164072 = add64(first_spi_157105, step_157106);
                                    int64_t max_arg1_164073 = sdiv64(step_157106, (int64_t) 2);
                                    int64_t max_res_164074 = smax64((int64_t) 1, max_arg1_164073);
                                    
                                    loopres_f_res_t_res_f_res_164070 = tmp_164072;
                                    loopres_f_res_t_res_f_res_164071 = max_res_164074;
                                }
                                loopres_f_res_t_res_163944 = loopres_f_res_t_res_f_res_164070;
                                loopres_f_res_t_res_163945 = loopres_f_res_t_res_f_res_164071;
                            }
                            loopres_f_res_157384 = loopres_f_res_t_res_163944;
                            loopres_f_res_157385 = loopres_f_res_t_res_163945;
                        } else {
                            bool cond_157505 = first_spi_157105 == spi_157065;
                            bool loop_cond_t_res_157508 = slt32(0, prev_depth_157132);
                            int64_t loopres_f_res_f_res_157506;
                            int64_t loopres_f_res_f_res_157507;
                            
                            if (cond_157505) {
                                loopres_f_res_f_res_157506 = (int64_t) -1;
                                loopres_f_res_f_res_157507 = (int64_t) 0;
                            } else {
                                if (mem_165016_cached_sizze_165932 < b_144114) {
                                    err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_165932, b_144114);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (mem_165017_cached_sizze_165933 < b_144114) {
                                    err = lexical_realloc(ctx, &mem_165017, &mem_165017_cached_sizze_165933, b_144114);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                
                                bool radix_gt_res_157509;
                                int32_t radix_gt_res_157510;
                                bool radix_gt_res_157511;
                                bool loop_while_157512;
                                int32_t p_157513;
                                bool p_157514;
                                
                                loop_while_157512 = loop_cond_t_res_157508;
                                p_157513 = 0;
                                p_157514 = 0;
                                while (loop_while_157512) {
                                    int32_t zt_rhs_157515 = add32(1, p_157513);
                                    int32_t zm_lhs_157516 = mul32(radix_sizze_144119, zt_rhs_157515);
                                    int32_t byteSeq_lt_arg1_157517 = sub32(zm_lhs_157516, 1);
                                    int32_t byteSeq_lt_arg0_157518 = mul32(radix_sizze_144119, p_157513);
                                    int32_t min_res_157519 = smin32(min_arg1_157089, byteSeq_lt_arg1_157517);
                                    int32_t zm_rhs_157520 = sdiv32(byteSeq_lt_arg0_157518, 8);
                                    int32_t zm_lhs_157521 = sub32(i64_res_156632, zm_rhs_157520);
                                    int32_t i32_arg0_157522 = sub32(zm_lhs_157521, 1);
                                    int64_t i32_res_157523 = sext_i32_i64(i32_arg0_157522);
                                    int32_t zm_rhs_157524 = sdiv32(min_res_157519, 8);
                                    int32_t zm_lhs_157525 = sub32(i64_res_156632, zm_rhs_157524);
                                    int32_t i32_arg0_157526 = sub32(zm_lhs_157525, 1);
                                    int64_t i32_res_157527 = sext_i32_i64(i32_arg0_157526);
                                    int64_t min_res_157528 = smin64(min_arg1_156647, i32_res_157527);
                                    bool x_157544 = sle64((int64_t) 0, i32_res_157523);
                                    bool y_157545 = slt64(i32_res_157523, b_144114);
                                    bool bounds_check_157546 = x_157544 && y_157545;
                                    bool index_certs_157547;
                                    
                                    if (!bounds_check_157546) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_157523, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157551 = sle64((int64_t) 0, min_res_157528);
                                    bool y_157552 = slt64(min_res_157528, b_144114);
                                    bool bounds_check_157553 = x_157551 && y_157552;
                                    bool index_certs_157554;
                                    
                                    if (!bounds_check_157553) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157528, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t firstBit_157529 = smod32(byteSeq_lt_arg0_157518, 8);
                                    int32_t lastBit_157530 = smod32(min_res_157519, 8);
                                    int8_t unsign_arg0_157531 = zext_i32_i8(firstBit_157529);
                                    int8_t first_bitMask_157532 = shl8((int8_t) -1, unsign_arg0_157531);
                                    int32_t zm_lhs_157533 = sub32(8, lastBit_157530);
                                    int32_t i32_arg0_157534 = sub32(zm_lhs_157533, 1);
                                    int8_t unsign_arg0_157535 = zext_i32_i8(i32_arg0_157534);
                                    int8_t unsign_arg0_157536 = lshr8((int8_t) -1, unsign_arg0_157535);
                                    
                                    for (int64_t i_164757 = 0; i_164757 < b_144114; i_164757++) {
                                        int8_t eta_p_158497 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164757];
                                        int8_t eta_p_158498 = ((int8_t *) pS_mem_164929.mem)[ext_164973 + i_164757];
                                        bool cond_158500 = sle64(i_164757, i32_res_157523);
                                        bool cond_t_res_158501 = sle64(min_res_157528, i_164757);
                                        bool x_158502 = cond_158500 && cond_t_res_158501;
                                        int8_t lifted_lambda_res_158503;
                                        
                                        if (x_158502) {
                                            lifted_lambda_res_158503 = eta_p_158497;
                                        } else {
                                            lifted_lambda_res_158503 = (int8_t) 0;
                                        }
                                        
                                        int8_t lifted_lambda_res_158508;
                                        
                                        if (x_158502) {
                                            lifted_lambda_res_158508 = eta_p_158498;
                                        } else {
                                            lifted_lambda_res_158508 = (int8_t) 0;
                                        }
                                        ((int8_t *) mem_165016)[i_164757] = lifted_lambda_res_158508;
                                        ((int8_t *) mem_165017)[i_164757] = lifted_lambda_res_158503;
                                    }
                                    
                                    int8_t za_lhs_157548 = ((int8_t *) mem_165017)[i32_res_157523];
                                    int8_t mod1_x_157549 = first_bitMask_157532 & za_lhs_157548;
                                    
                                    ((int8_t *) mem_165017)[i32_res_157523] = mod1_x_157549;
                                    
                                    int8_t za_lhs_157555 = ((int8_t *) mem_165017)[min_res_157528];
                                    int8_t tmp_157556 = unsign_arg0_157536 & za_lhs_157555;
                                    
                                    ((int8_t *) mem_165017)[min_res_157528] = tmp_157556;
                                    
                                    int8_t za_lhs_157565 = ((int8_t *) mem_165016)[i32_res_157523];
                                    int8_t mod1_x_157566 = first_bitMask_157532 & za_lhs_157565;
                                    
                                    ((int8_t *) mem_165016)[i32_res_157523] = mod1_x_157566;
                                    
                                    int8_t za_lhs_157568 = ((int8_t *) mem_165016)[min_res_157528];
                                    int8_t tmp_157569 = unsign_arg0_157536 & za_lhs_157568;
                                    
                                    ((int8_t *) mem_165016)[min_res_157528] = tmp_157569;
                                    
                                    bool byteSeq_lt_res_157571;
                                    int64_t byteSeq_lt_res_157572;
                                    bool byteSeq_lt_res_157573;
                                    bool loop_while_157574;
                                    int64_t p_157575;
                                    bool p_157576;
                                    
                                    loop_while_157574 = loop_cond_t_res_157273;
                                    p_157575 = (int64_t) 0;
                                    p_157576 = 0;
                                    while (loop_while_157574) {
                                        bool x_157577 = sle64((int64_t) 0, p_157575);
                                        bool y_157578 = slt64(p_157575, b_144114);
                                        bool bounds_check_157579 = x_157577 && y_157578;
                                        bool index_certs_157580;
                                        
                                        if (!bounds_check_157579) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_157575, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:78:17-27\n   #1  ftHashJoin.fut:177:17-83\n   #2  ftHashJoin.fut:376:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int8_t zl_lhs_157581 = ((int8_t *) mem_165017)[p_157575];
                                        int8_t zl_rhs_157582 = ((int8_t *) mem_165016)[p_157575];
                                        bool dlt_157583 = ult8(zl_lhs_157581, zl_rhs_157582);
                                        bool dgt_157584 = ult8(zl_rhs_157582, zl_lhs_157581);
                                        bool tmp_157585 = dlt_157583 || dgt_157584;
                                        bool cond_157586 = !tmp_157585;
                                        int64_t tmp_157587;
                                        
                                        if (cond_157586) {
                                            int64_t tmp_t_res_164075 = add64((int64_t) 1, p_157575);
                                            
                                            tmp_157587 = tmp_t_res_164075;
                                        } else {
                                            tmp_157587 = b_144114;
                                        }
                                        
                                        bool cond_157589 = !dlt_157583;
                                        bool loop_cond_t_res_157590 = slt64(tmp_157587, b_144114);
                                        bool x_157591 = cond_157589 && loop_cond_t_res_157590;
                                        bool loop_while_tmp_165743 = x_157591;
                                        int64_t p_tmp_165744 = tmp_157587;
                                        bool p_tmp_165745 = dlt_157583;
                                        
                                        loop_while_157574 = loop_while_tmp_165743;
                                        p_157575 = p_tmp_165744;
                                        p_157576 = p_tmp_165745;
                                    }
                                    byteSeq_lt_res_157571 = loop_while_157574;
                                    byteSeq_lt_res_157572 = p_157575;
                                    byteSeq_lt_res_157573 = p_157576;
                                    
                                    bool byteSeq_gt_res_157592;
                                    int64_t byteSeq_gt_res_157593;
                                    bool byteSeq_gt_res_157594;
                                    bool loop_while_157595;
                                    int64_t p_157596;
                                    bool p_157597;
                                    
                                    loop_while_157595 = loop_cond_t_res_157273;
                                    p_157596 = (int64_t) 0;
                                    p_157597 = 0;
                                    while (loop_while_157595) {
                                        bool x_157598 = sle64((int64_t) 0, p_157596);
                                        bool y_157599 = slt64(p_157596, b_144114);
                                        bool bounds_check_157600 = x_157598 && y_157599;
                                        bool index_certs_157601;
                                        
                                        if (!bounds_check_157600) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_157596, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:111:17-27\n   #1  ftHashJoin.fut:178:17-83\n   #2  ftHashJoin.fut:376:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int8_t zl_lhs_157602 = ((int8_t *) mem_165017)[p_157596];
                                        int8_t zl_rhs_157603 = ((int8_t *) mem_165016)[p_157596];
                                        bool dlt_157604 = ult8(zl_lhs_157602, zl_rhs_157603);
                                        bool dgt_157605 = ult8(zl_rhs_157603, zl_lhs_157602);
                                        bool tmp_157606 = dlt_157604 || dgt_157605;
                                        bool cond_157607 = !tmp_157606;
                                        int64_t tmp_157608;
                                        
                                        if (cond_157607) {
                                            int64_t tmp_t_res_164076 = add64((int64_t) 1, p_157596);
                                            
                                            tmp_157608 = tmp_t_res_164076;
                                        } else {
                                            tmp_157608 = b_144114;
                                        }
                                        
                                        bool cond_157610 = !dgt_157605;
                                        bool loop_cond_t_res_157611 = slt64(tmp_157608, b_144114);
                                        bool x_157612 = cond_157610 && loop_cond_t_res_157611;
                                        bool loop_while_tmp_165746 = x_157612;
                                        int64_t p_tmp_165747 = tmp_157608;
                                        bool p_tmp_165748 = dgt_157605;
                                        
                                        loop_while_157595 = loop_while_tmp_165746;
                                        p_157596 = p_tmp_165747;
                                        p_157597 = p_tmp_165748;
                                    }
                                    byteSeq_gt_res_157592 = loop_while_157595;
                                    byteSeq_gt_res_157593 = p_157596;
                                    byteSeq_gt_res_157594 = p_157597;
                                    
                                    bool tmp_157613 = byteSeq_lt_res_157573 || byteSeq_gt_res_157594;
                                    bool cond_157614 = !tmp_157613;
                                    int32_t tmp_157615;
                                    
                                    if (cond_157614) {
                                        tmp_157615 = zt_rhs_157515;
                                    } else {
                                        tmp_157615 = prev_depth_157132;
                                    }
                                    
                                    bool cond_157616 = !byteSeq_gt_res_157594;
                                    bool loop_cond_t_res_157617 = slt32(tmp_157615, prev_depth_157132);
                                    bool x_157618 = cond_157616 && loop_cond_t_res_157617;
                                    bool loop_while_tmp_165738 = x_157618;
                                    int32_t p_tmp_165739 = tmp_157615;
                                    bool p_tmp_165740 = byteSeq_gt_res_157594;
                                    
                                    loop_while_157512 = loop_while_tmp_165738;
                                    p_157513 = p_tmp_165739;
                                    p_157514 = p_tmp_165740;
                                }
                                radix_gt_res_157509 = loop_while_157512;
                                radix_gt_res_157510 = p_157513;
                                radix_gt_res_157511 = p_157514;
                                
                                int64_t loopres_f_res_f_res_f_res_157619;
                                int64_t loopres_f_res_f_res_f_res_157620;
                                
                                if (radix_gt_res_157511) {
                                    loopres_f_res_f_res_f_res_157619 = (int64_t) -1;
                                    loopres_f_res_f_res_f_res_157620 = (int64_t) 0;
                                } else {
                                    int64_t tmp_157621 = sub64(first_spi_157105, step_157106);
                                    int64_t max_arg1_157622 = sdiv64(step_157106, (int64_t) 2);
                                    int64_t max_res_157623 = smax64((int64_t) 1, max_arg1_157622);
                                    
                                    loopres_f_res_f_res_f_res_157619 = tmp_157621;
                                    loopres_f_res_f_res_f_res_157620 = max_res_157623;
                                }
                                loopres_f_res_f_res_157506 = loopres_f_res_f_res_f_res_157619;
                                loopres_f_res_f_res_157507 = loopres_f_res_f_res_f_res_157620;
                            }
                            loopres_f_res_157384 = loopres_f_res_f_res_157506;
                            loopres_f_res_157385 = loopres_f_res_f_res_157507;
                        }
                        loopres_157270 = loopres_f_res_157384;
                        loopres_157271 = loopres_f_res_157385;
                    }
                    
                    bool loop_cond_157624 = slt64((int64_t) 0, loopres_157271);
                    bool loop_while_tmp_165707 = loop_cond_157624;
                    int64_t first_spi_tmp_165708 = loopres_157270;
                    int64_t step_tmp_165709 = loopres_157271;
                    
                    loop_while_157104 = loop_while_tmp_165707;
                    first_spi_157105 = first_spi_tmp_165708;
                    step_157106 = step_tmp_165709;
                }
                lifted_lambda_res_f_res_f_res_157101 = loop_while_157104;
                lifted_lambda_res_f_res_f_res_157102 = first_spi_157105;
                lifted_lambda_res_f_res_f_res_157103 = step_157106;
                
                bool cond_157625 = slt64(lifted_lambda_res_f_res_f_res_157102, (int64_t) 0);
                int64_t lifted_lambda_res_f_res_f_res_157626;
                
                if (cond_157625) {
                    lifted_lambda_res_f_res_f_res_157626 = lifted_lambda_res_f_res_f_res_157102;
                } else {
                    if (mem_165047_cached_sizze_165936 < b_144114) {
                        err = lexical_realloc(ctx, &mem_165047, &mem_165047_cached_sizze_165936, b_144114);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165048_cached_sizze_165937 < b_144114) {
                        err = lexical_realloc(ctx, &mem_165048, &mem_165048_cached_sizze_165937, b_144114);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    
                    bool lifted_lambda_res_f_res_f_res_f_res_157627;
                    int64_t lifted_lambda_res_f_res_f_res_f_res_157628;
                    int64_t lifted_lambda_res_f_res_f_res_f_res_157629;
                    bool loop_while_157630;
                    int64_t last_spi_157631;
                    int64_t step_157632;
                    
                    loop_while_157630 = loop_cond_157086;
                    last_spi_157631 = last_potential_spi_157082;
                    step_157632 = max_res_157085;
                    while (loop_while_157630) {
                        bool x_157633 = sle64((int64_t) 0, last_spi_157631);
                        bool y_157634 = slt64(last_spi_157631, dz2081U_144117);
                        bool bounds_check_157635 = x_157633 && y_157634;
                        bool index_certs_157636;
                        
                        if (!bounds_check_157635) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) last_spi_157631, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:382:32-50\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t cur_S_157637 = ((int64_t *) bounds_mem_164932.mem)[last_spi_157631];
                        bool x_157638 = sle64((int64_t) 0, cur_S_157637);
                        bool y_157639 = slt64(cur_S_157637, nS_144115);
                        bool bounds_check_157640 = x_157638 && y_157639;
                        bool index_certs_157641;
                        
                        if (!bounds_check_157640) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_157637, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:382:29-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t min_arg1_157643 = ((int32_t *) depths_mem_164933.mem)[last_spi_157631];
                        int32_t min_res_157644 = smin32(zeze_lhs_157069, min_arg1_157643);
                        int32_t zm_lhs_157687 = mul32(radix_sizze_144119, min_res_157644);
                        int32_t byteSeq_eq_arg1_157688 = sub32(zm_lhs_157687, 1);
                        int32_t min_res_157689 = smin32(min_arg1_157089, byteSeq_eq_arg1_157688);
                        int32_t zm_rhs_157690 = sdiv32(min_res_157689, 8);
                        int32_t zm_lhs_157691 = sub32(i64_res_156632, zm_rhs_157690);
                        int32_t i32_arg0_157692 = sub32(zm_lhs_157691, 1);
                        int64_t i32_res_157693 = sext_i32_i64(i32_arg0_157692);
                        int64_t min_res_157694 = smin64(min_arg1_156647, i32_res_157693);
                        bool y_157711 = slt64(min_res_157694, b_144114);
                        bool x_157710 = sle64((int64_t) 0, min_res_157694);
                        bool bounds_check_157712 = x_157710 && y_157711;
                        bool index_certs_157713;
                        
                        if (!bounds_check_157712) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157694, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_157666 = slt64(last_spi_157631, last_potential_spi_157082);
                        int64_t tmp_164089 = add64((int64_t) 1, last_spi_157631);
                        bool x_164090 = sle64((int64_t) 0, tmp_164089);
                        bool y_164091 = slt64(tmp_164089, dz2081U_144117);
                        bool bounds_check_164092 = x_164090 && y_164091;
                        bool loop_not_taken_165549 = !cond_157666;
                        bool protect_assert_disj_165550 = bounds_check_164092 || loop_not_taken_165549;
                        bool index_certs_164093;
                        
                        if (!protect_assert_disj_165550) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_164089, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:386:73-93\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_157645 = slt64(spi_157065, last_spi_157631);
                        
                        for (int64_t i_164764 = 0; i_164764 < b_144114; i_164764++) {
                            int8_t eta_p_159185 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164764];
                            int8_t eta_p_159186 = ((int8_t *) pS_mem_164929.mem)[cur_S_157637 * b_144114 + i_164764];
                            bool cond_159188 = sle64(i_164764, i32_res_157091);
                            bool cond_t_res_159189 = sle64(min_res_157694, i_164764);
                            bool x_159190 = cond_159188 && cond_t_res_159189;
                            int8_t lifted_lambda_res_159191;
                            
                            if (x_159190) {
                                lifted_lambda_res_159191 = eta_p_159185;
                            } else {
                                lifted_lambda_res_159191 = (int8_t) 0;
                            }
                            
                            int8_t lifted_lambda_res_159196;
                            
                            if (x_159190) {
                                lifted_lambda_res_159196 = eta_p_159186;
                            } else {
                                lifted_lambda_res_159196 = (int8_t) 0;
                            }
                            ((int8_t *) mem_165047)[i_164764] = lifted_lambda_res_159196;
                            ((int8_t *) mem_165048)[i_164764] = lifted_lambda_res_159191;
                        }
                        
                        int8_t za_lhs_157724 = ((int8_t *) mem_165047)[i32_res_157091];
                        int8_t mod1_x_157725 = (int8_t) -1 & za_lhs_157724;
                        
                        ((int8_t *) mem_165047)[i32_res_157091] = mod1_x_157725;
                        
                        int8_t za_lhs_157727 = ((int8_t *) mem_165047)[min_res_157694];
                        int32_t lastBit_157695 = smod32(min_res_157689, 8);
                        int32_t zm_lhs_157696 = sub32(8, lastBit_157695);
                        int32_t i32_arg0_157697 = sub32(zm_lhs_157696, 1);
                        int8_t unsign_arg0_157698 = zext_i32_i8(i32_arg0_157697);
                        int8_t unsign_arg0_157699 = lshr8((int8_t) -1, unsign_arg0_157698);
                        int8_t tmp_157728 = unsign_arg0_157699 & za_lhs_157727;
                        
                        ((int8_t *) mem_165047)[min_res_157694] = tmp_157728;
                        
                        int8_t za_lhs_157707 = ((int8_t *) mem_165048)[i32_res_157091];
                        int8_t mod1_x_157708 = (int8_t) -1 & za_lhs_157707;
                        
                        ((int8_t *) mem_165048)[i32_res_157091] = mod1_x_157708;
                        
                        int8_t za_lhs_157714 = ((int8_t *) mem_165048)[min_res_157694];
                        int8_t tmp_157715 = unsign_arg0_157699 & za_lhs_157714;
                        
                        ((int8_t *) mem_165048)[min_res_157694] = tmp_157715;
                        
                        bool defunc_0_reduce_res_164311;
                        bool redout_164767 = 1;
                        
                        for (int64_t i_164768 = 0; i_164768 < b_144114; i_164768++) {
                            int8_t eta_p_159179 = ((int8_t *) mem_165048)[i_164768];
                            int8_t eta_p_159180 = ((int8_t *) mem_165047)[i_164768];
                            bool defunc_0_f_res_159181 = eta_p_159179 == eta_p_159180;
                            bool x_157738 = defunc_0_f_res_159181 && redout_164767;
                            bool redout_tmp_165754 = x_157738;
                            
                            redout_164767 = redout_tmp_165754;
                        }
                        defunc_0_reduce_res_164311 = redout_164767;
                        
                        int32_t next_depth_157679;
                        
                        if (cond_157666) {
                            bool index_certs_164086;
                            
                            if (!bounds_check_164092) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_164089, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:387:97-117\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t min_arg1_164087 = ((int32_t *) depths_mem_164933.mem)[tmp_164089];
                            int32_t min_res_164088 = smin32(zeze_lhs_157069, min_arg1_164087);
                            
                            next_depth_157679 = min_res_164088;
                        } else {
                            next_depth_157679 = min_res_157644;
                        }
                        
                        int64_t lmad_ext_165061 = b_144114 * cur_S_157637;
                        int64_t tmp_164094;
                        
                        if (cond_157666) {
                            int64_t x_165551 = ((int64_t *) bounds_mem_164932.mem)[tmp_164089];
                            
                            tmp_164094 = x_165551;
                        } else {
                            tmp_164094 = (int64_t) 0;
                        }
                        
                        int64_t lmad_ext_165062 = b_144114 * tmp_164094;
                        int64_t ext_165063;
                        
                        if (cond_157666) {
                            ext_165063 = lmad_ext_165062;
                        } else {
                            ext_165063 = lmad_ext_165061;
                        }
                        if (cond_157666) {
                            bool x_164095 = sle64((int64_t) 0, tmp_164094);
                            bool y_164096 = slt64(tmp_164094, nS_144115);
                            bool bounds_check_164097 = x_164095 && y_164096;
                            bool index_certs_164098;
                            
                            if (!bounds_check_164097) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_164094, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:386:70-94\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                        }
                        
                        bool cond_157739;
                        
                        if (defunc_0_reduce_res_164311) {
                            bool cond_164103 = last_spi_157631 == last_potential_spi_157082;
                            bool cond_t_res_164104;
                            
                            if (cond_164103) {
                                cond_t_res_164104 = 1;
                            } else {
                                int32_t zm_lhs_164105 = mul32(radix_sizze_144119, next_depth_157679);
                                int32_t byteSeq_neq_arg1_164106 = sub32(zm_lhs_164105, 1);
                                int32_t min_res_164107 = smin32(min_arg1_157089, byteSeq_neq_arg1_164106);
                                int32_t zm_rhs_164108 = sdiv32(min_res_164107, 8);
                                int32_t zm_lhs_164109 = sub32(i64_res_156632, zm_rhs_164108);
                                int32_t i32_arg0_164110 = sub32(zm_lhs_164109, 1);
                                int64_t i32_res_164111 = sext_i32_i64(i32_arg0_164110);
                                int64_t min_res_164112 = smin64(min_arg1_156647, i32_res_164111);
                                bool index_certs_164133;
                                
                                if (!bounds_check_157097) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_157091, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_164137 = sle64((int64_t) 0, min_res_164112);
                                bool y_164138 = slt64(min_res_164112, b_144114);
                                bool bounds_check_164139 = x_164137 && y_164138;
                                bool index_certs_164140;
                                
                                if (!bounds_check_164139) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_164112, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t lastBit_164113 = smod32(min_res_164107, 8);
                                int32_t zm_lhs_164114 = sub32(8, lastBit_164113);
                                int32_t i32_arg0_164115 = sub32(zm_lhs_164114, 1);
                                int8_t unsign_arg0_164116 = zext_i32_i8(i32_arg0_164115);
                                int8_t unsign_arg0_164117 = lshr8((int8_t) -1, unsign_arg0_164116);
                                
                                if (mem_165064_cached_sizze_165938 < b_144114) {
                                    err = lexical_realloc(ctx, &mem_165064, &mem_165064_cached_sizze_165938, b_144114);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                if (mem_165065_cached_sizze_165939 < b_144114) {
                                    err = lexical_realloc(ctx, &mem_165065, &mem_165065_cached_sizze_165939, b_144114);
                                    if (err != FUTHARK_SUCCESS)
                                        goto cleanup;
                                }
                                for (int64_t i_164773 = 0; i_164773 < b_144114; i_164773++) {
                                    int8_t eta_p_164121 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164773];
                                    int8_t eta_p_164122 = ((int8_t *) pS_mem_164929.mem)[ext_165063 + i_164773];
                                    bool cond_164123 = sle64(i_164773, i32_res_157091);
                                    bool cond_t_res_164124 = sle64(min_res_164112, i_164773);
                                    bool x_164125 = cond_164123 && cond_t_res_164124;
                                    int8_t lifted_lambda_res_164126;
                                    
                                    if (x_164125) {
                                        lifted_lambda_res_164126 = eta_p_164121;
                                    } else {
                                        lifted_lambda_res_164126 = (int8_t) 0;
                                    }
                                    
                                    int8_t lifted_lambda_res_164130;
                                    
                                    if (x_164125) {
                                        lifted_lambda_res_164130 = eta_p_164122;
                                    } else {
                                        lifted_lambda_res_164130 = (int8_t) 0;
                                    }
                                    ((int8_t *) mem_165064)[i_164773] = lifted_lambda_res_164130;
                                    ((int8_t *) mem_165065)[i_164773] = lifted_lambda_res_164126;
                                }
                                
                                int8_t za_lhs_164134 = ((int8_t *) mem_165065)[i32_res_157091];
                                int8_t mod1_x_164135 = (int8_t) -1 & za_lhs_164134;
                                
                                ((int8_t *) mem_165065)[i32_res_157091] = mod1_x_164135;
                                
                                int8_t za_lhs_164141 = ((int8_t *) mem_165065)[min_res_164112];
                                int8_t tmp_164142 = unsign_arg0_164117 & za_lhs_164141;
                                
                                ((int8_t *) mem_165065)[min_res_164112] = tmp_164142;
                                
                                int8_t za_lhs_164144 = ((int8_t *) mem_165064)[i32_res_157091];
                                int8_t mod1_x_164145 = (int8_t) -1 & za_lhs_164144;
                                
                                ((int8_t *) mem_165064)[i32_res_157091] = mod1_x_164145;
                                
                                int8_t za_lhs_164147 = ((int8_t *) mem_165064)[min_res_164112];
                                int8_t tmp_164148 = unsign_arg0_164117 & za_lhs_164147;
                                
                                ((int8_t *) mem_165064)[min_res_164112] = tmp_164148;
                                
                                bool defunc_0_reduce_res_164150;
                                bool redout_164776 = 0;
                                
                                for (int64_t i_164777 = 0; i_164777 < b_144114; i_164777++) {
                                    int8_t eta_p_164151 = ((int8_t *) mem_165065)[i_164777];
                                    int8_t eta_p_164152 = ((int8_t *) mem_165064)[i_164777];
                                    bool defunc_0_f_res_164153 = eta_p_164151 == eta_p_164152;
                                    bool defunc_0_f_res_164154 = !defunc_0_f_res_164153;
                                    bool defunc_0_op_res_164157 = defunc_0_f_res_164154 || redout_164776;
                                    bool redout_tmp_165757 = defunc_0_op_res_164157;
                                    
                                    redout_164776 = redout_tmp_165757;
                                }
                                defunc_0_reduce_res_164150 = redout_164776;
                                cond_t_res_164104 = defunc_0_reduce_res_164150;
                            }
                            cond_157739 = cond_t_res_164104;
                        } else {
                            cond_157739 = 0;
                        }
                        
                        int32_t prev_depth_157658;
                        
                        if (cond_157645) {
                            int64_t min_arg1_164159 = sub64(last_spi_157631, (int64_t) 1);
                            bool x_164160 = sle64((int64_t) 0, min_arg1_164159);
                            bool y_164161 = slt64(min_arg1_164159, dz2081U_144117);
                            bool bounds_check_164162 = x_164160 && y_164161;
                            bool index_certs_164163;
                            
                            if (!bounds_check_164162) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_arg1_164159, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:385:82-102\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t min_arg1_164164 = ((int32_t *) depths_mem_164933.mem)[min_arg1_164159];
                            int32_t min_res_164165 = smin32(zeze_lhs_157069, min_arg1_164164);
                            
                            prev_depth_157658 = min_res_164165;
                        } else {
                            prev_depth_157658 = min_res_157644;
                        }
                        
                        bool loop_cond_t_res_157798 = slt32(0, min_res_157644);
                        int64_t loopres_157796;
                        int64_t loopres_157797;
                        
                        if (cond_157739) {
                            loopres_157796 = last_spi_157631;
                            loopres_157797 = (int64_t) 0;
                        } else {
                            bool loop_cond_t_res_157799 = slt64((int64_t) 0, b_144114);
                            
                            if (mem_165078_cached_sizze_165940 < b_144114) {
                                err = lexical_realloc(ctx, &mem_165078, &mem_165078_cached_sizze_165940, b_144114);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_165079_cached_sizze_165941 < b_144114) {
                                err = lexical_realloc(ctx, &mem_165079, &mem_165079_cached_sizze_165941, b_144114);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            
                            bool radix_gt_res_157800;
                            int32_t radix_gt_res_157801;
                            bool radix_gt_res_157802;
                            bool loop_while_157803;
                            int32_t p_157804;
                            bool p_157805;
                            
                            loop_while_157803 = loop_cond_t_res_157798;
                            p_157804 = 0;
                            p_157805 = 0;
                            while (loop_while_157803) {
                                int32_t zt_rhs_157806 = add32(1, p_157804);
                                int32_t zm_lhs_157807 = mul32(radix_sizze_144119, zt_rhs_157806);
                                int32_t byteSeq_lt_arg1_157808 = sub32(zm_lhs_157807, 1);
                                int32_t byteSeq_lt_arg0_157809 = mul32(radix_sizze_144119, p_157804);
                                int32_t min_res_157810 = smin32(min_arg1_157089, byteSeq_lt_arg1_157808);
                                int32_t zm_rhs_157811 = sdiv32(byteSeq_lt_arg0_157809, 8);
                                int32_t zm_lhs_157812 = sub32(i64_res_156632, zm_rhs_157811);
                                int32_t i32_arg0_157813 = sub32(zm_lhs_157812, 1);
                                int64_t i32_res_157814 = sext_i32_i64(i32_arg0_157813);
                                int32_t zm_rhs_157815 = sdiv32(min_res_157810, 8);
                                int32_t zm_lhs_157816 = sub32(i64_res_156632, zm_rhs_157815);
                                int32_t i32_arg0_157817 = sub32(zm_lhs_157816, 1);
                                int64_t i32_res_157818 = sext_i32_i64(i32_arg0_157817);
                                int64_t min_res_157819 = smin64(min_arg1_156647, i32_res_157818);
                                bool x_157835 = sle64((int64_t) 0, i32_res_157814);
                                bool y_157836 = slt64(i32_res_157814, b_144114);
                                bool bounds_check_157837 = x_157835 && y_157836;
                                bool index_certs_157838;
                                
                                if (!bounds_check_157837) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_157814, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157842 = sle64((int64_t) 0, min_res_157819);
                                bool y_157843 = slt64(min_res_157819, b_144114);
                                bool bounds_check_157844 = x_157842 && y_157843;
                                bool index_certs_157845;
                                
                                if (!bounds_check_157844) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157819, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t firstBit_157820 = smod32(byteSeq_lt_arg0_157809, 8);
                                int32_t lastBit_157821 = smod32(min_res_157810, 8);
                                int8_t unsign_arg0_157822 = zext_i32_i8(firstBit_157820);
                                int8_t first_bitMask_157823 = shl8((int8_t) -1, unsign_arg0_157822);
                                int32_t zm_lhs_157824 = sub32(8, lastBit_157821);
                                int32_t i32_arg0_157825 = sub32(zm_lhs_157824, 1);
                                int8_t unsign_arg0_157826 = zext_i32_i8(i32_arg0_157825);
                                int8_t unsign_arg0_157827 = lshr8((int8_t) -1, unsign_arg0_157826);
                                
                                for (int64_t i_164782 = 0; i_164782 < b_144114; i_164782++) {
                                    int8_t eta_p_159515 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164782];
                                    int8_t eta_p_159516 = ((int8_t *) pS_mem_164929.mem)[cur_S_157637 * b_144114 + i_164782];
                                    bool cond_159518 = sle64(i_164782, i32_res_157814);
                                    bool cond_t_res_159519 = sle64(min_res_157819, i_164782);
                                    bool x_159520 = cond_159518 && cond_t_res_159519;
                                    int8_t lifted_lambda_res_159521;
                                    
                                    if (x_159520) {
                                        lifted_lambda_res_159521 = eta_p_159515;
                                    } else {
                                        lifted_lambda_res_159521 = (int8_t) 0;
                                    }
                                    
                                    int8_t lifted_lambda_res_159526;
                                    
                                    if (x_159520) {
                                        lifted_lambda_res_159526 = eta_p_159516;
                                    } else {
                                        lifted_lambda_res_159526 = (int8_t) 0;
                                    }
                                    ((int8_t *) mem_165078)[i_164782] = lifted_lambda_res_159526;
                                    ((int8_t *) mem_165079)[i_164782] = lifted_lambda_res_159521;
                                }
                                
                                int8_t za_lhs_157839 = ((int8_t *) mem_165079)[i32_res_157814];
                                int8_t mod1_x_157840 = first_bitMask_157823 & za_lhs_157839;
                                
                                ((int8_t *) mem_165079)[i32_res_157814] = mod1_x_157840;
                                
                                int8_t za_lhs_157846 = ((int8_t *) mem_165079)[min_res_157819];
                                int8_t tmp_157847 = unsign_arg0_157827 & za_lhs_157846;
                                
                                ((int8_t *) mem_165079)[min_res_157819] = tmp_157847;
                                
                                int8_t za_lhs_157856 = ((int8_t *) mem_165078)[i32_res_157814];
                                int8_t mod1_x_157857 = first_bitMask_157823 & za_lhs_157856;
                                
                                ((int8_t *) mem_165078)[i32_res_157814] = mod1_x_157857;
                                
                                int8_t za_lhs_157859 = ((int8_t *) mem_165078)[min_res_157819];
                                int8_t tmp_157860 = unsign_arg0_157827 & za_lhs_157859;
                                
                                ((int8_t *) mem_165078)[min_res_157819] = tmp_157860;
                                
                                bool byteSeq_lt_res_157862;
                                int64_t byteSeq_lt_res_157863;
                                bool byteSeq_lt_res_157864;
                                bool loop_while_157865;
                                int64_t p_157866;
                                bool p_157867;
                                
                                loop_while_157865 = loop_cond_t_res_157799;
                                p_157866 = (int64_t) 0;
                                p_157867 = 0;
                                while (loop_while_157865) {
                                    bool x_157868 = sle64((int64_t) 0, p_157866);
                                    bool y_157869 = slt64(p_157866, b_144114);
                                    bool bounds_check_157870 = x_157868 && y_157869;
                                    bool index_certs_157871;
                                    
                                    if (!bounds_check_157870) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_157866, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:78:17-27\n   #1  ftHashJoin.fut:177:17-83\n   #2  ftHashJoin.fut:393:20-61\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int8_t zl_lhs_157872 = ((int8_t *) mem_165079)[p_157866];
                                    int8_t zl_rhs_157873 = ((int8_t *) mem_165078)[p_157866];
                                    bool dlt_157874 = ult8(zl_lhs_157872, zl_rhs_157873);
                                    bool dgt_157875 = ult8(zl_rhs_157873, zl_lhs_157872);
                                    bool tmp_157876 = dlt_157874 || dgt_157875;
                                    bool cond_157877 = !tmp_157876;
                                    int64_t tmp_157878;
                                    
                                    if (cond_157877) {
                                        int64_t tmp_t_res_164166 = add64((int64_t) 1, p_157866);
                                        
                                        tmp_157878 = tmp_t_res_164166;
                                    } else {
                                        tmp_157878 = b_144114;
                                    }
                                    
                                    bool cond_157880 = !dlt_157874;
                                    bool loop_cond_t_res_157881 = slt64(tmp_157878, b_144114);
                                    bool x_157882 = cond_157880 && loop_cond_t_res_157881;
                                    bool loop_while_tmp_165763 = x_157882;
                                    int64_t p_tmp_165764 = tmp_157878;
                                    bool p_tmp_165765 = dlt_157874;
                                    
                                    loop_while_157865 = loop_while_tmp_165763;
                                    p_157866 = p_tmp_165764;
                                    p_157867 = p_tmp_165765;
                                }
                                byteSeq_lt_res_157862 = loop_while_157865;
                                byteSeq_lt_res_157863 = p_157866;
                                byteSeq_lt_res_157864 = p_157867;
                                
                                bool byteSeq_gt_res_157883;
                                int64_t byteSeq_gt_res_157884;
                                bool byteSeq_gt_res_157885;
                                bool loop_while_157886;
                                int64_t p_157887;
                                bool p_157888;
                                
                                loop_while_157886 = loop_cond_t_res_157799;
                                p_157887 = (int64_t) 0;
                                p_157888 = 0;
                                while (loop_while_157886) {
                                    bool x_157889 = sle64((int64_t) 0, p_157887);
                                    bool y_157890 = slt64(p_157887, b_144114);
                                    bool bounds_check_157891 = x_157889 && y_157890;
                                    bool index_certs_157892;
                                    
                                    if (!bounds_check_157891) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_157887, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:111:17-27\n   #1  ftHashJoin.fut:178:17-83\n   #2  ftHashJoin.fut:393:20-61\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int8_t zl_lhs_157893 = ((int8_t *) mem_165079)[p_157887];
                                    int8_t zl_rhs_157894 = ((int8_t *) mem_165078)[p_157887];
                                    bool dlt_157895 = ult8(zl_lhs_157893, zl_rhs_157894);
                                    bool dgt_157896 = ult8(zl_rhs_157894, zl_lhs_157893);
                                    bool tmp_157897 = dlt_157895 || dgt_157896;
                                    bool cond_157898 = !tmp_157897;
                                    int64_t tmp_157899;
                                    
                                    if (cond_157898) {
                                        int64_t tmp_t_res_164167 = add64((int64_t) 1, p_157887);
                                        
                                        tmp_157899 = tmp_t_res_164167;
                                    } else {
                                        tmp_157899 = b_144114;
                                    }
                                    
                                    bool cond_157901 = !dgt_157896;
                                    bool loop_cond_t_res_157902 = slt64(tmp_157899, b_144114);
                                    bool x_157903 = cond_157901 && loop_cond_t_res_157902;
                                    bool loop_while_tmp_165766 = x_157903;
                                    int64_t p_tmp_165767 = tmp_157899;
                                    bool p_tmp_165768 = dgt_157896;
                                    
                                    loop_while_157886 = loop_while_tmp_165766;
                                    p_157887 = p_tmp_165767;
                                    p_157888 = p_tmp_165768;
                                }
                                byteSeq_gt_res_157883 = loop_while_157886;
                                byteSeq_gt_res_157884 = p_157887;
                                byteSeq_gt_res_157885 = p_157888;
                                
                                bool tmp_157904 = byteSeq_lt_res_157864 || byteSeq_gt_res_157885;
                                bool cond_157905 = !tmp_157904;
                                int32_t tmp_157906;
                                
                                if (cond_157905) {
                                    tmp_157906 = zt_rhs_157806;
                                } else {
                                    tmp_157906 = min_res_157644;
                                }
                                
                                bool cond_157907 = !byteSeq_gt_res_157885;
                                bool loop_cond_t_res_157908 = slt32(tmp_157906, min_res_157644);
                                bool x_157909 = cond_157907 && loop_cond_t_res_157908;
                                bool loop_while_tmp_165758 = x_157909;
                                int32_t p_tmp_165759 = tmp_157906;
                                bool p_tmp_165760 = byteSeq_gt_res_157885;
                                
                                loop_while_157803 = loop_while_tmp_165758;
                                p_157804 = p_tmp_165759;
                                p_157805 = p_tmp_165760;
                            }
                            radix_gt_res_157800 = loop_while_157803;
                            radix_gt_res_157801 = p_157804;
                            radix_gt_res_157802 = p_157805;
                            
                            int64_t loopres_f_res_157910;
                            int64_t loopres_f_res_157911;
                            
                            if (radix_gt_res_157802) {
                                bool cond_164174 = last_spi_157631 == last_potential_spi_157082;
                                bool loop_cond_t_res_164177 = slt32(0, next_depth_157679);
                                int64_t loopres_f_res_t_res_164175;
                                int64_t loopres_f_res_t_res_164176;
                                
                                if (cond_164174) {
                                    loopres_f_res_t_res_164175 = (int64_t) -1;
                                    loopres_f_res_t_res_164176 = (int64_t) 0;
                                } else {
                                    if (mem_165109_cached_sizze_165944 < b_144114) {
                                        err = lexical_realloc(ctx, &mem_165109, &mem_165109_cached_sizze_165944, b_144114);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_165110_cached_sizze_165945 < b_144114) {
                                        err = lexical_realloc(ctx, &mem_165110, &mem_165110_cached_sizze_165945, b_144114);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    
                                    bool radix_lt_res_164178;
                                    int32_t radix_lt_res_164179;
                                    bool radix_lt_res_164180;
                                    bool loop_while_164181;
                                    int32_t p_164182;
                                    bool p_164183;
                                    
                                    loop_while_164181 = loop_cond_t_res_164177;
                                    p_164182 = 0;
                                    p_164183 = 0;
                                    while (loop_while_164181) {
                                        int32_t zt_rhs_164184 = add32(1, p_164182);
                                        int32_t zm_lhs_164185 = mul32(radix_sizze_144119, zt_rhs_164184);
                                        int32_t byteSeq_lt_arg1_164186 = sub32(zm_lhs_164185, 1);
                                        int32_t byteSeq_lt_arg0_164187 = mul32(radix_sizze_144119, p_164182);
                                        int32_t min_res_164188 = smin32(min_arg1_157089, byteSeq_lt_arg1_164186);
                                        int32_t zm_rhs_164189 = sdiv32(byteSeq_lt_arg0_164187, 8);
                                        int32_t zm_lhs_164190 = sub32(i64_res_156632, zm_rhs_164189);
                                        int32_t i32_arg0_164191 = sub32(zm_lhs_164190, 1);
                                        int64_t i32_res_164192 = sext_i32_i64(i32_arg0_164191);
                                        int32_t zm_rhs_164193 = sdiv32(min_res_164188, 8);
                                        int32_t zm_lhs_164194 = sub32(i64_res_156632, zm_rhs_164193);
                                        int32_t i32_arg0_164195 = sub32(zm_lhs_164194, 1);
                                        int64_t i32_res_164196 = sext_i32_i64(i32_arg0_164195);
                                        int64_t min_res_164197 = smin64(min_arg1_156647, i32_res_164196);
                                        bool x_164221 = sle64((int64_t) 0, i32_res_164192);
                                        bool y_164222 = slt64(i32_res_164192, b_144114);
                                        bool bounds_check_164223 = x_164221 && y_164222;
                                        bool index_certs_164224;
                                        
                                        if (!bounds_check_164223) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_164192, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_164228 = sle64((int64_t) 0, min_res_164197);
                                        bool y_164229 = slt64(min_res_164197, b_144114);
                                        bool bounds_check_164230 = x_164228 && y_164229;
                                        bool index_certs_164231;
                                        
                                        if (!bounds_check_164230) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_164197, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t firstBit_164198 = smod32(byteSeq_lt_arg0_164187, 8);
                                        int32_t lastBit_164199 = smod32(min_res_164188, 8);
                                        int8_t unsign_arg0_164200 = zext_i32_i8(firstBit_164198);
                                        int8_t first_bitMask_164201 = shl8((int8_t) -1, unsign_arg0_164200);
                                        int32_t zm_lhs_164202 = sub32(8, lastBit_164199);
                                        int32_t i32_arg0_164203 = sub32(zm_lhs_164202, 1);
                                        int8_t unsign_arg0_164204 = zext_i32_i8(i32_arg0_164203);
                                        int8_t unsign_arg0_164205 = lshr8((int8_t) -1, unsign_arg0_164204);
                                        
                                        for (int64_t i_164789 = 0; i_164789 < b_144114; i_164789++) {
                                            int8_t eta_p_164209 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164789];
                                            int8_t eta_p_164210 = ((int8_t *) pS_mem_164929.mem)[ext_165063 + i_164789];
                                            bool cond_164211 = sle64(i_164789, i32_res_164192);
                                            bool cond_t_res_164212 = sle64(min_res_164197, i_164789);
                                            bool x_164213 = cond_164211 && cond_t_res_164212;
                                            int8_t lifted_lambda_res_164214;
                                            
                                            if (x_164213) {
                                                lifted_lambda_res_164214 = eta_p_164209;
                                            } else {
                                                lifted_lambda_res_164214 = (int8_t) 0;
                                            }
                                            
                                            int8_t lifted_lambda_res_164218;
                                            
                                            if (x_164213) {
                                                lifted_lambda_res_164218 = eta_p_164210;
                                            } else {
                                                lifted_lambda_res_164218 = (int8_t) 0;
                                            }
                                            ((int8_t *) mem_165109)[i_164789] = lifted_lambda_res_164218;
                                            ((int8_t *) mem_165110)[i_164789] = lifted_lambda_res_164214;
                                        }
                                        
                                        int8_t za_lhs_164225 = ((int8_t *) mem_165110)[i32_res_164192];
                                        int8_t mod1_x_164226 = first_bitMask_164201 & za_lhs_164225;
                                        
                                        ((int8_t *) mem_165110)[i32_res_164192] = mod1_x_164226;
                                        
                                        int8_t za_lhs_164232 = ((int8_t *) mem_165110)[min_res_164197];
                                        int8_t tmp_164233 = unsign_arg0_164205 & za_lhs_164232;
                                        
                                        ((int8_t *) mem_165110)[min_res_164197] = tmp_164233;
                                        
                                        int8_t za_lhs_164235 = ((int8_t *) mem_165109)[i32_res_164192];
                                        int8_t mod1_x_164236 = first_bitMask_164201 & za_lhs_164235;
                                        
                                        ((int8_t *) mem_165109)[i32_res_164192] = mod1_x_164236;
                                        
                                        int8_t za_lhs_164238 = ((int8_t *) mem_165109)[min_res_164197];
                                        int8_t tmp_164239 = unsign_arg0_164205 & za_lhs_164238;
                                        
                                        ((int8_t *) mem_165109)[min_res_164197] = tmp_164239;
                                        
                                        bool byteSeq_lt_res_164241;
                                        int64_t byteSeq_lt_res_164242;
                                        bool byteSeq_lt_res_164243;
                                        bool loop_while_164244;
                                        int64_t p_164245;
                                        bool p_164246;
                                        
                                        loop_while_164244 = loop_cond_t_res_157799;
                                        p_164245 = (int64_t) 0;
                                        p_164246 = 0;
                                        while (loop_while_164244) {
                                            bool x_164247 = sle64((int64_t) 0, p_164245);
                                            bool y_164248 = slt64(p_164245, b_144114);
                                            bool bounds_check_164249 = x_164247 && y_164248;
                                            bool index_certs_164250;
                                            
                                            if (!bounds_check_164249) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_164245, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:78:17-27\n   #1  ftHashJoin.fut:148:17-83\n   #2  ftHashJoin.fut:396:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_164251 = ((int8_t *) mem_165110)[p_164245];
                                            int8_t zl_rhs_164252 = ((int8_t *) mem_165109)[p_164245];
                                            bool dlt_164253 = ult8(zl_lhs_164251, zl_rhs_164252);
                                            bool dgt_164254 = ult8(zl_rhs_164252, zl_lhs_164251);
                                            bool tmp_164255 = dlt_164253 || dgt_164254;
                                            bool cond_164256 = !tmp_164255;
                                            int64_t tmp_164257;
                                            
                                            if (cond_164256) {
                                                int64_t tmp_t_res_164258 = add64((int64_t) 1, p_164245);
                                                
                                                tmp_164257 = tmp_t_res_164258;
                                            } else {
                                                tmp_164257 = b_144114;
                                            }
                                            
                                            bool cond_164259 = !dlt_164253;
                                            bool loop_cond_t_res_164260 = slt64(tmp_164257, b_144114);
                                            bool x_164261 = cond_164259 && loop_cond_t_res_164260;
                                            bool loop_while_tmp_165774 = x_164261;
                                            int64_t p_tmp_165775 = tmp_164257;
                                            bool p_tmp_165776 = dlt_164253;
                                            
                                            loop_while_164244 = loop_while_tmp_165774;
                                            p_164245 = p_tmp_165775;
                                            p_164246 = p_tmp_165776;
                                        }
                                        byteSeq_lt_res_164241 = loop_while_164244;
                                        byteSeq_lt_res_164242 = p_164245;
                                        byteSeq_lt_res_164243 = p_164246;
                                        
                                        bool byteSeq_gt_res_164262;
                                        int64_t byteSeq_gt_res_164263;
                                        bool byteSeq_gt_res_164264;
                                        bool loop_while_164265;
                                        int64_t p_164266;
                                        bool p_164267;
                                        
                                        loop_while_164265 = loop_cond_t_res_157799;
                                        p_164266 = (int64_t) 0;
                                        p_164267 = 0;
                                        while (loop_while_164265) {
                                            bool x_164268 = sle64((int64_t) 0, p_164266);
                                            bool y_164269 = slt64(p_164266, b_144114);
                                            bool bounds_check_164270 = x_164268 && y_164269;
                                            bool index_certs_164271;
                                            
                                            if (!bounds_check_164270) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_164266, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:111:17-27\n   #1  ftHashJoin.fut:149:17-83\n   #2  ftHashJoin.fut:396:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_164272 = ((int8_t *) mem_165110)[p_164266];
                                            int8_t zl_rhs_164273 = ((int8_t *) mem_165109)[p_164266];
                                            bool dlt_164274 = ult8(zl_lhs_164272, zl_rhs_164273);
                                            bool dgt_164275 = ult8(zl_rhs_164273, zl_lhs_164272);
                                            bool tmp_164276 = dlt_164274 || dgt_164275;
                                            bool cond_164277 = !tmp_164276;
                                            int64_t tmp_164278;
                                            
                                            if (cond_164277) {
                                                int64_t tmp_t_res_164279 = add64((int64_t) 1, p_164266);
                                                
                                                tmp_164278 = tmp_t_res_164279;
                                            } else {
                                                tmp_164278 = b_144114;
                                            }
                                            
                                            bool cond_164280 = !dgt_164275;
                                            bool loop_cond_t_res_164281 = slt64(tmp_164278, b_144114);
                                            bool x_164282 = cond_164280 && loop_cond_t_res_164281;
                                            bool loop_while_tmp_165777 = x_164282;
                                            int64_t p_tmp_165778 = tmp_164278;
                                            bool p_tmp_165779 = dgt_164275;
                                            
                                            loop_while_164265 = loop_while_tmp_165777;
                                            p_164266 = p_tmp_165778;
                                            p_164267 = p_tmp_165779;
                                        }
                                        byteSeq_gt_res_164262 = loop_while_164265;
                                        byteSeq_gt_res_164263 = p_164266;
                                        byteSeq_gt_res_164264 = p_164267;
                                        
                                        bool tmp_164283 = byteSeq_lt_res_164243 || byteSeq_gt_res_164264;
                                        bool cond_164284 = !tmp_164283;
                                        int32_t tmp_164285;
                                        
                                        if (cond_164284) {
                                            tmp_164285 = zt_rhs_164184;
                                        } else {
                                            tmp_164285 = next_depth_157679;
                                        }
                                        
                                        bool cond_164286 = !byteSeq_lt_res_164243;
                                        bool loop_cond_t_res_164287 = slt32(tmp_164285, next_depth_157679);
                                        bool x_164288 = cond_164286 && loop_cond_t_res_164287;
                                        bool loop_while_tmp_165769 = x_164288;
                                        int32_t p_tmp_165770 = tmp_164285;
                                        bool p_tmp_165771 = byteSeq_lt_res_164243;
                                        
                                        loop_while_164181 = loop_while_tmp_165769;
                                        p_164182 = p_tmp_165770;
                                        p_164183 = p_tmp_165771;
                                    }
                                    radix_lt_res_164178 = loop_while_164181;
                                    radix_lt_res_164179 = p_164182;
                                    radix_lt_res_164180 = p_164183;
                                    
                                    int64_t loopres_f_res_t_res_f_res_164289;
                                    int64_t loopres_f_res_t_res_f_res_164290;
                                    
                                    if (radix_lt_res_164180) {
                                        loopres_f_res_t_res_f_res_164289 = (int64_t) -1;
                                        loopres_f_res_t_res_f_res_164290 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_164291 = add64(last_spi_157631, step_157632);
                                        int64_t max_arg1_164292 = sdiv64(step_157632, (int64_t) 2);
                                        int64_t max_res_164293 = smax64((int64_t) 1, max_arg1_164292);
                                        
                                        loopres_f_res_t_res_f_res_164289 = tmp_164291;
                                        loopres_f_res_t_res_f_res_164290 = max_res_164293;
                                    }
                                    loopres_f_res_t_res_164175 = loopres_f_res_t_res_f_res_164289;
                                    loopres_f_res_t_res_164176 = loopres_f_res_t_res_f_res_164290;
                                }
                                loopres_f_res_157910 = loopres_f_res_t_res_164175;
                                loopres_f_res_157911 = loopres_f_res_t_res_164176;
                            } else {
                                bool cond_158031 = last_spi_157631 == spi_157065;
                                int64_t tmp_164294 = sub64(last_spi_157631, (int64_t) 1);
                                bool x_164295 = sle64((int64_t) 0, tmp_164294);
                                bool y_164296 = slt64(tmp_164294, dz2081U_144117);
                                bool bounds_check_164297 = x_164295 && y_164296;
                                bool loop_not_taken_165541 = !cond_157645;
                                bool protect_assert_disj_165542 = bounds_check_164297 || loop_not_taken_165541;
                                bool protect_assert_disj_165586 = cond_158031 || protect_assert_disj_165542;
                                bool index_certs_164298;
                                
                                if (!protect_assert_disj_165586) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_164294, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:384:58-78\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_t_res_158034 = slt32(0, prev_depth_157658);
                                bool x_165583 = !cond_158031;
                                bool protect_cond_conj_165587 = cond_157645 && x_165583;
                                int64_t tmp_164299;
                                
                                if (protect_cond_conj_165587) {
                                    int64_t x_165543 = ((int64_t *) bounds_mem_164932.mem)[tmp_164294];
                                    
                                    tmp_164299 = x_165543;
                                } else {
                                    tmp_164299 = (int64_t) 0;
                                }
                                
                                int64_t lmad_ext_165093 = b_144114 * tmp_164299;
                                int64_t ext_165094;
                                
                                if (cond_157645) {
                                    ext_165094 = lmad_ext_165093;
                                } else {
                                    ext_165094 = lmad_ext_165061;
                                }
                                
                                int64_t loopres_f_res_f_res_158032;
                                int64_t loopres_f_res_f_res_158033;
                                
                                if (cond_158031) {
                                    loopres_f_res_f_res_158032 = (int64_t) -1;
                                    loopres_f_res_f_res_158033 = (int64_t) 0;
                                } else {
                                    if (cond_157645) {
                                        bool x_164300 = sle64((int64_t) 0, tmp_164299);
                                        bool y_164301 = slt64(tmp_164299, nS_144115);
                                        bool bounds_check_164302 = x_164300 && y_164301;
                                        bool index_certs_164303;
                                        
                                        if (!bounds_check_164302) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_164299, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:384:55-79\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:338:8-404:6\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                    }
                                    if (mem_165095_cached_sizze_165942 < b_144114) {
                                        err = lexical_realloc(ctx, &mem_165095, &mem_165095_cached_sizze_165942, b_144114);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    if (mem_165096_cached_sizze_165943 < b_144114) {
                                        err = lexical_realloc(ctx, &mem_165096, &mem_165096_cached_sizze_165943, b_144114);
                                        if (err != FUTHARK_SUCCESS)
                                            goto cleanup;
                                    }
                                    
                                    bool radix_gt_res_158035;
                                    int32_t radix_gt_res_158036;
                                    bool radix_gt_res_158037;
                                    bool loop_while_158038;
                                    int32_t p_158039;
                                    bool p_158040;
                                    
                                    loop_while_158038 = loop_cond_t_res_158034;
                                    p_158039 = 0;
                                    p_158040 = 0;
                                    while (loop_while_158038) {
                                        int32_t zt_rhs_158041 = add32(1, p_158039);
                                        int32_t zm_lhs_158042 = mul32(radix_sizze_144119, zt_rhs_158041);
                                        int32_t byteSeq_lt_arg1_158043 = sub32(zm_lhs_158042, 1);
                                        int32_t byteSeq_lt_arg0_158044 = mul32(radix_sizze_144119, p_158039);
                                        int32_t min_res_158045 = smin32(min_arg1_157089, byteSeq_lt_arg1_158043);
                                        int32_t zm_rhs_158046 = sdiv32(byteSeq_lt_arg0_158044, 8);
                                        int32_t zm_lhs_158047 = sub32(i64_res_156632, zm_rhs_158046);
                                        int32_t i32_arg0_158048 = sub32(zm_lhs_158047, 1);
                                        int64_t i32_res_158049 = sext_i32_i64(i32_arg0_158048);
                                        int32_t zm_rhs_158050 = sdiv32(min_res_158045, 8);
                                        int32_t zm_lhs_158051 = sub32(i64_res_156632, zm_rhs_158050);
                                        int32_t i32_arg0_158052 = sub32(zm_lhs_158051, 1);
                                        int64_t i32_res_158053 = sext_i32_i64(i32_arg0_158052);
                                        int64_t min_res_158054 = smin64(min_arg1_156647, i32_res_158053);
                                        bool x_158070 = sle64((int64_t) 0, i32_res_158049);
                                        bool y_158071 = slt64(i32_res_158049, b_144114);
                                        bool bounds_check_158072 = x_158070 && y_158071;
                                        bool index_certs_158073;
                                        
                                        if (!bounds_check_158072) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_158049, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_158077 = sle64((int64_t) 0, min_res_158054);
                                        bool y_158078 = slt64(min_res_158054, b_144114);
                                        bool bounds_check_158079 = x_158077 && y_158078;
                                        bool index_certs_158080;
                                        
                                        if (!bounds_check_158079) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_158054, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t firstBit_158055 = smod32(byteSeq_lt_arg0_158044, 8);
                                        int32_t lastBit_158056 = smod32(min_res_158045, 8);
                                        int8_t unsign_arg0_158057 = zext_i32_i8(firstBit_158055);
                                        int8_t first_bitMask_158058 = shl8((int8_t) -1, unsign_arg0_158057);
                                        int32_t zm_lhs_158059 = sub32(8, lastBit_158056);
                                        int32_t i32_arg0_158060 = sub32(zm_lhs_158059, 1);
                                        int8_t unsign_arg0_158061 = zext_i32_i8(i32_arg0_158060);
                                        int8_t unsign_arg0_158062 = lshr8((int8_t) -1, unsign_arg0_158061);
                                        
                                        for (int64_t i_164796 = 0; i_164796 < b_144114; i_164796++) {
                                            int8_t eta_p_159442 = ((int8_t *) pR_mem_164928.mem)[radix_to_idx_arg1_157028 * b_144114 + i_164796];
                                            int8_t eta_p_159443 = ((int8_t *) pS_mem_164929.mem)[ext_165094 + i_164796];
                                            bool cond_159445 = sle64(i_164796, i32_res_158049);
                                            bool cond_t_res_159446 = sle64(min_res_158054, i_164796);
                                            bool x_159447 = cond_159445 && cond_t_res_159446;
                                            int8_t lifted_lambda_res_159448;
                                            
                                            if (x_159447) {
                                                lifted_lambda_res_159448 = eta_p_159442;
                                            } else {
                                                lifted_lambda_res_159448 = (int8_t) 0;
                                            }
                                            
                                            int8_t lifted_lambda_res_159453;
                                            
                                            if (x_159447) {
                                                lifted_lambda_res_159453 = eta_p_159443;
                                            } else {
                                                lifted_lambda_res_159453 = (int8_t) 0;
                                            }
                                            ((int8_t *) mem_165095)[i_164796] = lifted_lambda_res_159453;
                                            ((int8_t *) mem_165096)[i_164796] = lifted_lambda_res_159448;
                                        }
                                        
                                        int8_t za_lhs_158074 = ((int8_t *) mem_165096)[i32_res_158049];
                                        int8_t mod1_x_158075 = first_bitMask_158058 & za_lhs_158074;
                                        
                                        ((int8_t *) mem_165096)[i32_res_158049] = mod1_x_158075;
                                        
                                        int8_t za_lhs_158081 = ((int8_t *) mem_165096)[min_res_158054];
                                        int8_t tmp_158082 = unsign_arg0_158062 & za_lhs_158081;
                                        
                                        ((int8_t *) mem_165096)[min_res_158054] = tmp_158082;
                                        
                                        int8_t za_lhs_158091 = ((int8_t *) mem_165095)[i32_res_158049];
                                        int8_t mod1_x_158092 = first_bitMask_158058 & za_lhs_158091;
                                        
                                        ((int8_t *) mem_165095)[i32_res_158049] = mod1_x_158092;
                                        
                                        int8_t za_lhs_158094 = ((int8_t *) mem_165095)[min_res_158054];
                                        int8_t tmp_158095 = unsign_arg0_158062 & za_lhs_158094;
                                        
                                        ((int8_t *) mem_165095)[min_res_158054] = tmp_158095;
                                        
                                        bool byteSeq_lt_res_158097;
                                        int64_t byteSeq_lt_res_158098;
                                        bool byteSeq_lt_res_158099;
                                        bool loop_while_158100;
                                        int64_t p_158101;
                                        bool p_158102;
                                        
                                        loop_while_158100 = loop_cond_t_res_157799;
                                        p_158101 = (int64_t) 0;
                                        p_158102 = 0;
                                        while (loop_while_158100) {
                                            bool x_158103 = sle64((int64_t) 0, p_158101);
                                            bool y_158104 = slt64(p_158101, b_144114);
                                            bool bounds_check_158105 = x_158103 && y_158104;
                                            bool index_certs_158106;
                                            
                                            if (!bounds_check_158105) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_158101, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:78:17-27\n   #1  ftHashJoin.fut:177:17-83\n   #2  ftHashJoin.fut:400:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_158107 = ((int8_t *) mem_165096)[p_158101];
                                            int8_t zl_rhs_158108 = ((int8_t *) mem_165095)[p_158101];
                                            bool dlt_158109 = ult8(zl_lhs_158107, zl_rhs_158108);
                                            bool dgt_158110 = ult8(zl_rhs_158108, zl_lhs_158107);
                                            bool tmp_158111 = dlt_158109 || dgt_158110;
                                            bool cond_158112 = !tmp_158111;
                                            int64_t tmp_158113;
                                            
                                            if (cond_158112) {
                                                int64_t tmp_t_res_164305 = add64((int64_t) 1, p_158101);
                                                
                                                tmp_158113 = tmp_t_res_164305;
                                            } else {
                                                tmp_158113 = b_144114;
                                            }
                                            
                                            bool cond_158115 = !dlt_158109;
                                            bool loop_cond_t_res_158116 = slt64(tmp_158113, b_144114);
                                            bool x_158117 = cond_158115 && loop_cond_t_res_158116;
                                            bool loop_while_tmp_165785 = x_158117;
                                            int64_t p_tmp_165786 = tmp_158113;
                                            bool p_tmp_165787 = dlt_158109;
                                            
                                            loop_while_158100 = loop_while_tmp_165785;
                                            p_158101 = p_tmp_165786;
                                            p_158102 = p_tmp_165787;
                                        }
                                        byteSeq_lt_res_158097 = loop_while_158100;
                                        byteSeq_lt_res_158098 = p_158101;
                                        byteSeq_lt_res_158099 = p_158102;
                                        
                                        bool byteSeq_gt_res_158118;
                                        int64_t byteSeq_gt_res_158119;
                                        bool byteSeq_gt_res_158120;
                                        bool loop_while_158121;
                                        int64_t p_158122;
                                        bool p_158123;
                                        
                                        loop_while_158121 = loop_cond_t_res_157799;
                                        p_158122 = (int64_t) 0;
                                        p_158123 = 0;
                                        while (loop_while_158121) {
                                            bool x_158124 = sle64((int64_t) 0, p_158122);
                                            bool y_158125 = slt64(p_158122, b_144114);
                                            bool bounds_check_158126 = x_158124 && y_158125;
                                            bool index_certs_158127;
                                            
                                            if (!bounds_check_158126) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_158122, "] out of bounds for array of shape [", (long long) b_144114, "].", "-> #0  ftHashJoin.fut:111:17-27\n   #1  ftHashJoin.fut:178:17-83\n   #2  ftHashJoin.fut:400:23-66\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftHashJoin.fut:338:8-404:6\n   #5  ftRelational.fut:318:4-328:18\n   #6  ftRelational.fut:312:1-330:70\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int8_t zl_lhs_158128 = ((int8_t *) mem_165096)[p_158122];
                                            int8_t zl_rhs_158129 = ((int8_t *) mem_165095)[p_158122];
                                            bool dlt_158130 = ult8(zl_lhs_158128, zl_rhs_158129);
                                            bool dgt_158131 = ult8(zl_rhs_158129, zl_lhs_158128);
                                            bool tmp_158132 = dlt_158130 || dgt_158131;
                                            bool cond_158133 = !tmp_158132;
                                            int64_t tmp_158134;
                                            
                                            if (cond_158133) {
                                                int64_t tmp_t_res_164306 = add64((int64_t) 1, p_158122);
                                                
                                                tmp_158134 = tmp_t_res_164306;
                                            } else {
                                                tmp_158134 = b_144114;
                                            }
                                            
                                            bool cond_158136 = !dgt_158131;
                                            bool loop_cond_t_res_158137 = slt64(tmp_158134, b_144114);
                                            bool x_158138 = cond_158136 && loop_cond_t_res_158137;
                                            bool loop_while_tmp_165788 = x_158138;
                                            int64_t p_tmp_165789 = tmp_158134;
                                            bool p_tmp_165790 = dgt_158131;
                                            
                                            loop_while_158121 = loop_while_tmp_165788;
                                            p_158122 = p_tmp_165789;
                                            p_158123 = p_tmp_165790;
                                        }
                                        byteSeq_gt_res_158118 = loop_while_158121;
                                        byteSeq_gt_res_158119 = p_158122;
                                        byteSeq_gt_res_158120 = p_158123;
                                        
                                        bool tmp_158139 = byteSeq_lt_res_158099 || byteSeq_gt_res_158120;
                                        bool cond_158140 = !tmp_158139;
                                        int32_t tmp_158141;
                                        
                                        if (cond_158140) {
                                            tmp_158141 = zt_rhs_158041;
                                        } else {
                                            tmp_158141 = prev_depth_157658;
                                        }
                                        
                                        bool cond_158142 = !byteSeq_gt_res_158120;
                                        bool loop_cond_t_res_158143 = slt32(tmp_158141, prev_depth_157658);
                                        bool x_158144 = cond_158142 && loop_cond_t_res_158143;
                                        bool loop_while_tmp_165780 = x_158144;
                                        int32_t p_tmp_165781 = tmp_158141;
                                        bool p_tmp_165782 = byteSeq_gt_res_158120;
                                        
                                        loop_while_158038 = loop_while_tmp_165780;
                                        p_158039 = p_tmp_165781;
                                        p_158040 = p_tmp_165782;
                                    }
                                    radix_gt_res_158035 = loop_while_158038;
                                    radix_gt_res_158036 = p_158039;
                                    radix_gt_res_158037 = p_158040;
                                    
                                    int64_t loopres_f_res_f_res_f_res_158145;
                                    int64_t loopres_f_res_f_res_f_res_158146;
                                    
                                    if (radix_gt_res_158037) {
                                        loopres_f_res_f_res_f_res_158145 = (int64_t) -1;
                                        loopres_f_res_f_res_f_res_158146 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_158147 = sub64(last_spi_157631, step_157632);
                                        int64_t max_arg1_158148 = sdiv64(step_157632, (int64_t) 2);
                                        int64_t max_res_158149 = smax64((int64_t) 1, max_arg1_158148);
                                        
                                        loopres_f_res_f_res_f_res_158145 = tmp_158147;
                                        loopres_f_res_f_res_f_res_158146 = max_res_158149;
                                    }
                                    loopres_f_res_f_res_158032 = loopres_f_res_f_res_f_res_158145;
                                    loopres_f_res_f_res_158033 = loopres_f_res_f_res_f_res_158146;
                                }
                                loopres_f_res_157910 = loopres_f_res_f_res_158032;
                                loopres_f_res_157911 = loopres_f_res_f_res_158033;
                            }
                            loopres_157796 = loopres_f_res_157910;
                            loopres_157797 = loopres_f_res_157911;
                        }
                        
                        bool loop_cond_158150 = slt64((int64_t) 0, loopres_157797);
                        bool loop_while_tmp_165749 = loop_cond_158150;
                        int64_t last_spi_tmp_165750 = loopres_157796;
                        int64_t step_tmp_165751 = loopres_157797;
                        
                        loop_while_157630 = loop_while_tmp_165749;
                        last_spi_157631 = last_spi_tmp_165750;
                        step_157632 = step_tmp_165751;
                    }
                    lifted_lambda_res_f_res_f_res_f_res_157627 = loop_while_157630;
                    lifted_lambda_res_f_res_f_res_f_res_157628 = last_spi_157631;
                    lifted_lambda_res_f_res_f_res_f_res_157629 = step_157632;
                    lifted_lambda_res_f_res_f_res_157626 = lifted_lambda_res_f_res_f_res_f_res_157628;
                }
                lifted_lambda_res_f_res_157078 = lifted_lambda_res_f_res_f_res_157102;
                lifted_lambda_res_f_res_157079 = lifted_lambda_res_f_res_f_res_157626;
            }
            lifted_lambda_res_157067 = lifted_lambda_res_f_res_157078;
            lifted_lambda_res_157068 = lifted_lambda_res_f_res_157079;
        }
        
        bool cond_158153 = sle64((int64_t) 0, lifted_lambda_res_157067);
        bool lifted_lambda_res_t_res_158154 = sle64((int64_t) 0, lifted_lambda_res_157068);
        bool x_158155 = cond_158153 && lifted_lambda_res_t_res_158154;
        int64_t defunc_0_f_res_158156 = btoi_bool_i64(x_158155);
        int64_t defunc_0_op_res_151079 = add64(defunc_0_f_res_158156, scanacc_164803);
        
        ((int64_t *) mem_164945)[i_164808] = defunc_0_op_res_151079;
        ((int64_t *) mem_164947)[i_164808] = defunc_0_f_res_158156;
        ((int64_t *) mem_164949)[i_164808] = lifted_lambda_res_157067;
        ((int64_t *) mem_164951)[i_164808] = lifted_lambda_res_157068;
        
        int64_t scanacc_tmp_165700 = defunc_0_op_res_151079;
        
        scanacc_164803 = scanacc_tmp_165700;
    }
    discard_164813 = scanacc_164803;
    
    bool cond_151080 = dz2081U_144116 == (int64_t) 0;
    bool x_151081 = !cond_151080;
    int64_t tmp_151082 = sub64(dz2081U_144116, (int64_t) 1);
    bool x_151083 = sle64((int64_t) 0, tmp_151082);
    bool y_151084 = slt64(tmp_151082, dz2081U_144116);
    bool bounds_check_151085 = x_151083 && y_151084;
    bool protect_assert_disj_151086 = cond_151080 || bounds_check_151085;
    bool index_certs_151087;
    
    if (!protect_assert_disj_151086) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_151082, "] out of bounds for array of shape [", (long long) dz2081U_144116, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:405:8-51\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151088;
    
    if (x_151081) {
        int64_t x_164314 = ((int64_t *) mem_164945)[tmp_151082];
        
        m_f_res_151088 = x_164314;
    } else {
        m_f_res_151088 = (int64_t) 0;
    }
    
    int64_t m_151090;
    
    if (cond_151080) {
        m_151090 = (int64_t) 0;
    } else {
        m_151090 = m_f_res_151088;
    }
    
    int64_t m_151100 = sub64(m_151090, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151102 = slt64(m_151100, dz2081U_144116);
    bool zzero_leq_i_p_m_t_s_151101 = sle64((int64_t) 0, m_151100);
    bool y_151104 = zzero_leq_i_p_m_t_s_151101 && i_p_m_t_s_leq_w_151102;
    bool i_lte_j_151103 = sle64((int64_t) 0, m_151090);
    bool forwards_ok_151105 = i_lte_j_151103 && y_151104;
    bool eq_x_zz_151097 = (int64_t) 0 == m_f_res_151088;
    bool p_and_eq_x_y_151098 = x_151081 && eq_x_zz_151097;
    bool empty_slice_151099 = cond_151080 || p_and_eq_x_y_151098;
    bool ok_or_empty_151106 = empty_slice_151099 || forwards_ok_151105;
    bool index_certs_151107;
    
    if (!ok_or_empty_151106) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151090, "] out of bounds for array of shape [", (long long) dz2081U_144116, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:405:8-51\n   #3  ftRelational.fut:318:4-328:18\n   #4  ftRelational.fut:312:1-330:70\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165135 = (int64_t) 8 * m_151090;
    
    if (mem_165136_cached_sizze_165946 < bytes_165135) {
        err = lexical_realloc(ctx, &mem_165136, &mem_165136_cached_sizze_165946, bytes_165135);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165136, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164951, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151090});
    if (mem_165138_cached_sizze_165947 < bytes_165135) {
        err = lexical_realloc(ctx, &mem_165138, &mem_165138_cached_sizze_165947, bytes_165135);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165138, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151090});
    if (mem_165140_cached_sizze_165948 < bytes_165135) {
        err = lexical_realloc(ctx, &mem_165140, &mem_165140_cached_sizze_165948, bytes_165135);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_165791 = 0; i_165791 < m_151090; i_165791++) {
        int64_t x_165792 = (int64_t) 0 + i_165791 * (int64_t) 1;
        
        ((int64_t *) mem_165140)[i_165791] = x_165792;
    }
    for (int64_t write_iter_164814 = 0; write_iter_164814 < dz2081U_144116; write_iter_164814++) {
        int64_t write_iv_164818 = ((int64_t *) mem_164947)[write_iter_164814];
        int64_t write_iv_164819 = ((int64_t *) mem_164945)[write_iter_164814];
        int64_t write_iv_164821 = ((int64_t *) mem_164949)[write_iter_164814];
        int64_t write_iv_164822 = ((int64_t *) mem_164951)[write_iter_164814];
        bool cond_157009 = write_iv_164818 == (int64_t) 1;
        int64_t lifted_lambda_res_157010;
        
        if (cond_157009) {
            int64_t lifted_lambda_res_t_res_164315 = sub64(write_iv_164819, (int64_t) 1);
            
            lifted_lambda_res_157010 = lifted_lambda_res_t_res_164315;
        } else {
            lifted_lambda_res_157010 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157010) && slt64(lifted_lambda_res_157010, m_151090)) {
            ((int64_t *) mem_165140)[lifted_lambda_res_157010] = write_iter_164814;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157010) && slt64(lifted_lambda_res_157010, m_151090)) {
            ((int64_t *) mem_165138)[lifted_lambda_res_157010] = write_iv_164821;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157010) && slt64(lifted_lambda_res_157010, m_151090)) {
            ((int64_t *) mem_165136)[lifted_lambda_res_157010] = write_iv_164822;
        }
    }
    if (memblock_alloc(ctx, &mem_165159, (int64_t) 0, "mem_165159")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165160, (int64_t) 0, "mem_165160")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165161, (int64_t) 0, "mem_165161")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165162, (int64_t) 0, "mem_165162")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165163, (int64_t) 0, "mem_165163")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t zl_rhs_151128 = sub64(dz2081U_144117, (int64_t) 1);
    int64_t join_hashPartitions_res_151129;
    int64_t join_hashPartitions_res_151130;
    int64_t join_hashPartitions_res_151131;
    int64_t loop_dz2081Uz2080U_151136;
    int64_t loop_dz2081Uz2081U_151137;
    int64_t loop_dz2081Uz2082U_151138;
    
    if (memblock_set(ctx, &mem_param_165166, &mem_165160, "mem_165160") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165169, &mem_165161, "mem_165161") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165173, &mem_165159, "mem_165159") != 0)
        return 1;
    loop_dz2081Uz2080U_151136 = (int64_t) 0;
    loop_dz2081Uz2081U_151137 = (int64_t) 0;
    loop_dz2081Uz2082U_151138 = (int64_t) 0;
    for (int64_t i_151135 = 0; i_151135 < m_151090; i_151135++) {
        int64_t p_match_151142 = ((int64_t *) mem_165140)[i_151135];
        int64_t p_match_151143 = ((int64_t *) mem_165138)[i_151135];
        int64_t p_match_151144 = ((int64_t *) mem_165136)[i_151135];
        bool x_151145 = sle64((int64_t) 0, p_match_151142);
        bool y_151146 = slt64(p_match_151142, dz2081U_144116);
        bool bounds_check_151147 = x_151145 && y_151146;
        bool index_certs_151148;
        
        if (!bounds_check_151147) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_match_151142, "] out of bounds for array of shape [", (long long) dz2081U_144116, "].", "-> #0  ftHashJoin.fut:478:18-42\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t r_lb_151149 = ((int64_t *) bounds_mem_164930.mem)[p_match_151142];
        bool cond_151150 = slt64(p_match_151142, tmp_151082);
        int64_t tmp_151151 = add64((int64_t) 1, p_match_151142);
        bool x_151152 = sle64((int64_t) 0, tmp_151151);
        bool y_151153 = slt64(tmp_151151, dz2081U_144116);
        bool bounds_check_151154 = x_151152 && y_151153;
        bool loop_not_taken_151155 = !cond_151150;
        bool protect_assert_disj_151156 = bounds_check_151154 || loop_not_taken_151155;
        bool index_certs_151157;
        
        if (!protect_assert_disj_151156) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_151151, "] out of bounds for array of shape [", (long long) dz2081U_144116, "].", "-> #0  ftHashJoin.fut:479:49-77\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t r_ub_t_res_151158;
        
        if (cond_151150) {
            int64_t x_164316 = ((int64_t *) bounds_mem_164930.mem)[tmp_151151];
            
            r_ub_t_res_151158 = x_164316;
        } else {
            r_ub_t_res_151158 = (int64_t) 0;
        }
        
        int64_t r_ub_151160;
        
        if (cond_151150) {
            r_ub_151160 = r_ub_t_res_151158;
        } else {
            r_ub_151160 = nR_144113;
        }
        
        int64_t j_m_i_151161 = sub64(r_ub_151160, r_lb_151149);
        bool empty_slice_151162 = j_m_i_151161 == (int64_t) 0;
        int64_t m_151163 = sub64(j_m_i_151161, (int64_t) 1);
        int64_t i_p_m_t_s_151164 = add64(r_lb_151149, m_151163);
        bool zzero_leq_i_p_m_t_s_151165 = sle64((int64_t) 0, i_p_m_t_s_151164);
        bool i_p_m_t_s_leq_w_151166 = slt64(i_p_m_t_s_151164, nR_144113);
        bool zzero_lte_i_151167 = sle64((int64_t) 0, r_lb_151149);
        bool i_lte_j_151168 = sle64(r_lb_151149, r_ub_151160);
        bool y_151169 = i_p_m_t_s_leq_w_151166 && zzero_lte_i_151167;
        bool y_151170 = zzero_leq_i_p_m_t_s_151165 && y_151169;
        bool forwards_ok_151171 = i_lte_j_151168 && y_151170;
        bool ok_or_empty_151172 = empty_slice_151162 || forwards_ok_151171;
        bool index_certs_151173;
        
        if (!ok_or_empty_151172) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) r_lb_151149, ":", (long long) r_ub_151160, "] out of bounds for array of shape [", (long long) nR_144113, "].", "-> #0  ftHashJoin.fut:480:20-33\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool bounds_invalid_upwards_151175 = slt64(p_match_151144, p_match_151143);
        int64_t distance_upwards_exclusive_151176 = sub64(p_match_151144, p_match_151143);
        int64_t distance_151177 = add64((int64_t) 1, distance_upwards_exclusive_151176);
        bool valid_151178 = !bounds_invalid_upwards_151175;
        bool range_valid_c_151179;
        
        if (!valid_151178) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) p_match_151143, "...", (long long) p_match_151144, " is invalid.", "-> #0  ftHashJoin.fut:483:27-52\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool cond_156709 = slt64((int64_t) 6, j_m_i_151161);
        int64_t bytes_165387 = (int64_t) 8 * j_m_i_151161;
        int64_t loopres_151180;
        int64_t loopres_151181;
        int64_t loopres_151182;
        int64_t loop_dz2083Uz2084U_151187;
        int64_t loop_dz2083Uz2085U_151188;
        int64_t loop_dz2083Uz2086U_151189;
        
        if (memblock_set(ctx, &mem_param_165176, &mem_165163, "mem_165163") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165179, &mem_165163, "mem_165163") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165183, &mem_165162, "mem_165162") != 0)
            return 1;
        loop_dz2083Uz2084U_151187 = (int64_t) 0;
        loop_dz2083Uz2085U_151188 = (int64_t) 0;
        loop_dz2083Uz2086U_151189 = (int64_t) 0;
        for (int64_t i_151186 = 0; i_151186 < distance_151177; i_151186++) {
            int64_t index_primexp_151193 = add64(p_match_151143, i_151186);
            bool x_151194 = sle64((int64_t) 0, index_primexp_151193);
            bool y_151195 = slt64(index_primexp_151193, dz2081U_144117);
            bool bounds_check_151196 = x_151194 && y_151195;
            bool index_certs_151197;
            
            if (!bounds_check_151196) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) index_primexp_151193, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:484:22-46\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t s_lb_151198 = ((int64_t *) bounds_mem_164932.mem)[index_primexp_151193];
            bool cond_151199 = slt64(index_primexp_151193, zl_rhs_151128);
            int64_t tmp_151200 = add64((int64_t) 1, index_primexp_151193);
            bool x_151201 = sle64((int64_t) 0, tmp_151200);
            bool y_151202 = slt64(tmp_151200, dz2081U_144117);
            bool bounds_check_151203 = x_151201 && y_151202;
            bool loop_not_taken_151204 = !cond_151199;
            bool protect_assert_disj_151205 = bounds_check_151203 || loop_not_taken_151204;
            bool index_certs_151206;
            
            if (!protect_assert_disj_151205) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_151200, "] out of bounds for array of shape [", (long long) dz2081U_144117, "].", "-> #0  ftHashJoin.fut:485:53-79\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t s_ub_t_res_151207;
            
            if (cond_151199) {
                int64_t x_164317 = ((int64_t *) bounds_mem_164932.mem)[tmp_151200];
                
                s_ub_t_res_151207 = x_164317;
            } else {
                s_ub_t_res_151207 = (int64_t) 0;
            }
            
            int64_t s_ub_151209;
            
            if (cond_151199) {
                s_ub_151209 = s_ub_t_res_151207;
            } else {
                s_ub_151209 = nS_144115;
            }
            
            int64_t j_m_i_151210 = sub64(s_ub_151209, s_lb_151198);
            bool empty_slice_151211 = j_m_i_151210 == (int64_t) 0;
            int64_t m_151212 = sub64(j_m_i_151210, (int64_t) 1);
            int64_t i_p_m_t_s_151213 = add64(s_lb_151198, m_151212);
            bool zzero_leq_i_p_m_t_s_151214 = sle64((int64_t) 0, i_p_m_t_s_151213);
            bool i_p_m_t_s_leq_w_151215 = slt64(i_p_m_t_s_151213, nS_144115);
            bool zzero_lte_i_151216 = sle64((int64_t) 0, s_lb_151198);
            bool i_lte_j_151217 = sle64(s_lb_151198, s_ub_151209);
            bool y_151218 = i_p_m_t_s_leq_w_151215 && zzero_lte_i_151216;
            bool y_151219 = zzero_leq_i_p_m_t_s_151214 && y_151218;
            bool forwards_ok_151220 = i_lte_j_151217 && y_151219;
            bool ok_or_empty_151221 = empty_slice_151211 || forwards_ok_151220;
            bool index_certs_151222;
            
            if (!ok_or_empty_151221) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) s_lb_151198, ":", (long long) s_ub_151209, "] out of bounds for array of shape [", (long long) nS_144115, "].", "-> #0  ftHashJoin.fut:486:24-37\n   #1  ftRelational.fut:316:4-330:70\n   #2  ftRelational.fut:312:1-330:70\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool cond_156849 = slt64((int64_t) 6, j_m_i_151210);
            bool cond_151224 = sle64(j_m_i_151210, j_m_i_151161);
            int64_t bytes_165242 = (int64_t) 8 * j_m_i_151210;
            int64_t find_joinPairs_res_151225;
            int64_t find_joinPairs_res_151226;
            int64_t find_joinPairs_res_151227;
            
            if (cond_151224) {
                int64_t do_find_joinPairs_res_164427;
                int64_t do_find_joinPairs_res_164428;
                int64_t do_find_joinPairs_res_164429;
                
                if (cond_156709) {
                    if (memblock_alloc(ctx, &mem_165388, bytes_165387, "mem_165388")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_165814 = 0; i_165814 < j_m_i_151161; i_165814++) {
                        int64_t x_165815 = (int64_t) 0 + i_165814 * (int64_t) 1;
                        
                        ((int64_t *) mem_165388.mem)[i_165814] = x_165815;
                    }
                    if (mem_165400_cached_sizze_165952 < bytes_165387) {
                        err = lexical_realloc(ctx, &mem_165400, &mem_165400_cached_sizze_165952, bytes_165387);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165401_cached_sizze_165953 < j_m_i_151161) {
                        err = lexical_realloc(ctx, &mem_165401, &mem_165401_cached_sizze_165953, j_m_i_151161);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165415_cached_sizze_165954 < bytes_165387) {
                        err = lexical_realloc(ctx, &mem_165415, &mem_165415_cached_sizze_165954, bytes_165387);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_165429, bytes_165387, "mem_165429")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t do_find_joinPairs_res_t_res_164434;
                    int64_t do_find_joinPairs_res_t_res_164435;
                    int64_t do_find_joinPairs_res_t_res_164436;
                    int64_t loop_dz2085U_164441;
                    int64_t loop_dz2086U_164442;
                    int64_t loop_dz2087U_164443;
                    
                    if (memblock_set(ctx, &mem_param_165392, &mem_165162, "mem_165162") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165395, &mem_165163, "mem_165163") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165398, &mem_165163, "mem_165163") != 0)
                        return 1;
                    loop_dz2085U_164441 = (int64_t) 0;
                    loop_dz2086U_164442 = (int64_t) 0;
                    loop_dz2087U_164443 = (int64_t) 0;
                    for (int64_t i_164440 = 0; i_164440 < j_m_i_151210; i_164440++) {
                        int64_t slice_164447 = s_lb_151198 + i_164440;
                        int64_t discard_164837;
                        int64_t defunc_res_164450;
                        int64_t scanacc_164830;
                        int64_t redout_164832;
                        
                        scanacc_164830 = (int64_t) 0;
                        redout_164832 = (int64_t) 0;
                        for (int64_t i_164834 = 0; i_164834 < j_m_i_151161; i_164834++) {
                            int64_t slice_164896 = r_lb_151149 + i_164834;
                            bool defunc_0_reduce_res_164453;
                            bool redout_164826 = 1;
                            
                            for (int64_t i_164827 = 0; i_164827 < b_144114; i_164827++) {
                                int8_t eta_p_164454 = ((int8_t *) pR_mem_164928.mem)[slice_164896 * b_144114 + i_164827];
                                int8_t eta_p_164455 = ((int8_t *) pS_mem_164929.mem)[slice_164447 * b_144114 + i_164827];
                                bool defunc_0_f_res_164456 = eta_p_164454 == eta_p_164455;
                                bool x_164459 = defunc_0_f_res_164456 && redout_164826;
                                bool redout_tmp_165829 = x_164459;
                                
                                redout_164826 = redout_tmp_165829;
                            }
                            defunc_0_reduce_res_164453 = redout_164826;
                            
                            int64_t bool_res_164461 = btoi_bool_i64(defunc_0_reduce_res_164453);
                            int64_t defunc_0_op_res_164465 = add64(bool_res_164461, scanacc_164830);
                            int64_t zp_res_164468 = add64(bool_res_164461, redout_164832);
                            
                            ((int64_t *) mem_165400)[i_164834] = defunc_0_op_res_164465;
                            ((bool *) mem_165401)[i_164834] = defunc_0_reduce_res_164453;
                            
                            int64_t scanacc_tmp_165825 = defunc_0_op_res_164465;
                            int64_t redout_tmp_165827 = zp_res_164468;
                            
                            scanacc_164830 = scanacc_tmp_165825;
                            redout_164832 = redout_tmp_165827;
                        }
                        discard_164837 = scanacc_164830;
                        defunc_res_164450 = redout_164832;
                        
                        int64_t bytes_165424 = (int64_t) 8 * defunc_res_164450;
                        int64_t conc_tmp_164506 = loop_dz2085U_164441 + defunc_res_164450;
                        int64_t bytes_165432 = b_144114 * conc_tmp_164506;
                        int64_t conc_tmp_164508 = loop_dz2086U_164442 + defunc_res_164450;
                        int64_t bytes_165434 = (int64_t) 8 * conc_tmp_164508;
                        int64_t conc_tmp_164510 = loop_dz2087U_164443 + defunc_res_164450;
                        int64_t bytes_165436 = (int64_t) 8 * conc_tmp_164510;
                        
                        for (int64_t i_164840 = 0; i_164840 < j_m_i_151161; i_164840++) {
                            bool eta_p_164489 = ((bool *) mem_165401)[i_164840];
                            int64_t zv_lhs_164490 = add64((int64_t) -1, i_164840);
                            int64_t tmp_164491 = smod64(zv_lhs_164490, j_m_i_151161);
                            int64_t lifted_lambda_res_164492 = ((int64_t *) mem_165400)[tmp_164491];
                            bool cond_164493 = i_164840 == (int64_t) 0;
                            int64_t lifted_lambda_res_164494;
                            
                            if (cond_164493) {
                                lifted_lambda_res_164494 = (int64_t) 0;
                            } else {
                                lifted_lambda_res_164494 = lifted_lambda_res_164492;
                            }
                            
                            int64_t lifted_lambda_res_164495;
                            
                            if (eta_p_164489) {
                                lifted_lambda_res_164495 = lifted_lambda_res_164494;
                            } else {
                                lifted_lambda_res_164495 = (int64_t) -1;
                            }
                            ((int64_t *) mem_165415)[i_164840] = lifted_lambda_res_164495;
                        }
                        if (memblock_alloc(ctx, &mem_165433, bytes_165432, "mem_165433")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165831 = 0; nest_i_165831 < defunc_res_164450; nest_i_165831++) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165433.mem, b_144114 * loop_dz2085U_164441 + nest_i_165831 * b_144114, (int64_t []) {(int64_t) 1}, (uint8_t *) pS_mem_164929.mem, slice_164447 * b_144114, (int64_t []) {(int64_t) 1}, (int64_t []) {b_144114});
                        }
                        if (memblock_alloc(ctx, &mem_165437, bytes_165436, "mem_165437")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165832 = 0; nest_i_165832 < defunc_res_164450; nest_i_165832++) {
                            ((int64_t *) mem_165437.mem)[loop_dz2087U_164443 + nest_i_165832] = i_164440;
                        }
                        if (memblock_alloc(ctx, &mem_165427, bytes_165424, "mem_165427")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165833 = 0; nest_i_165833 < defunc_res_164450; nest_i_165833++) {
                            ((int64_t *) mem_165427.mem)[nest_i_165833] = (int64_t) 0;
                        }
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165429.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165415, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151161});
                        if (futrts_partitioned_scatter_13032(ctx, &ext_mem_165431, mem_165427, mem_165429, mem_165388, defunc_res_164450, j_m_i_151161, scatter_psizze_144130) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_unref(ctx, &mem_165427, "mem_165427") != 0)
                            return 1;
                        
                        int64_t tmp_offs_165834 = (int64_t) 0;
                        
                        lmad_copy_1b(ctx, 2, (uint8_t *) mem_165433.mem, b_144114 * tmp_offs_165834, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_param_165392.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loop_dz2085U_164441, b_144114});
                        tmp_offs_165834 += loop_dz2085U_164441;
                        if (!(b_144114 * tmp_offs_165834 == b_144114 * loop_dz2085U_164441)) {
                            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165433.mem, b_144114 * tmp_offs_165834, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_165433.mem, b_144114 * loop_dz2085U_164441, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {defunc_res_164450, b_144114});
                        }
                        tmp_offs_165834 += defunc_res_164450;
                        if (memblock_alloc(ctx, &mem_165435, bytes_165434, "mem_165435")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165835 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165435.mem, tmp_offs_165835, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165395.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2086U_164442});
                        tmp_offs_165835 += loop_dz2086U_164442;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165435.mem, tmp_offs_165835, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165431.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_164450});
                        tmp_offs_165835 += defunc_res_164450;
                        if (memblock_unref(ctx, &ext_mem_165431, "ext_mem_165431") != 0)
                            return 1;
                        
                        int64_t tmp_offs_165836 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165437.mem, tmp_offs_165836, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165398.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2087U_164443});
                        tmp_offs_165836 += loop_dz2087U_164443;
                        if (!(tmp_offs_165836 == loop_dz2087U_164443)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165437.mem, tmp_offs_165836, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165437.mem, loop_dz2087U_164443, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_164450});
                        }
                        tmp_offs_165836 += defunc_res_164450;
                        if (memblock_set(ctx, &mem_param_tmp_165816, &mem_165433, "mem_165433") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165817, &mem_165435, "mem_165435") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165818, &mem_165437, "mem_165437") != 0)
                            return 1;
                        
                        int64_t loop_dz2085U_tmp_165819 = conc_tmp_164506;
                        int64_t loop_dz2086U_tmp_165820 = conc_tmp_164508;
                        int64_t loop_dz2087U_tmp_165821 = conc_tmp_164510;
                        
                        if (memblock_set(ctx, &mem_param_165392, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165395, &mem_param_tmp_165817, "mem_param_tmp_165817") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165398, &mem_param_tmp_165818, "mem_param_tmp_165818") != 0)
                            return 1;
                        loop_dz2085U_164441 = loop_dz2085U_tmp_165819;
                        loop_dz2086U_164442 = loop_dz2086U_tmp_165820;
                        loop_dz2087U_164443 = loop_dz2087U_tmp_165821;
                    }
                    if (memblock_set(ctx, &ext_mem_165447, &mem_param_165392, "mem_param_165392") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165446, &mem_param_165395, "mem_param_165395") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165445, &mem_param_165398, "mem_param_165398") != 0)
                        return 1;
                    do_find_joinPairs_res_t_res_164434 = loop_dz2085U_164441;
                    do_find_joinPairs_res_t_res_164435 = loop_dz2086U_164442;
                    do_find_joinPairs_res_t_res_164436 = loop_dz2087U_164443;
                    if (memblock_unref(ctx, &mem_165388, "mem_165388") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_165429, "mem_165429") != 0)
                        return 1;
                    
                    int64_t bytes_165448 = (int64_t) 8 * do_find_joinPairs_res_t_res_164435;
                    int64_t bytes_165456 = (int64_t) 8 * do_find_joinPairs_res_t_res_164436;
                    
                    if (memblock_alloc(ctx, &mem_165449, bytes_165448, "mem_165449")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164844 = 0; i_164844 < do_find_joinPairs_res_t_res_164435; i_164844++) {
                        int64_t eta_p_164513 = ((int64_t *) ext_mem_165446.mem)[i_164844];
                        int64_t lifted_lambda_res_164514 = add64(r_lb_151149, eta_p_164513);
                        
                        ((int64_t *) mem_165449.mem)[i_164844] = lifted_lambda_res_164514;
                    }
                    if (memblock_unref(ctx, &ext_mem_165446, "ext_mem_165446") != 0)
                        return 1;
                    if (memblock_alloc(ctx, &mem_165457, bytes_165456, "mem_165457")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164848 = 0; i_164848 < do_find_joinPairs_res_t_res_164436; i_164848++) {
                        int64_t eta_p_164521 = ((int64_t *) ext_mem_165445.mem)[i_164848];
                        int64_t lifted_lambda_res_164522 = add64(s_lb_151198, eta_p_164521);
                        
                        ((int64_t *) mem_165457.mem)[i_164848] = lifted_lambda_res_164522;
                    }
                    if (memblock_unref(ctx, &ext_mem_165445, "ext_mem_165445") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165473, &mem_165449, "mem_165449") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165470, &mem_165457, "mem_165457") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165467, &ext_mem_165447, "ext_mem_165447") != 0)
                        return 1;
                    do_find_joinPairs_res_164427 = do_find_joinPairs_res_t_res_164435;
                    do_find_joinPairs_res_164428 = do_find_joinPairs_res_t_res_164436;
                    do_find_joinPairs_res_164429 = do_find_joinPairs_res_t_res_164434;
                } else {
                    int64_t do_find_joinPairs_res_f_res_164528;
                    int64_t do_find_joinPairs_res_f_res_164529;
                    int64_t do_find_joinPairs_res_f_res_164530;
                    int64_t loop_dz2081Uz2080Uz2081U_164535;
                    int64_t loop_dz2081Uz2080Uz2082U_164536;
                    int64_t loop_dz2081Uz2080Uz2083U_164537;
                    
                    if (memblock_set(ctx, &mem_param_165332, &mem_165162, "mem_165162") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165335, &mem_165163, "mem_165163") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165338, &mem_165163, "mem_165163") != 0)
                        return 1;
                    loop_dz2081Uz2080Uz2081U_164535 = (int64_t) 0;
                    loop_dz2081Uz2080Uz2082U_164536 = (int64_t) 0;
                    loop_dz2081Uz2080Uz2083U_164537 = (int64_t) 0;
                    for (int64_t i_164534 = 0; i_164534 < j_m_i_151161; i_164534++) {
                        int64_t slice_164541 = r_lb_151149 + i_164534;
                        int64_t matches_164543;
                        int64_t loop_dz2081Uz2081Uz2082U_164546;
                        
                        if (memblock_set(ctx, &mem_param_165341, &mem_165163, "mem_165163") != 0)
                            return 1;
                        loop_dz2081Uz2081Uz2082U_164546 = (int64_t) 0;
                        for (int64_t i_164545 = 0; i_164545 < j_m_i_151210; i_164545++) {
                            int64_t slice_164548 = s_lb_151198 + i_164545;
                            bool defunc_0_reduce_res_164550;
                            bool redout_164850 = 1;
                            
                            for (int64_t i_164851 = 0; i_164851 < b_144114; i_164851++) {
                                int8_t eta_p_164551 = ((int8_t *) pR_mem_164928.mem)[slice_164541 * b_144114 + i_164851];
                                int8_t eta_p_164552 = ((int8_t *) pS_mem_164929.mem)[slice_164548 * b_144114 + i_164851];
                                bool defunc_0_f_res_164553 = eta_p_164551 == eta_p_164552;
                                bool x_164556 = defunc_0_f_res_164553 && redout_164850;
                                bool redout_tmp_165851 = x_164556;
                                
                                redout_164850 = redout_tmp_165851;
                            }
                            defunc_0_reduce_res_164550 = redout_164850;
                            
                            int64_t conc_tmp_164564 = (int64_t) 1 + loop_dz2081Uz2081Uz2082U_164546;
                            int64_t loopres_164565;
                            
                            if (defunc_0_reduce_res_164550) {
                                loopres_164565 = conc_tmp_164564;
                            } else {
                                loopres_164565 = loop_dz2081Uz2081Uz2082U_164546;
                            }
                            
                            int64_t bytes_165343 = (int64_t) 8 * loopres_164565;
                            
                            if (defunc_0_reduce_res_164550) {
                                if (memblock_alloc(ctx, &mem_165344, bytes_165343, "mem_165344")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t nest_i_165852 = 0; nest_i_165852 < (int64_t) 1; nest_i_165852++) {
                                    ((int64_t *) mem_165344.mem)[loop_dz2081Uz2081Uz2082U_164546 + nest_i_165852] = i_164545;
                                }
                                
                                int64_t tmp_offs_165853 = (int64_t) 0;
                                
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165344.mem, tmp_offs_165853, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165341.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2081Uz2082U_164546});
                                tmp_offs_165853 += loop_dz2081Uz2081Uz2082U_164546;
                                if (!(tmp_offs_165853 == loop_dz2081Uz2081Uz2082U_164546)) {
                                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165344.mem, tmp_offs_165853, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165344.mem, loop_dz2081Uz2081Uz2082U_164546, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                                }
                                tmp_offs_165853 += (int64_t) 1;
                                if (memblock_set(ctx, &ext_mem_165347, &mem_165344, "mem_165344") != 0)
                                    return 1;
                            } else if (memblock_set(ctx, &ext_mem_165347, &mem_param_165341, "mem_param_165341") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_tmp_165848, &ext_mem_165347, "ext_mem_165347") != 0)
                                return 1;
                            
                            int64_t loop_dz2081Uz2081Uz2082U_tmp_165849 = loopres_164565;
                            
                            if (memblock_set(ctx, &mem_param_165341, &mem_param_tmp_165848, "mem_param_tmp_165848") != 0)
                                return 1;
                            loop_dz2081Uz2081Uz2082U_164546 = loop_dz2081Uz2081Uz2082U_tmp_165849;
                        }
                        if (memblock_set(ctx, &ext_mem_165350, &mem_param_165341, "mem_param_165341") != 0)
                            return 1;
                        matches_164543 = loop_dz2081Uz2081Uz2082U_164546;
                        
                        int64_t conc_tmp_164572 = loop_dz2081Uz2080Uz2081U_164535 + matches_164543;
                        int64_t bytes_165355 = b_144114 * conc_tmp_164572;
                        int64_t conc_tmp_164574 = loop_dz2081Uz2080Uz2082U_164536 + matches_164543;
                        int64_t bytes_165357 = (int64_t) 8 * conc_tmp_164574;
                        int64_t conc_tmp_164576 = loop_dz2081Uz2080Uz2083U_164537 + matches_164543;
                        int64_t bytes_165359 = (int64_t) 8 * conc_tmp_164576;
                        
                        if (memblock_alloc(ctx, &mem_165356, bytes_165355, "mem_165356")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165854 = 0; nest_i_165854 < matches_164543; nest_i_165854++) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165356.mem, b_144114 * loop_dz2081Uz2080Uz2081U_164535 + nest_i_165854 * b_144114, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_164928.mem, slice_164541 * b_144114, (int64_t []) {(int64_t) 1}, (int64_t []) {b_144114});
                        }
                        if (memblock_alloc(ctx, &mem_165358, bytes_165357, "mem_165358")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165855 = 0; nest_i_165855 < matches_164543; nest_i_165855++) {
                            ((int64_t *) mem_165358.mem)[loop_dz2081Uz2080Uz2082U_164536 + nest_i_165855] = i_164534;
                        }
                        
                        int64_t tmp_offs_165856 = (int64_t) 0;
                        
                        lmad_copy_1b(ctx, 2, (uint8_t *) mem_165356.mem, b_144114 * tmp_offs_165856, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_param_165332.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loop_dz2081Uz2080Uz2081U_164535, b_144114});
                        tmp_offs_165856 += loop_dz2081Uz2080Uz2081U_164535;
                        if (!(b_144114 * tmp_offs_165856 == b_144114 * loop_dz2081Uz2080Uz2081U_164535)) {
                            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165356.mem, b_144114 * tmp_offs_165856, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_165356.mem, b_144114 * loop_dz2081Uz2080Uz2081U_164535, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {matches_164543, b_144114});
                        }
                        tmp_offs_165856 += matches_164543;
                        
                        int64_t tmp_offs_165857 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165358.mem, tmp_offs_165857, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165335.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2080Uz2082U_164536});
                        tmp_offs_165857 += loop_dz2081Uz2080Uz2082U_164536;
                        if (!(tmp_offs_165857 == loop_dz2081Uz2080Uz2082U_164536)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165358.mem, tmp_offs_165857, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165358.mem, loop_dz2081Uz2080Uz2082U_164536, (int64_t []) {(int64_t) 1}, (int64_t []) {matches_164543});
                        }
                        tmp_offs_165857 += matches_164543;
                        if (memblock_alloc(ctx, &mem_165360, bytes_165359, "mem_165360")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165858 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165360.mem, tmp_offs_165858, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165338.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2080Uz2083U_164537});
                        tmp_offs_165858 += loop_dz2081Uz2080Uz2083U_164537;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165360.mem, tmp_offs_165858, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165350.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {matches_164543});
                        tmp_offs_165858 += matches_164543;
                        if (memblock_unref(ctx, &ext_mem_165350, "ext_mem_165350") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165839, &mem_165356, "mem_165356") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165840, &mem_165358, "mem_165358") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165841, &mem_165360, "mem_165360") != 0)
                            return 1;
                        
                        int64_t loop_dz2081Uz2080Uz2081U_tmp_165842 = conc_tmp_164572;
                        int64_t loop_dz2081Uz2080Uz2082U_tmp_165843 = conc_tmp_164574;
                        int64_t loop_dz2081Uz2080Uz2083U_tmp_165844 = conc_tmp_164576;
                        
                        if (memblock_set(ctx, &mem_param_165332, &mem_param_tmp_165839, "mem_param_tmp_165839") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165335, &mem_param_tmp_165840, "mem_param_tmp_165840") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165338, &mem_param_tmp_165841, "mem_param_tmp_165841") != 0)
                            return 1;
                        loop_dz2081Uz2080Uz2081U_164535 = loop_dz2081Uz2080Uz2081U_tmp_165842;
                        loop_dz2081Uz2080Uz2082U_164536 = loop_dz2081Uz2080Uz2082U_tmp_165843;
                        loop_dz2081Uz2080Uz2083U_164537 = loop_dz2081Uz2080Uz2083U_tmp_165844;
                    }
                    if (memblock_set(ctx, &ext_mem_165370, &mem_param_165332, "mem_param_165332") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165369, &mem_param_165335, "mem_param_165335") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165368, &mem_param_165338, "mem_param_165338") != 0)
                        return 1;
                    do_find_joinPairs_res_f_res_164528 = loop_dz2081Uz2080Uz2081U_164535;
                    do_find_joinPairs_res_f_res_164529 = loop_dz2081Uz2080Uz2082U_164536;
                    do_find_joinPairs_res_f_res_164530 = loop_dz2081Uz2080Uz2083U_164537;
                    
                    int64_t bytes_165371 = (int64_t) 8 * do_find_joinPairs_res_f_res_164529;
                    int64_t bytes_165379 = (int64_t) 8 * do_find_joinPairs_res_f_res_164530;
                    
                    if (memblock_alloc(ctx, &mem_165372, bytes_165371, "mem_165372")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164854 = 0; i_164854 < do_find_joinPairs_res_f_res_164529; i_164854++) {
                        int64_t eta_p_164579 = ((int64_t *) ext_mem_165369.mem)[i_164854];
                        int64_t lifted_lambda_res_164580 = add64(r_lb_151149, eta_p_164579);
                        
                        ((int64_t *) mem_165372.mem)[i_164854] = lifted_lambda_res_164580;
                    }
                    if (memblock_unref(ctx, &ext_mem_165369, "ext_mem_165369") != 0)
                        return 1;
                    if (memblock_alloc(ctx, &mem_165380, bytes_165379, "mem_165380")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164858 = 0; i_164858 < do_find_joinPairs_res_f_res_164530; i_164858++) {
                        int64_t eta_p_164587 = ((int64_t *) ext_mem_165368.mem)[i_164858];
                        int64_t lifted_lambda_res_164588 = add64(s_lb_151198, eta_p_164587);
                        
                        ((int64_t *) mem_165380.mem)[i_164858] = lifted_lambda_res_164588;
                    }
                    if (memblock_unref(ctx, &ext_mem_165368, "ext_mem_165368") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165473, &mem_165372, "mem_165372") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165470, &mem_165380, "mem_165380") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165467, &ext_mem_165370, "ext_mem_165370") != 0)
                        return 1;
                    do_find_joinPairs_res_164427 = do_find_joinPairs_res_f_res_164529;
                    do_find_joinPairs_res_164428 = do_find_joinPairs_res_f_res_164530;
                    do_find_joinPairs_res_164429 = do_find_joinPairs_res_f_res_164528;
                }
                if (memblock_set(ctx, &ext_mem_165483, &ext_mem_165473, "ext_mem_165473") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165480, &ext_mem_165470, "ext_mem_165470") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165477, &ext_mem_165467, "ext_mem_165467") != 0)
                    return 1;
                find_joinPairs_res_151225 = do_find_joinPairs_res_164427;
                find_joinPairs_res_151226 = do_find_joinPairs_res_164428;
                find_joinPairs_res_151227 = do_find_joinPairs_res_164429;
            } else {
                int64_t do_find_joinPairs_res_156850;
                int64_t do_find_joinPairs_res_156851;
                int64_t do_find_joinPairs_res_156852;
                
                if (cond_156849) {
                    if (memblock_alloc(ctx, &mem_165243, bytes_165242, "mem_165243")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_165861 = 0; i_165861 < j_m_i_151210; i_165861++) {
                        int64_t x_165862 = (int64_t) 0 + i_165861 * (int64_t) 1;
                        
                        ((int64_t *) mem_165243.mem)[i_165861] = x_165862;
                    }
                    if (mem_165255_cached_sizze_165949 < bytes_165242) {
                        err = lexical_realloc(ctx, &mem_165255, &mem_165255_cached_sizze_165949, bytes_165242);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165256_cached_sizze_165950 < j_m_i_151210) {
                        err = lexical_realloc(ctx, &mem_165256, &mem_165256_cached_sizze_165950, j_m_i_151210);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165270_cached_sizze_165951 < bytes_165242) {
                        err = lexical_realloc(ctx, &mem_165270, &mem_165270_cached_sizze_165951, bytes_165242);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_165284, bytes_165242, "mem_165284")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t do_find_joinPairs_res_t_res_164603;
                    int64_t do_find_joinPairs_res_t_res_164604;
                    int64_t do_find_joinPairs_res_t_res_164605;
                    int64_t loop_dz2085U_164610;
                    int64_t loop_dz2086U_164611;
                    int64_t loop_dz2087U_164612;
                    
                    if (memblock_set(ctx, &mem_param_165247, &mem_165162, "mem_165162") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165250, &mem_165163, "mem_165163") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165253, &mem_165163, "mem_165163") != 0)
                        return 1;
                    loop_dz2085U_164610 = (int64_t) 0;
                    loop_dz2086U_164611 = (int64_t) 0;
                    loop_dz2087U_164612 = (int64_t) 0;
                    for (int64_t i_164609 = 0; i_164609 < j_m_i_151161; i_164609++) {
                        int64_t slice_164616 = r_lb_151149 + i_164609;
                        int64_t discard_164871;
                        int64_t defunc_res_164619;
                        int64_t scanacc_164864;
                        int64_t redout_164866;
                        
                        scanacc_164864 = (int64_t) 0;
                        redout_164866 = (int64_t) 0;
                        for (int64_t i_164868 = 0; i_164868 < j_m_i_151210; i_164868++) {
                            int64_t slice_164899 = s_lb_151198 + i_164868;
                            bool defunc_0_reduce_res_164622;
                            bool redout_164860 = 1;
                            
                            for (int64_t i_164861 = 0; i_164861 < b_144114; i_164861++) {
                                int8_t eta_p_164623 = ((int8_t *) pS_mem_164929.mem)[slice_164899 * b_144114 + i_164861];
                                int8_t eta_p_164624 = ((int8_t *) pR_mem_164928.mem)[slice_164616 * b_144114 + i_164861];
                                bool defunc_0_f_res_164625 = eta_p_164623 == eta_p_164624;
                                bool x_164628 = defunc_0_f_res_164625 && redout_164860;
                                bool redout_tmp_165876 = x_164628;
                                
                                redout_164860 = redout_tmp_165876;
                            }
                            defunc_0_reduce_res_164622 = redout_164860;
                            
                            int64_t bool_res_164630 = btoi_bool_i64(defunc_0_reduce_res_164622);
                            int64_t defunc_0_op_res_164634 = add64(bool_res_164630, scanacc_164864);
                            int64_t zp_res_164637 = add64(bool_res_164630, redout_164866);
                            
                            ((int64_t *) mem_165255)[i_164868] = defunc_0_op_res_164634;
                            ((bool *) mem_165256)[i_164868] = defunc_0_reduce_res_164622;
                            
                            int64_t scanacc_tmp_165872 = defunc_0_op_res_164634;
                            int64_t redout_tmp_165874 = zp_res_164637;
                            
                            scanacc_164864 = scanacc_tmp_165872;
                            redout_164866 = redout_tmp_165874;
                        }
                        discard_164871 = scanacc_164864;
                        defunc_res_164619 = redout_164866;
                        
                        int64_t bytes_165279 = (int64_t) 8 * defunc_res_164619;
                        int64_t conc_tmp_164675 = loop_dz2085U_164610 + defunc_res_164619;
                        int64_t bytes_165287 = b_144114 * conc_tmp_164675;
                        int64_t conc_tmp_164677 = loop_dz2086U_164611 + defunc_res_164619;
                        int64_t bytes_165289 = (int64_t) 8 * conc_tmp_164677;
                        int64_t conc_tmp_164679 = loop_dz2087U_164612 + defunc_res_164619;
                        int64_t bytes_165291 = (int64_t) 8 * conc_tmp_164679;
                        
                        for (int64_t i_164874 = 0; i_164874 < j_m_i_151210; i_164874++) {
                            bool eta_p_164658 = ((bool *) mem_165256)[i_164874];
                            int64_t zv_lhs_164659 = add64((int64_t) -1, i_164874);
                            int64_t tmp_164660 = smod64(zv_lhs_164659, j_m_i_151210);
                            int64_t lifted_lambda_res_164661 = ((int64_t *) mem_165255)[tmp_164660];
                            bool cond_164662 = i_164874 == (int64_t) 0;
                            int64_t lifted_lambda_res_164663;
                            
                            if (cond_164662) {
                                lifted_lambda_res_164663 = (int64_t) 0;
                            } else {
                                lifted_lambda_res_164663 = lifted_lambda_res_164661;
                            }
                            
                            int64_t lifted_lambda_res_164664;
                            
                            if (eta_p_164658) {
                                lifted_lambda_res_164664 = lifted_lambda_res_164663;
                            } else {
                                lifted_lambda_res_164664 = (int64_t) -1;
                            }
                            ((int64_t *) mem_165270)[i_164874] = lifted_lambda_res_164664;
                        }
                        if (memblock_alloc(ctx, &mem_165288, bytes_165287, "mem_165288")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165878 = 0; nest_i_165878 < defunc_res_164619; nest_i_165878++) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165288.mem, b_144114 * loop_dz2085U_164610 + nest_i_165878 * b_144114, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_164928.mem, slice_164616 * b_144114, (int64_t []) {(int64_t) 1}, (int64_t []) {b_144114});
                        }
                        if (memblock_alloc(ctx, &mem_165292, bytes_165291, "mem_165292")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165879 = 0; nest_i_165879 < defunc_res_164619; nest_i_165879++) {
                            ((int64_t *) mem_165292.mem)[loop_dz2087U_164612 + nest_i_165879] = i_164609;
                        }
                        if (memblock_alloc(ctx, &mem_165282, bytes_165279, "mem_165282")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165880 = 0; nest_i_165880 < defunc_res_164619; nest_i_165880++) {
                            ((int64_t *) mem_165282.mem)[nest_i_165880] = (int64_t) 0;
                        }
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165284.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165270, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151210});
                        if (futrts_partitioned_scatter_13032(ctx, &ext_mem_165286, mem_165282, mem_165284, mem_165243, defunc_res_164619, j_m_i_151210, scatter_psizze_144130) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_unref(ctx, &mem_165282, "mem_165282") != 0)
                            return 1;
                        
                        int64_t tmp_offs_165881 = (int64_t) 0;
                        
                        lmad_copy_1b(ctx, 2, (uint8_t *) mem_165288.mem, b_144114 * tmp_offs_165881, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_param_165247.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loop_dz2085U_164610, b_144114});
                        tmp_offs_165881 += loop_dz2085U_164610;
                        if (!(b_144114 * tmp_offs_165881 == b_144114 * loop_dz2085U_164610)) {
                            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165288.mem, b_144114 * tmp_offs_165881, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_165288.mem, b_144114 * loop_dz2085U_164610, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {defunc_res_164619, b_144114});
                        }
                        tmp_offs_165881 += defunc_res_164619;
                        if (memblock_alloc(ctx, &mem_165290, bytes_165289, "mem_165290")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165882 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165290.mem, tmp_offs_165882, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165250.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2086U_164611});
                        tmp_offs_165882 += loop_dz2086U_164611;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165290.mem, tmp_offs_165882, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165286.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_164619});
                        tmp_offs_165882 += defunc_res_164619;
                        if (memblock_unref(ctx, &ext_mem_165286, "ext_mem_165286") != 0)
                            return 1;
                        
                        int64_t tmp_offs_165883 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165292.mem, tmp_offs_165883, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165253.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2087U_164612});
                        tmp_offs_165883 += loop_dz2087U_164612;
                        if (!(tmp_offs_165883 == loop_dz2087U_164612)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165292.mem, tmp_offs_165883, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165292.mem, loop_dz2087U_164612, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_164619});
                        }
                        tmp_offs_165883 += defunc_res_164619;
                        if (memblock_set(ctx, &mem_param_tmp_165863, &mem_165288, "mem_165288") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165864, &mem_165290, "mem_165290") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165865, &mem_165292, "mem_165292") != 0)
                            return 1;
                        
                        int64_t loop_dz2085U_tmp_165866 = conc_tmp_164675;
                        int64_t loop_dz2086U_tmp_165867 = conc_tmp_164677;
                        int64_t loop_dz2087U_tmp_165868 = conc_tmp_164679;
                        
                        if (memblock_set(ctx, &mem_param_165247, &mem_param_tmp_165863, "mem_param_tmp_165863") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165250, &mem_param_tmp_165864, "mem_param_tmp_165864") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165253, &mem_param_tmp_165865, "mem_param_tmp_165865") != 0)
                            return 1;
                        loop_dz2085U_164610 = loop_dz2085U_tmp_165866;
                        loop_dz2086U_164611 = loop_dz2086U_tmp_165867;
                        loop_dz2087U_164612 = loop_dz2087U_tmp_165868;
                    }
                    if (memblock_set(ctx, &ext_mem_165302, &mem_param_165247, "mem_param_165247") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165301, &mem_param_165250, "mem_param_165250") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165300, &mem_param_165253, "mem_param_165253") != 0)
                        return 1;
                    do_find_joinPairs_res_t_res_164603 = loop_dz2085U_164610;
                    do_find_joinPairs_res_t_res_164604 = loop_dz2086U_164611;
                    do_find_joinPairs_res_t_res_164605 = loop_dz2087U_164612;
                    if (memblock_unref(ctx, &mem_165243, "mem_165243") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_165284, "mem_165284") != 0)
                        return 1;
                    
                    int64_t bytes_165303 = (int64_t) 8 * do_find_joinPairs_res_t_res_164604;
                    int64_t bytes_165311 = (int64_t) 8 * do_find_joinPairs_res_t_res_164605;
                    
                    if (memblock_alloc(ctx, &mem_165304, bytes_165303, "mem_165304")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164878 = 0; i_164878 < do_find_joinPairs_res_t_res_164604; i_164878++) {
                        int64_t eta_p_164682 = ((int64_t *) ext_mem_165301.mem)[i_164878];
                        int64_t lifted_lambda_res_164683 = add64(s_lb_151198, eta_p_164682);
                        
                        ((int64_t *) mem_165304.mem)[i_164878] = lifted_lambda_res_164683;
                    }
                    if (memblock_unref(ctx, &ext_mem_165301, "ext_mem_165301") != 0)
                        return 1;
                    if (memblock_alloc(ctx, &mem_165312, bytes_165311, "mem_165312")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164882 = 0; i_164882 < do_find_joinPairs_res_t_res_164605; i_164882++) {
                        int64_t eta_p_164690 = ((int64_t *) ext_mem_165300.mem)[i_164882];
                        int64_t lifted_lambda_res_164691 = add64(r_lb_151149, eta_p_164690);
                        
                        ((int64_t *) mem_165312.mem)[i_164882] = lifted_lambda_res_164691;
                    }
                    if (memblock_unref(ctx, &ext_mem_165300, "ext_mem_165300") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165328, &mem_165304, "mem_165304") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165325, &mem_165312, "mem_165312") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165322, &ext_mem_165302, "ext_mem_165302") != 0)
                        return 1;
                    do_find_joinPairs_res_156850 = do_find_joinPairs_res_t_res_164604;
                    do_find_joinPairs_res_156851 = do_find_joinPairs_res_t_res_164605;
                    do_find_joinPairs_res_156852 = do_find_joinPairs_res_t_res_164603;
                } else {
                    int64_t do_find_joinPairs_res_f_res_156932;
                    int64_t do_find_joinPairs_res_f_res_156933;
                    int64_t do_find_joinPairs_res_f_res_156934;
                    int64_t loop_dz2081Uz2080Uz2081U_156939;
                    int64_t loop_dz2081Uz2080Uz2082U_156940;
                    int64_t loop_dz2081Uz2080Uz2083U_156941;
                    
                    if (memblock_set(ctx, &mem_param_165187, &mem_165162, "mem_165162") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165190, &mem_165163, "mem_165163") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165193, &mem_165163, "mem_165163") != 0)
                        return 1;
                    loop_dz2081Uz2080Uz2081U_156939 = (int64_t) 0;
                    loop_dz2081Uz2080Uz2082U_156940 = (int64_t) 0;
                    loop_dz2081Uz2080Uz2083U_156941 = (int64_t) 0;
                    for (int64_t i_156938 = 0; i_156938 < j_m_i_151210; i_156938++) {
                        int64_t slice_156986 = s_lb_151198 + i_156938;
                        int64_t matches_156946;
                        int64_t loop_dz2081Uz2081Uz2082U_156949;
                        
                        if (memblock_set(ctx, &mem_param_165196, &mem_165163, "mem_165163") != 0)
                            return 1;
                        loop_dz2081Uz2081Uz2082U_156949 = (int64_t) 0;
                        for (int64_t i_156948 = 0; i_156948 < j_m_i_151161; i_156948++) {
                            int64_t slice_156985 = r_lb_151149 + i_156948;
                            bool defunc_0_reduce_res_164699;
                            bool redout_164884 = 1;
                            
                            for (int64_t i_164885 = 0; i_164885 < b_144114; i_164885++) {
                                int8_t eta_p_163018 = ((int8_t *) pS_mem_164929.mem)[slice_156986 * b_144114 + i_164885];
                                int8_t eta_p_163019 = ((int8_t *) pR_mem_164928.mem)[slice_156985 * b_144114 + i_164885];
                                bool defunc_0_f_res_163020 = eta_p_163018 == eta_p_163019;
                                bool x_156960 = defunc_0_f_res_163020 && redout_164884;
                                bool redout_tmp_165898 = x_156960;
                                
                                redout_164884 = redout_tmp_165898;
                            }
                            defunc_0_reduce_res_164699 = redout_164884;
                            
                            int64_t conc_tmp_156961 = (int64_t) 1 + loop_dz2081Uz2081Uz2082U_156949;
                            int64_t loopres_156962;
                            
                            if (defunc_0_reduce_res_164699) {
                                loopres_156962 = conc_tmp_156961;
                            } else {
                                loopres_156962 = loop_dz2081Uz2081Uz2082U_156949;
                            }
                            
                            int64_t bytes_165198 = (int64_t) 8 * loopres_156962;
                            
                            if (defunc_0_reduce_res_164699) {
                                if (memblock_alloc(ctx, &mem_165199, bytes_165198, "mem_165199")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t nest_i_165899 = 0; nest_i_165899 < (int64_t) 1; nest_i_165899++) {
                                    ((int64_t *) mem_165199.mem)[loop_dz2081Uz2081Uz2082U_156949 + nest_i_165899] = i_156948;
                                }
                                
                                int64_t tmp_offs_165900 = (int64_t) 0;
                                
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165199.mem, tmp_offs_165900, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2081Uz2082U_156949});
                                tmp_offs_165900 += loop_dz2081Uz2081Uz2082U_156949;
                                if (!(tmp_offs_165900 == loop_dz2081Uz2081Uz2082U_156949)) {
                                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165199.mem, tmp_offs_165900, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165199.mem, loop_dz2081Uz2081Uz2082U_156949, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                                }
                                tmp_offs_165900 += (int64_t) 1;
                                if (memblock_set(ctx, &ext_mem_165202, &mem_165199, "mem_165199") != 0)
                                    return 1;
                            } else if (memblock_set(ctx, &ext_mem_165202, &mem_param_165196, "mem_param_165196") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_tmp_165895, &ext_mem_165202, "ext_mem_165202") != 0)
                                return 1;
                            
                            int64_t loop_dz2081Uz2081Uz2082U_tmp_165896 = loopres_156962;
                            
                            if (memblock_set(ctx, &mem_param_165196, &mem_param_tmp_165895, "mem_param_tmp_165895") != 0)
                                return 1;
                            loop_dz2081Uz2081Uz2082U_156949 = loop_dz2081Uz2081Uz2082U_tmp_165896;
                        }
                        if (memblock_set(ctx, &ext_mem_165205, &mem_param_165196, "mem_param_165196") != 0)
                            return 1;
                        matches_156946 = loop_dz2081Uz2081Uz2082U_156949;
                        
                        int64_t conc_tmp_156969 = loop_dz2081Uz2080Uz2081U_156939 + matches_156946;
                        int64_t bytes_165210 = b_144114 * conc_tmp_156969;
                        int64_t conc_tmp_156971 = loop_dz2081Uz2080Uz2082U_156940 + matches_156946;
                        int64_t bytes_165212 = (int64_t) 8 * conc_tmp_156971;
                        int64_t conc_tmp_156973 = loop_dz2081Uz2080Uz2083U_156941 + matches_156946;
                        int64_t bytes_165214 = (int64_t) 8 * conc_tmp_156973;
                        
                        if (memblock_alloc(ctx, &mem_165211, bytes_165210, "mem_165211")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165901 = 0; nest_i_165901 < matches_156946; nest_i_165901++) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165211.mem, b_144114 * loop_dz2081Uz2080Uz2081U_156939 + nest_i_165901 * b_144114, (int64_t []) {(int64_t) 1}, (uint8_t *) pS_mem_164929.mem, slice_156986 * b_144114, (int64_t []) {(int64_t) 1}, (int64_t []) {b_144114});
                        }
                        if (memblock_alloc(ctx, &mem_165213, bytes_165212, "mem_165213")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165902 = 0; nest_i_165902 < matches_156946; nest_i_165902++) {
                            ((int64_t *) mem_165213.mem)[loop_dz2081Uz2080Uz2082U_156940 + nest_i_165902] = i_156938;
                        }
                        
                        int64_t tmp_offs_165903 = (int64_t) 0;
                        
                        lmad_copy_1b(ctx, 2, (uint8_t *) mem_165211.mem, b_144114 * tmp_offs_165903, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_param_165187.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loop_dz2081Uz2080Uz2081U_156939, b_144114});
                        tmp_offs_165903 += loop_dz2081Uz2080Uz2081U_156939;
                        if (!(b_144114 * tmp_offs_165903 == b_144114 * loop_dz2081Uz2080Uz2081U_156939)) {
                            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165211.mem, b_144114 * tmp_offs_165903, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_165211.mem, b_144114 * loop_dz2081Uz2080Uz2081U_156939, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {matches_156946, b_144114});
                        }
                        tmp_offs_165903 += matches_156946;
                        
                        int64_t tmp_offs_165904 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165213.mem, tmp_offs_165904, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165190.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2080Uz2082U_156940});
                        tmp_offs_165904 += loop_dz2081Uz2080Uz2082U_156940;
                        if (!(tmp_offs_165904 == loop_dz2081Uz2080Uz2082U_156940)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165213.mem, tmp_offs_165904, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165213.mem, loop_dz2081Uz2080Uz2082U_156940, (int64_t []) {(int64_t) 1}, (int64_t []) {matches_156946});
                        }
                        tmp_offs_165904 += matches_156946;
                        if (memblock_alloc(ctx, &mem_165215, bytes_165214, "mem_165215")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165905 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165215.mem, tmp_offs_165905, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165193.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2080Uz2083U_156941});
                        tmp_offs_165905 += loop_dz2081Uz2080Uz2083U_156941;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165215.mem, tmp_offs_165905, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {matches_156946});
                        tmp_offs_165905 += matches_156946;
                        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165886, &mem_165211, "mem_165211") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165887, &mem_165213, "mem_165213") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_tmp_165888, &mem_165215, "mem_165215") != 0)
                            return 1;
                        
                        int64_t loop_dz2081Uz2080Uz2081U_tmp_165889 = conc_tmp_156969;
                        int64_t loop_dz2081Uz2080Uz2082U_tmp_165890 = conc_tmp_156971;
                        int64_t loop_dz2081Uz2080Uz2083U_tmp_165891 = conc_tmp_156973;
                        
                        if (memblock_set(ctx, &mem_param_165187, &mem_param_tmp_165886, "mem_param_tmp_165886") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165190, &mem_param_tmp_165887, "mem_param_tmp_165887") != 0)
                            return 1;
                        if (memblock_set(ctx, &mem_param_165193, &mem_param_tmp_165888, "mem_param_tmp_165888") != 0)
                            return 1;
                        loop_dz2081Uz2080Uz2081U_156939 = loop_dz2081Uz2080Uz2081U_tmp_165889;
                        loop_dz2081Uz2080Uz2082U_156940 = loop_dz2081Uz2080Uz2082U_tmp_165890;
                        loop_dz2081Uz2080Uz2083U_156941 = loop_dz2081Uz2080Uz2083U_tmp_165891;
                    }
                    if (memblock_set(ctx, &ext_mem_165225, &mem_param_165187, "mem_param_165187") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165224, &mem_param_165190, "mem_param_165190") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165223, &mem_param_165193, "mem_param_165193") != 0)
                        return 1;
                    do_find_joinPairs_res_f_res_156932 = loop_dz2081Uz2080Uz2081U_156939;
                    do_find_joinPairs_res_f_res_156933 = loop_dz2081Uz2080Uz2082U_156940;
                    do_find_joinPairs_res_f_res_156934 = loop_dz2081Uz2080Uz2083U_156941;
                    
                    int64_t bytes_165226 = (int64_t) 8 * do_find_joinPairs_res_f_res_156933;
                    int64_t bytes_165234 = (int64_t) 8 * do_find_joinPairs_res_f_res_156934;
                    
                    if (memblock_alloc(ctx, &mem_165227, bytes_165226, "mem_165227")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164888 = 0; i_164888 < do_find_joinPairs_res_f_res_156933; i_164888++) {
                        int64_t eta_p_156976 = ((int64_t *) ext_mem_165224.mem)[i_164888];
                        int64_t lifted_lambda_res_156977 = add64(s_lb_151198, eta_p_156976);
                        
                        ((int64_t *) mem_165227.mem)[i_164888] = lifted_lambda_res_156977;
                    }
                    if (memblock_unref(ctx, &ext_mem_165224, "ext_mem_165224") != 0)
                        return 1;
                    if (memblock_alloc(ctx, &mem_165235, bytes_165234, "mem_165235")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164892 = 0; i_164892 < do_find_joinPairs_res_f_res_156934; i_164892++) {
                        int64_t eta_p_156979 = ((int64_t *) ext_mem_165223.mem)[i_164892];
                        int64_t lifted_lambda_res_156980 = add64(r_lb_151149, eta_p_156979);
                        
                        ((int64_t *) mem_165235.mem)[i_164892] = lifted_lambda_res_156980;
                    }
                    if (memblock_unref(ctx, &ext_mem_165223, "ext_mem_165223") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165328, &mem_165227, "mem_165227") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165325, &mem_165235, "mem_165235") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165322, &ext_mem_165225, "ext_mem_165225") != 0)
                        return 1;
                    do_find_joinPairs_res_156850 = do_find_joinPairs_res_f_res_156933;
                    do_find_joinPairs_res_156851 = do_find_joinPairs_res_f_res_156934;
                    do_find_joinPairs_res_156852 = do_find_joinPairs_res_f_res_156932;
                }
                if (memblock_set(ctx, &ext_mem_165483, &ext_mem_165325, "ext_mem_165325") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165480, &ext_mem_165328, "ext_mem_165328") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165477, &ext_mem_165322, "ext_mem_165322") != 0)
                    return 1;
                find_joinPairs_res_151225 = do_find_joinPairs_res_156851;
                find_joinPairs_res_151226 = do_find_joinPairs_res_156850;
                find_joinPairs_res_151227 = do_find_joinPairs_res_156852;
            }
            
            int64_t conc_tmp_151243 = loop_dz2083Uz2086U_151189 + find_joinPairs_res_151227;
            int64_t bytes_165484 = b_144114 * conc_tmp_151243;
            int64_t conc_tmp_151245 = loop_dz2083Uz2084U_151187 + find_joinPairs_res_151225;
            int64_t bytes_165486 = (int64_t) 8 * conc_tmp_151245;
            int64_t conc_tmp_151247 = loop_dz2083Uz2085U_151188 + find_joinPairs_res_151226;
            int64_t bytes_165488 = (int64_t) 8 * conc_tmp_151247;
            
            if (memblock_alloc(ctx, &mem_165485, bytes_165484, "mem_165485")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_165908 = (int64_t) 0;
            
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165485.mem, b_144114 * tmp_offs_165908, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_param_165183.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loop_dz2083Uz2086U_151189, b_144114});
            tmp_offs_165908 += loop_dz2083Uz2086U_151189;
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165485.mem, b_144114 * tmp_offs_165908, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) ext_mem_165477.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {find_joinPairs_res_151227, b_144114});
            tmp_offs_165908 += find_joinPairs_res_151227;
            if (memblock_unref(ctx, &ext_mem_165477, "ext_mem_165477") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165487, bytes_165486, "mem_165487")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_165909 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165487.mem, tmp_offs_165909, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165176.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2083Uz2084U_151187});
            tmp_offs_165909 += loop_dz2083Uz2084U_151187;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165487.mem, tmp_offs_165909, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165483.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {find_joinPairs_res_151225});
            tmp_offs_165909 += find_joinPairs_res_151225;
            if (memblock_unref(ctx, &ext_mem_165483, "ext_mem_165483") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165489, bytes_165488, "mem_165489")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_165910 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165489.mem, tmp_offs_165910, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165179.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2083Uz2085U_151188});
            tmp_offs_165910 += loop_dz2083Uz2085U_151188;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165489.mem, tmp_offs_165910, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165480.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {find_joinPairs_res_151226});
            tmp_offs_165910 += find_joinPairs_res_151226;
            if (memblock_unref(ctx, &ext_mem_165480, "ext_mem_165480") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165805, &mem_165487, "mem_165487") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165806, &mem_165489, "mem_165489") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165807, &mem_165485, "mem_165485") != 0)
                return 1;
            
            int64_t loop_dz2083Uz2084U_tmp_165808 = conc_tmp_151245;
            int64_t loop_dz2083Uz2085U_tmp_165809 = conc_tmp_151247;
            int64_t loop_dz2083Uz2086U_tmp_165810 = conc_tmp_151243;
            
            if (memblock_set(ctx, &mem_param_165176, &mem_param_tmp_165805, "mem_param_tmp_165805") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165179, &mem_param_tmp_165806, "mem_param_tmp_165806") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165183, &mem_param_tmp_165807, "mem_param_tmp_165807") != 0)
                return 1;
            loop_dz2083Uz2084U_151187 = loop_dz2083Uz2084U_tmp_165808;
            loop_dz2083Uz2085U_151188 = loop_dz2083Uz2085U_tmp_165809;
            loop_dz2083Uz2086U_151189 = loop_dz2083Uz2086U_tmp_165810;
        }
        if (memblock_set(ctx, &ext_mem_165499, &mem_param_165176, "mem_param_165176") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165498, &mem_param_165179, "mem_param_165179") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165497, &mem_param_165183, "mem_param_165183") != 0)
            return 1;
        loopres_151180 = loop_dz2083Uz2084U_151187;
        loopres_151181 = loop_dz2083Uz2085U_151188;
        loopres_151182 = loop_dz2083Uz2086U_151189;
        
        int64_t conc_tmp_151249 = loop_dz2081Uz2082U_151138 + loopres_151182;
        int64_t bytes_165500 = b_144114 * conc_tmp_151249;
        int64_t conc_tmp_151251 = loop_dz2081Uz2080U_151136 + loopres_151180;
        int64_t bytes_165502 = (int64_t) 8 * conc_tmp_151251;
        int64_t conc_tmp_151253 = loop_dz2081Uz2081U_151137 + loopres_151181;
        int64_t bytes_165504 = (int64_t) 8 * conc_tmp_151253;
        
        if (memblock_alloc(ctx, &mem_165501, bytes_165500, "mem_165501")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_165911 = (int64_t) 0;
        
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_165501.mem, b_144114 * tmp_offs_165911, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) mem_param_165173.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loop_dz2081Uz2082U_151138, b_144114});
        tmp_offs_165911 += loop_dz2081Uz2082U_151138;
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_165501.mem, b_144114 * tmp_offs_165911, (int64_t []) {b_144114, (int64_t) 1}, (uint8_t *) ext_mem_165497.mem, (int64_t) 0, (int64_t []) {b_144114, (int64_t) 1}, (int64_t []) {loopres_151182, b_144114});
        tmp_offs_165911 += loopres_151182;
        if (memblock_unref(ctx, &ext_mem_165497, "ext_mem_165497") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_165503, bytes_165502, "mem_165503")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_165912 = (int64_t) 0;
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165503.mem, tmp_offs_165912, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165166.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2080U_151136});
        tmp_offs_165912 += loop_dz2081Uz2080U_151136;
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165503.mem, tmp_offs_165912, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165499.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151180});
        tmp_offs_165912 += loopres_151180;
        if (memblock_unref(ctx, &ext_mem_165499, "ext_mem_165499") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_165505, bytes_165504, "mem_165505")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_165913 = (int64_t) 0;
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165505.mem, tmp_offs_165913, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165169.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2081U_151137});
        tmp_offs_165913 += loop_dz2081Uz2081U_151137;
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165505.mem, tmp_offs_165913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165498.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151181});
        tmp_offs_165913 += loopres_151181;
        if (memblock_unref(ctx, &ext_mem_165498, "ext_mem_165498") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165796, &mem_165503, "mem_165503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165797, &mem_165505, "mem_165505") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165798, &mem_165501, "mem_165501") != 0)
            return 1;
        
        int64_t loop_dz2081Uz2080U_tmp_165799 = conc_tmp_151251;
        int64_t loop_dz2081Uz2081U_tmp_165800 = conc_tmp_151253;
        int64_t loop_dz2081Uz2082U_tmp_165801 = conc_tmp_151249;
        
        if (memblock_set(ctx, &mem_param_165166, &mem_param_tmp_165796, "mem_param_tmp_165796") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165169, &mem_param_tmp_165797, "mem_param_tmp_165797") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165173, &mem_param_tmp_165798, "mem_param_tmp_165798") != 0)
            return 1;
        loop_dz2081Uz2080U_151136 = loop_dz2081Uz2080U_tmp_165799;
        loop_dz2081Uz2081U_151137 = loop_dz2081Uz2081U_tmp_165800;
        loop_dz2081Uz2082U_151138 = loop_dz2081Uz2082U_tmp_165801;
    }
    if (memblock_set(ctx, &ext_mem_165515, &mem_param_165166, "mem_param_165166") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165514, &mem_param_165169, "mem_param_165169") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165513, &mem_param_165173, "mem_param_165173") != 0)
        return 1;
    join_hashPartitions_res_151129 = loop_dz2081Uz2080U_151136;
    join_hashPartitions_res_151130 = loop_dz2081Uz2081U_151137;
    join_hashPartitions_res_151131 = loop_dz2081Uz2082U_151138;
    if (memblock_unref(ctx, &mem_165159, "mem_165159") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165160, "mem_165160") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165161, "mem_165161") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165162, "mem_165162") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165163, "mem_165163") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &ext_mem_165515, "ext_mem_165515") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &ext_mem_165514, "ext_mem_165514") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165695, &ext_mem_165513, "ext_mem_165513") != 0)
        return 1;
    prim_out_165696 = join_hashPartitions_res_151129;
    prim_out_165697 = join_hashPartitions_res_151130;
    prim_out_165698 = join_hashPartitions_res_151131;
    if (memblock_set(ctx, &*mem_out_p_165914, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165915, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165916, &mem_out_165695, "mem_out_165695") != 0)
        return 1;
    *out_prim_out_165917 = prim_out_165696;
    *out_prim_out_165918 = prim_out_165697;
    *out_prim_out_165919 = prim_out_165698;
    
  cleanup:
    {
        free(mem_164937);
        free(mem_164945);
        free(mem_164947);
        free(mem_164949);
        free(mem_164951);
        free(mem_164964);
        free(mem_164974);
        free(mem_164975);
        free(mem_164988);
        free(mem_164989);
        free(mem_165002);
        free(mem_165003);
        free(mem_165016);
        free(mem_165017);
        free(mem_165033);
        free(mem_165034);
        free(mem_165047);
        free(mem_165048);
        free(mem_165064);
        free(mem_165065);
        free(mem_165078);
        free(mem_165079);
        free(mem_165095);
        free(mem_165096);
        free(mem_165109);
        free(mem_165110);
        free(mem_165136);
        free(mem_165138);
        free(mem_165140);
        free(mem_165255);
        free(mem_165256);
        free(mem_165270);
        free(mem_165400);
        free(mem_165401);
        free(mem_165415);
        if (memblock_unref(ctx, &mem_param_tmp_165798, "mem_param_tmp_165798") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165797, "mem_param_tmp_165797") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165796, "mem_param_tmp_165796") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165505, "mem_165505") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165503, "mem_165503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165501, "mem_165501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165807, "mem_param_tmp_165807") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165806, "mem_param_tmp_165806") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165805, "mem_param_tmp_165805") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165489, "mem_165489") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165487, "mem_165487") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165485, "mem_165485") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165235, "mem_165235") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165227, "mem_165227") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165888, "mem_param_tmp_165888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165887, "mem_param_tmp_165887") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165886, "mem_param_tmp_165886") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165215, "mem_165215") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165213, "mem_165213") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165211, "mem_165211") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165895, "mem_param_tmp_165895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165199, "mem_165199") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165202, "ext_mem_165202") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165196, "mem_param_165196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165193, "mem_param_165193") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165190, "mem_param_165190") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165187, "mem_param_165187") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165223, "ext_mem_165223") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165224, "ext_mem_165224") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165225, "ext_mem_165225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165312, "mem_165312") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165304, "mem_165304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165865, "mem_param_tmp_165865") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165864, "mem_param_tmp_165864") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165863, "mem_param_tmp_165863") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165290, "mem_165290") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165286, "ext_mem_165286") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165282, "mem_165282") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165292, "mem_165292") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165288, "mem_165288") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165253, "mem_param_165253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165250, "mem_param_165250") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165247, "mem_param_165247") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165300, "ext_mem_165300") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165301, "ext_mem_165301") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165302, "ext_mem_165302") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165284, "mem_165284") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165243, "mem_165243") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165322, "ext_mem_165322") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165325, "ext_mem_165325") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165328, "ext_mem_165328") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165380, "mem_165380") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165841, "mem_param_tmp_165841") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165840, "mem_param_tmp_165840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165839, "mem_param_tmp_165839") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165360, "mem_165360") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165358, "mem_165358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165356, "mem_165356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165848, "mem_param_tmp_165848") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165344, "mem_165344") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165347, "ext_mem_165347") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165341, "mem_param_165341") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165350, "ext_mem_165350") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165338, "mem_param_165338") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165335, "mem_param_165335") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165332, "mem_param_165332") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165368, "ext_mem_165368") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165369, "ext_mem_165369") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165370, "ext_mem_165370") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165457, "mem_165457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165449, "mem_165449") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165818, "mem_param_tmp_165818") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165817, "mem_param_tmp_165817") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165435, "mem_165435") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165431, "ext_mem_165431") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165427, "mem_165427") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165437, "mem_165437") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165433, "mem_165433") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165398, "mem_param_165398") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165395, "mem_param_165395") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165392, "mem_param_165392") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165445, "ext_mem_165445") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165446, "ext_mem_165446") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165447, "ext_mem_165447") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165429, "mem_165429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165388, "mem_165388") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165467, "ext_mem_165467") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165470, "ext_mem_165470") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165473, "ext_mem_165473") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165477, "ext_mem_165477") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165480, "ext_mem_165480") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165483, "ext_mem_165483") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165183, "mem_param_165183") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165179, "mem_param_165179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165176, "mem_param_165176") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165497, "ext_mem_165497") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165498, "ext_mem_165498") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165499, "ext_mem_165499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165173, "mem_param_165173") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165169, "mem_param_165169") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165166, "mem_param_165166") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165513, "ext_mem_165513") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165514, "ext_mem_165514") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165515, "ext_mem_165515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165163, "mem_165163") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165162, "mem_165162") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165161, "mem_165161") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165160, "mem_165160") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165159, "mem_165159") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165695, "mem_out_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_165955, struct memblock ks_mem_164928, int64_t n_74295)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_comm_res_157003;
    double defunc_0_reduce_comm_res_157004;
    int64_t redout_164711;
    double redout_164712;
    
    redout_164711 = n_74295;
    redout_164712 = INFINITY;
    for (int64_t i_164713 = 0; i_164713 < n_74295; i_164713++) {
        double x_145877 = ((double *) ks_mem_164928.mem)[i_164713];
        bool defunc_0_lt_res_145882 = redout_164712 < x_145877;
        bool defunc_0_eq_res_145884 = redout_164712 == x_145877;
        bool cond_f_res_t_res_145885 = slt64(redout_164711, i_164713);
        bool x_145886 = defunc_0_eq_res_145884 && cond_f_res_t_res_145885;
        bool x_155439 = !defunc_0_lt_res_145882;
        bool y_155440 = x_145886 && x_155439;
        bool cond_145883 = defunc_0_lt_res_145882 || y_155440;
        int64_t defunc_0_op_res_145887;
        
        if (cond_145883) {
            defunc_0_op_res_145887 = redout_164711;
        } else {
            defunc_0_op_res_145887 = i_164713;
        }
        
        double defunc_0_op_res_145888;
        
        if (cond_145883) {
            defunc_0_op_res_145888 = redout_164712;
        } else {
            defunc_0_op_res_145888 = x_145877;
        }
        
        int64_t redout_tmp_165694 = defunc_0_op_res_145887;
        double redout_tmp_165695 = defunc_0_op_res_145888;
        
        redout_164711 = redout_tmp_165694;
        redout_164712 = redout_tmp_165695;
    }
    defunc_0_reduce_comm_res_157003 = redout_164711;
    defunc_0_reduce_comm_res_157004 = redout_164712;
    prim_out_165693 = defunc_0_reduce_comm_res_157003;
    *out_prim_out_165955 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_165956, struct memblock ks_mem_164928, int64_t n_74118)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_comm_res_157003;
    float defunc_0_reduce_comm_res_157004;
    int64_t redout_164711;
    float redout_164712;
    
    redout_164711 = n_74118;
    redout_164712 = INFINITY;
    for (int64_t i_164713 = 0; i_164713 < n_74118; i_164713++) {
        float x_145877 = ((float *) ks_mem_164928.mem)[i_164713];
        bool defunc_0_lt_res_145882 = redout_164712 < x_145877;
        bool defunc_0_eq_res_145884 = redout_164712 == x_145877;
        bool cond_f_res_t_res_145885 = slt64(redout_164711, i_164713);
        bool x_145886 = defunc_0_eq_res_145884 && cond_f_res_t_res_145885;
        bool x_155439 = !defunc_0_lt_res_145882;
        bool y_155440 = x_145886 && x_155439;
        bool cond_145883 = defunc_0_lt_res_145882 || y_155440;
        int64_t defunc_0_op_res_145887;
        
        if (cond_145883) {
            defunc_0_op_res_145887 = redout_164711;
        } else {
            defunc_0_op_res_145887 = i_164713;
        }
        
        float defunc_0_op_res_145888;
        
        if (cond_145883) {
            defunc_0_op_res_145888 = redout_164712;
        } else {
            defunc_0_op_res_145888 = x_145877;
        }
        
        int64_t redout_tmp_165694 = defunc_0_op_res_145887;
        float redout_tmp_165695 = defunc_0_op_res_145888;
        
        redout_164711 = redout_tmp_165694;
        redout_164712 = redout_tmp_165695;
    }
    defunc_0_reduce_comm_res_157003 = redout_164711;
    defunc_0_reduce_comm_res_157004 = redout_164712;
    prim_out_165693 = defunc_0_reduce_comm_res_157003;
    *out_prim_out_165956 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_165957, struct memblock ks_mem_164928, int64_t n_73767)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_comm_res_157003;
    int32_t defunc_0_reduce_comm_res_157004;
    int64_t redout_164711;
    int32_t redout_164712;
    
    redout_164711 = n_73767;
    redout_164712 = 2147483647;
    for (int64_t i_164713 = 0; i_164713 < n_73767; i_164713++) {
        int32_t x_145877 = ((int32_t *) ks_mem_164928.mem)[i_164713];
        bool defunc_0_lt_res_145882 = slt32(redout_164712, x_145877);
        bool defunc_0_eq_res_145884 = redout_164712 == x_145877;
        bool cond_f_res_t_res_145885 = slt64(redout_164711, i_164713);
        bool x_145886 = defunc_0_eq_res_145884 && cond_f_res_t_res_145885;
        bool x_155439 = !defunc_0_lt_res_145882;
        bool y_155440 = x_145886 && x_155439;
        bool cond_145883 = defunc_0_lt_res_145882 || y_155440;
        int64_t defunc_0_op_res_145887;
        
        if (cond_145883) {
            defunc_0_op_res_145887 = redout_164711;
        } else {
            defunc_0_op_res_145887 = i_164713;
        }
        
        int32_t defunc_0_op_res_145888;
        
        if (cond_145883) {
            defunc_0_op_res_145888 = redout_164712;
        } else {
            defunc_0_op_res_145888 = x_145877;
        }
        
        int64_t redout_tmp_165694 = defunc_0_op_res_145887;
        int32_t redout_tmp_165695 = defunc_0_op_res_145888;
        
        redout_164711 = redout_tmp_165694;
        redout_164712 = redout_tmp_165695;
    }
    defunc_0_reduce_comm_res_157003 = redout_164711;
    defunc_0_reduce_comm_res_157004 = redout_164712;
    prim_out_165693 = defunc_0_reduce_comm_res_157003;
    *out_prim_out_165957 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_165958, struct memblock ks_mem_164928, int64_t n_73941)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_comm_res_157003;
    int64_t defunc_0_reduce_comm_res_157004;
    int64_t redout_164711;
    int64_t redout_164712;
    
    redout_164711 = n_73941;
    redout_164712 = (int64_t) 9223372036854775807;
    for (int64_t i_164713 = 0; i_164713 < n_73941; i_164713++) {
        int64_t x_145877 = ((int64_t *) ks_mem_164928.mem)[i_164713];
        bool defunc_0_lt_res_145882 = slt64(redout_164712, x_145877);
        bool defunc_0_eq_res_145884 = redout_164712 == x_145877;
        bool cond_f_res_t_res_145885 = slt64(redout_164711, i_164713);
        bool x_145886 = defunc_0_eq_res_145884 && cond_f_res_t_res_145885;
        bool x_155439 = !defunc_0_lt_res_145882;
        bool y_155440 = x_145886 && x_155439;
        bool cond_145883 = defunc_0_lt_res_145882 || y_155440;
        int64_t defunc_0_op_res_145887;
        
        if (cond_145883) {
            defunc_0_op_res_145887 = redout_164711;
        } else {
            defunc_0_op_res_145887 = i_164713;
        }
        
        int64_t defunc_0_op_res_145888;
        
        if (cond_145883) {
            defunc_0_op_res_145888 = redout_164712;
        } else {
            defunc_0_op_res_145888 = x_145877;
        }
        
        int64_t redout_tmp_165694 = defunc_0_op_res_145887;
        int64_t redout_tmp_165695 = defunc_0_op_res_145888;
        
        redout_164711 = redout_tmp_165694;
        redout_164712 = redout_tmp_165695;
    }
    defunc_0_reduce_comm_res_157003 = redout_164711;
    defunc_0_reduce_comm_res_157004 = redout_164712;
    prim_out_165693 = defunc_0_reduce_comm_res_157003;
    *out_prim_out_165958 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_165959, struct memblock ks_mem_164928, int64_t n_73593)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_comm_res_157003;
    int16_t defunc_0_reduce_comm_res_157004;
    int64_t redout_164711;
    int16_t redout_164712;
    
    redout_164711 = n_73593;
    redout_164712 = (int16_t) 32767;
    for (int64_t i_164713 = 0; i_164713 < n_73593; i_164713++) {
        int16_t x_145877 = ((int16_t *) ks_mem_164928.mem)[i_164713];
        bool defunc_0_lt_res_145882 = slt16(redout_164712, x_145877);
        bool defunc_0_eq_res_145884 = redout_164712 == x_145877;
        bool cond_f_res_t_res_145885 = slt64(redout_164711, i_164713);
        bool x_145886 = defunc_0_eq_res_145884 && cond_f_res_t_res_145885;
        bool x_155439 = !defunc_0_lt_res_145882;
        bool y_155440 = x_145886 && x_155439;
        bool cond_145883 = defunc_0_lt_res_145882 || y_155440;
        int64_t defunc_0_op_res_145887;
        
        if (cond_145883) {
            defunc_0_op_res_145887 = redout_164711;
        } else {
            defunc_0_op_res_145887 = i_164713;
        }
        
        int16_t defunc_0_op_res_145888;
        
        if (cond_145883) {
            defunc_0_op_res_145888 = redout_164712;
        } else {
            defunc_0_op_res_145888 = x_145877;
        }
        
        int64_t redout_tmp_165694 = defunc_0_op_res_145887;
        int16_t redout_tmp_165695 = defunc_0_op_res_145888;
        
        redout_164711 = redout_tmp_165694;
        redout_164712 = redout_tmp_165695;
    }
    defunc_0_reduce_comm_res_157003 = redout_164711;
    defunc_0_reduce_comm_res_157004 = redout_164712;
    prim_out_165693 = defunc_0_reduce_comm_res_157003;
    *out_prim_out_165959 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_165960, struct memblock *mem_out_p_165961, int64_t *out_prim_out_165962, int32_t *out_prim_out_165963, struct memblock pXs_mem_164928, int64_t n_140775, int64_t b_140776, int32_t radix_sizze_140777, int64_t offset_140779, int64_t sizze_thresh_140780, int32_t max_depth_140781)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164938_cached_sizze_165964 = 0;
    unsigned char *mem_164938 = NULL;
    int64_t mem_164940_cached_sizze_165965 = 0;
    unsigned char *mem_164940 = NULL;
    int64_t mem_164942_cached_sizze_165966 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164944_cached_sizze_165967 = 0;
    unsigned char *mem_164944 = NULL;
    int64_t mem_164970_cached_sizze_165968 = 0;
    unsigned char *mem_164970 = NULL;
    int64_t mem_164972_cached_sizze_165969 = 0;
    unsigned char *mem_164972 = NULL;
    int64_t mem_164974_cached_sizze_165970 = 0;
    unsigned char *mem_164974 = NULL;
    struct memblock mem_165029;
    
    mem_165029.references = NULL;
    
    struct memblock mem_param_tmp_165698;
    
    mem_param_tmp_165698.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165716;
    
    mem_param_tmp_165716.references = NULL;
    
    struct memblock mem_param_tmp_165715;
    
    mem_param_tmp_165715.references = NULL;
    
    struct memblock mem_165015;
    
    mem_165015.references = NULL;
    
    struct memblock mem_165013;
    
    mem_165013.references = NULL;
    
    struct memblock ext_mem_165002;
    
    ext_mem_165002.references = NULL;
    
    struct memblock ext_mem_165003;
    
    ext_mem_165003.references = NULL;
    
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock mem_param_164998;
    
    mem_param_164998.references = NULL;
    
    struct memblock mem_param_164995;
    
    mem_param_164995.references = NULL;
    
    struct memblock ext_mem_165020;
    
    ext_mem_165020.references = NULL;
    
    struct memblock ext_mem_165021;
    
    ext_mem_165021.references = NULL;
    
    struct memblock mem_param_164936;
    
    mem_param_164936.references = NULL;
    
    struct memblock mem_param_164933;
    
    mem_param_164933.references = NULL;
    
    struct memblock ext_mem_165026;
    
    ext_mem_165026.references = NULL;
    
    struct memblock ext_mem_165027;
    
    ext_mem_165027.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock ext_mem_164930;
    
    ext_mem_164930.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165695;
    int32_t prim_out_165696;
    int32_t getPartitionBounds_arg3_146805 = sub32(radix_sizze_140777, 1);
    int64_t calc_partitions_from_partitioned_set_res_146806;
    int64_t calc_partitions_from_partitioned_set_res_146807;
    int32_t calc_partitions_from_partitioned_set_res_146810;
    
    if (futrts_getPartitionBounds_12923(ctx, &ext_mem_164930, &ext_mem_164929, &calc_partitions_from_partitioned_set_res_146806, &calc_partitions_from_partitioned_set_res_146807, &calc_partitions_from_partitioned_set_res_146810, pXs_mem_164928, n_140775, b_140776, 1, 0, getPartitionBounds_arg3_146805) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool cond_146811 = slt32(calc_partitions_from_partitioned_set_res_146810, max_depth_140781);
    int64_t calc_partitions_from_partitioned_set_res_146812;
    int64_t calc_partitions_from_partitioned_set_res_146813;
    bool calc_partitions_from_partitioned_set_res_146814;
    int32_t calc_partitions_from_partitioned_set_res_146817;
    int64_t loop_dz2088U_146818;
    int64_t loop_dz2089U_146819;
    bool loop_while_146820;
    int32_t p_146823;
    
    if (memblock_set(ctx, &mem_param_164933, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164936, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    loop_dz2088U_146818 = calc_partitions_from_partitioned_set_res_146806;
    loop_dz2089U_146819 = calc_partitions_from_partitioned_set_res_146807;
    loop_while_146820 = cond_146811;
    p_146823 = calc_partitions_from_partitioned_set_res_146810;
    while (loop_while_146820) {
        int64_t zl_rhs_146826 = sub64(loop_dz2088U_146818, (int64_t) 1);
        int64_t bytes_164937 = (int64_t) 8 * loop_dz2088U_146818;
        
        if (mem_164938_cached_sizze_165964 < bytes_164937) {
            err = lexical_realloc(ctx, &mem_164938, &mem_164938_cached_sizze_165964, bytes_164937);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164940_cached_sizze_165965 < bytes_164937) {
            err = lexical_realloc(ctx, &mem_164940, &mem_164940_cached_sizze_165965, bytes_164937);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164942_cached_sizze_165966 < bytes_164937) {
            err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_165966, bytes_164937);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164944_cached_sizze_165967 < bytes_164937) {
            err = lexical_realloc(ctx, &mem_164944, &mem_164944_cached_sizze_165967, bytes_164937);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_164725;
        int64_t scanacc_164715 = (int64_t) 0;
        
        for (int64_t i_164720 = 0; i_164720 < loop_dz2088U_146818; i_164720++) {
            int64_t tmp_157027 = ((int64_t *) mem_param_164933.mem)[i_164720];
            bool cond_157028 = slt64(i_164720, zl_rhs_146826);
            int64_t tmp_157029;
            
            if (cond_157028) {
                int64_t tmp_157067 = add64((int64_t) 1, i_164720);
                bool x_157068 = sle64((int64_t) 0, tmp_157067);
                bool y_157069 = slt64(tmp_157067, loop_dz2088U_146818);
                bool bounds_check_157070 = x_157068 && y_157069;
                bool index_certs_157071;
                
                if (!bounds_check_157070) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157067, "] out of bounds for array of shape [", (long long) loop_dz2088U_146818, "].", "-> #0  ftRelational.fut:254:55-62\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:242:1-279:32\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_t_res_157072 = ((int64_t *) mem_param_164933.mem)[tmp_157067];
                
                tmp_157029 = tmp_t_res_157072;
            } else {
                tmp_157029 = n_140775;
            }
            
            int64_t zg_lhs_157038 = sub64(tmp_157029, tmp_157027);
            bool lifted_lambda_res_157039 = slt64(sizze_thresh_140780, zg_lhs_157038);
            int64_t defunc_0_f_res_157040 = btoi_bool_i64(lifted_lambda_res_157039);
            int64_t defunc_0_op_res_146858 = add64(defunc_0_f_res_157040, scanacc_164715);
            
            ((int64_t *) mem_164938)[i_164720] = defunc_0_op_res_146858;
            ((int64_t *) mem_164940)[i_164720] = defunc_0_f_res_157040;
            ((int64_t *) mem_164942)[i_164720] = tmp_157027;
            ((int64_t *) mem_164944)[i_164720] = tmp_157029;
            
            int64_t scanacc_tmp_165705 = defunc_0_op_res_146858;
            
            scanacc_164715 = scanacc_tmp_165705;
        }
        discard_164725 = scanacc_164715;
        
        bool cond_146859 = loop_dz2088U_146818 == (int64_t) 0;
        bool x_146860 = !cond_146859;
        bool x_146862 = sle64((int64_t) 0, zl_rhs_146826);
        bool y_146863 = slt64(zl_rhs_146826, loop_dz2088U_146818);
        bool bounds_check_146864 = x_146862 && y_146863;
        bool protect_assert_disj_146865 = cond_146859 || bounds_check_146864;
        bool index_certs_146866;
        
        if (!protect_assert_disj_146865) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_146826, "] out of bounds for array of shape [", (long long) loop_dz2088U_146818, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:242:1-279:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t m_f_res_146867;
        
        if (x_146860) {
            int64_t x_157073 = ((int64_t *) mem_164938)[zl_rhs_146826];
            
            m_f_res_146867 = x_157073;
        } else {
            m_f_res_146867 = (int64_t) 0;
        }
        
        int64_t m_146869;
        
        if (cond_146859) {
            m_146869 = (int64_t) 0;
        } else {
            m_146869 = m_f_res_146867;
        }
        
        int64_t m_146879 = sub64(m_146869, (int64_t) 1);
        bool i_p_m_t_s_leq_w_146881 = slt64(m_146879, loop_dz2088U_146818);
        bool zzero_leq_i_p_m_t_s_146880 = sle64((int64_t) 0, m_146879);
        bool y_146883 = zzero_leq_i_p_m_t_s_146880 && i_p_m_t_s_leq_w_146881;
        bool i_lte_j_146882 = sle64((int64_t) 0, m_146869);
        bool forwards_ok_146884 = i_lte_j_146882 && y_146883;
        bool eq_x_zz_146876 = (int64_t) 0 == m_f_res_146867;
        bool p_and_eq_x_y_146877 = x_146860 && eq_x_zz_146876;
        bool empty_slice_146878 = cond_146859 || p_and_eq_x_y_146877;
        bool ok_or_empty_146885 = empty_slice_146878 || forwards_ok_146884;
        bool index_certs_146886;
        
        if (!ok_or_empty_146885) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_146869, "] out of bounds for array of shape [", (long long) loop_dz2088U_146818, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:242:1-279:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_164969 = (int64_t) 8 * m_146869;
        
        if (mem_164970_cached_sizze_165968 < bytes_164969) {
            err = lexical_realloc(ctx, &mem_164970, &mem_164970_cached_sizze_165968, bytes_164969);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_165710 = 0; i_165710 < m_146869; i_165710++) {
            int64_t x_165711 = (int64_t) 0 + i_165710 * (int64_t) 1;
            
            ((int64_t *) mem_164970)[i_165710] = x_165711;
        }
        if (mem_164972_cached_sizze_165969 < bytes_164969) {
            err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_165969, bytes_164969);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164944, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_146869});
        if (mem_164974_cached_sizze_165970 < bytes_164969) {
            err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_165970, bytes_164969);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164974, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164942, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_146869});
        for (int64_t write_iter_164726 = 0; write_iter_164726 < loop_dz2088U_146818; write_iter_164726++) {
            int64_t write_iv_164730 = ((int64_t *) mem_164940)[write_iter_164726];
            int64_t write_iv_164731 = ((int64_t *) mem_164938)[write_iter_164726];
            int64_t write_iv_164732 = ((int64_t *) mem_164942)[write_iter_164726];
            int64_t write_iv_164733 = ((int64_t *) mem_164944)[write_iter_164726];
            bool cond_157009 = write_iv_164730 == (int64_t) 1;
            int64_t lifted_lambda_res_157010;
            
            if (cond_157009) {
                int64_t lifted_lambda_res_t_res_157074 = sub64(write_iv_164731, (int64_t) 1);
                
                lifted_lambda_res_157010 = lifted_lambda_res_t_res_157074;
            } else {
                lifted_lambda_res_157010 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157010) && slt64(lifted_lambda_res_157010, m_146869)) {
                ((int64_t *) mem_164974)[lifted_lambda_res_157010] = write_iv_164732;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157010) && slt64(lifted_lambda_res_157010, m_146869)) {
                ((int64_t *) mem_164972)[lifted_lambda_res_157010] = write_iv_164733;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157010) && slt64(lifted_lambda_res_157010, m_146869)) {
                ((int64_t *) mem_164970)[lifted_lambda_res_157010] = write_iter_164726;
            }
        }
        
        int32_t new_i_146900 = mul32(radix_sizze_140777, p_146823);
        int32_t zt_rhs_146901 = add32(1, p_146823);
        int32_t zm_lhs_146902 = mul32(radix_sizze_140777, zt_rhs_146901);
        int32_t new_j_146903 = sub32(zm_lhs_146902, 1);
        int64_t loopres_146904;
        int64_t loopres_146905;
        int32_t loopres_146908;
        int64_t loopres_146909;
        int64_t loopres_146910;
        int64_t loop_dz2084Uz2089U_146912;
        int64_t loop_dz2085Uz2080U_146913;
        int32_t q_146916;
        int64_t ad_146917;
        int64_t ox_146918;
        
        if (memblock_set(ctx, &mem_param_164995, &mem_param_164933, "mem_param_164933") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164998, &mem_param_164936, "mem_param_164936") != 0)
            return 1;
        loop_dz2084Uz2089U_146912 = loop_dz2088U_146818;
        loop_dz2085Uz2080U_146913 = loop_dz2089U_146819;
        q_146916 = p_146823;
        ad_146917 = (int64_t) 0;
        ox_146918 = (int64_t) 0;
        for (int64_t i_146911 = 0; i_146911 < m_146869; i_146911++) {
            int64_t bounds_146919 = ((int64_t *) mem_164974)[i_146911];
            int64_t bounds_146920 = ((int64_t *) mem_164972)[i_146911];
            int64_t bounds_146921 = ((int64_t *) mem_164970)[i_146911];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_146922 = sub64(bounds_146920, bounds_146919);
            bool empty_slice_146923 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_146922 == (int64_t) 0;
            int64_t m_146924 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_146922, (int64_t) 1);
            int64_t i_p_m_t_s_146925 = add64(bounds_146919, m_146924);
            bool zzero_leq_i_p_m_t_s_146926 = sle64((int64_t) 0, i_p_m_t_s_146925);
            bool i_p_m_t_s_leq_w_146927 = slt64(i_p_m_t_s_146925, n_140775);
            bool zzero_lte_i_146928 = sle64((int64_t) 0, bounds_146919);
            bool i_lte_j_146929 = sle64(bounds_146919, bounds_146920);
            bool y_146930 = i_p_m_t_s_leq_w_146927 && zzero_lte_i_146928;
            bool y_146931 = zzero_leq_i_p_m_t_s_146926 && y_146930;
            bool forwards_ok_146932 = i_lte_j_146929 && y_146931;
            bool ok_or_empty_146933 = empty_slice_146923 || forwards_ok_146932;
            bool index_certs_146934;
            
            if (!ok_or_empty_146933) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_146919, ":", (long long) bounds_146920, "] out of bounds for array of shape [", (long long) n_140775, "].", "-> #0  ftRelational.fut:260:21-43\n   #1  ftRelational.fut:242:1-279:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164999 = b_140776 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_146922;
            
            if (memblock_alloc(ctx, &mem_165000, bytes_164999, "mem_165000")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165000.mem, (int64_t) 0, (int64_t []) {b_140776, (int64_t) 1}, (uint8_t *) pXs_mem_164928.mem, b_140776 * bounds_146919, (int64_t []) {b_140776, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_146922, b_140776});
            
            int64_t loopres_146938;
            int64_t loopres_146939;
            int32_t loopres_146942;
            
            if (futrts_getPartitionBounds_12923(ctx, &ext_mem_165003, &ext_mem_165002, &loopres_146938, &loopres_146939, &loopres_146942, mem_165000, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_146922, b_140776, zt_rhs_146901, new_i_146900, new_j_146903) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
                return 1;
            
            int64_t zm_lhs_146943 = add64(ox_146918, bounds_146921);
            int64_t stitch_146944 = sub64(zm_lhs_146943, ad_146917);
            bool empty_slice_146945 = stitch_146944 == (int64_t) 0;
            int64_t m_146946 = sub64(stitch_146944, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_146947 = sle64((int64_t) 0, m_146946);
            bool i_p_m_t_s_leq_w_146948 = slt64(m_146946, loop_dz2084Uz2089U_146912);
            bool i_lte_j_146949 = sle64((int64_t) 0, stitch_146944);
            bool y_146950 = zzero_leq_i_p_m_t_s_146947 && i_p_m_t_s_leq_w_146948;
            bool forwards_ok_146951 = i_lte_j_146949 && y_146950;
            bool ok_or_empty_146952 = empty_slice_146945 || forwards_ok_146951;
            bool index_certs_146953;
            
            if (!ok_or_empty_146952) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_146944, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_146912, "].", "-> #0  ftRelational.fut:268:18-36\n   #1  ftRelational.fut:242:1-279:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_146958 = loopres_146938 + stitch_146944;
            int64_t zpzp_rhs_146959 = add64((int64_t) 1, stitch_146944);
            int64_t j_m_i_146960 = sub64(loop_dz2084Uz2089U_146912, zpzp_rhs_146959);
            bool empty_slice_146961 = j_m_i_146960 == (int64_t) 0;
            int64_t m_146962 = sub64(j_m_i_146960, (int64_t) 1);
            int64_t i_p_m_t_s_146963 = add64(zpzp_rhs_146959, m_146962);
            bool zzero_leq_i_p_m_t_s_146964 = sle64((int64_t) 0, i_p_m_t_s_146963);
            bool i_p_m_t_s_leq_w_146965 = slt64(i_p_m_t_s_146963, loop_dz2084Uz2089U_146912);
            bool zzero_lte_i_146966 = sle64((int64_t) 0, zpzp_rhs_146959);
            bool i_lte_j_146967 = sle64(zpzp_rhs_146959, loop_dz2084Uz2089U_146912);
            bool y_146968 = i_p_m_t_s_leq_w_146965 && zzero_lte_i_146966;
            bool y_146969 = zzero_leq_i_p_m_t_s_146964 && y_146968;
            bool forwards_ok_146970 = i_lte_j_146967 && y_146969;
            bool ok_or_empty_146971 = empty_slice_146961 || forwards_ok_146970;
            bool index_certs_146972;
            
            if (!ok_or_empty_146971) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_146959, ":", (long long) loop_dz2084Uz2089U_146912, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_146912, "].", "-> #0  ftRelational.fut:268:90-126\n   #1  ftRelational.fut:242:1-279:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_146974 = conc_tmp_146958 + j_m_i_146960;
            int64_t bytes_165012 = (int64_t) 8 * conc_tmp_146974;
            bool i_p_m_t_s_leq_w_146976 = slt64(m_146946, loop_dz2085Uz2080U_146913);
            bool y_146977 = zzero_leq_i_p_m_t_s_146947 && i_p_m_t_s_leq_w_146976;
            bool ok_or_empty_146978 = empty_slice_146945 || y_146977;
            bool index_certs_146979;
            
            if (!ok_or_empty_146978) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_146944, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_146913, "].", "-> #0  ftRelational.fut:269:18-36\n   #1  ftRelational.fut:242:1-279:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_146981 = loopres_146939 + stitch_146944;
            int64_t j_m_i_146982 = sub64(loop_dz2085Uz2080U_146913, zpzp_rhs_146959);
            bool empty_slice_146983 = j_m_i_146982 == (int64_t) 0;
            int64_t m_146984 = sub64(j_m_i_146982, (int64_t) 1);
            int64_t i_p_m_t_s_146985 = add64(zpzp_rhs_146959, m_146984);
            bool zzero_leq_i_p_m_t_s_146986 = sle64((int64_t) 0, i_p_m_t_s_146985);
            bool i_p_m_t_s_leq_w_146987 = slt64(i_p_m_t_s_146985, loop_dz2085Uz2080U_146913);
            bool i_lte_j_146988 = sle64(zpzp_rhs_146959, loop_dz2085Uz2080U_146913);
            bool y_146989 = zzero_lte_i_146966 && i_p_m_t_s_leq_w_146987;
            bool y_146990 = zzero_leq_i_p_m_t_s_146986 && y_146989;
            bool forwards_ok_146991 = i_lte_j_146988 && y_146990;
            bool ok_or_empty_146992 = empty_slice_146983 || forwards_ok_146991;
            bool index_certs_146993;
            
            if (!ok_or_empty_146992) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_146959, ":", (long long) loop_dz2085Uz2080U_146913, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_146913, "].", "-> #0  ftRelational.fut:269:62-98\n   #1  ftRelational.fut:242:1-279:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_146995 = conc_tmp_146981 + j_m_i_146982;
            int64_t bytes_165014 = (int64_t) 4 * conc_tmp_146995;
            
            if (memblock_alloc(ctx, &mem_165013, bytes_165012, "mem_165013")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164740 = 0; i_164740 < loopres_146938; i_164740++) {
                int64_t eta_p_146956 = ((int64_t *) ext_mem_165003.mem)[i_164740];
                int64_t lifted_lambda_res_146957 = add64(bounds_146919, eta_p_146956);
                
                ((int64_t *) mem_165013.mem)[stitch_146944 + i_164740] = lifted_lambda_res_146957;
            }
            if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
                return 1;
            
            int64_t tmp_offs_165725 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165013.mem, tmp_offs_165725, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_146944});
            tmp_offs_165725 += stitch_146944;
            if (!(tmp_offs_165725 == stitch_146944)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165013.mem, tmp_offs_165725, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165013.mem, stitch_146944, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_146938});
            }
            tmp_offs_165725 += loopres_146938;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165013.mem, tmp_offs_165725, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164995.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_146959, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_146960});
            tmp_offs_165725 += j_m_i_146960;
            if (memblock_alloc(ctx, &mem_165015, bytes_165014, "mem_165015")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_165726 = (int64_t) 0;
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165015.mem, tmp_offs_165726, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_164998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_146944});
            tmp_offs_165726 += stitch_146944;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165015.mem, tmp_offs_165726, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165002.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_146939});
            tmp_offs_165726 += loopres_146939;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165015.mem, tmp_offs_165726, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_164998.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_146959, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_146982});
            tmp_offs_165726 += j_m_i_146982;
            if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
                return 1;
            
            int64_t tmp_146997 = add64((int64_t) 1, ad_146917);
            int64_t tmp_146998 = add64(ox_146918, loopres_146938);
            
            if (memblock_set(ctx, &mem_param_tmp_165715, &mem_165013, "mem_165013") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165716, &mem_165015, "mem_165015") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2089U_tmp_165717 = conc_tmp_146974;
            int64_t loop_dz2085Uz2080U_tmp_165718 = conc_tmp_146995;
            int32_t q_tmp_165721 = zt_rhs_146901;
            int64_t ad_tmp_165722 = tmp_146997;
            int64_t ox_tmp_165723 = tmp_146998;
            
            if (memblock_set(ctx, &mem_param_164995, &mem_param_tmp_165715, "mem_param_tmp_165715") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164998, &mem_param_tmp_165716, "mem_param_tmp_165716") != 0)
                return 1;
            loop_dz2084Uz2089U_146912 = loop_dz2084Uz2089U_tmp_165717;
            loop_dz2085Uz2080U_146913 = loop_dz2085Uz2080U_tmp_165718;
            q_146916 = q_tmp_165721;
            ad_146917 = ad_tmp_165722;
            ox_146918 = ox_tmp_165723;
        }
        if (memblock_set(ctx, &ext_mem_165021, &mem_param_164995, "mem_param_164995") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165020, &mem_param_164998, "mem_param_164998") != 0)
            return 1;
        loopres_146904 = loop_dz2084Uz2089U_146912;
        loopres_146905 = loop_dz2085Uz2080U_146913;
        loopres_146908 = q_146916;
        loopres_146909 = ad_146917;
        loopres_146910 = ox_146918;
        
        bool tmp_146999 = slt64((int64_t) 0, m_146869);
        bool cond_147000 = slt32(loopres_146908, max_depth_140781);
        bool x_147001 = tmp_146999 && cond_147000;
        
        if (memblock_set(ctx, &mem_param_tmp_165697, &ext_mem_165021, "ext_mem_165021") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165698, &ext_mem_165020, "ext_mem_165020") != 0)
            return 1;
        
        int64_t loop_dz2088U_tmp_165699 = loopres_146904;
        int64_t loop_dz2089U_tmp_165700 = loopres_146905;
        bool loop_while_tmp_165701 = x_147001;
        int32_t p_tmp_165704 = loopres_146908;
        
        if (memblock_set(ctx, &mem_param_164933, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164936, &mem_param_tmp_165698, "mem_param_tmp_165698") != 0)
            return 1;
        loop_dz2088U_146818 = loop_dz2088U_tmp_165699;
        loop_dz2089U_146819 = loop_dz2089U_tmp_165700;
        loop_while_146820 = loop_while_tmp_165701;
        p_146823 = p_tmp_165704;
    }
    if (memblock_set(ctx, &ext_mem_165027, &mem_param_164933, "mem_param_164933") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165026, &mem_param_164936, "mem_param_164936") != 0)
        return 1;
    calc_partitions_from_partitioned_set_res_146812 = loop_dz2088U_146818;
    calc_partitions_from_partitioned_set_res_146813 = loop_dz2089U_146819;
    calc_partitions_from_partitioned_set_res_146814 = loop_while_146820;
    calc_partitions_from_partitioned_set_res_146817 = p_146823;
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    
    int64_t bytes_165028 = (int64_t) 8 * calc_partitions_from_partitioned_set_res_146812;
    bool dim_match_147005 = calc_partitions_from_partitioned_set_res_146812 == calc_partitions_from_partitioned_set_res_146813;
    bool empty_or_match_cert_147006;
    
    if (!dim_match_147005) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) calc_partitions_from_partitioned_set_res_146813, "] cannot match shape of type `[", (long long) calc_partitions_from_partitioned_set_res_146812, "]i32`.", "-> #0  ftRelational.fut:277:14-54\n   #1  ftRelational.fut:242:1-279:32\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165029, bytes_165028, "mem_165029")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164744 = 0; i_164744 < calc_partitions_from_partitioned_set_res_146812; i_164744++) {
        int64_t eta_p_147003 = ((int64_t *) ext_mem_165027.mem)[i_164744];
        int64_t lifted_lambda_res_147004 = add64(offset_140779, eta_p_147003);
        
        ((int64_t *) mem_165029.mem)[i_164744] = lifted_lambda_res_147004;
    }
    if (memblock_unref(ctx, &ext_mem_165027, "ext_mem_165027") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165029, "mem_165029") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &ext_mem_165026, "ext_mem_165026") != 0)
        return 1;
    prim_out_165695 = calc_partitions_from_partitioned_set_res_146812;
    prim_out_165696 = calc_partitions_from_partitioned_set_res_146817;
    if (memblock_set(ctx, &*mem_out_p_165960, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165961, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    *out_prim_out_165962 = prim_out_165695;
    *out_prim_out_165963 = prim_out_165696;
    
  cleanup:
    {
        free(mem_164938);
        free(mem_164940);
        free(mem_164942);
        free(mem_164944);
        free(mem_164970);
        free(mem_164972);
        free(mem_164974);
        if (memblock_unref(ctx, &mem_165029, "mem_165029") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165698, "mem_param_tmp_165698") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165716, "mem_param_tmp_165716") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165715, "mem_param_tmp_165715") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165015, "mem_165015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165013, "mem_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164998, "mem_param_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164995, "mem_param_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165020, "ext_mem_165020") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165021, "ext_mem_165021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164936, "mem_param_164936") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164933, "mem_param_164933") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165026, "ext_mem_165026") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165027, "ext_mem_165027") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_165971, struct memblock *mem_out_p_165972, int64_t *out_prim_out_165973, struct memblock pXs_mem_164928, struct memblock bounds_mem_164929, struct memblock depths_mem_164930, int64_t n_141596, int64_t b_141597, int64_t dz2080U_141598, int64_t dz2081U_141599, int32_t radix_sizze_141600, int32_t maxDepth_141604, int64_t scatter_psizze_141605)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_165974 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164942_cached_sizze_165975 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164946_cached_sizze_165976 = 0;
    unsigned char *mem_164946 = NULL;
    int64_t mem_164978_cached_sizze_165977 = 0;
    unsigned char *mem_164978 = NULL;
    int64_t mem_164980_cached_sizze_165978 = 0;
    unsigned char *mem_164980 = NULL;
    struct memblock ext_mem_165004;
    
    ext_mem_165004.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock ext_mem_164998;
    
    ext_mem_164998.references = NULL;
    
    struct memblock mem_164996;
    
    mem_164996.references = NULL;
    
    struct memblock mem_164994;
    
    mem_164994.references = NULL;
    
    struct memblock mem_164957;
    
    mem_164957.references = NULL;
    
    struct memblock mem_164956;
    
    mem_164956.references = NULL;
    
    struct memblock mem_164970;
    
    mem_164970.references = NULL;
    
    struct memblock ext_mem_164973;
    
    ext_mem_164973.references = NULL;
    
    struct memblock ext_mem_164976;
    
    ext_mem_164976.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165695;
    int64_t bytes_164931 = (int64_t) 8 * dz2080U_141598;
    int64_t i32_res_145624 = sext_i32_i64(radix_sizze_141600);
    bool nonnegative_145625 = sle64((int64_t) 0, i32_res_145624);
    bool nonzzero_cert_145626;
    
    if (!nonnegative_145625) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftRelational.fut:306:78-83\n   #1  ftRelational.fut:281:1-308:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627 = shl64((int64_t) 1, i32_res_145624);
    int64_t bytes_164933 = (int64_t) 8 * b_141597;
    int32_t getRadix_arg1_156631 = sub32(radix_sizze_141600, 1);
    int32_t i64_res_156632 = sext_i64_i32(b_141597);
    int32_t zm_lhs_156633 = mul32(8, i64_res_156632);
    int32_t min_arg1_156634 = sub32(zm_lhs_156633, 1);
    int32_t min_res_156635 = smin32(getRadix_arg1_156631, min_arg1_156634);
    int32_t i32_arg0_156639 = sub32(i64_res_156632, 1);
    int64_t i32_res_156640 = sext_i32_i64(i32_arg0_156639);
    int32_t zm_rhs_156642 = sdiv32(min_res_156635, 8);
    int32_t zm_lhs_156643 = sub32(i64_res_156632, zm_rhs_156642);
    int32_t i32_arg0_156644 = sub32(zm_lhs_156643, 1);
    int64_t i32_res_156645 = sext_i32_i64(i32_arg0_156644);
    int64_t min_arg1_156647 = sub64(bytes_164933, (int64_t) 1);
    int64_t min_res_156648 = smin64(i32_res_156645, min_arg1_156647);
    bool x_156665 = sle64((int64_t) 0, i32_res_156640);
    bool y_156666 = slt64(i32_res_156640, b_141597);
    bool bounds_check_156667 = x_156665 && y_156666;
    bool index_certs_156668;
    
    if (!bounds_check_156667) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_156640, "] out of bounds for array of shape [", (long long) b_141597, "].", "-> #0  ftHashJoin.fut:31:48-64\n   #1  ftRelational.fut:281:1-308:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_156676 = sle64((int64_t) 0, min_res_156648);
    bool y_156677 = slt64(min_res_156648, b_141597);
    bool bounds_check_156678 = x_156676 && y_156677;
    bool index_certs_156679;
    
    if (!bounds_check_156678) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_156648, "] out of bounds for array of shape [", (long long) b_141597, "].", "-> #0  ftHashJoin.fut:32:38-54\n   #1  ftRelational.fut:281:1-308:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164993 = (int64_t) 8 * dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165696 = 0; i_165696 < dz2080U_141598; i_165696++) {
        int64_t x_165697 = (int64_t) 0 + i_165696 * (int64_t) 1;
        
        ((int64_t *) mem_164932.mem)[i_165696] = x_165697;
    }
    if (mem_164934_cached_sizze_165974 < bytes_164933) {
        err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_165974, bytes_164933);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < b_141597; i_164713++) {
        int64_t zm_lhs_156629 = sub64(b_141597, i_164713);
        int64_t lifted_lambda_res_156630 = sub64(zm_lhs_156629, (int64_t) 1);
        
        ((int64_t *) mem_164934)[i_164713] = lifted_lambda_res_156630;
    }
    
    int32_t lastBit_156650 = smod32(min_res_156635, 8);
    int32_t zm_lhs_156653 = sub32(8, lastBit_156650);
    int32_t i32_arg0_156654 = sub32(zm_lhs_156653, 1);
    int8_t unsign_arg0_156655 = zext_i32_i8(i32_arg0_156654);
    int8_t unsign_arg0_156656 = lshr8((int8_t) -1, unsign_arg0_156655);
    
    if (mem_164942_cached_sizze_165975 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_165975, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164946_cached_sizze_165976 < b_141597) {
        err = lexical_realloc(ctx, &mem_164946, &mem_164946_cached_sizze_165976, b_141597);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164723 = 0; i_164723 < dz2080U_141598; i_164723++) {
        int64_t radix_to_idx_arg1_145635 = ((int64_t *) bounds_mem_164929.mem)[i_164723];
        bool x_145636 = sle64((int64_t) 0, radix_to_idx_arg1_145635);
        bool y_145637 = slt64(radix_to_idx_arg1_145635, n_141596);
        bool bounds_check_145638 = x_145636 && y_145637;
        bool index_certs_145639;
        
        if (!bounds_check_145638) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_arg1_145635, "] out of bounds for array of shape [", (long long) n_141596, "].", "-> #0  ftRelational.fut:291:46-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:281:1-308:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < b_141597; i_164717++) {
            int8_t eta_p_156660 = ((int8_t *) pXs_mem_164928.mem)[radix_to_idx_arg1_145635 * b_141597 + i_164717];
            bool cond_156661 = sle64(i_164717, i32_res_156640);
            bool cond_t_res_156662 = sle64(min_res_156648, i_164717);
            bool x_156663 = cond_156661 && cond_t_res_156662;
            int8_t lifted_lambda_res_156664;
            
            if (x_156663) {
                lifted_lambda_res_156664 = eta_p_156660;
            } else {
                lifted_lambda_res_156664 = (int8_t) 0;
            }
            ((int8_t *) mem_164946)[i_164717] = lifted_lambda_res_156664;
        }
        
        int8_t za_lhs_156669 = ((int8_t *) mem_164946)[i32_res_156640];
        int8_t mod1_x_156670 = (int8_t) -1 & za_lhs_156669;
        
        ((int8_t *) mem_164946)[i32_res_156640] = mod1_x_156670;
        
        int8_t za_lhs_156680 = ((int8_t *) mem_164946)[min_res_156648];
        int8_t tmp_156681 = unsign_arg0_156656 & za_lhs_156680;
        
        ((int8_t *) mem_164946)[min_res_156648] = tmp_156681;
        
        int64_t defunc_res_157049;
        int64_t redout_164719 = (int64_t) 0;
        
        for (int64_t i_164720 = 0; i_164720 < b_141597; i_164720++) {
            int64_t eta_p_157023 = ((int64_t *) mem_164934)[i_164720];
            int64_t ztzt_rhs_157025 = mul64((int64_t) 8, eta_p_157023);
            bool nonnegative_157026 = sle64((int64_t) 0, ztzt_rhs_157025);
            bool nonzzero_cert_157027;
            
            if (!nonnegative_157026) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:37:39-68\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  ftRelational.fut:281:1-308:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t eta_p_157022 = ((int8_t *) mem_164946)[i_164720];
            int64_t u8_res_157024 = zext_i8_i64(eta_p_157022);
            int64_t zt_rhs_157028 = shl64((int64_t) 1, ztzt_rhs_157025);
            int64_t lifted_lambda_res_157029 = mul64(u8_res_157024, zt_rhs_157028);
            int64_t zp_res_156700 = add64(lifted_lambda_res_157029, redout_164719);
            int64_t redout_tmp_165701 = zp_res_156700;
            
            redout_164719 = redout_tmp_165701;
        }
        defunc_res_157049 = redout_164719;
        ((int64_t *) mem_164942)[i_164723] = defunc_res_157049;
    }
    
    bool cond_145645 = maxDepth_141604 == 1;
    
    if (cond_145645) {
        if (memblock_alloc(ctx, &mem_164970, dz2080U_141598, "mem_164970")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_165702 = 0; nest_i_165702 < dz2080U_141598; nest_i_165702++) {
            ((bool *) mem_164970.mem)[nest_i_165702] = 1;
        }
        if (memblock_set(ctx, &ext_mem_164976, &mem_164970, "mem_164970") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_164973, &mem_164970, "mem_164970") != 0)
            return 1;
    } else {
        int64_t zeze_rhs_145649 = sub64(dz2080U_141598, (int64_t) 1);
        
        if (memblock_alloc(ctx, &mem_164956, dz2080U_141598, "mem_164956")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164957, dz2080U_141598, "mem_164957")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164729 = 0; i_164729 < dz2080U_141598; i_164729++) {
            int64_t cur_i_145657 = ((int64_t *) mem_164942)[i_164729];
            bool cond_145658 = i_164729 == (int64_t) 0;
            int64_t pre_i_145659;
            
            if (cond_145658) {
                pre_i_145659 = (int64_t) -1;
            } else {
                int64_t tmp_145660 = sub64(i_164729, (int64_t) 1);
                bool x_145661 = sle64((int64_t) 0, tmp_145660);
                bool y_145662 = slt64(tmp_145660, dz2080U_141598);
                bool bounds_check_145663 = x_145661 && y_145662;
                bool index_certs_145664;
                
                if (!bounds_check_145663) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_145660, "] out of bounds for array of shape [", (long long) dz2080U_141598, "].", "-> #0  ftRelational.fut:298:42-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:296:10-303:8\n   #3  ftRelational.fut:281:1-308:86\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pre_i_f_res_145665 = ((int64_t *) mem_164942)[tmp_145660];
                
                pre_i_145659 = pre_i_f_res_145665;
            }
            
            bool is_first_145666 = cur_i_145657 == pre_i_145659;
            bool is_first_145667 = !is_first_145666;
            bool cond_145668 = i_164729 == zeze_rhs_145649;
            int64_t pos_i_145669;
            
            if (cond_145668) {
                pos_i_145669 = (int64_t) -1;
            } else {
                int64_t tmp_145670 = add64((int64_t) 1, i_164729);
                bool x_145671 = sle64((int64_t) 0, tmp_145670);
                bool y_145672 = slt64(tmp_145670, dz2080U_141598);
                bool bounds_check_145673 = x_145671 && y_145672;
                bool index_certs_145674;
                
                if (!bounds_check_145673) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_145670, "] out of bounds for array of shape [", (long long) dz2080U_141598, "].", "-> #0  ftRelational.fut:300:46-78\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:296:10-303:8\n   #3  ftRelational.fut:281:1-308:86\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pos_i_f_res_145675 = ((int64_t *) mem_164942)[tmp_145670];
                
                pos_i_145669 = pos_i_f_res_145675;
            }
            
            bool is_last_145676 = cur_i_145657 == pos_i_145669;
            bool is_last_145677 = !is_last_145676;
            
            ((bool *) mem_164956.mem)[i_164729] = is_first_145667;
            ((bool *) mem_164957.mem)[i_164729] = is_last_145677;
        }
        if (memblock_set(ctx, &ext_mem_164976, &mem_164956, "mem_164956") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_164973, &mem_164957, "mem_164957") != 0)
            return 1;
    }
    if (mem_164978_cached_sizze_165977 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_164978, &mem_164978_cached_sizze_165977, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164980_cached_sizze_165978 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_164980, &mem_164980_cached_sizze_165978, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164736 = 0; i_164736 < dz2080U_141598; i_164736++) {
        bool eta_p_157004 = ((bool *) ext_mem_164976.mem)[i_164736];
        bool eta_p_157006 = ((bool *) ext_mem_164973.mem)[i_164736];
        int64_t lifted_lambda_res_157008;
        
        if (eta_p_157004) {
            int64_t lifted_lambda_res_t_res_157057 = ((int64_t *) mem_164942)[i_164736];
            
            lifted_lambda_res_157008 = lifted_lambda_res_t_res_157057;
        } else {
            lifted_lambda_res_157008 = (int64_t) -1;
        }
        
        int64_t lifted_lambda_res_157015;
        
        if (eta_p_157006) {
            int64_t lifted_lambda_res_t_res_157062 = ((int64_t *) mem_164942)[i_164736];
            
            lifted_lambda_res_157015 = lifted_lambda_res_t_res_157062;
        } else {
            lifted_lambda_res_157015 = (int64_t) -1;
        }
        ((int64_t *) mem_164978)[i_164736] = lifted_lambda_res_157015;
        ((int64_t *) mem_164980)[i_164736] = lifted_lambda_res_157008;
    }
    if (memblock_unref(ctx, &ext_mem_164973, "ext_mem_164973") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164976, "ext_mem_164976") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164994, bytes_164993, "mem_164994")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165707 = 0; nest_i_165707 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627; nest_i_165707++) {
        ((int64_t *) mem_164994.mem)[nest_i_165707] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_164996, bytes_164931, "mem_164996")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164996.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164980, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2080U_141598});
    if (futrts_partitioned_scatter_13032(ctx, &ext_mem_164998, mem_164994, mem_164996, mem_164932, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627, dz2080U_141598, scatter_psizze_141605) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_164994, "mem_164994") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164996, "mem_164996") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165000, bytes_164993, "mem_165000")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165708 = 0; nest_i_165708 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627; nest_i_165708++) {
        ((int64_t *) mem_165000.mem)[nest_i_165708] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_165002, bytes_164931, "mem_165002")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164978, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2080U_141598});
    if (futrts_partitioned_scatter_13032(ctx, &ext_mem_165004, mem_165000, mem_165002, mem_164932, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627, dz2080U_141598, scatter_psizze_141605) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &ext_mem_164998, "ext_mem_164998") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &ext_mem_165004, "ext_mem_165004") != 0)
        return 1;
    prim_out_165695 = dzlz7bUZLztztZRz20U2z20Ursz7dUzg_145627;
    if (memblock_set(ctx, &*mem_out_p_165971, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165972, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    *out_prim_out_165973 = prim_out_165695;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164942);
        free(mem_164946);
        free(mem_164978);
        free(mem_164980);
        if (memblock_unref(ctx, &ext_mem_165004, "ext_mem_165004") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164998, "ext_mem_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164996, "mem_164996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164994, "mem_164994") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164957, "mem_164957") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164956, "mem_164956") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164970, "mem_164970") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164973, "ext_mem_164973") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164976, "ext_mem_164976") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_165979, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_77908, int64_t dz2083U_77909, int64_t incr_77910, int64_t psizze_77911, int64_t pL_bytes_77913)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164973;
    
    mem_164973.references = NULL;
    
    struct memblock mem_param_tmp_165698;
    
    mem_param_tmp_165698.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock mem_164950;
    
    mem_164950.references = NULL;
    
    struct memblock mem_164948;
    
    mem_164948.references = NULL;
    
    struct memblock mem_param_164946;
    
    mem_param_164946.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164970;
    
    ext_mem_164970.references = NULL;
    
    struct memblock ext_mem_164971;
    
    ext_mem_164971.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * niz2084U_77908;
    bool zzero_145876 = psizze_77911 == (int64_t) 0;
    bool nonzzero_145877 = !zzero_145876;
    bool nonzzero_cert_145878;
    
    if (!nonzzero_145877) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:52:1-53:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = niz2084U_77908 * pL_bytes_77913;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < niz2084U_77908; i_164713++) {
        int64_t eta_p_145872 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145873 = sub64(eta_p_145872, incr_77910);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145873;
    }
    
    int64_t zm_lhs_145874 = add64(dz2083U_77909, psizze_77911);
    int64_t zs_lhs_145875 = sub64(zm_lhs_145874, (int64_t) 1);
    int64_t m_145879 = sdiv64(zs_lhs_145875, psizze_77911);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < niz2084U_77908; nest_i_165695++) {
        for (int64_t nest_i_165696 = 0; nest_i_165696 < pL_bytes_77913; nest_i_165696++) {
            ((int8_t *) mem_164939.mem)[nest_i_165695 * pL_bytes_77913 + nest_i_165696] = (int8_t) 0;
        }
    }
    
    bool loop_cond_145881 = slt64((int64_t) 0, m_145879);
    bool partitioned_gather_res_145882;
    int64_t partitioned_gather_res_145885;
    bool loop_while_145886;
    int64_t p_145889;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164946, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145886 = loop_cond_145881;
    p_145889 = (int64_t) 0;
    while (loop_while_145886) {
        int64_t lower_bound_145890 = mul64(psizze_77911, p_145889);
        int64_t min_arg1_145891 = add64(psizze_77911, lower_bound_145890);
        int64_t min_res_145892 = smin64(dz2083U_77909, min_arg1_145891);
        int64_t j_m_i_145893 = sub64(min_res_145892, lower_bound_145890);
        bool empty_slice_145894 = j_m_i_145893 == (int64_t) 0;
        int64_t m_145895 = sub64(j_m_i_145893, (int64_t) 1);
        int64_t i_p_m_t_s_145896 = add64(lower_bound_145890, m_145895);
        bool zzero_leq_i_p_m_t_s_145897 = sle64((int64_t) 0, i_p_m_t_s_145896);
        bool i_p_m_t_s_leq_w_145898 = slt64(i_p_m_t_s_145896, dz2083U_77909);
        bool zzero_lte_i_145899 = sle64((int64_t) 0, lower_bound_145890);
        bool i_lte_j_145900 = sle64(lower_bound_145890, min_res_145892);
        bool y_145901 = i_p_m_t_s_leq_w_145898 && zzero_lte_i_145899;
        bool y_145902 = zzero_leq_i_p_m_t_s_145897 && y_145901;
        bool forwards_ok_145903 = i_lte_j_145900 && y_145902;
        bool ok_or_empty_145904 = empty_slice_145894 || forwards_ok_145903;
        bool index_certs_145905;
        
        if (!ok_or_empty_145904) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145890, ":", (long long) min_res_145892, "] out of bounds for array of shape [", (long long) dz2083U_77909, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:52:1-53:69\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164948, bytes_164930, "mem_164948")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164948.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_77908});
        if (memblock_alloc(ctx, &mem_164950, bytes_164938, "mem_164950")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < niz2084U_77908; i_164717++) {
            int64_t eta_p_145908 = ((int64_t *) mem_param_164942.mem)[i_164717];
            bool cond_145910 = sle64(lower_bound_145890, eta_p_145908);
            bool cond_t_res_145911 = slt64(eta_p_145908, min_res_145892);
            bool x_145912 = cond_145910 && cond_t_res_145911;
            int64_t binop_y_164955 = pL_bytes_77913 * i_164717;
            int64_t lmad_ext_164957 = pL_bytes_77913 * eta_p_145908;
            int64_t ext_164959;
            
            if (x_145912) {
                ext_164959 = lmad_ext_164957;
            } else {
                ext_164959 = binop_y_164955;
            }
            if (x_145912) {
                int64_t tmp_157003 = sub64(eta_p_145908, lower_bound_145890);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145893);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145893, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:52:1-53:69\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_set(ctx, &ext_mem_164960, &ys_mem_164929, "ys_mem_164929") != 0)
                    return 1;
            } else if (memblock_set(ctx, &ext_mem_164960, &mem_param_164946, "mem_param_164946") != 0)
                return 1;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_164950.mem, i_164717 * pL_bytes_77913, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_164960.mem, ext_164959, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_bytes_77913});
            if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
                return 1;
        }
        
        int64_t tmp_145920 = add64((int64_t) 1, p_145889);
        bool loop_cond_145921 = slt64(tmp_145920, m_145879);
        
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165698, &mem_164950, "mem_164950") != 0)
            return 1;
        
        bool loop_while_tmp_165699 = loop_cond_145921;
        int64_t p_tmp_165702 = tmp_145920;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164946, &mem_param_tmp_165698, "mem_param_tmp_165698") != 0)
            return 1;
        loop_while_145886 = loop_while_tmp_165699;
        p_145889 = p_tmp_165702;
    }
    if (memblock_set(ctx, &ext_mem_164971, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164970, &mem_param_164946, "mem_param_164946") != 0)
        return 1;
    partitioned_gather_res_145882 = loop_while_145886;
    partitioned_gather_res_145885 = p_145889;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164973, bytes_164938, "mem_164973")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_164973.mem, (int64_t) 0, (int64_t []) {pL_bytes_77913, (int64_t) 1}, (uint8_t *) ext_mem_164970.mem, (int64_t) 0, (int64_t []) {pL_bytes_77913, (int64_t) 1}, (int64_t []) {niz2084U_77908, pL_bytes_77913});
    if (memblock_unref(ctx, &ext_mem_164970, "ext_mem_164970") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164973, "mem_164973") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165979, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164973, "mem_164973") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165698, "mem_param_tmp_165698") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164950, "mem_164950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164946, "mem_param_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164970, "ext_mem_164970") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164971, "ext_mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_165980, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_77444, int64_t dz2083U_77445, int64_t incr_77446, int64_t psizze_77447)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * niz2084U_77444;
    bool zzero_145874 = psizze_77447 == (int64_t) 0;
    bool nonzzero_145875 = !zzero_145874;
    bool nonzzero_cert_145876;
    
    if (!nonzzero_145875) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:50:5-41\n   #2  ftRelational.fut:49:1-50:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < niz2084U_77444; i_164713++) {
        int64_t eta_p_145870 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145871 = sub64(eta_p_145870, incr_77446);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145871;
    }
    
    int64_t zm_lhs_145872 = add64(dz2083U_77445, psizze_77447);
    int64_t zs_lhs_145873 = sub64(zm_lhs_145872, (int64_t) 1);
    int64_t m_145877 = sdiv64(zs_lhs_145873, psizze_77447);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164930, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < niz2084U_77444; nest_i_165695++) {
        ((double *) mem_164939.mem)[nest_i_165695] = 0.0;
    }
    
    bool loop_cond_145879 = slt64((int64_t) 0, m_145877);
    bool partitioned_gather_res_145880;
    int64_t partitioned_gather_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_77447, p_145887);
        int64_t min_arg1_145889 = add64(psizze_77447, lower_bound_145888);
        int64_t min_res_145890 = smin64(dz2083U_77445, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, dz2083U_77445);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) dz2083U_77445, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:50:5-41\n   #2  ftRelational.fut:49:1-50:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_77444});
        if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < niz2084U_77444; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164942.mem)[i_164717];
            double eta_p_145907 = ((double *) mem_param_164945.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            double lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:50:5-41\n   #4  ftRelational.fut:49:1-50:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double tmp_157008 = ((double *) ys_mem_164929.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((double *) mem_164949.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145877);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145919;
        int64_t p_tmp_165701 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165698;
        p_145887 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145880 = loop_while_145884;
    partitioned_gather_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164930, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_77444});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165980, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165981, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_79416, int64_t n_79417, int64_t incr_79418, int64_t psizze_79419)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_param_tmp_165695;
    
    mem_param_tmp_165695.references = NULL;
    
    struct memblock mem_164948;
    
    mem_164948.references = NULL;
    
    struct memblock mem_164946;
    
    mem_164946.references = NULL;
    
    struct memblock mem_param_164944;
    
    mem_param_164944.references = NULL;
    
    struct memblock mem_param_164941;
    
    mem_param_164941.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164931 = (int64_t) 8 * ni_79416;
    bool zzero_145875 = psizze_79419 == (int64_t) 0;
    bool nonzzero_145876 = !zzero_145875;
    bool nonzzero_cert_145877;
    
    if (!nonzzero_145876) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:64:5-50\n   #2  ftRelational.fut:63:1-64:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < ni_79416; i_164713++) {
        int64_t eta_p_145871 = ((int64_t *) is_mem_164929.mem)[i_164713];
        int64_t lifted_lambda_res_145872 = sub64(eta_p_145871, incr_79418);
        
        ((int64_t *) mem_164932.mem)[i_164713] = lifted_lambda_res_145872;
    }
    
    int64_t zm_lhs_145873 = add64(n_79417, psizze_79419);
    int64_t zs_lhs_145874 = sub64(zm_lhs_145873, (int64_t) 1);
    int64_t m_145878 = sdiv64(zs_lhs_145874, psizze_79419);
    bool loop_cond_145879 = slt64((int64_t) 0, m_145878);
    bool partitioned_gather_over_array_res_145880;
    int64_t partitioned_gather_over_array_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164941, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164944, &preVals_mem_164928, "preVals_mem_164928") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_79419, p_145887);
        int64_t min_arg1_145889 = add64(psizze_79419, lower_bound_145888);
        int64_t min_res_145890 = smin64(n_79417, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, n_79417);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) n_79417, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:64:5-50\n   #2  ftRelational.fut:63:1-64:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164946, bytes_164931, "mem_164946")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164946.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_79416});
        if (memblock_alloc(ctx, &mem_164948, bytes_164931, "mem_164948")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < ni_79416; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164941.mem)[i_164717];
            double eta_p_145907 = ((double *) mem_param_164944.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            double lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:64:5-50\n   #4  ftRelational.fut:63:1-64:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double tmp_157008 = ((double *) ys_mem_164930.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((double *) mem_164948.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145878);
        
        if (memblock_set(ctx, &mem_param_tmp_165695, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164948, "mem_164948") != 0)
            return 1;
        
        bool loop_while_tmp_165697 = loop_cond_145919;
        int64_t p_tmp_165700 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164941, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164944, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165697;
        p_145887 = p_tmp_165700;
    }
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164941, "mem_param_164941") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164959, &mem_param_164944, "mem_param_164944") != 0)
        return 1;
    partitioned_gather_over_array_res_145880 = loop_while_145884;
    partitioned_gather_over_array_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164962, bytes_164931, "mem_164962")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164959.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_79416});
    if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164962, "mem_164962") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165981, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164944, "mem_param_164944") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164941, "mem_param_164941") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_165982, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_77164, int64_t dz2083U_77165, int64_t incr_77166, int64_t psizze_77167)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * niz2084U_77164;
    bool zzero_145874 = psizze_77167 == (int64_t) 0;
    bool nonzzero_145875 = !zzero_145874;
    bool nonzzero_cert_145876;
    
    if (!nonzzero_145875) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:48:5-41\n   #2  ftRelational.fut:47:1-48:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = (int64_t) 4 * niz2084U_77164;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < niz2084U_77164; i_164713++) {
        int64_t eta_p_145870 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145871 = sub64(eta_p_145870, incr_77166);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145871;
    }
    
    int64_t zm_lhs_145872 = add64(dz2083U_77165, psizze_77167);
    int64_t zs_lhs_145873 = sub64(zm_lhs_145872, (int64_t) 1);
    int64_t m_145877 = sdiv64(zs_lhs_145873, psizze_77167);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < niz2084U_77164; nest_i_165695++) {
        ((float *) mem_164939.mem)[nest_i_165695] = 0.0F;
    }
    
    bool loop_cond_145879 = slt64((int64_t) 0, m_145877);
    bool partitioned_gather_res_145880;
    int64_t partitioned_gather_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_77167, p_145887);
        int64_t min_arg1_145889 = add64(psizze_77167, lower_bound_145888);
        int64_t min_res_145890 = smin64(dz2083U_77165, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, dz2083U_77165);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) dz2083U_77165, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:48:5-41\n   #2  ftRelational.fut:47:1-48:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_77164});
        if (memblock_alloc(ctx, &mem_164949, bytes_164938, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < niz2084U_77164; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164942.mem)[i_164717];
            float eta_p_145907 = ((float *) mem_param_164945.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            float lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:48:5-41\n   #4  ftRelational.fut:47:1-48:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float tmp_157008 = ((float *) ys_mem_164929.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((float *) mem_164949.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145877);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145919;
        int64_t p_tmp_165701 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165698;
        p_145887 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145880 = loop_while_145884;
    partitioned_gather_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164938, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_77164});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165982, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165983, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_79115, int64_t n_79116, int64_t incr_79117, int64_t psizze_79118)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_param_tmp_165695;
    
    mem_param_tmp_165695.references = NULL;
    
    struct memblock mem_164948;
    
    mem_164948.references = NULL;
    
    struct memblock mem_164946;
    
    mem_164946.references = NULL;
    
    struct memblock mem_param_164944;
    
    mem_param_164944.references = NULL;
    
    struct memblock mem_param_164941;
    
    mem_param_164941.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164931 = (int64_t) 8 * ni_79115;
    bool zzero_145875 = psizze_79118 == (int64_t) 0;
    bool nonzzero_145876 = !zzero_145875;
    bool nonzzero_cert_145877;
    
    if (!nonzzero_145876) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:62:5-50\n   #2  ftRelational.fut:61:1-62:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164961 = (int64_t) 4 * ni_79115;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < ni_79115; i_164713++) {
        int64_t eta_p_145871 = ((int64_t *) is_mem_164929.mem)[i_164713];
        int64_t lifted_lambda_res_145872 = sub64(eta_p_145871, incr_79117);
        
        ((int64_t *) mem_164932.mem)[i_164713] = lifted_lambda_res_145872;
    }
    
    int64_t zm_lhs_145873 = add64(n_79116, psizze_79118);
    int64_t zs_lhs_145874 = sub64(zm_lhs_145873, (int64_t) 1);
    int64_t m_145878 = sdiv64(zs_lhs_145874, psizze_79118);
    bool loop_cond_145879 = slt64((int64_t) 0, m_145878);
    bool partitioned_gather_over_array_res_145880;
    int64_t partitioned_gather_over_array_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164941, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164944, &preVals_mem_164928, "preVals_mem_164928") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_79118, p_145887);
        int64_t min_arg1_145889 = add64(psizze_79118, lower_bound_145888);
        int64_t min_res_145890 = smin64(n_79116, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, n_79116);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) n_79116, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:62:5-50\n   #2  ftRelational.fut:61:1-62:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164946, bytes_164931, "mem_164946")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164946.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_79115});
        if (memblock_alloc(ctx, &mem_164948, bytes_164961, "mem_164948")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < ni_79115; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164941.mem)[i_164717];
            float eta_p_145907 = ((float *) mem_param_164944.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            float lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:62:5-50\n   #4  ftRelational.fut:61:1-62:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float tmp_157008 = ((float *) ys_mem_164930.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((float *) mem_164948.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145878);
        
        if (memblock_set(ctx, &mem_param_tmp_165695, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164948, "mem_164948") != 0)
            return 1;
        
        bool loop_while_tmp_165697 = loop_cond_145919;
        int64_t p_tmp_165700 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164941, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164944, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165697;
        p_145887 = p_tmp_165700;
    }
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164941, "mem_param_164941") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164959, &mem_param_164944, "mem_param_164944") != 0)
        return 1;
    partitioned_gather_over_array_res_145880 = loop_while_145884;
    partitioned_gather_over_array_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164962, bytes_164961, "mem_164962")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164959.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_79115});
    if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164962, "mem_164962") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165983, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164944, "mem_param_164944") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164941, "mem_param_164941") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_165984, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_76604, int64_t dz2083U_76605, int64_t incr_76606, int64_t psizze_76607)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * niz2084U_76604;
    bool zzero_145874 = psizze_76607 == (int64_t) 0;
    bool nonzzero_145875 = !zzero_145874;
    bool nonzzero_cert_145876;
    
    if (!nonzzero_145875) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:44:5-41\n   #2  ftRelational.fut:43:1-44:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = (int64_t) 4 * niz2084U_76604;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < niz2084U_76604; i_164713++) {
        int64_t eta_p_145870 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145871 = sub64(eta_p_145870, incr_76606);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145871;
    }
    
    int64_t zm_lhs_145872 = add64(dz2083U_76605, psizze_76607);
    int64_t zs_lhs_145873 = sub64(zm_lhs_145872, (int64_t) 1);
    int64_t m_145877 = sdiv64(zs_lhs_145873, psizze_76607);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < niz2084U_76604; nest_i_165695++) {
        ((int32_t *) mem_164939.mem)[nest_i_165695] = 0;
    }
    
    bool loop_cond_145879 = slt64((int64_t) 0, m_145877);
    bool partitioned_gather_res_145880;
    int64_t partitioned_gather_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_76607, p_145887);
        int64_t min_arg1_145889 = add64(psizze_76607, lower_bound_145888);
        int64_t min_res_145890 = smin64(dz2083U_76605, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, dz2083U_76605);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) dz2083U_76605, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:44:5-41\n   #2  ftRelational.fut:43:1-44:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_76604});
        if (memblock_alloc(ctx, &mem_164949, bytes_164938, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < niz2084U_76604; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164942.mem)[i_164717];
            int32_t eta_p_145907 = ((int32_t *) mem_param_164945.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            int32_t lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:44:5-41\n   #4  ftRelational.fut:43:1-44:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t tmp_157008 = ((int32_t *) ys_mem_164929.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((int32_t *) mem_164949.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145877);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145919;
        int64_t p_tmp_165701 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165698;
        p_145887 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145880 = loop_while_145884;
    partitioned_gather_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164938, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_76604});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165984, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165985, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_78513, int64_t n_78514, int64_t incr_78515, int64_t psizze_78516)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_param_tmp_165695;
    
    mem_param_tmp_165695.references = NULL;
    
    struct memblock mem_164948;
    
    mem_164948.references = NULL;
    
    struct memblock mem_164946;
    
    mem_164946.references = NULL;
    
    struct memblock mem_param_164944;
    
    mem_param_164944.references = NULL;
    
    struct memblock mem_param_164941;
    
    mem_param_164941.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164931 = (int64_t) 8 * ni_78513;
    bool zzero_145875 = psizze_78516 == (int64_t) 0;
    bool nonzzero_145876 = !zzero_145875;
    bool nonzzero_cert_145877;
    
    if (!nonzzero_145876) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:58:5-50\n   #2  ftRelational.fut:57:1-58:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164961 = (int64_t) 4 * ni_78513;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < ni_78513; i_164713++) {
        int64_t eta_p_145871 = ((int64_t *) is_mem_164929.mem)[i_164713];
        int64_t lifted_lambda_res_145872 = sub64(eta_p_145871, incr_78515);
        
        ((int64_t *) mem_164932.mem)[i_164713] = lifted_lambda_res_145872;
    }
    
    int64_t zm_lhs_145873 = add64(n_78514, psizze_78516);
    int64_t zs_lhs_145874 = sub64(zm_lhs_145873, (int64_t) 1);
    int64_t m_145878 = sdiv64(zs_lhs_145874, psizze_78516);
    bool loop_cond_145879 = slt64((int64_t) 0, m_145878);
    bool partitioned_gather_over_array_res_145880;
    int64_t partitioned_gather_over_array_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164941, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164944, &preVals_mem_164928, "preVals_mem_164928") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_78516, p_145887);
        int64_t min_arg1_145889 = add64(psizze_78516, lower_bound_145888);
        int64_t min_res_145890 = smin64(n_78514, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, n_78514);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) n_78514, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:58:5-50\n   #2  ftRelational.fut:57:1-58:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164946, bytes_164931, "mem_164946")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164946.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_78513});
        if (memblock_alloc(ctx, &mem_164948, bytes_164961, "mem_164948")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < ni_78513; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164941.mem)[i_164717];
            int32_t eta_p_145907 = ((int32_t *) mem_param_164944.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            int32_t lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:58:5-50\n   #4  ftRelational.fut:57:1-58:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t tmp_157008 = ((int32_t *) ys_mem_164930.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((int32_t *) mem_164948.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145878);
        
        if (memblock_set(ctx, &mem_param_tmp_165695, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164948, "mem_164948") != 0)
            return 1;
        
        bool loop_while_tmp_165697 = loop_cond_145919;
        int64_t p_tmp_165700 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164941, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164944, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165697;
        p_145887 = p_tmp_165700;
    }
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164941, "mem_param_164941") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164959, &mem_param_164944, "mem_param_164944") != 0)
        return 1;
    partitioned_gather_over_array_res_145880 = loop_while_145884;
    partitioned_gather_over_array_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164962, bytes_164961, "mem_164962")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164959.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_78513});
    if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164962, "mem_164962") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165985, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164944, "mem_param_164944") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164941, "mem_param_164941") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_165986, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_76884, int64_t dz2083U_76885, int64_t incr_76886, int64_t psizze_76887)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * niz2084U_76884;
    bool zzero_145874 = psizze_76887 == (int64_t) 0;
    bool nonzzero_145875 = !zzero_145874;
    bool nonzzero_cert_145876;
    
    if (!nonzzero_145875) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:46:5-41\n   #2  ftRelational.fut:45:1-46:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < niz2084U_76884; i_164713++) {
        int64_t eta_p_145870 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145871 = sub64(eta_p_145870, incr_76886);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145871;
    }
    
    int64_t zm_lhs_145872 = add64(dz2083U_76885, psizze_76887);
    int64_t zs_lhs_145873 = sub64(zm_lhs_145872, (int64_t) 1);
    int64_t m_145877 = sdiv64(zs_lhs_145873, psizze_76887);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164930, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < niz2084U_76884; nest_i_165695++) {
        ((int64_t *) mem_164939.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    bool loop_cond_145879 = slt64((int64_t) 0, m_145877);
    bool partitioned_gather_res_145880;
    int64_t partitioned_gather_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_76887, p_145887);
        int64_t min_arg1_145889 = add64(psizze_76887, lower_bound_145888);
        int64_t min_res_145890 = smin64(dz2083U_76885, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, dz2083U_76885);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) dz2083U_76885, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:46:5-41\n   #2  ftRelational.fut:45:1-46:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_76884});
        if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < niz2084U_76884; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164942.mem)[i_164717];
            int64_t eta_p_145907 = ((int64_t *) mem_param_164945.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            int64_t lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:46:5-41\n   #4  ftRelational.fut:45:1-46:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_157008 = ((int64_t *) ys_mem_164929.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((int64_t *) mem_164949.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145877);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145919;
        int64_t p_tmp_165701 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165698;
        p_145887 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145880 = loop_while_145884;
    partitioned_gather_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164930, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_76884});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165986, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165987, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_78814, int64_t n_78815, int64_t incr_78816, int64_t psizze_78817)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_param_tmp_165695;
    
    mem_param_tmp_165695.references = NULL;
    
    struct memblock mem_164948;
    
    mem_164948.references = NULL;
    
    struct memblock mem_164946;
    
    mem_164946.references = NULL;
    
    struct memblock mem_param_164944;
    
    mem_param_164944.references = NULL;
    
    struct memblock mem_param_164941;
    
    mem_param_164941.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164931 = (int64_t) 8 * ni_78814;
    bool zzero_145875 = psizze_78817 == (int64_t) 0;
    bool nonzzero_145876 = !zzero_145875;
    bool nonzzero_cert_145877;
    
    if (!nonzzero_145876) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:60:5-50\n   #2  ftRelational.fut:59:1-60:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < ni_78814; i_164713++) {
        int64_t eta_p_145871 = ((int64_t *) is_mem_164929.mem)[i_164713];
        int64_t lifted_lambda_res_145872 = sub64(eta_p_145871, incr_78816);
        
        ((int64_t *) mem_164932.mem)[i_164713] = lifted_lambda_res_145872;
    }
    
    int64_t zm_lhs_145873 = add64(n_78815, psizze_78817);
    int64_t zs_lhs_145874 = sub64(zm_lhs_145873, (int64_t) 1);
    int64_t m_145878 = sdiv64(zs_lhs_145874, psizze_78817);
    bool loop_cond_145879 = slt64((int64_t) 0, m_145878);
    bool partitioned_gather_over_array_res_145880;
    int64_t partitioned_gather_over_array_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164941, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164944, &preVals_mem_164928, "preVals_mem_164928") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_78817, p_145887);
        int64_t min_arg1_145889 = add64(psizze_78817, lower_bound_145888);
        int64_t min_res_145890 = smin64(n_78815, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, n_78815);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) n_78815, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:60:5-50\n   #2  ftRelational.fut:59:1-60:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164946, bytes_164931, "mem_164946")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164946.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_78814});
        if (memblock_alloc(ctx, &mem_164948, bytes_164931, "mem_164948")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < ni_78814; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164941.mem)[i_164717];
            int64_t eta_p_145907 = ((int64_t *) mem_param_164944.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            int64_t lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:60:5-50\n   #4  ftRelational.fut:59:1-60:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_157008 = ((int64_t *) ys_mem_164930.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((int64_t *) mem_164948.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145878);
        
        if (memblock_set(ctx, &mem_param_tmp_165695, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164948, "mem_164948") != 0)
            return 1;
        
        bool loop_while_tmp_165697 = loop_cond_145919;
        int64_t p_tmp_165700 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164941, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164944, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165697;
        p_145887 = p_tmp_165700;
    }
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164941, "mem_param_164941") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164959, &mem_param_164944, "mem_param_164944") != 0)
        return 1;
    partitioned_gather_over_array_res_145880 = loop_while_145884;
    partitioned_gather_over_array_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164962, bytes_164931, "mem_164962")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164959.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_78814});
    if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164962, "mem_164962") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165987, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164944, "mem_param_164944") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164941, "mem_param_164941") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_165988, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t niz2084U_76324, int64_t dz2083U_76325, int64_t incr_76326, int64_t psizze_76327)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * niz2084U_76324;
    bool zzero_145874 = psizze_76327 == (int64_t) 0;
    bool nonzzero_145875 = !zzero_145874;
    bool nonzzero_cert_145876;
    
    if (!nonzzero_145875) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftRelational.fut:42:5-41\n   #2  ftRelational.fut:41:1-42:41\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = (int64_t) 2 * niz2084U_76324;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < niz2084U_76324; i_164713++) {
        int64_t eta_p_145870 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145871 = sub64(eta_p_145870, incr_76326);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145871;
    }
    
    int64_t zm_lhs_145872 = add64(dz2083U_76325, psizze_76327);
    int64_t zs_lhs_145873 = sub64(zm_lhs_145872, (int64_t) 1);
    int64_t m_145877 = sdiv64(zs_lhs_145873, psizze_76327);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < niz2084U_76324; nest_i_165695++) {
        ((int16_t *) mem_164939.mem)[nest_i_165695] = (int16_t) 0;
    }
    
    bool loop_cond_145879 = slt64((int64_t) 0, m_145877);
    bool partitioned_gather_res_145880;
    int64_t partitioned_gather_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_76327, p_145887);
        int64_t min_arg1_145889 = add64(psizze_76327, lower_bound_145888);
        int64_t min_res_145890 = smin64(dz2083U_76325, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, dz2083U_76325);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) dz2083U_76325, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftRelational.fut:42:5-41\n   #2  ftRelational.fut:41:1-42:41\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_76324});
        if (memblock_alloc(ctx, &mem_164949, bytes_164938, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < niz2084U_76324; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164942.mem)[i_164717];
            int16_t eta_p_145907 = ((int16_t *) mem_param_164945.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            int16_t lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftRelational.fut:42:5-41\n   #4  ftRelational.fut:41:1-42:41\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t tmp_157008 = ((int16_t *) ys_mem_164929.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((int16_t *) mem_164949.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145877);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145919;
        int64_t p_tmp_165701 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165698;
        p_145887 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145880 = loop_while_145884;
    partitioned_gather_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164938, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_76324});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165988, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_165989, struct memblock preVals_mem_164928, struct memblock is_mem_164929, struct memblock ys_mem_164930, int64_t ni_78212, int64_t n_78213, int64_t incr_78214, int64_t psizze_78215)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_param_tmp_165695;
    
    mem_param_tmp_165695.references = NULL;
    
    struct memblock mem_164948;
    
    mem_164948.references = NULL;
    
    struct memblock mem_164946;
    
    mem_164946.references = NULL;
    
    struct memblock mem_param_164944;
    
    mem_param_164944.references = NULL;
    
    struct memblock mem_param_164941;
    
    mem_param_164941.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164931 = (int64_t) 8 * ni_78212;
    bool zzero_145875 = psizze_78215 == (int64_t) 0;
    bool nonzzero_145876 = !zzero_145875;
    bool nonzzero_cert_145877;
    
    if (!nonzzero_145876) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:43:22-28\n   #1  ftRelational.fut:56:5-50\n   #2  ftRelational.fut:55:1-56:50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164961 = (int64_t) 2 * ni_78212;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < ni_78212; i_164713++) {
        int64_t eta_p_145871 = ((int64_t *) is_mem_164929.mem)[i_164713];
        int64_t lifted_lambda_res_145872 = sub64(eta_p_145871, incr_78214);
        
        ((int64_t *) mem_164932.mem)[i_164713] = lifted_lambda_res_145872;
    }
    
    int64_t zm_lhs_145873 = add64(n_78213, psizze_78215);
    int64_t zs_lhs_145874 = sub64(zm_lhs_145873, (int64_t) 1);
    int64_t m_145878 = sdiv64(zs_lhs_145874, psizze_78215);
    bool loop_cond_145879 = slt64((int64_t) 0, m_145878);
    bool partitioned_gather_over_array_res_145880;
    int64_t partitioned_gather_over_array_res_145883;
    bool loop_while_145884;
    int64_t p_145887;
    
    if (memblock_set(ctx, &mem_param_164941, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164944, &preVals_mem_164928, "preVals_mem_164928") != 0)
        return 1;
    loop_while_145884 = loop_cond_145879;
    p_145887 = (int64_t) 0;
    while (loop_while_145884) {
        int64_t lower_bound_145888 = mul64(psizze_78215, p_145887);
        int64_t min_arg1_145889 = add64(psizze_78215, lower_bound_145888);
        int64_t min_res_145890 = smin64(n_78213, min_arg1_145889);
        int64_t j_m_i_145891 = sub64(min_res_145890, lower_bound_145888);
        bool empty_slice_145892 = j_m_i_145891 == (int64_t) 0;
        int64_t m_145893 = sub64(j_m_i_145891, (int64_t) 1);
        int64_t i_p_m_t_s_145894 = add64(lower_bound_145888, m_145893);
        bool zzero_leq_i_p_m_t_s_145895 = sle64((int64_t) 0, i_p_m_t_s_145894);
        bool i_p_m_t_s_leq_w_145896 = slt64(i_p_m_t_s_145894, n_78213);
        bool zzero_lte_i_145897 = sle64((int64_t) 0, lower_bound_145888);
        bool i_lte_j_145898 = sle64(lower_bound_145888, min_res_145890);
        bool y_145899 = i_p_m_t_s_leq_w_145896 && zzero_lte_i_145897;
        bool y_145900 = zzero_leq_i_p_m_t_s_145895 && y_145899;
        bool forwards_ok_145901 = i_lte_j_145898 && y_145900;
        bool ok_or_empty_145902 = empty_slice_145892 || forwards_ok_145901;
        bool index_certs_145903;
        
        if (!ok_or_empty_145902) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145888, ":", (long long) min_res_145890, "] out of bounds for array of shape [", (long long) n_78213, "].", "-> #0  ftbasics.fut:49:18-45\n   #1  ftRelational.fut:56:5-50\n   #2  ftRelational.fut:55:1-56:50\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164946, bytes_164931, "mem_164946")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164946.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_78212});
        if (memblock_alloc(ctx, &mem_164948, bytes_164961, "mem_164948")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < ni_78212; i_164717++) {
            int64_t eta_p_145906 = ((int64_t *) mem_param_164941.mem)[i_164717];
            int16_t eta_p_145907 = ((int16_t *) mem_param_164944.mem)[i_164717];
            bool cond_145908 = sle64(lower_bound_145888, eta_p_145906);
            bool cond_t_res_145909 = slt64(eta_p_145906, min_res_145890);
            bool x_145910 = cond_145908 && cond_t_res_145909;
            int16_t lifted_lambda_res_145911;
            
            if (x_145910) {
                int64_t tmp_157003 = sub64(eta_p_145906, lower_bound_145888);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145891);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145891, "].", "-> #0  ftbasics.fut:52:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:50:30-54:6\n   #3  ftRelational.fut:56:5-50\n   #4  ftRelational.fut:55:1-56:50\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t tmp_157008 = ((int16_t *) ys_mem_164930.mem)[eta_p_145906];
                
                lifted_lambda_res_145911 = tmp_157008;
            } else {
                lifted_lambda_res_145911 = eta_p_145907;
            }
            ((int16_t *) mem_164948.mem)[i_164717] = lifted_lambda_res_145911;
        }
        
        int64_t tmp_145918 = add64((int64_t) 1, p_145887);
        bool loop_cond_145919 = slt64(tmp_145918, m_145878);
        
        if (memblock_set(ctx, &mem_param_tmp_165695, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164948, "mem_164948") != 0)
            return 1;
        
        bool loop_while_tmp_165697 = loop_cond_145919;
        int64_t p_tmp_165700 = tmp_145918;
        
        if (memblock_set(ctx, &mem_param_164941, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164944, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        loop_while_145884 = loop_while_tmp_165697;
        p_145887 = p_tmp_165700;
    }
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164941, "mem_param_164941") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164959, &mem_param_164944, "mem_param_164944") != 0)
        return 1;
    partitioned_gather_over_array_res_145880 = loop_while_145884;
    partitioned_gather_over_array_res_145883 = p_145887;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164962, bytes_164961, "mem_164962")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_164959.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_78212});
    if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164962, "mem_164962") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165989, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165695, "mem_param_tmp_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164948, "mem_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164946, "mem_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164944, "mem_param_164944") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164941, "mem_param_164941") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_165990, struct memblock *mem_out_p_165991, struct memblock *mem_out_p_165992, int64_t *out_prim_out_165993, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_136036, int64_t nS_136037, int64_t offset_R_136040, int64_t offset_S_136041, int64_t partitionsPerWindow_136042, int64_t numberOfWindows_136043, int64_t extParallelism_136044, int64_t scatter_psizze_136045)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164942_cached_sizze_165994 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164944_cached_sizze_165995 = 0;
    unsigned char *mem_164944 = NULL;
    int64_t mem_164985_cached_sizze_165996 = 0;
    unsigned char *mem_164985 = NULL;
    int64_t mem_164987_cached_sizze_165997 = 0;
    unsigned char *mem_164987 = NULL;
    int64_t mem_165027_cached_sizze_165998 = 0;
    unsigned char *mem_165027 = NULL;
    int64_t mem_165029_cached_sizze_165999 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165087_cached_sizze_166000 = 0;
    unsigned char *mem_165087 = NULL;
    int64_t mem_165095_cached_sizze_166001 = 0;
    unsigned char *mem_165095 = NULL;
    int64_t mem_165135_cached_sizze_166002 = 0;
    unsigned char *mem_165135 = NULL;
    int64_t mem_165137_cached_sizze_166003 = 0;
    unsigned char *mem_165137 = NULL;
    int64_t mem_165207_cached_sizze_166004 = 0;
    unsigned char *mem_165207 = NULL;
    int64_t mem_165209_cached_sizze_166005 = 0;
    unsigned char *mem_165209 = NULL;
    int64_t mem_165223_cached_sizze_166006 = 0;
    unsigned char *mem_165223 = NULL;
    int64_t mem_165225_cached_sizze_166007 = 0;
    unsigned char *mem_165225 = NULL;
    int64_t mem_165227_cached_sizze_166008 = 0;
    unsigned char *mem_165227 = NULL;
    int64_t mem_165229_cached_sizze_166009 = 0;
    unsigned char *mem_165229 = NULL;
    int64_t mem_165255_cached_sizze_166010 = 0;
    unsigned char *mem_165255 = NULL;
    int64_t mem_165257_cached_sizze_166011 = 0;
    unsigned char *mem_165257 = NULL;
    int64_t mem_165259_cached_sizze_166012 = 0;
    unsigned char *mem_165259 = NULL;
    int64_t mem_165279_cached_sizze_166013 = 0;
    unsigned char *mem_165279 = NULL;
    int64_t mem_165302_cached_sizze_166014 = 0;
    unsigned char *mem_165302 = NULL;
    int64_t mem_165304_cached_sizze_166015 = 0;
    unsigned char *mem_165304 = NULL;
    int64_t mem_165306_cached_sizze_166016 = 0;
    unsigned char *mem_165306 = NULL;
    int64_t mem_165335_cached_sizze_166017 = 0;
    unsigned char *mem_165335 = NULL;
    int64_t mem_165337_cached_sizze_166018 = 0;
    unsigned char *mem_165337 = NULL;
    int64_t mem_165360_cached_sizze_166019 = 0;
    unsigned char *mem_165360 = NULL;
    int64_t mem_165362_cached_sizze_166020 = 0;
    unsigned char *mem_165362 = NULL;
    int64_t mem_165364_cached_sizze_166021 = 0;
    unsigned char *mem_165364 = NULL;
    struct memblock mem_165391;
    
    mem_165391.references = NULL;
    
    struct memblock mem_165389;
    
    mem_165389.references = NULL;
    
    struct memblock mem_165387;
    
    mem_165387.references = NULL;
    
    struct memblock mem_param_tmp_165816;
    
    mem_param_tmp_165816.references = NULL;
    
    struct memblock mem_param_tmp_165815;
    
    mem_param_tmp_165815.references = NULL;
    
    struct memblock mem_param_tmp_165814;
    
    mem_param_tmp_165814.references = NULL;
    
    struct memblock mem_165376;
    
    mem_165376.references = NULL;
    
    struct memblock mem_165374;
    
    mem_165374.references = NULL;
    
    struct memblock mem_165372;
    
    mem_165372.references = NULL;
    
    struct memblock mem_param_165358;
    
    mem_param_165358.references = NULL;
    
    struct memblock mem_param_165355;
    
    mem_param_165355.references = NULL;
    
    struct memblock mem_param_165352;
    
    mem_param_165352.references = NULL;
    
    struct memblock ext_mem_165383;
    
    ext_mem_165383.references = NULL;
    
    struct memblock ext_mem_165384;
    
    ext_mem_165384.references = NULL;
    
    struct memblock ext_mem_165385;
    
    ext_mem_165385.references = NULL;
    
    struct memblock mem_165291;
    
    mem_165291.references = NULL;
    
    struct memblock mem_165289;
    
    mem_165289.references = NULL;
    
    struct memblock mem_165287;
    
    mem_165287.references = NULL;
    
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_165187;
    
    mem_165187.references = NULL;
    
    struct memblock mem_165179;
    
    mem_165179.references = NULL;
    
    struct memblock mem_param_tmp_165750;
    
    mem_param_tmp_165750.references = NULL;
    
    struct memblock mem_param_tmp_165749;
    
    mem_param_tmp_165749.references = NULL;
    
    struct memblock mem_165105;
    
    mem_165105.references = NULL;
    
    struct memblock mem_165103;
    
    mem_165103.references = NULL;
    
    struct memblock mem_param_tmp_165762;
    
    mem_param_tmp_165762.references = NULL;
    
    struct memblock mem_param_tmp_165761;
    
    mem_param_tmp_165761.references = NULL;
    
    struct memblock mem_165073;
    
    mem_165073.references = NULL;
    
    struct memblock mem_165065;
    
    mem_165065.references = NULL;
    
    struct memblock mem_param_tmp_165768;
    
    mem_param_tmp_165768.references = NULL;
    
    struct memblock mem_param_tmp_165767;
    
    mem_param_tmp_165767.references = NULL;
    
    struct memblock mem_165045;
    
    mem_165045.references = NULL;
    
    struct memblock mem_165043;
    
    mem_165043.references = NULL;
    
    struct memblock ext_mem_165025;
    
    ext_mem_165025.references = NULL;
    
    struct memblock mem_165023;
    
    mem_165023.references = NULL;
    
    struct memblock ext_mem_165048;
    
    ext_mem_165048.references = NULL;
    
    struct memblock ext_mem_165051;
    
    ext_mem_165051.references = NULL;
    
    struct memblock ext_mem_165054;
    
    ext_mem_165054.references = NULL;
    
    struct memblock ext_mem_165057;
    
    ext_mem_165057.references = NULL;
    
    struct memblock mem_param_165021;
    
    mem_param_165021.references = NULL;
    
    struct memblock mem_param_165018;
    
    mem_param_165018.references = NULL;
    
    struct memblock ext_mem_165062;
    
    ext_mem_165062.references = NULL;
    
    struct memblock ext_mem_165063;
    
    ext_mem_165063.references = NULL;
    
    struct memblock mem_param_165015;
    
    mem_param_165015.references = NULL;
    
    struct memblock mem_param_165012;
    
    mem_param_165012.references = NULL;
    
    struct memblock ext_mem_165084;
    
    ext_mem_165084.references = NULL;
    
    struct memblock ext_mem_165085;
    
    ext_mem_165085.references = NULL;
    
    struct memblock mem_165009;
    
    mem_165009.references = NULL;
    
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock ext_mem_165114;
    
    ext_mem_165114.references = NULL;
    
    struct memblock ext_mem_165117;
    
    ext_mem_165117.references = NULL;
    
    struct memblock mem_param_165005;
    
    mem_param_165005.references = NULL;
    
    struct memblock mem_param_165002;
    
    mem_param_165002.references = NULL;
    
    struct memblock ext_mem_165122;
    
    ext_mem_165122.references = NULL;
    
    struct memblock ext_mem_165123;
    
    ext_mem_165123.references = NULL;
    
    struct memblock mem_164969;
    
    mem_164969.references = NULL;
    
    struct memblock mem_164971;
    
    mem_164971.references = NULL;
    
    struct memblock ext_mem_164974;
    
    ext_mem_164974.references = NULL;
    
    struct memblock ext_mem_164977;
    
    ext_mem_164977.references = NULL;
    
    struct memblock mem_164954;
    
    mem_164954.references = NULL;
    
    struct memblock mem_164952;
    
    mem_164952.references = NULL;
    
    struct memblock mem_param_tmp_165706;
    
    mem_param_tmp_165706.references = NULL;
    
    struct memblock mem_param_tmp_165705;
    
    mem_param_tmp_165705.references = NULL;
    
    struct memblock mem_165153;
    
    mem_165153.references = NULL;
    
    struct memblock mem_165151;
    
    mem_165151.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165131;
    
    mem_165131.references = NULL;
    
    struct memblock ext_mem_165156;
    
    ext_mem_165156.references = NULL;
    
    struct memblock ext_mem_165159;
    
    ext_mem_165159.references = NULL;
    
    struct memblock ext_mem_165162;
    
    ext_mem_165162.references = NULL;
    
    struct memblock ext_mem_165165;
    
    ext_mem_165165.references = NULL;
    
    struct memblock mem_param_165129;
    
    mem_param_165129.references = NULL;
    
    struct memblock mem_param_165126;
    
    mem_param_165126.references = NULL;
    
    struct memblock ext_mem_165170;
    
    ext_mem_165170.references = NULL;
    
    struct memblock ext_mem_165171;
    
    ext_mem_165171.references = NULL;
    
    struct memblock ext_mem_165174;
    
    ext_mem_165174.references = NULL;
    
    struct memblock ext_mem_165177;
    
    ext_mem_165177.references = NULL;
    
    struct memblock ext_mem_165196;
    
    ext_mem_165196.references = NULL;
    
    struct memblock ext_mem_165199;
    
    ext_mem_165199.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock ext_mem_165204;
    
    ext_mem_165204.references = NULL;
    
    struct memblock ext_mem_165205;
    
    ext_mem_165205.references = NULL;
    
    struct memblock mem_164934;
    
    mem_164934.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock ext_mem_164930;
    
    ext_mem_164930.references = NULL;
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165696;
    int64_t zm_lhs_150399 = add64(nR_136036, nS_136037);
    int64_t zs_lhs_150400 = sub64(zm_lhs_150399, (int64_t) 1);
    bool zzero_150401 = nR_136036 == (int64_t) 0;
    bool nonzzero_150402 = !zzero_150401;
    bool nonzzero_cert_150403;
    
    if (!nonzzero_150402) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:379:26-29\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_150404 = sdiv64(zs_lhs_150400, nR_136036);
    
    if (futrts_indicesWithIncrement_12227(ctx, &ext_mem_164930, tR_mem_164928, nR_136036, offset_R_136040) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_164931 = (int64_t) 8 * nR_136036;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165697 = 0; nest_i_165697 < nR_136036; nest_i_165697++) {
        ((int64_t *) mem_164932.mem)[nest_i_165697] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_164934, bytes_164931, "mem_164934")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165698 = 0; nest_i_165698 < nR_136036; nest_i_165698++) {
        ((int64_t *) mem_164934.mem)[nest_i_165698] = (int64_t) 0;
    }
    
    bool loop_cond_150409 = slt64((int64_t) 0, numIter_150404);
    int64_t gt_rhs_150410 = sub64(nR_136036, (int64_t) 1);
    bool x_150411 = sle64((int64_t) 0, gt_rhs_150410);
    bool y_150412 = slt64(gt_rhs_150410, nR_136036);
    bool bounds_check_150413 = x_150411 && y_150412;
    bool loop_not_taken_150414 = !loop_cond_150409;
    bool protect_assert_disj_150415 = bounds_check_150413 || loop_not_taken_150414;
    bool index_certs_150416;
    
    if (!protect_assert_disj_150415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:386:25-33\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    double gt_rhs_150417;
    
    if (loop_cond_150409) {
        double x_157438 = ((double *) tR_mem_164928.mem)[gt_rhs_150410];
        
        gt_rhs_150417 = x_157438;
    } else {
        gt_rhs_150417 = 0.0;
    }
    
    bool defunc_0_mergeJoin_res_150419;
    int64_t defunc_0_mergeJoin_res_150420;
    bool loop_while_150423;
    int64_t p_150424;
    
    if (memblock_set(ctx, &mem_param_164937, &mem_164934, "mem_164934") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &mem_164932, "mem_164932") != 0)
        return 1;
    loop_while_150423 = loop_cond_150409;
    p_150424 = (int64_t) 0;
    while (loop_while_150423) {
        int64_t tS_start_150427 = mul64(nR_136036, p_150424);
        int64_t min_arg1_150428 = add64(nR_136036, tS_start_150427);
        int64_t min_res_150429 = smin64(nS_136037, min_arg1_150428);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 = sub64(min_res_150429, tS_start_150427);
        bool empty_slice_150431 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 == (int64_t) 0;
        int64_t m_150432 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, (int64_t) 1);
        int64_t i_p_m_t_s_150433 = add64(tS_start_150427, m_150432);
        bool zzero_leq_i_p_m_t_s_150434 = sle64((int64_t) 0, i_p_m_t_s_150433);
        bool i_p_m_t_s_leq_w_150435 = slt64(i_p_m_t_s_150433, nS_136037);
        bool zzero_lte_i_150436 = sle64((int64_t) 0, tS_start_150427);
        bool i_lte_j_150437 = sle64(tS_start_150427, min_res_150429);
        bool y_150438 = i_p_m_t_s_leq_w_150435 && zzero_lte_i_150436;
        bool y_150439 = zzero_leq_i_p_m_t_s_150434 && y_150438;
        bool forwards_ok_150440 = i_lte_j_150437 && y_150439;
        bool ok_or_empty_150441 = empty_slice_150431 || forwards_ok_150440;
        bool index_certs_150442;
        
        if (!ok_or_empty_150441) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_150427, ":", (long long) min_res_150429, "] out of bounds for array of shape [", (long long) nS_136037, "].", "-> #0  ftSMJ.fut:385:16-35\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_150444 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
        bool index_certs_150445;
        
        if (!y_150444) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:386:12-19\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double gt_lhs_150446 = ((double *) tS_mem_164929.mem)[tS_start_150427];
        bool defunc_0_gt_res_150447 = gt_rhs_150417 < gt_lhs_150446;
        int64_t loopres_150448;
        
        if (defunc_0_gt_res_150447) {
            if (memblock_set(ctx, &ext_mem_165199, &mem_param_164937, "mem_param_164937") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_param_164940, "mem_param_164940") != 0)
                return 1;
            loopres_150448 = numIter_150404;
        } else {
            bool cond_150451 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, nR_136036);
            bool dim_match_150565 = nR_136036 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            bool protect_assert_disj_165549 = cond_150451 || dim_match_150565;
            bool empty_or_match_cert_150566;
            
            if (!protect_assert_disj_165549) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "] cannot match shape of type `[", (long long) nR_136036, "]f64`.", "-> #0  ftSMJ.fut:394:18-31\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_150572 = slt64((int64_t) 0, numberOfWindows_136043);
            bool y_150575 = slt64((int64_t) 0, nR_136036);
            bool loop_not_taken_150576 = !loop_cond_150572;
            bool protect_assert_disj_150577 = y_150575 || loop_not_taken_150576;
            bool protect_assert_disj_165551 = cond_150451 || protect_assert_disj_150577;
            bool index_certs_150578;
            
            if (!protect_assert_disj_165551) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:264:20-25\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_157450 = add64(nR_136036, extParallelism_136044);
            int64_t zs_lhs_157451 = sub64(zm_lhs_157450, (int64_t) 1);
            bool zzero_157452 = extParallelism_136044 == (int64_t) 0;
            bool nonzzero_157453 = !zzero_157452;
            bool loop_not_taken_165527 = !cond_150451;
            bool protect_assert_disj_165528 = nonzzero_157453 || loop_not_taken_165527;
            bool nonzzero_cert_157454;
            
            if (!protect_assert_disj_165528) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_157455 = sdiv_safe64(zs_lhs_157451, extParallelism_136044);
            bool loop_cond_157456 = slt64((int64_t) 0, numIter_157455);
            bool loop_not_taken_157457 = !y_150444;
            bool loop_not_taken_157458 = !loop_cond_157456;
            bool x_157459 = sle64((int64_t) 0, m_150432);
            bool y_157460 = slt64(m_150432, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
            bool bounds_check_157462 = x_157459 && y_157460;
            bool protect_assert_disj_157463 = loop_not_taken_157457 || bounds_check_157462;
            bool protect_assert_disj_157464 = loop_not_taken_157458 || protect_assert_disj_157463;
            bool protect_assert_disj_165530 = protect_assert_disj_157464 || loop_not_taken_165527;
            bool index_certs_157465;
            
            if (!protect_assert_disj_165530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151246;
            
            if (!bounds_check_157462) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:405:23-44\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151248;
            
            if (!bounds_check_150413) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:405:51-59\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 = mul64(partitionsPerWindow_136042, numberOfWindows_136043);
            int64_t join_chunks_arg3_150568 = add64(offset_S_136041, tS_start_150427);
            int64_t bytes_164941 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
            bool empty_slice_150573 = partitionsPerWindow_136042 == (int64_t) 0;
            int64_t m_150574 = sub64(partitionsPerWindow_136042, (int64_t) 1);
            bool protect_cond_conj_165552 = loop_cond_150572 && loop_not_taken_165527;
            double leq_lhs_150579;
            
            if (protect_cond_conj_165552) {
                double x_157566 = ((double *) tR_mem_164928.mem)[(int64_t) 0];
                
                leq_lhs_150579 = x_157566;
            } else {
                leq_lhs_150579 = 0.0;
            }
            
            bool defunc_0_leq_res_150583 = leq_lhs_150579 <= gt_lhs_150446;
            double lowest_150584;
            
            if (protect_cond_conj_165552) {
                bool loop_not_taken_165542 = !defunc_0_leq_res_150583;
                bool protect_assert_disj_165543 = y_150575 || loop_not_taken_165542;
                bool index_certs_157570;
                
                if (!protect_assert_disj_165543) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:264:44-49\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double lowest_t_res_157571;
                
                if (defunc_0_leq_res_150583) {
                    double x_165544 = ((double *) tR_mem_164928.mem)[(int64_t) 0];
                    
                    lowest_t_res_157571 = x_165544;
                } else {
                    lowest_t_res_157571 = 0.0;
                }
                
                double x_157569;
                
                if (defunc_0_leq_res_150583) {
                    x_157569 = lowest_t_res_157571;
                } else {
                    bool index_certs_157572;
                    
                    if (!y_150575) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:264:55-60\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    x_157569 = gt_lhs_150446;
                }
                lowest_150584 = x_157569;
            } else {
                lowest_150584 = 0.0;
            }
            
            int64_t zeze_rhs_150843 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, (int64_t) 1);
            bool loop_cond_150998 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
            bool protect_cond_conj_157461 = y_150444 && loop_cond_157456;
            bool protect_cond_conj_165531 = cond_150451 && protect_cond_conj_157461;
            double s_max_t_res_157466;
            
            if (protect_cond_conj_165531) {
                double x_157467 = ((double *) tS_mem_164929.mem)[i_p_m_t_s_150433];
                
                s_max_t_res_157466 = x_157467;
            } else {
                s_max_t_res_157466 = 0.0;
            }
            
            int64_t bytes_165130 = (int64_t) 8 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            int64_t ext_165176;
            int64_t ext_165175;
            int64_t ext_165173;
            int64_t ext_165172;
            
            if (cond_150451) {
                int64_t ext_165169;
                int64_t ext_165168;
                int64_t ext_165167;
                int64_t ext_165166;
                bool defunc_0_find_joinTuples_res_157468;
                int64_t defunc_0_find_joinTuples_res_157469;
                bool loop_while_157472;
                int64_t p_157473;
                int64_t ctx_param_ext_165124;
                int64_t ctx_param_ext_165125;
                int64_t ctx_param_ext_165127;
                int64_t ctx_param_ext_165128;
                
                if (memblock_set(ctx, &mem_param_165126, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165129, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165124 = (int64_t) 0;
                ctx_param_ext_165125 = (int64_t) 1;
                ctx_param_ext_165127 = (int64_t) 0;
                ctx_param_ext_165128 = (int64_t) 1;
                loop_while_157472 = loop_cond_157456;
                p_157473 = (int64_t) 0;
                while (loop_while_157472) {
                    int64_t start_157476 = mul64(extParallelism_136044, p_157473);
                    int64_t min_arg1_157477 = sub64(nR_136036, start_157476);
                    int64_t min_res_157478 = smin64(extParallelism_136044, min_arg1_157477);
                    int64_t iter_R_157479 = add64(start_157476, min_res_157478);
                    bool empty_slice_157480 = min_res_157478 == (int64_t) 0;
                    int64_t m_157481 = sub64(min_res_157478, (int64_t) 1);
                    int64_t i_p_m_t_s_157482 = add64(start_157476, m_157481);
                    bool zzero_leq_i_p_m_t_s_157483 = sle64((int64_t) 0, i_p_m_t_s_157482);
                    bool i_p_m_t_s_leq_w_157484 = slt64(i_p_m_t_s_157482, nR_136036);
                    bool zzero_lte_i_157485 = sle64((int64_t) 0, start_157476);
                    bool i_lte_j_157486 = sle64(start_157476, iter_R_157479);
                    bool y_157487 = i_p_m_t_s_leq_w_157484 && zzero_lte_i_157485;
                    bool y_157488 = zzero_leq_i_p_m_t_s_157483 && y_157487;
                    bool forwards_ok_157489 = i_lte_j_157486 && y_157488;
                    bool ok_or_empty_157490 = empty_slice_157480 || forwards_ok_157489;
                    bool index_certs_157491;
                    
                    if (!ok_or_empty_157490) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_157476, ":", (long long) iter_R_157479, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157492 = slt64(m_157481, min_res_157478);
                    bool x_157493 = sle64((int64_t) 0, m_157481);
                    bool bounds_check_157494 = y_157492 && x_157493;
                    bool index_certs_157495;
                    
                    if (!bounds_check_157494) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_157481, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157498 = slt64((int64_t) 0, min_res_157478);
                    bool index_certs_157499;
                    
                    if (!y_157498) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double r_max_157496 = ((double *) tR_mem_164928.mem)[i_p_m_t_s_157482];
                    double s_max_157497;
                    
                    if (y_150444) {
                        s_max_157497 = s_max_t_res_157466;
                    } else {
                        s_max_157497 = r_max_157496;
                    }
                    
                    double r_min_157500 = ((double *) tR_mem_164928.mem)[start_157476];
                    bool defunc_0_gt_res_157501 = s_max_157497 < r_min_157500;
                    double s_min_157502;
                    
                    if (y_150444) {
                        s_min_157502 = gt_lhs_150446;
                    } else {
                        s_min_157502 = r_min_157500;
                    }
                    
                    bool defunc_0_gt_res_157507 = r_max_157496 < s_min_157502;
                    int64_t ext_165158;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165158 = ctx_param_ext_165124;
                    } else {
                        ext_165158 = (int64_t) 0;
                    }
                    
                    int64_t ext_165157;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165157 = ctx_param_ext_165125;
                    } else {
                        ext_165157 = (int64_t) 1;
                    }
                    
                    int64_t ext_165155;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165155 = ctx_param_ext_165127;
                    } else {
                        ext_165155 = (int64_t) 0;
                    }
                    
                    int64_t ext_165154;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165154 = ctx_param_ext_165128;
                    } else {
                        ext_165154 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165134 = (int64_t) 8 * min_res_157478;
                    int64_t ext_165164;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165164 = ctx_param_ext_165124;
                    } else {
                        ext_165164 = ext_165158;
                    }
                    
                    int64_t ext_165163;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165163 = ctx_param_ext_165125;
                    } else {
                        ext_165163 = ext_165157;
                    }
                    
                    int64_t ext_165161;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165161 = ctx_param_ext_165127;
                    } else {
                        ext_165161 = ext_165155;
                    }
                    
                    int64_t ext_165160;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165160 = ctx_param_ext_165128;
                    } else {
                        ext_165160 = ext_165154;
                    }
                    
                    int64_t loopres_157503;
                    
                    if (defunc_0_gt_res_157501) {
                        if (memblock_set(ctx, &ext_mem_165165, &mem_param_165126, "mem_param_165126") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &mem_param_165129, "mem_param_165129") != 0)
                            return 1;
                        loopres_157503 = numIter_157455;
                    } else {
                        int64_t loopres_f_res_157508;
                        
                        if (defunc_0_gt_res_157507) {
                            int64_t tmp_157512 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_param_165126, "mem_param_165126") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_param_165129, "mem_param_165129") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157512;
                        } else {
                            if (memblock_alloc(ctx, &mem_165131, bytes_165130, "mem_165131")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165131.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) tS_mem_164929.mem, tS_start_150427, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430});
                            if (futrts_indicesWithIncrement_12227(ctx, &ext_mem_165133, mem_165131, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, join_chunks_arg3_150568) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
                                return 1;
                            if (mem_165135_cached_sizze_166002 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165135, &mem_165135_cached_sizze_166002, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_165137_cached_sizze_166003 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165137, &mem_165137_cached_sizze_166003, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164719 = 0; i_164719 < min_res_157478; i_164719++) {
                                int64_t slice_164899 = start_157476 + i_164719;
                                double eta_p_157518 = ((double *) tR_mem_164928.mem)[slice_164899];
                                int64_t defunc_0_reduce_comm_res_157519;
                                double defunc_0_reduce_comm_res_157520;
                                int64_t defunc_0_reduce_comm_res_157521;
                                int64_t redout_164711;
                                double redout_164712;
                                int64_t redout_164713;
                                
                                redout_164711 = (int64_t) -1;
                                redout_164712 = eta_p_157518;
                                redout_164713 = (int64_t) 0;
                                for (int64_t i_164714 = 0; i_164714 < dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430; i_164714++) {
                                    int64_t x_157522 = ((int64_t *) ext_mem_165133.mem)[i_164714];
                                    int64_t slice_164898 = tS_start_150427 + i_164714;
                                    double x_157523 = ((double *) tS_mem_164929.mem)[slice_164898];
                                    bool defunc_0_neq_res_157531 = redout_164712 == eta_p_157518;
                                    bool defunc_0_neq_res_157532 = !defunc_0_neq_res_157531;
                                    bool cond_f_res_157533 = slt64(redout_164711, (int64_t) 0);
                                    bool y_157534 = defunc_0_neq_res_157531 && cond_f_res_157533;
                                    bool cond_157535 = defunc_0_neq_res_157532 || y_157534;
                                    bool defunc_0_neq_res_157536 = x_157523 == eta_p_157518;
                                    bool defunc_0_neq_res_157537 = !defunc_0_neq_res_157536;
                                    bool cond_t_res_f_res_157538 = slt64(x_157522, (int64_t) 0);
                                    bool y_157539 = defunc_0_neq_res_157536 && cond_t_res_f_res_157538;
                                    bool cond_t_res_157540 = defunc_0_neq_res_157537 || y_157539;
                                    bool x_157541 = cond_157535 && cond_t_res_157540;
                                    int64_t defunc_0_op_res_157542;
                                    double defunc_0_op_res_157543;
                                    int64_t defunc_0_op_res_157544;
                                    
                                    if (x_157541) {
                                        defunc_0_op_res_157542 = (int64_t) -1;
                                        defunc_0_op_res_157543 = eta_p_157518;
                                        defunc_0_op_res_157544 = (int64_t) 0;
                                    } else {
                                        int64_t defunc_0_op_res_f_res_157545;
                                        double defunc_0_op_res_f_res_157546;
                                        int64_t defunc_0_op_res_f_res_157547;
                                        
                                        if (cond_157535) {
                                            defunc_0_op_res_f_res_157545 = x_157522;
                                            defunc_0_op_res_f_res_157546 = x_157523;
                                            defunc_0_op_res_f_res_157547 = (int64_t) 1;
                                        } else {
                                            double defunc_0_op_res_f_res_f_res_157548;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157548 = redout_164712;
                                            } else {
                                                defunc_0_op_res_f_res_f_res_157548 = eta_p_157518;
                                            }
                                            
                                            int64_t defunc_0_op_res_f_res_f_res_157549;
                                            int64_t defunc_0_op_res_f_res_f_res_157550;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157549 = redout_164711;
                                                defunc_0_op_res_f_res_f_res_157550 = redout_164713;
                                            } else {
                                                int64_t min_res_157551 = smin64(x_157522, redout_164711);
                                                int64_t tmp_157552 = add64((int64_t) 1, redout_164713);
                                                
                                                defunc_0_op_res_f_res_f_res_157549 = min_res_157551;
                                                defunc_0_op_res_f_res_f_res_157550 = tmp_157552;
                                            }
                                            defunc_0_op_res_f_res_157545 = defunc_0_op_res_f_res_f_res_157549;
                                            defunc_0_op_res_f_res_157546 = defunc_0_op_res_f_res_f_res_157548;
                                            defunc_0_op_res_f_res_157547 = defunc_0_op_res_f_res_f_res_157550;
                                        }
                                        defunc_0_op_res_157542 = defunc_0_op_res_f_res_157545;
                                        defunc_0_op_res_157543 = defunc_0_op_res_f_res_157546;
                                        defunc_0_op_res_157544 = defunc_0_op_res_f_res_157547;
                                    }
                                    
                                    int64_t redout_tmp_165717 = defunc_0_op_res_157542;
                                    double redout_tmp_165718 = defunc_0_op_res_157543;
                                    int64_t redout_tmp_165719 = defunc_0_op_res_157544;
                                    
                                    redout_164711 = redout_tmp_165717;
                                    redout_164712 = redout_tmp_165718;
                                    redout_164713 = redout_tmp_165719;
                                }
                                defunc_0_reduce_comm_res_157519 = redout_164711;
                                defunc_0_reduce_comm_res_157520 = redout_164712;
                                defunc_0_reduce_comm_res_157521 = redout_164713;
                                ((int64_t *) mem_165135)[i_164719] = defunc_0_reduce_comm_res_157519;
                                ((int64_t *) mem_165137)[i_164719] = defunc_0_reduce_comm_res_157521;
                            }
                            if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165151, bytes_164931, "mem_165151")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165129.mem, ctx_param_ext_165127, (int64_t []) {ctx_param_ext_165128}, (int64_t []) {nR_136036});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165135, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            if (memblock_alloc(ctx, &mem_165153, bytes_164931, "mem_165153")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165126.mem, ctx_param_ext_165124, (int64_t []) {ctx_param_ext_165125}, (int64_t []) {nR_136036});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165137, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            
                            int64_t tmp_157564 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_165153, "mem_165153") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_165151, "mem_165151") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157564;
                        }
                        if (memblock_set(ctx, &ext_mem_165165, &ext_mem_165159, "ext_mem_165159") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &ext_mem_165156, "ext_mem_165156") != 0)
                            return 1;
                        loopres_157503 = loopres_f_res_157508;
                    }
                    
                    bool loop_cond_157565 = slt64(loopres_157503, numIter_157455);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165705, &ext_mem_165165, "ext_mem_165165") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165706, &ext_mem_165162, "ext_mem_165162") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165707 = ext_165164;
                    int64_t ctx_param_ext_tmp_165708 = ext_165163;
                    int64_t ctx_param_ext_tmp_165709 = ext_165161;
                    int64_t ctx_param_ext_tmp_165710 = ext_165160;
                    bool loop_while_tmp_165711 = loop_cond_157565;
                    int64_t p_tmp_165712 = loopres_157503;
                    
                    if (memblock_set(ctx, &mem_param_165126, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165129, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
                        return 1;
                    ctx_param_ext_165124 = ctx_param_ext_tmp_165707;
                    ctx_param_ext_165125 = ctx_param_ext_tmp_165708;
                    ctx_param_ext_165127 = ctx_param_ext_tmp_165709;
                    ctx_param_ext_165128 = ctx_param_ext_tmp_165710;
                    loop_while_157472 = loop_while_tmp_165711;
                    p_157473 = p_tmp_165712;
                }
                if (memblock_set(ctx, &ext_mem_165171, &mem_param_165126, "mem_param_165126") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165170, &mem_param_165129, "mem_param_165129") != 0)
                    return 1;
                ext_165169 = ctx_param_ext_165124;
                ext_165168 = ctx_param_ext_165125;
                ext_165167 = ctx_param_ext_165127;
                ext_165166 = ctx_param_ext_165128;
                defunc_0_find_joinTuples_res_157468 = loop_while_157472;
                defunc_0_find_joinTuples_res_157469 = p_157473;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165171, "ext_mem_165171") != 0)
                    return 1;
                ext_165176 = ext_165169;
                ext_165175 = ext_165168;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165170, "ext_mem_165170") != 0)
                    return 1;
                ext_165173 = ext_165167;
                ext_165172 = ext_165166;
            } else {
                if (mem_164942_cached_sizze_165994 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_165994, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165720 = 0; nest_i_165720 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165720++) {
                    ((int64_t *) mem_164942)[nest_i_165720] = nR_136036;
                }
                if (mem_164944_cached_sizze_165995 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164944, &mem_164944_cached_sizze_165995, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165721 = 0; nest_i_165721 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165721++) {
                    ((int64_t *) mem_164944)[nest_i_165721] = nR_136036;
                }
                
                bool defunc_0_windowed_partitionFunc_res_150590;
                int64_t defunc_0_windowed_partitionFunc_res_150591;
                bool loop_while_150594;
                int64_t p_150595;
                
                loop_while_150594 = loop_cond_150572;
                p_150595 = (int64_t) 0;
                while (loop_while_150594) {
                    int64_t start_150598 = mul64(partitionsPerWindow_136042, p_150595);
                    int64_t end_150599 = add64(partitionsPerWindow_136042, start_150598);
                    int64_t max_res_150600 = smax64((int64_t) 1, start_150598);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601 = sub64(end_150599, max_res_150600);
                    bool bounds_invalid_upwards_150602 = slt64(end_150599, max_res_150600);
                    bool valid_150603 = !bounds_invalid_upwards_150602;
                    bool range_valid_c_150604;
                    
                    if (!valid_150603) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_150600, "..<", (long long) end_150599, " is invalid.", "-> #0  ftbasics.fut:267:43-68\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_150607 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 == (int64_t) 0;
                    bool nonzzero_150608 = !zzero_150607;
                    bool nonzzero_cert_150609;
                    
                    if (!nonzzero_150608) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:270:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_164951 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool cond_150810 = slt64((int64_t) 0, start_150598);
                    int64_t conc_tmp_150811 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    int64_t ret_150812;
                    
                    if (cond_150810) {
                        ret_150812 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    } else {
                        ret_150812 = conc_tmp_150811;
                    }
                    
                    bool eq_x_y_150820 = partitionsPerWindow_136042 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool eq_x_zz_150821 = partitionsPerWindow_136042 == conc_tmp_150811;
                    bool p_and_eq_x_y_150822 = cond_150810 && eq_x_y_150820;
                    bool not_p_150823 = !cond_150810;
                    bool p_and_eq_x_y_150824 = eq_x_zz_150821 && not_p_150823;
                    bool dim_match_150825 = p_and_eq_x_y_150822 || p_and_eq_x_y_150824;
                    bool empty_or_match_cert_150826;
                    
                    if (!dim_match_150825) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_150812, "] cannot match shape of type `[", (long long) partitionsPerWindow_136042, "](i64, i64)`.", "-> #0  ftbasics.fut:331:5-336:49\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_150828 = add64(m_150574, start_150598);
                    bool zzero_leq_i_p_m_t_s_150829 = sle64((int64_t) 0, i_p_m_t_s_150828);
                    bool i_p_m_t_s_leq_w_150830 = slt64(i_p_m_t_s_150828, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool zzero_lte_i_150831 = sle64((int64_t) 0, start_150598);
                    bool i_lte_j_150832 = sle64(start_150598, end_150599);
                    bool y_150833 = i_p_m_t_s_leq_w_150830 && zzero_lte_i_150831;
                    bool y_150834 = zzero_leq_i_p_m_t_s_150829 && y_150833;
                    bool forwards_ok_150835 = i_lte_j_150832 && y_150834;
                    bool ok_or_empty_150836 = empty_slice_150573 || forwards_ok_150835;
                    bool index_certs_150837;
                    
                    if (!ok_or_empty_150836) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_150598, ":", (long long) end_150599, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftbasics.fut:356:37-74\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_150606 = add64(nR_136036, nR_136036);
                    
                    if (memblock_alloc(ctx, &mem_164952, bytes_164951, "mem_164952")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_164954, bytes_164951, "mem_164954")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164726 = 0; i_164726 < dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601; i_164726++) {
                        int64_t index_primexp_164907 = add64(max_res_150600, i_164726);
                        int64_t zs_lhs_150613 = mul64(zt_rhs_150606, index_primexp_164907);
                        int64_t index_150614 = sdiv64(zs_lhs_150613, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool cond_150615 = slt64(nR_136036, index_150614);
                        int64_t loop_over_150616;
                        
                        if (cond_150615) {
                            loop_over_150616 = nR_136036;
                        } else {
                            loop_over_150616 = index_150614;
                        }
                        
                        int64_t loop_over_150617;
                        
                        if (cond_150615) {
                            int64_t loop_over_t_res_157573 = sub64(index_150614, nR_136036);
                            
                            loop_over_150617 = loop_over_t_res_157573;
                        } else {
                            loop_over_150617 = (int64_t) 0;
                        }
                        
                        int64_t loop_over_150619;
                        
                        if (cond_150615) {
                            int64_t zm_lhs_157574 = sub64(index_150614, nR_136036);
                            int64_t loop_over_t_res_157575 = sub64(zm_lhs_157574, (int64_t) 1);
                            
                            loop_over_150619 = loop_over_t_res_157575;
                        } else {
                            loop_over_150619 = (int64_t) 0;
                        }
                        
                        bool defunc_0_f_res_150622;
                        int64_t defunc_0_f_res_150623;
                        int64_t defunc_0_f_res_150624;
                        int64_t defunc_0_f_res_150625;
                        bool loop_while_150626;
                        int64_t p_150627;
                        int64_t p_150628;
                        int64_t p_150629;
                        
                        loop_while_150626 = 1;
                        p_150627 = loop_over_150619;
                        p_150628 = loop_over_150616;
                        p_150629 = loop_over_150617;
                        while (loop_while_150626) {
                            int64_t zs_lhs_150630 = sub64(p_150628, p_150627);
                            int64_t offset_150631 = sdiv64(zs_lhs_150630, (int64_t) 2);
                            int64_t ai_150632 = sub64(p_150628, offset_150631);
                            int64_t max_arg1_150633 = add64(p_150629, offset_150631);
                            int64_t max_res_150634 = smax64((int64_t) 0, max_arg1_150633);
                            bool cond_150635 = slt64((int64_t) 0, max_res_150634);
                            double b_prev_150636;
                            
                            if (cond_150635) {
                                int64_t tmp_157576 = sub64(max_res_150634, (int64_t) 1);
                                bool x_157577 = sle64((int64_t) 0, tmp_157576);
                                bool y_157578 = slt64(tmp_157576, nR_136036);
                                bool bounds_check_157579 = x_157577 && y_157578;
                                bool index_certs_157580;
                                
                                if (!bounds_check_157579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157576, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:282:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157581 = tS_start_150427 + tmp_157576;
                                double b_prev_t_res_157582 = ((double *) tS_mem_164929.mem)[slice_157581];
                                
                                b_prev_150636 = b_prev_t_res_157582;
                            } else {
                                b_prev_150636 = lowest_150584;
                            }
                            
                            bool cond_150643 = sle64(ai_150632, (int64_t) 0);
                            int64_t loopres_150644;
                            int64_t loopres_150645;
                            int64_t loopres_150646;
                            bool loopres_150647;
                            
                            if (cond_150643) {
                                loopres_150644 = p_150627;
                                loopres_150645 = (int64_t) 0;
                                loopres_150646 = max_res_150634;
                                loopres_150647 = 0;
                            } else {
                                bool cond_150648 = sle64(nR_136036, max_res_150634);
                                int64_t loopres_f_res_150649;
                                int64_t loopres_f_res_150650;
                                int64_t loopres_f_res_150651;
                                bool loopres_f_res_150652;
                                
                                if (cond_150648) {
                                    int64_t min_res_157584 = smin64(gt_rhs_150410, ai_150632);
                                    bool bounds_check_157587 = x_150411 && y_150412;
                                    bool index_certs_157588;
                                    
                                    if (!bounds_check_157587) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:293:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157591 = sle64((int64_t) 0, min_res_157584);
                                    bool y_157592 = slt64(min_res_157584, nR_136036);
                                    bool bounds_check_157593 = x_157591 && y_157592;
                                    bool index_certs_157594;
                                    
                                    if (!bounds_check_157593) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157584, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:293:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157589 = gt_rhs_150410 + tS_start_150427;
                                    double leq_lhs_157590 = ((double *) tS_mem_164929.mem)[slice_157589];
                                    double leq_rhs_157595 = ((double *) tR_mem_164928.mem)[min_res_157584];
                                    bool defunc_0_leq_res_157596 = leq_lhs_157590 <= leq_rhs_157595;
                                    int64_t loopres_f_res_t_res_157597;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157597 = ai_150632;
                                    } else {
                                        loopres_f_res_t_res_157597 = p_150628;
                                    }
                                    
                                    bool x_157598 = !defunc_0_leq_res_157596;
                                    int64_t loopres_f_res_t_res_157599;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157599 = nR_136036;
                                    } else {
                                        int64_t tmp_157600 = sub64(gt_rhs_150410, offset_150631);
                                        
                                        loopres_f_res_t_res_157599 = tmp_157600;
                                    }
                                    loopres_f_res_150649 = p_150627;
                                    loopres_f_res_150650 = loopres_f_res_t_res_157597;
                                    loopres_f_res_150651 = loopres_f_res_t_res_157599;
                                    loopres_f_res_150652 = x_157598;
                                } else {
                                    bool cond_150670 = sle64(nR_136036, ai_150632);
                                    int64_t loopres_f_res_f_res_150671;
                                    int64_t loopres_f_res_f_res_150672;
                                    int64_t loopres_f_res_f_res_150673;
                                    bool loopres_f_res_f_res_150674;
                                    
                                    if (cond_150670) {
                                        int64_t min_res_157602 = smin64(gt_rhs_150410, max_res_150634);
                                        bool bounds_check_157605 = x_150411 && y_150412;
                                        bool index_certs_157606;
                                        
                                        if (!bounds_check_157605) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:300:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157608 = sle64((int64_t) 0, min_res_157602);
                                        bool y_157609 = slt64(min_res_157602, nR_136036);
                                        bool bounds_check_157610 = x_157608 && y_157609;
                                        bool index_certs_157611;
                                        
                                        if (!bounds_check_157610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157602, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:300:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        double leq_lhs_157607 = ((double *) tR_mem_164928.mem)[gt_rhs_150410];
                                        int64_t slice_157612 = tS_start_150427 + min_res_157602;
                                        double leq_rhs_157613 = ((double *) tS_mem_164929.mem)[slice_157612];
                                        bool defunc_0_leq_res_157614 = leq_lhs_157607 <= leq_rhs_157613;
                                        int64_t loopres_f_res_f_res_t_res_157615;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157615 = max_res_150634;
                                        } else {
                                            loopres_f_res_f_res_t_res_157615 = p_150629;
                                        }
                                        
                                        bool x_157616 = !defunc_0_leq_res_157614;
                                        int64_t loopres_f_res_f_res_t_res_157617;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157617 = nR_136036;
                                        } else {
                                            loopres_f_res_f_res_t_res_157617 = gt_rhs_150410;
                                        }
                                        loopres_f_res_f_res_150671 = p_150627;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_t_res_157617;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_t_res_157615;
                                        loopres_f_res_f_res_150674 = x_157616;
                                    } else {
                                        bool cond_150691 = sle64(p_150628, p_150627);
                                        int64_t loopres_f_res_f_res_f_res_150692;
                                        int64_t loopres_f_res_f_res_f_res_150693;
                                        int64_t loopres_f_res_f_res_f_res_150694;
                                        bool loopres_f_res_f_res_f_res_150695;
                                        
                                        if (cond_150691) {
                                            bool cond_157655 = slt64(ai_150632, nR_136036);
                                            int64_t ai_157656;
                                            
                                            if (cond_157655) {
                                                ai_157656 = ai_150632;
                                            } else {
                                                ai_157656 = gt_rhs_150410;
                                            }
                                            
                                            bool x_157669 = sle64((int64_t) 0, ai_157656);
                                            bool y_157670 = slt64(ai_157656, nR_136036);
                                            bool bounds_check_157671 = x_157669 && y_157670;
                                            bool index_certs_157672;
                                            
                                            if (!bounds_check_157671) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_157656, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:234:8-14\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            double b_prev_157658;
                                            
                                            if (cond_150635) {
                                                int64_t tmp_157659 = sub64(max_res_150634, (int64_t) 1);
                                                bool x_157660 = sle64((int64_t) 0, tmp_157659);
                                                bool y_157661 = slt64(tmp_157659, nR_136036);
                                                bool bounds_check_157662 = x_157660 && y_157661;
                                                bool index_certs_157663;
                                                
                                                if (!bounds_check_157662) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157659, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:232:31-39\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_157664 = tS_start_150427 + tmp_157659;
                                                double b_prev_t_res_157665 = ((double *) tS_mem_164929.mem)[slice_157664];
                                                
                                                b_prev_157658 = b_prev_t_res_157665;
                                            } else {
                                                bool index_certs_157667;
                                                
                                                if (!y_150575) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:232:45-50\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                b_prev_157658 = gt_lhs_150446;
                                            }
                                            
                                            double gt_lhs_157673 = ((double *) tR_mem_164928.mem)[ai_157656];
                                            bool defunc_0_gt_res_157674 = b_prev_157658 < gt_lhs_157673;
                                            int64_t defunc_0_partFunc_sequential_search_res_157675;
                                            int64_t defunc_0_partFunc_sequential_search_res_157676;
                                            
                                            if (defunc_0_gt_res_157674) {
                                                int64_t zl_rhs_157677 = sub64(nR_136036, max_res_150634);
                                                bool loop_cond_157678 = slt64((int64_t) 0, zl_rhs_157677);
                                                bool defunc_0_partFunc_sequential_search_res_t_res_157679;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157681;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157682;
                                                bool loop_while_157683;
                                                int64_t p_157684;
                                                int64_t p_157685;
                                                int64_t p_157686;
                                                
                                                loop_while_157683 = loop_cond_157678;
                                                p_157684 = ai_157656;
                                                p_157685 = max_res_150634;
                                                p_157686 = (int64_t) 0;
                                                while (loop_while_157683) {
                                                    int64_t i_a_157687 = sub64(ai_157656, p_157686);
                                                    int64_t i_b_157688 = add64(max_res_150634, p_157686);
                                                    int64_t leq_lhs_157689 = sub64(i_a_157687, (int64_t) 1);
                                                    bool x_157690 = sle64((int64_t) 0, leq_lhs_157689);
                                                    bool y_157691 = slt64(leq_lhs_157689, nR_136036);
                                                    bool bounds_check_157692 = x_157690 && y_157691;
                                                    bool index_certs_157693;
                                                    
                                                    if (!bounds_check_157692) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157689, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:240:15-24\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157695 = sle64((int64_t) 0, i_b_157688);
                                                    bool y_157696 = slt64(i_b_157688, nR_136036);
                                                    bool bounds_check_157697 = x_157695 && y_157696;
                                                    bool index_certs_157698;
                                                    
                                                    if (!bounds_check_157697) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157688, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:240:31-38\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    double leq_lhs_157694 = ((double *) tR_mem_164928.mem)[leq_lhs_157689];
                                                    int64_t slice_157699 = tS_start_150427 + i_b_157688;
                                                    double leq_rhs_157700 = ((double *) tS_mem_164929.mem)[slice_157699];
                                                    bool defunc_0_leq_res_157701 = leq_lhs_157694 <= leq_rhs_157700;
                                                    int64_t loopres_157702;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157702 = i_a_157687;
                                                    } else {
                                                        loopres_157702 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157703;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157703 = i_b_157688;
                                                    } else {
                                                        loopres_157703 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157704;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157704 = zl_rhs_157677;
                                                    } else {
                                                        int64_t tmp_157705 = add64((int64_t) 1, p_157686);
                                                        
                                                        loopres_157704 = tmp_157705;
                                                    }
                                                    
                                                    bool loop_cond_157706 = slt64(loopres_157704, zl_rhs_157677);
                                                    bool loop_while_tmp_165732 = loop_cond_157706;
                                                    int64_t p_tmp_165733 = loopres_157702;
                                                    int64_t p_tmp_165734 = loopres_157703;
                                                    int64_t p_tmp_165735 = loopres_157704;
                                                    
                                                    loop_while_157683 = loop_while_tmp_165732;
                                                    p_157684 = p_tmp_165733;
                                                    p_157685 = p_tmp_165734;
                                                    p_157686 = p_tmp_165735;
                                                }
                                                defunc_0_partFunc_sequential_search_res_t_res_157679 = loop_while_157683;
                                                defunc_0_partFunc_sequential_search_res_t_res_157680 = p_157684;
                                                defunc_0_partFunc_sequential_search_res_t_res_157681 = p_157685;
                                                defunc_0_partFunc_sequential_search_res_t_res_157682 = p_157686;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_t_res_157681;
                                            } else {
                                                int64_t zl_rhs_157707 = sub64(max_res_150634, (int64_t) 1);
                                                bool loop_cond_157708 = slt64((int64_t) 0, zl_rhs_157707);
                                                bool defunc_0_partFunc_sequential_search_res_f_res_157709;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157711;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157712;
                                                bool loop_while_157713;
                                                int64_t p_157714;
                                                int64_t p_157715;
                                                int64_t p_157716;
                                                
                                                loop_while_157713 = loop_cond_157708;
                                                p_157714 = ai_157656;
                                                p_157715 = max_res_150634;
                                                p_157716 = (int64_t) 0;
                                                while (loop_while_157713) {
                                                    int64_t zp_lhs_157717 = add64(ai_157656, p_157716);
                                                    int64_t hi_a_157718 = add64((int64_t) 1, zp_lhs_157717);
                                                    bool cond_157719 = slt64(hi_a_157718, nR_136036);
                                                    int64_t i_a_157720;
                                                    
                                                    if (cond_157719) {
                                                        i_a_157720 = hi_a_157718;
                                                    } else {
                                                        i_a_157720 = gt_rhs_150410;
                                                    }
                                                    
                                                    int64_t zm_lhs_157722 = sub64(max_res_150634, p_157716);
                                                    int64_t i_b_157723 = sub64(zm_lhs_157722, (int64_t) 1);
                                                    bool x_157724 = sle64((int64_t) 0, i_a_157720);
                                                    bool y_157725 = slt64(i_a_157720, nR_136036);
                                                    bool bounds_check_157726 = x_157724 && y_157725;
                                                    bool index_certs_157727;
                                                    
                                                    if (!bounds_check_157726) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_a_157720, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:250:15-22\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157729 = sle64((int64_t) 0, i_b_157723);
                                                    bool y_157730 = slt64(i_b_157723, nR_136036);
                                                    bool bounds_check_157731 = x_157729 && y_157730;
                                                    bool index_certs_157732;
                                                    
                                                    if (!bounds_check_157731) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157723, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:250:28-35\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:210:133-136\n   #5  ftRelational.fut:199:1-210:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    double gt_lhs_157728 = ((double *) tR_mem_164928.mem)[i_a_157720];
                                                    int64_t slice_157733 = tS_start_150427 + i_b_157723;
                                                    double gt_rhs_157734 = ((double *) tS_mem_164929.mem)[slice_157733];
                                                    bool defunc_0_gt_res_157735 = gt_rhs_157734 < gt_lhs_157728;
                                                    int64_t loopres_157736;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157736 = i_a_157720;
                                                    } else {
                                                        loopres_157736 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157737;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157737 = zm_lhs_157722;
                                                    } else {
                                                        loopres_157737 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157738;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157738 = zl_rhs_157707;
                                                    } else {
                                                        int64_t tmp_157739 = add64((int64_t) 1, p_157716);
                                                        
                                                        loopres_157738 = tmp_157739;
                                                    }
                                                    
                                                    bool loop_cond_157740 = slt64(loopres_157738, zl_rhs_157707);
                                                    bool loop_while_tmp_165736 = loop_cond_157740;
                                                    int64_t p_tmp_165737 = loopres_157736;
                                                    int64_t p_tmp_165738 = loopres_157737;
                                                    int64_t p_tmp_165739 = loopres_157738;
                                                    
                                                    loop_while_157713 = loop_while_tmp_165736;
                                                    p_157714 = p_tmp_165737;
                                                    p_157715 = p_tmp_165738;
                                                    p_157716 = p_tmp_165739;
                                                }
                                                defunc_0_partFunc_sequential_search_res_f_res_157709 = loop_while_157713;
                                                defunc_0_partFunc_sequential_search_res_f_res_157710 = p_157714;
                                                defunc_0_partFunc_sequential_search_res_f_res_157711 = p_157715;
                                                defunc_0_partFunc_sequential_search_res_f_res_157712 = p_157716;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_f_res_157711;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = p_150627;
                                            loopres_f_res_f_res_f_res_150693 = defunc_0_partFunc_sequential_search_res_157675;
                                            loopres_f_res_f_res_f_res_150694 = defunc_0_partFunc_sequential_search_res_157676;
                                            loopres_f_res_f_res_f_res_150695 = 0;
                                        } else {
                                            bool x_150779 = sle64((int64_t) 0, ai_150632);
                                            bool y_150780 = slt64(ai_150632, nR_136036);
                                            bool bounds_check_150781 = x_150779 && y_150780;
                                            bool index_certs_150782;
                                            
                                            if (!bounds_check_150781) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_150632, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:308:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            double gt_lhs_150783 = ((double *) tR_mem_164928.mem)[ai_150632];
                                            bool defunc_0_gt_res_150784 = b_prev_150636 < gt_lhs_150783;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150785;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150786;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150787;
                                            bool loopres_f_res_f_res_f_res_f_res_150788;
                                            
                                            if (defunc_0_gt_res_150784) {
                                                int64_t leq_lhs_157741 = sub64(ai_150632, (int64_t) 1);
                                                bool x_157742 = sle64((int64_t) 0, leq_lhs_157741);
                                                bool y_157743 = slt64(leq_lhs_157741, nR_136036);
                                                bool bounds_check_157744 = x_157742 && y_157743;
                                                bool index_certs_157745;
                                                
                                                if (!bounds_check_157744) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157741, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:309:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                bool x_157747 = sle64((int64_t) 0, max_res_150634);
                                                bool y_157748 = slt64(max_res_150634, nR_136036);
                                                bool bounds_check_157749 = x_157747 && y_157748;
                                                bool index_certs_157750;
                                                
                                                if (!bounds_check_157749) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150634, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftbasics.fut:309:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                double leq_lhs_157746 = ((double *) tR_mem_164928.mem)[leq_lhs_157741];
                                                int64_t slice_157751 = tS_start_150427 + max_res_150634;
                                                double leq_rhs_157752 = ((double *) tS_mem_164929.mem)[slice_157751];
                                                bool defunc_0_leq_res_157753 = leq_lhs_157746 <= leq_rhs_157752;
                                                bool x_157754 = !defunc_0_leq_res_157753;
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = ai_150632;
                                                } else {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = leq_lhs_157741;
                                                }
                                                
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = max_res_150634;
                                                } else {
                                                    int64_t tmp_157757 = add64((int64_t) 1, max_res_150634);
                                                    
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = tmp_157757;
                                                }
                                                loopres_f_res_f_res_f_res_f_res_150785 = p_150627;
                                                loopres_f_res_f_res_f_res_f_res_150786 = loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                loopres_f_res_f_res_f_res_f_res_150787 = loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                loopres_f_res_f_res_f_res_f_res_150788 = x_157754;
                                            } else {
                                                int64_t tmp_150805 = add64((int64_t) 1, ai_150632);
                                                
                                                loopres_f_res_f_res_f_res_f_res_150785 = tmp_150805;
                                                loopres_f_res_f_res_f_res_f_res_150786 = p_150628;
                                                loopres_f_res_f_res_f_res_f_res_150787 = p_150629;
                                                loopres_f_res_f_res_f_res_f_res_150788 = 1;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = loopres_f_res_f_res_f_res_f_res_150785;
                                            loopres_f_res_f_res_f_res_150693 = loopres_f_res_f_res_f_res_f_res_150786;
                                            loopres_f_res_f_res_f_res_150694 = loopres_f_res_f_res_f_res_f_res_150787;
                                            loopres_f_res_f_res_f_res_150695 = loopres_f_res_f_res_f_res_f_res_150788;
                                        }
                                        loopres_f_res_f_res_150671 = loopres_f_res_f_res_f_res_150692;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_f_res_150693;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_f_res_150694;
                                        loopres_f_res_f_res_150674 = loopres_f_res_f_res_f_res_150695;
                                    }
                                    loopres_f_res_150649 = loopres_f_res_f_res_150671;
                                    loopres_f_res_150650 = loopres_f_res_f_res_150672;
                                    loopres_f_res_150651 = loopres_f_res_f_res_150673;
                                    loopres_f_res_150652 = loopres_f_res_f_res_150674;
                                }
                                loopres_150644 = loopres_f_res_150649;
                                loopres_150645 = loopres_f_res_150650;
                                loopres_150646 = loopres_f_res_150651;
                                loopres_150647 = loopres_f_res_150652;
                            }
                            
                            bool loop_while_tmp_165728 = loopres_150647;
                            int64_t p_tmp_165729 = loopres_150644;
                            int64_t p_tmp_165730 = loopres_150645;
                            int64_t p_tmp_165731 = loopres_150646;
                            
                            loop_while_150626 = loop_while_tmp_165728;
                            p_150627 = p_tmp_165729;
                            p_150628 = p_tmp_165730;
                            p_150629 = p_tmp_165731;
                        }
                        defunc_0_f_res_150622 = loop_while_150626;
                        defunc_0_f_res_150623 = p_150627;
                        defunc_0_f_res_150624 = p_150628;
                        defunc_0_f_res_150625 = p_150629;
                        ((int64_t *) mem_164952.mem)[i_164726] = defunc_0_f_res_150624;
                        ((int64_t *) mem_164954.mem)[i_164726] = defunc_0_f_res_150625;
                    }
                    
                    int64_t bytes_164968 = (int64_t) 8 * ret_150812;
                    
                    if (cond_150810) {
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164952, "mem_164952") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164954, "mem_164954") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc(ctx, &mem_164971, bytes_164968, "mem_164971")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165740 = 0; nest_i_165740 < (int64_t) 1; nest_i_165740++) {
                            ((int64_t *) mem_164971.mem)[nest_i_165740] = (int64_t) 0;
                        }
                        if (memblock_alloc(ctx, &mem_164969, bytes_164968, "mem_164969")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165741 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        tmp_offs_165741 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165741 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        
                        int64_t tmp_offs_165742 = (int64_t) 0;
                        
                        if (!(tmp_offs_165742 == (int64_t) 0)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        }
                        tmp_offs_165742 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164954.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165742 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164969, "mem_164969") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164971, "mem_164971") != 0)
                            return 1;
                    }
                    if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
                        return 1;
                    
                    int64_t tmp_150827 = add64((int64_t) 1, p_150595);
                    
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164942, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164977.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164944, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164974.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
                        return 1;
                    
                    bool loop_cond_150840 = slt64(tmp_150827, numberOfWindows_136043);
                    bool loop_while_tmp_165722 = loop_cond_150840;
                    int64_t p_tmp_165723 = tmp_150827;
                    
                    loop_while_150594 = loop_while_tmp_165722;
                    p_150595 = p_tmp_165723;
                }
                defunc_0_windowed_partitionFunc_res_150590 = loop_while_150594;
                defunc_0_windowed_partitionFunc_res_150591 = p_150595;
                if (mem_164985_cached_sizze_165996 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164985, &mem_164985_cached_sizze_165996, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_164987_cached_sizze_165997 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164987, &mem_164987_cached_sizze_165997, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_164733 = 0; i_164733 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; i_164733++) {
                    int64_t eta_p_150847 = ((int64_t *) mem_164942)[i_164733];
                    int64_t min_res_150848 = smin64(gt_rhs_150410, eta_p_150847);
                    bool x_150849 = sle64((int64_t) 0, min_res_150848);
                    bool y_150850 = slt64(min_res_150848, nR_136036);
                    bool bounds_check_150851 = x_150849 && y_150850;
                    bool index_certs_150852;
                    
                    if (!bounds_check_150851) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150848, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:274:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool cond_150854 = i_164733 == zeze_rhs_150843;
                    int64_t ri_next_150855;
                    
                    if (cond_150854) {
                        ri_next_150855 = nR_136036;
                    } else {
                        int64_t tmp_150856 = add64((int64_t) 1, i_164733);
                        bool x_150857 = sle64((int64_t) 0, tmp_150856);
                        bool y_150858 = slt64(tmp_150856, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150859 = x_150857 && y_150858;
                        bool index_certs_150860;
                        
                        if (!bounds_check_150859) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150856, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:275:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t ri_next_f_res_150861 = ((int64_t *) mem_164942)[tmp_150856];
                        
                        ri_next_150855 = ri_next_f_res_150861;
                    }
                    
                    int64_t max_arg1_150862 = sub64(ri_next_150855, (int64_t) 1);
                    int64_t max_res_150863 = smax64((int64_t) 0, max_arg1_150862);
                    bool x_150864 = sle64((int64_t) 0, max_res_150863);
                    bool y_150865 = slt64(max_res_150863, nR_136036);
                    bool bounds_check_150866 = x_150864 && y_150865;
                    bool index_certs_150867;
                    
                    if (!bounds_check_150866) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150863, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:276:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double r_min_150853 = ((double *) tR_mem_164928.mem)[min_res_150848];
                    double r_max_150868 = ((double *) tR_mem_164928.mem)[max_res_150863];
                    bool defunc_0_f_res_150869;
                    int64_t defunc_0_f_res_150870;
                    bool loop_while_150871;
                    int64_t fm_150872;
                    
                    loop_while_150871 = 1;
                    fm_150872 = i_164733;
                    while (loop_while_150871) {
                        bool x_150873 = sle64((int64_t) 0, fm_150872);
                        bool y_150874 = slt64(fm_150872, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150875 = x_150873 && y_150874;
                        bool index_certs_150876;
                        
                        if (!bounds_check_150875) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) fm_150872, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:281:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150877 = ((int64_t *) mem_164944)[fm_150872];
                        int64_t min_res_150878 = smin64(gt_rhs_150410, loopres_150877);
                        bool x_150879 = sle64((int64_t) 0, min_res_150878);
                        bool y_150880 = slt64(min_res_150878, nR_136036);
                        bool bounds_check_150881 = x_150879 && y_150880;
                        bool index_certs_150882;
                        
                        if (!bounds_check_150881) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150878, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:282:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150884 = sle64(zeze_rhs_150843, fm_150872);
                        int64_t si_next_150885;
                        
                        if (cond_150884) {
                            si_next_150885 = nR_136036;
                        } else {
                            int64_t tmp_150886 = add64((int64_t) 1, fm_150872);
                            bool x_150887 = sle64((int64_t) 0, tmp_150886);
                            bool y_150888 = slt64(tmp_150886, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150889 = x_150887 && y_150888;
                            bool index_certs_150890;
                            
                            if (!bounds_check_150889) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150886, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:283:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150891 = ((int64_t *) mem_164944)[tmp_150886];
                            
                            si_next_150885 = si_next_f_res_150891;
                        }
                        
                        int64_t max_arg1_150892 = sub64(si_next_150885, (int64_t) 1);
                        int64_t max_res_150893 = smax64(min_res_150878, max_arg1_150892);
                        bool x_150894 = sle64((int64_t) 0, max_res_150893);
                        bool y_150895 = slt64(max_res_150893, nR_136036);
                        bool bounds_check_150896 = x_150894 && y_150895;
                        bool index_certs_150897;
                        
                        if (!bounds_check_150896) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150893, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:284:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150899 = smin64(zeze_rhs_150843, si_next_150885);
                        bool x_150900 = sle64((int64_t) 0, min_res_150899);
                        bool y_150901 = slt64(min_res_150899, nR_136036);
                        bool bounds_check_150902 = x_150900 && y_150901;
                        bool index_certs_150903;
                        
                        if (!bounds_check_150902) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150899, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:285:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150905 = sub64(min_res_150878, (int64_t) 1);
                        int64_t max_res_150906 = smax64((int64_t) 0, max_arg1_150905);
                        bool x_150907 = sle64((int64_t) 0, max_res_150906);
                        bool y_150908 = slt64(max_res_150906, nR_136036);
                        bool bounds_check_150909 = x_150907 && y_150908;
                        bool index_certs_150910;
                        
                        if (!bounds_check_150909) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150906, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:286:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151506 = tS_start_150427 + min_res_150878;
                        double s_min_150883 = ((double *) tS_mem_164929.mem)[slice_151506];
                        int64_t slice_151505 = tS_start_150427 + max_res_150893;
                        double s_max_150898 = ((double *) tS_mem_164929.mem)[slice_151505];
                        int64_t slice_151504 = tS_start_150427 + min_res_150899;
                        double s_nextMin_150904 = ((double *) tS_mem_164929.mem)[slice_151504];
                        int64_t slice_151503 = tS_start_150427 + max_res_150906;
                        double s_prevMax_150911 = ((double *) tS_mem_164929.mem)[slice_151503];
                        bool defunc_0_gt_res_150912 = s_min_150883 < r_min_150853;
                        bool loopres_150913;
                        int64_t loopres_150914;
                        
                        if (defunc_0_gt_res_150912) {
                            bool defunc_0_leq_res_157760 = r_min_150853 <= s_max_150898;
                            bool loopres_t_res_157761;
                            int64_t loopres_t_res_157762;
                            
                            if (defunc_0_leq_res_157760) {
                                loopres_t_res_157761 = 0;
                                loopres_t_res_157762 = fm_150872;
                            } else {
                                bool defunc_0_leq_res_157763 = r_min_150853 <= s_nextMin_150904;
                                int64_t zgze_lhs_157764 = add64((int64_t) 1, fm_150872);
                                bool tmp_f_res_157765 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, zgze_lhs_157764);
                                bool x_157766 = !defunc_0_leq_res_157763;
                                bool y_157767 = tmp_f_res_157765 && x_157766;
                                bool tmp_157768 = defunc_0_leq_res_157763 || y_157767;
                                bool loopres_t_res_f_res_157769 = !tmp_157768;
                                
                                loopres_t_res_157761 = loopres_t_res_f_res_157769;
                                loopres_t_res_157762 = zgze_lhs_157764;
                            }
                            loopres_150913 = loopres_t_res_157761;
                            loopres_150914 = loopres_t_res_157762;
                        } else {
                            bool defunc_0_leq_res_150925 = s_prevMax_150911 <= r_min_150853;
                            int64_t zlze_lhs_150926 = sub64(fm_150872, (int64_t) 1);
                            bool tmp_f_res_150927 = sle64(zlze_lhs_150926, (int64_t) 0);
                            bool x_150928 = !defunc_0_leq_res_150925;
                            bool y_150929 = tmp_f_res_150927 && x_150928;
                            bool tmp_150930 = defunc_0_leq_res_150925 || y_150929;
                            int64_t max_res_150931 = smax64((int64_t) 0, zlze_lhs_150926);
                            bool loopres_f_res_150932 = !tmp_150930;
                            
                            loopres_150913 = loopres_f_res_150932;
                            loopres_150914 = max_res_150931;
                        }
                        
                        bool loop_while_tmp_165745 = loopres_150913;
                        int64_t fm_tmp_165746 = loopres_150914;
                        
                        loop_while_150871 = loop_while_tmp_165745;
                        fm_150872 = fm_tmp_165746;
                    }
                    defunc_0_f_res_150869 = loop_while_150871;
                    defunc_0_f_res_150870 = fm_150872;
                    
                    bool defunc_0_f_res_150934;
                    int64_t defunc_0_f_res_150935;
                    bool loop_while_150936;
                    int64_t lm_150937;
                    
                    loop_while_150936 = 1;
                    lm_150937 = i_164733;
                    while (loop_while_150936) {
                        bool x_150938 = sle64((int64_t) 0, lm_150937);
                        bool y_150939 = slt64(lm_150937, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150940 = x_150938 && y_150939;
                        bool index_certs_150941;
                        
                        if (!bounds_check_150940) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lm_150937, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:297:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150942 = ((int64_t *) mem_164944)[lm_150937];
                        int64_t min_res_150943 = smin64(gt_rhs_150410, loopres_150942);
                        bool x_150944 = sle64((int64_t) 0, min_res_150943);
                        bool y_150945 = slt64(min_res_150943, nR_136036);
                        bool bounds_check_150946 = x_150944 && y_150945;
                        bool index_certs_150947;
                        
                        if (!bounds_check_150946) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150943, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:298:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150949 = sle64(zeze_rhs_150843, lm_150937);
                        int64_t si_next_150950;
                        
                        if (cond_150949) {
                            si_next_150950 = nR_136036;
                        } else {
                            int64_t tmp_150951 = add64((int64_t) 1, lm_150937);
                            bool x_150952 = sle64((int64_t) 0, tmp_150951);
                            bool y_150953 = slt64(tmp_150951, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150954 = x_150952 && y_150953;
                            bool index_certs_150955;
                            
                            if (!bounds_check_150954) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150951, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:299:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150956 = ((int64_t *) mem_164944)[tmp_150951];
                            
                            si_next_150950 = si_next_f_res_150956;
                        }
                        
                        int64_t max_arg1_150957 = sub64(si_next_150950, (int64_t) 1);
                        int64_t max_res_150958 = smax64(min_res_150943, max_arg1_150957);
                        bool x_150959 = sle64((int64_t) 0, max_res_150958);
                        bool y_150960 = slt64(max_res_150958, nR_136036);
                        bool bounds_check_150961 = x_150959 && y_150960;
                        bool index_certs_150962;
                        
                        if (!bounds_check_150961) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150958, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:300:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150964 = smin64(zeze_rhs_150843, si_next_150950);
                        bool x_150965 = sle64((int64_t) 0, min_res_150964);
                        bool y_150966 = slt64(min_res_150964, nR_136036);
                        bool bounds_check_150967 = x_150965 && y_150966;
                        bool index_certs_150968;
                        
                        if (!bounds_check_150967) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150964, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:301:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150970 = sub64(min_res_150943, (int64_t) 1);
                        int64_t max_res_150971 = smax64((int64_t) 0, max_arg1_150970);
                        bool x_150972 = sle64((int64_t) 0, max_res_150971);
                        bool y_150973 = slt64(max_res_150971, nR_136036);
                        bool bounds_check_150974 = x_150972 && y_150973;
                        bool index_certs_150975;
                        
                        if (!bounds_check_150974) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150971, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:302:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151502 = tS_start_150427 + min_res_150943;
                        double s_min_150948 = ((double *) tS_mem_164929.mem)[slice_151502];
                        int64_t slice_151501 = tS_start_150427 + max_res_150958;
                        double s_max_150963 = ((double *) tS_mem_164929.mem)[slice_151501];
                        int64_t slice_151500 = tS_start_150427 + min_res_150964;
                        double s_nextMin_150969 = ((double *) tS_mem_164929.mem)[slice_151500];
                        int64_t slice_151499 = tS_start_150427 + max_res_150971;
                        double s_prevMax_150976 = ((double *) tS_mem_164929.mem)[slice_151499];
                        bool defunc_0_gt_res_150977 = r_max_150868 < s_max_150963;
                        bool loopres_150978;
                        int64_t loopres_150979;
                        
                        if (defunc_0_gt_res_150977) {
                            bool defunc_0_leq_res_157770 = s_min_150948 <= r_max_150868;
                            bool loopres_t_res_157771;
                            int64_t loopres_t_res_157772;
                            
                            if (defunc_0_leq_res_157770) {
                                loopres_t_res_157771 = 0;
                                loopres_t_res_157772 = lm_150937;
                            } else {
                                bool defunc_0_leq_res_157773 = s_prevMax_150976 <= r_max_150868;
                                int64_t zlze_lhs_157774 = sub64(lm_150937, (int64_t) 1);
                                bool tmp_f_res_157775 = sle64(zlze_lhs_157774, (int64_t) 0);
                                bool x_157776 = !defunc_0_leq_res_157773;
                                bool y_157777 = tmp_f_res_157775 && x_157776;
                                bool tmp_157778 = defunc_0_leq_res_157773 || y_157777;
                                int64_t max_res_157779 = smax64((int64_t) 0, zlze_lhs_157774);
                                bool loopres_t_res_f_res_157780 = !tmp_157778;
                                
                                loopres_t_res_157771 = loopres_t_res_f_res_157780;
                                loopres_t_res_157772 = max_res_157779;
                            }
                            loopres_150978 = loopres_t_res_157771;
                            loopres_150979 = loopres_t_res_157772;
                        } else {
                            bool defunc_0_leq_res_150991 = r_max_150868 <= s_nextMin_150969;
                            int64_t tmp_150992 = add64((int64_t) 1, lm_150937);
                            bool loopres_f_res_150993 = !defunc_0_leq_res_150991;
                            
                            loopres_150978 = loopres_f_res_150993;
                            loopres_150979 = tmp_150992;
                        }
                        
                        bool loop_cond_t_res_150994 = slt64(loopres_150979, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool x_150995 = loopres_150978 && loop_cond_t_res_150994;
                        bool loop_while_tmp_165747 = x_150995;
                        int64_t lm_tmp_165748 = loopres_150979;
                        
                        loop_while_150936 = loop_while_tmp_165747;
                        lm_150937 = lm_tmp_165748;
                    }
                    defunc_0_f_res_150934 = loop_while_150936;
                    defunc_0_f_res_150935 = lm_150937;
                    ((int64_t *) mem_164985)[i_164733] = defunc_0_f_res_150870;
                    ((int64_t *) mem_164987)[i_164733] = defunc_0_f_res_150935;
                }
                
                int64_t ext_165121;
                int64_t ext_165120;
                int64_t ext_165119;
                int64_t ext_165118;
                bool defunc_0_join_chunks_res_150999;
                int64_t defunc_0_join_chunks_res_151000;
                bool loop_while_151003;
                int64_t p_151004;
                int64_t ctx_param_ext_165000;
                int64_t ctx_param_ext_165001;
                int64_t ctx_param_ext_165003;
                int64_t ctx_param_ext_165004;
                
                if (memblock_set(ctx, &mem_param_165002, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165005, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165000 = (int64_t) 0;
                ctx_param_ext_165001 = (int64_t) 1;
                ctx_param_ext_165003 = (int64_t) 0;
                ctx_param_ext_165004 = (int64_t) 1;
                loop_while_151003 = loop_cond_150998;
                p_151004 = (int64_t) 0;
                while (loop_while_151003) {
                    bool x_151007 = sle64((int64_t) 0, p_151004);
                    bool y_151008 = slt64(p_151004, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151009 = x_151007 && y_151008;
                    bool index_certs_151010;
                    
                    if (!bounds_check_151009) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:334:22-34\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t loopres_151011 = ((int64_t *) mem_164985)[p_151004];
                    int64_t loopres_151012 = ((int64_t *) mem_164987)[p_151004];
                    int64_t min_res_151013 = smin64(zeze_rhs_150843, loopres_151012);
                    bool cond_151014 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, loopres_151011);
                    bool cond_151018 = slt64(min_res_151013, (int64_t) 0);
                    bool protect_assert_disj_151020 = bounds_check_151009 || cond_151018;
                    bool protect_assert_disj_165535 = cond_151014 || protect_assert_disj_151020;
                    bool index_certs_151021;
                    
                    if (!protect_assert_disj_165535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:338:19-32\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_151024 = add64((int64_t) 1, p_151004);
                    bool cond_151025 = zeze_lhs_151024 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    bool x_151027 = sle64((int64_t) 0, zeze_lhs_151024);
                    bool y_151028 = slt64(zeze_lhs_151024, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151029 = x_151027 && y_151028;
                    bool protect_assert_disj_151030 = cond_151025 || bounds_check_151029;
                    bool protect_assert_disj_151031 = cond_151018 || protect_assert_disj_151030;
                    bool protect_assert_disj_165538 = cond_151014 || protect_assert_disj_151031;
                    bool index_certs_151032;
                    
                    if (!protect_assert_disj_165538) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151024, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:339:49-64\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_165532 = !cond_151014;
                    bool x_151019 = !cond_151018;
                    bool protect_cond_conj_165536 = x_151019 && x_165532;
                    int64_t loopres_f_res_f_res_151022;
                    
                    if (protect_cond_conj_165536) {
                        int64_t x_157781 = ((int64_t *) mem_164942)[p_151004];
                        
                        loopres_f_res_f_res_151022 = x_157781;
                    } else {
                        loopres_f_res_f_res_151022 = (int64_t) 0;
                    }
                    
                    bool x_151026 = !cond_151025;
                    bool protect_cond_conj_151033 = x_151019 && x_151026;
                    bool protect_cond_conj_165539 = protect_cond_conj_151033 && x_165532;
                    int64_t r_end_f_res_151034;
                    
                    if (protect_cond_conj_165539) {
                        int64_t x_157782 = ((int64_t *) mem_164942)[zeze_lhs_151024];
                        
                        r_end_f_res_151034 = x_157782;
                    } else {
                        r_end_f_res_151034 = (int64_t) 0;
                    }
                    
                    int64_t r_end_151036;
                    
                    if (cond_151025) {
                        r_end_151036 = nR_136036;
                    } else {
                        r_end_151036 = r_end_f_res_151034;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 = sub64(r_end_151036, loopres_f_res_f_res_151022);
                    int64_t ext_165110;
                    
                    if (cond_151018) {
                        ext_165110 = ctx_param_ext_165000;
                    } else {
                        ext_165110 = (int64_t) 0;
                    }
                    
                    int64_t ext_165109;
                    
                    if (cond_151018) {
                        ext_165109 = ctx_param_ext_165001;
                    } else {
                        ext_165109 = (int64_t) 1;
                    }
                    
                    int64_t ext_165107;
                    
                    if (cond_151018) {
                        ext_165107 = ctx_param_ext_165003;
                    } else {
                        ext_165107 = (int64_t) 0;
                    }
                    
                    int64_t ext_165106;
                    
                    if (cond_151018) {
                        ext_165106 = ctx_param_ext_165004;
                    } else {
                        ext_165106 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165006 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037;
                    int64_t ext_165116;
                    
                    if (cond_151014) {
                        ext_165116 = ctx_param_ext_165000;
                    } else {
                        ext_165116 = ext_165110;
                    }
                    
                    int64_t ext_165115;
                    
                    if (cond_151014) {
                        ext_165115 = ctx_param_ext_165001;
                    } else {
                        ext_165115 = ext_165109;
                    }
                    
                    int64_t ext_165113;
                    
                    if (cond_151014) {
                        ext_165113 = ctx_param_ext_165003;
                    } else {
                        ext_165113 = ext_165107;
                    }
                    
                    int64_t ext_165112;
                    
                    if (cond_151014) {
                        ext_165112 = ctx_param_ext_165004;
                    } else {
                        ext_165112 = ext_165106;
                    }
                    
                    int64_t loopres_151015;
                    
                    if (cond_151014) {
                        loopres_151015 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    } else {
                        loopres_151015 = zeze_lhs_151024;
                    }
                    if (cond_151014) {
                        if (memblock_set(ctx, &ext_mem_165117, &mem_param_165002, "mem_param_165002") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &mem_param_165005, "mem_param_165005") != 0)
                            return 1;
                    } else {
                        if (cond_151018) {
                            if (memblock_set(ctx, &ext_mem_165111, &mem_param_165002, "mem_param_165002") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_param_165005, "mem_param_165005") != 0)
                                return 1;
                        } else {
                            bool empty_slice_151040 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 == (int64_t) 0;
                            int64_t m_151041 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, (int64_t) 1);
                            int64_t i_p_m_t_s_151042 = add64(loopres_f_res_f_res_151022, m_151041);
                            bool zzero_leq_i_p_m_t_s_151043 = sle64((int64_t) 0, i_p_m_t_s_151042);
                            bool i_p_m_t_s_leq_w_151044 = slt64(i_p_m_t_s_151042, nR_136036);
                            bool zzero_lte_i_151045 = sle64((int64_t) 0, loopres_f_res_f_res_151022);
                            bool i_lte_j_151046 = sle64(loopres_f_res_f_res_151022, r_end_151036);
                            bool y_151047 = i_p_m_t_s_leq_w_151044 && zzero_lte_i_151045;
                            bool y_151048 = zzero_leq_i_p_m_t_s_151043 && y_151047;
                            bool forwards_ok_151049 = i_lte_j_151046 && y_151048;
                            bool ok_or_empty_151050 = empty_slice_151040 || forwards_ok_151049;
                            bool index_certs_151051;
                            
                            if (!ok_or_empty_151050) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_151022, ":", (long long) r_end_151036, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:340:16-33\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_151054 = sle64(loopres_151011, min_res_151013);
                            bool loop_not_taken_151059 = !loop_cond_151054;
                            bool protect_assert_disj_151060 = loop_not_taken_151059 || nonzzero_157453;
                            bool nonzzero_cert_151061;
                            
                            if (!protect_assert_disj_151060) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165759 = 0; nest_i_165759 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165759++) {
                                ((int64_t *) mem_165007.mem)[nest_i_165759] = (int64_t) -1;
                            }
                            if (memblock_alloc(ctx, &mem_165009, bytes_165006, "mem_165009")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165760 = 0; nest_i_165760 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165760++) {
                                ((int64_t *) mem_165009.mem)[nest_i_165760] = (int64_t) 0;
                            }
                            
                            int64_t zm_lhs_151055 = add64(extParallelism_136044, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                            int64_t zs_lhs_151056 = sub64(zm_lhs_151055, (int64_t) 1);
                            int64_t numIter_151062 = sdiv_safe64(zs_lhs_151056, extParallelism_136044);
                            bool loop_cond_151063 = slt64((int64_t) 0, numIter_151062);
                            bool loop_not_taken_151064 = !loop_cond_151063;
                            bool loopres_f_res_f_res_151065;
                            int64_t loopres_f_res_f_res_151066;
                            bool loop_while_151069;
                            int64_t dp_151070;
                            
                            if (memblock_set(ctx, &mem_param_165012, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_165015, &mem_165007, "mem_165007") != 0)
                                return 1;
                            loop_while_151069 = loop_cond_151054;
                            dp_151070 = loopres_151011;
                            while (loop_while_151069) {
                                bool x_151073 = sle64((int64_t) 0, dp_151070);
                                bool y_151074 = slt64(dp_151070, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151075 = x_151073 && y_151074;
                                bool index_certs_151076;
                                
                                if (!bounds_check_151075) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_151070, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:344:21-38\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_151077 = ((int64_t *) mem_164944)[dp_151070];
                                int64_t zeze_lhs_151078 = add64((int64_t) 1, dp_151070);
                                bool cond_151079 = zeze_lhs_151078 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                                bool x_151080 = !cond_151079;
                                bool x_151081 = sle64((int64_t) 0, zeze_lhs_151078);
                                bool y_151082 = slt64(zeze_lhs_151078, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151083 = x_151081 && y_151082;
                                bool protect_assert_disj_151084 = cond_151079 || bounds_check_151083;
                                bool index_certs_151085;
                                
                                if (!protect_assert_disj_151084) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151078, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:345:55-74\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_151086;
                                
                                if (x_151080) {
                                    int64_t x_157783 = ((int64_t *) mem_164944)[zeze_lhs_151078];
                                    
                                    s_end_f_res_151086 = x_157783;
                                } else {
                                    s_end_f_res_151086 = (int64_t) 0;
                                }
                                
                                int64_t s_end_151088;
                                
                                if (cond_151079) {
                                    s_end_151088 = nR_136036;
                                } else {
                                    s_end_151088 = s_end_f_res_151086;
                                }
                                
                                int64_t j_m_i_151089 = sub64(s_end_151088, loopres_151077);
                                bool empty_slice_151090 = j_m_i_151089 == (int64_t) 0;
                                int64_t m_151091 = sub64(j_m_i_151089, (int64_t) 1);
                                int64_t i_p_m_t_s_151092 = add64(loopres_151077, m_151091);
                                bool zzero_leq_i_p_m_t_s_151093 = sle64((int64_t) 0, i_p_m_t_s_151092);
                                bool i_p_m_t_s_leq_w_151094 = slt64(i_p_m_t_s_151092, nR_136036);
                                bool zzero_lte_i_151095 = sle64((int64_t) 0, loopres_151077);
                                bool i_lte_j_151096 = sle64(loopres_151077, s_end_151088);
                                bool y_151097 = i_p_m_t_s_leq_w_151094 && zzero_lte_i_151095;
                                bool y_151098 = zzero_leq_i_p_m_t_s_151093 && y_151097;
                                bool forwards_ok_151099 = i_lte_j_151096 && y_151098;
                                bool ok_or_empty_151100 = empty_slice_151090 || forwards_ok_151099;
                                bool index_certs_151101;
                                
                                if (!ok_or_empty_151100) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151077, ":", (long long) s_end_151088, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  ftSMJ.fut:346:18-35\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_151104 = slt64((int64_t) 0, j_m_i_151089);
                                bool loop_not_taken_151105 = !cond_151104;
                                bool x_151106 = sle64((int64_t) 0, m_151091);
                                bool y_151107 = slt64(m_151091, j_m_i_151089);
                                bool bounds_check_151111 = x_151106 && y_151107;
                                bool protect_assert_disj_151112 = loop_not_taken_151105 || bounds_check_151111;
                                bool protect_assert_disj_151113 = loop_not_taken_151064 || protect_assert_disj_151112;
                                bool index_certs_151114;
                                
                                if (!protect_assert_disj_151113) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151091, "] out of bounds for array of shape [", (long long) j_m_i_151089, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_151498 = tS_start_150427 + loopres_151077;
                                int64_t find_joinTuples_arg3_151103 = add64(join_chunks_arg3_150568, loopres_151077);
                                bool protect_cond_conj_151108 = loop_cond_151063 && cond_151104;
                                double s_min_t_res_151109;
                                
                                if (protect_cond_conj_151108) {
                                    double x_157784 = ((double *) tS_mem_164929.mem)[slice_151498];
                                    
                                    s_min_t_res_151109 = x_157784;
                                } else {
                                    s_min_t_res_151109 = 0.0;
                                }
                                
                                double s_max_t_res_151115;
                                
                                if (protect_cond_conj_151108) {
                                    int64_t slice_157785 = tS_start_150427 + i_p_m_t_s_151092;
                                    double x_157786 = ((double *) tS_mem_164929.mem)[slice_157785];
                                    
                                    s_max_t_res_151115 = x_157786;
                                } else {
                                    s_max_t_res_151115 = 0.0;
                                }
                                
                                int64_t bytes_165022 = (int64_t) 8 * j_m_i_151089;
                                int64_t ext_165061;
                                int64_t ext_165060;
                                int64_t ext_165059;
                                int64_t ext_165058;
                                bool defunc_0_find_joinTuples_res_151117;
                                int64_t defunc_0_find_joinTuples_res_151118;
                                bool loop_while_151121;
                                int64_t p_151122;
                                int64_t ctx_param_ext_165016;
                                int64_t ctx_param_ext_165017;
                                int64_t ctx_param_ext_165019;
                                int64_t ctx_param_ext_165020;
                                
                                if (memblock_set(ctx, &mem_param_165018, &mem_165009, "mem_165009") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165021, &mem_165007, "mem_165007") != 0)
                                    return 1;
                                ctx_param_ext_165016 = (int64_t) 0;
                                ctx_param_ext_165017 = (int64_t) 1;
                                ctx_param_ext_165019 = (int64_t) 0;
                                ctx_param_ext_165020 = (int64_t) 1;
                                loop_while_151121 = loop_cond_151063;
                                p_151122 = (int64_t) 0;
                                while (loop_while_151121) {
                                    int64_t start_151125 = mul64(extParallelism_136044, p_151122);
                                    int64_t min_arg1_151126 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, start_151125);
                                    int64_t min_res_151127 = smin64(extParallelism_136044, min_arg1_151126);
                                    int64_t iter_R_151128 = add64(start_151125, min_res_151127);
                                    bool empty_slice_151129 = min_res_151127 == (int64_t) 0;
                                    int64_t m_151130 = sub64(min_res_151127, (int64_t) 1);
                                    int64_t i_p_m_t_s_151131 = add64(start_151125, m_151130);
                                    bool zzero_leq_i_p_m_t_s_151132 = sle64((int64_t) 0, i_p_m_t_s_151131);
                                    bool i_p_m_t_s_leq_w_151133 = slt64(i_p_m_t_s_151131, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                                    bool zzero_lte_i_151134 = sle64((int64_t) 0, start_151125);
                                    bool i_lte_j_151135 = sle64(start_151125, iter_R_151128);
                                    bool y_151136 = i_p_m_t_s_leq_w_151133 && zzero_lte_i_151134;
                                    bool y_151137 = zzero_leq_i_p_m_t_s_151132 && y_151136;
                                    bool forwards_ok_151138 = i_lte_j_151135 && y_151137;
                                    bool ok_or_empty_151139 = empty_slice_151129 || forwards_ok_151138;
                                    bool index_certs_151140;
                                    
                                    if (!ok_or_empty_151139) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_151125, ":", (long long) iter_R_151128, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151147 = slt64(m_151130, min_res_151127);
                                    bool x_151146 = sle64((int64_t) 0, m_151130);
                                    bool bounds_check_151148 = x_151146 && y_151147;
                                    bool index_certs_151149;
                                    
                                    if (!bounds_check_151148) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151130, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151143 = slt64((int64_t) 0, min_res_151127);
                                    bool index_certs_151144;
                                    
                                    if (!y_151143) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:210:133-136\n   #2  ftRelational.fut:199:1-210:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_151141 = loopres_f_res_f_res_151022 + start_151125;
                                    int64_t slice_151150 = loopres_f_res_f_res_151022 + i_p_m_t_s_151131;
                                    double r_max_151151 = ((double *) tR_mem_164928.mem)[slice_151150];
                                    double s_max_151153;
                                    
                                    if (cond_151104) {
                                        s_max_151153 = s_max_t_res_151115;
                                    } else {
                                        s_max_151153 = r_max_151151;
                                    }
                                    
                                    double r_min_151145 = ((double *) tR_mem_164928.mem)[slice_151141];
                                    bool defunc_0_gt_res_151154 = s_max_151153 < r_min_151145;
                                    double s_min_151152;
                                    
                                    if (cond_151104) {
                                        s_min_151152 = s_min_t_res_151109;
                                    } else {
                                        s_min_151152 = r_min_151145;
                                    }
                                    
                                    bool defunc_0_gt_res_151158 = r_max_151151 < s_min_151152;
                                    int64_t ext_165050;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165050 = ctx_param_ext_165016;
                                    } else {
                                        ext_165050 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165049;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165049 = ctx_param_ext_165017;
                                    } else {
                                        ext_165049 = (int64_t) 1;
                                    }
                                    
                                    int64_t ext_165047;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165047 = ctx_param_ext_165019;
                                    } else {
                                        ext_165047 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165046;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165046 = ctx_param_ext_165020;
                                    } else {
                                        ext_165046 = (int64_t) 1;
                                    }
                                    
                                    int64_t bytes_165026 = (int64_t) 8 * min_res_151127;
                                    int64_t ext_165056;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165056 = ctx_param_ext_165016;
                                    } else {
                                        ext_165056 = ext_165050;
                                    }
                                    
                                    int64_t ext_165055;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165055 = ctx_param_ext_165017;
                                    } else {
                                        ext_165055 = ext_165049;
                                    }
                                    
                                    int64_t ext_165053;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165053 = ctx_param_ext_165019;
                                    } else {
                                        ext_165053 = ext_165047;
                                    }
                                    
                                    int64_t ext_165052;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165052 = ctx_param_ext_165020;
                                    } else {
                                        ext_165052 = ext_165046;
                                    }
                                    
                                    int64_t loopres_151155;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        if (memblock_set(ctx, &ext_mem_165057, &mem_param_165018, "mem_param_165018") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &mem_param_165021, "mem_param_165021") != 0)
                                            return 1;
                                        loopres_151155 = numIter_151062;
                                    } else {
                                        int64_t loopres_f_res_151159;
                                        
                                        if (defunc_0_gt_res_151158) {
                                            int64_t tmp_157789 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_param_165018, "mem_param_165018") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_param_165021, "mem_param_165021") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_157789;
                                        } else {
                                            if (memblock_alloc(ctx, &mem_165023, bytes_165022, "mem_165023")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) tS_mem_164929.mem, slice_151498, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151089});
                                            if (futrts_indicesWithIncrement_12227(ctx, &ext_mem_165025, mem_165023, j_m_i_151089, find_joinTuples_arg3_151103) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
                                                return 1;
                                            if (mem_165027_cached_sizze_165998 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165027, &mem_165027_cached_sizze_165998, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            if (mem_165029_cached_sizze_165999 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_165999, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            for (int64_t i_164744 = 0; i_164744 < min_res_151127; i_164744++) {
                                                int64_t slice_164903 = slice_151141 + i_164744;
                                                double eta_p_151167 = ((double *) tR_mem_164928.mem)[slice_164903];
                                                int64_t defunc_0_reduce_comm_res_157790;
                                                double defunc_0_reduce_comm_res_157791;
                                                int64_t defunc_0_reduce_comm_res_157792;
                                                int64_t redout_164736;
                                                double redout_164737;
                                                int64_t redout_164738;
                                                
                                                redout_164736 = (int64_t) -1;
                                                redout_164737 = eta_p_151167;
                                                redout_164738 = (int64_t) 0;
                                                for (int64_t i_164739 = 0; i_164739 < j_m_i_151089; i_164739++) {
                                                    int64_t x_151171 = ((int64_t *) ext_mem_165025.mem)[i_164739];
                                                    int64_t slice_164902 = slice_151498 + i_164739;
                                                    double x_151172 = ((double *) tS_mem_164929.mem)[slice_164902];
                                                    bool defunc_0_neq_res_151180 = redout_164737 == eta_p_151167;
                                                    bool defunc_0_neq_res_151181 = !defunc_0_neq_res_151180;
                                                    bool cond_f_res_151182 = slt64(redout_164736, (int64_t) 0);
                                                    bool y_151183 = defunc_0_neq_res_151180 && cond_f_res_151182;
                                                    bool cond_151184 = defunc_0_neq_res_151181 || y_151183;
                                                    bool defunc_0_neq_res_151185 = x_151172 == eta_p_151167;
                                                    bool defunc_0_neq_res_151186 = !defunc_0_neq_res_151185;
                                                    bool cond_t_res_f_res_151187 = slt64(x_151171, (int64_t) 0);
                                                    bool y_151188 = defunc_0_neq_res_151185 && cond_t_res_f_res_151187;
                                                    bool cond_t_res_151189 = defunc_0_neq_res_151186 || y_151188;
                                                    bool x_151190 = cond_151184 && cond_t_res_151189;
                                                    int64_t defunc_0_op_res_151191;
                                                    double defunc_0_op_res_151192;
                                                    int64_t defunc_0_op_res_151193;
                                                    
                                                    if (x_151190) {
                                                        defunc_0_op_res_151191 = (int64_t) -1;
                                                        defunc_0_op_res_151192 = eta_p_151167;
                                                        defunc_0_op_res_151193 = (int64_t) 0;
                                                    } else {
                                                        int64_t defunc_0_op_res_f_res_151194;
                                                        double defunc_0_op_res_f_res_151195;
                                                        int64_t defunc_0_op_res_f_res_151196;
                                                        
                                                        if (cond_151184) {
                                                            defunc_0_op_res_f_res_151194 = x_151171;
                                                            defunc_0_op_res_f_res_151195 = x_151172;
                                                            defunc_0_op_res_f_res_151196 = (int64_t) 1;
                                                        } else {
                                                            double defunc_0_op_res_f_res_f_res_151197;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151197 = redout_164737;
                                                            } else {
                                                                defunc_0_op_res_f_res_f_res_151197 = eta_p_151167;
                                                            }
                                                            
                                                            int64_t defunc_0_op_res_f_res_f_res_151198;
                                                            int64_t defunc_0_op_res_f_res_f_res_151199;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151198 = redout_164736;
                                                                defunc_0_op_res_f_res_f_res_151199 = redout_164738;
                                                            } else {
                                                                int64_t min_res_151200 = smin64(x_151171, redout_164736);
                                                                int64_t tmp_151201 = add64((int64_t) 1, redout_164738);
                                                                
                                                                defunc_0_op_res_f_res_f_res_151198 = min_res_151200;
                                                                defunc_0_op_res_f_res_f_res_151199 = tmp_151201;
                                                            }
                                                            defunc_0_op_res_f_res_151194 = defunc_0_op_res_f_res_f_res_151198;
                                                            defunc_0_op_res_f_res_151195 = defunc_0_op_res_f_res_f_res_151197;
                                                            defunc_0_op_res_f_res_151196 = defunc_0_op_res_f_res_f_res_151199;
                                                        }
                                                        defunc_0_op_res_151191 = defunc_0_op_res_f_res_151194;
                                                        defunc_0_op_res_151192 = defunc_0_op_res_f_res_151195;
                                                        defunc_0_op_res_151193 = defunc_0_op_res_f_res_151196;
                                                    }
                                                    
                                                    int64_t redout_tmp_165779 = defunc_0_op_res_151191;
                                                    double redout_tmp_165780 = defunc_0_op_res_151192;
                                                    int64_t redout_tmp_165781 = defunc_0_op_res_151193;
                                                    
                                                    redout_164736 = redout_tmp_165779;
                                                    redout_164737 = redout_tmp_165780;
                                                    redout_164738 = redout_tmp_165781;
                                                }
                                                defunc_0_reduce_comm_res_157790 = redout_164736;
                                                defunc_0_reduce_comm_res_157791 = redout_164737;
                                                defunc_0_reduce_comm_res_157792 = redout_164738;
                                                ((int64_t *) mem_165027)[i_164744] = defunc_0_reduce_comm_res_157790;
                                                ((int64_t *) mem_165029)[i_164744] = defunc_0_reduce_comm_res_157792;
                                            }
                                            if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
                                                return 1;
                                            if (memblock_alloc(ctx, &mem_165043, bytes_165006, "mem_165043")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165021.mem, ctx_param_ext_165019, (int64_t []) {ctx_param_ext_165020}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165027, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            if (memblock_alloc(ctx, &mem_165045, bytes_165006, "mem_165045")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165018.mem, ctx_param_ext_165016, (int64_t []) {ctx_param_ext_165017}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165029, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            
                                            int64_t tmp_151206 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_165045, "mem_165045") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_165043, "mem_165043") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_151206;
                                        }
                                        if (memblock_set(ctx, &ext_mem_165057, &ext_mem_165051, "ext_mem_165051") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &ext_mem_165048, "ext_mem_165048") != 0)
                                            return 1;
                                        loopres_151155 = loopres_f_res_151159;
                                    }
                                    
                                    bool loop_cond_151207 = slt64(loopres_151155, numIter_151062);
                                    
                                    if (memblock_set(ctx, &mem_param_tmp_165767, &ext_mem_165057, "ext_mem_165057") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_tmp_165768, &ext_mem_165054, "ext_mem_165054") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_165769 = ext_165056;
                                    int64_t ctx_param_ext_tmp_165770 = ext_165055;
                                    int64_t ctx_param_ext_tmp_165771 = ext_165053;
                                    int64_t ctx_param_ext_tmp_165772 = ext_165052;
                                    bool loop_while_tmp_165773 = loop_cond_151207;
                                    int64_t p_tmp_165774 = loopres_151155;
                                    
                                    if (memblock_set(ctx, &mem_param_165018, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_165021, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
                                        return 1;
                                    ctx_param_ext_165016 = ctx_param_ext_tmp_165769;
                                    ctx_param_ext_165017 = ctx_param_ext_tmp_165770;
                                    ctx_param_ext_165019 = ctx_param_ext_tmp_165771;
                                    ctx_param_ext_165020 = ctx_param_ext_tmp_165772;
                                    loop_while_151121 = loop_while_tmp_165773;
                                    p_151122 = p_tmp_165774;
                                }
                                if (memblock_set(ctx, &ext_mem_165063, &mem_param_165018, "mem_param_165018") != 0)
                                    return 1;
                                if (memblock_set(ctx, &ext_mem_165062, &mem_param_165021, "mem_param_165021") != 0)
                                    return 1;
                                ext_165061 = ctx_param_ext_165016;
                                ext_165060 = ctx_param_ext_165017;
                                ext_165059 = ctx_param_ext_165019;
                                ext_165058 = ctx_param_ext_165020;
                                defunc_0_find_joinTuples_res_151117 = loop_while_151121;
                                defunc_0_find_joinTuples_res_151118 = p_151122;
                                if (memblock_alloc(ctx, &mem_165065, bytes_165006, "mem_165065")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164749 = 0; i_164749 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164749++) {
                                    int64_t eta_p_151209 = ((int64_t *) mem_param_165015.mem)[i_164749];
                                    int64_t eta_p_151210 = ((int64_t *) ext_mem_165062.mem)[ext_165059 + i_164749 * ext_165058];
                                    bool cond_151211 = slt64(eta_p_151209, (int64_t) 0);
                                    int64_t lifted_lambda_res_151212;
                                    
                                    if (cond_151211) {
                                        lifted_lambda_res_151212 = eta_p_151210;
                                    } else {
                                        lifted_lambda_res_151212 = eta_p_151209;
                                    }
                                    ((int64_t *) mem_165065.mem)[i_164749] = lifted_lambda_res_151212;
                                }
                                if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
                                    return 1;
                                if (memblock_alloc(ctx, &mem_165073, bytes_165006, "mem_165073")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164753 = 0; i_164753 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164753++) {
                                    int64_t eta_p_151214 = ((int64_t *) mem_param_165012.mem)[i_164753];
                                    int64_t eta_p_151215 = ((int64_t *) ext_mem_165063.mem)[ext_165061 + i_164753 * ext_165060];
                                    int64_t defunc_0_f_res_151216 = add64(eta_p_151214, eta_p_151215);
                                    
                                    ((int64_t *) mem_165073.mem)[i_164753] = defunc_0_f_res_151216;
                                }
                                if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
                                    return 1;
                                
                                bool loop_cond_151217 = sle64(zeze_lhs_151078, min_res_151013);
                                
                                if (memblock_set(ctx, &mem_param_tmp_165761, &mem_165073, "mem_165073") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_tmp_165762, &mem_165065, "mem_165065") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_165763 = loop_cond_151217;
                                int64_t dp_tmp_165764 = zeze_lhs_151078;
                                
                                if (memblock_set(ctx, &mem_param_165012, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165015, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
                                    return 1;
                                loop_while_151069 = loop_while_tmp_165763;
                                dp_151070 = dp_tmp_165764;
                            }
                            if (memblock_set(ctx, &ext_mem_165085, &mem_param_165012, "mem_param_165012") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165084, &mem_param_165015, "mem_param_165015") != 0)
                                return 1;
                            loopres_f_res_f_res_151065 = loop_while_151069;
                            loopres_f_res_f_res_151066 = dp_151070;
                            if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
                                return 1;
                            if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (mem_165087_cached_sizze_166000 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165087, &mem_165087_cached_sizze_166000, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164757 = 0; i_164757 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164757++) {
                                int64_t slice_164901 = loopres_f_res_f_res_151022 + i_164757;
                                int64_t eta_p_151220 = ((int64_t *) mem_param_165005.mem)[ctx_param_ext_165003 + slice_164901 * ctx_param_ext_165004];
                                int64_t eta_p_151221 = ((int64_t *) ext_mem_165084.mem)[i_164757];
                                bool cond_151222 = slt64(eta_p_151220, (int64_t) 0);
                                int64_t lifted_lambda_res_151223;
                                
                                if (cond_151222) {
                                    lifted_lambda_res_151223 = eta_p_151221;
                                } else {
                                    lifted_lambda_res_151223 = eta_p_151220;
                                }
                                ((int64_t *) mem_165087)[i_164757] = lifted_lambda_res_151223;
                            }
                            if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
                                return 1;
                            if (mem_165095_cached_sizze_166001 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165095, &mem_165095_cached_sizze_166001, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164761 = 0; i_164761 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164761++) {
                                int64_t slice_164900 = loopres_f_res_f_res_151022 + i_164761;
                                int64_t eta_p_151226 = ((int64_t *) mem_param_165002.mem)[ctx_param_ext_165000 + slice_164900 * ctx_param_ext_165001];
                                int64_t eta_p_151227 = ((int64_t *) ext_mem_165085.mem)[i_164761];
                                int64_t defunc_0_f_res_151228 = add64(eta_p_151226, eta_p_151227);
                                
                                ((int64_t *) mem_165095)[i_164761] = defunc_0_f_res_151228;
                            }
                            if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165103, bytes_164931, "mem_165103")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165005.mem, ctx_param_ext_165003, (int64_t []) {ctx_param_ext_165004}, (int64_t []) {nR_136036});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165087, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_alloc(ctx, &mem_165105, bytes_164931, "mem_165105")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165002.mem, ctx_param_ext_165000, (int64_t []) {ctx_param_ext_165001}, (int64_t []) {nR_136036});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165095, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_set(ctx, &ext_mem_165111, &mem_165105, "mem_165105") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_165103, "mem_165103") != 0)
                                return 1;
                        }
                        if (memblock_set(ctx, &ext_mem_165117, &ext_mem_165111, "ext_mem_165111") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &ext_mem_165108, "ext_mem_165108") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_151233 = slt64(loopres_151015, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165749, &ext_mem_165117, "ext_mem_165117") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165750, &ext_mem_165114, "ext_mem_165114") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165751 = ext_165116;
                    int64_t ctx_param_ext_tmp_165752 = ext_165115;
                    int64_t ctx_param_ext_tmp_165753 = ext_165113;
                    int64_t ctx_param_ext_tmp_165754 = ext_165112;
                    bool loop_while_tmp_165755 = loop_cond_151233;
                    int64_t p_tmp_165756 = loopres_151015;
                    
                    if (memblock_set(ctx, &mem_param_165002, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165005, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
                        return 1;
                    ctx_param_ext_165000 = ctx_param_ext_tmp_165751;
                    ctx_param_ext_165001 = ctx_param_ext_tmp_165752;
                    ctx_param_ext_165003 = ctx_param_ext_tmp_165753;
                    ctx_param_ext_165004 = ctx_param_ext_tmp_165754;
                    loop_while_151003 = loop_while_tmp_165755;
                    p_151004 = p_tmp_165756;
                }
                if (memblock_set(ctx, &ext_mem_165123, &mem_param_165002, "mem_param_165002") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165122, &mem_param_165005, "mem_param_165005") != 0)
                    return 1;
                ext_165121 = ctx_param_ext_165000;
                ext_165120 = ctx_param_ext_165001;
                ext_165119 = ctx_param_ext_165003;
                ext_165118 = ctx_param_ext_165004;
                defunc_0_join_chunks_res_150999 = loop_while_151003;
                defunc_0_join_chunks_res_151000 = p_151004;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165123, "ext_mem_165123") != 0)
                    return 1;
                ext_165176 = ext_165121;
                ext_165175 = ext_165120;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165122, "ext_mem_165122") != 0)
                    return 1;
                ext_165173 = ext_165119;
                ext_165172 = ext_165118;
            }
            if (memblock_alloc(ctx, &mem_165179, bytes_164931, "mem_165179")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164765 = 0; i_164765 < nR_136036; i_164765++) {
                int64_t eta_p_151235 = ((int64_t *) mem_param_164940.mem)[i_164765];
                int64_t eta_p_151236 = ((int64_t *) ext_mem_165174.mem)[ext_165173 + i_164765 * ext_165172];
                bool cond_151237 = slt64(eta_p_151235, (int64_t) 0);
                int64_t lifted_lambda_res_151238;
                
                if (cond_151237) {
                    lifted_lambda_res_151238 = eta_p_151236;
                } else {
                    lifted_lambda_res_151238 = eta_p_151235;
                }
                ((int64_t *) mem_165179.mem)[i_164765] = lifted_lambda_res_151238;
            }
            if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165187, bytes_164931, "mem_165187")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < nR_136036; i_164769++) {
                int64_t eta_p_151240 = ((int64_t *) mem_param_164937.mem)[i_164769];
                int64_t eta_p_151241 = ((int64_t *) ext_mem_165177.mem)[ext_165176 + i_164769 * ext_165175];
                int64_t defunc_0_f_res_151242 = add64(eta_p_151240, eta_p_151241);
                
                ((int64_t *) mem_165187.mem)[i_164769] = defunc_0_f_res_151242;
            }
            if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
                return 1;
            
            double leq_lhs_151247 = ((double *) tS_mem_164929.mem)[i_p_m_t_s_150433];
            double leq_rhs_151249 = ((double *) tR_mem_164928.mem)[gt_rhs_150410];
            bool defunc_0_leq_res_151250 = leq_lhs_151247 <= leq_rhs_151249;
            int64_t nextIter_151251;
            
            if (defunc_0_leq_res_151250) {
                int64_t nextIter_t_res_157804 = add64((int64_t) 1, p_150424);
                
                nextIter_151251 = nextIter_t_res_157804;
            } else {
                nextIter_151251 = numIter_150404;
            }
            if (memblock_set(ctx, &ext_mem_165199, &mem_165187, "mem_165187") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_165179, "mem_165179") != 0)
                return 1;
            loopres_150448 = nextIter_151251;
        }
        
        bool loop_cond_151253 = slt64(loopres_150448, numIter_150404);
        
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        
        bool loop_while_tmp_165701 = loop_cond_151253;
        int64_t p_tmp_165702 = loopres_150448;
        
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        loop_while_150423 = loop_while_tmp_165701;
        p_150424 = p_tmp_165702;
    }
    if (memblock_set(ctx, &ext_mem_165205, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165204, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    defunc_0_mergeJoin_res_150419 = loop_while_150423;
    defunc_0_mergeJoin_res_150420 = p_150424;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
        return 1;
    if (mem_165207_cached_sizze_166004 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165207, &mem_165207_cached_sizze_166004, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165209_cached_sizze_166005 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165209, &mem_165209_cached_sizze_166005, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164779;
    int64_t scanacc_164773 = (int64_t) 0;
    
    for (int64_t i_164776 = 0; i_164776 < nR_136036; i_164776++) {
        int64_t eta_p_157038 = ((int64_t *) ext_mem_165205.mem)[i_164776];
        bool lifted_lambda_res_157039 = slt64((int64_t) 0, eta_p_157038);
        int64_t defunc_0_f_res_157040 = btoi_bool_i64(lifted_lambda_res_157039);
        int64_t defunc_0_op_res_151262 = add64(defunc_0_f_res_157040, scanacc_164773);
        
        ((int64_t *) mem_165207)[i_164776] = defunc_0_op_res_151262;
        ((int64_t *) mem_165209)[i_164776] = defunc_0_f_res_157040;
        
        int64_t scanacc_tmp_165788 = defunc_0_op_res_151262;
        
        scanacc_164773 = scanacc_tmp_165788;
    }
    discard_164779 = scanacc_164773;
    
    bool protect_assert_disj_151269 = zzero_150401 || bounds_check_150413;
    bool index_certs_151270;
    
    if (!protect_assert_disj_151269) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151271;
    
    if (nonzzero_150402) {
        int64_t x_157807 = ((int64_t *) mem_165207)[gt_rhs_150410];
        
        m_f_res_151271 = x_157807;
    } else {
        m_f_res_151271 = (int64_t) 0;
    }
    
    int64_t m_151273;
    
    if (zzero_150401) {
        m_151273 = (int64_t) 0;
    } else {
        m_151273 = m_f_res_151271;
    }
    
    int64_t m_151283 = sub64(m_151273, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151285 = slt64(m_151283, nR_136036);
    bool zzero_leq_i_p_m_t_s_151284 = sle64((int64_t) 0, m_151283);
    bool y_151287 = zzero_leq_i_p_m_t_s_151284 && i_p_m_t_s_leq_w_151285;
    bool i_lte_j_151286 = sle64((int64_t) 0, m_151273);
    bool forwards_ok_151288 = i_lte_j_151286 && y_151287;
    bool eq_x_zz_151280 = (int64_t) 0 == m_f_res_151271;
    bool p_and_eq_x_y_151281 = nonzzero_150402 && eq_x_zz_151280;
    bool empty_slice_151282 = zzero_150401 || p_and_eq_x_y_151281;
    bool ok_or_empty_151289 = empty_slice_151282 || forwards_ok_151288;
    bool index_certs_151290;
    
    if (!ok_or_empty_151289) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151273, "] out of bounds for array of shape [", (long long) nR_136036, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165222 = (int64_t) 8 * m_151273;
    
    if (mem_165223_cached_sizze_166006 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165223, &mem_165223_cached_sizze_166006, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165225_cached_sizze_166007 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165225, &mem_165225_cached_sizze_166007, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165225, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165204.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165227_cached_sizze_166008 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165227, &mem_165227_cached_sizze_166008, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165227, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164930.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165229_cached_sizze_166009 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165229, &mem_165229_cached_sizze_166009, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) tR_mem_164928.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    for (int64_t write_iter_164780 = 0; write_iter_164780 < nR_136036; write_iter_164780++) {
        int64_t write_iv_164785 = ((int64_t *) mem_165209)[write_iter_164780];
        int64_t write_iv_164786 = ((int64_t *) mem_165207)[write_iter_164780];
        double write_iv_164787 = ((double *) tR_mem_164928.mem)[write_iter_164780];
        int64_t write_iv_164788 = ((int64_t *) ext_mem_164930.mem)[write_iter_164780];
        int64_t write_iv_164789 = ((int64_t *) ext_mem_165204.mem)[write_iter_164780];
        int64_t write_iv_164790 = ((int64_t *) ext_mem_165205.mem)[write_iter_164780];
        bool cond_157033 = write_iv_164785 == (int64_t) 1;
        int64_t lifted_lambda_res_157034;
        
        if (cond_157033) {
            int64_t lifted_lambda_res_t_res_157808 = sub64(write_iv_164786, (int64_t) 1);
            
            lifted_lambda_res_157034 = lifted_lambda_res_t_res_157808;
        } else {
            lifted_lambda_res_157034 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((double *) mem_165229)[lifted_lambda_res_157034] = write_iv_164787;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165227)[lifted_lambda_res_157034] = write_iv_164788;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165225)[lifted_lambda_res_157034] = write_iv_164789;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165223)[lifted_lambda_res_157034] = write_iv_164790;
        }
    }
    if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
        return 1;
    if (mem_165255_cached_sizze_166010 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165255, &mem_165255_cached_sizze_166010, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165257_cached_sizze_166011 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165257, &mem_165257_cached_sizze_166011, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165259_cached_sizze_166012 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165259, &mem_165259_cached_sizze_166012, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164807;
    int64_t discard_164808;
    int64_t scanacc_164798;
    int64_t scanacc_164799;
    
    scanacc_164798 = (int64_t) 0;
    scanacc_164799 = (int64_t) 0;
    for (int64_t i_164803 = 0; i_164803 < m_151273; i_164803++) {
        int64_t x_157043 = ((int64_t *) mem_165223)[i_164803];
        bool lifted_lambda_res_157045 = slt64((int64_t) 1, x_157043);
        int64_t defunc_0_f_res_157046 = btoi_bool_i64(lifted_lambda_res_157045);
        int64_t lifted_lambda_res_151312 = add64(x_157043, scanacc_164798);
        int64_t defunc_0_op_res_151405 = add64(defunc_0_f_res_157046, scanacc_164799);
        
        ((int64_t *) mem_165255)[i_164803] = lifted_lambda_res_151312;
        ((int64_t *) mem_165257)[i_164803] = defunc_0_op_res_151405;
        ((int64_t *) mem_165259)[i_164803] = defunc_0_f_res_157046;
        
        int64_t scanacc_tmp_165795 = lifted_lambda_res_151312;
        int64_t scanacc_tmp_165796 = defunc_0_op_res_151405;
        
        scanacc_164798 = scanacc_tmp_165795;
        scanacc_164799 = scanacc_tmp_165796;
    }
    discard_164807 = scanacc_164798;
    discard_164808 = scanacc_164799;
    if (mem_165279_cached_sizze_166013 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165279, &mem_165279_cached_sizze_166013, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164811 = 0; i_164811 < m_151273; i_164811++) {
        int64_t zv_lhs_157020 = add64((int64_t) -1, i_164811);
        int64_t tmp_157021 = smod64(zv_lhs_157020, m_151273);
        int64_t lifted_lambda_res_157022 = ((int64_t *) mem_165255)[tmp_157021];
        bool cond_157024 = i_164811 == (int64_t) 0;
        int64_t lifted_lambda_res_157025;
        
        if (cond_157024) {
            lifted_lambda_res_157025 = (int64_t) 0;
        } else {
            lifted_lambda_res_157025 = lifted_lambda_res_157022;
        }
        ((int64_t *) mem_165279)[i_164811] = lifted_lambda_res_157025;
    }
    
    bool cond_151324 = slt64((int64_t) 0, m_151273);
    bool y_151325 = slt64(m_151283, m_151273);
    bool bounds_check_151326 = zzero_leq_i_p_m_t_s_151284 && y_151325;
    bool loop_not_taken_151327 = !cond_151324;
    bool protect_assert_disj_151328 = bounds_check_151326 || loop_not_taken_151327;
    bool index_certs_151329;
    
    if (!protect_assert_disj_151328) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  ftSMJ.fut:432:10-41\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:210:133-136\n   #3  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_lhs_151330;
    
    if (cond_151324) {
        int64_t x_157809 = ((int64_t *) mem_165279)[m_151283];
        
        zp_lhs_151330 = x_157809;
    } else {
        zp_lhs_151330 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151332;
    
    if (cond_151324) {
        int64_t x_157810 = ((int64_t *) mem_165223)[m_151283];
        
        n_pairs_t_res_151332 = x_157810;
    } else {
        n_pairs_t_res_151332 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151334 = add64(zp_lhs_151330, n_pairs_t_res_151332);
    int64_t n_pairs_151335;
    
    if (cond_151324) {
        n_pairs_151335 = n_pairs_t_res_151334;
    } else {
        n_pairs_151335 = (int64_t) 0;
    }
    
    int64_t bytes_165286 = (int64_t) 8 * n_pairs_151335;
    bool zzero_151341 = scatter_psizze_136045 == (int64_t) 0;
    bool nonzzero_151342 = !zzero_151341;
    bool nonzzero_cert_151343;
    
    if (!nonzzero_151342) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:210:133-136\n   #3  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_151408 = !empty_slice_151282;
    bool protect_assert_disj_151409 = empty_slice_151282 || bounds_check_151326;
    bool index_certs_151410;
    
    if (!protect_assert_disj_151409) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151411;
    
    if (x_151408) {
        int64_t x_157815 = ((int64_t *) mem_165257)[m_151283];
        
        m_f_res_151411 = x_157815;
    } else {
        m_f_res_151411 = (int64_t) 0;
    }
    
    int64_t m_151413;
    
    if (empty_slice_151282) {
        m_151413 = (int64_t) 0;
    } else {
        m_151413 = m_f_res_151411;
    }
    
    int64_t m_151423 = sub64(m_151413, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151425 = slt64(m_151423, m_151273);
    bool zzero_leq_i_p_m_t_s_151424 = sle64((int64_t) 0, m_151423);
    bool y_151427 = zzero_leq_i_p_m_t_s_151424 && i_p_m_t_s_leq_w_151425;
    bool i_lte_j_151426 = sle64((int64_t) 0, m_151413);
    bool forwards_ok_151428 = i_lte_j_151426 && y_151427;
    bool eq_x_zz_151420 = (int64_t) 0 == m_f_res_151411;
    bool p_and_eq_x_y_151421 = x_151408 && eq_x_zz_151420;
    bool empty_slice_151422 = empty_slice_151282 || p_and_eq_x_y_151421;
    bool ok_or_empty_151429 = empty_slice_151422 || forwards_ok_151428;
    bool index_certs_151430;
    
    if (!ok_or_empty_151429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151413, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:210:133-136\n   #4  ftRelational.fut:199:1-210:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165334 = (int64_t) 8 * m_151413;
    
    if (memblock_alloc(ctx, &mem_165287, bytes_165286, "mem_165287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165801 = 0; nest_i_165801 < n_pairs_151335; nest_i_165801++) {
        ((double *) mem_165287.mem)[nest_i_165801] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_165289, bytes_165286, "mem_165289")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165802 = 0; nest_i_165802 < n_pairs_151335; nest_i_165802++) {
        ((int64_t *) mem_165289.mem)[nest_i_165802] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_165291, bytes_165286, "mem_165291")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165803 = 0; nest_i_165803 < n_pairs_151335; nest_i_165803++) {
        ((int64_t *) mem_165291.mem)[nest_i_165803] = (int64_t) -1;
    }
    
    int64_t zm_lhs_151339 = add64(scatter_psizze_136045, n_pairs_151335);
    int64_t zs_lhs_151340 = sub64(zm_lhs_151339, (int64_t) 1);
    int64_t m_151344 = sdiv64(zs_lhs_151340, scatter_psizze_136045);
    bool loop_cond_151345 = slt64((int64_t) 0, m_151344);
    bool partitioned_scatter_res_151346;
    int64_t partitioned_scatter_res_151350;
    bool loop_while_151351;
    int64_t p_151355;
    
    loop_while_151351 = loop_cond_151345;
    p_151355 = (int64_t) 0;
    while (loop_while_151351) {
        int64_t lower_bound_151356 = mul64(scatter_psizze_136045, p_151355);
        int64_t min_arg1_151357 = add64(scatter_psizze_136045, lower_bound_151356);
        int64_t min_res_151358 = smin64(n_pairs_151335, min_arg1_151357);
        int64_t j_m_i_151359 = sub64(min_res_151358, lower_bound_151356);
        bool empty_slice_151360 = j_m_i_151359 == (int64_t) 0;
        int64_t m_151361 = sub64(j_m_i_151359, (int64_t) 1);
        int64_t i_p_m_t_s_151362 = add64(lower_bound_151356, m_151361);
        bool zzero_leq_i_p_m_t_s_151363 = sle64((int64_t) 0, i_p_m_t_s_151362);
        bool i_p_m_t_s_leq_w_151364 = slt64(i_p_m_t_s_151362, n_pairs_151335);
        bool zzero_lte_i_151365 = sle64((int64_t) 0, lower_bound_151356);
        bool i_lte_j_151366 = sle64(lower_bound_151356, min_res_151358);
        bool y_151367 = i_p_m_t_s_leq_w_151364 && zzero_lte_i_151365;
        bool y_151368 = zzero_leq_i_p_m_t_s_151363 && y_151367;
        bool forwards_ok_151369 = i_lte_j_151366 && y_151368;
        bool ok_or_empty_151370 = empty_slice_151360 || forwards_ok_151369;
        bool index_certs_151371;
        
        if (!ok_or_empty_151370) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_151356, ":", (long long) min_res_151358, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:210:133-136\n   #3  ftRelational.fut:199:1-210:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165301 = (int64_t) 8 * j_m_i_151359;
        
        if (mem_165302_cached_sizze_166014 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165302, &mem_165302_cached_sizze_166014, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165287.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165304_cached_sizze_166015 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165304, &mem_165304_cached_sizze_166015, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165289.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165306_cached_sizze_166016 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165306, &mem_165306_cached_sizze_166016, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165291.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        for (int64_t write_iter_164813 = 0; write_iter_164813 < m_151273; write_iter_164813++) {
            int64_t write_iv_164817 = ((int64_t *) mem_165279)[write_iter_164813];
            double write_iv_164818 = ((double *) mem_165229)[write_iter_164813];
            int64_t write_iv_164819 = ((int64_t *) mem_165227)[write_iter_164813];
            int64_t write_iv_164820 = ((int64_t *) mem_165225)[write_iter_164813];
            bool cond_157424 = sle64(lower_bound_151356, write_iv_164817);
            bool cond_t_res_157425 = slt64(write_iv_164817, min_res_151358);
            bool x_157426 = cond_157424 && cond_t_res_157425;
            int64_t lifted_lambda_res_157427;
            
            if (x_157426) {
                int64_t lifted_lambda_res_t_res_157811 = sub64(write_iv_164817, lower_bound_151356);
                
                lifted_lambda_res_157427 = lifted_lambda_res_t_res_157811;
            } else {
                lifted_lambda_res_157427 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((double *) mem_165302)[lifted_lambda_res_157427] = write_iv_164818;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165304)[lifted_lambda_res_157427] = write_iv_164819;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165306)[lifted_lambda_res_157427] = write_iv_164820;
            }
        }
        
        int64_t tmp_151385 = add64((int64_t) 1, p_151355);
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165287.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165289.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165291.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        
        bool loop_cond_151396 = slt64(tmp_151385, m_151344);
        bool loop_while_tmp_165804 = loop_cond_151396;
        int64_t p_tmp_165808 = tmp_151385;
        
        loop_while_151351 = loop_while_tmp_165804;
        p_151355 = p_tmp_165808;
    }
    partitioned_scatter_res_151346 = loop_while_151351;
    partitioned_scatter_res_151350 = p_151355;
    if (mem_165335_cached_sizze_166017 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165335, &mem_165335_cached_sizze_166017, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165335, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    if (mem_165337_cached_sizze_166018 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165337, &mem_165337_cached_sizze_166018, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165337, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165279, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    for (int64_t write_iter_164824 = 0; write_iter_164824 < m_151273; write_iter_164824++) {
        int64_t write_iv_164827 = ((int64_t *) mem_165259)[write_iter_164824];
        int64_t write_iv_164828 = ((int64_t *) mem_165257)[write_iter_164824];
        int64_t write_iv_164829 = ((int64_t *) mem_165279)[write_iter_164824];
        int64_t write_iv_164830 = ((int64_t *) mem_165223)[write_iter_164824];
        bool cond_157008 = write_iv_164827 == (int64_t) 1;
        int64_t lifted_lambda_res_157009;
        
        if (cond_157008) {
            int64_t lifted_lambda_res_t_res_157816 = sub64(write_iv_164828, (int64_t) 1);
            
            lifted_lambda_res_157009 = lifted_lambda_res_t_res_157816;
        } else {
            lifted_lambda_res_157009 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165337)[lifted_lambda_res_157009] = write_iv_164829;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165335)[lifted_lambda_res_157009] = write_iv_164830;
        }
    }
    
    bool cond_151440 = slt64((int64_t) 0, m_151413);
    bool loop_cond_t_res_151441 = slt64(m_151273, n_pairs_151335);
    bool x_151442 = cond_151440 && loop_cond_t_res_151441;
    bool joinTups_to_joinPairs_InnerJoin_res_151443;
    int64_t joinTups_to_joinPairs_InnerJoin_res_151447;
    bool loop_while_151448;
    int64_t p_151452;
    
    if (memblock_set(ctx, &mem_param_165352, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165355, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165358, &mem_165291, "mem_165291") != 0)
        return 1;
    loop_while_151448 = x_151442;
    p_151452 = (int64_t) 0;
    while (loop_while_151448) {
        bool x_151453 = sle64((int64_t) 0, p_151452);
        bool y_151454 = slt64(p_151452, m_151413);
        bool bounds_check_151455 = x_151453 && y_151454;
        bool index_certs_151456;
        
        if (!bounds_check_151455) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151452, "] out of bounds for array of shape [", (long long) m_151413, "].", "-> #0  ftSMJ.fut:447:13-42\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:210:133-136\n   #3  ftRelational.fut:199:1-210:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_151457 = ((int64_t *) mem_165337)[p_151452];
        int64_t loopres_151458 = ((int64_t *) mem_165335)[p_151452];
        bool x_151459 = sle64((int64_t) 0, loopres_151457);
        bool y_151460 = slt64(loopres_151457, n_pairs_151335);
        bool bounds_check_151461 = x_151459 && y_151460;
        bool index_certs_151462;
        
        if (!bounds_check_151461) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:449:52-61\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:210:133-136\n   #3  ftRelational.fut:199:1-210:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165359 = (int64_t) 8 * loopres_151458;
        int64_t tmp_151473 = add64(loopres_151457, loopres_151458);
        bool empty_slice_151477 = loopres_151458 == (int64_t) 0;
        int64_t m_151478 = sub64(loopres_151458, (int64_t) 1);
        int64_t i_p_m_t_s_151479 = add64(loopres_151457, m_151478);
        bool zzero_leq_i_p_m_t_s_151480 = sle64((int64_t) 0, i_p_m_t_s_151479);
        bool i_p_m_t_s_leq_w_151481 = slt64(i_p_m_t_s_151479, n_pairs_151335);
        bool i_lte_j_151482 = sle64(loopres_151457, tmp_151473);
        bool y_151483 = x_151459 && i_p_m_t_s_leq_w_151481;
        bool y_151484 = zzero_leq_i_p_m_t_s_151480 && y_151483;
        bool forwards_ok_151485 = i_lte_j_151482 && y_151484;
        bool ok_or_empty_151486 = empty_slice_151477 || forwards_ok_151485;
        bool index_certs_151487;
        
        if (!ok_or_empty_151486) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, ":", (long long) tmp_151473, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:453:14-55\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:210:133-136\n   #3  ftRelational.fut:199:1-210:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double loopres_151463 = ((double *) mem_param_165352.mem)[loopres_151457];
        int64_t loopres_151464 = ((int64_t *) mem_param_165355.mem)[loopres_151457];
        int64_t loopres_151465 = ((int64_t *) mem_param_165358.mem)[loopres_151457];
        
        if (mem_165360_cached_sizze_166019 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165360, &mem_165360_cached_sizze_166019, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165822 = 0; nest_i_165822 < loopres_151458; nest_i_165822++) {
            ((double *) mem_165360)[nest_i_165822] = loopres_151463;
        }
        if (mem_165362_cached_sizze_166020 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165362, &mem_165362_cached_sizze_166020, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165823 = 0; nest_i_165823 < loopres_151458; nest_i_165823++) {
            ((int64_t *) mem_165362)[nest_i_165823] = loopres_151464;
        }
        if (mem_165364_cached_sizze_166021 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165364, &mem_165364_cached_sizze_166021, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164835 = 0; i_164835 < loopres_151458; i_164835++) {
            int64_t tmp_151471 = add64(loopres_151465, i_164835);
            
            ((int64_t *) mem_165364)[i_164835] = tmp_151471;
        }
        
        int64_t tmp_151472 = add64((int64_t) 1, p_151452);
        
        if (memblock_alloc(ctx, &mem_165372, bytes_165286, "mem_165372")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165372.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165374, bytes_165286, "mem_165374")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165376, bytes_165286, "mem_165376")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165372.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165360, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165364, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        
        bool cond_151491 = slt64(tmp_151472, m_151413);
        bool x_151492 = loop_cond_t_res_151441 && cond_151491;
        
        if (memblock_set(ctx, &mem_param_tmp_165814, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165815, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165816, &mem_165376, "mem_165376") != 0)
            return 1;
        
        bool loop_while_tmp_165817 = x_151492;
        int64_t p_tmp_165821 = tmp_151472;
        
        if (memblock_set(ctx, &mem_param_165352, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165355, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165358, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        loop_while_151448 = loop_while_tmp_165817;
        p_151452 = p_tmp_165821;
    }
    if (memblock_set(ctx, &ext_mem_165385, &mem_param_165352, "mem_param_165352") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165384, &mem_param_165355, "mem_param_165355") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165383, &mem_param_165358, "mem_param_165358") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_151443 = loop_while_151448;
    joinTups_to_joinPairs_InnerJoin_res_151447 = p_151452;
    if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165387, bytes_165286, "mem_165387")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165389, bytes_165286, "mem_165389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165384.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165391, bytes_165286, "mem_165391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165383.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165389, "mem_165389") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165391, "mem_165391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165695, &mem_165387, "mem_165387") != 0)
        return 1;
    prim_out_165696 = n_pairs_151335;
    if (memblock_set(ctx, &*mem_out_p_165990, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165991, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_165992, &mem_out_165695, "mem_out_165695") != 0)
        return 1;
    *out_prim_out_165993 = prim_out_165696;
    
  cleanup:
    {
        free(mem_164942);
        free(mem_164944);
        free(mem_164985);
        free(mem_164987);
        free(mem_165027);
        free(mem_165029);
        free(mem_165087);
        free(mem_165095);
        free(mem_165135);
        free(mem_165137);
        free(mem_165207);
        free(mem_165209);
        free(mem_165223);
        free(mem_165225);
        free(mem_165227);
        free(mem_165229);
        free(mem_165255);
        free(mem_165257);
        free(mem_165259);
        free(mem_165279);
        free(mem_165302);
        free(mem_165304);
        free(mem_165306);
        free(mem_165335);
        free(mem_165337);
        free(mem_165360);
        free(mem_165362);
        free(mem_165364);
        if (memblock_unref(ctx, &mem_165391, "mem_165391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165389, "mem_165389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165387, "mem_165387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165376, "mem_165376") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165358, "mem_param_165358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165355, "mem_param_165355") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165352, "mem_param_165352") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165187, "mem_165187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165179, "mem_165179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165105, "mem_165105") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165103, "mem_165103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165073, "mem_165073") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165065, "mem_165065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165045, "mem_165045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165043, "mem_165043") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165048, "ext_mem_165048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165051, "ext_mem_165051") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165054, "ext_mem_165054") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165057, "ext_mem_165057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165021, "mem_param_165021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165018, "mem_param_165018") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165015, "mem_param_165015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165012, "mem_param_165012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165114, "ext_mem_165114") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165117, "ext_mem_165117") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165005, "mem_param_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165002, "mem_param_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165122, "ext_mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165123, "ext_mem_165123") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164969, "mem_164969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164971, "mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165153, "mem_165153") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165151, "mem_165151") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165156, "ext_mem_165156") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165159, "ext_mem_165159") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165162, "ext_mem_165162") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165165, "ext_mem_165165") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165129, "mem_param_165129") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165126, "mem_param_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165170, "ext_mem_165170") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165171, "ext_mem_165171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165695, "mem_out_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_166022, struct memblock *mem_out_p_166023, struct memblock *mem_out_p_166024, int64_t *out_prim_out_166025, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_131064, int64_t nS_131065, int64_t offset_R_131068, int64_t offset_S_131069, int64_t partitionsPerWindow_131070, int64_t numberOfWindows_131071, int64_t extParallelism_131072, int64_t scatter_psizze_131073)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164942_cached_sizze_166026 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164944_cached_sizze_166027 = 0;
    unsigned char *mem_164944 = NULL;
    int64_t mem_164985_cached_sizze_166028 = 0;
    unsigned char *mem_164985 = NULL;
    int64_t mem_164987_cached_sizze_166029 = 0;
    unsigned char *mem_164987 = NULL;
    int64_t mem_165027_cached_sizze_166030 = 0;
    unsigned char *mem_165027 = NULL;
    int64_t mem_165029_cached_sizze_166031 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165087_cached_sizze_166032 = 0;
    unsigned char *mem_165087 = NULL;
    int64_t mem_165095_cached_sizze_166033 = 0;
    unsigned char *mem_165095 = NULL;
    int64_t mem_165135_cached_sizze_166034 = 0;
    unsigned char *mem_165135 = NULL;
    int64_t mem_165137_cached_sizze_166035 = 0;
    unsigned char *mem_165137 = NULL;
    int64_t mem_165207_cached_sizze_166036 = 0;
    unsigned char *mem_165207 = NULL;
    int64_t mem_165209_cached_sizze_166037 = 0;
    unsigned char *mem_165209 = NULL;
    int64_t mem_165223_cached_sizze_166038 = 0;
    unsigned char *mem_165223 = NULL;
    int64_t mem_165225_cached_sizze_166039 = 0;
    unsigned char *mem_165225 = NULL;
    int64_t mem_165227_cached_sizze_166040 = 0;
    unsigned char *mem_165227 = NULL;
    int64_t mem_165229_cached_sizze_166041 = 0;
    unsigned char *mem_165229 = NULL;
    int64_t mem_165255_cached_sizze_166042 = 0;
    unsigned char *mem_165255 = NULL;
    int64_t mem_165257_cached_sizze_166043 = 0;
    unsigned char *mem_165257 = NULL;
    int64_t mem_165259_cached_sizze_166044 = 0;
    unsigned char *mem_165259 = NULL;
    int64_t mem_165279_cached_sizze_166045 = 0;
    unsigned char *mem_165279 = NULL;
    int64_t mem_165302_cached_sizze_166046 = 0;
    unsigned char *mem_165302 = NULL;
    int64_t mem_165304_cached_sizze_166047 = 0;
    unsigned char *mem_165304 = NULL;
    int64_t mem_165306_cached_sizze_166048 = 0;
    unsigned char *mem_165306 = NULL;
    int64_t mem_165335_cached_sizze_166049 = 0;
    unsigned char *mem_165335 = NULL;
    int64_t mem_165337_cached_sizze_166050 = 0;
    unsigned char *mem_165337 = NULL;
    int64_t mem_165360_cached_sizze_166051 = 0;
    unsigned char *mem_165360 = NULL;
    int64_t mem_165362_cached_sizze_166052 = 0;
    unsigned char *mem_165362 = NULL;
    int64_t mem_165364_cached_sizze_166053 = 0;
    unsigned char *mem_165364 = NULL;
    struct memblock mem_165391;
    
    mem_165391.references = NULL;
    
    struct memblock mem_165389;
    
    mem_165389.references = NULL;
    
    struct memblock mem_165387;
    
    mem_165387.references = NULL;
    
    struct memblock mem_param_tmp_165816;
    
    mem_param_tmp_165816.references = NULL;
    
    struct memblock mem_param_tmp_165815;
    
    mem_param_tmp_165815.references = NULL;
    
    struct memblock mem_param_tmp_165814;
    
    mem_param_tmp_165814.references = NULL;
    
    struct memblock mem_165376;
    
    mem_165376.references = NULL;
    
    struct memblock mem_165374;
    
    mem_165374.references = NULL;
    
    struct memblock mem_165372;
    
    mem_165372.references = NULL;
    
    struct memblock mem_param_165358;
    
    mem_param_165358.references = NULL;
    
    struct memblock mem_param_165355;
    
    mem_param_165355.references = NULL;
    
    struct memblock mem_param_165352;
    
    mem_param_165352.references = NULL;
    
    struct memblock ext_mem_165383;
    
    ext_mem_165383.references = NULL;
    
    struct memblock ext_mem_165384;
    
    ext_mem_165384.references = NULL;
    
    struct memblock ext_mem_165385;
    
    ext_mem_165385.references = NULL;
    
    struct memblock mem_165291;
    
    mem_165291.references = NULL;
    
    struct memblock mem_165289;
    
    mem_165289.references = NULL;
    
    struct memblock mem_165287;
    
    mem_165287.references = NULL;
    
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_165187;
    
    mem_165187.references = NULL;
    
    struct memblock mem_165179;
    
    mem_165179.references = NULL;
    
    struct memblock mem_param_tmp_165750;
    
    mem_param_tmp_165750.references = NULL;
    
    struct memblock mem_param_tmp_165749;
    
    mem_param_tmp_165749.references = NULL;
    
    struct memblock mem_165105;
    
    mem_165105.references = NULL;
    
    struct memblock mem_165103;
    
    mem_165103.references = NULL;
    
    struct memblock mem_param_tmp_165762;
    
    mem_param_tmp_165762.references = NULL;
    
    struct memblock mem_param_tmp_165761;
    
    mem_param_tmp_165761.references = NULL;
    
    struct memblock mem_165073;
    
    mem_165073.references = NULL;
    
    struct memblock mem_165065;
    
    mem_165065.references = NULL;
    
    struct memblock mem_param_tmp_165768;
    
    mem_param_tmp_165768.references = NULL;
    
    struct memblock mem_param_tmp_165767;
    
    mem_param_tmp_165767.references = NULL;
    
    struct memblock mem_165045;
    
    mem_165045.references = NULL;
    
    struct memblock mem_165043;
    
    mem_165043.references = NULL;
    
    struct memblock ext_mem_165025;
    
    ext_mem_165025.references = NULL;
    
    struct memblock mem_165023;
    
    mem_165023.references = NULL;
    
    struct memblock ext_mem_165048;
    
    ext_mem_165048.references = NULL;
    
    struct memblock ext_mem_165051;
    
    ext_mem_165051.references = NULL;
    
    struct memblock ext_mem_165054;
    
    ext_mem_165054.references = NULL;
    
    struct memblock ext_mem_165057;
    
    ext_mem_165057.references = NULL;
    
    struct memblock mem_param_165021;
    
    mem_param_165021.references = NULL;
    
    struct memblock mem_param_165018;
    
    mem_param_165018.references = NULL;
    
    struct memblock ext_mem_165062;
    
    ext_mem_165062.references = NULL;
    
    struct memblock ext_mem_165063;
    
    ext_mem_165063.references = NULL;
    
    struct memblock mem_param_165015;
    
    mem_param_165015.references = NULL;
    
    struct memblock mem_param_165012;
    
    mem_param_165012.references = NULL;
    
    struct memblock ext_mem_165084;
    
    ext_mem_165084.references = NULL;
    
    struct memblock ext_mem_165085;
    
    ext_mem_165085.references = NULL;
    
    struct memblock mem_165009;
    
    mem_165009.references = NULL;
    
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock ext_mem_165114;
    
    ext_mem_165114.references = NULL;
    
    struct memblock ext_mem_165117;
    
    ext_mem_165117.references = NULL;
    
    struct memblock mem_param_165005;
    
    mem_param_165005.references = NULL;
    
    struct memblock mem_param_165002;
    
    mem_param_165002.references = NULL;
    
    struct memblock ext_mem_165122;
    
    ext_mem_165122.references = NULL;
    
    struct memblock ext_mem_165123;
    
    ext_mem_165123.references = NULL;
    
    struct memblock mem_164969;
    
    mem_164969.references = NULL;
    
    struct memblock mem_164971;
    
    mem_164971.references = NULL;
    
    struct memblock ext_mem_164974;
    
    ext_mem_164974.references = NULL;
    
    struct memblock ext_mem_164977;
    
    ext_mem_164977.references = NULL;
    
    struct memblock mem_164954;
    
    mem_164954.references = NULL;
    
    struct memblock mem_164952;
    
    mem_164952.references = NULL;
    
    struct memblock mem_param_tmp_165706;
    
    mem_param_tmp_165706.references = NULL;
    
    struct memblock mem_param_tmp_165705;
    
    mem_param_tmp_165705.references = NULL;
    
    struct memblock mem_165153;
    
    mem_165153.references = NULL;
    
    struct memblock mem_165151;
    
    mem_165151.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165131;
    
    mem_165131.references = NULL;
    
    struct memblock ext_mem_165156;
    
    ext_mem_165156.references = NULL;
    
    struct memblock ext_mem_165159;
    
    ext_mem_165159.references = NULL;
    
    struct memblock ext_mem_165162;
    
    ext_mem_165162.references = NULL;
    
    struct memblock ext_mem_165165;
    
    ext_mem_165165.references = NULL;
    
    struct memblock mem_param_165129;
    
    mem_param_165129.references = NULL;
    
    struct memblock mem_param_165126;
    
    mem_param_165126.references = NULL;
    
    struct memblock ext_mem_165170;
    
    ext_mem_165170.references = NULL;
    
    struct memblock ext_mem_165171;
    
    ext_mem_165171.references = NULL;
    
    struct memblock ext_mem_165174;
    
    ext_mem_165174.references = NULL;
    
    struct memblock ext_mem_165177;
    
    ext_mem_165177.references = NULL;
    
    struct memblock ext_mem_165196;
    
    ext_mem_165196.references = NULL;
    
    struct memblock ext_mem_165199;
    
    ext_mem_165199.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock ext_mem_165204;
    
    ext_mem_165204.references = NULL;
    
    struct memblock ext_mem_165205;
    
    ext_mem_165205.references = NULL;
    
    struct memblock mem_164934;
    
    mem_164934.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock ext_mem_164930;
    
    ext_mem_164930.references = NULL;
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165696;
    int64_t zm_lhs_150399 = add64(nR_131064, nS_131065);
    int64_t zs_lhs_150400 = sub64(zm_lhs_150399, (int64_t) 1);
    bool zzero_150401 = nR_131064 == (int64_t) 0;
    bool nonzzero_150402 = !zzero_150401;
    bool nonzzero_cert_150403;
    
    if (!nonzzero_150402) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:379:26-29\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_150404 = sdiv64(zs_lhs_150400, nR_131064);
    
    if (futrts_indicesWithIncrement_12206(ctx, &ext_mem_164930, tR_mem_164928, nR_131064, offset_R_131068) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_164931 = (int64_t) 8 * nR_131064;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165697 = 0; nest_i_165697 < nR_131064; nest_i_165697++) {
        ((int64_t *) mem_164932.mem)[nest_i_165697] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_164934, bytes_164931, "mem_164934")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165698 = 0; nest_i_165698 < nR_131064; nest_i_165698++) {
        ((int64_t *) mem_164934.mem)[nest_i_165698] = (int64_t) 0;
    }
    
    bool loop_cond_150409 = slt64((int64_t) 0, numIter_150404);
    int64_t gt_rhs_150410 = sub64(nR_131064, (int64_t) 1);
    bool x_150411 = sle64((int64_t) 0, gt_rhs_150410);
    bool y_150412 = slt64(gt_rhs_150410, nR_131064);
    bool bounds_check_150413 = x_150411 && y_150412;
    bool loop_not_taken_150414 = !loop_cond_150409;
    bool protect_assert_disj_150415 = bounds_check_150413 || loop_not_taken_150414;
    bool index_certs_150416;
    
    if (!protect_assert_disj_150415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:386:25-33\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    float gt_rhs_150417;
    
    if (loop_cond_150409) {
        float x_157438 = ((float *) tR_mem_164928.mem)[gt_rhs_150410];
        
        gt_rhs_150417 = x_157438;
    } else {
        gt_rhs_150417 = 0.0F;
    }
    
    bool defunc_0_mergeJoin_res_150419;
    int64_t defunc_0_mergeJoin_res_150420;
    bool loop_while_150423;
    int64_t p_150424;
    
    if (memblock_set(ctx, &mem_param_164937, &mem_164934, "mem_164934") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &mem_164932, "mem_164932") != 0)
        return 1;
    loop_while_150423 = loop_cond_150409;
    p_150424 = (int64_t) 0;
    while (loop_while_150423) {
        int64_t tS_start_150427 = mul64(nR_131064, p_150424);
        int64_t min_arg1_150428 = add64(nR_131064, tS_start_150427);
        int64_t min_res_150429 = smin64(nS_131065, min_arg1_150428);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 = sub64(min_res_150429, tS_start_150427);
        bool empty_slice_150431 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 == (int64_t) 0;
        int64_t m_150432 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, (int64_t) 1);
        int64_t i_p_m_t_s_150433 = add64(tS_start_150427, m_150432);
        bool zzero_leq_i_p_m_t_s_150434 = sle64((int64_t) 0, i_p_m_t_s_150433);
        bool i_p_m_t_s_leq_w_150435 = slt64(i_p_m_t_s_150433, nS_131065);
        bool zzero_lte_i_150436 = sle64((int64_t) 0, tS_start_150427);
        bool i_lte_j_150437 = sle64(tS_start_150427, min_res_150429);
        bool y_150438 = i_p_m_t_s_leq_w_150435 && zzero_lte_i_150436;
        bool y_150439 = zzero_leq_i_p_m_t_s_150434 && y_150438;
        bool forwards_ok_150440 = i_lte_j_150437 && y_150439;
        bool ok_or_empty_150441 = empty_slice_150431 || forwards_ok_150440;
        bool index_certs_150442;
        
        if (!ok_or_empty_150441) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_150427, ":", (long long) min_res_150429, "] out of bounds for array of shape [", (long long) nS_131065, "].", "-> #0  ftSMJ.fut:385:16-35\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_150444 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
        bool index_certs_150445;
        
        if (!y_150444) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:386:12-19\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float gt_lhs_150446 = ((float *) tS_mem_164929.mem)[tS_start_150427];
        bool defunc_0_gt_res_150447 = gt_rhs_150417 < gt_lhs_150446;
        int64_t loopres_150448;
        
        if (defunc_0_gt_res_150447) {
            if (memblock_set(ctx, &ext_mem_165199, &mem_param_164937, "mem_param_164937") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_param_164940, "mem_param_164940") != 0)
                return 1;
            loopres_150448 = numIter_150404;
        } else {
            bool cond_150451 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, nR_131064);
            bool dim_match_150565 = nR_131064 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            bool protect_assert_disj_165549 = cond_150451 || dim_match_150565;
            bool empty_or_match_cert_150566;
            
            if (!protect_assert_disj_165549) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "] cannot match shape of type `[", (long long) nR_131064, "]f32`.", "-> #0  ftSMJ.fut:394:18-31\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_150572 = slt64((int64_t) 0, numberOfWindows_131071);
            bool y_150575 = slt64((int64_t) 0, nR_131064);
            bool loop_not_taken_150576 = !loop_cond_150572;
            bool protect_assert_disj_150577 = y_150575 || loop_not_taken_150576;
            bool protect_assert_disj_165551 = cond_150451 || protect_assert_disj_150577;
            bool index_certs_150578;
            
            if (!protect_assert_disj_165551) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:264:20-25\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_157450 = add64(nR_131064, extParallelism_131072);
            int64_t zs_lhs_157451 = sub64(zm_lhs_157450, (int64_t) 1);
            bool zzero_157452 = extParallelism_131072 == (int64_t) 0;
            bool nonzzero_157453 = !zzero_157452;
            bool loop_not_taken_165527 = !cond_150451;
            bool protect_assert_disj_165528 = nonzzero_157453 || loop_not_taken_165527;
            bool nonzzero_cert_157454;
            
            if (!protect_assert_disj_165528) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_157455 = sdiv_safe64(zs_lhs_157451, extParallelism_131072);
            bool loop_cond_157456 = slt64((int64_t) 0, numIter_157455);
            bool loop_not_taken_157457 = !y_150444;
            bool loop_not_taken_157458 = !loop_cond_157456;
            bool x_157459 = sle64((int64_t) 0, m_150432);
            bool y_157460 = slt64(m_150432, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
            bool bounds_check_157462 = x_157459 && y_157460;
            bool protect_assert_disj_157463 = loop_not_taken_157457 || bounds_check_157462;
            bool protect_assert_disj_157464 = loop_not_taken_157458 || protect_assert_disj_157463;
            bool protect_assert_disj_165530 = protect_assert_disj_157464 || loop_not_taken_165527;
            bool index_certs_157465;
            
            if (!protect_assert_disj_165530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151246;
            
            if (!bounds_check_157462) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:405:23-44\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151248;
            
            if (!bounds_check_150413) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:405:51-59\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 = mul64(partitionsPerWindow_131070, numberOfWindows_131071);
            int64_t join_chunks_arg3_150568 = add64(offset_S_131069, tS_start_150427);
            int64_t bytes_164941 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
            bool empty_slice_150573 = partitionsPerWindow_131070 == (int64_t) 0;
            int64_t m_150574 = sub64(partitionsPerWindow_131070, (int64_t) 1);
            bool protect_cond_conj_165552 = loop_cond_150572 && loop_not_taken_165527;
            float leq_lhs_150579;
            
            if (protect_cond_conj_165552) {
                float x_157566 = ((float *) tR_mem_164928.mem)[(int64_t) 0];
                
                leq_lhs_150579 = x_157566;
            } else {
                leq_lhs_150579 = 0.0F;
            }
            
            bool defunc_0_leq_res_150583 = leq_lhs_150579 <= gt_lhs_150446;
            float lowest_150584;
            
            if (protect_cond_conj_165552) {
                bool loop_not_taken_165542 = !defunc_0_leq_res_150583;
                bool protect_assert_disj_165543 = y_150575 || loop_not_taken_165542;
                bool index_certs_157570;
                
                if (!protect_assert_disj_165543) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:264:44-49\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float lowest_t_res_157571;
                
                if (defunc_0_leq_res_150583) {
                    float x_165544 = ((float *) tR_mem_164928.mem)[(int64_t) 0];
                    
                    lowest_t_res_157571 = x_165544;
                } else {
                    lowest_t_res_157571 = 0.0F;
                }
                
                float x_157569;
                
                if (defunc_0_leq_res_150583) {
                    x_157569 = lowest_t_res_157571;
                } else {
                    bool index_certs_157572;
                    
                    if (!y_150575) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:264:55-60\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    x_157569 = gt_lhs_150446;
                }
                lowest_150584 = x_157569;
            } else {
                lowest_150584 = 0.0F;
            }
            
            int64_t zeze_rhs_150843 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, (int64_t) 1);
            bool loop_cond_150998 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
            bool protect_cond_conj_157461 = y_150444 && loop_cond_157456;
            bool protect_cond_conj_165531 = cond_150451 && protect_cond_conj_157461;
            float s_max_t_res_157466;
            
            if (protect_cond_conj_165531) {
                float x_157467 = ((float *) tS_mem_164929.mem)[i_p_m_t_s_150433];
                
                s_max_t_res_157466 = x_157467;
            } else {
                s_max_t_res_157466 = 0.0F;
            }
            
            int64_t bytes_165130 = (int64_t) 4 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            int64_t ext_165176;
            int64_t ext_165175;
            int64_t ext_165173;
            int64_t ext_165172;
            
            if (cond_150451) {
                int64_t ext_165169;
                int64_t ext_165168;
                int64_t ext_165167;
                int64_t ext_165166;
                bool defunc_0_find_joinTuples_res_157468;
                int64_t defunc_0_find_joinTuples_res_157469;
                bool loop_while_157472;
                int64_t p_157473;
                int64_t ctx_param_ext_165124;
                int64_t ctx_param_ext_165125;
                int64_t ctx_param_ext_165127;
                int64_t ctx_param_ext_165128;
                
                if (memblock_set(ctx, &mem_param_165126, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165129, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165124 = (int64_t) 0;
                ctx_param_ext_165125 = (int64_t) 1;
                ctx_param_ext_165127 = (int64_t) 0;
                ctx_param_ext_165128 = (int64_t) 1;
                loop_while_157472 = loop_cond_157456;
                p_157473 = (int64_t) 0;
                while (loop_while_157472) {
                    int64_t start_157476 = mul64(extParallelism_131072, p_157473);
                    int64_t min_arg1_157477 = sub64(nR_131064, start_157476);
                    int64_t min_res_157478 = smin64(extParallelism_131072, min_arg1_157477);
                    int64_t iter_R_157479 = add64(start_157476, min_res_157478);
                    bool empty_slice_157480 = min_res_157478 == (int64_t) 0;
                    int64_t m_157481 = sub64(min_res_157478, (int64_t) 1);
                    int64_t i_p_m_t_s_157482 = add64(start_157476, m_157481);
                    bool zzero_leq_i_p_m_t_s_157483 = sle64((int64_t) 0, i_p_m_t_s_157482);
                    bool i_p_m_t_s_leq_w_157484 = slt64(i_p_m_t_s_157482, nR_131064);
                    bool zzero_lte_i_157485 = sle64((int64_t) 0, start_157476);
                    bool i_lte_j_157486 = sle64(start_157476, iter_R_157479);
                    bool y_157487 = i_p_m_t_s_leq_w_157484 && zzero_lte_i_157485;
                    bool y_157488 = zzero_leq_i_p_m_t_s_157483 && y_157487;
                    bool forwards_ok_157489 = i_lte_j_157486 && y_157488;
                    bool ok_or_empty_157490 = empty_slice_157480 || forwards_ok_157489;
                    bool index_certs_157491;
                    
                    if (!ok_or_empty_157490) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_157476, ":", (long long) iter_R_157479, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157492 = slt64(m_157481, min_res_157478);
                    bool x_157493 = sle64((int64_t) 0, m_157481);
                    bool bounds_check_157494 = y_157492 && x_157493;
                    bool index_certs_157495;
                    
                    if (!bounds_check_157494) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_157481, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157498 = slt64((int64_t) 0, min_res_157478);
                    bool index_certs_157499;
                    
                    if (!y_157498) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float r_max_157496 = ((float *) tR_mem_164928.mem)[i_p_m_t_s_157482];
                    float s_max_157497;
                    
                    if (y_150444) {
                        s_max_157497 = s_max_t_res_157466;
                    } else {
                        s_max_157497 = r_max_157496;
                    }
                    
                    float r_min_157500 = ((float *) tR_mem_164928.mem)[start_157476];
                    bool defunc_0_gt_res_157501 = s_max_157497 < r_min_157500;
                    float s_min_157502;
                    
                    if (y_150444) {
                        s_min_157502 = gt_lhs_150446;
                    } else {
                        s_min_157502 = r_min_157500;
                    }
                    
                    bool defunc_0_gt_res_157507 = r_max_157496 < s_min_157502;
                    int64_t ext_165158;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165158 = ctx_param_ext_165124;
                    } else {
                        ext_165158 = (int64_t) 0;
                    }
                    
                    int64_t ext_165157;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165157 = ctx_param_ext_165125;
                    } else {
                        ext_165157 = (int64_t) 1;
                    }
                    
                    int64_t ext_165155;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165155 = ctx_param_ext_165127;
                    } else {
                        ext_165155 = (int64_t) 0;
                    }
                    
                    int64_t ext_165154;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165154 = ctx_param_ext_165128;
                    } else {
                        ext_165154 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165134 = (int64_t) 8 * min_res_157478;
                    int64_t ext_165164;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165164 = ctx_param_ext_165124;
                    } else {
                        ext_165164 = ext_165158;
                    }
                    
                    int64_t ext_165163;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165163 = ctx_param_ext_165125;
                    } else {
                        ext_165163 = ext_165157;
                    }
                    
                    int64_t ext_165161;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165161 = ctx_param_ext_165127;
                    } else {
                        ext_165161 = ext_165155;
                    }
                    
                    int64_t ext_165160;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165160 = ctx_param_ext_165128;
                    } else {
                        ext_165160 = ext_165154;
                    }
                    
                    int64_t loopres_157503;
                    
                    if (defunc_0_gt_res_157501) {
                        if (memblock_set(ctx, &ext_mem_165165, &mem_param_165126, "mem_param_165126") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &mem_param_165129, "mem_param_165129") != 0)
                            return 1;
                        loopres_157503 = numIter_157455;
                    } else {
                        int64_t loopres_f_res_157508;
                        
                        if (defunc_0_gt_res_157507) {
                            int64_t tmp_157512 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_param_165126, "mem_param_165126") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_param_165129, "mem_param_165129") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157512;
                        } else {
                            if (memblock_alloc(ctx, &mem_165131, bytes_165130, "mem_165131")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165131.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) tS_mem_164929.mem, tS_start_150427, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430});
                            if (futrts_indicesWithIncrement_12206(ctx, &ext_mem_165133, mem_165131, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, join_chunks_arg3_150568) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
                                return 1;
                            if (mem_165135_cached_sizze_166034 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165135, &mem_165135_cached_sizze_166034, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_165137_cached_sizze_166035 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165137, &mem_165137_cached_sizze_166035, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164719 = 0; i_164719 < min_res_157478; i_164719++) {
                                int64_t slice_164899 = start_157476 + i_164719;
                                float eta_p_157518 = ((float *) tR_mem_164928.mem)[slice_164899];
                                int64_t defunc_0_reduce_comm_res_157519;
                                float defunc_0_reduce_comm_res_157520;
                                int64_t defunc_0_reduce_comm_res_157521;
                                int64_t redout_164711;
                                float redout_164712;
                                int64_t redout_164713;
                                
                                redout_164711 = (int64_t) -1;
                                redout_164712 = eta_p_157518;
                                redout_164713 = (int64_t) 0;
                                for (int64_t i_164714 = 0; i_164714 < dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430; i_164714++) {
                                    int64_t x_157522 = ((int64_t *) ext_mem_165133.mem)[i_164714];
                                    int64_t slice_164898 = tS_start_150427 + i_164714;
                                    float x_157523 = ((float *) tS_mem_164929.mem)[slice_164898];
                                    bool defunc_0_neq_res_157531 = redout_164712 == eta_p_157518;
                                    bool defunc_0_neq_res_157532 = !defunc_0_neq_res_157531;
                                    bool cond_f_res_157533 = slt64(redout_164711, (int64_t) 0);
                                    bool y_157534 = defunc_0_neq_res_157531 && cond_f_res_157533;
                                    bool cond_157535 = defunc_0_neq_res_157532 || y_157534;
                                    bool defunc_0_neq_res_157536 = x_157523 == eta_p_157518;
                                    bool defunc_0_neq_res_157537 = !defunc_0_neq_res_157536;
                                    bool cond_t_res_f_res_157538 = slt64(x_157522, (int64_t) 0);
                                    bool y_157539 = defunc_0_neq_res_157536 && cond_t_res_f_res_157538;
                                    bool cond_t_res_157540 = defunc_0_neq_res_157537 || y_157539;
                                    bool x_157541 = cond_157535 && cond_t_res_157540;
                                    int64_t defunc_0_op_res_157542;
                                    float defunc_0_op_res_157543;
                                    int64_t defunc_0_op_res_157544;
                                    
                                    if (x_157541) {
                                        defunc_0_op_res_157542 = (int64_t) -1;
                                        defunc_0_op_res_157543 = eta_p_157518;
                                        defunc_0_op_res_157544 = (int64_t) 0;
                                    } else {
                                        int64_t defunc_0_op_res_f_res_157545;
                                        float defunc_0_op_res_f_res_157546;
                                        int64_t defunc_0_op_res_f_res_157547;
                                        
                                        if (cond_157535) {
                                            defunc_0_op_res_f_res_157545 = x_157522;
                                            defunc_0_op_res_f_res_157546 = x_157523;
                                            defunc_0_op_res_f_res_157547 = (int64_t) 1;
                                        } else {
                                            float defunc_0_op_res_f_res_f_res_157548;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157548 = redout_164712;
                                            } else {
                                                defunc_0_op_res_f_res_f_res_157548 = eta_p_157518;
                                            }
                                            
                                            int64_t defunc_0_op_res_f_res_f_res_157549;
                                            int64_t defunc_0_op_res_f_res_f_res_157550;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157549 = redout_164711;
                                                defunc_0_op_res_f_res_f_res_157550 = redout_164713;
                                            } else {
                                                int64_t min_res_157551 = smin64(x_157522, redout_164711);
                                                int64_t tmp_157552 = add64((int64_t) 1, redout_164713);
                                                
                                                defunc_0_op_res_f_res_f_res_157549 = min_res_157551;
                                                defunc_0_op_res_f_res_f_res_157550 = tmp_157552;
                                            }
                                            defunc_0_op_res_f_res_157545 = defunc_0_op_res_f_res_f_res_157549;
                                            defunc_0_op_res_f_res_157546 = defunc_0_op_res_f_res_f_res_157548;
                                            defunc_0_op_res_f_res_157547 = defunc_0_op_res_f_res_f_res_157550;
                                        }
                                        defunc_0_op_res_157542 = defunc_0_op_res_f_res_157545;
                                        defunc_0_op_res_157543 = defunc_0_op_res_f_res_157546;
                                        defunc_0_op_res_157544 = defunc_0_op_res_f_res_157547;
                                    }
                                    
                                    int64_t redout_tmp_165717 = defunc_0_op_res_157542;
                                    float redout_tmp_165718 = defunc_0_op_res_157543;
                                    int64_t redout_tmp_165719 = defunc_0_op_res_157544;
                                    
                                    redout_164711 = redout_tmp_165717;
                                    redout_164712 = redout_tmp_165718;
                                    redout_164713 = redout_tmp_165719;
                                }
                                defunc_0_reduce_comm_res_157519 = redout_164711;
                                defunc_0_reduce_comm_res_157520 = redout_164712;
                                defunc_0_reduce_comm_res_157521 = redout_164713;
                                ((int64_t *) mem_165135)[i_164719] = defunc_0_reduce_comm_res_157519;
                                ((int64_t *) mem_165137)[i_164719] = defunc_0_reduce_comm_res_157521;
                            }
                            if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165151, bytes_164931, "mem_165151")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165129.mem, ctx_param_ext_165127, (int64_t []) {ctx_param_ext_165128}, (int64_t []) {nR_131064});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165135, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            if (memblock_alloc(ctx, &mem_165153, bytes_164931, "mem_165153")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165126.mem, ctx_param_ext_165124, (int64_t []) {ctx_param_ext_165125}, (int64_t []) {nR_131064});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165137, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            
                            int64_t tmp_157564 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_165153, "mem_165153") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_165151, "mem_165151") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157564;
                        }
                        if (memblock_set(ctx, &ext_mem_165165, &ext_mem_165159, "ext_mem_165159") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &ext_mem_165156, "ext_mem_165156") != 0)
                            return 1;
                        loopres_157503 = loopres_f_res_157508;
                    }
                    
                    bool loop_cond_157565 = slt64(loopres_157503, numIter_157455);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165705, &ext_mem_165165, "ext_mem_165165") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165706, &ext_mem_165162, "ext_mem_165162") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165707 = ext_165164;
                    int64_t ctx_param_ext_tmp_165708 = ext_165163;
                    int64_t ctx_param_ext_tmp_165709 = ext_165161;
                    int64_t ctx_param_ext_tmp_165710 = ext_165160;
                    bool loop_while_tmp_165711 = loop_cond_157565;
                    int64_t p_tmp_165712 = loopres_157503;
                    
                    if (memblock_set(ctx, &mem_param_165126, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165129, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
                        return 1;
                    ctx_param_ext_165124 = ctx_param_ext_tmp_165707;
                    ctx_param_ext_165125 = ctx_param_ext_tmp_165708;
                    ctx_param_ext_165127 = ctx_param_ext_tmp_165709;
                    ctx_param_ext_165128 = ctx_param_ext_tmp_165710;
                    loop_while_157472 = loop_while_tmp_165711;
                    p_157473 = p_tmp_165712;
                }
                if (memblock_set(ctx, &ext_mem_165171, &mem_param_165126, "mem_param_165126") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165170, &mem_param_165129, "mem_param_165129") != 0)
                    return 1;
                ext_165169 = ctx_param_ext_165124;
                ext_165168 = ctx_param_ext_165125;
                ext_165167 = ctx_param_ext_165127;
                ext_165166 = ctx_param_ext_165128;
                defunc_0_find_joinTuples_res_157468 = loop_while_157472;
                defunc_0_find_joinTuples_res_157469 = p_157473;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165171, "ext_mem_165171") != 0)
                    return 1;
                ext_165176 = ext_165169;
                ext_165175 = ext_165168;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165170, "ext_mem_165170") != 0)
                    return 1;
                ext_165173 = ext_165167;
                ext_165172 = ext_165166;
            } else {
                if (mem_164942_cached_sizze_166026 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_166026, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165720 = 0; nest_i_165720 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165720++) {
                    ((int64_t *) mem_164942)[nest_i_165720] = nR_131064;
                }
                if (mem_164944_cached_sizze_166027 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164944, &mem_164944_cached_sizze_166027, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165721 = 0; nest_i_165721 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165721++) {
                    ((int64_t *) mem_164944)[nest_i_165721] = nR_131064;
                }
                
                bool defunc_0_windowed_partitionFunc_res_150590;
                int64_t defunc_0_windowed_partitionFunc_res_150591;
                bool loop_while_150594;
                int64_t p_150595;
                
                loop_while_150594 = loop_cond_150572;
                p_150595 = (int64_t) 0;
                while (loop_while_150594) {
                    int64_t start_150598 = mul64(partitionsPerWindow_131070, p_150595);
                    int64_t end_150599 = add64(partitionsPerWindow_131070, start_150598);
                    int64_t max_res_150600 = smax64((int64_t) 1, start_150598);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601 = sub64(end_150599, max_res_150600);
                    bool bounds_invalid_upwards_150602 = slt64(end_150599, max_res_150600);
                    bool valid_150603 = !bounds_invalid_upwards_150602;
                    bool range_valid_c_150604;
                    
                    if (!valid_150603) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_150600, "..<", (long long) end_150599, " is invalid.", "-> #0  ftbasics.fut:267:43-68\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_150607 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 == (int64_t) 0;
                    bool nonzzero_150608 = !zzero_150607;
                    bool nonzzero_cert_150609;
                    
                    if (!nonzzero_150608) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:270:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_164951 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool cond_150810 = slt64((int64_t) 0, start_150598);
                    int64_t conc_tmp_150811 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    int64_t ret_150812;
                    
                    if (cond_150810) {
                        ret_150812 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    } else {
                        ret_150812 = conc_tmp_150811;
                    }
                    
                    bool eq_x_y_150820 = partitionsPerWindow_131070 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool eq_x_zz_150821 = partitionsPerWindow_131070 == conc_tmp_150811;
                    bool p_and_eq_x_y_150822 = cond_150810 && eq_x_y_150820;
                    bool not_p_150823 = !cond_150810;
                    bool p_and_eq_x_y_150824 = eq_x_zz_150821 && not_p_150823;
                    bool dim_match_150825 = p_and_eq_x_y_150822 || p_and_eq_x_y_150824;
                    bool empty_or_match_cert_150826;
                    
                    if (!dim_match_150825) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_150812, "] cannot match shape of type `[", (long long) partitionsPerWindow_131070, "](i64, i64)`.", "-> #0  ftbasics.fut:331:5-336:49\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_150828 = add64(m_150574, start_150598);
                    bool zzero_leq_i_p_m_t_s_150829 = sle64((int64_t) 0, i_p_m_t_s_150828);
                    bool i_p_m_t_s_leq_w_150830 = slt64(i_p_m_t_s_150828, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool zzero_lte_i_150831 = sle64((int64_t) 0, start_150598);
                    bool i_lte_j_150832 = sle64(start_150598, end_150599);
                    bool y_150833 = i_p_m_t_s_leq_w_150830 && zzero_lte_i_150831;
                    bool y_150834 = zzero_leq_i_p_m_t_s_150829 && y_150833;
                    bool forwards_ok_150835 = i_lte_j_150832 && y_150834;
                    bool ok_or_empty_150836 = empty_slice_150573 || forwards_ok_150835;
                    bool index_certs_150837;
                    
                    if (!ok_or_empty_150836) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_150598, ":", (long long) end_150599, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftbasics.fut:356:37-74\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_150606 = add64(nR_131064, nR_131064);
                    
                    if (memblock_alloc(ctx, &mem_164952, bytes_164951, "mem_164952")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_164954, bytes_164951, "mem_164954")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164726 = 0; i_164726 < dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601; i_164726++) {
                        int64_t index_primexp_164907 = add64(max_res_150600, i_164726);
                        int64_t zs_lhs_150613 = mul64(zt_rhs_150606, index_primexp_164907);
                        int64_t index_150614 = sdiv64(zs_lhs_150613, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool cond_150615 = slt64(nR_131064, index_150614);
                        int64_t loop_over_150616;
                        
                        if (cond_150615) {
                            loop_over_150616 = nR_131064;
                        } else {
                            loop_over_150616 = index_150614;
                        }
                        
                        int64_t loop_over_150617;
                        
                        if (cond_150615) {
                            int64_t loop_over_t_res_157573 = sub64(index_150614, nR_131064);
                            
                            loop_over_150617 = loop_over_t_res_157573;
                        } else {
                            loop_over_150617 = (int64_t) 0;
                        }
                        
                        int64_t loop_over_150619;
                        
                        if (cond_150615) {
                            int64_t zm_lhs_157574 = sub64(index_150614, nR_131064);
                            int64_t loop_over_t_res_157575 = sub64(zm_lhs_157574, (int64_t) 1);
                            
                            loop_over_150619 = loop_over_t_res_157575;
                        } else {
                            loop_over_150619 = (int64_t) 0;
                        }
                        
                        bool defunc_0_f_res_150622;
                        int64_t defunc_0_f_res_150623;
                        int64_t defunc_0_f_res_150624;
                        int64_t defunc_0_f_res_150625;
                        bool loop_while_150626;
                        int64_t p_150627;
                        int64_t p_150628;
                        int64_t p_150629;
                        
                        loop_while_150626 = 1;
                        p_150627 = loop_over_150619;
                        p_150628 = loop_over_150616;
                        p_150629 = loop_over_150617;
                        while (loop_while_150626) {
                            int64_t zs_lhs_150630 = sub64(p_150628, p_150627);
                            int64_t offset_150631 = sdiv64(zs_lhs_150630, (int64_t) 2);
                            int64_t ai_150632 = sub64(p_150628, offset_150631);
                            int64_t max_arg1_150633 = add64(p_150629, offset_150631);
                            int64_t max_res_150634 = smax64((int64_t) 0, max_arg1_150633);
                            bool cond_150635 = slt64((int64_t) 0, max_res_150634);
                            float b_prev_150636;
                            
                            if (cond_150635) {
                                int64_t tmp_157576 = sub64(max_res_150634, (int64_t) 1);
                                bool x_157577 = sle64((int64_t) 0, tmp_157576);
                                bool y_157578 = slt64(tmp_157576, nR_131064);
                                bool bounds_check_157579 = x_157577 && y_157578;
                                bool index_certs_157580;
                                
                                if (!bounds_check_157579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157576, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:282:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157581 = tS_start_150427 + tmp_157576;
                                float b_prev_t_res_157582 = ((float *) tS_mem_164929.mem)[slice_157581];
                                
                                b_prev_150636 = b_prev_t_res_157582;
                            } else {
                                b_prev_150636 = lowest_150584;
                            }
                            
                            bool cond_150643 = sle64(ai_150632, (int64_t) 0);
                            int64_t loopres_150644;
                            int64_t loopres_150645;
                            int64_t loopres_150646;
                            bool loopres_150647;
                            
                            if (cond_150643) {
                                loopres_150644 = p_150627;
                                loopres_150645 = (int64_t) 0;
                                loopres_150646 = max_res_150634;
                                loopres_150647 = 0;
                            } else {
                                bool cond_150648 = sle64(nR_131064, max_res_150634);
                                int64_t loopres_f_res_150649;
                                int64_t loopres_f_res_150650;
                                int64_t loopres_f_res_150651;
                                bool loopres_f_res_150652;
                                
                                if (cond_150648) {
                                    int64_t min_res_157584 = smin64(gt_rhs_150410, ai_150632);
                                    bool bounds_check_157587 = x_150411 && y_150412;
                                    bool index_certs_157588;
                                    
                                    if (!bounds_check_157587) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:293:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157591 = sle64((int64_t) 0, min_res_157584);
                                    bool y_157592 = slt64(min_res_157584, nR_131064);
                                    bool bounds_check_157593 = x_157591 && y_157592;
                                    bool index_certs_157594;
                                    
                                    if (!bounds_check_157593) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157584, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:293:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157589 = gt_rhs_150410 + tS_start_150427;
                                    float leq_lhs_157590 = ((float *) tS_mem_164929.mem)[slice_157589];
                                    float leq_rhs_157595 = ((float *) tR_mem_164928.mem)[min_res_157584];
                                    bool defunc_0_leq_res_157596 = leq_lhs_157590 <= leq_rhs_157595;
                                    int64_t loopres_f_res_t_res_157597;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157597 = ai_150632;
                                    } else {
                                        loopres_f_res_t_res_157597 = p_150628;
                                    }
                                    
                                    bool x_157598 = !defunc_0_leq_res_157596;
                                    int64_t loopres_f_res_t_res_157599;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157599 = nR_131064;
                                    } else {
                                        int64_t tmp_157600 = sub64(gt_rhs_150410, offset_150631);
                                        
                                        loopres_f_res_t_res_157599 = tmp_157600;
                                    }
                                    loopres_f_res_150649 = p_150627;
                                    loopres_f_res_150650 = loopres_f_res_t_res_157597;
                                    loopres_f_res_150651 = loopres_f_res_t_res_157599;
                                    loopres_f_res_150652 = x_157598;
                                } else {
                                    bool cond_150670 = sle64(nR_131064, ai_150632);
                                    int64_t loopres_f_res_f_res_150671;
                                    int64_t loopres_f_res_f_res_150672;
                                    int64_t loopres_f_res_f_res_150673;
                                    bool loopres_f_res_f_res_150674;
                                    
                                    if (cond_150670) {
                                        int64_t min_res_157602 = smin64(gt_rhs_150410, max_res_150634);
                                        bool bounds_check_157605 = x_150411 && y_150412;
                                        bool index_certs_157606;
                                        
                                        if (!bounds_check_157605) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:300:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157608 = sle64((int64_t) 0, min_res_157602);
                                        bool y_157609 = slt64(min_res_157602, nR_131064);
                                        bool bounds_check_157610 = x_157608 && y_157609;
                                        bool index_certs_157611;
                                        
                                        if (!bounds_check_157610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157602, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:300:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        float leq_lhs_157607 = ((float *) tR_mem_164928.mem)[gt_rhs_150410];
                                        int64_t slice_157612 = tS_start_150427 + min_res_157602;
                                        float leq_rhs_157613 = ((float *) tS_mem_164929.mem)[slice_157612];
                                        bool defunc_0_leq_res_157614 = leq_lhs_157607 <= leq_rhs_157613;
                                        int64_t loopres_f_res_f_res_t_res_157615;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157615 = max_res_150634;
                                        } else {
                                            loopres_f_res_f_res_t_res_157615 = p_150629;
                                        }
                                        
                                        bool x_157616 = !defunc_0_leq_res_157614;
                                        int64_t loopres_f_res_f_res_t_res_157617;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157617 = nR_131064;
                                        } else {
                                            loopres_f_res_f_res_t_res_157617 = gt_rhs_150410;
                                        }
                                        loopres_f_res_f_res_150671 = p_150627;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_t_res_157617;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_t_res_157615;
                                        loopres_f_res_f_res_150674 = x_157616;
                                    } else {
                                        bool cond_150691 = sle64(p_150628, p_150627);
                                        int64_t loopres_f_res_f_res_f_res_150692;
                                        int64_t loopres_f_res_f_res_f_res_150693;
                                        int64_t loopres_f_res_f_res_f_res_150694;
                                        bool loopres_f_res_f_res_f_res_150695;
                                        
                                        if (cond_150691) {
                                            bool cond_157655 = slt64(ai_150632, nR_131064);
                                            int64_t ai_157656;
                                            
                                            if (cond_157655) {
                                                ai_157656 = ai_150632;
                                            } else {
                                                ai_157656 = gt_rhs_150410;
                                            }
                                            
                                            bool x_157669 = sle64((int64_t) 0, ai_157656);
                                            bool y_157670 = slt64(ai_157656, nR_131064);
                                            bool bounds_check_157671 = x_157669 && y_157670;
                                            bool index_certs_157672;
                                            
                                            if (!bounds_check_157671) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_157656, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:234:8-14\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            float b_prev_157658;
                                            
                                            if (cond_150635) {
                                                int64_t tmp_157659 = sub64(max_res_150634, (int64_t) 1);
                                                bool x_157660 = sle64((int64_t) 0, tmp_157659);
                                                bool y_157661 = slt64(tmp_157659, nR_131064);
                                                bool bounds_check_157662 = x_157660 && y_157661;
                                                bool index_certs_157663;
                                                
                                                if (!bounds_check_157662) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157659, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:232:31-39\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_157664 = tS_start_150427 + tmp_157659;
                                                float b_prev_t_res_157665 = ((float *) tS_mem_164929.mem)[slice_157664];
                                                
                                                b_prev_157658 = b_prev_t_res_157665;
                                            } else {
                                                bool index_certs_157667;
                                                
                                                if (!y_150575) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:232:45-50\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                b_prev_157658 = gt_lhs_150446;
                                            }
                                            
                                            float gt_lhs_157673 = ((float *) tR_mem_164928.mem)[ai_157656];
                                            bool defunc_0_gt_res_157674 = b_prev_157658 < gt_lhs_157673;
                                            int64_t defunc_0_partFunc_sequential_search_res_157675;
                                            int64_t defunc_0_partFunc_sequential_search_res_157676;
                                            
                                            if (defunc_0_gt_res_157674) {
                                                int64_t zl_rhs_157677 = sub64(nR_131064, max_res_150634);
                                                bool loop_cond_157678 = slt64((int64_t) 0, zl_rhs_157677);
                                                bool defunc_0_partFunc_sequential_search_res_t_res_157679;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157681;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157682;
                                                bool loop_while_157683;
                                                int64_t p_157684;
                                                int64_t p_157685;
                                                int64_t p_157686;
                                                
                                                loop_while_157683 = loop_cond_157678;
                                                p_157684 = ai_157656;
                                                p_157685 = max_res_150634;
                                                p_157686 = (int64_t) 0;
                                                while (loop_while_157683) {
                                                    int64_t i_a_157687 = sub64(ai_157656, p_157686);
                                                    int64_t i_b_157688 = add64(max_res_150634, p_157686);
                                                    int64_t leq_lhs_157689 = sub64(i_a_157687, (int64_t) 1);
                                                    bool x_157690 = sle64((int64_t) 0, leq_lhs_157689);
                                                    bool y_157691 = slt64(leq_lhs_157689, nR_131064);
                                                    bool bounds_check_157692 = x_157690 && y_157691;
                                                    bool index_certs_157693;
                                                    
                                                    if (!bounds_check_157692) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157689, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:240:15-24\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157695 = sle64((int64_t) 0, i_b_157688);
                                                    bool y_157696 = slt64(i_b_157688, nR_131064);
                                                    bool bounds_check_157697 = x_157695 && y_157696;
                                                    bool index_certs_157698;
                                                    
                                                    if (!bounds_check_157697) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157688, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:240:31-38\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    float leq_lhs_157694 = ((float *) tR_mem_164928.mem)[leq_lhs_157689];
                                                    int64_t slice_157699 = tS_start_150427 + i_b_157688;
                                                    float leq_rhs_157700 = ((float *) tS_mem_164929.mem)[slice_157699];
                                                    bool defunc_0_leq_res_157701 = leq_lhs_157694 <= leq_rhs_157700;
                                                    int64_t loopres_157702;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157702 = i_a_157687;
                                                    } else {
                                                        loopres_157702 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157703;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157703 = i_b_157688;
                                                    } else {
                                                        loopres_157703 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157704;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157704 = zl_rhs_157677;
                                                    } else {
                                                        int64_t tmp_157705 = add64((int64_t) 1, p_157686);
                                                        
                                                        loopres_157704 = tmp_157705;
                                                    }
                                                    
                                                    bool loop_cond_157706 = slt64(loopres_157704, zl_rhs_157677);
                                                    bool loop_while_tmp_165732 = loop_cond_157706;
                                                    int64_t p_tmp_165733 = loopres_157702;
                                                    int64_t p_tmp_165734 = loopres_157703;
                                                    int64_t p_tmp_165735 = loopres_157704;
                                                    
                                                    loop_while_157683 = loop_while_tmp_165732;
                                                    p_157684 = p_tmp_165733;
                                                    p_157685 = p_tmp_165734;
                                                    p_157686 = p_tmp_165735;
                                                }
                                                defunc_0_partFunc_sequential_search_res_t_res_157679 = loop_while_157683;
                                                defunc_0_partFunc_sequential_search_res_t_res_157680 = p_157684;
                                                defunc_0_partFunc_sequential_search_res_t_res_157681 = p_157685;
                                                defunc_0_partFunc_sequential_search_res_t_res_157682 = p_157686;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_t_res_157681;
                                            } else {
                                                int64_t zl_rhs_157707 = sub64(max_res_150634, (int64_t) 1);
                                                bool loop_cond_157708 = slt64((int64_t) 0, zl_rhs_157707);
                                                bool defunc_0_partFunc_sequential_search_res_f_res_157709;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157711;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157712;
                                                bool loop_while_157713;
                                                int64_t p_157714;
                                                int64_t p_157715;
                                                int64_t p_157716;
                                                
                                                loop_while_157713 = loop_cond_157708;
                                                p_157714 = ai_157656;
                                                p_157715 = max_res_150634;
                                                p_157716 = (int64_t) 0;
                                                while (loop_while_157713) {
                                                    int64_t zp_lhs_157717 = add64(ai_157656, p_157716);
                                                    int64_t hi_a_157718 = add64((int64_t) 1, zp_lhs_157717);
                                                    bool cond_157719 = slt64(hi_a_157718, nR_131064);
                                                    int64_t i_a_157720;
                                                    
                                                    if (cond_157719) {
                                                        i_a_157720 = hi_a_157718;
                                                    } else {
                                                        i_a_157720 = gt_rhs_150410;
                                                    }
                                                    
                                                    int64_t zm_lhs_157722 = sub64(max_res_150634, p_157716);
                                                    int64_t i_b_157723 = sub64(zm_lhs_157722, (int64_t) 1);
                                                    bool x_157724 = sle64((int64_t) 0, i_a_157720);
                                                    bool y_157725 = slt64(i_a_157720, nR_131064);
                                                    bool bounds_check_157726 = x_157724 && y_157725;
                                                    bool index_certs_157727;
                                                    
                                                    if (!bounds_check_157726) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_a_157720, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:250:15-22\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157729 = sle64((int64_t) 0, i_b_157723);
                                                    bool y_157730 = slt64(i_b_157723, nR_131064);
                                                    bool bounds_check_157731 = x_157729 && y_157730;
                                                    bool index_certs_157732;
                                                    
                                                    if (!bounds_check_157731) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157723, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:250:28-35\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:197:133-136\n   #5  ftRelational.fut:186:1-197:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    float gt_lhs_157728 = ((float *) tR_mem_164928.mem)[i_a_157720];
                                                    int64_t slice_157733 = tS_start_150427 + i_b_157723;
                                                    float gt_rhs_157734 = ((float *) tS_mem_164929.mem)[slice_157733];
                                                    bool defunc_0_gt_res_157735 = gt_rhs_157734 < gt_lhs_157728;
                                                    int64_t loopres_157736;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157736 = i_a_157720;
                                                    } else {
                                                        loopres_157736 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157737;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157737 = zm_lhs_157722;
                                                    } else {
                                                        loopres_157737 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157738;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157738 = zl_rhs_157707;
                                                    } else {
                                                        int64_t tmp_157739 = add64((int64_t) 1, p_157716);
                                                        
                                                        loopres_157738 = tmp_157739;
                                                    }
                                                    
                                                    bool loop_cond_157740 = slt64(loopres_157738, zl_rhs_157707);
                                                    bool loop_while_tmp_165736 = loop_cond_157740;
                                                    int64_t p_tmp_165737 = loopres_157736;
                                                    int64_t p_tmp_165738 = loopres_157737;
                                                    int64_t p_tmp_165739 = loopres_157738;
                                                    
                                                    loop_while_157713 = loop_while_tmp_165736;
                                                    p_157714 = p_tmp_165737;
                                                    p_157715 = p_tmp_165738;
                                                    p_157716 = p_tmp_165739;
                                                }
                                                defunc_0_partFunc_sequential_search_res_f_res_157709 = loop_while_157713;
                                                defunc_0_partFunc_sequential_search_res_f_res_157710 = p_157714;
                                                defunc_0_partFunc_sequential_search_res_f_res_157711 = p_157715;
                                                defunc_0_partFunc_sequential_search_res_f_res_157712 = p_157716;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_f_res_157711;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = p_150627;
                                            loopres_f_res_f_res_f_res_150693 = defunc_0_partFunc_sequential_search_res_157675;
                                            loopres_f_res_f_res_f_res_150694 = defunc_0_partFunc_sequential_search_res_157676;
                                            loopres_f_res_f_res_f_res_150695 = 0;
                                        } else {
                                            bool x_150779 = sle64((int64_t) 0, ai_150632);
                                            bool y_150780 = slt64(ai_150632, nR_131064);
                                            bool bounds_check_150781 = x_150779 && y_150780;
                                            bool index_certs_150782;
                                            
                                            if (!bounds_check_150781) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_150632, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:308:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            float gt_lhs_150783 = ((float *) tR_mem_164928.mem)[ai_150632];
                                            bool defunc_0_gt_res_150784 = b_prev_150636 < gt_lhs_150783;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150785;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150786;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150787;
                                            bool loopres_f_res_f_res_f_res_f_res_150788;
                                            
                                            if (defunc_0_gt_res_150784) {
                                                int64_t leq_lhs_157741 = sub64(ai_150632, (int64_t) 1);
                                                bool x_157742 = sle64((int64_t) 0, leq_lhs_157741);
                                                bool y_157743 = slt64(leq_lhs_157741, nR_131064);
                                                bool bounds_check_157744 = x_157742 && y_157743;
                                                bool index_certs_157745;
                                                
                                                if (!bounds_check_157744) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157741, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:309:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                bool x_157747 = sle64((int64_t) 0, max_res_150634);
                                                bool y_157748 = slt64(max_res_150634, nR_131064);
                                                bool bounds_check_157749 = x_157747 && y_157748;
                                                bool index_certs_157750;
                                                
                                                if (!bounds_check_157749) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150634, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftbasics.fut:309:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                float leq_lhs_157746 = ((float *) tR_mem_164928.mem)[leq_lhs_157741];
                                                int64_t slice_157751 = tS_start_150427 + max_res_150634;
                                                float leq_rhs_157752 = ((float *) tS_mem_164929.mem)[slice_157751];
                                                bool defunc_0_leq_res_157753 = leq_lhs_157746 <= leq_rhs_157752;
                                                bool x_157754 = !defunc_0_leq_res_157753;
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = ai_150632;
                                                } else {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = leq_lhs_157741;
                                                }
                                                
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = max_res_150634;
                                                } else {
                                                    int64_t tmp_157757 = add64((int64_t) 1, max_res_150634);
                                                    
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = tmp_157757;
                                                }
                                                loopres_f_res_f_res_f_res_f_res_150785 = p_150627;
                                                loopres_f_res_f_res_f_res_f_res_150786 = loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                loopres_f_res_f_res_f_res_f_res_150787 = loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                loopres_f_res_f_res_f_res_f_res_150788 = x_157754;
                                            } else {
                                                int64_t tmp_150805 = add64((int64_t) 1, ai_150632);
                                                
                                                loopres_f_res_f_res_f_res_f_res_150785 = tmp_150805;
                                                loopres_f_res_f_res_f_res_f_res_150786 = p_150628;
                                                loopres_f_res_f_res_f_res_f_res_150787 = p_150629;
                                                loopres_f_res_f_res_f_res_f_res_150788 = 1;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = loopres_f_res_f_res_f_res_f_res_150785;
                                            loopres_f_res_f_res_f_res_150693 = loopres_f_res_f_res_f_res_f_res_150786;
                                            loopres_f_res_f_res_f_res_150694 = loopres_f_res_f_res_f_res_f_res_150787;
                                            loopres_f_res_f_res_f_res_150695 = loopres_f_res_f_res_f_res_f_res_150788;
                                        }
                                        loopres_f_res_f_res_150671 = loopres_f_res_f_res_f_res_150692;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_f_res_150693;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_f_res_150694;
                                        loopres_f_res_f_res_150674 = loopres_f_res_f_res_f_res_150695;
                                    }
                                    loopres_f_res_150649 = loopres_f_res_f_res_150671;
                                    loopres_f_res_150650 = loopres_f_res_f_res_150672;
                                    loopres_f_res_150651 = loopres_f_res_f_res_150673;
                                    loopres_f_res_150652 = loopres_f_res_f_res_150674;
                                }
                                loopres_150644 = loopres_f_res_150649;
                                loopres_150645 = loopres_f_res_150650;
                                loopres_150646 = loopres_f_res_150651;
                                loopres_150647 = loopres_f_res_150652;
                            }
                            
                            bool loop_while_tmp_165728 = loopres_150647;
                            int64_t p_tmp_165729 = loopres_150644;
                            int64_t p_tmp_165730 = loopres_150645;
                            int64_t p_tmp_165731 = loopres_150646;
                            
                            loop_while_150626 = loop_while_tmp_165728;
                            p_150627 = p_tmp_165729;
                            p_150628 = p_tmp_165730;
                            p_150629 = p_tmp_165731;
                        }
                        defunc_0_f_res_150622 = loop_while_150626;
                        defunc_0_f_res_150623 = p_150627;
                        defunc_0_f_res_150624 = p_150628;
                        defunc_0_f_res_150625 = p_150629;
                        ((int64_t *) mem_164952.mem)[i_164726] = defunc_0_f_res_150624;
                        ((int64_t *) mem_164954.mem)[i_164726] = defunc_0_f_res_150625;
                    }
                    
                    int64_t bytes_164968 = (int64_t) 8 * ret_150812;
                    
                    if (cond_150810) {
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164952, "mem_164952") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164954, "mem_164954") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc(ctx, &mem_164971, bytes_164968, "mem_164971")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165740 = 0; nest_i_165740 < (int64_t) 1; nest_i_165740++) {
                            ((int64_t *) mem_164971.mem)[nest_i_165740] = (int64_t) 0;
                        }
                        if (memblock_alloc(ctx, &mem_164969, bytes_164968, "mem_164969")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165741 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        tmp_offs_165741 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165741 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        
                        int64_t tmp_offs_165742 = (int64_t) 0;
                        
                        if (!(tmp_offs_165742 == (int64_t) 0)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        }
                        tmp_offs_165742 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164954.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165742 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164969, "mem_164969") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164971, "mem_164971") != 0)
                            return 1;
                    }
                    if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
                        return 1;
                    
                    int64_t tmp_150827 = add64((int64_t) 1, p_150595);
                    
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164942, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164977.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164944, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164974.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
                        return 1;
                    
                    bool loop_cond_150840 = slt64(tmp_150827, numberOfWindows_131071);
                    bool loop_while_tmp_165722 = loop_cond_150840;
                    int64_t p_tmp_165723 = tmp_150827;
                    
                    loop_while_150594 = loop_while_tmp_165722;
                    p_150595 = p_tmp_165723;
                }
                defunc_0_windowed_partitionFunc_res_150590 = loop_while_150594;
                defunc_0_windowed_partitionFunc_res_150591 = p_150595;
                if (mem_164985_cached_sizze_166028 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164985, &mem_164985_cached_sizze_166028, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_164987_cached_sizze_166029 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164987, &mem_164987_cached_sizze_166029, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_164733 = 0; i_164733 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; i_164733++) {
                    int64_t eta_p_150847 = ((int64_t *) mem_164942)[i_164733];
                    int64_t min_res_150848 = smin64(gt_rhs_150410, eta_p_150847);
                    bool x_150849 = sle64((int64_t) 0, min_res_150848);
                    bool y_150850 = slt64(min_res_150848, nR_131064);
                    bool bounds_check_150851 = x_150849 && y_150850;
                    bool index_certs_150852;
                    
                    if (!bounds_check_150851) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150848, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:274:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool cond_150854 = i_164733 == zeze_rhs_150843;
                    int64_t ri_next_150855;
                    
                    if (cond_150854) {
                        ri_next_150855 = nR_131064;
                    } else {
                        int64_t tmp_150856 = add64((int64_t) 1, i_164733);
                        bool x_150857 = sle64((int64_t) 0, tmp_150856);
                        bool y_150858 = slt64(tmp_150856, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150859 = x_150857 && y_150858;
                        bool index_certs_150860;
                        
                        if (!bounds_check_150859) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150856, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:275:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t ri_next_f_res_150861 = ((int64_t *) mem_164942)[tmp_150856];
                        
                        ri_next_150855 = ri_next_f_res_150861;
                    }
                    
                    int64_t max_arg1_150862 = sub64(ri_next_150855, (int64_t) 1);
                    int64_t max_res_150863 = smax64((int64_t) 0, max_arg1_150862);
                    bool x_150864 = sle64((int64_t) 0, max_res_150863);
                    bool y_150865 = slt64(max_res_150863, nR_131064);
                    bool bounds_check_150866 = x_150864 && y_150865;
                    bool index_certs_150867;
                    
                    if (!bounds_check_150866) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150863, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:276:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float r_min_150853 = ((float *) tR_mem_164928.mem)[min_res_150848];
                    float r_max_150868 = ((float *) tR_mem_164928.mem)[max_res_150863];
                    bool defunc_0_f_res_150869;
                    int64_t defunc_0_f_res_150870;
                    bool loop_while_150871;
                    int64_t fm_150872;
                    
                    loop_while_150871 = 1;
                    fm_150872 = i_164733;
                    while (loop_while_150871) {
                        bool x_150873 = sle64((int64_t) 0, fm_150872);
                        bool y_150874 = slt64(fm_150872, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150875 = x_150873 && y_150874;
                        bool index_certs_150876;
                        
                        if (!bounds_check_150875) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) fm_150872, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:281:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150877 = ((int64_t *) mem_164944)[fm_150872];
                        int64_t min_res_150878 = smin64(gt_rhs_150410, loopres_150877);
                        bool x_150879 = sle64((int64_t) 0, min_res_150878);
                        bool y_150880 = slt64(min_res_150878, nR_131064);
                        bool bounds_check_150881 = x_150879 && y_150880;
                        bool index_certs_150882;
                        
                        if (!bounds_check_150881) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150878, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:282:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150884 = sle64(zeze_rhs_150843, fm_150872);
                        int64_t si_next_150885;
                        
                        if (cond_150884) {
                            si_next_150885 = nR_131064;
                        } else {
                            int64_t tmp_150886 = add64((int64_t) 1, fm_150872);
                            bool x_150887 = sle64((int64_t) 0, tmp_150886);
                            bool y_150888 = slt64(tmp_150886, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150889 = x_150887 && y_150888;
                            bool index_certs_150890;
                            
                            if (!bounds_check_150889) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150886, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:283:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150891 = ((int64_t *) mem_164944)[tmp_150886];
                            
                            si_next_150885 = si_next_f_res_150891;
                        }
                        
                        int64_t max_arg1_150892 = sub64(si_next_150885, (int64_t) 1);
                        int64_t max_res_150893 = smax64(min_res_150878, max_arg1_150892);
                        bool x_150894 = sle64((int64_t) 0, max_res_150893);
                        bool y_150895 = slt64(max_res_150893, nR_131064);
                        bool bounds_check_150896 = x_150894 && y_150895;
                        bool index_certs_150897;
                        
                        if (!bounds_check_150896) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150893, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:284:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150899 = smin64(zeze_rhs_150843, si_next_150885);
                        bool x_150900 = sle64((int64_t) 0, min_res_150899);
                        bool y_150901 = slt64(min_res_150899, nR_131064);
                        bool bounds_check_150902 = x_150900 && y_150901;
                        bool index_certs_150903;
                        
                        if (!bounds_check_150902) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150899, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:285:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150905 = sub64(min_res_150878, (int64_t) 1);
                        int64_t max_res_150906 = smax64((int64_t) 0, max_arg1_150905);
                        bool x_150907 = sle64((int64_t) 0, max_res_150906);
                        bool y_150908 = slt64(max_res_150906, nR_131064);
                        bool bounds_check_150909 = x_150907 && y_150908;
                        bool index_certs_150910;
                        
                        if (!bounds_check_150909) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150906, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:286:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151506 = tS_start_150427 + min_res_150878;
                        float s_min_150883 = ((float *) tS_mem_164929.mem)[slice_151506];
                        int64_t slice_151505 = tS_start_150427 + max_res_150893;
                        float s_max_150898 = ((float *) tS_mem_164929.mem)[slice_151505];
                        int64_t slice_151504 = tS_start_150427 + min_res_150899;
                        float s_nextMin_150904 = ((float *) tS_mem_164929.mem)[slice_151504];
                        int64_t slice_151503 = tS_start_150427 + max_res_150906;
                        float s_prevMax_150911 = ((float *) tS_mem_164929.mem)[slice_151503];
                        bool defunc_0_gt_res_150912 = s_min_150883 < r_min_150853;
                        bool loopres_150913;
                        int64_t loopres_150914;
                        
                        if (defunc_0_gt_res_150912) {
                            bool defunc_0_leq_res_157760 = r_min_150853 <= s_max_150898;
                            bool loopres_t_res_157761;
                            int64_t loopres_t_res_157762;
                            
                            if (defunc_0_leq_res_157760) {
                                loopres_t_res_157761 = 0;
                                loopres_t_res_157762 = fm_150872;
                            } else {
                                bool defunc_0_leq_res_157763 = r_min_150853 <= s_nextMin_150904;
                                int64_t zgze_lhs_157764 = add64((int64_t) 1, fm_150872);
                                bool tmp_f_res_157765 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, zgze_lhs_157764);
                                bool x_157766 = !defunc_0_leq_res_157763;
                                bool y_157767 = tmp_f_res_157765 && x_157766;
                                bool tmp_157768 = defunc_0_leq_res_157763 || y_157767;
                                bool loopres_t_res_f_res_157769 = !tmp_157768;
                                
                                loopres_t_res_157761 = loopres_t_res_f_res_157769;
                                loopres_t_res_157762 = zgze_lhs_157764;
                            }
                            loopres_150913 = loopres_t_res_157761;
                            loopres_150914 = loopres_t_res_157762;
                        } else {
                            bool defunc_0_leq_res_150925 = s_prevMax_150911 <= r_min_150853;
                            int64_t zlze_lhs_150926 = sub64(fm_150872, (int64_t) 1);
                            bool tmp_f_res_150927 = sle64(zlze_lhs_150926, (int64_t) 0);
                            bool x_150928 = !defunc_0_leq_res_150925;
                            bool y_150929 = tmp_f_res_150927 && x_150928;
                            bool tmp_150930 = defunc_0_leq_res_150925 || y_150929;
                            int64_t max_res_150931 = smax64((int64_t) 0, zlze_lhs_150926);
                            bool loopres_f_res_150932 = !tmp_150930;
                            
                            loopres_150913 = loopres_f_res_150932;
                            loopres_150914 = max_res_150931;
                        }
                        
                        bool loop_while_tmp_165745 = loopres_150913;
                        int64_t fm_tmp_165746 = loopres_150914;
                        
                        loop_while_150871 = loop_while_tmp_165745;
                        fm_150872 = fm_tmp_165746;
                    }
                    defunc_0_f_res_150869 = loop_while_150871;
                    defunc_0_f_res_150870 = fm_150872;
                    
                    bool defunc_0_f_res_150934;
                    int64_t defunc_0_f_res_150935;
                    bool loop_while_150936;
                    int64_t lm_150937;
                    
                    loop_while_150936 = 1;
                    lm_150937 = i_164733;
                    while (loop_while_150936) {
                        bool x_150938 = sle64((int64_t) 0, lm_150937);
                        bool y_150939 = slt64(lm_150937, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150940 = x_150938 && y_150939;
                        bool index_certs_150941;
                        
                        if (!bounds_check_150940) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lm_150937, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:297:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150942 = ((int64_t *) mem_164944)[lm_150937];
                        int64_t min_res_150943 = smin64(gt_rhs_150410, loopres_150942);
                        bool x_150944 = sle64((int64_t) 0, min_res_150943);
                        bool y_150945 = slt64(min_res_150943, nR_131064);
                        bool bounds_check_150946 = x_150944 && y_150945;
                        bool index_certs_150947;
                        
                        if (!bounds_check_150946) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150943, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:298:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150949 = sle64(zeze_rhs_150843, lm_150937);
                        int64_t si_next_150950;
                        
                        if (cond_150949) {
                            si_next_150950 = nR_131064;
                        } else {
                            int64_t tmp_150951 = add64((int64_t) 1, lm_150937);
                            bool x_150952 = sle64((int64_t) 0, tmp_150951);
                            bool y_150953 = slt64(tmp_150951, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150954 = x_150952 && y_150953;
                            bool index_certs_150955;
                            
                            if (!bounds_check_150954) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150951, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:299:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150956 = ((int64_t *) mem_164944)[tmp_150951];
                            
                            si_next_150950 = si_next_f_res_150956;
                        }
                        
                        int64_t max_arg1_150957 = sub64(si_next_150950, (int64_t) 1);
                        int64_t max_res_150958 = smax64(min_res_150943, max_arg1_150957);
                        bool x_150959 = sle64((int64_t) 0, max_res_150958);
                        bool y_150960 = slt64(max_res_150958, nR_131064);
                        bool bounds_check_150961 = x_150959 && y_150960;
                        bool index_certs_150962;
                        
                        if (!bounds_check_150961) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150958, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:300:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150964 = smin64(zeze_rhs_150843, si_next_150950);
                        bool x_150965 = sle64((int64_t) 0, min_res_150964);
                        bool y_150966 = slt64(min_res_150964, nR_131064);
                        bool bounds_check_150967 = x_150965 && y_150966;
                        bool index_certs_150968;
                        
                        if (!bounds_check_150967) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150964, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:301:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150970 = sub64(min_res_150943, (int64_t) 1);
                        int64_t max_res_150971 = smax64((int64_t) 0, max_arg1_150970);
                        bool x_150972 = sle64((int64_t) 0, max_res_150971);
                        bool y_150973 = slt64(max_res_150971, nR_131064);
                        bool bounds_check_150974 = x_150972 && y_150973;
                        bool index_certs_150975;
                        
                        if (!bounds_check_150974) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150971, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:302:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151502 = tS_start_150427 + min_res_150943;
                        float s_min_150948 = ((float *) tS_mem_164929.mem)[slice_151502];
                        int64_t slice_151501 = tS_start_150427 + max_res_150958;
                        float s_max_150963 = ((float *) tS_mem_164929.mem)[slice_151501];
                        int64_t slice_151500 = tS_start_150427 + min_res_150964;
                        float s_nextMin_150969 = ((float *) tS_mem_164929.mem)[slice_151500];
                        int64_t slice_151499 = tS_start_150427 + max_res_150971;
                        float s_prevMax_150976 = ((float *) tS_mem_164929.mem)[slice_151499];
                        bool defunc_0_gt_res_150977 = r_max_150868 < s_max_150963;
                        bool loopres_150978;
                        int64_t loopres_150979;
                        
                        if (defunc_0_gt_res_150977) {
                            bool defunc_0_leq_res_157770 = s_min_150948 <= r_max_150868;
                            bool loopres_t_res_157771;
                            int64_t loopres_t_res_157772;
                            
                            if (defunc_0_leq_res_157770) {
                                loopres_t_res_157771 = 0;
                                loopres_t_res_157772 = lm_150937;
                            } else {
                                bool defunc_0_leq_res_157773 = s_prevMax_150976 <= r_max_150868;
                                int64_t zlze_lhs_157774 = sub64(lm_150937, (int64_t) 1);
                                bool tmp_f_res_157775 = sle64(zlze_lhs_157774, (int64_t) 0);
                                bool x_157776 = !defunc_0_leq_res_157773;
                                bool y_157777 = tmp_f_res_157775 && x_157776;
                                bool tmp_157778 = defunc_0_leq_res_157773 || y_157777;
                                int64_t max_res_157779 = smax64((int64_t) 0, zlze_lhs_157774);
                                bool loopres_t_res_f_res_157780 = !tmp_157778;
                                
                                loopres_t_res_157771 = loopres_t_res_f_res_157780;
                                loopres_t_res_157772 = max_res_157779;
                            }
                            loopres_150978 = loopres_t_res_157771;
                            loopres_150979 = loopres_t_res_157772;
                        } else {
                            bool defunc_0_leq_res_150991 = r_max_150868 <= s_nextMin_150969;
                            int64_t tmp_150992 = add64((int64_t) 1, lm_150937);
                            bool loopres_f_res_150993 = !defunc_0_leq_res_150991;
                            
                            loopres_150978 = loopres_f_res_150993;
                            loopres_150979 = tmp_150992;
                        }
                        
                        bool loop_cond_t_res_150994 = slt64(loopres_150979, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool x_150995 = loopres_150978 && loop_cond_t_res_150994;
                        bool loop_while_tmp_165747 = x_150995;
                        int64_t lm_tmp_165748 = loopres_150979;
                        
                        loop_while_150936 = loop_while_tmp_165747;
                        lm_150937 = lm_tmp_165748;
                    }
                    defunc_0_f_res_150934 = loop_while_150936;
                    defunc_0_f_res_150935 = lm_150937;
                    ((int64_t *) mem_164985)[i_164733] = defunc_0_f_res_150870;
                    ((int64_t *) mem_164987)[i_164733] = defunc_0_f_res_150935;
                }
                
                int64_t ext_165121;
                int64_t ext_165120;
                int64_t ext_165119;
                int64_t ext_165118;
                bool defunc_0_join_chunks_res_150999;
                int64_t defunc_0_join_chunks_res_151000;
                bool loop_while_151003;
                int64_t p_151004;
                int64_t ctx_param_ext_165000;
                int64_t ctx_param_ext_165001;
                int64_t ctx_param_ext_165003;
                int64_t ctx_param_ext_165004;
                
                if (memblock_set(ctx, &mem_param_165002, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165005, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165000 = (int64_t) 0;
                ctx_param_ext_165001 = (int64_t) 1;
                ctx_param_ext_165003 = (int64_t) 0;
                ctx_param_ext_165004 = (int64_t) 1;
                loop_while_151003 = loop_cond_150998;
                p_151004 = (int64_t) 0;
                while (loop_while_151003) {
                    bool x_151007 = sle64((int64_t) 0, p_151004);
                    bool y_151008 = slt64(p_151004, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151009 = x_151007 && y_151008;
                    bool index_certs_151010;
                    
                    if (!bounds_check_151009) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:334:22-34\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t loopres_151011 = ((int64_t *) mem_164985)[p_151004];
                    int64_t loopres_151012 = ((int64_t *) mem_164987)[p_151004];
                    int64_t min_res_151013 = smin64(zeze_rhs_150843, loopres_151012);
                    bool cond_151014 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, loopres_151011);
                    bool cond_151018 = slt64(min_res_151013, (int64_t) 0);
                    bool protect_assert_disj_151020 = bounds_check_151009 || cond_151018;
                    bool protect_assert_disj_165535 = cond_151014 || protect_assert_disj_151020;
                    bool index_certs_151021;
                    
                    if (!protect_assert_disj_165535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:338:19-32\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_151024 = add64((int64_t) 1, p_151004);
                    bool cond_151025 = zeze_lhs_151024 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    bool x_151027 = sle64((int64_t) 0, zeze_lhs_151024);
                    bool y_151028 = slt64(zeze_lhs_151024, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151029 = x_151027 && y_151028;
                    bool protect_assert_disj_151030 = cond_151025 || bounds_check_151029;
                    bool protect_assert_disj_151031 = cond_151018 || protect_assert_disj_151030;
                    bool protect_assert_disj_165538 = cond_151014 || protect_assert_disj_151031;
                    bool index_certs_151032;
                    
                    if (!protect_assert_disj_165538) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151024, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:339:49-64\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_165532 = !cond_151014;
                    bool x_151019 = !cond_151018;
                    bool protect_cond_conj_165536 = x_151019 && x_165532;
                    int64_t loopres_f_res_f_res_151022;
                    
                    if (protect_cond_conj_165536) {
                        int64_t x_157781 = ((int64_t *) mem_164942)[p_151004];
                        
                        loopres_f_res_f_res_151022 = x_157781;
                    } else {
                        loopres_f_res_f_res_151022 = (int64_t) 0;
                    }
                    
                    bool x_151026 = !cond_151025;
                    bool protect_cond_conj_151033 = x_151019 && x_151026;
                    bool protect_cond_conj_165539 = protect_cond_conj_151033 && x_165532;
                    int64_t r_end_f_res_151034;
                    
                    if (protect_cond_conj_165539) {
                        int64_t x_157782 = ((int64_t *) mem_164942)[zeze_lhs_151024];
                        
                        r_end_f_res_151034 = x_157782;
                    } else {
                        r_end_f_res_151034 = (int64_t) 0;
                    }
                    
                    int64_t r_end_151036;
                    
                    if (cond_151025) {
                        r_end_151036 = nR_131064;
                    } else {
                        r_end_151036 = r_end_f_res_151034;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 = sub64(r_end_151036, loopres_f_res_f_res_151022);
                    int64_t ext_165110;
                    
                    if (cond_151018) {
                        ext_165110 = ctx_param_ext_165000;
                    } else {
                        ext_165110 = (int64_t) 0;
                    }
                    
                    int64_t ext_165109;
                    
                    if (cond_151018) {
                        ext_165109 = ctx_param_ext_165001;
                    } else {
                        ext_165109 = (int64_t) 1;
                    }
                    
                    int64_t ext_165107;
                    
                    if (cond_151018) {
                        ext_165107 = ctx_param_ext_165003;
                    } else {
                        ext_165107 = (int64_t) 0;
                    }
                    
                    int64_t ext_165106;
                    
                    if (cond_151018) {
                        ext_165106 = ctx_param_ext_165004;
                    } else {
                        ext_165106 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165006 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037;
                    int64_t ext_165116;
                    
                    if (cond_151014) {
                        ext_165116 = ctx_param_ext_165000;
                    } else {
                        ext_165116 = ext_165110;
                    }
                    
                    int64_t ext_165115;
                    
                    if (cond_151014) {
                        ext_165115 = ctx_param_ext_165001;
                    } else {
                        ext_165115 = ext_165109;
                    }
                    
                    int64_t ext_165113;
                    
                    if (cond_151014) {
                        ext_165113 = ctx_param_ext_165003;
                    } else {
                        ext_165113 = ext_165107;
                    }
                    
                    int64_t ext_165112;
                    
                    if (cond_151014) {
                        ext_165112 = ctx_param_ext_165004;
                    } else {
                        ext_165112 = ext_165106;
                    }
                    
                    int64_t loopres_151015;
                    
                    if (cond_151014) {
                        loopres_151015 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    } else {
                        loopres_151015 = zeze_lhs_151024;
                    }
                    if (cond_151014) {
                        if (memblock_set(ctx, &ext_mem_165117, &mem_param_165002, "mem_param_165002") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &mem_param_165005, "mem_param_165005") != 0)
                            return 1;
                    } else {
                        if (cond_151018) {
                            if (memblock_set(ctx, &ext_mem_165111, &mem_param_165002, "mem_param_165002") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_param_165005, "mem_param_165005") != 0)
                                return 1;
                        } else {
                            bool empty_slice_151040 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 == (int64_t) 0;
                            int64_t m_151041 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, (int64_t) 1);
                            int64_t i_p_m_t_s_151042 = add64(loopres_f_res_f_res_151022, m_151041);
                            bool zzero_leq_i_p_m_t_s_151043 = sle64((int64_t) 0, i_p_m_t_s_151042);
                            bool i_p_m_t_s_leq_w_151044 = slt64(i_p_m_t_s_151042, nR_131064);
                            bool zzero_lte_i_151045 = sle64((int64_t) 0, loopres_f_res_f_res_151022);
                            bool i_lte_j_151046 = sle64(loopres_f_res_f_res_151022, r_end_151036);
                            bool y_151047 = i_p_m_t_s_leq_w_151044 && zzero_lte_i_151045;
                            bool y_151048 = zzero_leq_i_p_m_t_s_151043 && y_151047;
                            bool forwards_ok_151049 = i_lte_j_151046 && y_151048;
                            bool ok_or_empty_151050 = empty_slice_151040 || forwards_ok_151049;
                            bool index_certs_151051;
                            
                            if (!ok_or_empty_151050) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_151022, ":", (long long) r_end_151036, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:340:16-33\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_151054 = sle64(loopres_151011, min_res_151013);
                            bool loop_not_taken_151059 = !loop_cond_151054;
                            bool protect_assert_disj_151060 = loop_not_taken_151059 || nonzzero_157453;
                            bool nonzzero_cert_151061;
                            
                            if (!protect_assert_disj_151060) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165759 = 0; nest_i_165759 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165759++) {
                                ((int64_t *) mem_165007.mem)[nest_i_165759] = (int64_t) -1;
                            }
                            if (memblock_alloc(ctx, &mem_165009, bytes_165006, "mem_165009")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165760 = 0; nest_i_165760 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165760++) {
                                ((int64_t *) mem_165009.mem)[nest_i_165760] = (int64_t) 0;
                            }
                            
                            int64_t zm_lhs_151055 = add64(extParallelism_131072, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                            int64_t zs_lhs_151056 = sub64(zm_lhs_151055, (int64_t) 1);
                            int64_t numIter_151062 = sdiv_safe64(zs_lhs_151056, extParallelism_131072);
                            bool loop_cond_151063 = slt64((int64_t) 0, numIter_151062);
                            bool loop_not_taken_151064 = !loop_cond_151063;
                            bool loopres_f_res_f_res_151065;
                            int64_t loopres_f_res_f_res_151066;
                            bool loop_while_151069;
                            int64_t dp_151070;
                            
                            if (memblock_set(ctx, &mem_param_165012, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_165015, &mem_165007, "mem_165007") != 0)
                                return 1;
                            loop_while_151069 = loop_cond_151054;
                            dp_151070 = loopres_151011;
                            while (loop_while_151069) {
                                bool x_151073 = sle64((int64_t) 0, dp_151070);
                                bool y_151074 = slt64(dp_151070, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151075 = x_151073 && y_151074;
                                bool index_certs_151076;
                                
                                if (!bounds_check_151075) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_151070, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:344:21-38\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_151077 = ((int64_t *) mem_164944)[dp_151070];
                                int64_t zeze_lhs_151078 = add64((int64_t) 1, dp_151070);
                                bool cond_151079 = zeze_lhs_151078 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                                bool x_151080 = !cond_151079;
                                bool x_151081 = sle64((int64_t) 0, zeze_lhs_151078);
                                bool y_151082 = slt64(zeze_lhs_151078, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151083 = x_151081 && y_151082;
                                bool protect_assert_disj_151084 = cond_151079 || bounds_check_151083;
                                bool index_certs_151085;
                                
                                if (!protect_assert_disj_151084) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151078, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:345:55-74\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_151086;
                                
                                if (x_151080) {
                                    int64_t x_157783 = ((int64_t *) mem_164944)[zeze_lhs_151078];
                                    
                                    s_end_f_res_151086 = x_157783;
                                } else {
                                    s_end_f_res_151086 = (int64_t) 0;
                                }
                                
                                int64_t s_end_151088;
                                
                                if (cond_151079) {
                                    s_end_151088 = nR_131064;
                                } else {
                                    s_end_151088 = s_end_f_res_151086;
                                }
                                
                                int64_t j_m_i_151089 = sub64(s_end_151088, loopres_151077);
                                bool empty_slice_151090 = j_m_i_151089 == (int64_t) 0;
                                int64_t m_151091 = sub64(j_m_i_151089, (int64_t) 1);
                                int64_t i_p_m_t_s_151092 = add64(loopres_151077, m_151091);
                                bool zzero_leq_i_p_m_t_s_151093 = sle64((int64_t) 0, i_p_m_t_s_151092);
                                bool i_p_m_t_s_leq_w_151094 = slt64(i_p_m_t_s_151092, nR_131064);
                                bool zzero_lte_i_151095 = sle64((int64_t) 0, loopres_151077);
                                bool i_lte_j_151096 = sle64(loopres_151077, s_end_151088);
                                bool y_151097 = i_p_m_t_s_leq_w_151094 && zzero_lte_i_151095;
                                bool y_151098 = zzero_leq_i_p_m_t_s_151093 && y_151097;
                                bool forwards_ok_151099 = i_lte_j_151096 && y_151098;
                                bool ok_or_empty_151100 = empty_slice_151090 || forwards_ok_151099;
                                bool index_certs_151101;
                                
                                if (!ok_or_empty_151100) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151077, ":", (long long) s_end_151088, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  ftSMJ.fut:346:18-35\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_151104 = slt64((int64_t) 0, j_m_i_151089);
                                bool loop_not_taken_151105 = !cond_151104;
                                bool x_151106 = sle64((int64_t) 0, m_151091);
                                bool y_151107 = slt64(m_151091, j_m_i_151089);
                                bool bounds_check_151111 = x_151106 && y_151107;
                                bool protect_assert_disj_151112 = loop_not_taken_151105 || bounds_check_151111;
                                bool protect_assert_disj_151113 = loop_not_taken_151064 || protect_assert_disj_151112;
                                bool index_certs_151114;
                                
                                if (!protect_assert_disj_151113) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151091, "] out of bounds for array of shape [", (long long) j_m_i_151089, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_151498 = tS_start_150427 + loopres_151077;
                                int64_t find_joinTuples_arg3_151103 = add64(join_chunks_arg3_150568, loopres_151077);
                                bool protect_cond_conj_151108 = loop_cond_151063 && cond_151104;
                                float s_min_t_res_151109;
                                
                                if (protect_cond_conj_151108) {
                                    float x_157784 = ((float *) tS_mem_164929.mem)[slice_151498];
                                    
                                    s_min_t_res_151109 = x_157784;
                                } else {
                                    s_min_t_res_151109 = 0.0F;
                                }
                                
                                float s_max_t_res_151115;
                                
                                if (protect_cond_conj_151108) {
                                    int64_t slice_157785 = tS_start_150427 + i_p_m_t_s_151092;
                                    float x_157786 = ((float *) tS_mem_164929.mem)[slice_157785];
                                    
                                    s_max_t_res_151115 = x_157786;
                                } else {
                                    s_max_t_res_151115 = 0.0F;
                                }
                                
                                int64_t bytes_165022 = (int64_t) 4 * j_m_i_151089;
                                int64_t ext_165061;
                                int64_t ext_165060;
                                int64_t ext_165059;
                                int64_t ext_165058;
                                bool defunc_0_find_joinTuples_res_151117;
                                int64_t defunc_0_find_joinTuples_res_151118;
                                bool loop_while_151121;
                                int64_t p_151122;
                                int64_t ctx_param_ext_165016;
                                int64_t ctx_param_ext_165017;
                                int64_t ctx_param_ext_165019;
                                int64_t ctx_param_ext_165020;
                                
                                if (memblock_set(ctx, &mem_param_165018, &mem_165009, "mem_165009") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165021, &mem_165007, "mem_165007") != 0)
                                    return 1;
                                ctx_param_ext_165016 = (int64_t) 0;
                                ctx_param_ext_165017 = (int64_t) 1;
                                ctx_param_ext_165019 = (int64_t) 0;
                                ctx_param_ext_165020 = (int64_t) 1;
                                loop_while_151121 = loop_cond_151063;
                                p_151122 = (int64_t) 0;
                                while (loop_while_151121) {
                                    int64_t start_151125 = mul64(extParallelism_131072, p_151122);
                                    int64_t min_arg1_151126 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, start_151125);
                                    int64_t min_res_151127 = smin64(extParallelism_131072, min_arg1_151126);
                                    int64_t iter_R_151128 = add64(start_151125, min_res_151127);
                                    bool empty_slice_151129 = min_res_151127 == (int64_t) 0;
                                    int64_t m_151130 = sub64(min_res_151127, (int64_t) 1);
                                    int64_t i_p_m_t_s_151131 = add64(start_151125, m_151130);
                                    bool zzero_leq_i_p_m_t_s_151132 = sle64((int64_t) 0, i_p_m_t_s_151131);
                                    bool i_p_m_t_s_leq_w_151133 = slt64(i_p_m_t_s_151131, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                                    bool zzero_lte_i_151134 = sle64((int64_t) 0, start_151125);
                                    bool i_lte_j_151135 = sle64(start_151125, iter_R_151128);
                                    bool y_151136 = i_p_m_t_s_leq_w_151133 && zzero_lte_i_151134;
                                    bool y_151137 = zzero_leq_i_p_m_t_s_151132 && y_151136;
                                    bool forwards_ok_151138 = i_lte_j_151135 && y_151137;
                                    bool ok_or_empty_151139 = empty_slice_151129 || forwards_ok_151138;
                                    bool index_certs_151140;
                                    
                                    if (!ok_or_empty_151139) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_151125, ":", (long long) iter_R_151128, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151147 = slt64(m_151130, min_res_151127);
                                    bool x_151146 = sle64((int64_t) 0, m_151130);
                                    bool bounds_check_151148 = x_151146 && y_151147;
                                    bool index_certs_151149;
                                    
                                    if (!bounds_check_151148) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151130, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151143 = slt64((int64_t) 0, min_res_151127);
                                    bool index_certs_151144;
                                    
                                    if (!y_151143) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:197:133-136\n   #2  ftRelational.fut:186:1-197:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_151141 = loopres_f_res_f_res_151022 + start_151125;
                                    int64_t slice_151150 = loopres_f_res_f_res_151022 + i_p_m_t_s_151131;
                                    float r_max_151151 = ((float *) tR_mem_164928.mem)[slice_151150];
                                    float s_max_151153;
                                    
                                    if (cond_151104) {
                                        s_max_151153 = s_max_t_res_151115;
                                    } else {
                                        s_max_151153 = r_max_151151;
                                    }
                                    
                                    float r_min_151145 = ((float *) tR_mem_164928.mem)[slice_151141];
                                    bool defunc_0_gt_res_151154 = s_max_151153 < r_min_151145;
                                    float s_min_151152;
                                    
                                    if (cond_151104) {
                                        s_min_151152 = s_min_t_res_151109;
                                    } else {
                                        s_min_151152 = r_min_151145;
                                    }
                                    
                                    bool defunc_0_gt_res_151158 = r_max_151151 < s_min_151152;
                                    int64_t ext_165050;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165050 = ctx_param_ext_165016;
                                    } else {
                                        ext_165050 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165049;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165049 = ctx_param_ext_165017;
                                    } else {
                                        ext_165049 = (int64_t) 1;
                                    }
                                    
                                    int64_t ext_165047;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165047 = ctx_param_ext_165019;
                                    } else {
                                        ext_165047 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165046;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165046 = ctx_param_ext_165020;
                                    } else {
                                        ext_165046 = (int64_t) 1;
                                    }
                                    
                                    int64_t bytes_165026 = (int64_t) 8 * min_res_151127;
                                    int64_t ext_165056;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165056 = ctx_param_ext_165016;
                                    } else {
                                        ext_165056 = ext_165050;
                                    }
                                    
                                    int64_t ext_165055;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165055 = ctx_param_ext_165017;
                                    } else {
                                        ext_165055 = ext_165049;
                                    }
                                    
                                    int64_t ext_165053;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165053 = ctx_param_ext_165019;
                                    } else {
                                        ext_165053 = ext_165047;
                                    }
                                    
                                    int64_t ext_165052;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165052 = ctx_param_ext_165020;
                                    } else {
                                        ext_165052 = ext_165046;
                                    }
                                    
                                    int64_t loopres_151155;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        if (memblock_set(ctx, &ext_mem_165057, &mem_param_165018, "mem_param_165018") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &mem_param_165021, "mem_param_165021") != 0)
                                            return 1;
                                        loopres_151155 = numIter_151062;
                                    } else {
                                        int64_t loopres_f_res_151159;
                                        
                                        if (defunc_0_gt_res_151158) {
                                            int64_t tmp_157789 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_param_165018, "mem_param_165018") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_param_165021, "mem_param_165021") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_157789;
                                        } else {
                                            if (memblock_alloc(ctx, &mem_165023, bytes_165022, "mem_165023")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) tS_mem_164929.mem, slice_151498, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151089});
                                            if (futrts_indicesWithIncrement_12206(ctx, &ext_mem_165025, mem_165023, j_m_i_151089, find_joinTuples_arg3_151103) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
                                                return 1;
                                            if (mem_165027_cached_sizze_166030 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165027, &mem_165027_cached_sizze_166030, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            if (mem_165029_cached_sizze_166031 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166031, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            for (int64_t i_164744 = 0; i_164744 < min_res_151127; i_164744++) {
                                                int64_t slice_164903 = slice_151141 + i_164744;
                                                float eta_p_151167 = ((float *) tR_mem_164928.mem)[slice_164903];
                                                int64_t defunc_0_reduce_comm_res_157790;
                                                float defunc_0_reduce_comm_res_157791;
                                                int64_t defunc_0_reduce_comm_res_157792;
                                                int64_t redout_164736;
                                                float redout_164737;
                                                int64_t redout_164738;
                                                
                                                redout_164736 = (int64_t) -1;
                                                redout_164737 = eta_p_151167;
                                                redout_164738 = (int64_t) 0;
                                                for (int64_t i_164739 = 0; i_164739 < j_m_i_151089; i_164739++) {
                                                    int64_t x_151171 = ((int64_t *) ext_mem_165025.mem)[i_164739];
                                                    int64_t slice_164902 = slice_151498 + i_164739;
                                                    float x_151172 = ((float *) tS_mem_164929.mem)[slice_164902];
                                                    bool defunc_0_neq_res_151180 = redout_164737 == eta_p_151167;
                                                    bool defunc_0_neq_res_151181 = !defunc_0_neq_res_151180;
                                                    bool cond_f_res_151182 = slt64(redout_164736, (int64_t) 0);
                                                    bool y_151183 = defunc_0_neq_res_151180 && cond_f_res_151182;
                                                    bool cond_151184 = defunc_0_neq_res_151181 || y_151183;
                                                    bool defunc_0_neq_res_151185 = x_151172 == eta_p_151167;
                                                    bool defunc_0_neq_res_151186 = !defunc_0_neq_res_151185;
                                                    bool cond_t_res_f_res_151187 = slt64(x_151171, (int64_t) 0);
                                                    bool y_151188 = defunc_0_neq_res_151185 && cond_t_res_f_res_151187;
                                                    bool cond_t_res_151189 = defunc_0_neq_res_151186 || y_151188;
                                                    bool x_151190 = cond_151184 && cond_t_res_151189;
                                                    int64_t defunc_0_op_res_151191;
                                                    float defunc_0_op_res_151192;
                                                    int64_t defunc_0_op_res_151193;
                                                    
                                                    if (x_151190) {
                                                        defunc_0_op_res_151191 = (int64_t) -1;
                                                        defunc_0_op_res_151192 = eta_p_151167;
                                                        defunc_0_op_res_151193 = (int64_t) 0;
                                                    } else {
                                                        int64_t defunc_0_op_res_f_res_151194;
                                                        float defunc_0_op_res_f_res_151195;
                                                        int64_t defunc_0_op_res_f_res_151196;
                                                        
                                                        if (cond_151184) {
                                                            defunc_0_op_res_f_res_151194 = x_151171;
                                                            defunc_0_op_res_f_res_151195 = x_151172;
                                                            defunc_0_op_res_f_res_151196 = (int64_t) 1;
                                                        } else {
                                                            float defunc_0_op_res_f_res_f_res_151197;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151197 = redout_164737;
                                                            } else {
                                                                defunc_0_op_res_f_res_f_res_151197 = eta_p_151167;
                                                            }
                                                            
                                                            int64_t defunc_0_op_res_f_res_f_res_151198;
                                                            int64_t defunc_0_op_res_f_res_f_res_151199;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151198 = redout_164736;
                                                                defunc_0_op_res_f_res_f_res_151199 = redout_164738;
                                                            } else {
                                                                int64_t min_res_151200 = smin64(x_151171, redout_164736);
                                                                int64_t tmp_151201 = add64((int64_t) 1, redout_164738);
                                                                
                                                                defunc_0_op_res_f_res_f_res_151198 = min_res_151200;
                                                                defunc_0_op_res_f_res_f_res_151199 = tmp_151201;
                                                            }
                                                            defunc_0_op_res_f_res_151194 = defunc_0_op_res_f_res_f_res_151198;
                                                            defunc_0_op_res_f_res_151195 = defunc_0_op_res_f_res_f_res_151197;
                                                            defunc_0_op_res_f_res_151196 = defunc_0_op_res_f_res_f_res_151199;
                                                        }
                                                        defunc_0_op_res_151191 = defunc_0_op_res_f_res_151194;
                                                        defunc_0_op_res_151192 = defunc_0_op_res_f_res_151195;
                                                        defunc_0_op_res_151193 = defunc_0_op_res_f_res_151196;
                                                    }
                                                    
                                                    int64_t redout_tmp_165779 = defunc_0_op_res_151191;
                                                    float redout_tmp_165780 = defunc_0_op_res_151192;
                                                    int64_t redout_tmp_165781 = defunc_0_op_res_151193;
                                                    
                                                    redout_164736 = redout_tmp_165779;
                                                    redout_164737 = redout_tmp_165780;
                                                    redout_164738 = redout_tmp_165781;
                                                }
                                                defunc_0_reduce_comm_res_157790 = redout_164736;
                                                defunc_0_reduce_comm_res_157791 = redout_164737;
                                                defunc_0_reduce_comm_res_157792 = redout_164738;
                                                ((int64_t *) mem_165027)[i_164744] = defunc_0_reduce_comm_res_157790;
                                                ((int64_t *) mem_165029)[i_164744] = defunc_0_reduce_comm_res_157792;
                                            }
                                            if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
                                                return 1;
                                            if (memblock_alloc(ctx, &mem_165043, bytes_165006, "mem_165043")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165021.mem, ctx_param_ext_165019, (int64_t []) {ctx_param_ext_165020}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165027, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            if (memblock_alloc(ctx, &mem_165045, bytes_165006, "mem_165045")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165018.mem, ctx_param_ext_165016, (int64_t []) {ctx_param_ext_165017}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165029, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            
                                            int64_t tmp_151206 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_165045, "mem_165045") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_165043, "mem_165043") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_151206;
                                        }
                                        if (memblock_set(ctx, &ext_mem_165057, &ext_mem_165051, "ext_mem_165051") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &ext_mem_165048, "ext_mem_165048") != 0)
                                            return 1;
                                        loopres_151155 = loopres_f_res_151159;
                                    }
                                    
                                    bool loop_cond_151207 = slt64(loopres_151155, numIter_151062);
                                    
                                    if (memblock_set(ctx, &mem_param_tmp_165767, &ext_mem_165057, "ext_mem_165057") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_tmp_165768, &ext_mem_165054, "ext_mem_165054") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_165769 = ext_165056;
                                    int64_t ctx_param_ext_tmp_165770 = ext_165055;
                                    int64_t ctx_param_ext_tmp_165771 = ext_165053;
                                    int64_t ctx_param_ext_tmp_165772 = ext_165052;
                                    bool loop_while_tmp_165773 = loop_cond_151207;
                                    int64_t p_tmp_165774 = loopres_151155;
                                    
                                    if (memblock_set(ctx, &mem_param_165018, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_165021, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
                                        return 1;
                                    ctx_param_ext_165016 = ctx_param_ext_tmp_165769;
                                    ctx_param_ext_165017 = ctx_param_ext_tmp_165770;
                                    ctx_param_ext_165019 = ctx_param_ext_tmp_165771;
                                    ctx_param_ext_165020 = ctx_param_ext_tmp_165772;
                                    loop_while_151121 = loop_while_tmp_165773;
                                    p_151122 = p_tmp_165774;
                                }
                                if (memblock_set(ctx, &ext_mem_165063, &mem_param_165018, "mem_param_165018") != 0)
                                    return 1;
                                if (memblock_set(ctx, &ext_mem_165062, &mem_param_165021, "mem_param_165021") != 0)
                                    return 1;
                                ext_165061 = ctx_param_ext_165016;
                                ext_165060 = ctx_param_ext_165017;
                                ext_165059 = ctx_param_ext_165019;
                                ext_165058 = ctx_param_ext_165020;
                                defunc_0_find_joinTuples_res_151117 = loop_while_151121;
                                defunc_0_find_joinTuples_res_151118 = p_151122;
                                if (memblock_alloc(ctx, &mem_165065, bytes_165006, "mem_165065")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164749 = 0; i_164749 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164749++) {
                                    int64_t eta_p_151209 = ((int64_t *) mem_param_165015.mem)[i_164749];
                                    int64_t eta_p_151210 = ((int64_t *) ext_mem_165062.mem)[ext_165059 + i_164749 * ext_165058];
                                    bool cond_151211 = slt64(eta_p_151209, (int64_t) 0);
                                    int64_t lifted_lambda_res_151212;
                                    
                                    if (cond_151211) {
                                        lifted_lambda_res_151212 = eta_p_151210;
                                    } else {
                                        lifted_lambda_res_151212 = eta_p_151209;
                                    }
                                    ((int64_t *) mem_165065.mem)[i_164749] = lifted_lambda_res_151212;
                                }
                                if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
                                    return 1;
                                if (memblock_alloc(ctx, &mem_165073, bytes_165006, "mem_165073")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164753 = 0; i_164753 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164753++) {
                                    int64_t eta_p_151214 = ((int64_t *) mem_param_165012.mem)[i_164753];
                                    int64_t eta_p_151215 = ((int64_t *) ext_mem_165063.mem)[ext_165061 + i_164753 * ext_165060];
                                    int64_t defunc_0_f_res_151216 = add64(eta_p_151214, eta_p_151215);
                                    
                                    ((int64_t *) mem_165073.mem)[i_164753] = defunc_0_f_res_151216;
                                }
                                if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
                                    return 1;
                                
                                bool loop_cond_151217 = sle64(zeze_lhs_151078, min_res_151013);
                                
                                if (memblock_set(ctx, &mem_param_tmp_165761, &mem_165073, "mem_165073") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_tmp_165762, &mem_165065, "mem_165065") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_165763 = loop_cond_151217;
                                int64_t dp_tmp_165764 = zeze_lhs_151078;
                                
                                if (memblock_set(ctx, &mem_param_165012, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165015, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
                                    return 1;
                                loop_while_151069 = loop_while_tmp_165763;
                                dp_151070 = dp_tmp_165764;
                            }
                            if (memblock_set(ctx, &ext_mem_165085, &mem_param_165012, "mem_param_165012") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165084, &mem_param_165015, "mem_param_165015") != 0)
                                return 1;
                            loopres_f_res_f_res_151065 = loop_while_151069;
                            loopres_f_res_f_res_151066 = dp_151070;
                            if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
                                return 1;
                            if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (mem_165087_cached_sizze_166032 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165087, &mem_165087_cached_sizze_166032, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164757 = 0; i_164757 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164757++) {
                                int64_t slice_164901 = loopres_f_res_f_res_151022 + i_164757;
                                int64_t eta_p_151220 = ((int64_t *) mem_param_165005.mem)[ctx_param_ext_165003 + slice_164901 * ctx_param_ext_165004];
                                int64_t eta_p_151221 = ((int64_t *) ext_mem_165084.mem)[i_164757];
                                bool cond_151222 = slt64(eta_p_151220, (int64_t) 0);
                                int64_t lifted_lambda_res_151223;
                                
                                if (cond_151222) {
                                    lifted_lambda_res_151223 = eta_p_151221;
                                } else {
                                    lifted_lambda_res_151223 = eta_p_151220;
                                }
                                ((int64_t *) mem_165087)[i_164757] = lifted_lambda_res_151223;
                            }
                            if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
                                return 1;
                            if (mem_165095_cached_sizze_166033 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165095, &mem_165095_cached_sizze_166033, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164761 = 0; i_164761 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164761++) {
                                int64_t slice_164900 = loopres_f_res_f_res_151022 + i_164761;
                                int64_t eta_p_151226 = ((int64_t *) mem_param_165002.mem)[ctx_param_ext_165000 + slice_164900 * ctx_param_ext_165001];
                                int64_t eta_p_151227 = ((int64_t *) ext_mem_165085.mem)[i_164761];
                                int64_t defunc_0_f_res_151228 = add64(eta_p_151226, eta_p_151227);
                                
                                ((int64_t *) mem_165095)[i_164761] = defunc_0_f_res_151228;
                            }
                            if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165103, bytes_164931, "mem_165103")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165005.mem, ctx_param_ext_165003, (int64_t []) {ctx_param_ext_165004}, (int64_t []) {nR_131064});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165087, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_alloc(ctx, &mem_165105, bytes_164931, "mem_165105")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165002.mem, ctx_param_ext_165000, (int64_t []) {ctx_param_ext_165001}, (int64_t []) {nR_131064});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165095, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_set(ctx, &ext_mem_165111, &mem_165105, "mem_165105") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_165103, "mem_165103") != 0)
                                return 1;
                        }
                        if (memblock_set(ctx, &ext_mem_165117, &ext_mem_165111, "ext_mem_165111") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &ext_mem_165108, "ext_mem_165108") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_151233 = slt64(loopres_151015, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165749, &ext_mem_165117, "ext_mem_165117") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165750, &ext_mem_165114, "ext_mem_165114") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165751 = ext_165116;
                    int64_t ctx_param_ext_tmp_165752 = ext_165115;
                    int64_t ctx_param_ext_tmp_165753 = ext_165113;
                    int64_t ctx_param_ext_tmp_165754 = ext_165112;
                    bool loop_while_tmp_165755 = loop_cond_151233;
                    int64_t p_tmp_165756 = loopres_151015;
                    
                    if (memblock_set(ctx, &mem_param_165002, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165005, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
                        return 1;
                    ctx_param_ext_165000 = ctx_param_ext_tmp_165751;
                    ctx_param_ext_165001 = ctx_param_ext_tmp_165752;
                    ctx_param_ext_165003 = ctx_param_ext_tmp_165753;
                    ctx_param_ext_165004 = ctx_param_ext_tmp_165754;
                    loop_while_151003 = loop_while_tmp_165755;
                    p_151004 = p_tmp_165756;
                }
                if (memblock_set(ctx, &ext_mem_165123, &mem_param_165002, "mem_param_165002") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165122, &mem_param_165005, "mem_param_165005") != 0)
                    return 1;
                ext_165121 = ctx_param_ext_165000;
                ext_165120 = ctx_param_ext_165001;
                ext_165119 = ctx_param_ext_165003;
                ext_165118 = ctx_param_ext_165004;
                defunc_0_join_chunks_res_150999 = loop_while_151003;
                defunc_0_join_chunks_res_151000 = p_151004;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165123, "ext_mem_165123") != 0)
                    return 1;
                ext_165176 = ext_165121;
                ext_165175 = ext_165120;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165122, "ext_mem_165122") != 0)
                    return 1;
                ext_165173 = ext_165119;
                ext_165172 = ext_165118;
            }
            if (memblock_alloc(ctx, &mem_165179, bytes_164931, "mem_165179")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164765 = 0; i_164765 < nR_131064; i_164765++) {
                int64_t eta_p_151235 = ((int64_t *) mem_param_164940.mem)[i_164765];
                int64_t eta_p_151236 = ((int64_t *) ext_mem_165174.mem)[ext_165173 + i_164765 * ext_165172];
                bool cond_151237 = slt64(eta_p_151235, (int64_t) 0);
                int64_t lifted_lambda_res_151238;
                
                if (cond_151237) {
                    lifted_lambda_res_151238 = eta_p_151236;
                } else {
                    lifted_lambda_res_151238 = eta_p_151235;
                }
                ((int64_t *) mem_165179.mem)[i_164765] = lifted_lambda_res_151238;
            }
            if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165187, bytes_164931, "mem_165187")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < nR_131064; i_164769++) {
                int64_t eta_p_151240 = ((int64_t *) mem_param_164937.mem)[i_164769];
                int64_t eta_p_151241 = ((int64_t *) ext_mem_165177.mem)[ext_165176 + i_164769 * ext_165175];
                int64_t defunc_0_f_res_151242 = add64(eta_p_151240, eta_p_151241);
                
                ((int64_t *) mem_165187.mem)[i_164769] = defunc_0_f_res_151242;
            }
            if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
                return 1;
            
            float leq_lhs_151247 = ((float *) tS_mem_164929.mem)[i_p_m_t_s_150433];
            float leq_rhs_151249 = ((float *) tR_mem_164928.mem)[gt_rhs_150410];
            bool defunc_0_leq_res_151250 = leq_lhs_151247 <= leq_rhs_151249;
            int64_t nextIter_151251;
            
            if (defunc_0_leq_res_151250) {
                int64_t nextIter_t_res_157804 = add64((int64_t) 1, p_150424);
                
                nextIter_151251 = nextIter_t_res_157804;
            } else {
                nextIter_151251 = numIter_150404;
            }
            if (memblock_set(ctx, &ext_mem_165199, &mem_165187, "mem_165187") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_165179, "mem_165179") != 0)
                return 1;
            loopres_150448 = nextIter_151251;
        }
        
        bool loop_cond_151253 = slt64(loopres_150448, numIter_150404);
        
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        
        bool loop_while_tmp_165701 = loop_cond_151253;
        int64_t p_tmp_165702 = loopres_150448;
        
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        loop_while_150423 = loop_while_tmp_165701;
        p_150424 = p_tmp_165702;
    }
    if (memblock_set(ctx, &ext_mem_165205, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165204, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    defunc_0_mergeJoin_res_150419 = loop_while_150423;
    defunc_0_mergeJoin_res_150420 = p_150424;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
        return 1;
    if (mem_165207_cached_sizze_166036 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165207, &mem_165207_cached_sizze_166036, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165209_cached_sizze_166037 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165209, &mem_165209_cached_sizze_166037, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164779;
    int64_t scanacc_164773 = (int64_t) 0;
    
    for (int64_t i_164776 = 0; i_164776 < nR_131064; i_164776++) {
        int64_t eta_p_157038 = ((int64_t *) ext_mem_165205.mem)[i_164776];
        bool lifted_lambda_res_157039 = slt64((int64_t) 0, eta_p_157038);
        int64_t defunc_0_f_res_157040 = btoi_bool_i64(lifted_lambda_res_157039);
        int64_t defunc_0_op_res_151262 = add64(defunc_0_f_res_157040, scanacc_164773);
        
        ((int64_t *) mem_165207)[i_164776] = defunc_0_op_res_151262;
        ((int64_t *) mem_165209)[i_164776] = defunc_0_f_res_157040;
        
        int64_t scanacc_tmp_165788 = defunc_0_op_res_151262;
        
        scanacc_164773 = scanacc_tmp_165788;
    }
    discard_164779 = scanacc_164773;
    
    bool protect_assert_disj_151269 = zzero_150401 || bounds_check_150413;
    bool index_certs_151270;
    
    if (!protect_assert_disj_151269) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151271;
    
    if (nonzzero_150402) {
        int64_t x_157807 = ((int64_t *) mem_165207)[gt_rhs_150410];
        
        m_f_res_151271 = x_157807;
    } else {
        m_f_res_151271 = (int64_t) 0;
    }
    
    int64_t m_151273;
    
    if (zzero_150401) {
        m_151273 = (int64_t) 0;
    } else {
        m_151273 = m_f_res_151271;
    }
    
    int64_t m_151283 = sub64(m_151273, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151285 = slt64(m_151283, nR_131064);
    bool zzero_leq_i_p_m_t_s_151284 = sle64((int64_t) 0, m_151283);
    bool y_151287 = zzero_leq_i_p_m_t_s_151284 && i_p_m_t_s_leq_w_151285;
    bool i_lte_j_151286 = sle64((int64_t) 0, m_151273);
    bool forwards_ok_151288 = i_lte_j_151286 && y_151287;
    bool eq_x_zz_151280 = (int64_t) 0 == m_f_res_151271;
    bool p_and_eq_x_y_151281 = nonzzero_150402 && eq_x_zz_151280;
    bool empty_slice_151282 = zzero_150401 || p_and_eq_x_y_151281;
    bool ok_or_empty_151289 = empty_slice_151282 || forwards_ok_151288;
    bool index_certs_151290;
    
    if (!ok_or_empty_151289) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151273, "] out of bounds for array of shape [", (long long) nR_131064, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165222 = (int64_t) 8 * m_151273;
    
    if (mem_165223_cached_sizze_166038 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165223, &mem_165223_cached_sizze_166038, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165225_cached_sizze_166039 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165225, &mem_165225_cached_sizze_166039, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165225, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165204.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165227_cached_sizze_166040 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165227, &mem_165227_cached_sizze_166040, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165227, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164930.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    
    int64_t bytes_165228 = (int64_t) 4 * m_151273;
    
    if (mem_165229_cached_sizze_166041 < bytes_165228) {
        err = lexical_realloc(ctx, &mem_165229, &mem_165229_cached_sizze_166041, bytes_165228);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) tR_mem_164928.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    for (int64_t write_iter_164780 = 0; write_iter_164780 < nR_131064; write_iter_164780++) {
        int64_t write_iv_164785 = ((int64_t *) mem_165209)[write_iter_164780];
        int64_t write_iv_164786 = ((int64_t *) mem_165207)[write_iter_164780];
        float write_iv_164787 = ((float *) tR_mem_164928.mem)[write_iter_164780];
        int64_t write_iv_164788 = ((int64_t *) ext_mem_164930.mem)[write_iter_164780];
        int64_t write_iv_164789 = ((int64_t *) ext_mem_165204.mem)[write_iter_164780];
        int64_t write_iv_164790 = ((int64_t *) ext_mem_165205.mem)[write_iter_164780];
        bool cond_157033 = write_iv_164785 == (int64_t) 1;
        int64_t lifted_lambda_res_157034;
        
        if (cond_157033) {
            int64_t lifted_lambda_res_t_res_157808 = sub64(write_iv_164786, (int64_t) 1);
            
            lifted_lambda_res_157034 = lifted_lambda_res_t_res_157808;
        } else {
            lifted_lambda_res_157034 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((float *) mem_165229)[lifted_lambda_res_157034] = write_iv_164787;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165227)[lifted_lambda_res_157034] = write_iv_164788;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165225)[lifted_lambda_res_157034] = write_iv_164789;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165223)[lifted_lambda_res_157034] = write_iv_164790;
        }
    }
    if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
        return 1;
    if (mem_165255_cached_sizze_166042 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165255, &mem_165255_cached_sizze_166042, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165257_cached_sizze_166043 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165257, &mem_165257_cached_sizze_166043, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165259_cached_sizze_166044 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165259, &mem_165259_cached_sizze_166044, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164807;
    int64_t discard_164808;
    int64_t scanacc_164798;
    int64_t scanacc_164799;
    
    scanacc_164798 = (int64_t) 0;
    scanacc_164799 = (int64_t) 0;
    for (int64_t i_164803 = 0; i_164803 < m_151273; i_164803++) {
        int64_t x_157043 = ((int64_t *) mem_165223)[i_164803];
        bool lifted_lambda_res_157045 = slt64((int64_t) 1, x_157043);
        int64_t defunc_0_f_res_157046 = btoi_bool_i64(lifted_lambda_res_157045);
        int64_t lifted_lambda_res_151312 = add64(x_157043, scanacc_164798);
        int64_t defunc_0_op_res_151405 = add64(defunc_0_f_res_157046, scanacc_164799);
        
        ((int64_t *) mem_165255)[i_164803] = lifted_lambda_res_151312;
        ((int64_t *) mem_165257)[i_164803] = defunc_0_op_res_151405;
        ((int64_t *) mem_165259)[i_164803] = defunc_0_f_res_157046;
        
        int64_t scanacc_tmp_165795 = lifted_lambda_res_151312;
        int64_t scanacc_tmp_165796 = defunc_0_op_res_151405;
        
        scanacc_164798 = scanacc_tmp_165795;
        scanacc_164799 = scanacc_tmp_165796;
    }
    discard_164807 = scanacc_164798;
    discard_164808 = scanacc_164799;
    if (mem_165279_cached_sizze_166045 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165279, &mem_165279_cached_sizze_166045, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164811 = 0; i_164811 < m_151273; i_164811++) {
        int64_t zv_lhs_157020 = add64((int64_t) -1, i_164811);
        int64_t tmp_157021 = smod64(zv_lhs_157020, m_151273);
        int64_t lifted_lambda_res_157022 = ((int64_t *) mem_165255)[tmp_157021];
        bool cond_157024 = i_164811 == (int64_t) 0;
        int64_t lifted_lambda_res_157025;
        
        if (cond_157024) {
            lifted_lambda_res_157025 = (int64_t) 0;
        } else {
            lifted_lambda_res_157025 = lifted_lambda_res_157022;
        }
        ((int64_t *) mem_165279)[i_164811] = lifted_lambda_res_157025;
    }
    
    bool cond_151324 = slt64((int64_t) 0, m_151273);
    bool y_151325 = slt64(m_151283, m_151273);
    bool bounds_check_151326 = zzero_leq_i_p_m_t_s_151284 && y_151325;
    bool loop_not_taken_151327 = !cond_151324;
    bool protect_assert_disj_151328 = bounds_check_151326 || loop_not_taken_151327;
    bool index_certs_151329;
    
    if (!protect_assert_disj_151328) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  ftSMJ.fut:432:10-41\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:197:133-136\n   #3  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_lhs_151330;
    
    if (cond_151324) {
        int64_t x_157809 = ((int64_t *) mem_165279)[m_151283];
        
        zp_lhs_151330 = x_157809;
    } else {
        zp_lhs_151330 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151332;
    
    if (cond_151324) {
        int64_t x_157810 = ((int64_t *) mem_165223)[m_151283];
        
        n_pairs_t_res_151332 = x_157810;
    } else {
        n_pairs_t_res_151332 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151334 = add64(zp_lhs_151330, n_pairs_t_res_151332);
    int64_t n_pairs_151335;
    
    if (cond_151324) {
        n_pairs_151335 = n_pairs_t_res_151334;
    } else {
        n_pairs_151335 = (int64_t) 0;
    }
    
    int64_t bytes_165286 = (int64_t) 4 * n_pairs_151335;
    int64_t bytes_165288 = (int64_t) 8 * n_pairs_151335;
    bool zzero_151341 = scatter_psizze_131073 == (int64_t) 0;
    bool nonzzero_151342 = !zzero_151341;
    bool nonzzero_cert_151343;
    
    if (!nonzzero_151342) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:197:133-136\n   #3  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_151408 = !empty_slice_151282;
    bool protect_assert_disj_151409 = empty_slice_151282 || bounds_check_151326;
    bool index_certs_151410;
    
    if (!protect_assert_disj_151409) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151411;
    
    if (x_151408) {
        int64_t x_157815 = ((int64_t *) mem_165257)[m_151283];
        
        m_f_res_151411 = x_157815;
    } else {
        m_f_res_151411 = (int64_t) 0;
    }
    
    int64_t m_151413;
    
    if (empty_slice_151282) {
        m_151413 = (int64_t) 0;
    } else {
        m_151413 = m_f_res_151411;
    }
    
    int64_t m_151423 = sub64(m_151413, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151425 = slt64(m_151423, m_151273);
    bool zzero_leq_i_p_m_t_s_151424 = sle64((int64_t) 0, m_151423);
    bool y_151427 = zzero_leq_i_p_m_t_s_151424 && i_p_m_t_s_leq_w_151425;
    bool i_lte_j_151426 = sle64((int64_t) 0, m_151413);
    bool forwards_ok_151428 = i_lte_j_151426 && y_151427;
    bool eq_x_zz_151420 = (int64_t) 0 == m_f_res_151411;
    bool p_and_eq_x_y_151421 = x_151408 && eq_x_zz_151420;
    bool empty_slice_151422 = empty_slice_151282 || p_and_eq_x_y_151421;
    bool ok_or_empty_151429 = empty_slice_151422 || forwards_ok_151428;
    bool index_certs_151430;
    
    if (!ok_or_empty_151429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151413, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:197:133-136\n   #4  ftRelational.fut:186:1-197:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165334 = (int64_t) 8 * m_151413;
    
    if (memblock_alloc(ctx, &mem_165287, bytes_165286, "mem_165287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165801 = 0; nest_i_165801 < n_pairs_151335; nest_i_165801++) {
        ((float *) mem_165287.mem)[nest_i_165801] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_165289, bytes_165288, "mem_165289")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165802 = 0; nest_i_165802 < n_pairs_151335; nest_i_165802++) {
        ((int64_t *) mem_165289.mem)[nest_i_165802] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_165291, bytes_165288, "mem_165291")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165803 = 0; nest_i_165803 < n_pairs_151335; nest_i_165803++) {
        ((int64_t *) mem_165291.mem)[nest_i_165803] = (int64_t) -1;
    }
    
    int64_t zm_lhs_151339 = add64(scatter_psizze_131073, n_pairs_151335);
    int64_t zs_lhs_151340 = sub64(zm_lhs_151339, (int64_t) 1);
    int64_t m_151344 = sdiv64(zs_lhs_151340, scatter_psizze_131073);
    bool loop_cond_151345 = slt64((int64_t) 0, m_151344);
    bool partitioned_scatter_res_151346;
    int64_t partitioned_scatter_res_151350;
    bool loop_while_151351;
    int64_t p_151355;
    
    loop_while_151351 = loop_cond_151345;
    p_151355 = (int64_t) 0;
    while (loop_while_151351) {
        int64_t lower_bound_151356 = mul64(scatter_psizze_131073, p_151355);
        int64_t min_arg1_151357 = add64(scatter_psizze_131073, lower_bound_151356);
        int64_t min_res_151358 = smin64(n_pairs_151335, min_arg1_151357);
        int64_t j_m_i_151359 = sub64(min_res_151358, lower_bound_151356);
        bool empty_slice_151360 = j_m_i_151359 == (int64_t) 0;
        int64_t m_151361 = sub64(j_m_i_151359, (int64_t) 1);
        int64_t i_p_m_t_s_151362 = add64(lower_bound_151356, m_151361);
        bool zzero_leq_i_p_m_t_s_151363 = sle64((int64_t) 0, i_p_m_t_s_151362);
        bool i_p_m_t_s_leq_w_151364 = slt64(i_p_m_t_s_151362, n_pairs_151335);
        bool zzero_lte_i_151365 = sle64((int64_t) 0, lower_bound_151356);
        bool i_lte_j_151366 = sle64(lower_bound_151356, min_res_151358);
        bool y_151367 = i_p_m_t_s_leq_w_151364 && zzero_lte_i_151365;
        bool y_151368 = zzero_leq_i_p_m_t_s_151363 && y_151367;
        bool forwards_ok_151369 = i_lte_j_151366 && y_151368;
        bool ok_or_empty_151370 = empty_slice_151360 || forwards_ok_151369;
        bool index_certs_151371;
        
        if (!ok_or_empty_151370) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_151356, ":", (long long) min_res_151358, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:197:133-136\n   #3  ftRelational.fut:186:1-197:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165301 = (int64_t) 4 * j_m_i_151359;
        int64_t bytes_165303 = (int64_t) 8 * j_m_i_151359;
        
        if (mem_165302_cached_sizze_166046 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165302, &mem_165302_cached_sizze_166046, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_165287.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165304_cached_sizze_166047 < bytes_165303) {
            err = lexical_realloc(ctx, &mem_165304, &mem_165304_cached_sizze_166047, bytes_165303);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165289.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165306_cached_sizze_166048 < bytes_165303) {
            err = lexical_realloc(ctx, &mem_165306, &mem_165306_cached_sizze_166048, bytes_165303);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165291.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        for (int64_t write_iter_164813 = 0; write_iter_164813 < m_151273; write_iter_164813++) {
            int64_t write_iv_164817 = ((int64_t *) mem_165279)[write_iter_164813];
            float write_iv_164818 = ((float *) mem_165229)[write_iter_164813];
            int64_t write_iv_164819 = ((int64_t *) mem_165227)[write_iter_164813];
            int64_t write_iv_164820 = ((int64_t *) mem_165225)[write_iter_164813];
            bool cond_157424 = sle64(lower_bound_151356, write_iv_164817);
            bool cond_t_res_157425 = slt64(write_iv_164817, min_res_151358);
            bool x_157426 = cond_157424 && cond_t_res_157425;
            int64_t lifted_lambda_res_157427;
            
            if (x_157426) {
                int64_t lifted_lambda_res_t_res_157811 = sub64(write_iv_164817, lower_bound_151356);
                
                lifted_lambda_res_157427 = lifted_lambda_res_t_res_157811;
            } else {
                lifted_lambda_res_157427 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((float *) mem_165302)[lifted_lambda_res_157427] = write_iv_164818;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165304)[lifted_lambda_res_157427] = write_iv_164819;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165306)[lifted_lambda_res_157427] = write_iv_164820;
            }
        }
        
        int64_t tmp_151385 = add64((int64_t) 1, p_151355);
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165287.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165289.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165291.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        
        bool loop_cond_151396 = slt64(tmp_151385, m_151344);
        bool loop_while_tmp_165804 = loop_cond_151396;
        int64_t p_tmp_165808 = tmp_151385;
        
        loop_while_151351 = loop_while_tmp_165804;
        p_151355 = p_tmp_165808;
    }
    partitioned_scatter_res_151346 = loop_while_151351;
    partitioned_scatter_res_151350 = p_151355;
    if (mem_165335_cached_sizze_166049 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165335, &mem_165335_cached_sizze_166049, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165335, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    if (mem_165337_cached_sizze_166050 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165337, &mem_165337_cached_sizze_166050, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165337, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165279, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    for (int64_t write_iter_164824 = 0; write_iter_164824 < m_151273; write_iter_164824++) {
        int64_t write_iv_164827 = ((int64_t *) mem_165259)[write_iter_164824];
        int64_t write_iv_164828 = ((int64_t *) mem_165257)[write_iter_164824];
        int64_t write_iv_164829 = ((int64_t *) mem_165279)[write_iter_164824];
        int64_t write_iv_164830 = ((int64_t *) mem_165223)[write_iter_164824];
        bool cond_157008 = write_iv_164827 == (int64_t) 1;
        int64_t lifted_lambda_res_157009;
        
        if (cond_157008) {
            int64_t lifted_lambda_res_t_res_157816 = sub64(write_iv_164828, (int64_t) 1);
            
            lifted_lambda_res_157009 = lifted_lambda_res_t_res_157816;
        } else {
            lifted_lambda_res_157009 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165337)[lifted_lambda_res_157009] = write_iv_164829;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165335)[lifted_lambda_res_157009] = write_iv_164830;
        }
    }
    
    bool cond_151440 = slt64((int64_t) 0, m_151413);
    bool loop_cond_t_res_151441 = slt64(m_151273, n_pairs_151335);
    bool x_151442 = cond_151440 && loop_cond_t_res_151441;
    bool joinTups_to_joinPairs_InnerJoin_res_151443;
    int64_t joinTups_to_joinPairs_InnerJoin_res_151447;
    bool loop_while_151448;
    int64_t p_151452;
    
    if (memblock_set(ctx, &mem_param_165352, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165355, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165358, &mem_165291, "mem_165291") != 0)
        return 1;
    loop_while_151448 = x_151442;
    p_151452 = (int64_t) 0;
    while (loop_while_151448) {
        bool x_151453 = sle64((int64_t) 0, p_151452);
        bool y_151454 = slt64(p_151452, m_151413);
        bool bounds_check_151455 = x_151453 && y_151454;
        bool index_certs_151456;
        
        if (!bounds_check_151455) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151452, "] out of bounds for array of shape [", (long long) m_151413, "].", "-> #0  ftSMJ.fut:447:13-42\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:197:133-136\n   #3  ftRelational.fut:186:1-197:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_151457 = ((int64_t *) mem_165337)[p_151452];
        int64_t loopres_151458 = ((int64_t *) mem_165335)[p_151452];
        bool x_151459 = sle64((int64_t) 0, loopres_151457);
        bool y_151460 = slt64(loopres_151457, n_pairs_151335);
        bool bounds_check_151461 = x_151459 && y_151460;
        bool index_certs_151462;
        
        if (!bounds_check_151461) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:449:52-61\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:197:133-136\n   #3  ftRelational.fut:186:1-197:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165359 = (int64_t) 4 * loopres_151458;
        int64_t bytes_165361 = (int64_t) 8 * loopres_151458;
        int64_t tmp_151473 = add64(loopres_151457, loopres_151458);
        bool empty_slice_151477 = loopres_151458 == (int64_t) 0;
        int64_t m_151478 = sub64(loopres_151458, (int64_t) 1);
        int64_t i_p_m_t_s_151479 = add64(loopres_151457, m_151478);
        bool zzero_leq_i_p_m_t_s_151480 = sle64((int64_t) 0, i_p_m_t_s_151479);
        bool i_p_m_t_s_leq_w_151481 = slt64(i_p_m_t_s_151479, n_pairs_151335);
        bool i_lte_j_151482 = sle64(loopres_151457, tmp_151473);
        bool y_151483 = x_151459 && i_p_m_t_s_leq_w_151481;
        bool y_151484 = zzero_leq_i_p_m_t_s_151480 && y_151483;
        bool forwards_ok_151485 = i_lte_j_151482 && y_151484;
        bool ok_or_empty_151486 = empty_slice_151477 || forwards_ok_151485;
        bool index_certs_151487;
        
        if (!ok_or_empty_151486) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, ":", (long long) tmp_151473, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:453:14-55\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:197:133-136\n   #3  ftRelational.fut:186:1-197:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float loopres_151463 = ((float *) mem_param_165352.mem)[loopres_151457];
        int64_t loopres_151464 = ((int64_t *) mem_param_165355.mem)[loopres_151457];
        int64_t loopres_151465 = ((int64_t *) mem_param_165358.mem)[loopres_151457];
        
        if (mem_165360_cached_sizze_166051 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165360, &mem_165360_cached_sizze_166051, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165822 = 0; nest_i_165822 < loopres_151458; nest_i_165822++) {
            ((float *) mem_165360)[nest_i_165822] = loopres_151463;
        }
        if (mem_165362_cached_sizze_166052 < bytes_165361) {
            err = lexical_realloc(ctx, &mem_165362, &mem_165362_cached_sizze_166052, bytes_165361);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165823 = 0; nest_i_165823 < loopres_151458; nest_i_165823++) {
            ((int64_t *) mem_165362)[nest_i_165823] = loopres_151464;
        }
        if (mem_165364_cached_sizze_166053 < bytes_165361) {
            err = lexical_realloc(ctx, &mem_165364, &mem_165364_cached_sizze_166053, bytes_165361);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164835 = 0; i_164835 < loopres_151458; i_164835++) {
            int64_t tmp_151471 = add64(loopres_151465, i_164835);
            
            ((int64_t *) mem_165364)[i_164835] = tmp_151471;
        }
        
        int64_t tmp_151472 = add64((int64_t) 1, p_151452);
        
        if (memblock_alloc(ctx, &mem_165372, bytes_165286, "mem_165372")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165372.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_165352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165374, bytes_165288, "mem_165374")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165376, bytes_165288, "mem_165376")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165372.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_165360, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165364, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        
        bool cond_151491 = slt64(tmp_151472, m_151413);
        bool x_151492 = loop_cond_t_res_151441 && cond_151491;
        
        if (memblock_set(ctx, &mem_param_tmp_165814, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165815, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165816, &mem_165376, "mem_165376") != 0)
            return 1;
        
        bool loop_while_tmp_165817 = x_151492;
        int64_t p_tmp_165821 = tmp_151472;
        
        if (memblock_set(ctx, &mem_param_165352, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165355, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165358, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        loop_while_151448 = loop_while_tmp_165817;
        p_151452 = p_tmp_165821;
    }
    if (memblock_set(ctx, &ext_mem_165385, &mem_param_165352, "mem_param_165352") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165384, &mem_param_165355, "mem_param_165355") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165383, &mem_param_165358, "mem_param_165358") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_151443 = loop_while_151448;
    joinTups_to_joinPairs_InnerJoin_res_151447 = p_151452;
    if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165387, bytes_165286, "mem_165387")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165389, bytes_165288, "mem_165389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165384.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165391, bytes_165288, "mem_165391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165383.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165389, "mem_165389") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165391, "mem_165391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165695, &mem_165387, "mem_165387") != 0)
        return 1;
    prim_out_165696 = n_pairs_151335;
    if (memblock_set(ctx, &*mem_out_p_166022, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166023, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166024, &mem_out_165695, "mem_out_165695") != 0)
        return 1;
    *out_prim_out_166025 = prim_out_165696;
    
  cleanup:
    {
        free(mem_164942);
        free(mem_164944);
        free(mem_164985);
        free(mem_164987);
        free(mem_165027);
        free(mem_165029);
        free(mem_165087);
        free(mem_165095);
        free(mem_165135);
        free(mem_165137);
        free(mem_165207);
        free(mem_165209);
        free(mem_165223);
        free(mem_165225);
        free(mem_165227);
        free(mem_165229);
        free(mem_165255);
        free(mem_165257);
        free(mem_165259);
        free(mem_165279);
        free(mem_165302);
        free(mem_165304);
        free(mem_165306);
        free(mem_165335);
        free(mem_165337);
        free(mem_165360);
        free(mem_165362);
        free(mem_165364);
        if (memblock_unref(ctx, &mem_165391, "mem_165391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165389, "mem_165389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165387, "mem_165387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165376, "mem_165376") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165358, "mem_param_165358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165355, "mem_param_165355") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165352, "mem_param_165352") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165187, "mem_165187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165179, "mem_165179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165105, "mem_165105") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165103, "mem_165103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165073, "mem_165073") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165065, "mem_165065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165045, "mem_165045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165043, "mem_165043") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165048, "ext_mem_165048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165051, "ext_mem_165051") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165054, "ext_mem_165054") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165057, "ext_mem_165057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165021, "mem_param_165021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165018, "mem_param_165018") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165015, "mem_param_165015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165012, "mem_param_165012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165114, "ext_mem_165114") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165117, "ext_mem_165117") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165005, "mem_param_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165002, "mem_param_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165122, "ext_mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165123, "ext_mem_165123") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164969, "mem_164969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164971, "mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165153, "mem_165153") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165151, "mem_165151") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165156, "ext_mem_165156") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165159, "ext_mem_165159") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165162, "ext_mem_165162") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165165, "ext_mem_165165") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165129, "mem_param_165129") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165126, "mem_param_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165170, "ext_mem_165170") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165171, "ext_mem_165171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165695, "mem_out_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_166054, struct memblock *mem_out_p_166055, struct memblock *mem_out_p_166056, int64_t *out_prim_out_166057, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_121202, int64_t nS_121203, int64_t offset_R_121206, int64_t offset_S_121207, int64_t partitionsPerWindow_121208, int64_t numberOfWindows_121209, int64_t extParallelism_121210, int64_t scatter_psizze_121211)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164942_cached_sizze_166058 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164944_cached_sizze_166059 = 0;
    unsigned char *mem_164944 = NULL;
    int64_t mem_164985_cached_sizze_166060 = 0;
    unsigned char *mem_164985 = NULL;
    int64_t mem_164987_cached_sizze_166061 = 0;
    unsigned char *mem_164987 = NULL;
    int64_t mem_165027_cached_sizze_166062 = 0;
    unsigned char *mem_165027 = NULL;
    int64_t mem_165029_cached_sizze_166063 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165087_cached_sizze_166064 = 0;
    unsigned char *mem_165087 = NULL;
    int64_t mem_165095_cached_sizze_166065 = 0;
    unsigned char *mem_165095 = NULL;
    int64_t mem_165135_cached_sizze_166066 = 0;
    unsigned char *mem_165135 = NULL;
    int64_t mem_165137_cached_sizze_166067 = 0;
    unsigned char *mem_165137 = NULL;
    int64_t mem_165207_cached_sizze_166068 = 0;
    unsigned char *mem_165207 = NULL;
    int64_t mem_165209_cached_sizze_166069 = 0;
    unsigned char *mem_165209 = NULL;
    int64_t mem_165223_cached_sizze_166070 = 0;
    unsigned char *mem_165223 = NULL;
    int64_t mem_165225_cached_sizze_166071 = 0;
    unsigned char *mem_165225 = NULL;
    int64_t mem_165227_cached_sizze_166072 = 0;
    unsigned char *mem_165227 = NULL;
    int64_t mem_165229_cached_sizze_166073 = 0;
    unsigned char *mem_165229 = NULL;
    int64_t mem_165255_cached_sizze_166074 = 0;
    unsigned char *mem_165255 = NULL;
    int64_t mem_165257_cached_sizze_166075 = 0;
    unsigned char *mem_165257 = NULL;
    int64_t mem_165259_cached_sizze_166076 = 0;
    unsigned char *mem_165259 = NULL;
    int64_t mem_165279_cached_sizze_166077 = 0;
    unsigned char *mem_165279 = NULL;
    int64_t mem_165302_cached_sizze_166078 = 0;
    unsigned char *mem_165302 = NULL;
    int64_t mem_165304_cached_sizze_166079 = 0;
    unsigned char *mem_165304 = NULL;
    int64_t mem_165306_cached_sizze_166080 = 0;
    unsigned char *mem_165306 = NULL;
    int64_t mem_165335_cached_sizze_166081 = 0;
    unsigned char *mem_165335 = NULL;
    int64_t mem_165337_cached_sizze_166082 = 0;
    unsigned char *mem_165337 = NULL;
    int64_t mem_165360_cached_sizze_166083 = 0;
    unsigned char *mem_165360 = NULL;
    int64_t mem_165362_cached_sizze_166084 = 0;
    unsigned char *mem_165362 = NULL;
    int64_t mem_165364_cached_sizze_166085 = 0;
    unsigned char *mem_165364 = NULL;
    struct memblock mem_165391;
    
    mem_165391.references = NULL;
    
    struct memblock mem_165389;
    
    mem_165389.references = NULL;
    
    struct memblock mem_165387;
    
    mem_165387.references = NULL;
    
    struct memblock mem_param_tmp_165816;
    
    mem_param_tmp_165816.references = NULL;
    
    struct memblock mem_param_tmp_165815;
    
    mem_param_tmp_165815.references = NULL;
    
    struct memblock mem_param_tmp_165814;
    
    mem_param_tmp_165814.references = NULL;
    
    struct memblock mem_165376;
    
    mem_165376.references = NULL;
    
    struct memblock mem_165374;
    
    mem_165374.references = NULL;
    
    struct memblock mem_165372;
    
    mem_165372.references = NULL;
    
    struct memblock mem_param_165358;
    
    mem_param_165358.references = NULL;
    
    struct memblock mem_param_165355;
    
    mem_param_165355.references = NULL;
    
    struct memblock mem_param_165352;
    
    mem_param_165352.references = NULL;
    
    struct memblock ext_mem_165383;
    
    ext_mem_165383.references = NULL;
    
    struct memblock ext_mem_165384;
    
    ext_mem_165384.references = NULL;
    
    struct memblock ext_mem_165385;
    
    ext_mem_165385.references = NULL;
    
    struct memblock mem_165291;
    
    mem_165291.references = NULL;
    
    struct memblock mem_165289;
    
    mem_165289.references = NULL;
    
    struct memblock mem_165287;
    
    mem_165287.references = NULL;
    
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_165187;
    
    mem_165187.references = NULL;
    
    struct memblock mem_165179;
    
    mem_165179.references = NULL;
    
    struct memblock mem_param_tmp_165750;
    
    mem_param_tmp_165750.references = NULL;
    
    struct memblock mem_param_tmp_165749;
    
    mem_param_tmp_165749.references = NULL;
    
    struct memblock mem_165105;
    
    mem_165105.references = NULL;
    
    struct memblock mem_165103;
    
    mem_165103.references = NULL;
    
    struct memblock mem_param_tmp_165762;
    
    mem_param_tmp_165762.references = NULL;
    
    struct memblock mem_param_tmp_165761;
    
    mem_param_tmp_165761.references = NULL;
    
    struct memblock mem_165073;
    
    mem_165073.references = NULL;
    
    struct memblock mem_165065;
    
    mem_165065.references = NULL;
    
    struct memblock mem_param_tmp_165768;
    
    mem_param_tmp_165768.references = NULL;
    
    struct memblock mem_param_tmp_165767;
    
    mem_param_tmp_165767.references = NULL;
    
    struct memblock mem_165045;
    
    mem_165045.references = NULL;
    
    struct memblock mem_165043;
    
    mem_165043.references = NULL;
    
    struct memblock ext_mem_165025;
    
    ext_mem_165025.references = NULL;
    
    struct memblock mem_165023;
    
    mem_165023.references = NULL;
    
    struct memblock ext_mem_165048;
    
    ext_mem_165048.references = NULL;
    
    struct memblock ext_mem_165051;
    
    ext_mem_165051.references = NULL;
    
    struct memblock ext_mem_165054;
    
    ext_mem_165054.references = NULL;
    
    struct memblock ext_mem_165057;
    
    ext_mem_165057.references = NULL;
    
    struct memblock mem_param_165021;
    
    mem_param_165021.references = NULL;
    
    struct memblock mem_param_165018;
    
    mem_param_165018.references = NULL;
    
    struct memblock ext_mem_165062;
    
    ext_mem_165062.references = NULL;
    
    struct memblock ext_mem_165063;
    
    ext_mem_165063.references = NULL;
    
    struct memblock mem_param_165015;
    
    mem_param_165015.references = NULL;
    
    struct memblock mem_param_165012;
    
    mem_param_165012.references = NULL;
    
    struct memblock ext_mem_165084;
    
    ext_mem_165084.references = NULL;
    
    struct memblock ext_mem_165085;
    
    ext_mem_165085.references = NULL;
    
    struct memblock mem_165009;
    
    mem_165009.references = NULL;
    
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock ext_mem_165114;
    
    ext_mem_165114.references = NULL;
    
    struct memblock ext_mem_165117;
    
    ext_mem_165117.references = NULL;
    
    struct memblock mem_param_165005;
    
    mem_param_165005.references = NULL;
    
    struct memblock mem_param_165002;
    
    mem_param_165002.references = NULL;
    
    struct memblock ext_mem_165122;
    
    ext_mem_165122.references = NULL;
    
    struct memblock ext_mem_165123;
    
    ext_mem_165123.references = NULL;
    
    struct memblock mem_164969;
    
    mem_164969.references = NULL;
    
    struct memblock mem_164971;
    
    mem_164971.references = NULL;
    
    struct memblock ext_mem_164974;
    
    ext_mem_164974.references = NULL;
    
    struct memblock ext_mem_164977;
    
    ext_mem_164977.references = NULL;
    
    struct memblock mem_164954;
    
    mem_164954.references = NULL;
    
    struct memblock mem_164952;
    
    mem_164952.references = NULL;
    
    struct memblock mem_param_tmp_165706;
    
    mem_param_tmp_165706.references = NULL;
    
    struct memblock mem_param_tmp_165705;
    
    mem_param_tmp_165705.references = NULL;
    
    struct memblock mem_165153;
    
    mem_165153.references = NULL;
    
    struct memblock mem_165151;
    
    mem_165151.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165131;
    
    mem_165131.references = NULL;
    
    struct memblock ext_mem_165156;
    
    ext_mem_165156.references = NULL;
    
    struct memblock ext_mem_165159;
    
    ext_mem_165159.references = NULL;
    
    struct memblock ext_mem_165162;
    
    ext_mem_165162.references = NULL;
    
    struct memblock ext_mem_165165;
    
    ext_mem_165165.references = NULL;
    
    struct memblock mem_param_165129;
    
    mem_param_165129.references = NULL;
    
    struct memblock mem_param_165126;
    
    mem_param_165126.references = NULL;
    
    struct memblock ext_mem_165170;
    
    ext_mem_165170.references = NULL;
    
    struct memblock ext_mem_165171;
    
    ext_mem_165171.references = NULL;
    
    struct memblock ext_mem_165174;
    
    ext_mem_165174.references = NULL;
    
    struct memblock ext_mem_165177;
    
    ext_mem_165177.references = NULL;
    
    struct memblock ext_mem_165196;
    
    ext_mem_165196.references = NULL;
    
    struct memblock ext_mem_165199;
    
    ext_mem_165199.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock ext_mem_165204;
    
    ext_mem_165204.references = NULL;
    
    struct memblock ext_mem_165205;
    
    ext_mem_165205.references = NULL;
    
    struct memblock mem_164934;
    
    mem_164934.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock ext_mem_164930;
    
    ext_mem_164930.references = NULL;
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165696;
    int64_t zm_lhs_150399 = add64(nR_121202, nS_121203);
    int64_t zs_lhs_150400 = sub64(zm_lhs_150399, (int64_t) 1);
    bool zzero_150401 = nR_121202 == (int64_t) 0;
    bool nonzzero_150402 = !zzero_150401;
    bool nonzzero_cert_150403;
    
    if (!nonzzero_150402) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:379:26-29\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_150404 = sdiv64(zs_lhs_150400, nR_121202);
    
    if (futrts_indicesWithIncrement_12162(ctx, &ext_mem_164930, tR_mem_164928, nR_121202, offset_R_121206) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_164931 = (int64_t) 8 * nR_121202;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165697 = 0; nest_i_165697 < nR_121202; nest_i_165697++) {
        ((int64_t *) mem_164932.mem)[nest_i_165697] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_164934, bytes_164931, "mem_164934")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165698 = 0; nest_i_165698 < nR_121202; nest_i_165698++) {
        ((int64_t *) mem_164934.mem)[nest_i_165698] = (int64_t) 0;
    }
    
    bool loop_cond_150409 = slt64((int64_t) 0, numIter_150404);
    int64_t gt_rhs_150410 = sub64(nR_121202, (int64_t) 1);
    bool x_150411 = sle64((int64_t) 0, gt_rhs_150410);
    bool y_150412 = slt64(gt_rhs_150410, nR_121202);
    bool bounds_check_150413 = x_150411 && y_150412;
    bool loop_not_taken_150414 = !loop_cond_150409;
    bool protect_assert_disj_150415 = bounds_check_150413 || loop_not_taken_150414;
    bool index_certs_150416;
    
    if (!protect_assert_disj_150415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:386:25-33\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t gt_rhs_150417;
    
    if (loop_cond_150409) {
        int32_t x_157438 = ((int32_t *) tR_mem_164928.mem)[gt_rhs_150410];
        
        gt_rhs_150417 = x_157438;
    } else {
        gt_rhs_150417 = 0;
    }
    
    bool defunc_0_mergeJoin_res_150419;
    int64_t defunc_0_mergeJoin_res_150420;
    bool loop_while_150423;
    int64_t p_150424;
    
    if (memblock_set(ctx, &mem_param_164937, &mem_164934, "mem_164934") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &mem_164932, "mem_164932") != 0)
        return 1;
    loop_while_150423 = loop_cond_150409;
    p_150424 = (int64_t) 0;
    while (loop_while_150423) {
        int64_t tS_start_150427 = mul64(nR_121202, p_150424);
        int64_t min_arg1_150428 = add64(nR_121202, tS_start_150427);
        int64_t min_res_150429 = smin64(nS_121203, min_arg1_150428);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 = sub64(min_res_150429, tS_start_150427);
        bool empty_slice_150431 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 == (int64_t) 0;
        int64_t m_150432 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, (int64_t) 1);
        int64_t i_p_m_t_s_150433 = add64(tS_start_150427, m_150432);
        bool zzero_leq_i_p_m_t_s_150434 = sle64((int64_t) 0, i_p_m_t_s_150433);
        bool i_p_m_t_s_leq_w_150435 = slt64(i_p_m_t_s_150433, nS_121203);
        bool zzero_lte_i_150436 = sle64((int64_t) 0, tS_start_150427);
        bool i_lte_j_150437 = sle64(tS_start_150427, min_res_150429);
        bool y_150438 = i_p_m_t_s_leq_w_150435 && zzero_lte_i_150436;
        bool y_150439 = zzero_leq_i_p_m_t_s_150434 && y_150438;
        bool forwards_ok_150440 = i_lte_j_150437 && y_150439;
        bool ok_or_empty_150441 = empty_slice_150431 || forwards_ok_150440;
        bool index_certs_150442;
        
        if (!ok_or_empty_150441) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_150427, ":", (long long) min_res_150429, "] out of bounds for array of shape [", (long long) nS_121203, "].", "-> #0  ftSMJ.fut:385:16-35\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_150444 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
        bool index_certs_150445;
        
        if (!y_150444) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:386:12-19\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t gt_lhs_150446 = ((int32_t *) tS_mem_164929.mem)[tS_start_150427];
        bool defunc_0_gt_res_150447 = slt32(gt_rhs_150417, gt_lhs_150446);
        int64_t loopres_150448;
        
        if (defunc_0_gt_res_150447) {
            if (memblock_set(ctx, &ext_mem_165199, &mem_param_164937, "mem_param_164937") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_param_164940, "mem_param_164940") != 0)
                return 1;
            loopres_150448 = numIter_150404;
        } else {
            bool cond_150451 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, nR_121202);
            bool dim_match_150565 = nR_121202 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            bool protect_assert_disj_165549 = cond_150451 || dim_match_150565;
            bool empty_or_match_cert_150566;
            
            if (!protect_assert_disj_165549) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "] cannot match shape of type `[", (long long) nR_121202, "]i32`.", "-> #0  ftSMJ.fut:394:18-31\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_150572 = slt64((int64_t) 0, numberOfWindows_121209);
            bool y_150575 = slt64((int64_t) 0, nR_121202);
            bool loop_not_taken_150576 = !loop_cond_150572;
            bool protect_assert_disj_150577 = y_150575 || loop_not_taken_150576;
            bool protect_assert_disj_165551 = cond_150451 || protect_assert_disj_150577;
            bool index_certs_150578;
            
            if (!protect_assert_disj_165551) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:264:20-25\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_157450 = add64(nR_121202, extParallelism_121210);
            int64_t zs_lhs_157451 = sub64(zm_lhs_157450, (int64_t) 1);
            bool zzero_157452 = extParallelism_121210 == (int64_t) 0;
            bool nonzzero_157453 = !zzero_157452;
            bool loop_not_taken_165527 = !cond_150451;
            bool protect_assert_disj_165528 = nonzzero_157453 || loop_not_taken_165527;
            bool nonzzero_cert_157454;
            
            if (!protect_assert_disj_165528) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_157455 = sdiv_safe64(zs_lhs_157451, extParallelism_121210);
            bool loop_cond_157456 = slt64((int64_t) 0, numIter_157455);
            bool loop_not_taken_157457 = !y_150444;
            bool loop_not_taken_157458 = !loop_cond_157456;
            bool x_157459 = sle64((int64_t) 0, m_150432);
            bool y_157460 = slt64(m_150432, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
            bool bounds_check_157462 = x_157459 && y_157460;
            bool protect_assert_disj_157463 = loop_not_taken_157457 || bounds_check_157462;
            bool protect_assert_disj_157464 = loop_not_taken_157458 || protect_assert_disj_157463;
            bool protect_assert_disj_165530 = protect_assert_disj_157464 || loop_not_taken_165527;
            bool index_certs_157465;
            
            if (!protect_assert_disj_165530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151246;
            
            if (!bounds_check_157462) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:405:23-44\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151248;
            
            if (!bounds_check_150413) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:405:51-59\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 = mul64(partitionsPerWindow_121208, numberOfWindows_121209);
            int64_t join_chunks_arg3_150568 = add64(offset_S_121207, tS_start_150427);
            int64_t bytes_164941 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
            bool empty_slice_150573 = partitionsPerWindow_121208 == (int64_t) 0;
            int64_t m_150574 = sub64(partitionsPerWindow_121208, (int64_t) 1);
            bool protect_cond_conj_165552 = loop_cond_150572 && loop_not_taken_165527;
            int32_t leq_lhs_150579;
            
            if (protect_cond_conj_165552) {
                int32_t x_157566 = ((int32_t *) tR_mem_164928.mem)[(int64_t) 0];
                
                leq_lhs_150579 = x_157566;
            } else {
                leq_lhs_150579 = 0;
            }
            
            bool defunc_0_leq_res_150583 = sle32(leq_lhs_150579, gt_lhs_150446);
            int32_t lowest_150584;
            
            if (protect_cond_conj_165552) {
                bool loop_not_taken_165542 = !defunc_0_leq_res_150583;
                bool protect_assert_disj_165543 = y_150575 || loop_not_taken_165542;
                bool index_certs_157570;
                
                if (!protect_assert_disj_165543) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:264:44-49\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t lowest_t_res_157571;
                
                if (defunc_0_leq_res_150583) {
                    int32_t x_165544 = ((int32_t *) tR_mem_164928.mem)[(int64_t) 0];
                    
                    lowest_t_res_157571 = x_165544;
                } else {
                    lowest_t_res_157571 = 0;
                }
                
                int32_t x_157569;
                
                if (defunc_0_leq_res_150583) {
                    x_157569 = lowest_t_res_157571;
                } else {
                    bool index_certs_157572;
                    
                    if (!y_150575) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:264:55-60\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    x_157569 = gt_lhs_150446;
                }
                lowest_150584 = x_157569;
            } else {
                lowest_150584 = 0;
            }
            
            int64_t zeze_rhs_150843 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, (int64_t) 1);
            bool loop_cond_150998 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
            bool protect_cond_conj_157461 = y_150444 && loop_cond_157456;
            bool protect_cond_conj_165531 = cond_150451 && protect_cond_conj_157461;
            int32_t s_max_t_res_157466;
            
            if (protect_cond_conj_165531) {
                int32_t x_157467 = ((int32_t *) tS_mem_164929.mem)[i_p_m_t_s_150433];
                
                s_max_t_res_157466 = x_157467;
            } else {
                s_max_t_res_157466 = 0;
            }
            
            int64_t bytes_165130 = (int64_t) 4 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            int64_t ext_165176;
            int64_t ext_165175;
            int64_t ext_165173;
            int64_t ext_165172;
            
            if (cond_150451) {
                int64_t ext_165169;
                int64_t ext_165168;
                int64_t ext_165167;
                int64_t ext_165166;
                bool defunc_0_find_joinTuples_res_157468;
                int64_t defunc_0_find_joinTuples_res_157469;
                bool loop_while_157472;
                int64_t p_157473;
                int64_t ctx_param_ext_165124;
                int64_t ctx_param_ext_165125;
                int64_t ctx_param_ext_165127;
                int64_t ctx_param_ext_165128;
                
                if (memblock_set(ctx, &mem_param_165126, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165129, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165124 = (int64_t) 0;
                ctx_param_ext_165125 = (int64_t) 1;
                ctx_param_ext_165127 = (int64_t) 0;
                ctx_param_ext_165128 = (int64_t) 1;
                loop_while_157472 = loop_cond_157456;
                p_157473 = (int64_t) 0;
                while (loop_while_157472) {
                    int64_t start_157476 = mul64(extParallelism_121210, p_157473);
                    int64_t min_arg1_157477 = sub64(nR_121202, start_157476);
                    int64_t min_res_157478 = smin64(extParallelism_121210, min_arg1_157477);
                    int64_t iter_R_157479 = add64(start_157476, min_res_157478);
                    bool empty_slice_157480 = min_res_157478 == (int64_t) 0;
                    int64_t m_157481 = sub64(min_res_157478, (int64_t) 1);
                    int64_t i_p_m_t_s_157482 = add64(start_157476, m_157481);
                    bool zzero_leq_i_p_m_t_s_157483 = sle64((int64_t) 0, i_p_m_t_s_157482);
                    bool i_p_m_t_s_leq_w_157484 = slt64(i_p_m_t_s_157482, nR_121202);
                    bool zzero_lte_i_157485 = sle64((int64_t) 0, start_157476);
                    bool i_lte_j_157486 = sle64(start_157476, iter_R_157479);
                    bool y_157487 = i_p_m_t_s_leq_w_157484 && zzero_lte_i_157485;
                    bool y_157488 = zzero_leq_i_p_m_t_s_157483 && y_157487;
                    bool forwards_ok_157489 = i_lte_j_157486 && y_157488;
                    bool ok_or_empty_157490 = empty_slice_157480 || forwards_ok_157489;
                    bool index_certs_157491;
                    
                    if (!ok_or_empty_157490) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_157476, ":", (long long) iter_R_157479, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157492 = slt64(m_157481, min_res_157478);
                    bool x_157493 = sle64((int64_t) 0, m_157481);
                    bool bounds_check_157494 = y_157492 && x_157493;
                    bool index_certs_157495;
                    
                    if (!bounds_check_157494) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_157481, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157498 = slt64((int64_t) 0, min_res_157478);
                    bool index_certs_157499;
                    
                    if (!y_157498) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t r_max_157496 = ((int32_t *) tR_mem_164928.mem)[i_p_m_t_s_157482];
                    int32_t s_max_157497;
                    
                    if (y_150444) {
                        s_max_157497 = s_max_t_res_157466;
                    } else {
                        s_max_157497 = r_max_157496;
                    }
                    
                    int32_t r_min_157500 = ((int32_t *) tR_mem_164928.mem)[start_157476];
                    bool defunc_0_gt_res_157501 = slt32(s_max_157497, r_min_157500);
                    int32_t s_min_157502;
                    
                    if (y_150444) {
                        s_min_157502 = gt_lhs_150446;
                    } else {
                        s_min_157502 = r_min_157500;
                    }
                    
                    bool defunc_0_gt_res_157507 = slt32(r_max_157496, s_min_157502);
                    int64_t ext_165158;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165158 = ctx_param_ext_165124;
                    } else {
                        ext_165158 = (int64_t) 0;
                    }
                    
                    int64_t ext_165157;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165157 = ctx_param_ext_165125;
                    } else {
                        ext_165157 = (int64_t) 1;
                    }
                    
                    int64_t ext_165155;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165155 = ctx_param_ext_165127;
                    } else {
                        ext_165155 = (int64_t) 0;
                    }
                    
                    int64_t ext_165154;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165154 = ctx_param_ext_165128;
                    } else {
                        ext_165154 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165134 = (int64_t) 8 * min_res_157478;
                    int64_t ext_165164;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165164 = ctx_param_ext_165124;
                    } else {
                        ext_165164 = ext_165158;
                    }
                    
                    int64_t ext_165163;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165163 = ctx_param_ext_165125;
                    } else {
                        ext_165163 = ext_165157;
                    }
                    
                    int64_t ext_165161;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165161 = ctx_param_ext_165127;
                    } else {
                        ext_165161 = ext_165155;
                    }
                    
                    int64_t ext_165160;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165160 = ctx_param_ext_165128;
                    } else {
                        ext_165160 = ext_165154;
                    }
                    
                    int64_t loopres_157503;
                    
                    if (defunc_0_gt_res_157501) {
                        if (memblock_set(ctx, &ext_mem_165165, &mem_param_165126, "mem_param_165126") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &mem_param_165129, "mem_param_165129") != 0)
                            return 1;
                        loopres_157503 = numIter_157455;
                    } else {
                        int64_t loopres_f_res_157508;
                        
                        if (defunc_0_gt_res_157507) {
                            int64_t tmp_157512 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_param_165126, "mem_param_165126") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_param_165129, "mem_param_165129") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157512;
                        } else {
                            if (memblock_alloc(ctx, &mem_165131, bytes_165130, "mem_165131")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165131.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) tS_mem_164929.mem, tS_start_150427, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430});
                            if (futrts_indicesWithIncrement_12162(ctx, &ext_mem_165133, mem_165131, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, join_chunks_arg3_150568) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
                                return 1;
                            if (mem_165135_cached_sizze_166066 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165135, &mem_165135_cached_sizze_166066, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_165137_cached_sizze_166067 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165137, &mem_165137_cached_sizze_166067, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164719 = 0; i_164719 < min_res_157478; i_164719++) {
                                int64_t slice_164899 = start_157476 + i_164719;
                                int32_t eta_p_157518 = ((int32_t *) tR_mem_164928.mem)[slice_164899];
                                int64_t defunc_0_reduce_comm_res_157519;
                                int32_t defunc_0_reduce_comm_res_157520;
                                int64_t defunc_0_reduce_comm_res_157521;
                                int64_t redout_164711;
                                int32_t redout_164712;
                                int64_t redout_164713;
                                
                                redout_164711 = (int64_t) -1;
                                redout_164712 = eta_p_157518;
                                redout_164713 = (int64_t) 0;
                                for (int64_t i_164714 = 0; i_164714 < dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430; i_164714++) {
                                    int64_t x_157522 = ((int64_t *) ext_mem_165133.mem)[i_164714];
                                    int64_t slice_164898 = tS_start_150427 + i_164714;
                                    int32_t x_157523 = ((int32_t *) tS_mem_164929.mem)[slice_164898];
                                    bool defunc_0_neq_res_157531 = redout_164712 == eta_p_157518;
                                    bool defunc_0_neq_res_157532 = !defunc_0_neq_res_157531;
                                    bool cond_f_res_157533 = slt64(redout_164711, (int64_t) 0);
                                    bool y_157534 = defunc_0_neq_res_157531 && cond_f_res_157533;
                                    bool cond_157535 = defunc_0_neq_res_157532 || y_157534;
                                    bool defunc_0_neq_res_157536 = x_157523 == eta_p_157518;
                                    bool defunc_0_neq_res_157537 = !defunc_0_neq_res_157536;
                                    bool cond_t_res_f_res_157538 = slt64(x_157522, (int64_t) 0);
                                    bool y_157539 = defunc_0_neq_res_157536 && cond_t_res_f_res_157538;
                                    bool cond_t_res_157540 = defunc_0_neq_res_157537 || y_157539;
                                    bool x_157541 = cond_157535 && cond_t_res_157540;
                                    int64_t defunc_0_op_res_157542;
                                    int32_t defunc_0_op_res_157543;
                                    int64_t defunc_0_op_res_157544;
                                    
                                    if (x_157541) {
                                        defunc_0_op_res_157542 = (int64_t) -1;
                                        defunc_0_op_res_157543 = eta_p_157518;
                                        defunc_0_op_res_157544 = (int64_t) 0;
                                    } else {
                                        int64_t defunc_0_op_res_f_res_157545;
                                        int32_t defunc_0_op_res_f_res_157546;
                                        int64_t defunc_0_op_res_f_res_157547;
                                        
                                        if (cond_157535) {
                                            defunc_0_op_res_f_res_157545 = x_157522;
                                            defunc_0_op_res_f_res_157546 = x_157523;
                                            defunc_0_op_res_f_res_157547 = (int64_t) 1;
                                        } else {
                                            int32_t defunc_0_op_res_f_res_f_res_157548;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157548 = redout_164712;
                                            } else {
                                                defunc_0_op_res_f_res_f_res_157548 = eta_p_157518;
                                            }
                                            
                                            int64_t defunc_0_op_res_f_res_f_res_157549;
                                            int64_t defunc_0_op_res_f_res_f_res_157550;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157549 = redout_164711;
                                                defunc_0_op_res_f_res_f_res_157550 = redout_164713;
                                            } else {
                                                int64_t min_res_157551 = smin64(x_157522, redout_164711);
                                                int64_t tmp_157552 = add64((int64_t) 1, redout_164713);
                                                
                                                defunc_0_op_res_f_res_f_res_157549 = min_res_157551;
                                                defunc_0_op_res_f_res_f_res_157550 = tmp_157552;
                                            }
                                            defunc_0_op_res_f_res_157545 = defunc_0_op_res_f_res_f_res_157549;
                                            defunc_0_op_res_f_res_157546 = defunc_0_op_res_f_res_f_res_157548;
                                            defunc_0_op_res_f_res_157547 = defunc_0_op_res_f_res_f_res_157550;
                                        }
                                        defunc_0_op_res_157542 = defunc_0_op_res_f_res_157545;
                                        defunc_0_op_res_157543 = defunc_0_op_res_f_res_157546;
                                        defunc_0_op_res_157544 = defunc_0_op_res_f_res_157547;
                                    }
                                    
                                    int64_t redout_tmp_165717 = defunc_0_op_res_157542;
                                    int32_t redout_tmp_165718 = defunc_0_op_res_157543;
                                    int64_t redout_tmp_165719 = defunc_0_op_res_157544;
                                    
                                    redout_164711 = redout_tmp_165717;
                                    redout_164712 = redout_tmp_165718;
                                    redout_164713 = redout_tmp_165719;
                                }
                                defunc_0_reduce_comm_res_157519 = redout_164711;
                                defunc_0_reduce_comm_res_157520 = redout_164712;
                                defunc_0_reduce_comm_res_157521 = redout_164713;
                                ((int64_t *) mem_165135)[i_164719] = defunc_0_reduce_comm_res_157519;
                                ((int64_t *) mem_165137)[i_164719] = defunc_0_reduce_comm_res_157521;
                            }
                            if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165151, bytes_164931, "mem_165151")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165129.mem, ctx_param_ext_165127, (int64_t []) {ctx_param_ext_165128}, (int64_t []) {nR_121202});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165135, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            if (memblock_alloc(ctx, &mem_165153, bytes_164931, "mem_165153")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165126.mem, ctx_param_ext_165124, (int64_t []) {ctx_param_ext_165125}, (int64_t []) {nR_121202});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165137, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            
                            int64_t tmp_157564 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_165153, "mem_165153") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_165151, "mem_165151") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157564;
                        }
                        if (memblock_set(ctx, &ext_mem_165165, &ext_mem_165159, "ext_mem_165159") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &ext_mem_165156, "ext_mem_165156") != 0)
                            return 1;
                        loopres_157503 = loopres_f_res_157508;
                    }
                    
                    bool loop_cond_157565 = slt64(loopres_157503, numIter_157455);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165705, &ext_mem_165165, "ext_mem_165165") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165706, &ext_mem_165162, "ext_mem_165162") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165707 = ext_165164;
                    int64_t ctx_param_ext_tmp_165708 = ext_165163;
                    int64_t ctx_param_ext_tmp_165709 = ext_165161;
                    int64_t ctx_param_ext_tmp_165710 = ext_165160;
                    bool loop_while_tmp_165711 = loop_cond_157565;
                    int64_t p_tmp_165712 = loopres_157503;
                    
                    if (memblock_set(ctx, &mem_param_165126, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165129, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
                        return 1;
                    ctx_param_ext_165124 = ctx_param_ext_tmp_165707;
                    ctx_param_ext_165125 = ctx_param_ext_tmp_165708;
                    ctx_param_ext_165127 = ctx_param_ext_tmp_165709;
                    ctx_param_ext_165128 = ctx_param_ext_tmp_165710;
                    loop_while_157472 = loop_while_tmp_165711;
                    p_157473 = p_tmp_165712;
                }
                if (memblock_set(ctx, &ext_mem_165171, &mem_param_165126, "mem_param_165126") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165170, &mem_param_165129, "mem_param_165129") != 0)
                    return 1;
                ext_165169 = ctx_param_ext_165124;
                ext_165168 = ctx_param_ext_165125;
                ext_165167 = ctx_param_ext_165127;
                ext_165166 = ctx_param_ext_165128;
                defunc_0_find_joinTuples_res_157468 = loop_while_157472;
                defunc_0_find_joinTuples_res_157469 = p_157473;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165171, "ext_mem_165171") != 0)
                    return 1;
                ext_165176 = ext_165169;
                ext_165175 = ext_165168;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165170, "ext_mem_165170") != 0)
                    return 1;
                ext_165173 = ext_165167;
                ext_165172 = ext_165166;
            } else {
                if (mem_164942_cached_sizze_166058 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_166058, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165720 = 0; nest_i_165720 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165720++) {
                    ((int64_t *) mem_164942)[nest_i_165720] = nR_121202;
                }
                if (mem_164944_cached_sizze_166059 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164944, &mem_164944_cached_sizze_166059, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165721 = 0; nest_i_165721 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165721++) {
                    ((int64_t *) mem_164944)[nest_i_165721] = nR_121202;
                }
                
                bool defunc_0_windowed_partitionFunc_res_150590;
                int64_t defunc_0_windowed_partitionFunc_res_150591;
                bool loop_while_150594;
                int64_t p_150595;
                
                loop_while_150594 = loop_cond_150572;
                p_150595 = (int64_t) 0;
                while (loop_while_150594) {
                    int64_t start_150598 = mul64(partitionsPerWindow_121208, p_150595);
                    int64_t end_150599 = add64(partitionsPerWindow_121208, start_150598);
                    int64_t max_res_150600 = smax64((int64_t) 1, start_150598);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601 = sub64(end_150599, max_res_150600);
                    bool bounds_invalid_upwards_150602 = slt64(end_150599, max_res_150600);
                    bool valid_150603 = !bounds_invalid_upwards_150602;
                    bool range_valid_c_150604;
                    
                    if (!valid_150603) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_150600, "..<", (long long) end_150599, " is invalid.", "-> #0  ftbasics.fut:267:43-68\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_150607 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 == (int64_t) 0;
                    bool nonzzero_150608 = !zzero_150607;
                    bool nonzzero_cert_150609;
                    
                    if (!nonzzero_150608) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:270:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_164951 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool cond_150810 = slt64((int64_t) 0, start_150598);
                    int64_t conc_tmp_150811 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    int64_t ret_150812;
                    
                    if (cond_150810) {
                        ret_150812 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    } else {
                        ret_150812 = conc_tmp_150811;
                    }
                    
                    bool eq_x_y_150820 = partitionsPerWindow_121208 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool eq_x_zz_150821 = partitionsPerWindow_121208 == conc_tmp_150811;
                    bool p_and_eq_x_y_150822 = cond_150810 && eq_x_y_150820;
                    bool not_p_150823 = !cond_150810;
                    bool p_and_eq_x_y_150824 = eq_x_zz_150821 && not_p_150823;
                    bool dim_match_150825 = p_and_eq_x_y_150822 || p_and_eq_x_y_150824;
                    bool empty_or_match_cert_150826;
                    
                    if (!dim_match_150825) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_150812, "] cannot match shape of type `[", (long long) partitionsPerWindow_121208, "](i64, i64)`.", "-> #0  ftbasics.fut:331:5-336:49\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_150828 = add64(m_150574, start_150598);
                    bool zzero_leq_i_p_m_t_s_150829 = sle64((int64_t) 0, i_p_m_t_s_150828);
                    bool i_p_m_t_s_leq_w_150830 = slt64(i_p_m_t_s_150828, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool zzero_lte_i_150831 = sle64((int64_t) 0, start_150598);
                    bool i_lte_j_150832 = sle64(start_150598, end_150599);
                    bool y_150833 = i_p_m_t_s_leq_w_150830 && zzero_lte_i_150831;
                    bool y_150834 = zzero_leq_i_p_m_t_s_150829 && y_150833;
                    bool forwards_ok_150835 = i_lte_j_150832 && y_150834;
                    bool ok_or_empty_150836 = empty_slice_150573 || forwards_ok_150835;
                    bool index_certs_150837;
                    
                    if (!ok_or_empty_150836) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_150598, ":", (long long) end_150599, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftbasics.fut:356:37-74\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_150606 = add64(nR_121202, nR_121202);
                    
                    if (memblock_alloc(ctx, &mem_164952, bytes_164951, "mem_164952")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_164954, bytes_164951, "mem_164954")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164726 = 0; i_164726 < dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601; i_164726++) {
                        int64_t index_primexp_164907 = add64(max_res_150600, i_164726);
                        int64_t zs_lhs_150613 = mul64(zt_rhs_150606, index_primexp_164907);
                        int64_t index_150614 = sdiv64(zs_lhs_150613, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool cond_150615 = slt64(nR_121202, index_150614);
                        int64_t loop_over_150616;
                        
                        if (cond_150615) {
                            loop_over_150616 = nR_121202;
                        } else {
                            loop_over_150616 = index_150614;
                        }
                        
                        int64_t loop_over_150617;
                        
                        if (cond_150615) {
                            int64_t loop_over_t_res_157573 = sub64(index_150614, nR_121202);
                            
                            loop_over_150617 = loop_over_t_res_157573;
                        } else {
                            loop_over_150617 = (int64_t) 0;
                        }
                        
                        int64_t loop_over_150619;
                        
                        if (cond_150615) {
                            int64_t zm_lhs_157574 = sub64(index_150614, nR_121202);
                            int64_t loop_over_t_res_157575 = sub64(zm_lhs_157574, (int64_t) 1);
                            
                            loop_over_150619 = loop_over_t_res_157575;
                        } else {
                            loop_over_150619 = (int64_t) 0;
                        }
                        
                        bool defunc_0_f_res_150622;
                        int64_t defunc_0_f_res_150623;
                        int64_t defunc_0_f_res_150624;
                        int64_t defunc_0_f_res_150625;
                        bool loop_while_150626;
                        int64_t p_150627;
                        int64_t p_150628;
                        int64_t p_150629;
                        
                        loop_while_150626 = 1;
                        p_150627 = loop_over_150619;
                        p_150628 = loop_over_150616;
                        p_150629 = loop_over_150617;
                        while (loop_while_150626) {
                            int64_t zs_lhs_150630 = sub64(p_150628, p_150627);
                            int64_t offset_150631 = sdiv64(zs_lhs_150630, (int64_t) 2);
                            int64_t ai_150632 = sub64(p_150628, offset_150631);
                            int64_t max_arg1_150633 = add64(p_150629, offset_150631);
                            int64_t max_res_150634 = smax64((int64_t) 0, max_arg1_150633);
                            bool cond_150635 = slt64((int64_t) 0, max_res_150634);
                            int32_t b_prev_150636;
                            
                            if (cond_150635) {
                                int64_t tmp_157576 = sub64(max_res_150634, (int64_t) 1);
                                bool x_157577 = sle64((int64_t) 0, tmp_157576);
                                bool y_157578 = slt64(tmp_157576, nR_121202);
                                bool bounds_check_157579 = x_157577 && y_157578;
                                bool index_certs_157580;
                                
                                if (!bounds_check_157579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157576, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:282:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157581 = tS_start_150427 + tmp_157576;
                                int32_t b_prev_t_res_157582 = ((int32_t *) tS_mem_164929.mem)[slice_157581];
                                
                                b_prev_150636 = b_prev_t_res_157582;
                            } else {
                                b_prev_150636 = lowest_150584;
                            }
                            
                            bool cond_150643 = sle64(ai_150632, (int64_t) 0);
                            int64_t loopres_150644;
                            int64_t loopres_150645;
                            int64_t loopres_150646;
                            bool loopres_150647;
                            
                            if (cond_150643) {
                                loopres_150644 = p_150627;
                                loopres_150645 = (int64_t) 0;
                                loopres_150646 = max_res_150634;
                                loopres_150647 = 0;
                            } else {
                                bool cond_150648 = sle64(nR_121202, max_res_150634);
                                int64_t loopres_f_res_150649;
                                int64_t loopres_f_res_150650;
                                int64_t loopres_f_res_150651;
                                bool loopres_f_res_150652;
                                
                                if (cond_150648) {
                                    int64_t min_res_157584 = smin64(gt_rhs_150410, ai_150632);
                                    bool bounds_check_157587 = x_150411 && y_150412;
                                    bool index_certs_157588;
                                    
                                    if (!bounds_check_157587) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:293:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157591 = sle64((int64_t) 0, min_res_157584);
                                    bool y_157592 = slt64(min_res_157584, nR_121202);
                                    bool bounds_check_157593 = x_157591 && y_157592;
                                    bool index_certs_157594;
                                    
                                    if (!bounds_check_157593) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157584, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:293:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157589 = gt_rhs_150410 + tS_start_150427;
                                    int32_t leq_lhs_157590 = ((int32_t *) tS_mem_164929.mem)[slice_157589];
                                    int32_t leq_rhs_157595 = ((int32_t *) tR_mem_164928.mem)[min_res_157584];
                                    bool defunc_0_leq_res_157596 = sle32(leq_lhs_157590, leq_rhs_157595);
                                    int64_t loopres_f_res_t_res_157597;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157597 = ai_150632;
                                    } else {
                                        loopres_f_res_t_res_157597 = p_150628;
                                    }
                                    
                                    bool x_157598 = !defunc_0_leq_res_157596;
                                    int64_t loopres_f_res_t_res_157599;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157599 = nR_121202;
                                    } else {
                                        int64_t tmp_157600 = sub64(gt_rhs_150410, offset_150631);
                                        
                                        loopres_f_res_t_res_157599 = tmp_157600;
                                    }
                                    loopres_f_res_150649 = p_150627;
                                    loopres_f_res_150650 = loopres_f_res_t_res_157597;
                                    loopres_f_res_150651 = loopres_f_res_t_res_157599;
                                    loopres_f_res_150652 = x_157598;
                                } else {
                                    bool cond_150670 = sle64(nR_121202, ai_150632);
                                    int64_t loopres_f_res_f_res_150671;
                                    int64_t loopres_f_res_f_res_150672;
                                    int64_t loopres_f_res_f_res_150673;
                                    bool loopres_f_res_f_res_150674;
                                    
                                    if (cond_150670) {
                                        int64_t min_res_157602 = smin64(gt_rhs_150410, max_res_150634);
                                        bool bounds_check_157605 = x_150411 && y_150412;
                                        bool index_certs_157606;
                                        
                                        if (!bounds_check_157605) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:300:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157608 = sle64((int64_t) 0, min_res_157602);
                                        bool y_157609 = slt64(min_res_157602, nR_121202);
                                        bool bounds_check_157610 = x_157608 && y_157609;
                                        bool index_certs_157611;
                                        
                                        if (!bounds_check_157610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157602, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:300:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int32_t leq_lhs_157607 = ((int32_t *) tR_mem_164928.mem)[gt_rhs_150410];
                                        int64_t slice_157612 = tS_start_150427 + min_res_157602;
                                        int32_t leq_rhs_157613 = ((int32_t *) tS_mem_164929.mem)[slice_157612];
                                        bool defunc_0_leq_res_157614 = sle32(leq_lhs_157607, leq_rhs_157613);
                                        int64_t loopres_f_res_f_res_t_res_157615;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157615 = max_res_150634;
                                        } else {
                                            loopres_f_res_f_res_t_res_157615 = p_150629;
                                        }
                                        
                                        bool x_157616 = !defunc_0_leq_res_157614;
                                        int64_t loopres_f_res_f_res_t_res_157617;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157617 = nR_121202;
                                        } else {
                                            loopres_f_res_f_res_t_res_157617 = gt_rhs_150410;
                                        }
                                        loopres_f_res_f_res_150671 = p_150627;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_t_res_157617;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_t_res_157615;
                                        loopres_f_res_f_res_150674 = x_157616;
                                    } else {
                                        bool cond_150691 = sle64(p_150628, p_150627);
                                        int64_t loopres_f_res_f_res_f_res_150692;
                                        int64_t loopres_f_res_f_res_f_res_150693;
                                        int64_t loopres_f_res_f_res_f_res_150694;
                                        bool loopres_f_res_f_res_f_res_150695;
                                        
                                        if (cond_150691) {
                                            bool cond_157655 = slt64(ai_150632, nR_121202);
                                            int64_t ai_157656;
                                            
                                            if (cond_157655) {
                                                ai_157656 = ai_150632;
                                            } else {
                                                ai_157656 = gt_rhs_150410;
                                            }
                                            
                                            bool x_157669 = sle64((int64_t) 0, ai_157656);
                                            bool y_157670 = slt64(ai_157656, nR_121202);
                                            bool bounds_check_157671 = x_157669 && y_157670;
                                            bool index_certs_157672;
                                            
                                            if (!bounds_check_157671) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_157656, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:234:8-14\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int32_t b_prev_157658;
                                            
                                            if (cond_150635) {
                                                int64_t tmp_157659 = sub64(max_res_150634, (int64_t) 1);
                                                bool x_157660 = sle64((int64_t) 0, tmp_157659);
                                                bool y_157661 = slt64(tmp_157659, nR_121202);
                                                bool bounds_check_157662 = x_157660 && y_157661;
                                                bool index_certs_157663;
                                                
                                                if (!bounds_check_157662) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157659, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:232:31-39\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_157664 = tS_start_150427 + tmp_157659;
                                                int32_t b_prev_t_res_157665 = ((int32_t *) tS_mem_164929.mem)[slice_157664];
                                                
                                                b_prev_157658 = b_prev_t_res_157665;
                                            } else {
                                                bool index_certs_157667;
                                                
                                                if (!y_150575) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:232:45-50\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                b_prev_157658 = gt_lhs_150446;
                                            }
                                            
                                            int32_t gt_lhs_157673 = ((int32_t *) tR_mem_164928.mem)[ai_157656];
                                            bool defunc_0_gt_res_157674 = slt32(b_prev_157658, gt_lhs_157673);
                                            int64_t defunc_0_partFunc_sequential_search_res_157675;
                                            int64_t defunc_0_partFunc_sequential_search_res_157676;
                                            
                                            if (defunc_0_gt_res_157674) {
                                                int64_t zl_rhs_157677 = sub64(nR_121202, max_res_150634);
                                                bool loop_cond_157678 = slt64((int64_t) 0, zl_rhs_157677);
                                                bool defunc_0_partFunc_sequential_search_res_t_res_157679;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157681;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157682;
                                                bool loop_while_157683;
                                                int64_t p_157684;
                                                int64_t p_157685;
                                                int64_t p_157686;
                                                
                                                loop_while_157683 = loop_cond_157678;
                                                p_157684 = ai_157656;
                                                p_157685 = max_res_150634;
                                                p_157686 = (int64_t) 0;
                                                while (loop_while_157683) {
                                                    int64_t i_a_157687 = sub64(ai_157656, p_157686);
                                                    int64_t i_b_157688 = add64(max_res_150634, p_157686);
                                                    int64_t leq_lhs_157689 = sub64(i_a_157687, (int64_t) 1);
                                                    bool x_157690 = sle64((int64_t) 0, leq_lhs_157689);
                                                    bool y_157691 = slt64(leq_lhs_157689, nR_121202);
                                                    bool bounds_check_157692 = x_157690 && y_157691;
                                                    bool index_certs_157693;
                                                    
                                                    if (!bounds_check_157692) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157689, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:240:15-24\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157695 = sle64((int64_t) 0, i_b_157688);
                                                    bool y_157696 = slt64(i_b_157688, nR_121202);
                                                    bool bounds_check_157697 = x_157695 && y_157696;
                                                    bool index_certs_157698;
                                                    
                                                    if (!bounds_check_157697) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157688, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:240:31-38\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    int32_t leq_lhs_157694 = ((int32_t *) tR_mem_164928.mem)[leq_lhs_157689];
                                                    int64_t slice_157699 = tS_start_150427 + i_b_157688;
                                                    int32_t leq_rhs_157700 = ((int32_t *) tS_mem_164929.mem)[slice_157699];
                                                    bool defunc_0_leq_res_157701 = sle32(leq_lhs_157694, leq_rhs_157700);
                                                    int64_t loopres_157702;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157702 = i_a_157687;
                                                    } else {
                                                        loopres_157702 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157703;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157703 = i_b_157688;
                                                    } else {
                                                        loopres_157703 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157704;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157704 = zl_rhs_157677;
                                                    } else {
                                                        int64_t tmp_157705 = add64((int64_t) 1, p_157686);
                                                        
                                                        loopres_157704 = tmp_157705;
                                                    }
                                                    
                                                    bool loop_cond_157706 = slt64(loopres_157704, zl_rhs_157677);
                                                    bool loop_while_tmp_165732 = loop_cond_157706;
                                                    int64_t p_tmp_165733 = loopres_157702;
                                                    int64_t p_tmp_165734 = loopres_157703;
                                                    int64_t p_tmp_165735 = loopres_157704;
                                                    
                                                    loop_while_157683 = loop_while_tmp_165732;
                                                    p_157684 = p_tmp_165733;
                                                    p_157685 = p_tmp_165734;
                                                    p_157686 = p_tmp_165735;
                                                }
                                                defunc_0_partFunc_sequential_search_res_t_res_157679 = loop_while_157683;
                                                defunc_0_partFunc_sequential_search_res_t_res_157680 = p_157684;
                                                defunc_0_partFunc_sequential_search_res_t_res_157681 = p_157685;
                                                defunc_0_partFunc_sequential_search_res_t_res_157682 = p_157686;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_t_res_157681;
                                            } else {
                                                int64_t zl_rhs_157707 = sub64(max_res_150634, (int64_t) 1);
                                                bool loop_cond_157708 = slt64((int64_t) 0, zl_rhs_157707);
                                                bool defunc_0_partFunc_sequential_search_res_f_res_157709;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157711;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157712;
                                                bool loop_while_157713;
                                                int64_t p_157714;
                                                int64_t p_157715;
                                                int64_t p_157716;
                                                
                                                loop_while_157713 = loop_cond_157708;
                                                p_157714 = ai_157656;
                                                p_157715 = max_res_150634;
                                                p_157716 = (int64_t) 0;
                                                while (loop_while_157713) {
                                                    int64_t zp_lhs_157717 = add64(ai_157656, p_157716);
                                                    int64_t hi_a_157718 = add64((int64_t) 1, zp_lhs_157717);
                                                    bool cond_157719 = slt64(hi_a_157718, nR_121202);
                                                    int64_t i_a_157720;
                                                    
                                                    if (cond_157719) {
                                                        i_a_157720 = hi_a_157718;
                                                    } else {
                                                        i_a_157720 = gt_rhs_150410;
                                                    }
                                                    
                                                    int64_t zm_lhs_157722 = sub64(max_res_150634, p_157716);
                                                    int64_t i_b_157723 = sub64(zm_lhs_157722, (int64_t) 1);
                                                    bool x_157724 = sle64((int64_t) 0, i_a_157720);
                                                    bool y_157725 = slt64(i_a_157720, nR_121202);
                                                    bool bounds_check_157726 = x_157724 && y_157725;
                                                    bool index_certs_157727;
                                                    
                                                    if (!bounds_check_157726) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_a_157720, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:250:15-22\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157729 = sle64((int64_t) 0, i_b_157723);
                                                    bool y_157730 = slt64(i_b_157723, nR_121202);
                                                    bool bounds_check_157731 = x_157729 && y_157730;
                                                    bool index_certs_157732;
                                                    
                                                    if (!bounds_check_157731) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157723, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:250:28-35\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:171:133-136\n   #5  ftRelational.fut:160:1-171:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    int32_t gt_lhs_157728 = ((int32_t *) tR_mem_164928.mem)[i_a_157720];
                                                    int64_t slice_157733 = tS_start_150427 + i_b_157723;
                                                    int32_t gt_rhs_157734 = ((int32_t *) tS_mem_164929.mem)[slice_157733];
                                                    bool defunc_0_gt_res_157735 = slt32(gt_rhs_157734, gt_lhs_157728);
                                                    int64_t loopres_157736;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157736 = i_a_157720;
                                                    } else {
                                                        loopres_157736 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157737;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157737 = zm_lhs_157722;
                                                    } else {
                                                        loopres_157737 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157738;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157738 = zl_rhs_157707;
                                                    } else {
                                                        int64_t tmp_157739 = add64((int64_t) 1, p_157716);
                                                        
                                                        loopres_157738 = tmp_157739;
                                                    }
                                                    
                                                    bool loop_cond_157740 = slt64(loopres_157738, zl_rhs_157707);
                                                    bool loop_while_tmp_165736 = loop_cond_157740;
                                                    int64_t p_tmp_165737 = loopres_157736;
                                                    int64_t p_tmp_165738 = loopres_157737;
                                                    int64_t p_tmp_165739 = loopres_157738;
                                                    
                                                    loop_while_157713 = loop_while_tmp_165736;
                                                    p_157714 = p_tmp_165737;
                                                    p_157715 = p_tmp_165738;
                                                    p_157716 = p_tmp_165739;
                                                }
                                                defunc_0_partFunc_sequential_search_res_f_res_157709 = loop_while_157713;
                                                defunc_0_partFunc_sequential_search_res_f_res_157710 = p_157714;
                                                defunc_0_partFunc_sequential_search_res_f_res_157711 = p_157715;
                                                defunc_0_partFunc_sequential_search_res_f_res_157712 = p_157716;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_f_res_157711;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = p_150627;
                                            loopres_f_res_f_res_f_res_150693 = defunc_0_partFunc_sequential_search_res_157675;
                                            loopres_f_res_f_res_f_res_150694 = defunc_0_partFunc_sequential_search_res_157676;
                                            loopres_f_res_f_res_f_res_150695 = 0;
                                        } else {
                                            bool x_150779 = sle64((int64_t) 0, ai_150632);
                                            bool y_150780 = slt64(ai_150632, nR_121202);
                                            bool bounds_check_150781 = x_150779 && y_150780;
                                            bool index_certs_150782;
                                            
                                            if (!bounds_check_150781) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_150632, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:308:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int32_t gt_lhs_150783 = ((int32_t *) tR_mem_164928.mem)[ai_150632];
                                            bool defunc_0_gt_res_150784 = slt32(b_prev_150636, gt_lhs_150783);
                                            int64_t loopres_f_res_f_res_f_res_f_res_150785;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150786;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150787;
                                            bool loopres_f_res_f_res_f_res_f_res_150788;
                                            
                                            if (defunc_0_gt_res_150784) {
                                                int64_t leq_lhs_157741 = sub64(ai_150632, (int64_t) 1);
                                                bool x_157742 = sle64((int64_t) 0, leq_lhs_157741);
                                                bool y_157743 = slt64(leq_lhs_157741, nR_121202);
                                                bool bounds_check_157744 = x_157742 && y_157743;
                                                bool index_certs_157745;
                                                
                                                if (!bounds_check_157744) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157741, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:309:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                bool x_157747 = sle64((int64_t) 0, max_res_150634);
                                                bool y_157748 = slt64(max_res_150634, nR_121202);
                                                bool bounds_check_157749 = x_157747 && y_157748;
                                                bool index_certs_157750;
                                                
                                                if (!bounds_check_157749) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150634, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftbasics.fut:309:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int32_t leq_lhs_157746 = ((int32_t *) tR_mem_164928.mem)[leq_lhs_157741];
                                                int64_t slice_157751 = tS_start_150427 + max_res_150634;
                                                int32_t leq_rhs_157752 = ((int32_t *) tS_mem_164929.mem)[slice_157751];
                                                bool defunc_0_leq_res_157753 = sle32(leq_lhs_157746, leq_rhs_157752);
                                                bool x_157754 = !defunc_0_leq_res_157753;
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = ai_150632;
                                                } else {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = leq_lhs_157741;
                                                }
                                                
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = max_res_150634;
                                                } else {
                                                    int64_t tmp_157757 = add64((int64_t) 1, max_res_150634);
                                                    
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = tmp_157757;
                                                }
                                                loopres_f_res_f_res_f_res_f_res_150785 = p_150627;
                                                loopres_f_res_f_res_f_res_f_res_150786 = loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                loopres_f_res_f_res_f_res_f_res_150787 = loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                loopres_f_res_f_res_f_res_f_res_150788 = x_157754;
                                            } else {
                                                int64_t tmp_150805 = add64((int64_t) 1, ai_150632);
                                                
                                                loopres_f_res_f_res_f_res_f_res_150785 = tmp_150805;
                                                loopres_f_res_f_res_f_res_f_res_150786 = p_150628;
                                                loopres_f_res_f_res_f_res_f_res_150787 = p_150629;
                                                loopres_f_res_f_res_f_res_f_res_150788 = 1;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = loopres_f_res_f_res_f_res_f_res_150785;
                                            loopres_f_res_f_res_f_res_150693 = loopres_f_res_f_res_f_res_f_res_150786;
                                            loopres_f_res_f_res_f_res_150694 = loopres_f_res_f_res_f_res_f_res_150787;
                                            loopres_f_res_f_res_f_res_150695 = loopres_f_res_f_res_f_res_f_res_150788;
                                        }
                                        loopres_f_res_f_res_150671 = loopres_f_res_f_res_f_res_150692;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_f_res_150693;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_f_res_150694;
                                        loopres_f_res_f_res_150674 = loopres_f_res_f_res_f_res_150695;
                                    }
                                    loopres_f_res_150649 = loopres_f_res_f_res_150671;
                                    loopres_f_res_150650 = loopres_f_res_f_res_150672;
                                    loopres_f_res_150651 = loopres_f_res_f_res_150673;
                                    loopres_f_res_150652 = loopres_f_res_f_res_150674;
                                }
                                loopres_150644 = loopres_f_res_150649;
                                loopres_150645 = loopres_f_res_150650;
                                loopres_150646 = loopres_f_res_150651;
                                loopres_150647 = loopres_f_res_150652;
                            }
                            
                            bool loop_while_tmp_165728 = loopres_150647;
                            int64_t p_tmp_165729 = loopres_150644;
                            int64_t p_tmp_165730 = loopres_150645;
                            int64_t p_tmp_165731 = loopres_150646;
                            
                            loop_while_150626 = loop_while_tmp_165728;
                            p_150627 = p_tmp_165729;
                            p_150628 = p_tmp_165730;
                            p_150629 = p_tmp_165731;
                        }
                        defunc_0_f_res_150622 = loop_while_150626;
                        defunc_0_f_res_150623 = p_150627;
                        defunc_0_f_res_150624 = p_150628;
                        defunc_0_f_res_150625 = p_150629;
                        ((int64_t *) mem_164952.mem)[i_164726] = defunc_0_f_res_150624;
                        ((int64_t *) mem_164954.mem)[i_164726] = defunc_0_f_res_150625;
                    }
                    
                    int64_t bytes_164968 = (int64_t) 8 * ret_150812;
                    
                    if (cond_150810) {
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164952, "mem_164952") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164954, "mem_164954") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc(ctx, &mem_164971, bytes_164968, "mem_164971")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165740 = 0; nest_i_165740 < (int64_t) 1; nest_i_165740++) {
                            ((int64_t *) mem_164971.mem)[nest_i_165740] = (int64_t) 0;
                        }
                        if (memblock_alloc(ctx, &mem_164969, bytes_164968, "mem_164969")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165741 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        tmp_offs_165741 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165741 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        
                        int64_t tmp_offs_165742 = (int64_t) 0;
                        
                        if (!(tmp_offs_165742 == (int64_t) 0)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        }
                        tmp_offs_165742 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164954.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165742 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164969, "mem_164969") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164971, "mem_164971") != 0)
                            return 1;
                    }
                    if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
                        return 1;
                    
                    int64_t tmp_150827 = add64((int64_t) 1, p_150595);
                    
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164942, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164977.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164944, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164974.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
                        return 1;
                    
                    bool loop_cond_150840 = slt64(tmp_150827, numberOfWindows_121209);
                    bool loop_while_tmp_165722 = loop_cond_150840;
                    int64_t p_tmp_165723 = tmp_150827;
                    
                    loop_while_150594 = loop_while_tmp_165722;
                    p_150595 = p_tmp_165723;
                }
                defunc_0_windowed_partitionFunc_res_150590 = loop_while_150594;
                defunc_0_windowed_partitionFunc_res_150591 = p_150595;
                if (mem_164985_cached_sizze_166060 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164985, &mem_164985_cached_sizze_166060, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_164987_cached_sizze_166061 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164987, &mem_164987_cached_sizze_166061, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_164733 = 0; i_164733 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; i_164733++) {
                    int64_t eta_p_150847 = ((int64_t *) mem_164942)[i_164733];
                    int64_t min_res_150848 = smin64(gt_rhs_150410, eta_p_150847);
                    bool x_150849 = sle64((int64_t) 0, min_res_150848);
                    bool y_150850 = slt64(min_res_150848, nR_121202);
                    bool bounds_check_150851 = x_150849 && y_150850;
                    bool index_certs_150852;
                    
                    if (!bounds_check_150851) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150848, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:274:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool cond_150854 = i_164733 == zeze_rhs_150843;
                    int64_t ri_next_150855;
                    
                    if (cond_150854) {
                        ri_next_150855 = nR_121202;
                    } else {
                        int64_t tmp_150856 = add64((int64_t) 1, i_164733);
                        bool x_150857 = sle64((int64_t) 0, tmp_150856);
                        bool y_150858 = slt64(tmp_150856, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150859 = x_150857 && y_150858;
                        bool index_certs_150860;
                        
                        if (!bounds_check_150859) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150856, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:275:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t ri_next_f_res_150861 = ((int64_t *) mem_164942)[tmp_150856];
                        
                        ri_next_150855 = ri_next_f_res_150861;
                    }
                    
                    int64_t max_arg1_150862 = sub64(ri_next_150855, (int64_t) 1);
                    int64_t max_res_150863 = smax64((int64_t) 0, max_arg1_150862);
                    bool x_150864 = sle64((int64_t) 0, max_res_150863);
                    bool y_150865 = slt64(max_res_150863, nR_121202);
                    bool bounds_check_150866 = x_150864 && y_150865;
                    bool index_certs_150867;
                    
                    if (!bounds_check_150866) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150863, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:276:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t r_min_150853 = ((int32_t *) tR_mem_164928.mem)[min_res_150848];
                    int32_t r_max_150868 = ((int32_t *) tR_mem_164928.mem)[max_res_150863];
                    bool defunc_0_f_res_150869;
                    int64_t defunc_0_f_res_150870;
                    bool loop_while_150871;
                    int64_t fm_150872;
                    
                    loop_while_150871 = 1;
                    fm_150872 = i_164733;
                    while (loop_while_150871) {
                        bool x_150873 = sle64((int64_t) 0, fm_150872);
                        bool y_150874 = slt64(fm_150872, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150875 = x_150873 && y_150874;
                        bool index_certs_150876;
                        
                        if (!bounds_check_150875) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) fm_150872, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:281:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150877 = ((int64_t *) mem_164944)[fm_150872];
                        int64_t min_res_150878 = smin64(gt_rhs_150410, loopres_150877);
                        bool x_150879 = sle64((int64_t) 0, min_res_150878);
                        bool y_150880 = slt64(min_res_150878, nR_121202);
                        bool bounds_check_150881 = x_150879 && y_150880;
                        bool index_certs_150882;
                        
                        if (!bounds_check_150881) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150878, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:282:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150884 = sle64(zeze_rhs_150843, fm_150872);
                        int64_t si_next_150885;
                        
                        if (cond_150884) {
                            si_next_150885 = nR_121202;
                        } else {
                            int64_t tmp_150886 = add64((int64_t) 1, fm_150872);
                            bool x_150887 = sle64((int64_t) 0, tmp_150886);
                            bool y_150888 = slt64(tmp_150886, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150889 = x_150887 && y_150888;
                            bool index_certs_150890;
                            
                            if (!bounds_check_150889) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150886, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:283:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150891 = ((int64_t *) mem_164944)[tmp_150886];
                            
                            si_next_150885 = si_next_f_res_150891;
                        }
                        
                        int64_t max_arg1_150892 = sub64(si_next_150885, (int64_t) 1);
                        int64_t max_res_150893 = smax64(min_res_150878, max_arg1_150892);
                        bool x_150894 = sle64((int64_t) 0, max_res_150893);
                        bool y_150895 = slt64(max_res_150893, nR_121202);
                        bool bounds_check_150896 = x_150894 && y_150895;
                        bool index_certs_150897;
                        
                        if (!bounds_check_150896) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150893, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:284:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150899 = smin64(zeze_rhs_150843, si_next_150885);
                        bool x_150900 = sle64((int64_t) 0, min_res_150899);
                        bool y_150901 = slt64(min_res_150899, nR_121202);
                        bool bounds_check_150902 = x_150900 && y_150901;
                        bool index_certs_150903;
                        
                        if (!bounds_check_150902) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150899, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:285:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150905 = sub64(min_res_150878, (int64_t) 1);
                        int64_t max_res_150906 = smax64((int64_t) 0, max_arg1_150905);
                        bool x_150907 = sle64((int64_t) 0, max_res_150906);
                        bool y_150908 = slt64(max_res_150906, nR_121202);
                        bool bounds_check_150909 = x_150907 && y_150908;
                        bool index_certs_150910;
                        
                        if (!bounds_check_150909) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150906, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:286:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151506 = tS_start_150427 + min_res_150878;
                        int32_t s_min_150883 = ((int32_t *) tS_mem_164929.mem)[slice_151506];
                        int64_t slice_151505 = tS_start_150427 + max_res_150893;
                        int32_t s_max_150898 = ((int32_t *) tS_mem_164929.mem)[slice_151505];
                        int64_t slice_151504 = tS_start_150427 + min_res_150899;
                        int32_t s_nextMin_150904 = ((int32_t *) tS_mem_164929.mem)[slice_151504];
                        int64_t slice_151503 = tS_start_150427 + max_res_150906;
                        int32_t s_prevMax_150911 = ((int32_t *) tS_mem_164929.mem)[slice_151503];
                        bool defunc_0_gt_res_150912 = slt32(s_min_150883, r_min_150853);
                        bool loopres_150913;
                        int64_t loopres_150914;
                        
                        if (defunc_0_gt_res_150912) {
                            bool defunc_0_leq_res_157760 = sle32(r_min_150853, s_max_150898);
                            bool loopres_t_res_157761;
                            int64_t loopres_t_res_157762;
                            
                            if (defunc_0_leq_res_157760) {
                                loopres_t_res_157761 = 0;
                                loopres_t_res_157762 = fm_150872;
                            } else {
                                bool defunc_0_leq_res_157763 = sle32(r_min_150853, s_nextMin_150904);
                                int64_t zgze_lhs_157764 = add64((int64_t) 1, fm_150872);
                                bool tmp_f_res_157765 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, zgze_lhs_157764);
                                bool x_157766 = !defunc_0_leq_res_157763;
                                bool y_157767 = tmp_f_res_157765 && x_157766;
                                bool tmp_157768 = defunc_0_leq_res_157763 || y_157767;
                                bool loopres_t_res_f_res_157769 = !tmp_157768;
                                
                                loopres_t_res_157761 = loopres_t_res_f_res_157769;
                                loopres_t_res_157762 = zgze_lhs_157764;
                            }
                            loopres_150913 = loopres_t_res_157761;
                            loopres_150914 = loopres_t_res_157762;
                        } else {
                            bool defunc_0_leq_res_150925 = sle32(s_prevMax_150911, r_min_150853);
                            int64_t zlze_lhs_150926 = sub64(fm_150872, (int64_t) 1);
                            bool tmp_f_res_150927 = sle64(zlze_lhs_150926, (int64_t) 0);
                            bool x_150928 = !defunc_0_leq_res_150925;
                            bool y_150929 = tmp_f_res_150927 && x_150928;
                            bool tmp_150930 = defunc_0_leq_res_150925 || y_150929;
                            int64_t max_res_150931 = smax64((int64_t) 0, zlze_lhs_150926);
                            bool loopres_f_res_150932 = !tmp_150930;
                            
                            loopres_150913 = loopres_f_res_150932;
                            loopres_150914 = max_res_150931;
                        }
                        
                        bool loop_while_tmp_165745 = loopres_150913;
                        int64_t fm_tmp_165746 = loopres_150914;
                        
                        loop_while_150871 = loop_while_tmp_165745;
                        fm_150872 = fm_tmp_165746;
                    }
                    defunc_0_f_res_150869 = loop_while_150871;
                    defunc_0_f_res_150870 = fm_150872;
                    
                    bool defunc_0_f_res_150934;
                    int64_t defunc_0_f_res_150935;
                    bool loop_while_150936;
                    int64_t lm_150937;
                    
                    loop_while_150936 = 1;
                    lm_150937 = i_164733;
                    while (loop_while_150936) {
                        bool x_150938 = sle64((int64_t) 0, lm_150937);
                        bool y_150939 = slt64(lm_150937, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150940 = x_150938 && y_150939;
                        bool index_certs_150941;
                        
                        if (!bounds_check_150940) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lm_150937, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:297:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150942 = ((int64_t *) mem_164944)[lm_150937];
                        int64_t min_res_150943 = smin64(gt_rhs_150410, loopres_150942);
                        bool x_150944 = sle64((int64_t) 0, min_res_150943);
                        bool y_150945 = slt64(min_res_150943, nR_121202);
                        bool bounds_check_150946 = x_150944 && y_150945;
                        bool index_certs_150947;
                        
                        if (!bounds_check_150946) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150943, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:298:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150949 = sle64(zeze_rhs_150843, lm_150937);
                        int64_t si_next_150950;
                        
                        if (cond_150949) {
                            si_next_150950 = nR_121202;
                        } else {
                            int64_t tmp_150951 = add64((int64_t) 1, lm_150937);
                            bool x_150952 = sle64((int64_t) 0, tmp_150951);
                            bool y_150953 = slt64(tmp_150951, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150954 = x_150952 && y_150953;
                            bool index_certs_150955;
                            
                            if (!bounds_check_150954) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150951, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:299:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150956 = ((int64_t *) mem_164944)[tmp_150951];
                            
                            si_next_150950 = si_next_f_res_150956;
                        }
                        
                        int64_t max_arg1_150957 = sub64(si_next_150950, (int64_t) 1);
                        int64_t max_res_150958 = smax64(min_res_150943, max_arg1_150957);
                        bool x_150959 = sle64((int64_t) 0, max_res_150958);
                        bool y_150960 = slt64(max_res_150958, nR_121202);
                        bool bounds_check_150961 = x_150959 && y_150960;
                        bool index_certs_150962;
                        
                        if (!bounds_check_150961) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150958, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:300:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150964 = smin64(zeze_rhs_150843, si_next_150950);
                        bool x_150965 = sle64((int64_t) 0, min_res_150964);
                        bool y_150966 = slt64(min_res_150964, nR_121202);
                        bool bounds_check_150967 = x_150965 && y_150966;
                        bool index_certs_150968;
                        
                        if (!bounds_check_150967) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150964, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:301:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150970 = sub64(min_res_150943, (int64_t) 1);
                        int64_t max_res_150971 = smax64((int64_t) 0, max_arg1_150970);
                        bool x_150972 = sle64((int64_t) 0, max_res_150971);
                        bool y_150973 = slt64(max_res_150971, nR_121202);
                        bool bounds_check_150974 = x_150972 && y_150973;
                        bool index_certs_150975;
                        
                        if (!bounds_check_150974) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150971, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:302:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151502 = tS_start_150427 + min_res_150943;
                        int32_t s_min_150948 = ((int32_t *) tS_mem_164929.mem)[slice_151502];
                        int64_t slice_151501 = tS_start_150427 + max_res_150958;
                        int32_t s_max_150963 = ((int32_t *) tS_mem_164929.mem)[slice_151501];
                        int64_t slice_151500 = tS_start_150427 + min_res_150964;
                        int32_t s_nextMin_150969 = ((int32_t *) tS_mem_164929.mem)[slice_151500];
                        int64_t slice_151499 = tS_start_150427 + max_res_150971;
                        int32_t s_prevMax_150976 = ((int32_t *) tS_mem_164929.mem)[slice_151499];
                        bool defunc_0_gt_res_150977 = slt32(r_max_150868, s_max_150963);
                        bool loopres_150978;
                        int64_t loopres_150979;
                        
                        if (defunc_0_gt_res_150977) {
                            bool defunc_0_leq_res_157770 = sle32(s_min_150948, r_max_150868);
                            bool loopres_t_res_157771;
                            int64_t loopres_t_res_157772;
                            
                            if (defunc_0_leq_res_157770) {
                                loopres_t_res_157771 = 0;
                                loopres_t_res_157772 = lm_150937;
                            } else {
                                bool defunc_0_leq_res_157773 = sle32(s_prevMax_150976, r_max_150868);
                                int64_t zlze_lhs_157774 = sub64(lm_150937, (int64_t) 1);
                                bool tmp_f_res_157775 = sle64(zlze_lhs_157774, (int64_t) 0);
                                bool x_157776 = !defunc_0_leq_res_157773;
                                bool y_157777 = tmp_f_res_157775 && x_157776;
                                bool tmp_157778 = defunc_0_leq_res_157773 || y_157777;
                                int64_t max_res_157779 = smax64((int64_t) 0, zlze_lhs_157774);
                                bool loopres_t_res_f_res_157780 = !tmp_157778;
                                
                                loopres_t_res_157771 = loopres_t_res_f_res_157780;
                                loopres_t_res_157772 = max_res_157779;
                            }
                            loopres_150978 = loopres_t_res_157771;
                            loopres_150979 = loopres_t_res_157772;
                        } else {
                            bool defunc_0_leq_res_150991 = sle32(r_max_150868, s_nextMin_150969);
                            int64_t tmp_150992 = add64((int64_t) 1, lm_150937);
                            bool loopres_f_res_150993 = !defunc_0_leq_res_150991;
                            
                            loopres_150978 = loopres_f_res_150993;
                            loopres_150979 = tmp_150992;
                        }
                        
                        bool loop_cond_t_res_150994 = slt64(loopres_150979, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool x_150995 = loopres_150978 && loop_cond_t_res_150994;
                        bool loop_while_tmp_165747 = x_150995;
                        int64_t lm_tmp_165748 = loopres_150979;
                        
                        loop_while_150936 = loop_while_tmp_165747;
                        lm_150937 = lm_tmp_165748;
                    }
                    defunc_0_f_res_150934 = loop_while_150936;
                    defunc_0_f_res_150935 = lm_150937;
                    ((int64_t *) mem_164985)[i_164733] = defunc_0_f_res_150870;
                    ((int64_t *) mem_164987)[i_164733] = defunc_0_f_res_150935;
                }
                
                int64_t ext_165121;
                int64_t ext_165120;
                int64_t ext_165119;
                int64_t ext_165118;
                bool defunc_0_join_chunks_res_150999;
                int64_t defunc_0_join_chunks_res_151000;
                bool loop_while_151003;
                int64_t p_151004;
                int64_t ctx_param_ext_165000;
                int64_t ctx_param_ext_165001;
                int64_t ctx_param_ext_165003;
                int64_t ctx_param_ext_165004;
                
                if (memblock_set(ctx, &mem_param_165002, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165005, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165000 = (int64_t) 0;
                ctx_param_ext_165001 = (int64_t) 1;
                ctx_param_ext_165003 = (int64_t) 0;
                ctx_param_ext_165004 = (int64_t) 1;
                loop_while_151003 = loop_cond_150998;
                p_151004 = (int64_t) 0;
                while (loop_while_151003) {
                    bool x_151007 = sle64((int64_t) 0, p_151004);
                    bool y_151008 = slt64(p_151004, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151009 = x_151007 && y_151008;
                    bool index_certs_151010;
                    
                    if (!bounds_check_151009) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:334:22-34\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t loopres_151011 = ((int64_t *) mem_164985)[p_151004];
                    int64_t loopres_151012 = ((int64_t *) mem_164987)[p_151004];
                    int64_t min_res_151013 = smin64(zeze_rhs_150843, loopres_151012);
                    bool cond_151014 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, loopres_151011);
                    bool cond_151018 = slt64(min_res_151013, (int64_t) 0);
                    bool protect_assert_disj_151020 = bounds_check_151009 || cond_151018;
                    bool protect_assert_disj_165535 = cond_151014 || protect_assert_disj_151020;
                    bool index_certs_151021;
                    
                    if (!protect_assert_disj_165535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:338:19-32\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_151024 = add64((int64_t) 1, p_151004);
                    bool cond_151025 = zeze_lhs_151024 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    bool x_151027 = sle64((int64_t) 0, zeze_lhs_151024);
                    bool y_151028 = slt64(zeze_lhs_151024, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151029 = x_151027 && y_151028;
                    bool protect_assert_disj_151030 = cond_151025 || bounds_check_151029;
                    bool protect_assert_disj_151031 = cond_151018 || protect_assert_disj_151030;
                    bool protect_assert_disj_165538 = cond_151014 || protect_assert_disj_151031;
                    bool index_certs_151032;
                    
                    if (!protect_assert_disj_165538) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151024, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:339:49-64\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_165532 = !cond_151014;
                    bool x_151019 = !cond_151018;
                    bool protect_cond_conj_165536 = x_151019 && x_165532;
                    int64_t loopres_f_res_f_res_151022;
                    
                    if (protect_cond_conj_165536) {
                        int64_t x_157781 = ((int64_t *) mem_164942)[p_151004];
                        
                        loopres_f_res_f_res_151022 = x_157781;
                    } else {
                        loopres_f_res_f_res_151022 = (int64_t) 0;
                    }
                    
                    bool x_151026 = !cond_151025;
                    bool protect_cond_conj_151033 = x_151019 && x_151026;
                    bool protect_cond_conj_165539 = protect_cond_conj_151033 && x_165532;
                    int64_t r_end_f_res_151034;
                    
                    if (protect_cond_conj_165539) {
                        int64_t x_157782 = ((int64_t *) mem_164942)[zeze_lhs_151024];
                        
                        r_end_f_res_151034 = x_157782;
                    } else {
                        r_end_f_res_151034 = (int64_t) 0;
                    }
                    
                    int64_t r_end_151036;
                    
                    if (cond_151025) {
                        r_end_151036 = nR_121202;
                    } else {
                        r_end_151036 = r_end_f_res_151034;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 = sub64(r_end_151036, loopres_f_res_f_res_151022);
                    int64_t ext_165110;
                    
                    if (cond_151018) {
                        ext_165110 = ctx_param_ext_165000;
                    } else {
                        ext_165110 = (int64_t) 0;
                    }
                    
                    int64_t ext_165109;
                    
                    if (cond_151018) {
                        ext_165109 = ctx_param_ext_165001;
                    } else {
                        ext_165109 = (int64_t) 1;
                    }
                    
                    int64_t ext_165107;
                    
                    if (cond_151018) {
                        ext_165107 = ctx_param_ext_165003;
                    } else {
                        ext_165107 = (int64_t) 0;
                    }
                    
                    int64_t ext_165106;
                    
                    if (cond_151018) {
                        ext_165106 = ctx_param_ext_165004;
                    } else {
                        ext_165106 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165006 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037;
                    int64_t ext_165116;
                    
                    if (cond_151014) {
                        ext_165116 = ctx_param_ext_165000;
                    } else {
                        ext_165116 = ext_165110;
                    }
                    
                    int64_t ext_165115;
                    
                    if (cond_151014) {
                        ext_165115 = ctx_param_ext_165001;
                    } else {
                        ext_165115 = ext_165109;
                    }
                    
                    int64_t ext_165113;
                    
                    if (cond_151014) {
                        ext_165113 = ctx_param_ext_165003;
                    } else {
                        ext_165113 = ext_165107;
                    }
                    
                    int64_t ext_165112;
                    
                    if (cond_151014) {
                        ext_165112 = ctx_param_ext_165004;
                    } else {
                        ext_165112 = ext_165106;
                    }
                    
                    int64_t loopres_151015;
                    
                    if (cond_151014) {
                        loopres_151015 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    } else {
                        loopres_151015 = zeze_lhs_151024;
                    }
                    if (cond_151014) {
                        if (memblock_set(ctx, &ext_mem_165117, &mem_param_165002, "mem_param_165002") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &mem_param_165005, "mem_param_165005") != 0)
                            return 1;
                    } else {
                        if (cond_151018) {
                            if (memblock_set(ctx, &ext_mem_165111, &mem_param_165002, "mem_param_165002") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_param_165005, "mem_param_165005") != 0)
                                return 1;
                        } else {
                            bool empty_slice_151040 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 == (int64_t) 0;
                            int64_t m_151041 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, (int64_t) 1);
                            int64_t i_p_m_t_s_151042 = add64(loopres_f_res_f_res_151022, m_151041);
                            bool zzero_leq_i_p_m_t_s_151043 = sle64((int64_t) 0, i_p_m_t_s_151042);
                            bool i_p_m_t_s_leq_w_151044 = slt64(i_p_m_t_s_151042, nR_121202);
                            bool zzero_lte_i_151045 = sle64((int64_t) 0, loopres_f_res_f_res_151022);
                            bool i_lte_j_151046 = sle64(loopres_f_res_f_res_151022, r_end_151036);
                            bool y_151047 = i_p_m_t_s_leq_w_151044 && zzero_lte_i_151045;
                            bool y_151048 = zzero_leq_i_p_m_t_s_151043 && y_151047;
                            bool forwards_ok_151049 = i_lte_j_151046 && y_151048;
                            bool ok_or_empty_151050 = empty_slice_151040 || forwards_ok_151049;
                            bool index_certs_151051;
                            
                            if (!ok_or_empty_151050) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_151022, ":", (long long) r_end_151036, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:340:16-33\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_151054 = sle64(loopres_151011, min_res_151013);
                            bool loop_not_taken_151059 = !loop_cond_151054;
                            bool protect_assert_disj_151060 = loop_not_taken_151059 || nonzzero_157453;
                            bool nonzzero_cert_151061;
                            
                            if (!protect_assert_disj_151060) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165759 = 0; nest_i_165759 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165759++) {
                                ((int64_t *) mem_165007.mem)[nest_i_165759] = (int64_t) -1;
                            }
                            if (memblock_alloc(ctx, &mem_165009, bytes_165006, "mem_165009")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165760 = 0; nest_i_165760 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165760++) {
                                ((int64_t *) mem_165009.mem)[nest_i_165760] = (int64_t) 0;
                            }
                            
                            int64_t zm_lhs_151055 = add64(extParallelism_121210, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                            int64_t zs_lhs_151056 = sub64(zm_lhs_151055, (int64_t) 1);
                            int64_t numIter_151062 = sdiv_safe64(zs_lhs_151056, extParallelism_121210);
                            bool loop_cond_151063 = slt64((int64_t) 0, numIter_151062);
                            bool loop_not_taken_151064 = !loop_cond_151063;
                            bool loopres_f_res_f_res_151065;
                            int64_t loopres_f_res_f_res_151066;
                            bool loop_while_151069;
                            int64_t dp_151070;
                            
                            if (memblock_set(ctx, &mem_param_165012, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_165015, &mem_165007, "mem_165007") != 0)
                                return 1;
                            loop_while_151069 = loop_cond_151054;
                            dp_151070 = loopres_151011;
                            while (loop_while_151069) {
                                bool x_151073 = sle64((int64_t) 0, dp_151070);
                                bool y_151074 = slt64(dp_151070, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151075 = x_151073 && y_151074;
                                bool index_certs_151076;
                                
                                if (!bounds_check_151075) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_151070, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:344:21-38\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_151077 = ((int64_t *) mem_164944)[dp_151070];
                                int64_t zeze_lhs_151078 = add64((int64_t) 1, dp_151070);
                                bool cond_151079 = zeze_lhs_151078 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                                bool x_151080 = !cond_151079;
                                bool x_151081 = sle64((int64_t) 0, zeze_lhs_151078);
                                bool y_151082 = slt64(zeze_lhs_151078, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151083 = x_151081 && y_151082;
                                bool protect_assert_disj_151084 = cond_151079 || bounds_check_151083;
                                bool index_certs_151085;
                                
                                if (!protect_assert_disj_151084) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151078, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:345:55-74\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_151086;
                                
                                if (x_151080) {
                                    int64_t x_157783 = ((int64_t *) mem_164944)[zeze_lhs_151078];
                                    
                                    s_end_f_res_151086 = x_157783;
                                } else {
                                    s_end_f_res_151086 = (int64_t) 0;
                                }
                                
                                int64_t s_end_151088;
                                
                                if (cond_151079) {
                                    s_end_151088 = nR_121202;
                                } else {
                                    s_end_151088 = s_end_f_res_151086;
                                }
                                
                                int64_t j_m_i_151089 = sub64(s_end_151088, loopres_151077);
                                bool empty_slice_151090 = j_m_i_151089 == (int64_t) 0;
                                int64_t m_151091 = sub64(j_m_i_151089, (int64_t) 1);
                                int64_t i_p_m_t_s_151092 = add64(loopres_151077, m_151091);
                                bool zzero_leq_i_p_m_t_s_151093 = sle64((int64_t) 0, i_p_m_t_s_151092);
                                bool i_p_m_t_s_leq_w_151094 = slt64(i_p_m_t_s_151092, nR_121202);
                                bool zzero_lte_i_151095 = sle64((int64_t) 0, loopres_151077);
                                bool i_lte_j_151096 = sle64(loopres_151077, s_end_151088);
                                bool y_151097 = i_p_m_t_s_leq_w_151094 && zzero_lte_i_151095;
                                bool y_151098 = zzero_leq_i_p_m_t_s_151093 && y_151097;
                                bool forwards_ok_151099 = i_lte_j_151096 && y_151098;
                                bool ok_or_empty_151100 = empty_slice_151090 || forwards_ok_151099;
                                bool index_certs_151101;
                                
                                if (!ok_or_empty_151100) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151077, ":", (long long) s_end_151088, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  ftSMJ.fut:346:18-35\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_151104 = slt64((int64_t) 0, j_m_i_151089);
                                bool loop_not_taken_151105 = !cond_151104;
                                bool x_151106 = sle64((int64_t) 0, m_151091);
                                bool y_151107 = slt64(m_151091, j_m_i_151089);
                                bool bounds_check_151111 = x_151106 && y_151107;
                                bool protect_assert_disj_151112 = loop_not_taken_151105 || bounds_check_151111;
                                bool protect_assert_disj_151113 = loop_not_taken_151064 || protect_assert_disj_151112;
                                bool index_certs_151114;
                                
                                if (!protect_assert_disj_151113) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151091, "] out of bounds for array of shape [", (long long) j_m_i_151089, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_151498 = tS_start_150427 + loopres_151077;
                                int64_t find_joinTuples_arg3_151103 = add64(join_chunks_arg3_150568, loopres_151077);
                                bool protect_cond_conj_151108 = loop_cond_151063 && cond_151104;
                                int32_t s_min_t_res_151109;
                                
                                if (protect_cond_conj_151108) {
                                    int32_t x_157784 = ((int32_t *) tS_mem_164929.mem)[slice_151498];
                                    
                                    s_min_t_res_151109 = x_157784;
                                } else {
                                    s_min_t_res_151109 = 0;
                                }
                                
                                int32_t s_max_t_res_151115;
                                
                                if (protect_cond_conj_151108) {
                                    int64_t slice_157785 = tS_start_150427 + i_p_m_t_s_151092;
                                    int32_t x_157786 = ((int32_t *) tS_mem_164929.mem)[slice_157785];
                                    
                                    s_max_t_res_151115 = x_157786;
                                } else {
                                    s_max_t_res_151115 = 0;
                                }
                                
                                int64_t bytes_165022 = (int64_t) 4 * j_m_i_151089;
                                int64_t ext_165061;
                                int64_t ext_165060;
                                int64_t ext_165059;
                                int64_t ext_165058;
                                bool defunc_0_find_joinTuples_res_151117;
                                int64_t defunc_0_find_joinTuples_res_151118;
                                bool loop_while_151121;
                                int64_t p_151122;
                                int64_t ctx_param_ext_165016;
                                int64_t ctx_param_ext_165017;
                                int64_t ctx_param_ext_165019;
                                int64_t ctx_param_ext_165020;
                                
                                if (memblock_set(ctx, &mem_param_165018, &mem_165009, "mem_165009") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165021, &mem_165007, "mem_165007") != 0)
                                    return 1;
                                ctx_param_ext_165016 = (int64_t) 0;
                                ctx_param_ext_165017 = (int64_t) 1;
                                ctx_param_ext_165019 = (int64_t) 0;
                                ctx_param_ext_165020 = (int64_t) 1;
                                loop_while_151121 = loop_cond_151063;
                                p_151122 = (int64_t) 0;
                                while (loop_while_151121) {
                                    int64_t start_151125 = mul64(extParallelism_121210, p_151122);
                                    int64_t min_arg1_151126 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, start_151125);
                                    int64_t min_res_151127 = smin64(extParallelism_121210, min_arg1_151126);
                                    int64_t iter_R_151128 = add64(start_151125, min_res_151127);
                                    bool empty_slice_151129 = min_res_151127 == (int64_t) 0;
                                    int64_t m_151130 = sub64(min_res_151127, (int64_t) 1);
                                    int64_t i_p_m_t_s_151131 = add64(start_151125, m_151130);
                                    bool zzero_leq_i_p_m_t_s_151132 = sle64((int64_t) 0, i_p_m_t_s_151131);
                                    bool i_p_m_t_s_leq_w_151133 = slt64(i_p_m_t_s_151131, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                                    bool zzero_lte_i_151134 = sle64((int64_t) 0, start_151125);
                                    bool i_lte_j_151135 = sle64(start_151125, iter_R_151128);
                                    bool y_151136 = i_p_m_t_s_leq_w_151133 && zzero_lte_i_151134;
                                    bool y_151137 = zzero_leq_i_p_m_t_s_151132 && y_151136;
                                    bool forwards_ok_151138 = i_lte_j_151135 && y_151137;
                                    bool ok_or_empty_151139 = empty_slice_151129 || forwards_ok_151138;
                                    bool index_certs_151140;
                                    
                                    if (!ok_or_empty_151139) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_151125, ":", (long long) iter_R_151128, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151147 = slt64(m_151130, min_res_151127);
                                    bool x_151146 = sle64((int64_t) 0, m_151130);
                                    bool bounds_check_151148 = x_151146 && y_151147;
                                    bool index_certs_151149;
                                    
                                    if (!bounds_check_151148) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151130, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151143 = slt64((int64_t) 0, min_res_151127);
                                    bool index_certs_151144;
                                    
                                    if (!y_151143) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:171:133-136\n   #2  ftRelational.fut:160:1-171:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_151141 = loopres_f_res_f_res_151022 + start_151125;
                                    int64_t slice_151150 = loopres_f_res_f_res_151022 + i_p_m_t_s_151131;
                                    int32_t r_max_151151 = ((int32_t *) tR_mem_164928.mem)[slice_151150];
                                    int32_t s_max_151153;
                                    
                                    if (cond_151104) {
                                        s_max_151153 = s_max_t_res_151115;
                                    } else {
                                        s_max_151153 = r_max_151151;
                                    }
                                    
                                    int32_t r_min_151145 = ((int32_t *) tR_mem_164928.mem)[slice_151141];
                                    bool defunc_0_gt_res_151154 = slt32(s_max_151153, r_min_151145);
                                    int32_t s_min_151152;
                                    
                                    if (cond_151104) {
                                        s_min_151152 = s_min_t_res_151109;
                                    } else {
                                        s_min_151152 = r_min_151145;
                                    }
                                    
                                    bool defunc_0_gt_res_151158 = slt32(r_max_151151, s_min_151152);
                                    int64_t ext_165050;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165050 = ctx_param_ext_165016;
                                    } else {
                                        ext_165050 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165049;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165049 = ctx_param_ext_165017;
                                    } else {
                                        ext_165049 = (int64_t) 1;
                                    }
                                    
                                    int64_t ext_165047;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165047 = ctx_param_ext_165019;
                                    } else {
                                        ext_165047 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165046;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165046 = ctx_param_ext_165020;
                                    } else {
                                        ext_165046 = (int64_t) 1;
                                    }
                                    
                                    int64_t bytes_165026 = (int64_t) 8 * min_res_151127;
                                    int64_t ext_165056;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165056 = ctx_param_ext_165016;
                                    } else {
                                        ext_165056 = ext_165050;
                                    }
                                    
                                    int64_t ext_165055;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165055 = ctx_param_ext_165017;
                                    } else {
                                        ext_165055 = ext_165049;
                                    }
                                    
                                    int64_t ext_165053;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165053 = ctx_param_ext_165019;
                                    } else {
                                        ext_165053 = ext_165047;
                                    }
                                    
                                    int64_t ext_165052;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165052 = ctx_param_ext_165020;
                                    } else {
                                        ext_165052 = ext_165046;
                                    }
                                    
                                    int64_t loopres_151155;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        if (memblock_set(ctx, &ext_mem_165057, &mem_param_165018, "mem_param_165018") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &mem_param_165021, "mem_param_165021") != 0)
                                            return 1;
                                        loopres_151155 = numIter_151062;
                                    } else {
                                        int64_t loopres_f_res_151159;
                                        
                                        if (defunc_0_gt_res_151158) {
                                            int64_t tmp_157789 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_param_165018, "mem_param_165018") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_param_165021, "mem_param_165021") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_157789;
                                        } else {
                                            if (memblock_alloc(ctx, &mem_165023, bytes_165022, "mem_165023")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_165023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) tS_mem_164929.mem, slice_151498, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151089});
                                            if (futrts_indicesWithIncrement_12162(ctx, &ext_mem_165025, mem_165023, j_m_i_151089, find_joinTuples_arg3_151103) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
                                                return 1;
                                            if (mem_165027_cached_sizze_166062 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165027, &mem_165027_cached_sizze_166062, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            if (mem_165029_cached_sizze_166063 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166063, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            for (int64_t i_164744 = 0; i_164744 < min_res_151127; i_164744++) {
                                                int64_t slice_164903 = slice_151141 + i_164744;
                                                int32_t eta_p_151167 = ((int32_t *) tR_mem_164928.mem)[slice_164903];
                                                int64_t defunc_0_reduce_comm_res_157790;
                                                int32_t defunc_0_reduce_comm_res_157791;
                                                int64_t defunc_0_reduce_comm_res_157792;
                                                int64_t redout_164736;
                                                int32_t redout_164737;
                                                int64_t redout_164738;
                                                
                                                redout_164736 = (int64_t) -1;
                                                redout_164737 = eta_p_151167;
                                                redout_164738 = (int64_t) 0;
                                                for (int64_t i_164739 = 0; i_164739 < j_m_i_151089; i_164739++) {
                                                    int64_t x_151171 = ((int64_t *) ext_mem_165025.mem)[i_164739];
                                                    int64_t slice_164902 = slice_151498 + i_164739;
                                                    int32_t x_151172 = ((int32_t *) tS_mem_164929.mem)[slice_164902];
                                                    bool defunc_0_neq_res_151180 = redout_164737 == eta_p_151167;
                                                    bool defunc_0_neq_res_151181 = !defunc_0_neq_res_151180;
                                                    bool cond_f_res_151182 = slt64(redout_164736, (int64_t) 0);
                                                    bool y_151183 = defunc_0_neq_res_151180 && cond_f_res_151182;
                                                    bool cond_151184 = defunc_0_neq_res_151181 || y_151183;
                                                    bool defunc_0_neq_res_151185 = x_151172 == eta_p_151167;
                                                    bool defunc_0_neq_res_151186 = !defunc_0_neq_res_151185;
                                                    bool cond_t_res_f_res_151187 = slt64(x_151171, (int64_t) 0);
                                                    bool y_151188 = defunc_0_neq_res_151185 && cond_t_res_f_res_151187;
                                                    bool cond_t_res_151189 = defunc_0_neq_res_151186 || y_151188;
                                                    bool x_151190 = cond_151184 && cond_t_res_151189;
                                                    int64_t defunc_0_op_res_151191;
                                                    int32_t defunc_0_op_res_151192;
                                                    int64_t defunc_0_op_res_151193;
                                                    
                                                    if (x_151190) {
                                                        defunc_0_op_res_151191 = (int64_t) -1;
                                                        defunc_0_op_res_151192 = eta_p_151167;
                                                        defunc_0_op_res_151193 = (int64_t) 0;
                                                    } else {
                                                        int64_t defunc_0_op_res_f_res_151194;
                                                        int32_t defunc_0_op_res_f_res_151195;
                                                        int64_t defunc_0_op_res_f_res_151196;
                                                        
                                                        if (cond_151184) {
                                                            defunc_0_op_res_f_res_151194 = x_151171;
                                                            defunc_0_op_res_f_res_151195 = x_151172;
                                                            defunc_0_op_res_f_res_151196 = (int64_t) 1;
                                                        } else {
                                                            int32_t defunc_0_op_res_f_res_f_res_151197;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151197 = redout_164737;
                                                            } else {
                                                                defunc_0_op_res_f_res_f_res_151197 = eta_p_151167;
                                                            }
                                                            
                                                            int64_t defunc_0_op_res_f_res_f_res_151198;
                                                            int64_t defunc_0_op_res_f_res_f_res_151199;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151198 = redout_164736;
                                                                defunc_0_op_res_f_res_f_res_151199 = redout_164738;
                                                            } else {
                                                                int64_t min_res_151200 = smin64(x_151171, redout_164736);
                                                                int64_t tmp_151201 = add64((int64_t) 1, redout_164738);
                                                                
                                                                defunc_0_op_res_f_res_f_res_151198 = min_res_151200;
                                                                defunc_0_op_res_f_res_f_res_151199 = tmp_151201;
                                                            }
                                                            defunc_0_op_res_f_res_151194 = defunc_0_op_res_f_res_f_res_151198;
                                                            defunc_0_op_res_f_res_151195 = defunc_0_op_res_f_res_f_res_151197;
                                                            defunc_0_op_res_f_res_151196 = defunc_0_op_res_f_res_f_res_151199;
                                                        }
                                                        defunc_0_op_res_151191 = defunc_0_op_res_f_res_151194;
                                                        defunc_0_op_res_151192 = defunc_0_op_res_f_res_151195;
                                                        defunc_0_op_res_151193 = defunc_0_op_res_f_res_151196;
                                                    }
                                                    
                                                    int64_t redout_tmp_165779 = defunc_0_op_res_151191;
                                                    int32_t redout_tmp_165780 = defunc_0_op_res_151192;
                                                    int64_t redout_tmp_165781 = defunc_0_op_res_151193;
                                                    
                                                    redout_164736 = redout_tmp_165779;
                                                    redout_164737 = redout_tmp_165780;
                                                    redout_164738 = redout_tmp_165781;
                                                }
                                                defunc_0_reduce_comm_res_157790 = redout_164736;
                                                defunc_0_reduce_comm_res_157791 = redout_164737;
                                                defunc_0_reduce_comm_res_157792 = redout_164738;
                                                ((int64_t *) mem_165027)[i_164744] = defunc_0_reduce_comm_res_157790;
                                                ((int64_t *) mem_165029)[i_164744] = defunc_0_reduce_comm_res_157792;
                                            }
                                            if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
                                                return 1;
                                            if (memblock_alloc(ctx, &mem_165043, bytes_165006, "mem_165043")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165021.mem, ctx_param_ext_165019, (int64_t []) {ctx_param_ext_165020}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165027, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            if (memblock_alloc(ctx, &mem_165045, bytes_165006, "mem_165045")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165018.mem, ctx_param_ext_165016, (int64_t []) {ctx_param_ext_165017}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165029, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            
                                            int64_t tmp_151206 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_165045, "mem_165045") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_165043, "mem_165043") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_151206;
                                        }
                                        if (memblock_set(ctx, &ext_mem_165057, &ext_mem_165051, "ext_mem_165051") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &ext_mem_165048, "ext_mem_165048") != 0)
                                            return 1;
                                        loopres_151155 = loopres_f_res_151159;
                                    }
                                    
                                    bool loop_cond_151207 = slt64(loopres_151155, numIter_151062);
                                    
                                    if (memblock_set(ctx, &mem_param_tmp_165767, &ext_mem_165057, "ext_mem_165057") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_tmp_165768, &ext_mem_165054, "ext_mem_165054") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_165769 = ext_165056;
                                    int64_t ctx_param_ext_tmp_165770 = ext_165055;
                                    int64_t ctx_param_ext_tmp_165771 = ext_165053;
                                    int64_t ctx_param_ext_tmp_165772 = ext_165052;
                                    bool loop_while_tmp_165773 = loop_cond_151207;
                                    int64_t p_tmp_165774 = loopres_151155;
                                    
                                    if (memblock_set(ctx, &mem_param_165018, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_165021, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
                                        return 1;
                                    ctx_param_ext_165016 = ctx_param_ext_tmp_165769;
                                    ctx_param_ext_165017 = ctx_param_ext_tmp_165770;
                                    ctx_param_ext_165019 = ctx_param_ext_tmp_165771;
                                    ctx_param_ext_165020 = ctx_param_ext_tmp_165772;
                                    loop_while_151121 = loop_while_tmp_165773;
                                    p_151122 = p_tmp_165774;
                                }
                                if (memblock_set(ctx, &ext_mem_165063, &mem_param_165018, "mem_param_165018") != 0)
                                    return 1;
                                if (memblock_set(ctx, &ext_mem_165062, &mem_param_165021, "mem_param_165021") != 0)
                                    return 1;
                                ext_165061 = ctx_param_ext_165016;
                                ext_165060 = ctx_param_ext_165017;
                                ext_165059 = ctx_param_ext_165019;
                                ext_165058 = ctx_param_ext_165020;
                                defunc_0_find_joinTuples_res_151117 = loop_while_151121;
                                defunc_0_find_joinTuples_res_151118 = p_151122;
                                if (memblock_alloc(ctx, &mem_165065, bytes_165006, "mem_165065")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164749 = 0; i_164749 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164749++) {
                                    int64_t eta_p_151209 = ((int64_t *) mem_param_165015.mem)[i_164749];
                                    int64_t eta_p_151210 = ((int64_t *) ext_mem_165062.mem)[ext_165059 + i_164749 * ext_165058];
                                    bool cond_151211 = slt64(eta_p_151209, (int64_t) 0);
                                    int64_t lifted_lambda_res_151212;
                                    
                                    if (cond_151211) {
                                        lifted_lambda_res_151212 = eta_p_151210;
                                    } else {
                                        lifted_lambda_res_151212 = eta_p_151209;
                                    }
                                    ((int64_t *) mem_165065.mem)[i_164749] = lifted_lambda_res_151212;
                                }
                                if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
                                    return 1;
                                if (memblock_alloc(ctx, &mem_165073, bytes_165006, "mem_165073")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164753 = 0; i_164753 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164753++) {
                                    int64_t eta_p_151214 = ((int64_t *) mem_param_165012.mem)[i_164753];
                                    int64_t eta_p_151215 = ((int64_t *) ext_mem_165063.mem)[ext_165061 + i_164753 * ext_165060];
                                    int64_t defunc_0_f_res_151216 = add64(eta_p_151214, eta_p_151215);
                                    
                                    ((int64_t *) mem_165073.mem)[i_164753] = defunc_0_f_res_151216;
                                }
                                if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
                                    return 1;
                                
                                bool loop_cond_151217 = sle64(zeze_lhs_151078, min_res_151013);
                                
                                if (memblock_set(ctx, &mem_param_tmp_165761, &mem_165073, "mem_165073") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_tmp_165762, &mem_165065, "mem_165065") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_165763 = loop_cond_151217;
                                int64_t dp_tmp_165764 = zeze_lhs_151078;
                                
                                if (memblock_set(ctx, &mem_param_165012, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165015, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
                                    return 1;
                                loop_while_151069 = loop_while_tmp_165763;
                                dp_151070 = dp_tmp_165764;
                            }
                            if (memblock_set(ctx, &ext_mem_165085, &mem_param_165012, "mem_param_165012") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165084, &mem_param_165015, "mem_param_165015") != 0)
                                return 1;
                            loopres_f_res_f_res_151065 = loop_while_151069;
                            loopres_f_res_f_res_151066 = dp_151070;
                            if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
                                return 1;
                            if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (mem_165087_cached_sizze_166064 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165087, &mem_165087_cached_sizze_166064, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164757 = 0; i_164757 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164757++) {
                                int64_t slice_164901 = loopres_f_res_f_res_151022 + i_164757;
                                int64_t eta_p_151220 = ((int64_t *) mem_param_165005.mem)[ctx_param_ext_165003 + slice_164901 * ctx_param_ext_165004];
                                int64_t eta_p_151221 = ((int64_t *) ext_mem_165084.mem)[i_164757];
                                bool cond_151222 = slt64(eta_p_151220, (int64_t) 0);
                                int64_t lifted_lambda_res_151223;
                                
                                if (cond_151222) {
                                    lifted_lambda_res_151223 = eta_p_151221;
                                } else {
                                    lifted_lambda_res_151223 = eta_p_151220;
                                }
                                ((int64_t *) mem_165087)[i_164757] = lifted_lambda_res_151223;
                            }
                            if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
                                return 1;
                            if (mem_165095_cached_sizze_166065 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165095, &mem_165095_cached_sizze_166065, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164761 = 0; i_164761 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164761++) {
                                int64_t slice_164900 = loopres_f_res_f_res_151022 + i_164761;
                                int64_t eta_p_151226 = ((int64_t *) mem_param_165002.mem)[ctx_param_ext_165000 + slice_164900 * ctx_param_ext_165001];
                                int64_t eta_p_151227 = ((int64_t *) ext_mem_165085.mem)[i_164761];
                                int64_t defunc_0_f_res_151228 = add64(eta_p_151226, eta_p_151227);
                                
                                ((int64_t *) mem_165095)[i_164761] = defunc_0_f_res_151228;
                            }
                            if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165103, bytes_164931, "mem_165103")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165005.mem, ctx_param_ext_165003, (int64_t []) {ctx_param_ext_165004}, (int64_t []) {nR_121202});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165087, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_alloc(ctx, &mem_165105, bytes_164931, "mem_165105")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165002.mem, ctx_param_ext_165000, (int64_t []) {ctx_param_ext_165001}, (int64_t []) {nR_121202});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165095, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_set(ctx, &ext_mem_165111, &mem_165105, "mem_165105") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_165103, "mem_165103") != 0)
                                return 1;
                        }
                        if (memblock_set(ctx, &ext_mem_165117, &ext_mem_165111, "ext_mem_165111") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &ext_mem_165108, "ext_mem_165108") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_151233 = slt64(loopres_151015, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165749, &ext_mem_165117, "ext_mem_165117") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165750, &ext_mem_165114, "ext_mem_165114") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165751 = ext_165116;
                    int64_t ctx_param_ext_tmp_165752 = ext_165115;
                    int64_t ctx_param_ext_tmp_165753 = ext_165113;
                    int64_t ctx_param_ext_tmp_165754 = ext_165112;
                    bool loop_while_tmp_165755 = loop_cond_151233;
                    int64_t p_tmp_165756 = loopres_151015;
                    
                    if (memblock_set(ctx, &mem_param_165002, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165005, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
                        return 1;
                    ctx_param_ext_165000 = ctx_param_ext_tmp_165751;
                    ctx_param_ext_165001 = ctx_param_ext_tmp_165752;
                    ctx_param_ext_165003 = ctx_param_ext_tmp_165753;
                    ctx_param_ext_165004 = ctx_param_ext_tmp_165754;
                    loop_while_151003 = loop_while_tmp_165755;
                    p_151004 = p_tmp_165756;
                }
                if (memblock_set(ctx, &ext_mem_165123, &mem_param_165002, "mem_param_165002") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165122, &mem_param_165005, "mem_param_165005") != 0)
                    return 1;
                ext_165121 = ctx_param_ext_165000;
                ext_165120 = ctx_param_ext_165001;
                ext_165119 = ctx_param_ext_165003;
                ext_165118 = ctx_param_ext_165004;
                defunc_0_join_chunks_res_150999 = loop_while_151003;
                defunc_0_join_chunks_res_151000 = p_151004;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165123, "ext_mem_165123") != 0)
                    return 1;
                ext_165176 = ext_165121;
                ext_165175 = ext_165120;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165122, "ext_mem_165122") != 0)
                    return 1;
                ext_165173 = ext_165119;
                ext_165172 = ext_165118;
            }
            if (memblock_alloc(ctx, &mem_165179, bytes_164931, "mem_165179")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164765 = 0; i_164765 < nR_121202; i_164765++) {
                int64_t eta_p_151235 = ((int64_t *) mem_param_164940.mem)[i_164765];
                int64_t eta_p_151236 = ((int64_t *) ext_mem_165174.mem)[ext_165173 + i_164765 * ext_165172];
                bool cond_151237 = slt64(eta_p_151235, (int64_t) 0);
                int64_t lifted_lambda_res_151238;
                
                if (cond_151237) {
                    lifted_lambda_res_151238 = eta_p_151236;
                } else {
                    lifted_lambda_res_151238 = eta_p_151235;
                }
                ((int64_t *) mem_165179.mem)[i_164765] = lifted_lambda_res_151238;
            }
            if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165187, bytes_164931, "mem_165187")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < nR_121202; i_164769++) {
                int64_t eta_p_151240 = ((int64_t *) mem_param_164937.mem)[i_164769];
                int64_t eta_p_151241 = ((int64_t *) ext_mem_165177.mem)[ext_165176 + i_164769 * ext_165175];
                int64_t defunc_0_f_res_151242 = add64(eta_p_151240, eta_p_151241);
                
                ((int64_t *) mem_165187.mem)[i_164769] = defunc_0_f_res_151242;
            }
            if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
                return 1;
            
            int32_t leq_lhs_151247 = ((int32_t *) tS_mem_164929.mem)[i_p_m_t_s_150433];
            int32_t leq_rhs_151249 = ((int32_t *) tR_mem_164928.mem)[gt_rhs_150410];
            bool defunc_0_leq_res_151250 = sle32(leq_lhs_151247, leq_rhs_151249);
            int64_t nextIter_151251;
            
            if (defunc_0_leq_res_151250) {
                int64_t nextIter_t_res_157804 = add64((int64_t) 1, p_150424);
                
                nextIter_151251 = nextIter_t_res_157804;
            } else {
                nextIter_151251 = numIter_150404;
            }
            if (memblock_set(ctx, &ext_mem_165199, &mem_165187, "mem_165187") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_165179, "mem_165179") != 0)
                return 1;
            loopres_150448 = nextIter_151251;
        }
        
        bool loop_cond_151253 = slt64(loopres_150448, numIter_150404);
        
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        
        bool loop_while_tmp_165701 = loop_cond_151253;
        int64_t p_tmp_165702 = loopres_150448;
        
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        loop_while_150423 = loop_while_tmp_165701;
        p_150424 = p_tmp_165702;
    }
    if (memblock_set(ctx, &ext_mem_165205, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165204, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    defunc_0_mergeJoin_res_150419 = loop_while_150423;
    defunc_0_mergeJoin_res_150420 = p_150424;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
        return 1;
    if (mem_165207_cached_sizze_166068 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165207, &mem_165207_cached_sizze_166068, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165209_cached_sizze_166069 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165209, &mem_165209_cached_sizze_166069, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164779;
    int64_t scanacc_164773 = (int64_t) 0;
    
    for (int64_t i_164776 = 0; i_164776 < nR_121202; i_164776++) {
        int64_t eta_p_157038 = ((int64_t *) ext_mem_165205.mem)[i_164776];
        bool lifted_lambda_res_157039 = slt64((int64_t) 0, eta_p_157038);
        int64_t defunc_0_f_res_157040 = btoi_bool_i64(lifted_lambda_res_157039);
        int64_t defunc_0_op_res_151262 = add64(defunc_0_f_res_157040, scanacc_164773);
        
        ((int64_t *) mem_165207)[i_164776] = defunc_0_op_res_151262;
        ((int64_t *) mem_165209)[i_164776] = defunc_0_f_res_157040;
        
        int64_t scanacc_tmp_165788 = defunc_0_op_res_151262;
        
        scanacc_164773 = scanacc_tmp_165788;
    }
    discard_164779 = scanacc_164773;
    
    bool protect_assert_disj_151269 = zzero_150401 || bounds_check_150413;
    bool index_certs_151270;
    
    if (!protect_assert_disj_151269) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151271;
    
    if (nonzzero_150402) {
        int64_t x_157807 = ((int64_t *) mem_165207)[gt_rhs_150410];
        
        m_f_res_151271 = x_157807;
    } else {
        m_f_res_151271 = (int64_t) 0;
    }
    
    int64_t m_151273;
    
    if (zzero_150401) {
        m_151273 = (int64_t) 0;
    } else {
        m_151273 = m_f_res_151271;
    }
    
    int64_t m_151283 = sub64(m_151273, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151285 = slt64(m_151283, nR_121202);
    bool zzero_leq_i_p_m_t_s_151284 = sle64((int64_t) 0, m_151283);
    bool y_151287 = zzero_leq_i_p_m_t_s_151284 && i_p_m_t_s_leq_w_151285;
    bool i_lte_j_151286 = sle64((int64_t) 0, m_151273);
    bool forwards_ok_151288 = i_lte_j_151286 && y_151287;
    bool eq_x_zz_151280 = (int64_t) 0 == m_f_res_151271;
    bool p_and_eq_x_y_151281 = nonzzero_150402 && eq_x_zz_151280;
    bool empty_slice_151282 = zzero_150401 || p_and_eq_x_y_151281;
    bool ok_or_empty_151289 = empty_slice_151282 || forwards_ok_151288;
    bool index_certs_151290;
    
    if (!ok_or_empty_151289) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151273, "] out of bounds for array of shape [", (long long) nR_121202, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165222 = (int64_t) 8 * m_151273;
    
    if (mem_165223_cached_sizze_166070 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165223, &mem_165223_cached_sizze_166070, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165225_cached_sizze_166071 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165225, &mem_165225_cached_sizze_166071, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165225, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165204.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165227_cached_sizze_166072 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165227, &mem_165227_cached_sizze_166072, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165227, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164930.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    
    int64_t bytes_165228 = (int64_t) 4 * m_151273;
    
    if (mem_165229_cached_sizze_166073 < bytes_165228) {
        err = lexical_realloc(ctx, &mem_165229, &mem_165229_cached_sizze_166073, bytes_165228);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) tR_mem_164928.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    for (int64_t write_iter_164780 = 0; write_iter_164780 < nR_121202; write_iter_164780++) {
        int64_t write_iv_164785 = ((int64_t *) mem_165209)[write_iter_164780];
        int64_t write_iv_164786 = ((int64_t *) mem_165207)[write_iter_164780];
        int32_t write_iv_164787 = ((int32_t *) tR_mem_164928.mem)[write_iter_164780];
        int64_t write_iv_164788 = ((int64_t *) ext_mem_164930.mem)[write_iter_164780];
        int64_t write_iv_164789 = ((int64_t *) ext_mem_165204.mem)[write_iter_164780];
        int64_t write_iv_164790 = ((int64_t *) ext_mem_165205.mem)[write_iter_164780];
        bool cond_157033 = write_iv_164785 == (int64_t) 1;
        int64_t lifted_lambda_res_157034;
        
        if (cond_157033) {
            int64_t lifted_lambda_res_t_res_157808 = sub64(write_iv_164786, (int64_t) 1);
            
            lifted_lambda_res_157034 = lifted_lambda_res_t_res_157808;
        } else {
            lifted_lambda_res_157034 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int32_t *) mem_165229)[lifted_lambda_res_157034] = write_iv_164787;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165227)[lifted_lambda_res_157034] = write_iv_164788;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165225)[lifted_lambda_res_157034] = write_iv_164789;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165223)[lifted_lambda_res_157034] = write_iv_164790;
        }
    }
    if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
        return 1;
    if (mem_165255_cached_sizze_166074 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165255, &mem_165255_cached_sizze_166074, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165257_cached_sizze_166075 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165257, &mem_165257_cached_sizze_166075, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165259_cached_sizze_166076 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165259, &mem_165259_cached_sizze_166076, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164807;
    int64_t discard_164808;
    int64_t scanacc_164798;
    int64_t scanacc_164799;
    
    scanacc_164798 = (int64_t) 0;
    scanacc_164799 = (int64_t) 0;
    for (int64_t i_164803 = 0; i_164803 < m_151273; i_164803++) {
        int64_t x_157043 = ((int64_t *) mem_165223)[i_164803];
        bool lifted_lambda_res_157045 = slt64((int64_t) 1, x_157043);
        int64_t defunc_0_f_res_157046 = btoi_bool_i64(lifted_lambda_res_157045);
        int64_t lifted_lambda_res_151312 = add64(x_157043, scanacc_164798);
        int64_t defunc_0_op_res_151405 = add64(defunc_0_f_res_157046, scanacc_164799);
        
        ((int64_t *) mem_165255)[i_164803] = lifted_lambda_res_151312;
        ((int64_t *) mem_165257)[i_164803] = defunc_0_op_res_151405;
        ((int64_t *) mem_165259)[i_164803] = defunc_0_f_res_157046;
        
        int64_t scanacc_tmp_165795 = lifted_lambda_res_151312;
        int64_t scanacc_tmp_165796 = defunc_0_op_res_151405;
        
        scanacc_164798 = scanacc_tmp_165795;
        scanacc_164799 = scanacc_tmp_165796;
    }
    discard_164807 = scanacc_164798;
    discard_164808 = scanacc_164799;
    if (mem_165279_cached_sizze_166077 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165279, &mem_165279_cached_sizze_166077, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164811 = 0; i_164811 < m_151273; i_164811++) {
        int64_t zv_lhs_157020 = add64((int64_t) -1, i_164811);
        int64_t tmp_157021 = smod64(zv_lhs_157020, m_151273);
        int64_t lifted_lambda_res_157022 = ((int64_t *) mem_165255)[tmp_157021];
        bool cond_157024 = i_164811 == (int64_t) 0;
        int64_t lifted_lambda_res_157025;
        
        if (cond_157024) {
            lifted_lambda_res_157025 = (int64_t) 0;
        } else {
            lifted_lambda_res_157025 = lifted_lambda_res_157022;
        }
        ((int64_t *) mem_165279)[i_164811] = lifted_lambda_res_157025;
    }
    
    bool cond_151324 = slt64((int64_t) 0, m_151273);
    bool y_151325 = slt64(m_151283, m_151273);
    bool bounds_check_151326 = zzero_leq_i_p_m_t_s_151284 && y_151325;
    bool loop_not_taken_151327 = !cond_151324;
    bool protect_assert_disj_151328 = bounds_check_151326 || loop_not_taken_151327;
    bool index_certs_151329;
    
    if (!protect_assert_disj_151328) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  ftSMJ.fut:432:10-41\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:171:133-136\n   #3  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_lhs_151330;
    
    if (cond_151324) {
        int64_t x_157809 = ((int64_t *) mem_165279)[m_151283];
        
        zp_lhs_151330 = x_157809;
    } else {
        zp_lhs_151330 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151332;
    
    if (cond_151324) {
        int64_t x_157810 = ((int64_t *) mem_165223)[m_151283];
        
        n_pairs_t_res_151332 = x_157810;
    } else {
        n_pairs_t_res_151332 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151334 = add64(zp_lhs_151330, n_pairs_t_res_151332);
    int64_t n_pairs_151335;
    
    if (cond_151324) {
        n_pairs_151335 = n_pairs_t_res_151334;
    } else {
        n_pairs_151335 = (int64_t) 0;
    }
    
    int64_t bytes_165286 = (int64_t) 4 * n_pairs_151335;
    int64_t bytes_165288 = (int64_t) 8 * n_pairs_151335;
    bool zzero_151341 = scatter_psizze_121211 == (int64_t) 0;
    bool nonzzero_151342 = !zzero_151341;
    bool nonzzero_cert_151343;
    
    if (!nonzzero_151342) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:171:133-136\n   #3  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_151408 = !empty_slice_151282;
    bool protect_assert_disj_151409 = empty_slice_151282 || bounds_check_151326;
    bool index_certs_151410;
    
    if (!protect_assert_disj_151409) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151411;
    
    if (x_151408) {
        int64_t x_157815 = ((int64_t *) mem_165257)[m_151283];
        
        m_f_res_151411 = x_157815;
    } else {
        m_f_res_151411 = (int64_t) 0;
    }
    
    int64_t m_151413;
    
    if (empty_slice_151282) {
        m_151413 = (int64_t) 0;
    } else {
        m_151413 = m_f_res_151411;
    }
    
    int64_t m_151423 = sub64(m_151413, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151425 = slt64(m_151423, m_151273);
    bool zzero_leq_i_p_m_t_s_151424 = sle64((int64_t) 0, m_151423);
    bool y_151427 = zzero_leq_i_p_m_t_s_151424 && i_p_m_t_s_leq_w_151425;
    bool i_lte_j_151426 = sle64((int64_t) 0, m_151413);
    bool forwards_ok_151428 = i_lte_j_151426 && y_151427;
    bool eq_x_zz_151420 = (int64_t) 0 == m_f_res_151411;
    bool p_and_eq_x_y_151421 = x_151408 && eq_x_zz_151420;
    bool empty_slice_151422 = empty_slice_151282 || p_and_eq_x_y_151421;
    bool ok_or_empty_151429 = empty_slice_151422 || forwards_ok_151428;
    bool index_certs_151430;
    
    if (!ok_or_empty_151429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151413, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:171:133-136\n   #4  ftRelational.fut:160:1-171:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165334 = (int64_t) 8 * m_151413;
    
    if (memblock_alloc(ctx, &mem_165287, bytes_165286, "mem_165287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165801 = 0; nest_i_165801 < n_pairs_151335; nest_i_165801++) {
        ((int32_t *) mem_165287.mem)[nest_i_165801] = 0;
    }
    if (memblock_alloc(ctx, &mem_165289, bytes_165288, "mem_165289")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165802 = 0; nest_i_165802 < n_pairs_151335; nest_i_165802++) {
        ((int64_t *) mem_165289.mem)[nest_i_165802] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_165291, bytes_165288, "mem_165291")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165803 = 0; nest_i_165803 < n_pairs_151335; nest_i_165803++) {
        ((int64_t *) mem_165291.mem)[nest_i_165803] = (int64_t) -1;
    }
    
    int64_t zm_lhs_151339 = add64(scatter_psizze_121211, n_pairs_151335);
    int64_t zs_lhs_151340 = sub64(zm_lhs_151339, (int64_t) 1);
    int64_t m_151344 = sdiv64(zs_lhs_151340, scatter_psizze_121211);
    bool loop_cond_151345 = slt64((int64_t) 0, m_151344);
    bool partitioned_scatter_res_151346;
    int64_t partitioned_scatter_res_151350;
    bool loop_while_151351;
    int64_t p_151355;
    
    loop_while_151351 = loop_cond_151345;
    p_151355 = (int64_t) 0;
    while (loop_while_151351) {
        int64_t lower_bound_151356 = mul64(scatter_psizze_121211, p_151355);
        int64_t min_arg1_151357 = add64(scatter_psizze_121211, lower_bound_151356);
        int64_t min_res_151358 = smin64(n_pairs_151335, min_arg1_151357);
        int64_t j_m_i_151359 = sub64(min_res_151358, lower_bound_151356);
        bool empty_slice_151360 = j_m_i_151359 == (int64_t) 0;
        int64_t m_151361 = sub64(j_m_i_151359, (int64_t) 1);
        int64_t i_p_m_t_s_151362 = add64(lower_bound_151356, m_151361);
        bool zzero_leq_i_p_m_t_s_151363 = sle64((int64_t) 0, i_p_m_t_s_151362);
        bool i_p_m_t_s_leq_w_151364 = slt64(i_p_m_t_s_151362, n_pairs_151335);
        bool zzero_lte_i_151365 = sle64((int64_t) 0, lower_bound_151356);
        bool i_lte_j_151366 = sle64(lower_bound_151356, min_res_151358);
        bool y_151367 = i_p_m_t_s_leq_w_151364 && zzero_lte_i_151365;
        bool y_151368 = zzero_leq_i_p_m_t_s_151363 && y_151367;
        bool forwards_ok_151369 = i_lte_j_151366 && y_151368;
        bool ok_or_empty_151370 = empty_slice_151360 || forwards_ok_151369;
        bool index_certs_151371;
        
        if (!ok_or_empty_151370) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_151356, ":", (long long) min_res_151358, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:171:133-136\n   #3  ftRelational.fut:160:1-171:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165301 = (int64_t) 4 * j_m_i_151359;
        int64_t bytes_165303 = (int64_t) 8 * j_m_i_151359;
        
        if (mem_165302_cached_sizze_166078 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165302, &mem_165302_cached_sizze_166078, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_165287.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165304_cached_sizze_166079 < bytes_165303) {
            err = lexical_realloc(ctx, &mem_165304, &mem_165304_cached_sizze_166079, bytes_165303);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165289.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165306_cached_sizze_166080 < bytes_165303) {
            err = lexical_realloc(ctx, &mem_165306, &mem_165306_cached_sizze_166080, bytes_165303);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165291.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        for (int64_t write_iter_164813 = 0; write_iter_164813 < m_151273; write_iter_164813++) {
            int64_t write_iv_164817 = ((int64_t *) mem_165279)[write_iter_164813];
            int32_t write_iv_164818 = ((int32_t *) mem_165229)[write_iter_164813];
            int64_t write_iv_164819 = ((int64_t *) mem_165227)[write_iter_164813];
            int64_t write_iv_164820 = ((int64_t *) mem_165225)[write_iter_164813];
            bool cond_157424 = sle64(lower_bound_151356, write_iv_164817);
            bool cond_t_res_157425 = slt64(write_iv_164817, min_res_151358);
            bool x_157426 = cond_157424 && cond_t_res_157425;
            int64_t lifted_lambda_res_157427;
            
            if (x_157426) {
                int64_t lifted_lambda_res_t_res_157811 = sub64(write_iv_164817, lower_bound_151356);
                
                lifted_lambda_res_157427 = lifted_lambda_res_t_res_157811;
            } else {
                lifted_lambda_res_157427 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int32_t *) mem_165302)[lifted_lambda_res_157427] = write_iv_164818;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165304)[lifted_lambda_res_157427] = write_iv_164819;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165306)[lifted_lambda_res_157427] = write_iv_164820;
            }
        }
        
        int64_t tmp_151385 = add64((int64_t) 1, p_151355);
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165287.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165289.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165291.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        
        bool loop_cond_151396 = slt64(tmp_151385, m_151344);
        bool loop_while_tmp_165804 = loop_cond_151396;
        int64_t p_tmp_165808 = tmp_151385;
        
        loop_while_151351 = loop_while_tmp_165804;
        p_151355 = p_tmp_165808;
    }
    partitioned_scatter_res_151346 = loop_while_151351;
    partitioned_scatter_res_151350 = p_151355;
    if (mem_165335_cached_sizze_166081 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165335, &mem_165335_cached_sizze_166081, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165335, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    if (mem_165337_cached_sizze_166082 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165337, &mem_165337_cached_sizze_166082, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165337, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165279, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    for (int64_t write_iter_164824 = 0; write_iter_164824 < m_151273; write_iter_164824++) {
        int64_t write_iv_164827 = ((int64_t *) mem_165259)[write_iter_164824];
        int64_t write_iv_164828 = ((int64_t *) mem_165257)[write_iter_164824];
        int64_t write_iv_164829 = ((int64_t *) mem_165279)[write_iter_164824];
        int64_t write_iv_164830 = ((int64_t *) mem_165223)[write_iter_164824];
        bool cond_157008 = write_iv_164827 == (int64_t) 1;
        int64_t lifted_lambda_res_157009;
        
        if (cond_157008) {
            int64_t lifted_lambda_res_t_res_157816 = sub64(write_iv_164828, (int64_t) 1);
            
            lifted_lambda_res_157009 = lifted_lambda_res_t_res_157816;
        } else {
            lifted_lambda_res_157009 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165337)[lifted_lambda_res_157009] = write_iv_164829;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165335)[lifted_lambda_res_157009] = write_iv_164830;
        }
    }
    
    bool cond_151440 = slt64((int64_t) 0, m_151413);
    bool loop_cond_t_res_151441 = slt64(m_151273, n_pairs_151335);
    bool x_151442 = cond_151440 && loop_cond_t_res_151441;
    bool joinTups_to_joinPairs_InnerJoin_res_151443;
    int64_t joinTups_to_joinPairs_InnerJoin_res_151447;
    bool loop_while_151448;
    int64_t p_151452;
    
    if (memblock_set(ctx, &mem_param_165352, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165355, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165358, &mem_165291, "mem_165291") != 0)
        return 1;
    loop_while_151448 = x_151442;
    p_151452 = (int64_t) 0;
    while (loop_while_151448) {
        bool x_151453 = sle64((int64_t) 0, p_151452);
        bool y_151454 = slt64(p_151452, m_151413);
        bool bounds_check_151455 = x_151453 && y_151454;
        bool index_certs_151456;
        
        if (!bounds_check_151455) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151452, "] out of bounds for array of shape [", (long long) m_151413, "].", "-> #0  ftSMJ.fut:447:13-42\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:171:133-136\n   #3  ftRelational.fut:160:1-171:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_151457 = ((int64_t *) mem_165337)[p_151452];
        int64_t loopres_151458 = ((int64_t *) mem_165335)[p_151452];
        bool x_151459 = sle64((int64_t) 0, loopres_151457);
        bool y_151460 = slt64(loopres_151457, n_pairs_151335);
        bool bounds_check_151461 = x_151459 && y_151460;
        bool index_certs_151462;
        
        if (!bounds_check_151461) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:449:52-61\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:171:133-136\n   #3  ftRelational.fut:160:1-171:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165359 = (int64_t) 4 * loopres_151458;
        int64_t bytes_165361 = (int64_t) 8 * loopres_151458;
        int64_t tmp_151473 = add64(loopres_151457, loopres_151458);
        bool empty_slice_151477 = loopres_151458 == (int64_t) 0;
        int64_t m_151478 = sub64(loopres_151458, (int64_t) 1);
        int64_t i_p_m_t_s_151479 = add64(loopres_151457, m_151478);
        bool zzero_leq_i_p_m_t_s_151480 = sle64((int64_t) 0, i_p_m_t_s_151479);
        bool i_p_m_t_s_leq_w_151481 = slt64(i_p_m_t_s_151479, n_pairs_151335);
        bool i_lte_j_151482 = sle64(loopres_151457, tmp_151473);
        bool y_151483 = x_151459 && i_p_m_t_s_leq_w_151481;
        bool y_151484 = zzero_leq_i_p_m_t_s_151480 && y_151483;
        bool forwards_ok_151485 = i_lte_j_151482 && y_151484;
        bool ok_or_empty_151486 = empty_slice_151477 || forwards_ok_151485;
        bool index_certs_151487;
        
        if (!ok_or_empty_151486) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, ":", (long long) tmp_151473, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:453:14-55\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:171:133-136\n   #3  ftRelational.fut:160:1-171:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t loopres_151463 = ((int32_t *) mem_param_165352.mem)[loopres_151457];
        int64_t loopres_151464 = ((int64_t *) mem_param_165355.mem)[loopres_151457];
        int64_t loopres_151465 = ((int64_t *) mem_param_165358.mem)[loopres_151457];
        
        if (mem_165360_cached_sizze_166083 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165360, &mem_165360_cached_sizze_166083, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165822 = 0; nest_i_165822 < loopres_151458; nest_i_165822++) {
            ((int32_t *) mem_165360)[nest_i_165822] = loopres_151463;
        }
        if (mem_165362_cached_sizze_166084 < bytes_165361) {
            err = lexical_realloc(ctx, &mem_165362, &mem_165362_cached_sizze_166084, bytes_165361);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165823 = 0; nest_i_165823 < loopres_151458; nest_i_165823++) {
            ((int64_t *) mem_165362)[nest_i_165823] = loopres_151464;
        }
        if (mem_165364_cached_sizze_166085 < bytes_165361) {
            err = lexical_realloc(ctx, &mem_165364, &mem_165364_cached_sizze_166085, bytes_165361);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164835 = 0; i_164835 < loopres_151458; i_164835++) {
            int64_t tmp_151471 = add64(loopres_151465, i_164835);
            
            ((int64_t *) mem_165364)[i_164835] = tmp_151471;
        }
        
        int64_t tmp_151472 = add64((int64_t) 1, p_151452);
        
        if (memblock_alloc(ctx, &mem_165372, bytes_165286, "mem_165372")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165372.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_165352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165374, bytes_165288, "mem_165374")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165376, bytes_165288, "mem_165376")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_165372.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_165360, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165364, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        
        bool cond_151491 = slt64(tmp_151472, m_151413);
        bool x_151492 = loop_cond_t_res_151441 && cond_151491;
        
        if (memblock_set(ctx, &mem_param_tmp_165814, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165815, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165816, &mem_165376, "mem_165376") != 0)
            return 1;
        
        bool loop_while_tmp_165817 = x_151492;
        int64_t p_tmp_165821 = tmp_151472;
        
        if (memblock_set(ctx, &mem_param_165352, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165355, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165358, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        loop_while_151448 = loop_while_tmp_165817;
        p_151452 = p_tmp_165821;
    }
    if (memblock_set(ctx, &ext_mem_165385, &mem_param_165352, "mem_param_165352") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165384, &mem_param_165355, "mem_param_165355") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165383, &mem_param_165358, "mem_param_165358") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_151443 = loop_while_151448;
    joinTups_to_joinPairs_InnerJoin_res_151447 = p_151452;
    if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165387, bytes_165286, "mem_165387")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165389, bytes_165288, "mem_165389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165384.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165391, bytes_165288, "mem_165391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165383.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165389, "mem_165389") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165391, "mem_165391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165695, &mem_165387, "mem_165387") != 0)
        return 1;
    prim_out_165696 = n_pairs_151335;
    if (memblock_set(ctx, &*mem_out_p_166054, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166055, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166056, &mem_out_165695, "mem_out_165695") != 0)
        return 1;
    *out_prim_out_166057 = prim_out_165696;
    
  cleanup:
    {
        free(mem_164942);
        free(mem_164944);
        free(mem_164985);
        free(mem_164987);
        free(mem_165027);
        free(mem_165029);
        free(mem_165087);
        free(mem_165095);
        free(mem_165135);
        free(mem_165137);
        free(mem_165207);
        free(mem_165209);
        free(mem_165223);
        free(mem_165225);
        free(mem_165227);
        free(mem_165229);
        free(mem_165255);
        free(mem_165257);
        free(mem_165259);
        free(mem_165279);
        free(mem_165302);
        free(mem_165304);
        free(mem_165306);
        free(mem_165335);
        free(mem_165337);
        free(mem_165360);
        free(mem_165362);
        free(mem_165364);
        if (memblock_unref(ctx, &mem_165391, "mem_165391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165389, "mem_165389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165387, "mem_165387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165376, "mem_165376") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165358, "mem_param_165358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165355, "mem_param_165355") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165352, "mem_param_165352") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165187, "mem_165187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165179, "mem_165179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165105, "mem_165105") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165103, "mem_165103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165073, "mem_165073") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165065, "mem_165065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165045, "mem_165045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165043, "mem_165043") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165048, "ext_mem_165048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165051, "ext_mem_165051") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165054, "ext_mem_165054") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165057, "ext_mem_165057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165021, "mem_param_165021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165018, "mem_param_165018") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165015, "mem_param_165015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165012, "mem_param_165012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165114, "ext_mem_165114") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165117, "ext_mem_165117") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165005, "mem_param_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165002, "mem_param_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165122, "ext_mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165123, "ext_mem_165123") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164969, "mem_164969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164971, "mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165153, "mem_165153") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165151, "mem_165151") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165156, "ext_mem_165156") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165159, "ext_mem_165159") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165162, "ext_mem_165162") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165165, "ext_mem_165165") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165129, "mem_param_165129") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165126, "mem_param_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165170, "ext_mem_165170") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165171, "ext_mem_165171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165695, "mem_out_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_166086, struct memblock *mem_out_p_166087, struct memblock *mem_out_p_166088, int64_t *out_prim_out_166089, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_126092, int64_t nS_126093, int64_t offset_R_126096, int64_t offset_S_126097, int64_t partitionsPerWindow_126098, int64_t numberOfWindows_126099, int64_t extParallelism_126100, int64_t scatter_psizze_126101)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164942_cached_sizze_166090 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164944_cached_sizze_166091 = 0;
    unsigned char *mem_164944 = NULL;
    int64_t mem_164985_cached_sizze_166092 = 0;
    unsigned char *mem_164985 = NULL;
    int64_t mem_164987_cached_sizze_166093 = 0;
    unsigned char *mem_164987 = NULL;
    int64_t mem_165027_cached_sizze_166094 = 0;
    unsigned char *mem_165027 = NULL;
    int64_t mem_165029_cached_sizze_166095 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165087_cached_sizze_166096 = 0;
    unsigned char *mem_165087 = NULL;
    int64_t mem_165095_cached_sizze_166097 = 0;
    unsigned char *mem_165095 = NULL;
    int64_t mem_165135_cached_sizze_166098 = 0;
    unsigned char *mem_165135 = NULL;
    int64_t mem_165137_cached_sizze_166099 = 0;
    unsigned char *mem_165137 = NULL;
    int64_t mem_165207_cached_sizze_166100 = 0;
    unsigned char *mem_165207 = NULL;
    int64_t mem_165209_cached_sizze_166101 = 0;
    unsigned char *mem_165209 = NULL;
    int64_t mem_165223_cached_sizze_166102 = 0;
    unsigned char *mem_165223 = NULL;
    int64_t mem_165225_cached_sizze_166103 = 0;
    unsigned char *mem_165225 = NULL;
    int64_t mem_165227_cached_sizze_166104 = 0;
    unsigned char *mem_165227 = NULL;
    int64_t mem_165229_cached_sizze_166105 = 0;
    unsigned char *mem_165229 = NULL;
    int64_t mem_165255_cached_sizze_166106 = 0;
    unsigned char *mem_165255 = NULL;
    int64_t mem_165257_cached_sizze_166107 = 0;
    unsigned char *mem_165257 = NULL;
    int64_t mem_165259_cached_sizze_166108 = 0;
    unsigned char *mem_165259 = NULL;
    int64_t mem_165279_cached_sizze_166109 = 0;
    unsigned char *mem_165279 = NULL;
    int64_t mem_165302_cached_sizze_166110 = 0;
    unsigned char *mem_165302 = NULL;
    int64_t mem_165304_cached_sizze_166111 = 0;
    unsigned char *mem_165304 = NULL;
    int64_t mem_165306_cached_sizze_166112 = 0;
    unsigned char *mem_165306 = NULL;
    int64_t mem_165335_cached_sizze_166113 = 0;
    unsigned char *mem_165335 = NULL;
    int64_t mem_165337_cached_sizze_166114 = 0;
    unsigned char *mem_165337 = NULL;
    int64_t mem_165360_cached_sizze_166115 = 0;
    unsigned char *mem_165360 = NULL;
    int64_t mem_165362_cached_sizze_166116 = 0;
    unsigned char *mem_165362 = NULL;
    int64_t mem_165364_cached_sizze_166117 = 0;
    unsigned char *mem_165364 = NULL;
    struct memblock mem_165391;
    
    mem_165391.references = NULL;
    
    struct memblock mem_165389;
    
    mem_165389.references = NULL;
    
    struct memblock mem_165387;
    
    mem_165387.references = NULL;
    
    struct memblock mem_param_tmp_165816;
    
    mem_param_tmp_165816.references = NULL;
    
    struct memblock mem_param_tmp_165815;
    
    mem_param_tmp_165815.references = NULL;
    
    struct memblock mem_param_tmp_165814;
    
    mem_param_tmp_165814.references = NULL;
    
    struct memblock mem_165376;
    
    mem_165376.references = NULL;
    
    struct memblock mem_165374;
    
    mem_165374.references = NULL;
    
    struct memblock mem_165372;
    
    mem_165372.references = NULL;
    
    struct memblock mem_param_165358;
    
    mem_param_165358.references = NULL;
    
    struct memblock mem_param_165355;
    
    mem_param_165355.references = NULL;
    
    struct memblock mem_param_165352;
    
    mem_param_165352.references = NULL;
    
    struct memblock ext_mem_165383;
    
    ext_mem_165383.references = NULL;
    
    struct memblock ext_mem_165384;
    
    ext_mem_165384.references = NULL;
    
    struct memblock ext_mem_165385;
    
    ext_mem_165385.references = NULL;
    
    struct memblock mem_165291;
    
    mem_165291.references = NULL;
    
    struct memblock mem_165289;
    
    mem_165289.references = NULL;
    
    struct memblock mem_165287;
    
    mem_165287.references = NULL;
    
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_165187;
    
    mem_165187.references = NULL;
    
    struct memblock mem_165179;
    
    mem_165179.references = NULL;
    
    struct memblock mem_param_tmp_165750;
    
    mem_param_tmp_165750.references = NULL;
    
    struct memblock mem_param_tmp_165749;
    
    mem_param_tmp_165749.references = NULL;
    
    struct memblock mem_165105;
    
    mem_165105.references = NULL;
    
    struct memblock mem_165103;
    
    mem_165103.references = NULL;
    
    struct memblock mem_param_tmp_165762;
    
    mem_param_tmp_165762.references = NULL;
    
    struct memblock mem_param_tmp_165761;
    
    mem_param_tmp_165761.references = NULL;
    
    struct memblock mem_165073;
    
    mem_165073.references = NULL;
    
    struct memblock mem_165065;
    
    mem_165065.references = NULL;
    
    struct memblock mem_param_tmp_165768;
    
    mem_param_tmp_165768.references = NULL;
    
    struct memblock mem_param_tmp_165767;
    
    mem_param_tmp_165767.references = NULL;
    
    struct memblock mem_165045;
    
    mem_165045.references = NULL;
    
    struct memblock mem_165043;
    
    mem_165043.references = NULL;
    
    struct memblock ext_mem_165025;
    
    ext_mem_165025.references = NULL;
    
    struct memblock mem_165023;
    
    mem_165023.references = NULL;
    
    struct memblock ext_mem_165048;
    
    ext_mem_165048.references = NULL;
    
    struct memblock ext_mem_165051;
    
    ext_mem_165051.references = NULL;
    
    struct memblock ext_mem_165054;
    
    ext_mem_165054.references = NULL;
    
    struct memblock ext_mem_165057;
    
    ext_mem_165057.references = NULL;
    
    struct memblock mem_param_165021;
    
    mem_param_165021.references = NULL;
    
    struct memblock mem_param_165018;
    
    mem_param_165018.references = NULL;
    
    struct memblock ext_mem_165062;
    
    ext_mem_165062.references = NULL;
    
    struct memblock ext_mem_165063;
    
    ext_mem_165063.references = NULL;
    
    struct memblock mem_param_165015;
    
    mem_param_165015.references = NULL;
    
    struct memblock mem_param_165012;
    
    mem_param_165012.references = NULL;
    
    struct memblock ext_mem_165084;
    
    ext_mem_165084.references = NULL;
    
    struct memblock ext_mem_165085;
    
    ext_mem_165085.references = NULL;
    
    struct memblock mem_165009;
    
    mem_165009.references = NULL;
    
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock ext_mem_165114;
    
    ext_mem_165114.references = NULL;
    
    struct memblock ext_mem_165117;
    
    ext_mem_165117.references = NULL;
    
    struct memblock mem_param_165005;
    
    mem_param_165005.references = NULL;
    
    struct memblock mem_param_165002;
    
    mem_param_165002.references = NULL;
    
    struct memblock ext_mem_165122;
    
    ext_mem_165122.references = NULL;
    
    struct memblock ext_mem_165123;
    
    ext_mem_165123.references = NULL;
    
    struct memblock mem_164969;
    
    mem_164969.references = NULL;
    
    struct memblock mem_164971;
    
    mem_164971.references = NULL;
    
    struct memblock ext_mem_164974;
    
    ext_mem_164974.references = NULL;
    
    struct memblock ext_mem_164977;
    
    ext_mem_164977.references = NULL;
    
    struct memblock mem_164954;
    
    mem_164954.references = NULL;
    
    struct memblock mem_164952;
    
    mem_164952.references = NULL;
    
    struct memblock mem_param_tmp_165706;
    
    mem_param_tmp_165706.references = NULL;
    
    struct memblock mem_param_tmp_165705;
    
    mem_param_tmp_165705.references = NULL;
    
    struct memblock mem_165153;
    
    mem_165153.references = NULL;
    
    struct memblock mem_165151;
    
    mem_165151.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165131;
    
    mem_165131.references = NULL;
    
    struct memblock ext_mem_165156;
    
    ext_mem_165156.references = NULL;
    
    struct memblock ext_mem_165159;
    
    ext_mem_165159.references = NULL;
    
    struct memblock ext_mem_165162;
    
    ext_mem_165162.references = NULL;
    
    struct memblock ext_mem_165165;
    
    ext_mem_165165.references = NULL;
    
    struct memblock mem_param_165129;
    
    mem_param_165129.references = NULL;
    
    struct memblock mem_param_165126;
    
    mem_param_165126.references = NULL;
    
    struct memblock ext_mem_165170;
    
    ext_mem_165170.references = NULL;
    
    struct memblock ext_mem_165171;
    
    ext_mem_165171.references = NULL;
    
    struct memblock ext_mem_165174;
    
    ext_mem_165174.references = NULL;
    
    struct memblock ext_mem_165177;
    
    ext_mem_165177.references = NULL;
    
    struct memblock ext_mem_165196;
    
    ext_mem_165196.references = NULL;
    
    struct memblock ext_mem_165199;
    
    ext_mem_165199.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock ext_mem_165204;
    
    ext_mem_165204.references = NULL;
    
    struct memblock ext_mem_165205;
    
    ext_mem_165205.references = NULL;
    
    struct memblock mem_164934;
    
    mem_164934.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock ext_mem_164930;
    
    ext_mem_164930.references = NULL;
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165696;
    int64_t zm_lhs_150399 = add64(nR_126092, nS_126093);
    int64_t zs_lhs_150400 = sub64(zm_lhs_150399, (int64_t) 1);
    bool zzero_150401 = nR_126092 == (int64_t) 0;
    bool nonzzero_150402 = !zzero_150401;
    bool nonzzero_cert_150403;
    
    if (!nonzzero_150402) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:379:26-29\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_150404 = sdiv64(zs_lhs_150400, nR_126092);
    
    if (futrts_indicesWithIncrement_12184(ctx, &ext_mem_164930, tR_mem_164928, nR_126092, offset_R_126096) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_164931 = (int64_t) 8 * nR_126092;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165697 = 0; nest_i_165697 < nR_126092; nest_i_165697++) {
        ((int64_t *) mem_164932.mem)[nest_i_165697] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_164934, bytes_164931, "mem_164934")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165698 = 0; nest_i_165698 < nR_126092; nest_i_165698++) {
        ((int64_t *) mem_164934.mem)[nest_i_165698] = (int64_t) 0;
    }
    
    bool loop_cond_150409 = slt64((int64_t) 0, numIter_150404);
    int64_t gt_rhs_150410 = sub64(nR_126092, (int64_t) 1);
    bool x_150411 = sle64((int64_t) 0, gt_rhs_150410);
    bool y_150412 = slt64(gt_rhs_150410, nR_126092);
    bool bounds_check_150413 = x_150411 && y_150412;
    bool loop_not_taken_150414 = !loop_cond_150409;
    bool protect_assert_disj_150415 = bounds_check_150413 || loop_not_taken_150414;
    bool index_certs_150416;
    
    if (!protect_assert_disj_150415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:386:25-33\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t gt_rhs_150417;
    
    if (loop_cond_150409) {
        int64_t x_157438 = ((int64_t *) tR_mem_164928.mem)[gt_rhs_150410];
        
        gt_rhs_150417 = x_157438;
    } else {
        gt_rhs_150417 = (int64_t) 0;
    }
    
    bool defunc_0_mergeJoin_res_150419;
    int64_t defunc_0_mergeJoin_res_150420;
    bool loop_while_150423;
    int64_t p_150424;
    
    if (memblock_set(ctx, &mem_param_164937, &mem_164934, "mem_164934") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &mem_164932, "mem_164932") != 0)
        return 1;
    loop_while_150423 = loop_cond_150409;
    p_150424 = (int64_t) 0;
    while (loop_while_150423) {
        int64_t tS_start_150427 = mul64(nR_126092, p_150424);
        int64_t min_arg1_150428 = add64(nR_126092, tS_start_150427);
        int64_t min_res_150429 = smin64(nS_126093, min_arg1_150428);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 = sub64(min_res_150429, tS_start_150427);
        bool empty_slice_150431 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 == (int64_t) 0;
        int64_t m_150432 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, (int64_t) 1);
        int64_t i_p_m_t_s_150433 = add64(tS_start_150427, m_150432);
        bool zzero_leq_i_p_m_t_s_150434 = sle64((int64_t) 0, i_p_m_t_s_150433);
        bool i_p_m_t_s_leq_w_150435 = slt64(i_p_m_t_s_150433, nS_126093);
        bool zzero_lte_i_150436 = sle64((int64_t) 0, tS_start_150427);
        bool i_lte_j_150437 = sle64(tS_start_150427, min_res_150429);
        bool y_150438 = i_p_m_t_s_leq_w_150435 && zzero_lte_i_150436;
        bool y_150439 = zzero_leq_i_p_m_t_s_150434 && y_150438;
        bool forwards_ok_150440 = i_lte_j_150437 && y_150439;
        bool ok_or_empty_150441 = empty_slice_150431 || forwards_ok_150440;
        bool index_certs_150442;
        
        if (!ok_or_empty_150441) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_150427, ":", (long long) min_res_150429, "] out of bounds for array of shape [", (long long) nS_126093, "].", "-> #0  ftSMJ.fut:385:16-35\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_150444 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
        bool index_certs_150445;
        
        if (!y_150444) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:386:12-19\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t gt_lhs_150446 = ((int64_t *) tS_mem_164929.mem)[tS_start_150427];
        bool defunc_0_gt_res_150447 = slt64(gt_rhs_150417, gt_lhs_150446);
        int64_t loopres_150448;
        
        if (defunc_0_gt_res_150447) {
            if (memblock_set(ctx, &ext_mem_165199, &mem_param_164937, "mem_param_164937") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_param_164940, "mem_param_164940") != 0)
                return 1;
            loopres_150448 = numIter_150404;
        } else {
            bool cond_150451 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, nR_126092);
            bool dim_match_150565 = nR_126092 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            bool protect_assert_disj_165549 = cond_150451 || dim_match_150565;
            bool empty_or_match_cert_150566;
            
            if (!protect_assert_disj_165549) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "] cannot match shape of type `[", (long long) nR_126092, "]i64`.", "-> #0  ftSMJ.fut:394:18-31\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_150572 = slt64((int64_t) 0, numberOfWindows_126099);
            bool y_150575 = slt64((int64_t) 0, nR_126092);
            bool loop_not_taken_150576 = !loop_cond_150572;
            bool protect_assert_disj_150577 = y_150575 || loop_not_taken_150576;
            bool protect_assert_disj_165551 = cond_150451 || protect_assert_disj_150577;
            bool index_certs_150578;
            
            if (!protect_assert_disj_165551) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:264:20-25\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_157450 = add64(nR_126092, extParallelism_126100);
            int64_t zs_lhs_157451 = sub64(zm_lhs_157450, (int64_t) 1);
            bool zzero_157452 = extParallelism_126100 == (int64_t) 0;
            bool nonzzero_157453 = !zzero_157452;
            bool loop_not_taken_165527 = !cond_150451;
            bool protect_assert_disj_165528 = nonzzero_157453 || loop_not_taken_165527;
            bool nonzzero_cert_157454;
            
            if (!protect_assert_disj_165528) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_157455 = sdiv_safe64(zs_lhs_157451, extParallelism_126100);
            bool loop_cond_157456 = slt64((int64_t) 0, numIter_157455);
            bool loop_not_taken_157457 = !y_150444;
            bool loop_not_taken_157458 = !loop_cond_157456;
            bool x_157459 = sle64((int64_t) 0, m_150432);
            bool y_157460 = slt64(m_150432, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
            bool bounds_check_157462 = x_157459 && y_157460;
            bool protect_assert_disj_157463 = loop_not_taken_157457 || bounds_check_157462;
            bool protect_assert_disj_157464 = loop_not_taken_157458 || protect_assert_disj_157463;
            bool protect_assert_disj_165530 = protect_assert_disj_157464 || loop_not_taken_165527;
            bool index_certs_157465;
            
            if (!protect_assert_disj_165530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151246;
            
            if (!bounds_check_157462) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:405:23-44\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151248;
            
            if (!bounds_check_150413) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:405:51-59\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 = mul64(partitionsPerWindow_126098, numberOfWindows_126099);
            int64_t join_chunks_arg3_150568 = add64(offset_S_126097, tS_start_150427);
            int64_t bytes_164941 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
            bool empty_slice_150573 = partitionsPerWindow_126098 == (int64_t) 0;
            int64_t m_150574 = sub64(partitionsPerWindow_126098, (int64_t) 1);
            bool protect_cond_conj_165552 = loop_cond_150572 && loop_not_taken_165527;
            int64_t leq_lhs_150579;
            
            if (protect_cond_conj_165552) {
                int64_t x_157566 = ((int64_t *) tR_mem_164928.mem)[(int64_t) 0];
                
                leq_lhs_150579 = x_157566;
            } else {
                leq_lhs_150579 = (int64_t) 0;
            }
            
            bool defunc_0_leq_res_150583 = sle64(leq_lhs_150579, gt_lhs_150446);
            int64_t lowest_150584;
            
            if (protect_cond_conj_165552) {
                bool loop_not_taken_165542 = !defunc_0_leq_res_150583;
                bool protect_assert_disj_165543 = y_150575 || loop_not_taken_165542;
                bool index_certs_157570;
                
                if (!protect_assert_disj_165543) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:264:44-49\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t lowest_t_res_157571;
                
                if (defunc_0_leq_res_150583) {
                    int64_t x_165544 = ((int64_t *) tR_mem_164928.mem)[(int64_t) 0];
                    
                    lowest_t_res_157571 = x_165544;
                } else {
                    lowest_t_res_157571 = (int64_t) 0;
                }
                
                int64_t x_157569;
                
                if (defunc_0_leq_res_150583) {
                    x_157569 = lowest_t_res_157571;
                } else {
                    bool index_certs_157572;
                    
                    if (!y_150575) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:264:55-60\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    x_157569 = gt_lhs_150446;
                }
                lowest_150584 = x_157569;
            } else {
                lowest_150584 = (int64_t) 0;
            }
            
            int64_t zeze_rhs_150843 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, (int64_t) 1);
            bool loop_cond_150998 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
            bool protect_cond_conj_157461 = y_150444 && loop_cond_157456;
            bool protect_cond_conj_165531 = cond_150451 && protect_cond_conj_157461;
            int64_t s_max_t_res_157466;
            
            if (protect_cond_conj_165531) {
                int64_t x_157467 = ((int64_t *) tS_mem_164929.mem)[i_p_m_t_s_150433];
                
                s_max_t_res_157466 = x_157467;
            } else {
                s_max_t_res_157466 = (int64_t) 0;
            }
            
            int64_t bytes_165130 = (int64_t) 8 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            int64_t ext_165176;
            int64_t ext_165175;
            int64_t ext_165173;
            int64_t ext_165172;
            
            if (cond_150451) {
                int64_t ext_165169;
                int64_t ext_165168;
                int64_t ext_165167;
                int64_t ext_165166;
                bool defunc_0_find_joinTuples_res_157468;
                int64_t defunc_0_find_joinTuples_res_157469;
                bool loop_while_157472;
                int64_t p_157473;
                int64_t ctx_param_ext_165124;
                int64_t ctx_param_ext_165125;
                int64_t ctx_param_ext_165127;
                int64_t ctx_param_ext_165128;
                
                if (memblock_set(ctx, &mem_param_165126, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165129, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165124 = (int64_t) 0;
                ctx_param_ext_165125 = (int64_t) 1;
                ctx_param_ext_165127 = (int64_t) 0;
                ctx_param_ext_165128 = (int64_t) 1;
                loop_while_157472 = loop_cond_157456;
                p_157473 = (int64_t) 0;
                while (loop_while_157472) {
                    int64_t start_157476 = mul64(extParallelism_126100, p_157473);
                    int64_t min_arg1_157477 = sub64(nR_126092, start_157476);
                    int64_t min_res_157478 = smin64(extParallelism_126100, min_arg1_157477);
                    int64_t iter_R_157479 = add64(start_157476, min_res_157478);
                    bool empty_slice_157480 = min_res_157478 == (int64_t) 0;
                    int64_t m_157481 = sub64(min_res_157478, (int64_t) 1);
                    int64_t i_p_m_t_s_157482 = add64(start_157476, m_157481);
                    bool zzero_leq_i_p_m_t_s_157483 = sle64((int64_t) 0, i_p_m_t_s_157482);
                    bool i_p_m_t_s_leq_w_157484 = slt64(i_p_m_t_s_157482, nR_126092);
                    bool zzero_lte_i_157485 = sle64((int64_t) 0, start_157476);
                    bool i_lte_j_157486 = sle64(start_157476, iter_R_157479);
                    bool y_157487 = i_p_m_t_s_leq_w_157484 && zzero_lte_i_157485;
                    bool y_157488 = zzero_leq_i_p_m_t_s_157483 && y_157487;
                    bool forwards_ok_157489 = i_lte_j_157486 && y_157488;
                    bool ok_or_empty_157490 = empty_slice_157480 || forwards_ok_157489;
                    bool index_certs_157491;
                    
                    if (!ok_or_empty_157490) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_157476, ":", (long long) iter_R_157479, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157492 = slt64(m_157481, min_res_157478);
                    bool x_157493 = sle64((int64_t) 0, m_157481);
                    bool bounds_check_157494 = y_157492 && x_157493;
                    bool index_certs_157495;
                    
                    if (!bounds_check_157494) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_157481, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157498 = slt64((int64_t) 0, min_res_157478);
                    bool index_certs_157499;
                    
                    if (!y_157498) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t r_max_157496 = ((int64_t *) tR_mem_164928.mem)[i_p_m_t_s_157482];
                    int64_t s_max_157497;
                    
                    if (y_150444) {
                        s_max_157497 = s_max_t_res_157466;
                    } else {
                        s_max_157497 = r_max_157496;
                    }
                    
                    int64_t r_min_157500 = ((int64_t *) tR_mem_164928.mem)[start_157476];
                    bool defunc_0_gt_res_157501 = slt64(s_max_157497, r_min_157500);
                    int64_t s_min_157502;
                    
                    if (y_150444) {
                        s_min_157502 = gt_lhs_150446;
                    } else {
                        s_min_157502 = r_min_157500;
                    }
                    
                    bool defunc_0_gt_res_157507 = slt64(r_max_157496, s_min_157502);
                    int64_t ext_165158;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165158 = ctx_param_ext_165124;
                    } else {
                        ext_165158 = (int64_t) 0;
                    }
                    
                    int64_t ext_165157;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165157 = ctx_param_ext_165125;
                    } else {
                        ext_165157 = (int64_t) 1;
                    }
                    
                    int64_t ext_165155;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165155 = ctx_param_ext_165127;
                    } else {
                        ext_165155 = (int64_t) 0;
                    }
                    
                    int64_t ext_165154;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165154 = ctx_param_ext_165128;
                    } else {
                        ext_165154 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165134 = (int64_t) 8 * min_res_157478;
                    int64_t ext_165164;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165164 = ctx_param_ext_165124;
                    } else {
                        ext_165164 = ext_165158;
                    }
                    
                    int64_t ext_165163;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165163 = ctx_param_ext_165125;
                    } else {
                        ext_165163 = ext_165157;
                    }
                    
                    int64_t ext_165161;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165161 = ctx_param_ext_165127;
                    } else {
                        ext_165161 = ext_165155;
                    }
                    
                    int64_t ext_165160;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165160 = ctx_param_ext_165128;
                    } else {
                        ext_165160 = ext_165154;
                    }
                    
                    int64_t loopres_157503;
                    
                    if (defunc_0_gt_res_157501) {
                        if (memblock_set(ctx, &ext_mem_165165, &mem_param_165126, "mem_param_165126") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &mem_param_165129, "mem_param_165129") != 0)
                            return 1;
                        loopres_157503 = numIter_157455;
                    } else {
                        int64_t loopres_f_res_157508;
                        
                        if (defunc_0_gt_res_157507) {
                            int64_t tmp_157512 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_param_165126, "mem_param_165126") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_param_165129, "mem_param_165129") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157512;
                        } else {
                            if (memblock_alloc(ctx, &mem_165131, bytes_165130, "mem_165131")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165131.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) tS_mem_164929.mem, tS_start_150427, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430});
                            if (futrts_indicesWithIncrement_12184(ctx, &ext_mem_165133, mem_165131, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, join_chunks_arg3_150568) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
                                return 1;
                            if (mem_165135_cached_sizze_166098 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165135, &mem_165135_cached_sizze_166098, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_165137_cached_sizze_166099 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165137, &mem_165137_cached_sizze_166099, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164719 = 0; i_164719 < min_res_157478; i_164719++) {
                                int64_t slice_164899 = start_157476 + i_164719;
                                int64_t eta_p_157518 = ((int64_t *) tR_mem_164928.mem)[slice_164899];
                                int64_t defunc_0_reduce_comm_res_157519;
                                int64_t defunc_0_reduce_comm_res_157520;
                                int64_t defunc_0_reduce_comm_res_157521;
                                int64_t redout_164711;
                                int64_t redout_164712;
                                int64_t redout_164713;
                                
                                redout_164711 = (int64_t) -1;
                                redout_164712 = eta_p_157518;
                                redout_164713 = (int64_t) 0;
                                for (int64_t i_164714 = 0; i_164714 < dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430; i_164714++) {
                                    int64_t x_157522 = ((int64_t *) ext_mem_165133.mem)[i_164714];
                                    int64_t slice_164898 = tS_start_150427 + i_164714;
                                    int64_t x_157523 = ((int64_t *) tS_mem_164929.mem)[slice_164898];
                                    bool defunc_0_neq_res_157531 = redout_164712 == eta_p_157518;
                                    bool defunc_0_neq_res_157532 = !defunc_0_neq_res_157531;
                                    bool cond_f_res_157533 = slt64(redout_164711, (int64_t) 0);
                                    bool y_157534 = defunc_0_neq_res_157531 && cond_f_res_157533;
                                    bool cond_157535 = defunc_0_neq_res_157532 || y_157534;
                                    bool defunc_0_neq_res_157536 = x_157523 == eta_p_157518;
                                    bool defunc_0_neq_res_157537 = !defunc_0_neq_res_157536;
                                    bool cond_t_res_f_res_157538 = slt64(x_157522, (int64_t) 0);
                                    bool y_157539 = defunc_0_neq_res_157536 && cond_t_res_f_res_157538;
                                    bool cond_t_res_157540 = defunc_0_neq_res_157537 || y_157539;
                                    bool x_157541 = cond_157535 && cond_t_res_157540;
                                    int64_t defunc_0_op_res_157542;
                                    int64_t defunc_0_op_res_157543;
                                    int64_t defunc_0_op_res_157544;
                                    
                                    if (x_157541) {
                                        defunc_0_op_res_157542 = (int64_t) -1;
                                        defunc_0_op_res_157543 = eta_p_157518;
                                        defunc_0_op_res_157544 = (int64_t) 0;
                                    } else {
                                        int64_t defunc_0_op_res_f_res_157545;
                                        int64_t defunc_0_op_res_f_res_157546;
                                        int64_t defunc_0_op_res_f_res_157547;
                                        
                                        if (cond_157535) {
                                            defunc_0_op_res_f_res_157545 = x_157522;
                                            defunc_0_op_res_f_res_157546 = x_157523;
                                            defunc_0_op_res_f_res_157547 = (int64_t) 1;
                                        } else {
                                            int64_t defunc_0_op_res_f_res_f_res_157548;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157548 = redout_164712;
                                            } else {
                                                defunc_0_op_res_f_res_f_res_157548 = eta_p_157518;
                                            }
                                            
                                            int64_t defunc_0_op_res_f_res_f_res_157549;
                                            int64_t defunc_0_op_res_f_res_f_res_157550;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157549 = redout_164711;
                                                defunc_0_op_res_f_res_f_res_157550 = redout_164713;
                                            } else {
                                                int64_t min_res_157551 = smin64(x_157522, redout_164711);
                                                int64_t tmp_157552 = add64((int64_t) 1, redout_164713);
                                                
                                                defunc_0_op_res_f_res_f_res_157549 = min_res_157551;
                                                defunc_0_op_res_f_res_f_res_157550 = tmp_157552;
                                            }
                                            defunc_0_op_res_f_res_157545 = defunc_0_op_res_f_res_f_res_157549;
                                            defunc_0_op_res_f_res_157546 = defunc_0_op_res_f_res_f_res_157548;
                                            defunc_0_op_res_f_res_157547 = defunc_0_op_res_f_res_f_res_157550;
                                        }
                                        defunc_0_op_res_157542 = defunc_0_op_res_f_res_157545;
                                        defunc_0_op_res_157543 = defunc_0_op_res_f_res_157546;
                                        defunc_0_op_res_157544 = defunc_0_op_res_f_res_157547;
                                    }
                                    
                                    int64_t redout_tmp_165717 = defunc_0_op_res_157542;
                                    int64_t redout_tmp_165718 = defunc_0_op_res_157543;
                                    int64_t redout_tmp_165719 = defunc_0_op_res_157544;
                                    
                                    redout_164711 = redout_tmp_165717;
                                    redout_164712 = redout_tmp_165718;
                                    redout_164713 = redout_tmp_165719;
                                }
                                defunc_0_reduce_comm_res_157519 = redout_164711;
                                defunc_0_reduce_comm_res_157520 = redout_164712;
                                defunc_0_reduce_comm_res_157521 = redout_164713;
                                ((int64_t *) mem_165135)[i_164719] = defunc_0_reduce_comm_res_157519;
                                ((int64_t *) mem_165137)[i_164719] = defunc_0_reduce_comm_res_157521;
                            }
                            if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165151, bytes_164931, "mem_165151")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165129.mem, ctx_param_ext_165127, (int64_t []) {ctx_param_ext_165128}, (int64_t []) {nR_126092});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165135, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            if (memblock_alloc(ctx, &mem_165153, bytes_164931, "mem_165153")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165126.mem, ctx_param_ext_165124, (int64_t []) {ctx_param_ext_165125}, (int64_t []) {nR_126092});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165137, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            
                            int64_t tmp_157564 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_165153, "mem_165153") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_165151, "mem_165151") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157564;
                        }
                        if (memblock_set(ctx, &ext_mem_165165, &ext_mem_165159, "ext_mem_165159") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &ext_mem_165156, "ext_mem_165156") != 0)
                            return 1;
                        loopres_157503 = loopres_f_res_157508;
                    }
                    
                    bool loop_cond_157565 = slt64(loopres_157503, numIter_157455);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165705, &ext_mem_165165, "ext_mem_165165") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165706, &ext_mem_165162, "ext_mem_165162") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165707 = ext_165164;
                    int64_t ctx_param_ext_tmp_165708 = ext_165163;
                    int64_t ctx_param_ext_tmp_165709 = ext_165161;
                    int64_t ctx_param_ext_tmp_165710 = ext_165160;
                    bool loop_while_tmp_165711 = loop_cond_157565;
                    int64_t p_tmp_165712 = loopres_157503;
                    
                    if (memblock_set(ctx, &mem_param_165126, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165129, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
                        return 1;
                    ctx_param_ext_165124 = ctx_param_ext_tmp_165707;
                    ctx_param_ext_165125 = ctx_param_ext_tmp_165708;
                    ctx_param_ext_165127 = ctx_param_ext_tmp_165709;
                    ctx_param_ext_165128 = ctx_param_ext_tmp_165710;
                    loop_while_157472 = loop_while_tmp_165711;
                    p_157473 = p_tmp_165712;
                }
                if (memblock_set(ctx, &ext_mem_165171, &mem_param_165126, "mem_param_165126") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165170, &mem_param_165129, "mem_param_165129") != 0)
                    return 1;
                ext_165169 = ctx_param_ext_165124;
                ext_165168 = ctx_param_ext_165125;
                ext_165167 = ctx_param_ext_165127;
                ext_165166 = ctx_param_ext_165128;
                defunc_0_find_joinTuples_res_157468 = loop_while_157472;
                defunc_0_find_joinTuples_res_157469 = p_157473;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165171, "ext_mem_165171") != 0)
                    return 1;
                ext_165176 = ext_165169;
                ext_165175 = ext_165168;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165170, "ext_mem_165170") != 0)
                    return 1;
                ext_165173 = ext_165167;
                ext_165172 = ext_165166;
            } else {
                if (mem_164942_cached_sizze_166090 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_166090, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165720 = 0; nest_i_165720 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165720++) {
                    ((int64_t *) mem_164942)[nest_i_165720] = nR_126092;
                }
                if (mem_164944_cached_sizze_166091 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164944, &mem_164944_cached_sizze_166091, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165721 = 0; nest_i_165721 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165721++) {
                    ((int64_t *) mem_164944)[nest_i_165721] = nR_126092;
                }
                
                bool defunc_0_windowed_partitionFunc_res_150590;
                int64_t defunc_0_windowed_partitionFunc_res_150591;
                bool loop_while_150594;
                int64_t p_150595;
                
                loop_while_150594 = loop_cond_150572;
                p_150595 = (int64_t) 0;
                while (loop_while_150594) {
                    int64_t start_150598 = mul64(partitionsPerWindow_126098, p_150595);
                    int64_t end_150599 = add64(partitionsPerWindow_126098, start_150598);
                    int64_t max_res_150600 = smax64((int64_t) 1, start_150598);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601 = sub64(end_150599, max_res_150600);
                    bool bounds_invalid_upwards_150602 = slt64(end_150599, max_res_150600);
                    bool valid_150603 = !bounds_invalid_upwards_150602;
                    bool range_valid_c_150604;
                    
                    if (!valid_150603) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_150600, "..<", (long long) end_150599, " is invalid.", "-> #0  ftbasics.fut:267:43-68\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_150607 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 == (int64_t) 0;
                    bool nonzzero_150608 = !zzero_150607;
                    bool nonzzero_cert_150609;
                    
                    if (!nonzzero_150608) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:270:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_164951 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool cond_150810 = slt64((int64_t) 0, start_150598);
                    int64_t conc_tmp_150811 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    int64_t ret_150812;
                    
                    if (cond_150810) {
                        ret_150812 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    } else {
                        ret_150812 = conc_tmp_150811;
                    }
                    
                    bool eq_x_y_150820 = partitionsPerWindow_126098 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool eq_x_zz_150821 = partitionsPerWindow_126098 == conc_tmp_150811;
                    bool p_and_eq_x_y_150822 = cond_150810 && eq_x_y_150820;
                    bool not_p_150823 = !cond_150810;
                    bool p_and_eq_x_y_150824 = eq_x_zz_150821 && not_p_150823;
                    bool dim_match_150825 = p_and_eq_x_y_150822 || p_and_eq_x_y_150824;
                    bool empty_or_match_cert_150826;
                    
                    if (!dim_match_150825) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_150812, "] cannot match shape of type `[", (long long) partitionsPerWindow_126098, "](i64, i64)`.", "-> #0  ftbasics.fut:331:5-336:49\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_150828 = add64(m_150574, start_150598);
                    bool zzero_leq_i_p_m_t_s_150829 = sle64((int64_t) 0, i_p_m_t_s_150828);
                    bool i_p_m_t_s_leq_w_150830 = slt64(i_p_m_t_s_150828, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool zzero_lte_i_150831 = sle64((int64_t) 0, start_150598);
                    bool i_lte_j_150832 = sle64(start_150598, end_150599);
                    bool y_150833 = i_p_m_t_s_leq_w_150830 && zzero_lte_i_150831;
                    bool y_150834 = zzero_leq_i_p_m_t_s_150829 && y_150833;
                    bool forwards_ok_150835 = i_lte_j_150832 && y_150834;
                    bool ok_or_empty_150836 = empty_slice_150573 || forwards_ok_150835;
                    bool index_certs_150837;
                    
                    if (!ok_or_empty_150836) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_150598, ":", (long long) end_150599, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftbasics.fut:356:37-74\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_150606 = add64(nR_126092, nR_126092);
                    
                    if (memblock_alloc(ctx, &mem_164952, bytes_164951, "mem_164952")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_164954, bytes_164951, "mem_164954")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164726 = 0; i_164726 < dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601; i_164726++) {
                        int64_t index_primexp_164907 = add64(max_res_150600, i_164726);
                        int64_t zs_lhs_150613 = mul64(zt_rhs_150606, index_primexp_164907);
                        int64_t index_150614 = sdiv64(zs_lhs_150613, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool cond_150615 = slt64(nR_126092, index_150614);
                        int64_t loop_over_150616;
                        
                        if (cond_150615) {
                            loop_over_150616 = nR_126092;
                        } else {
                            loop_over_150616 = index_150614;
                        }
                        
                        int64_t loop_over_150617;
                        
                        if (cond_150615) {
                            int64_t loop_over_t_res_157573 = sub64(index_150614, nR_126092);
                            
                            loop_over_150617 = loop_over_t_res_157573;
                        } else {
                            loop_over_150617 = (int64_t) 0;
                        }
                        
                        int64_t loop_over_150619;
                        
                        if (cond_150615) {
                            int64_t zm_lhs_157574 = sub64(index_150614, nR_126092);
                            int64_t loop_over_t_res_157575 = sub64(zm_lhs_157574, (int64_t) 1);
                            
                            loop_over_150619 = loop_over_t_res_157575;
                        } else {
                            loop_over_150619 = (int64_t) 0;
                        }
                        
                        bool defunc_0_f_res_150622;
                        int64_t defunc_0_f_res_150623;
                        int64_t defunc_0_f_res_150624;
                        int64_t defunc_0_f_res_150625;
                        bool loop_while_150626;
                        int64_t p_150627;
                        int64_t p_150628;
                        int64_t p_150629;
                        
                        loop_while_150626 = 1;
                        p_150627 = loop_over_150619;
                        p_150628 = loop_over_150616;
                        p_150629 = loop_over_150617;
                        while (loop_while_150626) {
                            int64_t zs_lhs_150630 = sub64(p_150628, p_150627);
                            int64_t offset_150631 = sdiv64(zs_lhs_150630, (int64_t) 2);
                            int64_t ai_150632 = sub64(p_150628, offset_150631);
                            int64_t max_arg1_150633 = add64(p_150629, offset_150631);
                            int64_t max_res_150634 = smax64((int64_t) 0, max_arg1_150633);
                            bool cond_150635 = slt64((int64_t) 0, max_res_150634);
                            int64_t b_prev_150636;
                            
                            if (cond_150635) {
                                int64_t tmp_157576 = sub64(max_res_150634, (int64_t) 1);
                                bool x_157577 = sle64((int64_t) 0, tmp_157576);
                                bool y_157578 = slt64(tmp_157576, nR_126092);
                                bool bounds_check_157579 = x_157577 && y_157578;
                                bool index_certs_157580;
                                
                                if (!bounds_check_157579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157576, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:282:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157581 = tS_start_150427 + tmp_157576;
                                int64_t b_prev_t_res_157582 = ((int64_t *) tS_mem_164929.mem)[slice_157581];
                                
                                b_prev_150636 = b_prev_t_res_157582;
                            } else {
                                b_prev_150636 = lowest_150584;
                            }
                            
                            bool cond_150643 = sle64(ai_150632, (int64_t) 0);
                            int64_t loopres_150644;
                            int64_t loopres_150645;
                            int64_t loopres_150646;
                            bool loopres_150647;
                            
                            if (cond_150643) {
                                loopres_150644 = p_150627;
                                loopres_150645 = (int64_t) 0;
                                loopres_150646 = max_res_150634;
                                loopres_150647 = 0;
                            } else {
                                bool cond_150648 = sle64(nR_126092, max_res_150634);
                                int64_t loopres_f_res_150649;
                                int64_t loopres_f_res_150650;
                                int64_t loopres_f_res_150651;
                                bool loopres_f_res_150652;
                                
                                if (cond_150648) {
                                    int64_t min_res_157584 = smin64(gt_rhs_150410, ai_150632);
                                    bool bounds_check_157587 = x_150411 && y_150412;
                                    bool index_certs_157588;
                                    
                                    if (!bounds_check_157587) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:293:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157591 = sle64((int64_t) 0, min_res_157584);
                                    bool y_157592 = slt64(min_res_157584, nR_126092);
                                    bool bounds_check_157593 = x_157591 && y_157592;
                                    bool index_certs_157594;
                                    
                                    if (!bounds_check_157593) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157584, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:293:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157589 = gt_rhs_150410 + tS_start_150427;
                                    int64_t leq_lhs_157590 = ((int64_t *) tS_mem_164929.mem)[slice_157589];
                                    int64_t leq_rhs_157595 = ((int64_t *) tR_mem_164928.mem)[min_res_157584];
                                    bool defunc_0_leq_res_157596 = sle64(leq_lhs_157590, leq_rhs_157595);
                                    int64_t loopres_f_res_t_res_157597;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157597 = ai_150632;
                                    } else {
                                        loopres_f_res_t_res_157597 = p_150628;
                                    }
                                    
                                    bool x_157598 = !defunc_0_leq_res_157596;
                                    int64_t loopres_f_res_t_res_157599;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157599 = nR_126092;
                                    } else {
                                        int64_t tmp_157600 = sub64(gt_rhs_150410, offset_150631);
                                        
                                        loopres_f_res_t_res_157599 = tmp_157600;
                                    }
                                    loopres_f_res_150649 = p_150627;
                                    loopres_f_res_150650 = loopres_f_res_t_res_157597;
                                    loopres_f_res_150651 = loopres_f_res_t_res_157599;
                                    loopres_f_res_150652 = x_157598;
                                } else {
                                    bool cond_150670 = sle64(nR_126092, ai_150632);
                                    int64_t loopres_f_res_f_res_150671;
                                    int64_t loopres_f_res_f_res_150672;
                                    int64_t loopres_f_res_f_res_150673;
                                    bool loopres_f_res_f_res_150674;
                                    
                                    if (cond_150670) {
                                        int64_t min_res_157602 = smin64(gt_rhs_150410, max_res_150634);
                                        bool bounds_check_157605 = x_150411 && y_150412;
                                        bool index_certs_157606;
                                        
                                        if (!bounds_check_157605) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:300:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157608 = sle64((int64_t) 0, min_res_157602);
                                        bool y_157609 = slt64(min_res_157602, nR_126092);
                                        bool bounds_check_157610 = x_157608 && y_157609;
                                        bool index_certs_157611;
                                        
                                        if (!bounds_check_157610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157602, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:300:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t leq_lhs_157607 = ((int64_t *) tR_mem_164928.mem)[gt_rhs_150410];
                                        int64_t slice_157612 = tS_start_150427 + min_res_157602;
                                        int64_t leq_rhs_157613 = ((int64_t *) tS_mem_164929.mem)[slice_157612];
                                        bool defunc_0_leq_res_157614 = sle64(leq_lhs_157607, leq_rhs_157613);
                                        int64_t loopres_f_res_f_res_t_res_157615;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157615 = max_res_150634;
                                        } else {
                                            loopres_f_res_f_res_t_res_157615 = p_150629;
                                        }
                                        
                                        bool x_157616 = !defunc_0_leq_res_157614;
                                        int64_t loopres_f_res_f_res_t_res_157617;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157617 = nR_126092;
                                        } else {
                                            loopres_f_res_f_res_t_res_157617 = gt_rhs_150410;
                                        }
                                        loopres_f_res_f_res_150671 = p_150627;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_t_res_157617;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_t_res_157615;
                                        loopres_f_res_f_res_150674 = x_157616;
                                    } else {
                                        bool cond_150691 = sle64(p_150628, p_150627);
                                        int64_t loopres_f_res_f_res_f_res_150692;
                                        int64_t loopres_f_res_f_res_f_res_150693;
                                        int64_t loopres_f_res_f_res_f_res_150694;
                                        bool loopres_f_res_f_res_f_res_150695;
                                        
                                        if (cond_150691) {
                                            bool cond_157655 = slt64(ai_150632, nR_126092);
                                            int64_t ai_157656;
                                            
                                            if (cond_157655) {
                                                ai_157656 = ai_150632;
                                            } else {
                                                ai_157656 = gt_rhs_150410;
                                            }
                                            
                                            bool x_157669 = sle64((int64_t) 0, ai_157656);
                                            bool y_157670 = slt64(ai_157656, nR_126092);
                                            bool bounds_check_157671 = x_157669 && y_157670;
                                            bool index_certs_157672;
                                            
                                            if (!bounds_check_157671) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_157656, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:234:8-14\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t b_prev_157658;
                                            
                                            if (cond_150635) {
                                                int64_t tmp_157659 = sub64(max_res_150634, (int64_t) 1);
                                                bool x_157660 = sle64((int64_t) 0, tmp_157659);
                                                bool y_157661 = slt64(tmp_157659, nR_126092);
                                                bool bounds_check_157662 = x_157660 && y_157661;
                                                bool index_certs_157663;
                                                
                                                if (!bounds_check_157662) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157659, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:232:31-39\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_157664 = tS_start_150427 + tmp_157659;
                                                int64_t b_prev_t_res_157665 = ((int64_t *) tS_mem_164929.mem)[slice_157664];
                                                
                                                b_prev_157658 = b_prev_t_res_157665;
                                            } else {
                                                bool index_certs_157667;
                                                
                                                if (!y_150575) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:232:45-50\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                b_prev_157658 = gt_lhs_150446;
                                            }
                                            
                                            int64_t gt_lhs_157673 = ((int64_t *) tR_mem_164928.mem)[ai_157656];
                                            bool defunc_0_gt_res_157674 = slt64(b_prev_157658, gt_lhs_157673);
                                            int64_t defunc_0_partFunc_sequential_search_res_157675;
                                            int64_t defunc_0_partFunc_sequential_search_res_157676;
                                            
                                            if (defunc_0_gt_res_157674) {
                                                int64_t zl_rhs_157677 = sub64(nR_126092, max_res_150634);
                                                bool loop_cond_157678 = slt64((int64_t) 0, zl_rhs_157677);
                                                bool defunc_0_partFunc_sequential_search_res_t_res_157679;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157681;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157682;
                                                bool loop_while_157683;
                                                int64_t p_157684;
                                                int64_t p_157685;
                                                int64_t p_157686;
                                                
                                                loop_while_157683 = loop_cond_157678;
                                                p_157684 = ai_157656;
                                                p_157685 = max_res_150634;
                                                p_157686 = (int64_t) 0;
                                                while (loop_while_157683) {
                                                    int64_t i_a_157687 = sub64(ai_157656, p_157686);
                                                    int64_t i_b_157688 = add64(max_res_150634, p_157686);
                                                    int64_t leq_lhs_157689 = sub64(i_a_157687, (int64_t) 1);
                                                    bool x_157690 = sle64((int64_t) 0, leq_lhs_157689);
                                                    bool y_157691 = slt64(leq_lhs_157689, nR_126092);
                                                    bool bounds_check_157692 = x_157690 && y_157691;
                                                    bool index_certs_157693;
                                                    
                                                    if (!bounds_check_157692) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157689, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:240:15-24\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157695 = sle64((int64_t) 0, i_b_157688);
                                                    bool y_157696 = slt64(i_b_157688, nR_126092);
                                                    bool bounds_check_157697 = x_157695 && y_157696;
                                                    bool index_certs_157698;
                                                    
                                                    if (!bounds_check_157697) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157688, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:240:31-38\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    int64_t leq_lhs_157694 = ((int64_t *) tR_mem_164928.mem)[leq_lhs_157689];
                                                    int64_t slice_157699 = tS_start_150427 + i_b_157688;
                                                    int64_t leq_rhs_157700 = ((int64_t *) tS_mem_164929.mem)[slice_157699];
                                                    bool defunc_0_leq_res_157701 = sle64(leq_lhs_157694, leq_rhs_157700);
                                                    int64_t loopres_157702;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157702 = i_a_157687;
                                                    } else {
                                                        loopres_157702 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157703;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157703 = i_b_157688;
                                                    } else {
                                                        loopres_157703 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157704;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157704 = zl_rhs_157677;
                                                    } else {
                                                        int64_t tmp_157705 = add64((int64_t) 1, p_157686);
                                                        
                                                        loopres_157704 = tmp_157705;
                                                    }
                                                    
                                                    bool loop_cond_157706 = slt64(loopres_157704, zl_rhs_157677);
                                                    bool loop_while_tmp_165732 = loop_cond_157706;
                                                    int64_t p_tmp_165733 = loopres_157702;
                                                    int64_t p_tmp_165734 = loopres_157703;
                                                    int64_t p_tmp_165735 = loopres_157704;
                                                    
                                                    loop_while_157683 = loop_while_tmp_165732;
                                                    p_157684 = p_tmp_165733;
                                                    p_157685 = p_tmp_165734;
                                                    p_157686 = p_tmp_165735;
                                                }
                                                defunc_0_partFunc_sequential_search_res_t_res_157679 = loop_while_157683;
                                                defunc_0_partFunc_sequential_search_res_t_res_157680 = p_157684;
                                                defunc_0_partFunc_sequential_search_res_t_res_157681 = p_157685;
                                                defunc_0_partFunc_sequential_search_res_t_res_157682 = p_157686;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_t_res_157681;
                                            } else {
                                                int64_t zl_rhs_157707 = sub64(max_res_150634, (int64_t) 1);
                                                bool loop_cond_157708 = slt64((int64_t) 0, zl_rhs_157707);
                                                bool defunc_0_partFunc_sequential_search_res_f_res_157709;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157711;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157712;
                                                bool loop_while_157713;
                                                int64_t p_157714;
                                                int64_t p_157715;
                                                int64_t p_157716;
                                                
                                                loop_while_157713 = loop_cond_157708;
                                                p_157714 = ai_157656;
                                                p_157715 = max_res_150634;
                                                p_157716 = (int64_t) 0;
                                                while (loop_while_157713) {
                                                    int64_t zp_lhs_157717 = add64(ai_157656, p_157716);
                                                    int64_t hi_a_157718 = add64((int64_t) 1, zp_lhs_157717);
                                                    bool cond_157719 = slt64(hi_a_157718, nR_126092);
                                                    int64_t i_a_157720;
                                                    
                                                    if (cond_157719) {
                                                        i_a_157720 = hi_a_157718;
                                                    } else {
                                                        i_a_157720 = gt_rhs_150410;
                                                    }
                                                    
                                                    int64_t zm_lhs_157722 = sub64(max_res_150634, p_157716);
                                                    int64_t i_b_157723 = sub64(zm_lhs_157722, (int64_t) 1);
                                                    bool x_157724 = sle64((int64_t) 0, i_a_157720);
                                                    bool y_157725 = slt64(i_a_157720, nR_126092);
                                                    bool bounds_check_157726 = x_157724 && y_157725;
                                                    bool index_certs_157727;
                                                    
                                                    if (!bounds_check_157726) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_a_157720, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:250:15-22\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157729 = sle64((int64_t) 0, i_b_157723);
                                                    bool y_157730 = slt64(i_b_157723, nR_126092);
                                                    bool bounds_check_157731 = x_157729 && y_157730;
                                                    bool index_certs_157732;
                                                    
                                                    if (!bounds_check_157731) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157723, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:250:28-35\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:184:133-136\n   #5  ftRelational.fut:173:1-184:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    int64_t gt_lhs_157728 = ((int64_t *) tR_mem_164928.mem)[i_a_157720];
                                                    int64_t slice_157733 = tS_start_150427 + i_b_157723;
                                                    int64_t gt_rhs_157734 = ((int64_t *) tS_mem_164929.mem)[slice_157733];
                                                    bool defunc_0_gt_res_157735 = slt64(gt_rhs_157734, gt_lhs_157728);
                                                    int64_t loopres_157736;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157736 = i_a_157720;
                                                    } else {
                                                        loopres_157736 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157737;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157737 = zm_lhs_157722;
                                                    } else {
                                                        loopres_157737 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157738;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157738 = zl_rhs_157707;
                                                    } else {
                                                        int64_t tmp_157739 = add64((int64_t) 1, p_157716);
                                                        
                                                        loopres_157738 = tmp_157739;
                                                    }
                                                    
                                                    bool loop_cond_157740 = slt64(loopres_157738, zl_rhs_157707);
                                                    bool loop_while_tmp_165736 = loop_cond_157740;
                                                    int64_t p_tmp_165737 = loopres_157736;
                                                    int64_t p_tmp_165738 = loopres_157737;
                                                    int64_t p_tmp_165739 = loopres_157738;
                                                    
                                                    loop_while_157713 = loop_while_tmp_165736;
                                                    p_157714 = p_tmp_165737;
                                                    p_157715 = p_tmp_165738;
                                                    p_157716 = p_tmp_165739;
                                                }
                                                defunc_0_partFunc_sequential_search_res_f_res_157709 = loop_while_157713;
                                                defunc_0_partFunc_sequential_search_res_f_res_157710 = p_157714;
                                                defunc_0_partFunc_sequential_search_res_f_res_157711 = p_157715;
                                                defunc_0_partFunc_sequential_search_res_f_res_157712 = p_157716;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_f_res_157711;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = p_150627;
                                            loopres_f_res_f_res_f_res_150693 = defunc_0_partFunc_sequential_search_res_157675;
                                            loopres_f_res_f_res_f_res_150694 = defunc_0_partFunc_sequential_search_res_157676;
                                            loopres_f_res_f_res_f_res_150695 = 0;
                                        } else {
                                            bool x_150779 = sle64((int64_t) 0, ai_150632);
                                            bool y_150780 = slt64(ai_150632, nR_126092);
                                            bool bounds_check_150781 = x_150779 && y_150780;
                                            bool index_certs_150782;
                                            
                                            if (!bounds_check_150781) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_150632, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:308:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t gt_lhs_150783 = ((int64_t *) tR_mem_164928.mem)[ai_150632];
                                            bool defunc_0_gt_res_150784 = slt64(b_prev_150636, gt_lhs_150783);
                                            int64_t loopres_f_res_f_res_f_res_f_res_150785;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150786;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150787;
                                            bool loopres_f_res_f_res_f_res_f_res_150788;
                                            
                                            if (defunc_0_gt_res_150784) {
                                                int64_t leq_lhs_157741 = sub64(ai_150632, (int64_t) 1);
                                                bool x_157742 = sle64((int64_t) 0, leq_lhs_157741);
                                                bool y_157743 = slt64(leq_lhs_157741, nR_126092);
                                                bool bounds_check_157744 = x_157742 && y_157743;
                                                bool index_certs_157745;
                                                
                                                if (!bounds_check_157744) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157741, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:309:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                bool x_157747 = sle64((int64_t) 0, max_res_150634);
                                                bool y_157748 = slt64(max_res_150634, nR_126092);
                                                bool bounds_check_157749 = x_157747 && y_157748;
                                                bool index_certs_157750;
                                                
                                                if (!bounds_check_157749) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150634, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftbasics.fut:309:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t leq_lhs_157746 = ((int64_t *) tR_mem_164928.mem)[leq_lhs_157741];
                                                int64_t slice_157751 = tS_start_150427 + max_res_150634;
                                                int64_t leq_rhs_157752 = ((int64_t *) tS_mem_164929.mem)[slice_157751];
                                                bool defunc_0_leq_res_157753 = sle64(leq_lhs_157746, leq_rhs_157752);
                                                bool x_157754 = !defunc_0_leq_res_157753;
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = ai_150632;
                                                } else {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = leq_lhs_157741;
                                                }
                                                
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = max_res_150634;
                                                } else {
                                                    int64_t tmp_157757 = add64((int64_t) 1, max_res_150634);
                                                    
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = tmp_157757;
                                                }
                                                loopres_f_res_f_res_f_res_f_res_150785 = p_150627;
                                                loopres_f_res_f_res_f_res_f_res_150786 = loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                loopres_f_res_f_res_f_res_f_res_150787 = loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                loopres_f_res_f_res_f_res_f_res_150788 = x_157754;
                                            } else {
                                                int64_t tmp_150805 = add64((int64_t) 1, ai_150632);
                                                
                                                loopres_f_res_f_res_f_res_f_res_150785 = tmp_150805;
                                                loopres_f_res_f_res_f_res_f_res_150786 = p_150628;
                                                loopres_f_res_f_res_f_res_f_res_150787 = p_150629;
                                                loopres_f_res_f_res_f_res_f_res_150788 = 1;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = loopres_f_res_f_res_f_res_f_res_150785;
                                            loopres_f_res_f_res_f_res_150693 = loopres_f_res_f_res_f_res_f_res_150786;
                                            loopres_f_res_f_res_f_res_150694 = loopres_f_res_f_res_f_res_f_res_150787;
                                            loopres_f_res_f_res_f_res_150695 = loopres_f_res_f_res_f_res_f_res_150788;
                                        }
                                        loopres_f_res_f_res_150671 = loopres_f_res_f_res_f_res_150692;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_f_res_150693;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_f_res_150694;
                                        loopres_f_res_f_res_150674 = loopres_f_res_f_res_f_res_150695;
                                    }
                                    loopres_f_res_150649 = loopres_f_res_f_res_150671;
                                    loopres_f_res_150650 = loopres_f_res_f_res_150672;
                                    loopres_f_res_150651 = loopres_f_res_f_res_150673;
                                    loopres_f_res_150652 = loopres_f_res_f_res_150674;
                                }
                                loopres_150644 = loopres_f_res_150649;
                                loopres_150645 = loopres_f_res_150650;
                                loopres_150646 = loopres_f_res_150651;
                                loopres_150647 = loopres_f_res_150652;
                            }
                            
                            bool loop_while_tmp_165728 = loopres_150647;
                            int64_t p_tmp_165729 = loopres_150644;
                            int64_t p_tmp_165730 = loopres_150645;
                            int64_t p_tmp_165731 = loopres_150646;
                            
                            loop_while_150626 = loop_while_tmp_165728;
                            p_150627 = p_tmp_165729;
                            p_150628 = p_tmp_165730;
                            p_150629 = p_tmp_165731;
                        }
                        defunc_0_f_res_150622 = loop_while_150626;
                        defunc_0_f_res_150623 = p_150627;
                        defunc_0_f_res_150624 = p_150628;
                        defunc_0_f_res_150625 = p_150629;
                        ((int64_t *) mem_164952.mem)[i_164726] = defunc_0_f_res_150624;
                        ((int64_t *) mem_164954.mem)[i_164726] = defunc_0_f_res_150625;
                    }
                    
                    int64_t bytes_164968 = (int64_t) 8 * ret_150812;
                    
                    if (cond_150810) {
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164952, "mem_164952") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164954, "mem_164954") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc(ctx, &mem_164971, bytes_164968, "mem_164971")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165740 = 0; nest_i_165740 < (int64_t) 1; nest_i_165740++) {
                            ((int64_t *) mem_164971.mem)[nest_i_165740] = (int64_t) 0;
                        }
                        if (memblock_alloc(ctx, &mem_164969, bytes_164968, "mem_164969")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165741 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        tmp_offs_165741 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165741 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        
                        int64_t tmp_offs_165742 = (int64_t) 0;
                        
                        if (!(tmp_offs_165742 == (int64_t) 0)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        }
                        tmp_offs_165742 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164954.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165742 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164969, "mem_164969") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164971, "mem_164971") != 0)
                            return 1;
                    }
                    if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
                        return 1;
                    
                    int64_t tmp_150827 = add64((int64_t) 1, p_150595);
                    
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164942, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164977.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164944, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164974.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
                        return 1;
                    
                    bool loop_cond_150840 = slt64(tmp_150827, numberOfWindows_126099);
                    bool loop_while_tmp_165722 = loop_cond_150840;
                    int64_t p_tmp_165723 = tmp_150827;
                    
                    loop_while_150594 = loop_while_tmp_165722;
                    p_150595 = p_tmp_165723;
                }
                defunc_0_windowed_partitionFunc_res_150590 = loop_while_150594;
                defunc_0_windowed_partitionFunc_res_150591 = p_150595;
                if (mem_164985_cached_sizze_166092 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164985, &mem_164985_cached_sizze_166092, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_164987_cached_sizze_166093 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164987, &mem_164987_cached_sizze_166093, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_164733 = 0; i_164733 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; i_164733++) {
                    int64_t eta_p_150847 = ((int64_t *) mem_164942)[i_164733];
                    int64_t min_res_150848 = smin64(gt_rhs_150410, eta_p_150847);
                    bool x_150849 = sle64((int64_t) 0, min_res_150848);
                    bool y_150850 = slt64(min_res_150848, nR_126092);
                    bool bounds_check_150851 = x_150849 && y_150850;
                    bool index_certs_150852;
                    
                    if (!bounds_check_150851) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150848, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:274:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool cond_150854 = i_164733 == zeze_rhs_150843;
                    int64_t ri_next_150855;
                    
                    if (cond_150854) {
                        ri_next_150855 = nR_126092;
                    } else {
                        int64_t tmp_150856 = add64((int64_t) 1, i_164733);
                        bool x_150857 = sle64((int64_t) 0, tmp_150856);
                        bool y_150858 = slt64(tmp_150856, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150859 = x_150857 && y_150858;
                        bool index_certs_150860;
                        
                        if (!bounds_check_150859) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150856, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:275:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t ri_next_f_res_150861 = ((int64_t *) mem_164942)[tmp_150856];
                        
                        ri_next_150855 = ri_next_f_res_150861;
                    }
                    
                    int64_t max_arg1_150862 = sub64(ri_next_150855, (int64_t) 1);
                    int64_t max_res_150863 = smax64((int64_t) 0, max_arg1_150862);
                    bool x_150864 = sle64((int64_t) 0, max_res_150863);
                    bool y_150865 = slt64(max_res_150863, nR_126092);
                    bool bounds_check_150866 = x_150864 && y_150865;
                    bool index_certs_150867;
                    
                    if (!bounds_check_150866) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150863, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:276:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t r_min_150853 = ((int64_t *) tR_mem_164928.mem)[min_res_150848];
                    int64_t r_max_150868 = ((int64_t *) tR_mem_164928.mem)[max_res_150863];
                    bool defunc_0_f_res_150869;
                    int64_t defunc_0_f_res_150870;
                    bool loop_while_150871;
                    int64_t fm_150872;
                    
                    loop_while_150871 = 1;
                    fm_150872 = i_164733;
                    while (loop_while_150871) {
                        bool x_150873 = sle64((int64_t) 0, fm_150872);
                        bool y_150874 = slt64(fm_150872, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150875 = x_150873 && y_150874;
                        bool index_certs_150876;
                        
                        if (!bounds_check_150875) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) fm_150872, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:281:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150877 = ((int64_t *) mem_164944)[fm_150872];
                        int64_t min_res_150878 = smin64(gt_rhs_150410, loopres_150877);
                        bool x_150879 = sle64((int64_t) 0, min_res_150878);
                        bool y_150880 = slt64(min_res_150878, nR_126092);
                        bool bounds_check_150881 = x_150879 && y_150880;
                        bool index_certs_150882;
                        
                        if (!bounds_check_150881) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150878, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:282:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150884 = sle64(zeze_rhs_150843, fm_150872);
                        int64_t si_next_150885;
                        
                        if (cond_150884) {
                            si_next_150885 = nR_126092;
                        } else {
                            int64_t tmp_150886 = add64((int64_t) 1, fm_150872);
                            bool x_150887 = sle64((int64_t) 0, tmp_150886);
                            bool y_150888 = slt64(tmp_150886, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150889 = x_150887 && y_150888;
                            bool index_certs_150890;
                            
                            if (!bounds_check_150889) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150886, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:283:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150891 = ((int64_t *) mem_164944)[tmp_150886];
                            
                            si_next_150885 = si_next_f_res_150891;
                        }
                        
                        int64_t max_arg1_150892 = sub64(si_next_150885, (int64_t) 1);
                        int64_t max_res_150893 = smax64(min_res_150878, max_arg1_150892);
                        bool x_150894 = sle64((int64_t) 0, max_res_150893);
                        bool y_150895 = slt64(max_res_150893, nR_126092);
                        bool bounds_check_150896 = x_150894 && y_150895;
                        bool index_certs_150897;
                        
                        if (!bounds_check_150896) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150893, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:284:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150899 = smin64(zeze_rhs_150843, si_next_150885);
                        bool x_150900 = sle64((int64_t) 0, min_res_150899);
                        bool y_150901 = slt64(min_res_150899, nR_126092);
                        bool bounds_check_150902 = x_150900 && y_150901;
                        bool index_certs_150903;
                        
                        if (!bounds_check_150902) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150899, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:285:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150905 = sub64(min_res_150878, (int64_t) 1);
                        int64_t max_res_150906 = smax64((int64_t) 0, max_arg1_150905);
                        bool x_150907 = sle64((int64_t) 0, max_res_150906);
                        bool y_150908 = slt64(max_res_150906, nR_126092);
                        bool bounds_check_150909 = x_150907 && y_150908;
                        bool index_certs_150910;
                        
                        if (!bounds_check_150909) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150906, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:286:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151506 = tS_start_150427 + min_res_150878;
                        int64_t s_min_150883 = ((int64_t *) tS_mem_164929.mem)[slice_151506];
                        int64_t slice_151505 = tS_start_150427 + max_res_150893;
                        int64_t s_max_150898 = ((int64_t *) tS_mem_164929.mem)[slice_151505];
                        int64_t slice_151504 = tS_start_150427 + min_res_150899;
                        int64_t s_nextMin_150904 = ((int64_t *) tS_mem_164929.mem)[slice_151504];
                        int64_t slice_151503 = tS_start_150427 + max_res_150906;
                        int64_t s_prevMax_150911 = ((int64_t *) tS_mem_164929.mem)[slice_151503];
                        bool defunc_0_gt_res_150912 = slt64(s_min_150883, r_min_150853);
                        bool loopres_150913;
                        int64_t loopres_150914;
                        
                        if (defunc_0_gt_res_150912) {
                            bool defunc_0_leq_res_157760 = sle64(r_min_150853, s_max_150898);
                            bool loopres_t_res_157761;
                            int64_t loopres_t_res_157762;
                            
                            if (defunc_0_leq_res_157760) {
                                loopres_t_res_157761 = 0;
                                loopres_t_res_157762 = fm_150872;
                            } else {
                                bool defunc_0_leq_res_157763 = sle64(r_min_150853, s_nextMin_150904);
                                int64_t zgze_lhs_157764 = add64((int64_t) 1, fm_150872);
                                bool tmp_f_res_157765 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, zgze_lhs_157764);
                                bool x_157766 = !defunc_0_leq_res_157763;
                                bool y_157767 = tmp_f_res_157765 && x_157766;
                                bool tmp_157768 = defunc_0_leq_res_157763 || y_157767;
                                bool loopres_t_res_f_res_157769 = !tmp_157768;
                                
                                loopres_t_res_157761 = loopres_t_res_f_res_157769;
                                loopres_t_res_157762 = zgze_lhs_157764;
                            }
                            loopres_150913 = loopres_t_res_157761;
                            loopres_150914 = loopres_t_res_157762;
                        } else {
                            bool defunc_0_leq_res_150925 = sle64(s_prevMax_150911, r_min_150853);
                            int64_t zlze_lhs_150926 = sub64(fm_150872, (int64_t) 1);
                            bool tmp_f_res_150927 = sle64(zlze_lhs_150926, (int64_t) 0);
                            bool x_150928 = !defunc_0_leq_res_150925;
                            bool y_150929 = tmp_f_res_150927 && x_150928;
                            bool tmp_150930 = defunc_0_leq_res_150925 || y_150929;
                            int64_t max_res_150931 = smax64((int64_t) 0, zlze_lhs_150926);
                            bool loopres_f_res_150932 = !tmp_150930;
                            
                            loopres_150913 = loopres_f_res_150932;
                            loopres_150914 = max_res_150931;
                        }
                        
                        bool loop_while_tmp_165745 = loopres_150913;
                        int64_t fm_tmp_165746 = loopres_150914;
                        
                        loop_while_150871 = loop_while_tmp_165745;
                        fm_150872 = fm_tmp_165746;
                    }
                    defunc_0_f_res_150869 = loop_while_150871;
                    defunc_0_f_res_150870 = fm_150872;
                    
                    bool defunc_0_f_res_150934;
                    int64_t defunc_0_f_res_150935;
                    bool loop_while_150936;
                    int64_t lm_150937;
                    
                    loop_while_150936 = 1;
                    lm_150937 = i_164733;
                    while (loop_while_150936) {
                        bool x_150938 = sle64((int64_t) 0, lm_150937);
                        bool y_150939 = slt64(lm_150937, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150940 = x_150938 && y_150939;
                        bool index_certs_150941;
                        
                        if (!bounds_check_150940) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lm_150937, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:297:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150942 = ((int64_t *) mem_164944)[lm_150937];
                        int64_t min_res_150943 = smin64(gt_rhs_150410, loopres_150942);
                        bool x_150944 = sle64((int64_t) 0, min_res_150943);
                        bool y_150945 = slt64(min_res_150943, nR_126092);
                        bool bounds_check_150946 = x_150944 && y_150945;
                        bool index_certs_150947;
                        
                        if (!bounds_check_150946) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150943, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:298:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150949 = sle64(zeze_rhs_150843, lm_150937);
                        int64_t si_next_150950;
                        
                        if (cond_150949) {
                            si_next_150950 = nR_126092;
                        } else {
                            int64_t tmp_150951 = add64((int64_t) 1, lm_150937);
                            bool x_150952 = sle64((int64_t) 0, tmp_150951);
                            bool y_150953 = slt64(tmp_150951, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150954 = x_150952 && y_150953;
                            bool index_certs_150955;
                            
                            if (!bounds_check_150954) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150951, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:299:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150956 = ((int64_t *) mem_164944)[tmp_150951];
                            
                            si_next_150950 = si_next_f_res_150956;
                        }
                        
                        int64_t max_arg1_150957 = sub64(si_next_150950, (int64_t) 1);
                        int64_t max_res_150958 = smax64(min_res_150943, max_arg1_150957);
                        bool x_150959 = sle64((int64_t) 0, max_res_150958);
                        bool y_150960 = slt64(max_res_150958, nR_126092);
                        bool bounds_check_150961 = x_150959 && y_150960;
                        bool index_certs_150962;
                        
                        if (!bounds_check_150961) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150958, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:300:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150964 = smin64(zeze_rhs_150843, si_next_150950);
                        bool x_150965 = sle64((int64_t) 0, min_res_150964);
                        bool y_150966 = slt64(min_res_150964, nR_126092);
                        bool bounds_check_150967 = x_150965 && y_150966;
                        bool index_certs_150968;
                        
                        if (!bounds_check_150967) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150964, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:301:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150970 = sub64(min_res_150943, (int64_t) 1);
                        int64_t max_res_150971 = smax64((int64_t) 0, max_arg1_150970);
                        bool x_150972 = sle64((int64_t) 0, max_res_150971);
                        bool y_150973 = slt64(max_res_150971, nR_126092);
                        bool bounds_check_150974 = x_150972 && y_150973;
                        bool index_certs_150975;
                        
                        if (!bounds_check_150974) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150971, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:302:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151502 = tS_start_150427 + min_res_150943;
                        int64_t s_min_150948 = ((int64_t *) tS_mem_164929.mem)[slice_151502];
                        int64_t slice_151501 = tS_start_150427 + max_res_150958;
                        int64_t s_max_150963 = ((int64_t *) tS_mem_164929.mem)[slice_151501];
                        int64_t slice_151500 = tS_start_150427 + min_res_150964;
                        int64_t s_nextMin_150969 = ((int64_t *) tS_mem_164929.mem)[slice_151500];
                        int64_t slice_151499 = tS_start_150427 + max_res_150971;
                        int64_t s_prevMax_150976 = ((int64_t *) tS_mem_164929.mem)[slice_151499];
                        bool defunc_0_gt_res_150977 = slt64(r_max_150868, s_max_150963);
                        bool loopres_150978;
                        int64_t loopres_150979;
                        
                        if (defunc_0_gt_res_150977) {
                            bool defunc_0_leq_res_157770 = sle64(s_min_150948, r_max_150868);
                            bool loopres_t_res_157771;
                            int64_t loopres_t_res_157772;
                            
                            if (defunc_0_leq_res_157770) {
                                loopres_t_res_157771 = 0;
                                loopres_t_res_157772 = lm_150937;
                            } else {
                                bool defunc_0_leq_res_157773 = sle64(s_prevMax_150976, r_max_150868);
                                int64_t zlze_lhs_157774 = sub64(lm_150937, (int64_t) 1);
                                bool tmp_f_res_157775 = sle64(zlze_lhs_157774, (int64_t) 0);
                                bool x_157776 = !defunc_0_leq_res_157773;
                                bool y_157777 = tmp_f_res_157775 && x_157776;
                                bool tmp_157778 = defunc_0_leq_res_157773 || y_157777;
                                int64_t max_res_157779 = smax64((int64_t) 0, zlze_lhs_157774);
                                bool loopres_t_res_f_res_157780 = !tmp_157778;
                                
                                loopres_t_res_157771 = loopres_t_res_f_res_157780;
                                loopres_t_res_157772 = max_res_157779;
                            }
                            loopres_150978 = loopres_t_res_157771;
                            loopres_150979 = loopres_t_res_157772;
                        } else {
                            bool defunc_0_leq_res_150991 = sle64(r_max_150868, s_nextMin_150969);
                            int64_t tmp_150992 = add64((int64_t) 1, lm_150937);
                            bool loopres_f_res_150993 = !defunc_0_leq_res_150991;
                            
                            loopres_150978 = loopres_f_res_150993;
                            loopres_150979 = tmp_150992;
                        }
                        
                        bool loop_cond_t_res_150994 = slt64(loopres_150979, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool x_150995 = loopres_150978 && loop_cond_t_res_150994;
                        bool loop_while_tmp_165747 = x_150995;
                        int64_t lm_tmp_165748 = loopres_150979;
                        
                        loop_while_150936 = loop_while_tmp_165747;
                        lm_150937 = lm_tmp_165748;
                    }
                    defunc_0_f_res_150934 = loop_while_150936;
                    defunc_0_f_res_150935 = lm_150937;
                    ((int64_t *) mem_164985)[i_164733] = defunc_0_f_res_150870;
                    ((int64_t *) mem_164987)[i_164733] = defunc_0_f_res_150935;
                }
                
                int64_t ext_165121;
                int64_t ext_165120;
                int64_t ext_165119;
                int64_t ext_165118;
                bool defunc_0_join_chunks_res_150999;
                int64_t defunc_0_join_chunks_res_151000;
                bool loop_while_151003;
                int64_t p_151004;
                int64_t ctx_param_ext_165000;
                int64_t ctx_param_ext_165001;
                int64_t ctx_param_ext_165003;
                int64_t ctx_param_ext_165004;
                
                if (memblock_set(ctx, &mem_param_165002, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165005, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165000 = (int64_t) 0;
                ctx_param_ext_165001 = (int64_t) 1;
                ctx_param_ext_165003 = (int64_t) 0;
                ctx_param_ext_165004 = (int64_t) 1;
                loop_while_151003 = loop_cond_150998;
                p_151004 = (int64_t) 0;
                while (loop_while_151003) {
                    bool x_151007 = sle64((int64_t) 0, p_151004);
                    bool y_151008 = slt64(p_151004, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151009 = x_151007 && y_151008;
                    bool index_certs_151010;
                    
                    if (!bounds_check_151009) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:334:22-34\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t loopres_151011 = ((int64_t *) mem_164985)[p_151004];
                    int64_t loopres_151012 = ((int64_t *) mem_164987)[p_151004];
                    int64_t min_res_151013 = smin64(zeze_rhs_150843, loopres_151012);
                    bool cond_151014 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, loopres_151011);
                    bool cond_151018 = slt64(min_res_151013, (int64_t) 0);
                    bool protect_assert_disj_151020 = bounds_check_151009 || cond_151018;
                    bool protect_assert_disj_165535 = cond_151014 || protect_assert_disj_151020;
                    bool index_certs_151021;
                    
                    if (!protect_assert_disj_165535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:338:19-32\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_151024 = add64((int64_t) 1, p_151004);
                    bool cond_151025 = zeze_lhs_151024 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    bool x_151027 = sle64((int64_t) 0, zeze_lhs_151024);
                    bool y_151028 = slt64(zeze_lhs_151024, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151029 = x_151027 && y_151028;
                    bool protect_assert_disj_151030 = cond_151025 || bounds_check_151029;
                    bool protect_assert_disj_151031 = cond_151018 || protect_assert_disj_151030;
                    bool protect_assert_disj_165538 = cond_151014 || protect_assert_disj_151031;
                    bool index_certs_151032;
                    
                    if (!protect_assert_disj_165538) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151024, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:339:49-64\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_165532 = !cond_151014;
                    bool x_151019 = !cond_151018;
                    bool protect_cond_conj_165536 = x_151019 && x_165532;
                    int64_t loopres_f_res_f_res_151022;
                    
                    if (protect_cond_conj_165536) {
                        int64_t x_157781 = ((int64_t *) mem_164942)[p_151004];
                        
                        loopres_f_res_f_res_151022 = x_157781;
                    } else {
                        loopres_f_res_f_res_151022 = (int64_t) 0;
                    }
                    
                    bool x_151026 = !cond_151025;
                    bool protect_cond_conj_151033 = x_151019 && x_151026;
                    bool protect_cond_conj_165539 = protect_cond_conj_151033 && x_165532;
                    int64_t r_end_f_res_151034;
                    
                    if (protect_cond_conj_165539) {
                        int64_t x_157782 = ((int64_t *) mem_164942)[zeze_lhs_151024];
                        
                        r_end_f_res_151034 = x_157782;
                    } else {
                        r_end_f_res_151034 = (int64_t) 0;
                    }
                    
                    int64_t r_end_151036;
                    
                    if (cond_151025) {
                        r_end_151036 = nR_126092;
                    } else {
                        r_end_151036 = r_end_f_res_151034;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 = sub64(r_end_151036, loopres_f_res_f_res_151022);
                    int64_t ext_165110;
                    
                    if (cond_151018) {
                        ext_165110 = ctx_param_ext_165000;
                    } else {
                        ext_165110 = (int64_t) 0;
                    }
                    
                    int64_t ext_165109;
                    
                    if (cond_151018) {
                        ext_165109 = ctx_param_ext_165001;
                    } else {
                        ext_165109 = (int64_t) 1;
                    }
                    
                    int64_t ext_165107;
                    
                    if (cond_151018) {
                        ext_165107 = ctx_param_ext_165003;
                    } else {
                        ext_165107 = (int64_t) 0;
                    }
                    
                    int64_t ext_165106;
                    
                    if (cond_151018) {
                        ext_165106 = ctx_param_ext_165004;
                    } else {
                        ext_165106 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165006 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037;
                    int64_t ext_165116;
                    
                    if (cond_151014) {
                        ext_165116 = ctx_param_ext_165000;
                    } else {
                        ext_165116 = ext_165110;
                    }
                    
                    int64_t ext_165115;
                    
                    if (cond_151014) {
                        ext_165115 = ctx_param_ext_165001;
                    } else {
                        ext_165115 = ext_165109;
                    }
                    
                    int64_t ext_165113;
                    
                    if (cond_151014) {
                        ext_165113 = ctx_param_ext_165003;
                    } else {
                        ext_165113 = ext_165107;
                    }
                    
                    int64_t ext_165112;
                    
                    if (cond_151014) {
                        ext_165112 = ctx_param_ext_165004;
                    } else {
                        ext_165112 = ext_165106;
                    }
                    
                    int64_t loopres_151015;
                    
                    if (cond_151014) {
                        loopres_151015 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    } else {
                        loopres_151015 = zeze_lhs_151024;
                    }
                    if (cond_151014) {
                        if (memblock_set(ctx, &ext_mem_165117, &mem_param_165002, "mem_param_165002") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &mem_param_165005, "mem_param_165005") != 0)
                            return 1;
                    } else {
                        if (cond_151018) {
                            if (memblock_set(ctx, &ext_mem_165111, &mem_param_165002, "mem_param_165002") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_param_165005, "mem_param_165005") != 0)
                                return 1;
                        } else {
                            bool empty_slice_151040 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 == (int64_t) 0;
                            int64_t m_151041 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, (int64_t) 1);
                            int64_t i_p_m_t_s_151042 = add64(loopres_f_res_f_res_151022, m_151041);
                            bool zzero_leq_i_p_m_t_s_151043 = sle64((int64_t) 0, i_p_m_t_s_151042);
                            bool i_p_m_t_s_leq_w_151044 = slt64(i_p_m_t_s_151042, nR_126092);
                            bool zzero_lte_i_151045 = sle64((int64_t) 0, loopres_f_res_f_res_151022);
                            bool i_lte_j_151046 = sle64(loopres_f_res_f_res_151022, r_end_151036);
                            bool y_151047 = i_p_m_t_s_leq_w_151044 && zzero_lte_i_151045;
                            bool y_151048 = zzero_leq_i_p_m_t_s_151043 && y_151047;
                            bool forwards_ok_151049 = i_lte_j_151046 && y_151048;
                            bool ok_or_empty_151050 = empty_slice_151040 || forwards_ok_151049;
                            bool index_certs_151051;
                            
                            if (!ok_or_empty_151050) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_151022, ":", (long long) r_end_151036, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:340:16-33\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_151054 = sle64(loopres_151011, min_res_151013);
                            bool loop_not_taken_151059 = !loop_cond_151054;
                            bool protect_assert_disj_151060 = loop_not_taken_151059 || nonzzero_157453;
                            bool nonzzero_cert_151061;
                            
                            if (!protect_assert_disj_151060) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165759 = 0; nest_i_165759 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165759++) {
                                ((int64_t *) mem_165007.mem)[nest_i_165759] = (int64_t) -1;
                            }
                            if (memblock_alloc(ctx, &mem_165009, bytes_165006, "mem_165009")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165760 = 0; nest_i_165760 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165760++) {
                                ((int64_t *) mem_165009.mem)[nest_i_165760] = (int64_t) 0;
                            }
                            
                            int64_t zm_lhs_151055 = add64(extParallelism_126100, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                            int64_t zs_lhs_151056 = sub64(zm_lhs_151055, (int64_t) 1);
                            int64_t numIter_151062 = sdiv_safe64(zs_lhs_151056, extParallelism_126100);
                            bool loop_cond_151063 = slt64((int64_t) 0, numIter_151062);
                            bool loop_not_taken_151064 = !loop_cond_151063;
                            bool loopres_f_res_f_res_151065;
                            int64_t loopres_f_res_f_res_151066;
                            bool loop_while_151069;
                            int64_t dp_151070;
                            
                            if (memblock_set(ctx, &mem_param_165012, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_165015, &mem_165007, "mem_165007") != 0)
                                return 1;
                            loop_while_151069 = loop_cond_151054;
                            dp_151070 = loopres_151011;
                            while (loop_while_151069) {
                                bool x_151073 = sle64((int64_t) 0, dp_151070);
                                bool y_151074 = slt64(dp_151070, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151075 = x_151073 && y_151074;
                                bool index_certs_151076;
                                
                                if (!bounds_check_151075) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_151070, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:344:21-38\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_151077 = ((int64_t *) mem_164944)[dp_151070];
                                int64_t zeze_lhs_151078 = add64((int64_t) 1, dp_151070);
                                bool cond_151079 = zeze_lhs_151078 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                                bool x_151080 = !cond_151079;
                                bool x_151081 = sle64((int64_t) 0, zeze_lhs_151078);
                                bool y_151082 = slt64(zeze_lhs_151078, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151083 = x_151081 && y_151082;
                                bool protect_assert_disj_151084 = cond_151079 || bounds_check_151083;
                                bool index_certs_151085;
                                
                                if (!protect_assert_disj_151084) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151078, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:345:55-74\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_151086;
                                
                                if (x_151080) {
                                    int64_t x_157783 = ((int64_t *) mem_164944)[zeze_lhs_151078];
                                    
                                    s_end_f_res_151086 = x_157783;
                                } else {
                                    s_end_f_res_151086 = (int64_t) 0;
                                }
                                
                                int64_t s_end_151088;
                                
                                if (cond_151079) {
                                    s_end_151088 = nR_126092;
                                } else {
                                    s_end_151088 = s_end_f_res_151086;
                                }
                                
                                int64_t j_m_i_151089 = sub64(s_end_151088, loopres_151077);
                                bool empty_slice_151090 = j_m_i_151089 == (int64_t) 0;
                                int64_t m_151091 = sub64(j_m_i_151089, (int64_t) 1);
                                int64_t i_p_m_t_s_151092 = add64(loopres_151077, m_151091);
                                bool zzero_leq_i_p_m_t_s_151093 = sle64((int64_t) 0, i_p_m_t_s_151092);
                                bool i_p_m_t_s_leq_w_151094 = slt64(i_p_m_t_s_151092, nR_126092);
                                bool zzero_lte_i_151095 = sle64((int64_t) 0, loopres_151077);
                                bool i_lte_j_151096 = sle64(loopres_151077, s_end_151088);
                                bool y_151097 = i_p_m_t_s_leq_w_151094 && zzero_lte_i_151095;
                                bool y_151098 = zzero_leq_i_p_m_t_s_151093 && y_151097;
                                bool forwards_ok_151099 = i_lte_j_151096 && y_151098;
                                bool ok_or_empty_151100 = empty_slice_151090 || forwards_ok_151099;
                                bool index_certs_151101;
                                
                                if (!ok_or_empty_151100) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151077, ":", (long long) s_end_151088, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  ftSMJ.fut:346:18-35\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_151104 = slt64((int64_t) 0, j_m_i_151089);
                                bool loop_not_taken_151105 = !cond_151104;
                                bool x_151106 = sle64((int64_t) 0, m_151091);
                                bool y_151107 = slt64(m_151091, j_m_i_151089);
                                bool bounds_check_151111 = x_151106 && y_151107;
                                bool protect_assert_disj_151112 = loop_not_taken_151105 || bounds_check_151111;
                                bool protect_assert_disj_151113 = loop_not_taken_151064 || protect_assert_disj_151112;
                                bool index_certs_151114;
                                
                                if (!protect_assert_disj_151113) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151091, "] out of bounds for array of shape [", (long long) j_m_i_151089, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_151498 = tS_start_150427 + loopres_151077;
                                int64_t find_joinTuples_arg3_151103 = add64(join_chunks_arg3_150568, loopres_151077);
                                bool protect_cond_conj_151108 = loop_cond_151063 && cond_151104;
                                int64_t s_min_t_res_151109;
                                
                                if (protect_cond_conj_151108) {
                                    int64_t x_157784 = ((int64_t *) tS_mem_164929.mem)[slice_151498];
                                    
                                    s_min_t_res_151109 = x_157784;
                                } else {
                                    s_min_t_res_151109 = (int64_t) 0;
                                }
                                
                                int64_t s_max_t_res_151115;
                                
                                if (protect_cond_conj_151108) {
                                    int64_t slice_157785 = tS_start_150427 + i_p_m_t_s_151092;
                                    int64_t x_157786 = ((int64_t *) tS_mem_164929.mem)[slice_157785];
                                    
                                    s_max_t_res_151115 = x_157786;
                                } else {
                                    s_max_t_res_151115 = (int64_t) 0;
                                }
                                
                                int64_t bytes_165022 = (int64_t) 8 * j_m_i_151089;
                                int64_t ext_165061;
                                int64_t ext_165060;
                                int64_t ext_165059;
                                int64_t ext_165058;
                                bool defunc_0_find_joinTuples_res_151117;
                                int64_t defunc_0_find_joinTuples_res_151118;
                                bool loop_while_151121;
                                int64_t p_151122;
                                int64_t ctx_param_ext_165016;
                                int64_t ctx_param_ext_165017;
                                int64_t ctx_param_ext_165019;
                                int64_t ctx_param_ext_165020;
                                
                                if (memblock_set(ctx, &mem_param_165018, &mem_165009, "mem_165009") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165021, &mem_165007, "mem_165007") != 0)
                                    return 1;
                                ctx_param_ext_165016 = (int64_t) 0;
                                ctx_param_ext_165017 = (int64_t) 1;
                                ctx_param_ext_165019 = (int64_t) 0;
                                ctx_param_ext_165020 = (int64_t) 1;
                                loop_while_151121 = loop_cond_151063;
                                p_151122 = (int64_t) 0;
                                while (loop_while_151121) {
                                    int64_t start_151125 = mul64(extParallelism_126100, p_151122);
                                    int64_t min_arg1_151126 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, start_151125);
                                    int64_t min_res_151127 = smin64(extParallelism_126100, min_arg1_151126);
                                    int64_t iter_R_151128 = add64(start_151125, min_res_151127);
                                    bool empty_slice_151129 = min_res_151127 == (int64_t) 0;
                                    int64_t m_151130 = sub64(min_res_151127, (int64_t) 1);
                                    int64_t i_p_m_t_s_151131 = add64(start_151125, m_151130);
                                    bool zzero_leq_i_p_m_t_s_151132 = sle64((int64_t) 0, i_p_m_t_s_151131);
                                    bool i_p_m_t_s_leq_w_151133 = slt64(i_p_m_t_s_151131, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                                    bool zzero_lte_i_151134 = sle64((int64_t) 0, start_151125);
                                    bool i_lte_j_151135 = sle64(start_151125, iter_R_151128);
                                    bool y_151136 = i_p_m_t_s_leq_w_151133 && zzero_lte_i_151134;
                                    bool y_151137 = zzero_leq_i_p_m_t_s_151132 && y_151136;
                                    bool forwards_ok_151138 = i_lte_j_151135 && y_151137;
                                    bool ok_or_empty_151139 = empty_slice_151129 || forwards_ok_151138;
                                    bool index_certs_151140;
                                    
                                    if (!ok_or_empty_151139) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_151125, ":", (long long) iter_R_151128, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151147 = slt64(m_151130, min_res_151127);
                                    bool x_151146 = sle64((int64_t) 0, m_151130);
                                    bool bounds_check_151148 = x_151146 && y_151147;
                                    bool index_certs_151149;
                                    
                                    if (!bounds_check_151148) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151130, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151143 = slt64((int64_t) 0, min_res_151127);
                                    bool index_certs_151144;
                                    
                                    if (!y_151143) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:184:133-136\n   #2  ftRelational.fut:173:1-184:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_151141 = loopres_f_res_f_res_151022 + start_151125;
                                    int64_t slice_151150 = loopres_f_res_f_res_151022 + i_p_m_t_s_151131;
                                    int64_t r_max_151151 = ((int64_t *) tR_mem_164928.mem)[slice_151150];
                                    int64_t s_max_151153;
                                    
                                    if (cond_151104) {
                                        s_max_151153 = s_max_t_res_151115;
                                    } else {
                                        s_max_151153 = r_max_151151;
                                    }
                                    
                                    int64_t r_min_151145 = ((int64_t *) tR_mem_164928.mem)[slice_151141];
                                    bool defunc_0_gt_res_151154 = slt64(s_max_151153, r_min_151145);
                                    int64_t s_min_151152;
                                    
                                    if (cond_151104) {
                                        s_min_151152 = s_min_t_res_151109;
                                    } else {
                                        s_min_151152 = r_min_151145;
                                    }
                                    
                                    bool defunc_0_gt_res_151158 = slt64(r_max_151151, s_min_151152);
                                    int64_t ext_165050;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165050 = ctx_param_ext_165016;
                                    } else {
                                        ext_165050 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165049;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165049 = ctx_param_ext_165017;
                                    } else {
                                        ext_165049 = (int64_t) 1;
                                    }
                                    
                                    int64_t ext_165047;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165047 = ctx_param_ext_165019;
                                    } else {
                                        ext_165047 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165046;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165046 = ctx_param_ext_165020;
                                    } else {
                                        ext_165046 = (int64_t) 1;
                                    }
                                    
                                    int64_t bytes_165026 = (int64_t) 8 * min_res_151127;
                                    int64_t ext_165056;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165056 = ctx_param_ext_165016;
                                    } else {
                                        ext_165056 = ext_165050;
                                    }
                                    
                                    int64_t ext_165055;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165055 = ctx_param_ext_165017;
                                    } else {
                                        ext_165055 = ext_165049;
                                    }
                                    
                                    int64_t ext_165053;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165053 = ctx_param_ext_165019;
                                    } else {
                                        ext_165053 = ext_165047;
                                    }
                                    
                                    int64_t ext_165052;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165052 = ctx_param_ext_165020;
                                    } else {
                                        ext_165052 = ext_165046;
                                    }
                                    
                                    int64_t loopres_151155;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        if (memblock_set(ctx, &ext_mem_165057, &mem_param_165018, "mem_param_165018") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &mem_param_165021, "mem_param_165021") != 0)
                                            return 1;
                                        loopres_151155 = numIter_151062;
                                    } else {
                                        int64_t loopres_f_res_151159;
                                        
                                        if (defunc_0_gt_res_151158) {
                                            int64_t tmp_157789 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_param_165018, "mem_param_165018") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_param_165021, "mem_param_165021") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_157789;
                                        } else {
                                            if (memblock_alloc(ctx, &mem_165023, bytes_165022, "mem_165023")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) tS_mem_164929.mem, slice_151498, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151089});
                                            if (futrts_indicesWithIncrement_12184(ctx, &ext_mem_165025, mem_165023, j_m_i_151089, find_joinTuples_arg3_151103) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
                                                return 1;
                                            if (mem_165027_cached_sizze_166094 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165027, &mem_165027_cached_sizze_166094, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            if (mem_165029_cached_sizze_166095 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166095, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            for (int64_t i_164744 = 0; i_164744 < min_res_151127; i_164744++) {
                                                int64_t slice_164903 = slice_151141 + i_164744;
                                                int64_t eta_p_151167 = ((int64_t *) tR_mem_164928.mem)[slice_164903];
                                                int64_t defunc_0_reduce_comm_res_157790;
                                                int64_t defunc_0_reduce_comm_res_157791;
                                                int64_t defunc_0_reduce_comm_res_157792;
                                                int64_t redout_164736;
                                                int64_t redout_164737;
                                                int64_t redout_164738;
                                                
                                                redout_164736 = (int64_t) -1;
                                                redout_164737 = eta_p_151167;
                                                redout_164738 = (int64_t) 0;
                                                for (int64_t i_164739 = 0; i_164739 < j_m_i_151089; i_164739++) {
                                                    int64_t x_151171 = ((int64_t *) ext_mem_165025.mem)[i_164739];
                                                    int64_t slice_164902 = slice_151498 + i_164739;
                                                    int64_t x_151172 = ((int64_t *) tS_mem_164929.mem)[slice_164902];
                                                    bool defunc_0_neq_res_151180 = redout_164737 == eta_p_151167;
                                                    bool defunc_0_neq_res_151181 = !defunc_0_neq_res_151180;
                                                    bool cond_f_res_151182 = slt64(redout_164736, (int64_t) 0);
                                                    bool y_151183 = defunc_0_neq_res_151180 && cond_f_res_151182;
                                                    bool cond_151184 = defunc_0_neq_res_151181 || y_151183;
                                                    bool defunc_0_neq_res_151185 = x_151172 == eta_p_151167;
                                                    bool defunc_0_neq_res_151186 = !defunc_0_neq_res_151185;
                                                    bool cond_t_res_f_res_151187 = slt64(x_151171, (int64_t) 0);
                                                    bool y_151188 = defunc_0_neq_res_151185 && cond_t_res_f_res_151187;
                                                    bool cond_t_res_151189 = defunc_0_neq_res_151186 || y_151188;
                                                    bool x_151190 = cond_151184 && cond_t_res_151189;
                                                    int64_t defunc_0_op_res_151191;
                                                    int64_t defunc_0_op_res_151192;
                                                    int64_t defunc_0_op_res_151193;
                                                    
                                                    if (x_151190) {
                                                        defunc_0_op_res_151191 = (int64_t) -1;
                                                        defunc_0_op_res_151192 = eta_p_151167;
                                                        defunc_0_op_res_151193 = (int64_t) 0;
                                                    } else {
                                                        int64_t defunc_0_op_res_f_res_151194;
                                                        int64_t defunc_0_op_res_f_res_151195;
                                                        int64_t defunc_0_op_res_f_res_151196;
                                                        
                                                        if (cond_151184) {
                                                            defunc_0_op_res_f_res_151194 = x_151171;
                                                            defunc_0_op_res_f_res_151195 = x_151172;
                                                            defunc_0_op_res_f_res_151196 = (int64_t) 1;
                                                        } else {
                                                            int64_t defunc_0_op_res_f_res_f_res_151197;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151197 = redout_164737;
                                                            } else {
                                                                defunc_0_op_res_f_res_f_res_151197 = eta_p_151167;
                                                            }
                                                            
                                                            int64_t defunc_0_op_res_f_res_f_res_151198;
                                                            int64_t defunc_0_op_res_f_res_f_res_151199;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151198 = redout_164736;
                                                                defunc_0_op_res_f_res_f_res_151199 = redout_164738;
                                                            } else {
                                                                int64_t min_res_151200 = smin64(x_151171, redout_164736);
                                                                int64_t tmp_151201 = add64((int64_t) 1, redout_164738);
                                                                
                                                                defunc_0_op_res_f_res_f_res_151198 = min_res_151200;
                                                                defunc_0_op_res_f_res_f_res_151199 = tmp_151201;
                                                            }
                                                            defunc_0_op_res_f_res_151194 = defunc_0_op_res_f_res_f_res_151198;
                                                            defunc_0_op_res_f_res_151195 = defunc_0_op_res_f_res_f_res_151197;
                                                            defunc_0_op_res_f_res_151196 = defunc_0_op_res_f_res_f_res_151199;
                                                        }
                                                        defunc_0_op_res_151191 = defunc_0_op_res_f_res_151194;
                                                        defunc_0_op_res_151192 = defunc_0_op_res_f_res_151195;
                                                        defunc_0_op_res_151193 = defunc_0_op_res_f_res_151196;
                                                    }
                                                    
                                                    int64_t redout_tmp_165779 = defunc_0_op_res_151191;
                                                    int64_t redout_tmp_165780 = defunc_0_op_res_151192;
                                                    int64_t redout_tmp_165781 = defunc_0_op_res_151193;
                                                    
                                                    redout_164736 = redout_tmp_165779;
                                                    redout_164737 = redout_tmp_165780;
                                                    redout_164738 = redout_tmp_165781;
                                                }
                                                defunc_0_reduce_comm_res_157790 = redout_164736;
                                                defunc_0_reduce_comm_res_157791 = redout_164737;
                                                defunc_0_reduce_comm_res_157792 = redout_164738;
                                                ((int64_t *) mem_165027)[i_164744] = defunc_0_reduce_comm_res_157790;
                                                ((int64_t *) mem_165029)[i_164744] = defunc_0_reduce_comm_res_157792;
                                            }
                                            if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
                                                return 1;
                                            if (memblock_alloc(ctx, &mem_165043, bytes_165006, "mem_165043")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165021.mem, ctx_param_ext_165019, (int64_t []) {ctx_param_ext_165020}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165027, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            if (memblock_alloc(ctx, &mem_165045, bytes_165006, "mem_165045")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165018.mem, ctx_param_ext_165016, (int64_t []) {ctx_param_ext_165017}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165029, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            
                                            int64_t tmp_151206 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_165045, "mem_165045") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_165043, "mem_165043") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_151206;
                                        }
                                        if (memblock_set(ctx, &ext_mem_165057, &ext_mem_165051, "ext_mem_165051") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &ext_mem_165048, "ext_mem_165048") != 0)
                                            return 1;
                                        loopres_151155 = loopres_f_res_151159;
                                    }
                                    
                                    bool loop_cond_151207 = slt64(loopres_151155, numIter_151062);
                                    
                                    if (memblock_set(ctx, &mem_param_tmp_165767, &ext_mem_165057, "ext_mem_165057") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_tmp_165768, &ext_mem_165054, "ext_mem_165054") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_165769 = ext_165056;
                                    int64_t ctx_param_ext_tmp_165770 = ext_165055;
                                    int64_t ctx_param_ext_tmp_165771 = ext_165053;
                                    int64_t ctx_param_ext_tmp_165772 = ext_165052;
                                    bool loop_while_tmp_165773 = loop_cond_151207;
                                    int64_t p_tmp_165774 = loopres_151155;
                                    
                                    if (memblock_set(ctx, &mem_param_165018, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_165021, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
                                        return 1;
                                    ctx_param_ext_165016 = ctx_param_ext_tmp_165769;
                                    ctx_param_ext_165017 = ctx_param_ext_tmp_165770;
                                    ctx_param_ext_165019 = ctx_param_ext_tmp_165771;
                                    ctx_param_ext_165020 = ctx_param_ext_tmp_165772;
                                    loop_while_151121 = loop_while_tmp_165773;
                                    p_151122 = p_tmp_165774;
                                }
                                if (memblock_set(ctx, &ext_mem_165063, &mem_param_165018, "mem_param_165018") != 0)
                                    return 1;
                                if (memblock_set(ctx, &ext_mem_165062, &mem_param_165021, "mem_param_165021") != 0)
                                    return 1;
                                ext_165061 = ctx_param_ext_165016;
                                ext_165060 = ctx_param_ext_165017;
                                ext_165059 = ctx_param_ext_165019;
                                ext_165058 = ctx_param_ext_165020;
                                defunc_0_find_joinTuples_res_151117 = loop_while_151121;
                                defunc_0_find_joinTuples_res_151118 = p_151122;
                                if (memblock_alloc(ctx, &mem_165065, bytes_165006, "mem_165065")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164749 = 0; i_164749 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164749++) {
                                    int64_t eta_p_151209 = ((int64_t *) mem_param_165015.mem)[i_164749];
                                    int64_t eta_p_151210 = ((int64_t *) ext_mem_165062.mem)[ext_165059 + i_164749 * ext_165058];
                                    bool cond_151211 = slt64(eta_p_151209, (int64_t) 0);
                                    int64_t lifted_lambda_res_151212;
                                    
                                    if (cond_151211) {
                                        lifted_lambda_res_151212 = eta_p_151210;
                                    } else {
                                        lifted_lambda_res_151212 = eta_p_151209;
                                    }
                                    ((int64_t *) mem_165065.mem)[i_164749] = lifted_lambda_res_151212;
                                }
                                if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
                                    return 1;
                                if (memblock_alloc(ctx, &mem_165073, bytes_165006, "mem_165073")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164753 = 0; i_164753 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164753++) {
                                    int64_t eta_p_151214 = ((int64_t *) mem_param_165012.mem)[i_164753];
                                    int64_t eta_p_151215 = ((int64_t *) ext_mem_165063.mem)[ext_165061 + i_164753 * ext_165060];
                                    int64_t defunc_0_f_res_151216 = add64(eta_p_151214, eta_p_151215);
                                    
                                    ((int64_t *) mem_165073.mem)[i_164753] = defunc_0_f_res_151216;
                                }
                                if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
                                    return 1;
                                
                                bool loop_cond_151217 = sle64(zeze_lhs_151078, min_res_151013);
                                
                                if (memblock_set(ctx, &mem_param_tmp_165761, &mem_165073, "mem_165073") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_tmp_165762, &mem_165065, "mem_165065") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_165763 = loop_cond_151217;
                                int64_t dp_tmp_165764 = zeze_lhs_151078;
                                
                                if (memblock_set(ctx, &mem_param_165012, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165015, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
                                    return 1;
                                loop_while_151069 = loop_while_tmp_165763;
                                dp_151070 = dp_tmp_165764;
                            }
                            if (memblock_set(ctx, &ext_mem_165085, &mem_param_165012, "mem_param_165012") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165084, &mem_param_165015, "mem_param_165015") != 0)
                                return 1;
                            loopres_f_res_f_res_151065 = loop_while_151069;
                            loopres_f_res_f_res_151066 = dp_151070;
                            if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
                                return 1;
                            if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (mem_165087_cached_sizze_166096 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165087, &mem_165087_cached_sizze_166096, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164757 = 0; i_164757 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164757++) {
                                int64_t slice_164901 = loopres_f_res_f_res_151022 + i_164757;
                                int64_t eta_p_151220 = ((int64_t *) mem_param_165005.mem)[ctx_param_ext_165003 + slice_164901 * ctx_param_ext_165004];
                                int64_t eta_p_151221 = ((int64_t *) ext_mem_165084.mem)[i_164757];
                                bool cond_151222 = slt64(eta_p_151220, (int64_t) 0);
                                int64_t lifted_lambda_res_151223;
                                
                                if (cond_151222) {
                                    lifted_lambda_res_151223 = eta_p_151221;
                                } else {
                                    lifted_lambda_res_151223 = eta_p_151220;
                                }
                                ((int64_t *) mem_165087)[i_164757] = lifted_lambda_res_151223;
                            }
                            if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
                                return 1;
                            if (mem_165095_cached_sizze_166097 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165095, &mem_165095_cached_sizze_166097, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164761 = 0; i_164761 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164761++) {
                                int64_t slice_164900 = loopres_f_res_f_res_151022 + i_164761;
                                int64_t eta_p_151226 = ((int64_t *) mem_param_165002.mem)[ctx_param_ext_165000 + slice_164900 * ctx_param_ext_165001];
                                int64_t eta_p_151227 = ((int64_t *) ext_mem_165085.mem)[i_164761];
                                int64_t defunc_0_f_res_151228 = add64(eta_p_151226, eta_p_151227);
                                
                                ((int64_t *) mem_165095)[i_164761] = defunc_0_f_res_151228;
                            }
                            if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165103, bytes_164931, "mem_165103")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165005.mem, ctx_param_ext_165003, (int64_t []) {ctx_param_ext_165004}, (int64_t []) {nR_126092});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165087, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_alloc(ctx, &mem_165105, bytes_164931, "mem_165105")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165002.mem, ctx_param_ext_165000, (int64_t []) {ctx_param_ext_165001}, (int64_t []) {nR_126092});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165095, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_set(ctx, &ext_mem_165111, &mem_165105, "mem_165105") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_165103, "mem_165103") != 0)
                                return 1;
                        }
                        if (memblock_set(ctx, &ext_mem_165117, &ext_mem_165111, "ext_mem_165111") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &ext_mem_165108, "ext_mem_165108") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_151233 = slt64(loopres_151015, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165749, &ext_mem_165117, "ext_mem_165117") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165750, &ext_mem_165114, "ext_mem_165114") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165751 = ext_165116;
                    int64_t ctx_param_ext_tmp_165752 = ext_165115;
                    int64_t ctx_param_ext_tmp_165753 = ext_165113;
                    int64_t ctx_param_ext_tmp_165754 = ext_165112;
                    bool loop_while_tmp_165755 = loop_cond_151233;
                    int64_t p_tmp_165756 = loopres_151015;
                    
                    if (memblock_set(ctx, &mem_param_165002, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165005, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
                        return 1;
                    ctx_param_ext_165000 = ctx_param_ext_tmp_165751;
                    ctx_param_ext_165001 = ctx_param_ext_tmp_165752;
                    ctx_param_ext_165003 = ctx_param_ext_tmp_165753;
                    ctx_param_ext_165004 = ctx_param_ext_tmp_165754;
                    loop_while_151003 = loop_while_tmp_165755;
                    p_151004 = p_tmp_165756;
                }
                if (memblock_set(ctx, &ext_mem_165123, &mem_param_165002, "mem_param_165002") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165122, &mem_param_165005, "mem_param_165005") != 0)
                    return 1;
                ext_165121 = ctx_param_ext_165000;
                ext_165120 = ctx_param_ext_165001;
                ext_165119 = ctx_param_ext_165003;
                ext_165118 = ctx_param_ext_165004;
                defunc_0_join_chunks_res_150999 = loop_while_151003;
                defunc_0_join_chunks_res_151000 = p_151004;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165123, "ext_mem_165123") != 0)
                    return 1;
                ext_165176 = ext_165121;
                ext_165175 = ext_165120;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165122, "ext_mem_165122") != 0)
                    return 1;
                ext_165173 = ext_165119;
                ext_165172 = ext_165118;
            }
            if (memblock_alloc(ctx, &mem_165179, bytes_164931, "mem_165179")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164765 = 0; i_164765 < nR_126092; i_164765++) {
                int64_t eta_p_151235 = ((int64_t *) mem_param_164940.mem)[i_164765];
                int64_t eta_p_151236 = ((int64_t *) ext_mem_165174.mem)[ext_165173 + i_164765 * ext_165172];
                bool cond_151237 = slt64(eta_p_151235, (int64_t) 0);
                int64_t lifted_lambda_res_151238;
                
                if (cond_151237) {
                    lifted_lambda_res_151238 = eta_p_151236;
                } else {
                    lifted_lambda_res_151238 = eta_p_151235;
                }
                ((int64_t *) mem_165179.mem)[i_164765] = lifted_lambda_res_151238;
            }
            if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165187, bytes_164931, "mem_165187")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < nR_126092; i_164769++) {
                int64_t eta_p_151240 = ((int64_t *) mem_param_164937.mem)[i_164769];
                int64_t eta_p_151241 = ((int64_t *) ext_mem_165177.mem)[ext_165176 + i_164769 * ext_165175];
                int64_t defunc_0_f_res_151242 = add64(eta_p_151240, eta_p_151241);
                
                ((int64_t *) mem_165187.mem)[i_164769] = defunc_0_f_res_151242;
            }
            if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
                return 1;
            
            int64_t leq_lhs_151247 = ((int64_t *) tS_mem_164929.mem)[i_p_m_t_s_150433];
            int64_t leq_rhs_151249 = ((int64_t *) tR_mem_164928.mem)[gt_rhs_150410];
            bool defunc_0_leq_res_151250 = sle64(leq_lhs_151247, leq_rhs_151249);
            int64_t nextIter_151251;
            
            if (defunc_0_leq_res_151250) {
                int64_t nextIter_t_res_157804 = add64((int64_t) 1, p_150424);
                
                nextIter_151251 = nextIter_t_res_157804;
            } else {
                nextIter_151251 = numIter_150404;
            }
            if (memblock_set(ctx, &ext_mem_165199, &mem_165187, "mem_165187") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_165179, "mem_165179") != 0)
                return 1;
            loopres_150448 = nextIter_151251;
        }
        
        bool loop_cond_151253 = slt64(loopres_150448, numIter_150404);
        
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        
        bool loop_while_tmp_165701 = loop_cond_151253;
        int64_t p_tmp_165702 = loopres_150448;
        
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        loop_while_150423 = loop_while_tmp_165701;
        p_150424 = p_tmp_165702;
    }
    if (memblock_set(ctx, &ext_mem_165205, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165204, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    defunc_0_mergeJoin_res_150419 = loop_while_150423;
    defunc_0_mergeJoin_res_150420 = p_150424;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
        return 1;
    if (mem_165207_cached_sizze_166100 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165207, &mem_165207_cached_sizze_166100, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165209_cached_sizze_166101 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165209, &mem_165209_cached_sizze_166101, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164779;
    int64_t scanacc_164773 = (int64_t) 0;
    
    for (int64_t i_164776 = 0; i_164776 < nR_126092; i_164776++) {
        int64_t eta_p_157038 = ((int64_t *) ext_mem_165205.mem)[i_164776];
        bool lifted_lambda_res_157039 = slt64((int64_t) 0, eta_p_157038);
        int64_t defunc_0_f_res_157040 = btoi_bool_i64(lifted_lambda_res_157039);
        int64_t defunc_0_op_res_151262 = add64(defunc_0_f_res_157040, scanacc_164773);
        
        ((int64_t *) mem_165207)[i_164776] = defunc_0_op_res_151262;
        ((int64_t *) mem_165209)[i_164776] = defunc_0_f_res_157040;
        
        int64_t scanacc_tmp_165788 = defunc_0_op_res_151262;
        
        scanacc_164773 = scanacc_tmp_165788;
    }
    discard_164779 = scanacc_164773;
    
    bool protect_assert_disj_151269 = zzero_150401 || bounds_check_150413;
    bool index_certs_151270;
    
    if (!protect_assert_disj_151269) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151271;
    
    if (nonzzero_150402) {
        int64_t x_157807 = ((int64_t *) mem_165207)[gt_rhs_150410];
        
        m_f_res_151271 = x_157807;
    } else {
        m_f_res_151271 = (int64_t) 0;
    }
    
    int64_t m_151273;
    
    if (zzero_150401) {
        m_151273 = (int64_t) 0;
    } else {
        m_151273 = m_f_res_151271;
    }
    
    int64_t m_151283 = sub64(m_151273, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151285 = slt64(m_151283, nR_126092);
    bool zzero_leq_i_p_m_t_s_151284 = sle64((int64_t) 0, m_151283);
    bool y_151287 = zzero_leq_i_p_m_t_s_151284 && i_p_m_t_s_leq_w_151285;
    bool i_lte_j_151286 = sle64((int64_t) 0, m_151273);
    bool forwards_ok_151288 = i_lte_j_151286 && y_151287;
    bool eq_x_zz_151280 = (int64_t) 0 == m_f_res_151271;
    bool p_and_eq_x_y_151281 = nonzzero_150402 && eq_x_zz_151280;
    bool empty_slice_151282 = zzero_150401 || p_and_eq_x_y_151281;
    bool ok_or_empty_151289 = empty_slice_151282 || forwards_ok_151288;
    bool index_certs_151290;
    
    if (!ok_or_empty_151289) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151273, "] out of bounds for array of shape [", (long long) nR_126092, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165222 = (int64_t) 8 * m_151273;
    
    if (mem_165223_cached_sizze_166102 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165223, &mem_165223_cached_sizze_166102, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165225_cached_sizze_166103 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165225, &mem_165225_cached_sizze_166103, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165225, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165204.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165227_cached_sizze_166104 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165227, &mem_165227_cached_sizze_166104, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165227, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164930.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165229_cached_sizze_166105 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165229, &mem_165229_cached_sizze_166105, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) tR_mem_164928.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    for (int64_t write_iter_164780 = 0; write_iter_164780 < nR_126092; write_iter_164780++) {
        int64_t write_iv_164785 = ((int64_t *) mem_165209)[write_iter_164780];
        int64_t write_iv_164786 = ((int64_t *) mem_165207)[write_iter_164780];
        int64_t write_iv_164787 = ((int64_t *) tR_mem_164928.mem)[write_iter_164780];
        int64_t write_iv_164788 = ((int64_t *) ext_mem_164930.mem)[write_iter_164780];
        int64_t write_iv_164789 = ((int64_t *) ext_mem_165204.mem)[write_iter_164780];
        int64_t write_iv_164790 = ((int64_t *) ext_mem_165205.mem)[write_iter_164780];
        bool cond_157033 = write_iv_164785 == (int64_t) 1;
        int64_t lifted_lambda_res_157034;
        
        if (cond_157033) {
            int64_t lifted_lambda_res_t_res_157808 = sub64(write_iv_164786, (int64_t) 1);
            
            lifted_lambda_res_157034 = lifted_lambda_res_t_res_157808;
        } else {
            lifted_lambda_res_157034 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165229)[lifted_lambda_res_157034] = write_iv_164787;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165227)[lifted_lambda_res_157034] = write_iv_164788;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165225)[lifted_lambda_res_157034] = write_iv_164789;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165223)[lifted_lambda_res_157034] = write_iv_164790;
        }
    }
    if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
        return 1;
    if (mem_165255_cached_sizze_166106 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165255, &mem_165255_cached_sizze_166106, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165257_cached_sizze_166107 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165257, &mem_165257_cached_sizze_166107, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165259_cached_sizze_166108 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165259, &mem_165259_cached_sizze_166108, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164807;
    int64_t discard_164808;
    int64_t scanacc_164798;
    int64_t scanacc_164799;
    
    scanacc_164798 = (int64_t) 0;
    scanacc_164799 = (int64_t) 0;
    for (int64_t i_164803 = 0; i_164803 < m_151273; i_164803++) {
        int64_t x_157043 = ((int64_t *) mem_165223)[i_164803];
        bool lifted_lambda_res_157045 = slt64((int64_t) 1, x_157043);
        int64_t defunc_0_f_res_157046 = btoi_bool_i64(lifted_lambda_res_157045);
        int64_t lifted_lambda_res_151312 = add64(x_157043, scanacc_164798);
        int64_t defunc_0_op_res_151405 = add64(defunc_0_f_res_157046, scanacc_164799);
        
        ((int64_t *) mem_165255)[i_164803] = lifted_lambda_res_151312;
        ((int64_t *) mem_165257)[i_164803] = defunc_0_op_res_151405;
        ((int64_t *) mem_165259)[i_164803] = defunc_0_f_res_157046;
        
        int64_t scanacc_tmp_165795 = lifted_lambda_res_151312;
        int64_t scanacc_tmp_165796 = defunc_0_op_res_151405;
        
        scanacc_164798 = scanacc_tmp_165795;
        scanacc_164799 = scanacc_tmp_165796;
    }
    discard_164807 = scanacc_164798;
    discard_164808 = scanacc_164799;
    if (mem_165279_cached_sizze_166109 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165279, &mem_165279_cached_sizze_166109, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164811 = 0; i_164811 < m_151273; i_164811++) {
        int64_t zv_lhs_157020 = add64((int64_t) -1, i_164811);
        int64_t tmp_157021 = smod64(zv_lhs_157020, m_151273);
        int64_t lifted_lambda_res_157022 = ((int64_t *) mem_165255)[tmp_157021];
        bool cond_157024 = i_164811 == (int64_t) 0;
        int64_t lifted_lambda_res_157025;
        
        if (cond_157024) {
            lifted_lambda_res_157025 = (int64_t) 0;
        } else {
            lifted_lambda_res_157025 = lifted_lambda_res_157022;
        }
        ((int64_t *) mem_165279)[i_164811] = lifted_lambda_res_157025;
    }
    
    bool cond_151324 = slt64((int64_t) 0, m_151273);
    bool y_151325 = slt64(m_151283, m_151273);
    bool bounds_check_151326 = zzero_leq_i_p_m_t_s_151284 && y_151325;
    bool loop_not_taken_151327 = !cond_151324;
    bool protect_assert_disj_151328 = bounds_check_151326 || loop_not_taken_151327;
    bool index_certs_151329;
    
    if (!protect_assert_disj_151328) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  ftSMJ.fut:432:10-41\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:184:133-136\n   #3  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_lhs_151330;
    
    if (cond_151324) {
        int64_t x_157809 = ((int64_t *) mem_165279)[m_151283];
        
        zp_lhs_151330 = x_157809;
    } else {
        zp_lhs_151330 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151332;
    
    if (cond_151324) {
        int64_t x_157810 = ((int64_t *) mem_165223)[m_151283];
        
        n_pairs_t_res_151332 = x_157810;
    } else {
        n_pairs_t_res_151332 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151334 = add64(zp_lhs_151330, n_pairs_t_res_151332);
    int64_t n_pairs_151335;
    
    if (cond_151324) {
        n_pairs_151335 = n_pairs_t_res_151334;
    } else {
        n_pairs_151335 = (int64_t) 0;
    }
    
    int64_t bytes_165286 = (int64_t) 8 * n_pairs_151335;
    bool zzero_151341 = scatter_psizze_126101 == (int64_t) 0;
    bool nonzzero_151342 = !zzero_151341;
    bool nonzzero_cert_151343;
    
    if (!nonzzero_151342) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:184:133-136\n   #3  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_151408 = !empty_slice_151282;
    bool protect_assert_disj_151409 = empty_slice_151282 || bounds_check_151326;
    bool index_certs_151410;
    
    if (!protect_assert_disj_151409) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151411;
    
    if (x_151408) {
        int64_t x_157815 = ((int64_t *) mem_165257)[m_151283];
        
        m_f_res_151411 = x_157815;
    } else {
        m_f_res_151411 = (int64_t) 0;
    }
    
    int64_t m_151413;
    
    if (empty_slice_151282) {
        m_151413 = (int64_t) 0;
    } else {
        m_151413 = m_f_res_151411;
    }
    
    int64_t m_151423 = sub64(m_151413, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151425 = slt64(m_151423, m_151273);
    bool zzero_leq_i_p_m_t_s_151424 = sle64((int64_t) 0, m_151423);
    bool y_151427 = zzero_leq_i_p_m_t_s_151424 && i_p_m_t_s_leq_w_151425;
    bool i_lte_j_151426 = sle64((int64_t) 0, m_151413);
    bool forwards_ok_151428 = i_lte_j_151426 && y_151427;
    bool eq_x_zz_151420 = (int64_t) 0 == m_f_res_151411;
    bool p_and_eq_x_y_151421 = x_151408 && eq_x_zz_151420;
    bool empty_slice_151422 = empty_slice_151282 || p_and_eq_x_y_151421;
    bool ok_or_empty_151429 = empty_slice_151422 || forwards_ok_151428;
    bool index_certs_151430;
    
    if (!ok_or_empty_151429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151413, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:184:133-136\n   #4  ftRelational.fut:173:1-184:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165334 = (int64_t) 8 * m_151413;
    
    if (memblock_alloc(ctx, &mem_165287, bytes_165286, "mem_165287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165801 = 0; nest_i_165801 < n_pairs_151335; nest_i_165801++) {
        ((int64_t *) mem_165287.mem)[nest_i_165801] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_165289, bytes_165286, "mem_165289")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165802 = 0; nest_i_165802 < n_pairs_151335; nest_i_165802++) {
        ((int64_t *) mem_165289.mem)[nest_i_165802] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_165291, bytes_165286, "mem_165291")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165803 = 0; nest_i_165803 < n_pairs_151335; nest_i_165803++) {
        ((int64_t *) mem_165291.mem)[nest_i_165803] = (int64_t) -1;
    }
    
    int64_t zm_lhs_151339 = add64(scatter_psizze_126101, n_pairs_151335);
    int64_t zs_lhs_151340 = sub64(zm_lhs_151339, (int64_t) 1);
    int64_t m_151344 = sdiv64(zs_lhs_151340, scatter_psizze_126101);
    bool loop_cond_151345 = slt64((int64_t) 0, m_151344);
    bool partitioned_scatter_res_151346;
    int64_t partitioned_scatter_res_151350;
    bool loop_while_151351;
    int64_t p_151355;
    
    loop_while_151351 = loop_cond_151345;
    p_151355 = (int64_t) 0;
    while (loop_while_151351) {
        int64_t lower_bound_151356 = mul64(scatter_psizze_126101, p_151355);
        int64_t min_arg1_151357 = add64(scatter_psizze_126101, lower_bound_151356);
        int64_t min_res_151358 = smin64(n_pairs_151335, min_arg1_151357);
        int64_t j_m_i_151359 = sub64(min_res_151358, lower_bound_151356);
        bool empty_slice_151360 = j_m_i_151359 == (int64_t) 0;
        int64_t m_151361 = sub64(j_m_i_151359, (int64_t) 1);
        int64_t i_p_m_t_s_151362 = add64(lower_bound_151356, m_151361);
        bool zzero_leq_i_p_m_t_s_151363 = sle64((int64_t) 0, i_p_m_t_s_151362);
        bool i_p_m_t_s_leq_w_151364 = slt64(i_p_m_t_s_151362, n_pairs_151335);
        bool zzero_lte_i_151365 = sle64((int64_t) 0, lower_bound_151356);
        bool i_lte_j_151366 = sle64(lower_bound_151356, min_res_151358);
        bool y_151367 = i_p_m_t_s_leq_w_151364 && zzero_lte_i_151365;
        bool y_151368 = zzero_leq_i_p_m_t_s_151363 && y_151367;
        bool forwards_ok_151369 = i_lte_j_151366 && y_151368;
        bool ok_or_empty_151370 = empty_slice_151360 || forwards_ok_151369;
        bool index_certs_151371;
        
        if (!ok_or_empty_151370) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_151356, ":", (long long) min_res_151358, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:184:133-136\n   #3  ftRelational.fut:173:1-184:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165301 = (int64_t) 8 * j_m_i_151359;
        
        if (mem_165302_cached_sizze_166110 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165302, &mem_165302_cached_sizze_166110, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165287.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165304_cached_sizze_166111 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165304, &mem_165304_cached_sizze_166111, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165289.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165306_cached_sizze_166112 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165306, &mem_165306_cached_sizze_166112, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165291.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        for (int64_t write_iter_164813 = 0; write_iter_164813 < m_151273; write_iter_164813++) {
            int64_t write_iv_164817 = ((int64_t *) mem_165279)[write_iter_164813];
            int64_t write_iv_164818 = ((int64_t *) mem_165229)[write_iter_164813];
            int64_t write_iv_164819 = ((int64_t *) mem_165227)[write_iter_164813];
            int64_t write_iv_164820 = ((int64_t *) mem_165225)[write_iter_164813];
            bool cond_157424 = sle64(lower_bound_151356, write_iv_164817);
            bool cond_t_res_157425 = slt64(write_iv_164817, min_res_151358);
            bool x_157426 = cond_157424 && cond_t_res_157425;
            int64_t lifted_lambda_res_157427;
            
            if (x_157426) {
                int64_t lifted_lambda_res_t_res_157811 = sub64(write_iv_164817, lower_bound_151356);
                
                lifted_lambda_res_157427 = lifted_lambda_res_t_res_157811;
            } else {
                lifted_lambda_res_157427 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165302)[lifted_lambda_res_157427] = write_iv_164818;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165304)[lifted_lambda_res_157427] = write_iv_164819;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165306)[lifted_lambda_res_157427] = write_iv_164820;
            }
        }
        
        int64_t tmp_151385 = add64((int64_t) 1, p_151355);
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165287.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165289.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165291.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        
        bool loop_cond_151396 = slt64(tmp_151385, m_151344);
        bool loop_while_tmp_165804 = loop_cond_151396;
        int64_t p_tmp_165808 = tmp_151385;
        
        loop_while_151351 = loop_while_tmp_165804;
        p_151355 = p_tmp_165808;
    }
    partitioned_scatter_res_151346 = loop_while_151351;
    partitioned_scatter_res_151350 = p_151355;
    if (mem_165335_cached_sizze_166113 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165335, &mem_165335_cached_sizze_166113, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165335, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    if (mem_165337_cached_sizze_166114 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165337, &mem_165337_cached_sizze_166114, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165337, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165279, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    for (int64_t write_iter_164824 = 0; write_iter_164824 < m_151273; write_iter_164824++) {
        int64_t write_iv_164827 = ((int64_t *) mem_165259)[write_iter_164824];
        int64_t write_iv_164828 = ((int64_t *) mem_165257)[write_iter_164824];
        int64_t write_iv_164829 = ((int64_t *) mem_165279)[write_iter_164824];
        int64_t write_iv_164830 = ((int64_t *) mem_165223)[write_iter_164824];
        bool cond_157008 = write_iv_164827 == (int64_t) 1;
        int64_t lifted_lambda_res_157009;
        
        if (cond_157008) {
            int64_t lifted_lambda_res_t_res_157816 = sub64(write_iv_164828, (int64_t) 1);
            
            lifted_lambda_res_157009 = lifted_lambda_res_t_res_157816;
        } else {
            lifted_lambda_res_157009 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165337)[lifted_lambda_res_157009] = write_iv_164829;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165335)[lifted_lambda_res_157009] = write_iv_164830;
        }
    }
    
    bool cond_151440 = slt64((int64_t) 0, m_151413);
    bool loop_cond_t_res_151441 = slt64(m_151273, n_pairs_151335);
    bool x_151442 = cond_151440 && loop_cond_t_res_151441;
    bool joinTups_to_joinPairs_InnerJoin_res_151443;
    int64_t joinTups_to_joinPairs_InnerJoin_res_151447;
    bool loop_while_151448;
    int64_t p_151452;
    
    if (memblock_set(ctx, &mem_param_165352, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165355, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165358, &mem_165291, "mem_165291") != 0)
        return 1;
    loop_while_151448 = x_151442;
    p_151452 = (int64_t) 0;
    while (loop_while_151448) {
        bool x_151453 = sle64((int64_t) 0, p_151452);
        bool y_151454 = slt64(p_151452, m_151413);
        bool bounds_check_151455 = x_151453 && y_151454;
        bool index_certs_151456;
        
        if (!bounds_check_151455) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151452, "] out of bounds for array of shape [", (long long) m_151413, "].", "-> #0  ftSMJ.fut:447:13-42\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:184:133-136\n   #3  ftRelational.fut:173:1-184:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_151457 = ((int64_t *) mem_165337)[p_151452];
        int64_t loopres_151458 = ((int64_t *) mem_165335)[p_151452];
        bool x_151459 = sle64((int64_t) 0, loopres_151457);
        bool y_151460 = slt64(loopres_151457, n_pairs_151335);
        bool bounds_check_151461 = x_151459 && y_151460;
        bool index_certs_151462;
        
        if (!bounds_check_151461) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:449:52-61\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:184:133-136\n   #3  ftRelational.fut:173:1-184:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165359 = (int64_t) 8 * loopres_151458;
        int64_t tmp_151473 = add64(loopres_151457, loopres_151458);
        bool empty_slice_151477 = loopres_151458 == (int64_t) 0;
        int64_t m_151478 = sub64(loopres_151458, (int64_t) 1);
        int64_t i_p_m_t_s_151479 = add64(loopres_151457, m_151478);
        bool zzero_leq_i_p_m_t_s_151480 = sle64((int64_t) 0, i_p_m_t_s_151479);
        bool i_p_m_t_s_leq_w_151481 = slt64(i_p_m_t_s_151479, n_pairs_151335);
        bool i_lte_j_151482 = sle64(loopres_151457, tmp_151473);
        bool y_151483 = x_151459 && i_p_m_t_s_leq_w_151481;
        bool y_151484 = zzero_leq_i_p_m_t_s_151480 && y_151483;
        bool forwards_ok_151485 = i_lte_j_151482 && y_151484;
        bool ok_or_empty_151486 = empty_slice_151477 || forwards_ok_151485;
        bool index_certs_151487;
        
        if (!ok_or_empty_151486) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, ":", (long long) tmp_151473, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:453:14-55\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:184:133-136\n   #3  ftRelational.fut:173:1-184:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_151463 = ((int64_t *) mem_param_165352.mem)[loopres_151457];
        int64_t loopres_151464 = ((int64_t *) mem_param_165355.mem)[loopres_151457];
        int64_t loopres_151465 = ((int64_t *) mem_param_165358.mem)[loopres_151457];
        
        if (mem_165360_cached_sizze_166115 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165360, &mem_165360_cached_sizze_166115, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165822 = 0; nest_i_165822 < loopres_151458; nest_i_165822++) {
            ((int64_t *) mem_165360)[nest_i_165822] = loopres_151463;
        }
        if (mem_165362_cached_sizze_166116 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165362, &mem_165362_cached_sizze_166116, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165823 = 0; nest_i_165823 < loopres_151458; nest_i_165823++) {
            ((int64_t *) mem_165362)[nest_i_165823] = loopres_151464;
        }
        if (mem_165364_cached_sizze_166117 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165364, &mem_165364_cached_sizze_166117, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164835 = 0; i_164835 < loopres_151458; i_164835++) {
            int64_t tmp_151471 = add64(loopres_151465, i_164835);
            
            ((int64_t *) mem_165364)[i_164835] = tmp_151471;
        }
        
        int64_t tmp_151472 = add64((int64_t) 1, p_151452);
        
        if (memblock_alloc(ctx, &mem_165372, bytes_165286, "mem_165372")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165372.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165374, bytes_165286, "mem_165374")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165376, bytes_165286, "mem_165376")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165372.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165360, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165364, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        
        bool cond_151491 = slt64(tmp_151472, m_151413);
        bool x_151492 = loop_cond_t_res_151441 && cond_151491;
        
        if (memblock_set(ctx, &mem_param_tmp_165814, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165815, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165816, &mem_165376, "mem_165376") != 0)
            return 1;
        
        bool loop_while_tmp_165817 = x_151492;
        int64_t p_tmp_165821 = tmp_151472;
        
        if (memblock_set(ctx, &mem_param_165352, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165355, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165358, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        loop_while_151448 = loop_while_tmp_165817;
        p_151452 = p_tmp_165821;
    }
    if (memblock_set(ctx, &ext_mem_165385, &mem_param_165352, "mem_param_165352") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165384, &mem_param_165355, "mem_param_165355") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165383, &mem_param_165358, "mem_param_165358") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_151443 = loop_while_151448;
    joinTups_to_joinPairs_InnerJoin_res_151447 = p_151452;
    if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165387, bytes_165286, "mem_165387")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165389, bytes_165286, "mem_165389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165384.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165391, bytes_165286, "mem_165391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165383.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165389, "mem_165389") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165391, "mem_165391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165695, &mem_165387, "mem_165387") != 0)
        return 1;
    prim_out_165696 = n_pairs_151335;
    if (memblock_set(ctx, &*mem_out_p_166086, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166087, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166088, &mem_out_165695, "mem_out_165695") != 0)
        return 1;
    *out_prim_out_166089 = prim_out_165696;
    
  cleanup:
    {
        free(mem_164942);
        free(mem_164944);
        free(mem_164985);
        free(mem_164987);
        free(mem_165027);
        free(mem_165029);
        free(mem_165087);
        free(mem_165095);
        free(mem_165135);
        free(mem_165137);
        free(mem_165207);
        free(mem_165209);
        free(mem_165223);
        free(mem_165225);
        free(mem_165227);
        free(mem_165229);
        free(mem_165255);
        free(mem_165257);
        free(mem_165259);
        free(mem_165279);
        free(mem_165302);
        free(mem_165304);
        free(mem_165306);
        free(mem_165335);
        free(mem_165337);
        free(mem_165360);
        free(mem_165362);
        free(mem_165364);
        if (memblock_unref(ctx, &mem_165391, "mem_165391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165389, "mem_165389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165387, "mem_165387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165376, "mem_165376") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165358, "mem_param_165358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165355, "mem_param_165355") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165352, "mem_param_165352") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165187, "mem_165187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165179, "mem_165179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165105, "mem_165105") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165103, "mem_165103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165073, "mem_165073") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165065, "mem_165065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165045, "mem_165045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165043, "mem_165043") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165048, "ext_mem_165048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165051, "ext_mem_165051") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165054, "ext_mem_165054") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165057, "ext_mem_165057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165021, "mem_param_165021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165018, "mem_param_165018") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165015, "mem_param_165015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165012, "mem_param_165012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165114, "ext_mem_165114") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165117, "ext_mem_165117") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165005, "mem_param_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165002, "mem_param_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165122, "ext_mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165123, "ext_mem_165123") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164969, "mem_164969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164971, "mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165153, "mem_165153") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165151, "mem_165151") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165156, "ext_mem_165156") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165159, "ext_mem_165159") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165162, "ext_mem_165162") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165165, "ext_mem_165165") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165129, "mem_param_165129") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165126, "mem_param_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165170, "ext_mem_165170") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165171, "ext_mem_165171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165695, "mem_out_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_166118, struct memblock *mem_out_p_166119, struct memblock *mem_out_p_166120, int64_t *out_prim_out_166121, struct memblock tR_mem_164928, struct memblock tS_mem_164929, int64_t nR_116230, int64_t nS_116231, int64_t offset_R_116234, int64_t offset_S_116235, int64_t partitionsPerWindow_116236, int64_t numberOfWindows_116237, int64_t extParallelism_116238, int64_t scatter_psizze_116239)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164942_cached_sizze_166122 = 0;
    unsigned char *mem_164942 = NULL;
    int64_t mem_164944_cached_sizze_166123 = 0;
    unsigned char *mem_164944 = NULL;
    int64_t mem_164985_cached_sizze_166124 = 0;
    unsigned char *mem_164985 = NULL;
    int64_t mem_164987_cached_sizze_166125 = 0;
    unsigned char *mem_164987 = NULL;
    int64_t mem_165027_cached_sizze_166126 = 0;
    unsigned char *mem_165027 = NULL;
    int64_t mem_165029_cached_sizze_166127 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165087_cached_sizze_166128 = 0;
    unsigned char *mem_165087 = NULL;
    int64_t mem_165095_cached_sizze_166129 = 0;
    unsigned char *mem_165095 = NULL;
    int64_t mem_165135_cached_sizze_166130 = 0;
    unsigned char *mem_165135 = NULL;
    int64_t mem_165137_cached_sizze_166131 = 0;
    unsigned char *mem_165137 = NULL;
    int64_t mem_165207_cached_sizze_166132 = 0;
    unsigned char *mem_165207 = NULL;
    int64_t mem_165209_cached_sizze_166133 = 0;
    unsigned char *mem_165209 = NULL;
    int64_t mem_165223_cached_sizze_166134 = 0;
    unsigned char *mem_165223 = NULL;
    int64_t mem_165225_cached_sizze_166135 = 0;
    unsigned char *mem_165225 = NULL;
    int64_t mem_165227_cached_sizze_166136 = 0;
    unsigned char *mem_165227 = NULL;
    int64_t mem_165229_cached_sizze_166137 = 0;
    unsigned char *mem_165229 = NULL;
    int64_t mem_165255_cached_sizze_166138 = 0;
    unsigned char *mem_165255 = NULL;
    int64_t mem_165257_cached_sizze_166139 = 0;
    unsigned char *mem_165257 = NULL;
    int64_t mem_165259_cached_sizze_166140 = 0;
    unsigned char *mem_165259 = NULL;
    int64_t mem_165279_cached_sizze_166141 = 0;
    unsigned char *mem_165279 = NULL;
    int64_t mem_165302_cached_sizze_166142 = 0;
    unsigned char *mem_165302 = NULL;
    int64_t mem_165304_cached_sizze_166143 = 0;
    unsigned char *mem_165304 = NULL;
    int64_t mem_165306_cached_sizze_166144 = 0;
    unsigned char *mem_165306 = NULL;
    int64_t mem_165335_cached_sizze_166145 = 0;
    unsigned char *mem_165335 = NULL;
    int64_t mem_165337_cached_sizze_166146 = 0;
    unsigned char *mem_165337 = NULL;
    int64_t mem_165360_cached_sizze_166147 = 0;
    unsigned char *mem_165360 = NULL;
    int64_t mem_165362_cached_sizze_166148 = 0;
    unsigned char *mem_165362 = NULL;
    int64_t mem_165364_cached_sizze_166149 = 0;
    unsigned char *mem_165364 = NULL;
    struct memblock mem_165391;
    
    mem_165391.references = NULL;
    
    struct memblock mem_165389;
    
    mem_165389.references = NULL;
    
    struct memblock mem_165387;
    
    mem_165387.references = NULL;
    
    struct memblock mem_param_tmp_165816;
    
    mem_param_tmp_165816.references = NULL;
    
    struct memblock mem_param_tmp_165815;
    
    mem_param_tmp_165815.references = NULL;
    
    struct memblock mem_param_tmp_165814;
    
    mem_param_tmp_165814.references = NULL;
    
    struct memblock mem_165376;
    
    mem_165376.references = NULL;
    
    struct memblock mem_165374;
    
    mem_165374.references = NULL;
    
    struct memblock mem_165372;
    
    mem_165372.references = NULL;
    
    struct memblock mem_param_165358;
    
    mem_param_165358.references = NULL;
    
    struct memblock mem_param_165355;
    
    mem_param_165355.references = NULL;
    
    struct memblock mem_param_165352;
    
    mem_param_165352.references = NULL;
    
    struct memblock ext_mem_165383;
    
    ext_mem_165383.references = NULL;
    
    struct memblock ext_mem_165384;
    
    ext_mem_165384.references = NULL;
    
    struct memblock ext_mem_165385;
    
    ext_mem_165385.references = NULL;
    
    struct memblock mem_165291;
    
    mem_165291.references = NULL;
    
    struct memblock mem_165289;
    
    mem_165289.references = NULL;
    
    struct memblock mem_165287;
    
    mem_165287.references = NULL;
    
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_165187;
    
    mem_165187.references = NULL;
    
    struct memblock mem_165179;
    
    mem_165179.references = NULL;
    
    struct memblock mem_param_tmp_165750;
    
    mem_param_tmp_165750.references = NULL;
    
    struct memblock mem_param_tmp_165749;
    
    mem_param_tmp_165749.references = NULL;
    
    struct memblock mem_165105;
    
    mem_165105.references = NULL;
    
    struct memblock mem_165103;
    
    mem_165103.references = NULL;
    
    struct memblock mem_param_tmp_165762;
    
    mem_param_tmp_165762.references = NULL;
    
    struct memblock mem_param_tmp_165761;
    
    mem_param_tmp_165761.references = NULL;
    
    struct memblock mem_165073;
    
    mem_165073.references = NULL;
    
    struct memblock mem_165065;
    
    mem_165065.references = NULL;
    
    struct memblock mem_param_tmp_165768;
    
    mem_param_tmp_165768.references = NULL;
    
    struct memblock mem_param_tmp_165767;
    
    mem_param_tmp_165767.references = NULL;
    
    struct memblock mem_165045;
    
    mem_165045.references = NULL;
    
    struct memblock mem_165043;
    
    mem_165043.references = NULL;
    
    struct memblock ext_mem_165025;
    
    ext_mem_165025.references = NULL;
    
    struct memblock mem_165023;
    
    mem_165023.references = NULL;
    
    struct memblock ext_mem_165048;
    
    ext_mem_165048.references = NULL;
    
    struct memblock ext_mem_165051;
    
    ext_mem_165051.references = NULL;
    
    struct memblock ext_mem_165054;
    
    ext_mem_165054.references = NULL;
    
    struct memblock ext_mem_165057;
    
    ext_mem_165057.references = NULL;
    
    struct memblock mem_param_165021;
    
    mem_param_165021.references = NULL;
    
    struct memblock mem_param_165018;
    
    mem_param_165018.references = NULL;
    
    struct memblock ext_mem_165062;
    
    ext_mem_165062.references = NULL;
    
    struct memblock ext_mem_165063;
    
    ext_mem_165063.references = NULL;
    
    struct memblock mem_param_165015;
    
    mem_param_165015.references = NULL;
    
    struct memblock mem_param_165012;
    
    mem_param_165012.references = NULL;
    
    struct memblock ext_mem_165084;
    
    ext_mem_165084.references = NULL;
    
    struct memblock ext_mem_165085;
    
    ext_mem_165085.references = NULL;
    
    struct memblock mem_165009;
    
    mem_165009.references = NULL;
    
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock ext_mem_165114;
    
    ext_mem_165114.references = NULL;
    
    struct memblock ext_mem_165117;
    
    ext_mem_165117.references = NULL;
    
    struct memblock mem_param_165005;
    
    mem_param_165005.references = NULL;
    
    struct memblock mem_param_165002;
    
    mem_param_165002.references = NULL;
    
    struct memblock ext_mem_165122;
    
    ext_mem_165122.references = NULL;
    
    struct memblock ext_mem_165123;
    
    ext_mem_165123.references = NULL;
    
    struct memblock mem_164969;
    
    mem_164969.references = NULL;
    
    struct memblock mem_164971;
    
    mem_164971.references = NULL;
    
    struct memblock ext_mem_164974;
    
    ext_mem_164974.references = NULL;
    
    struct memblock ext_mem_164977;
    
    ext_mem_164977.references = NULL;
    
    struct memblock mem_164954;
    
    mem_164954.references = NULL;
    
    struct memblock mem_164952;
    
    mem_164952.references = NULL;
    
    struct memblock mem_param_tmp_165706;
    
    mem_param_tmp_165706.references = NULL;
    
    struct memblock mem_param_tmp_165705;
    
    mem_param_tmp_165705.references = NULL;
    
    struct memblock mem_165153;
    
    mem_165153.references = NULL;
    
    struct memblock mem_165151;
    
    mem_165151.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165131;
    
    mem_165131.references = NULL;
    
    struct memblock ext_mem_165156;
    
    ext_mem_165156.references = NULL;
    
    struct memblock ext_mem_165159;
    
    ext_mem_165159.references = NULL;
    
    struct memblock ext_mem_165162;
    
    ext_mem_165162.references = NULL;
    
    struct memblock ext_mem_165165;
    
    ext_mem_165165.references = NULL;
    
    struct memblock mem_param_165129;
    
    mem_param_165129.references = NULL;
    
    struct memblock mem_param_165126;
    
    mem_param_165126.references = NULL;
    
    struct memblock ext_mem_165170;
    
    ext_mem_165170.references = NULL;
    
    struct memblock ext_mem_165171;
    
    ext_mem_165171.references = NULL;
    
    struct memblock ext_mem_165174;
    
    ext_mem_165174.references = NULL;
    
    struct memblock ext_mem_165177;
    
    ext_mem_165177.references = NULL;
    
    struct memblock ext_mem_165196;
    
    ext_mem_165196.references = NULL;
    
    struct memblock ext_mem_165199;
    
    ext_mem_165199.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock ext_mem_165204;
    
    ext_mem_165204.references = NULL;
    
    struct memblock ext_mem_165205;
    
    ext_mem_165205.references = NULL;
    
    struct memblock mem_164934;
    
    mem_164934.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock ext_mem_164930;
    
    ext_mem_164930.references = NULL;
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165696;
    int64_t zm_lhs_150399 = add64(nR_116230, nS_116231);
    int64_t zs_lhs_150400 = sub64(zm_lhs_150399, (int64_t) 1);
    bool zzero_150401 = nR_116230 == (int64_t) 0;
    bool nonzzero_150402 = !zzero_150401;
    bool nonzzero_cert_150403;
    
    if (!nonzzero_150402) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:379:26-29\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_150404 = sdiv64(zs_lhs_150400, nR_116230);
    
    if (futrts_indicesWithIncrement_12141(ctx, &ext_mem_164930, tR_mem_164928, nR_116230, offset_R_116234) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_164931 = (int64_t) 8 * nR_116230;
    
    if (memblock_alloc(ctx, &mem_164932, bytes_164931, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165697 = 0; nest_i_165697 < nR_116230; nest_i_165697++) {
        ((int64_t *) mem_164932.mem)[nest_i_165697] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_164934, bytes_164931, "mem_164934")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165698 = 0; nest_i_165698 < nR_116230; nest_i_165698++) {
        ((int64_t *) mem_164934.mem)[nest_i_165698] = (int64_t) 0;
    }
    
    bool loop_cond_150409 = slt64((int64_t) 0, numIter_150404);
    int64_t gt_rhs_150410 = sub64(nR_116230, (int64_t) 1);
    bool x_150411 = sle64((int64_t) 0, gt_rhs_150410);
    bool y_150412 = slt64(gt_rhs_150410, nR_116230);
    bool bounds_check_150413 = x_150411 && y_150412;
    bool loop_not_taken_150414 = !loop_cond_150409;
    bool protect_assert_disj_150415 = bounds_check_150413 || loop_not_taken_150414;
    bool index_certs_150416;
    
    if (!protect_assert_disj_150415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:386:25-33\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int16_t gt_rhs_150417;
    
    if (loop_cond_150409) {
        int16_t x_157438 = ((int16_t *) tR_mem_164928.mem)[gt_rhs_150410];
        
        gt_rhs_150417 = x_157438;
    } else {
        gt_rhs_150417 = (int16_t) 0;
    }
    
    bool defunc_0_mergeJoin_res_150419;
    int64_t defunc_0_mergeJoin_res_150420;
    bool loop_while_150423;
    int64_t p_150424;
    
    if (memblock_set(ctx, &mem_param_164937, &mem_164934, "mem_164934") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &mem_164932, "mem_164932") != 0)
        return 1;
    loop_while_150423 = loop_cond_150409;
    p_150424 = (int64_t) 0;
    while (loop_while_150423) {
        int64_t tS_start_150427 = mul64(nR_116230, p_150424);
        int64_t min_arg1_150428 = add64(nR_116230, tS_start_150427);
        int64_t min_res_150429 = smin64(nS_116231, min_arg1_150428);
        int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 = sub64(min_res_150429, tS_start_150427);
        bool empty_slice_150431 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430 == (int64_t) 0;
        int64_t m_150432 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, (int64_t) 1);
        int64_t i_p_m_t_s_150433 = add64(tS_start_150427, m_150432);
        bool zzero_leq_i_p_m_t_s_150434 = sle64((int64_t) 0, i_p_m_t_s_150433);
        bool i_p_m_t_s_leq_w_150435 = slt64(i_p_m_t_s_150433, nS_116231);
        bool zzero_lte_i_150436 = sle64((int64_t) 0, tS_start_150427);
        bool i_lte_j_150437 = sle64(tS_start_150427, min_res_150429);
        bool y_150438 = i_p_m_t_s_leq_w_150435 && zzero_lte_i_150436;
        bool y_150439 = zzero_leq_i_p_m_t_s_150434 && y_150438;
        bool forwards_ok_150440 = i_lte_j_150437 && y_150439;
        bool ok_or_empty_150441 = empty_slice_150431 || forwards_ok_150440;
        bool index_certs_150442;
        
        if (!ok_or_empty_150441) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_150427, ":", (long long) min_res_150429, "] out of bounds for array of shape [", (long long) nS_116231, "].", "-> #0  ftSMJ.fut:385:16-35\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_150444 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
        bool index_certs_150445;
        
        if (!y_150444) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:386:12-19\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t gt_lhs_150446 = ((int16_t *) tS_mem_164929.mem)[tS_start_150427];
        bool defunc_0_gt_res_150447 = slt16(gt_rhs_150417, gt_lhs_150446);
        int64_t loopres_150448;
        
        if (defunc_0_gt_res_150447) {
            if (memblock_set(ctx, &ext_mem_165199, &mem_param_164937, "mem_param_164937") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_param_164940, "mem_param_164940") != 0)
                return 1;
            loopres_150448 = numIter_150404;
        } else {
            bool cond_150451 = slt64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, nR_116230);
            bool dim_match_150565 = nR_116230 == dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            bool protect_assert_disj_165549 = cond_150451 || dim_match_150565;
            bool empty_or_match_cert_150566;
            
            if (!protect_assert_disj_165549) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "] cannot match shape of type `[", (long long) nR_116230, "]i16`.", "-> #0  ftSMJ.fut:394:18-31\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_cond_150572 = slt64((int64_t) 0, numberOfWindows_116237);
            bool y_150575 = slt64((int64_t) 0, nR_116230);
            bool loop_not_taken_150576 = !loop_cond_150572;
            bool protect_assert_disj_150577 = y_150575 || loop_not_taken_150576;
            bool protect_assert_disj_165551 = cond_150451 || protect_assert_disj_150577;
            bool index_certs_150578;
            
            if (!protect_assert_disj_165551) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:264:20-25\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_157450 = add64(nR_116230, extParallelism_116238);
            int64_t zs_lhs_157451 = sub64(zm_lhs_157450, (int64_t) 1);
            bool zzero_157452 = extParallelism_116238 == (int64_t) 0;
            bool nonzzero_157453 = !zzero_157452;
            bool loop_not_taken_165527 = !cond_150451;
            bool protect_assert_disj_165528 = nonzzero_157453 || loop_not_taken_165527;
            bool nonzzero_cert_157454;
            
            if (!protect_assert_disj_165528) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t numIter_157455 = sdiv_safe64(zs_lhs_157451, extParallelism_116238);
            bool loop_cond_157456 = slt64((int64_t) 0, numIter_157455);
            bool loop_not_taken_157457 = !y_150444;
            bool loop_not_taken_157458 = !loop_cond_157456;
            bool x_157459 = sle64((int64_t) 0, m_150432);
            bool y_157460 = slt64(m_150432, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430);
            bool bounds_check_157462 = x_157459 && y_157460;
            bool protect_assert_disj_157463 = loop_not_taken_157457 || bounds_check_157462;
            bool protect_assert_disj_157464 = loop_not_taken_157458 || protect_assert_disj_157463;
            bool protect_assert_disj_165530 = protect_assert_disj_157464 || loop_not_taken_165527;
            bool index_certs_157465;
            
            if (!protect_assert_disj_165530) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151246;
            
            if (!bounds_check_157462) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_150432, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, "].", "-> #0  ftSMJ.fut:405:23-44\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool index_certs_151248;
            
            if (!bounds_check_150413) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:405:51-59\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 = mul64(partitionsPerWindow_116236, numberOfWindows_116237);
            int64_t join_chunks_arg3_150568 = add64(offset_S_116235, tS_start_150427);
            int64_t bytes_164941 = (int64_t) 8 * dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
            bool empty_slice_150573 = partitionsPerWindow_116236 == (int64_t) 0;
            int64_t m_150574 = sub64(partitionsPerWindow_116236, (int64_t) 1);
            bool protect_cond_conj_165552 = loop_cond_150572 && loop_not_taken_165527;
            int16_t leq_lhs_150579;
            
            if (protect_cond_conj_165552) {
                int16_t x_157566 = ((int16_t *) tR_mem_164928.mem)[(int64_t) 0];
                
                leq_lhs_150579 = x_157566;
            } else {
                leq_lhs_150579 = (int16_t) 0;
            }
            
            bool defunc_0_leq_res_150583 = sle16(leq_lhs_150579, gt_lhs_150446);
            int16_t lowest_150584;
            
            if (protect_cond_conj_165552) {
                bool loop_not_taken_165542 = !defunc_0_leq_res_150583;
                bool protect_assert_disj_165543 = y_150575 || loop_not_taken_165542;
                bool index_certs_157570;
                
                if (!protect_assert_disj_165543) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:264:44-49\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t lowest_t_res_157571;
                
                if (defunc_0_leq_res_150583) {
                    int16_t x_165544 = ((int16_t *) tR_mem_164928.mem)[(int64_t) 0];
                    
                    lowest_t_res_157571 = x_165544;
                } else {
                    lowest_t_res_157571 = (int16_t) 0;
                }
                
                int16_t x_157569;
                
                if (defunc_0_leq_res_150583) {
                    x_157569 = lowest_t_res_157571;
                } else {
                    bool index_certs_157572;
                    
                    if (!y_150575) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:264:55-60\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    x_157569 = gt_lhs_150446;
                }
                lowest_150584 = x_157569;
            } else {
                lowest_150584 = (int16_t) 0;
            }
            
            int64_t zeze_rhs_150843 = sub64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, (int64_t) 1);
            bool loop_cond_150998 = slt64((int64_t) 0, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
            bool protect_cond_conj_157461 = y_150444 && loop_cond_157456;
            bool protect_cond_conj_165531 = cond_150451 && protect_cond_conj_157461;
            int16_t s_max_t_res_157466;
            
            if (protect_cond_conj_165531) {
                int16_t x_157467 = ((int16_t *) tS_mem_164929.mem)[i_p_m_t_s_150433];
                
                s_max_t_res_157466 = x_157467;
            } else {
                s_max_t_res_157466 = (int16_t) 0;
            }
            
            int64_t bytes_165130 = (int64_t) 2 * dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430;
            int64_t ext_165176;
            int64_t ext_165175;
            int64_t ext_165173;
            int64_t ext_165172;
            
            if (cond_150451) {
                int64_t ext_165169;
                int64_t ext_165168;
                int64_t ext_165167;
                int64_t ext_165166;
                bool defunc_0_find_joinTuples_res_157468;
                int64_t defunc_0_find_joinTuples_res_157469;
                bool loop_while_157472;
                int64_t p_157473;
                int64_t ctx_param_ext_165124;
                int64_t ctx_param_ext_165125;
                int64_t ctx_param_ext_165127;
                int64_t ctx_param_ext_165128;
                
                if (memblock_set(ctx, &mem_param_165126, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165129, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165124 = (int64_t) 0;
                ctx_param_ext_165125 = (int64_t) 1;
                ctx_param_ext_165127 = (int64_t) 0;
                ctx_param_ext_165128 = (int64_t) 1;
                loop_while_157472 = loop_cond_157456;
                p_157473 = (int64_t) 0;
                while (loop_while_157472) {
                    int64_t start_157476 = mul64(extParallelism_116238, p_157473);
                    int64_t min_arg1_157477 = sub64(nR_116230, start_157476);
                    int64_t min_res_157478 = smin64(extParallelism_116238, min_arg1_157477);
                    int64_t iter_R_157479 = add64(start_157476, min_res_157478);
                    bool empty_slice_157480 = min_res_157478 == (int64_t) 0;
                    int64_t m_157481 = sub64(min_res_157478, (int64_t) 1);
                    int64_t i_p_m_t_s_157482 = add64(start_157476, m_157481);
                    bool zzero_leq_i_p_m_t_s_157483 = sle64((int64_t) 0, i_p_m_t_s_157482);
                    bool i_p_m_t_s_leq_w_157484 = slt64(i_p_m_t_s_157482, nR_116230);
                    bool zzero_lte_i_157485 = sle64((int64_t) 0, start_157476);
                    bool i_lte_j_157486 = sle64(start_157476, iter_R_157479);
                    bool y_157487 = i_p_m_t_s_leq_w_157484 && zzero_lte_i_157485;
                    bool y_157488 = zzero_leq_i_p_m_t_s_157483 && y_157487;
                    bool forwards_ok_157489 = i_lte_j_157486 && y_157488;
                    bool ok_or_empty_157490 = empty_slice_157480 || forwards_ok_157489;
                    bool index_certs_157491;
                    
                    if (!ok_or_empty_157490) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_157476, ":", (long long) iter_R_157479, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157492 = slt64(m_157481, min_res_157478);
                    bool x_157493 = sle64((int64_t) 0, m_157481);
                    bool bounds_check_157494 = y_157492 && x_157493;
                    bool index_certs_157495;
                    
                    if (!bounds_check_157494) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_157481, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_157498 = slt64((int64_t) 0, min_res_157478);
                    bool index_certs_157499;
                    
                    if (!y_157498) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_157478, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t r_max_157496 = ((int16_t *) tR_mem_164928.mem)[i_p_m_t_s_157482];
                    int16_t s_max_157497;
                    
                    if (y_150444) {
                        s_max_157497 = s_max_t_res_157466;
                    } else {
                        s_max_157497 = r_max_157496;
                    }
                    
                    int16_t r_min_157500 = ((int16_t *) tR_mem_164928.mem)[start_157476];
                    bool defunc_0_gt_res_157501 = slt16(s_max_157497, r_min_157500);
                    int16_t s_min_157502;
                    
                    if (y_150444) {
                        s_min_157502 = gt_lhs_150446;
                    } else {
                        s_min_157502 = r_min_157500;
                    }
                    
                    bool defunc_0_gt_res_157507 = slt16(r_max_157496, s_min_157502);
                    int64_t ext_165158;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165158 = ctx_param_ext_165124;
                    } else {
                        ext_165158 = (int64_t) 0;
                    }
                    
                    int64_t ext_165157;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165157 = ctx_param_ext_165125;
                    } else {
                        ext_165157 = (int64_t) 1;
                    }
                    
                    int64_t ext_165155;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165155 = ctx_param_ext_165127;
                    } else {
                        ext_165155 = (int64_t) 0;
                    }
                    
                    int64_t ext_165154;
                    
                    if (defunc_0_gt_res_157507) {
                        ext_165154 = ctx_param_ext_165128;
                    } else {
                        ext_165154 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165134 = (int64_t) 8 * min_res_157478;
                    int64_t ext_165164;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165164 = ctx_param_ext_165124;
                    } else {
                        ext_165164 = ext_165158;
                    }
                    
                    int64_t ext_165163;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165163 = ctx_param_ext_165125;
                    } else {
                        ext_165163 = ext_165157;
                    }
                    
                    int64_t ext_165161;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165161 = ctx_param_ext_165127;
                    } else {
                        ext_165161 = ext_165155;
                    }
                    
                    int64_t ext_165160;
                    
                    if (defunc_0_gt_res_157501) {
                        ext_165160 = ctx_param_ext_165128;
                    } else {
                        ext_165160 = ext_165154;
                    }
                    
                    int64_t loopres_157503;
                    
                    if (defunc_0_gt_res_157501) {
                        if (memblock_set(ctx, &ext_mem_165165, &mem_param_165126, "mem_param_165126") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &mem_param_165129, "mem_param_165129") != 0)
                            return 1;
                        loopres_157503 = numIter_157455;
                    } else {
                        int64_t loopres_f_res_157508;
                        
                        if (defunc_0_gt_res_157507) {
                            int64_t tmp_157512 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_param_165126, "mem_param_165126") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_param_165129, "mem_param_165129") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157512;
                        } else {
                            if (memblock_alloc(ctx, &mem_165131, bytes_165130, "mem_165131")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_2b(ctx, 1, (uint16_t *) mem_165131.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) tS_mem_164929.mem, tS_start_150427, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430});
                            if (futrts_indicesWithIncrement_12141(ctx, &ext_mem_165133, mem_165131, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430, join_chunks_arg3_150568) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
                                return 1;
                            if (mem_165135_cached_sizze_166130 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165135, &mem_165135_cached_sizze_166130, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            if (mem_165137_cached_sizze_166131 < bytes_165134) {
                                err = lexical_realloc(ctx, &mem_165137, &mem_165137_cached_sizze_166131, bytes_165134);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164719 = 0; i_164719 < min_res_157478; i_164719++) {
                                int64_t slice_164899 = start_157476 + i_164719;
                                int16_t eta_p_157518 = ((int16_t *) tR_mem_164928.mem)[slice_164899];
                                int64_t defunc_0_reduce_comm_res_157519;
                                int16_t defunc_0_reduce_comm_res_157520;
                                int64_t defunc_0_reduce_comm_res_157521;
                                int64_t redout_164711;
                                int16_t redout_164712;
                                int64_t redout_164713;
                                
                                redout_164711 = (int64_t) -1;
                                redout_164712 = eta_p_157518;
                                redout_164713 = (int64_t) 0;
                                for (int64_t i_164714 = 0; i_164714 < dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_150430; i_164714++) {
                                    int64_t x_157522 = ((int64_t *) ext_mem_165133.mem)[i_164714];
                                    int64_t slice_164898 = tS_start_150427 + i_164714;
                                    int16_t x_157523 = ((int16_t *) tS_mem_164929.mem)[slice_164898];
                                    bool defunc_0_neq_res_157531 = redout_164712 == eta_p_157518;
                                    bool defunc_0_neq_res_157532 = !defunc_0_neq_res_157531;
                                    bool cond_f_res_157533 = slt64(redout_164711, (int64_t) 0);
                                    bool y_157534 = defunc_0_neq_res_157531 && cond_f_res_157533;
                                    bool cond_157535 = defunc_0_neq_res_157532 || y_157534;
                                    bool defunc_0_neq_res_157536 = x_157523 == eta_p_157518;
                                    bool defunc_0_neq_res_157537 = !defunc_0_neq_res_157536;
                                    bool cond_t_res_f_res_157538 = slt64(x_157522, (int64_t) 0);
                                    bool y_157539 = defunc_0_neq_res_157536 && cond_t_res_f_res_157538;
                                    bool cond_t_res_157540 = defunc_0_neq_res_157537 || y_157539;
                                    bool x_157541 = cond_157535 && cond_t_res_157540;
                                    int64_t defunc_0_op_res_157542;
                                    int16_t defunc_0_op_res_157543;
                                    int64_t defunc_0_op_res_157544;
                                    
                                    if (x_157541) {
                                        defunc_0_op_res_157542 = (int64_t) -1;
                                        defunc_0_op_res_157543 = eta_p_157518;
                                        defunc_0_op_res_157544 = (int64_t) 0;
                                    } else {
                                        int64_t defunc_0_op_res_f_res_157545;
                                        int16_t defunc_0_op_res_f_res_157546;
                                        int64_t defunc_0_op_res_f_res_157547;
                                        
                                        if (cond_157535) {
                                            defunc_0_op_res_f_res_157545 = x_157522;
                                            defunc_0_op_res_f_res_157546 = x_157523;
                                            defunc_0_op_res_f_res_157547 = (int64_t) 1;
                                        } else {
                                            int16_t defunc_0_op_res_f_res_f_res_157548;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157548 = redout_164712;
                                            } else {
                                                defunc_0_op_res_f_res_f_res_157548 = eta_p_157518;
                                            }
                                            
                                            int64_t defunc_0_op_res_f_res_f_res_157549;
                                            int64_t defunc_0_op_res_f_res_f_res_157550;
                                            
                                            if (cond_t_res_157540) {
                                                defunc_0_op_res_f_res_f_res_157549 = redout_164711;
                                                defunc_0_op_res_f_res_f_res_157550 = redout_164713;
                                            } else {
                                                int64_t min_res_157551 = smin64(x_157522, redout_164711);
                                                int64_t tmp_157552 = add64((int64_t) 1, redout_164713);
                                                
                                                defunc_0_op_res_f_res_f_res_157549 = min_res_157551;
                                                defunc_0_op_res_f_res_f_res_157550 = tmp_157552;
                                            }
                                            defunc_0_op_res_f_res_157545 = defunc_0_op_res_f_res_f_res_157549;
                                            defunc_0_op_res_f_res_157546 = defunc_0_op_res_f_res_f_res_157548;
                                            defunc_0_op_res_f_res_157547 = defunc_0_op_res_f_res_f_res_157550;
                                        }
                                        defunc_0_op_res_157542 = defunc_0_op_res_f_res_157545;
                                        defunc_0_op_res_157543 = defunc_0_op_res_f_res_157546;
                                        defunc_0_op_res_157544 = defunc_0_op_res_f_res_157547;
                                    }
                                    
                                    int64_t redout_tmp_165717 = defunc_0_op_res_157542;
                                    int16_t redout_tmp_165718 = defunc_0_op_res_157543;
                                    int64_t redout_tmp_165719 = defunc_0_op_res_157544;
                                    
                                    redout_164711 = redout_tmp_165717;
                                    redout_164712 = redout_tmp_165718;
                                    redout_164713 = redout_tmp_165719;
                                }
                                defunc_0_reduce_comm_res_157519 = redout_164711;
                                defunc_0_reduce_comm_res_157520 = redout_164712;
                                defunc_0_reduce_comm_res_157521 = redout_164713;
                                ((int64_t *) mem_165135)[i_164719] = defunc_0_reduce_comm_res_157519;
                                ((int64_t *) mem_165137)[i_164719] = defunc_0_reduce_comm_res_157521;
                            }
                            if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165151, bytes_164931, "mem_165151")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165129.mem, ctx_param_ext_165127, (int64_t []) {ctx_param_ext_165128}, (int64_t []) {nR_116230});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165151.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165135, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            if (memblock_alloc(ctx, &mem_165153, bytes_164931, "mem_165153")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165126.mem, ctx_param_ext_165124, (int64_t []) {ctx_param_ext_165125}, (int64_t []) {nR_116230});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165153.mem, start_157476, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165137, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_157478});
                            
                            int64_t tmp_157564 = add64((int64_t) 1, p_157473);
                            
                            if (memblock_set(ctx, &ext_mem_165159, &mem_165153, "mem_165153") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165156, &mem_165151, "mem_165151") != 0)
                                return 1;
                            loopres_f_res_157508 = tmp_157564;
                        }
                        if (memblock_set(ctx, &ext_mem_165165, &ext_mem_165159, "ext_mem_165159") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165162, &ext_mem_165156, "ext_mem_165156") != 0)
                            return 1;
                        loopres_157503 = loopres_f_res_157508;
                    }
                    
                    bool loop_cond_157565 = slt64(loopres_157503, numIter_157455);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165705, &ext_mem_165165, "ext_mem_165165") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165706, &ext_mem_165162, "ext_mem_165162") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165707 = ext_165164;
                    int64_t ctx_param_ext_tmp_165708 = ext_165163;
                    int64_t ctx_param_ext_tmp_165709 = ext_165161;
                    int64_t ctx_param_ext_tmp_165710 = ext_165160;
                    bool loop_while_tmp_165711 = loop_cond_157565;
                    int64_t p_tmp_165712 = loopres_157503;
                    
                    if (memblock_set(ctx, &mem_param_165126, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165129, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
                        return 1;
                    ctx_param_ext_165124 = ctx_param_ext_tmp_165707;
                    ctx_param_ext_165125 = ctx_param_ext_tmp_165708;
                    ctx_param_ext_165127 = ctx_param_ext_tmp_165709;
                    ctx_param_ext_165128 = ctx_param_ext_tmp_165710;
                    loop_while_157472 = loop_while_tmp_165711;
                    p_157473 = p_tmp_165712;
                }
                if (memblock_set(ctx, &ext_mem_165171, &mem_param_165126, "mem_param_165126") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165170, &mem_param_165129, "mem_param_165129") != 0)
                    return 1;
                ext_165169 = ctx_param_ext_165124;
                ext_165168 = ctx_param_ext_165125;
                ext_165167 = ctx_param_ext_165127;
                ext_165166 = ctx_param_ext_165128;
                defunc_0_find_joinTuples_res_157468 = loop_while_157472;
                defunc_0_find_joinTuples_res_157469 = p_157473;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165171, "ext_mem_165171") != 0)
                    return 1;
                ext_165176 = ext_165169;
                ext_165175 = ext_165168;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165170, "ext_mem_165170") != 0)
                    return 1;
                ext_165173 = ext_165167;
                ext_165172 = ext_165166;
            } else {
                if (mem_164942_cached_sizze_166122 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164942, &mem_164942_cached_sizze_166122, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165720 = 0; nest_i_165720 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165720++) {
                    ((int64_t *) mem_164942)[nest_i_165720] = nR_116230;
                }
                if (mem_164944_cached_sizze_166123 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164944, &mem_164944_cached_sizze_166123, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t nest_i_165721 = 0; nest_i_165721 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; nest_i_165721++) {
                    ((int64_t *) mem_164944)[nest_i_165721] = nR_116230;
                }
                
                bool defunc_0_windowed_partitionFunc_res_150590;
                int64_t defunc_0_windowed_partitionFunc_res_150591;
                bool loop_while_150594;
                int64_t p_150595;
                
                loop_while_150594 = loop_cond_150572;
                p_150595 = (int64_t) 0;
                while (loop_while_150594) {
                    int64_t start_150598 = mul64(partitionsPerWindow_116236, p_150595);
                    int64_t end_150599 = add64(partitionsPerWindow_116236, start_150598);
                    int64_t max_res_150600 = smax64((int64_t) 1, start_150598);
                    int64_t dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601 = sub64(end_150599, max_res_150600);
                    bool bounds_invalid_upwards_150602 = slt64(end_150599, max_res_150600);
                    bool valid_150603 = !bounds_invalid_upwards_150602;
                    bool range_valid_c_150604;
                    
                    if (!valid_150603) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) max_res_150600, "..<", (long long) end_150599, " is invalid.", "-> #0  ftbasics.fut:267:43-68\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool zzero_150607 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569 == (int64_t) 0;
                    bool nonzzero_150608 = !zzero_150607;
                    bool nonzzero_cert_150609;
                    
                    if (!nonzzero_150608) {
                        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:270:36-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_164951 = (int64_t) 8 * dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool cond_150810 = slt64((int64_t) 0, start_150598);
                    int64_t conc_tmp_150811 = (int64_t) 1 + dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    int64_t ret_150812;
                    
                    if (cond_150810) {
                        ret_150812 = dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    } else {
                        ret_150812 = conc_tmp_150811;
                    }
                    
                    bool eq_x_y_150820 = partitionsPerWindow_116236 == dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                    bool eq_x_zz_150821 = partitionsPerWindow_116236 == conc_tmp_150811;
                    bool p_and_eq_x_y_150822 = cond_150810 && eq_x_y_150820;
                    bool not_p_150823 = !cond_150810;
                    bool p_and_eq_x_y_150824 = eq_x_zz_150821 && not_p_150823;
                    bool dim_match_150825 = p_and_eq_x_y_150822 || p_and_eq_x_y_150824;
                    bool empty_or_match_cert_150826;
                    
                    if (!dim_match_150825) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) ret_150812, "] cannot match shape of type `[", (long long) partitionsPerWindow_116236, "](i64, i64)`.", "-> #0  ftbasics.fut:331:5-336:49\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t i_p_m_t_s_150828 = add64(m_150574, start_150598);
                    bool zzero_leq_i_p_m_t_s_150829 = sle64((int64_t) 0, i_p_m_t_s_150828);
                    bool i_p_m_t_s_leq_w_150830 = slt64(i_p_m_t_s_150828, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool zzero_lte_i_150831 = sle64((int64_t) 0, start_150598);
                    bool i_lte_j_150832 = sle64(start_150598, end_150599);
                    bool y_150833 = i_p_m_t_s_leq_w_150830 && zzero_lte_i_150831;
                    bool y_150834 = zzero_leq_i_p_m_t_s_150829 && y_150833;
                    bool forwards_ok_150835 = i_lte_j_150832 && y_150834;
                    bool ok_or_empty_150836 = empty_slice_150573 || forwards_ok_150835;
                    bool index_certs_150837;
                    
                    if (!ok_or_empty_150836) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_150598, ":", (long long) end_150599, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftbasics.fut:356:37-74\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zt_rhs_150606 = add64(nR_116230, nR_116230);
                    
                    if (memblock_alloc(ctx, &mem_164952, bytes_164951, "mem_164952")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_164954, bytes_164951, "mem_164954")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_164726 = 0; i_164726 < dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601; i_164726++) {
                        int64_t index_primexp_164907 = add64(max_res_150600, i_164726);
                        int64_t zs_lhs_150613 = mul64(zt_rhs_150606, index_primexp_164907);
                        int64_t index_150614 = sdiv64(zs_lhs_150613, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool cond_150615 = slt64(nR_116230, index_150614);
                        int64_t loop_over_150616;
                        
                        if (cond_150615) {
                            loop_over_150616 = nR_116230;
                        } else {
                            loop_over_150616 = index_150614;
                        }
                        
                        int64_t loop_over_150617;
                        
                        if (cond_150615) {
                            int64_t loop_over_t_res_157573 = sub64(index_150614, nR_116230);
                            
                            loop_over_150617 = loop_over_t_res_157573;
                        } else {
                            loop_over_150617 = (int64_t) 0;
                        }
                        
                        int64_t loop_over_150619;
                        
                        if (cond_150615) {
                            int64_t zm_lhs_157574 = sub64(index_150614, nR_116230);
                            int64_t loop_over_t_res_157575 = sub64(zm_lhs_157574, (int64_t) 1);
                            
                            loop_over_150619 = loop_over_t_res_157575;
                        } else {
                            loop_over_150619 = (int64_t) 0;
                        }
                        
                        bool defunc_0_f_res_150622;
                        int64_t defunc_0_f_res_150623;
                        int64_t defunc_0_f_res_150624;
                        int64_t defunc_0_f_res_150625;
                        bool loop_while_150626;
                        int64_t p_150627;
                        int64_t p_150628;
                        int64_t p_150629;
                        
                        loop_while_150626 = 1;
                        p_150627 = loop_over_150619;
                        p_150628 = loop_over_150616;
                        p_150629 = loop_over_150617;
                        while (loop_while_150626) {
                            int64_t zs_lhs_150630 = sub64(p_150628, p_150627);
                            int64_t offset_150631 = sdiv64(zs_lhs_150630, (int64_t) 2);
                            int64_t ai_150632 = sub64(p_150628, offset_150631);
                            int64_t max_arg1_150633 = add64(p_150629, offset_150631);
                            int64_t max_res_150634 = smax64((int64_t) 0, max_arg1_150633);
                            bool cond_150635 = slt64((int64_t) 0, max_res_150634);
                            int16_t b_prev_150636;
                            
                            if (cond_150635) {
                                int64_t tmp_157576 = sub64(max_res_150634, (int64_t) 1);
                                bool x_157577 = sle64((int64_t) 0, tmp_157576);
                                bool y_157578 = slt64(tmp_157576, nR_116230);
                                bool bounds_check_157579 = x_157577 && y_157578;
                                bool index_certs_157580;
                                
                                if (!bounds_check_157579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157576, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:282:37-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157581 = tS_start_150427 + tmp_157576;
                                int16_t b_prev_t_res_157582 = ((int16_t *) tS_mem_164929.mem)[slice_157581];
                                
                                b_prev_150636 = b_prev_t_res_157582;
                            } else {
                                b_prev_150636 = lowest_150584;
                            }
                            
                            bool cond_150643 = sle64(ai_150632, (int64_t) 0);
                            int64_t loopres_150644;
                            int64_t loopres_150645;
                            int64_t loopres_150646;
                            bool loopres_150647;
                            
                            if (cond_150643) {
                                loopres_150644 = p_150627;
                                loopres_150645 = (int64_t) 0;
                                loopres_150646 = max_res_150634;
                                loopres_150647 = 0;
                            } else {
                                bool cond_150648 = sle64(nR_116230, max_res_150634);
                                int64_t loopres_f_res_150649;
                                int64_t loopres_f_res_150650;
                                int64_t loopres_f_res_150651;
                                bool loopres_f_res_150652;
                                
                                if (cond_150648) {
                                    int64_t min_res_157584 = smin64(gt_rhs_150410, ai_150632);
                                    bool bounds_check_157587 = x_150411 && y_150412;
                                    bool index_certs_157588;
                                    
                                    if (!bounds_check_157587) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:293:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157591 = sle64((int64_t) 0, min_res_157584);
                                    bool y_157592 = slt64(min_res_157584, nR_116230);
                                    bool bounds_check_157593 = x_157591 && y_157592;
                                    bool index_certs_157594;
                                    
                                    if (!bounds_check_157593) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157584, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:293:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157589 = gt_rhs_150410 + tS_start_150427;
                                    int16_t leq_lhs_157590 = ((int16_t *) tS_mem_164929.mem)[slice_157589];
                                    int16_t leq_rhs_157595 = ((int16_t *) tR_mem_164928.mem)[min_res_157584];
                                    bool defunc_0_leq_res_157596 = sle16(leq_lhs_157590, leq_rhs_157595);
                                    int64_t loopres_f_res_t_res_157597;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157597 = ai_150632;
                                    } else {
                                        loopres_f_res_t_res_157597 = p_150628;
                                    }
                                    
                                    bool x_157598 = !defunc_0_leq_res_157596;
                                    int64_t loopres_f_res_t_res_157599;
                                    
                                    if (defunc_0_leq_res_157596) {
                                        loopres_f_res_t_res_157599 = nR_116230;
                                    } else {
                                        int64_t tmp_157600 = sub64(gt_rhs_150410, offset_150631);
                                        
                                        loopres_f_res_t_res_157599 = tmp_157600;
                                    }
                                    loopres_f_res_150649 = p_150627;
                                    loopres_f_res_150650 = loopres_f_res_t_res_157597;
                                    loopres_f_res_150651 = loopres_f_res_t_res_157599;
                                    loopres_f_res_150652 = x_157598;
                                } else {
                                    bool cond_150670 = sle64(nR_116230, ai_150632);
                                    int64_t loopres_f_res_f_res_150671;
                                    int64_t loopres_f_res_f_res_150672;
                                    int64_t loopres_f_res_f_res_150673;
                                    bool loopres_f_res_f_res_150674;
                                    
                                    if (cond_150670) {
                                        int64_t min_res_157602 = smin64(gt_rhs_150410, max_res_150634);
                                        bool bounds_check_157605 = x_150411 && y_150412;
                                        bool index_certs_157606;
                                        
                                        if (!bounds_check_157605) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:300:25-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157608 = sle64((int64_t) 0, min_res_157602);
                                        bool y_157609 = slt64(min_res_157602, nR_116230);
                                        bool bounds_check_157610 = x_157608 && y_157609;
                                        bool index_certs_157611;
                                        
                                        if (!bounds_check_157610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_157602, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:300:39-48\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int16_t leq_lhs_157607 = ((int16_t *) tR_mem_164928.mem)[gt_rhs_150410];
                                        int64_t slice_157612 = tS_start_150427 + min_res_157602;
                                        int16_t leq_rhs_157613 = ((int16_t *) tS_mem_164929.mem)[slice_157612];
                                        bool defunc_0_leq_res_157614 = sle16(leq_lhs_157607, leq_rhs_157613);
                                        int64_t loopres_f_res_f_res_t_res_157615;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157615 = max_res_150634;
                                        } else {
                                            loopres_f_res_f_res_t_res_157615 = p_150629;
                                        }
                                        
                                        bool x_157616 = !defunc_0_leq_res_157614;
                                        int64_t loopres_f_res_f_res_t_res_157617;
                                        
                                        if (defunc_0_leq_res_157614) {
                                            loopres_f_res_f_res_t_res_157617 = nR_116230;
                                        } else {
                                            loopres_f_res_f_res_t_res_157617 = gt_rhs_150410;
                                        }
                                        loopres_f_res_f_res_150671 = p_150627;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_t_res_157617;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_t_res_157615;
                                        loopres_f_res_f_res_150674 = x_157616;
                                    } else {
                                        bool cond_150691 = sle64(p_150628, p_150627);
                                        int64_t loopres_f_res_f_res_f_res_150692;
                                        int64_t loopres_f_res_f_res_f_res_150693;
                                        int64_t loopres_f_res_f_res_f_res_150694;
                                        bool loopres_f_res_f_res_f_res_150695;
                                        
                                        if (cond_150691) {
                                            bool cond_157655 = slt64(ai_150632, nR_116230);
                                            int64_t ai_157656;
                                            
                                            if (cond_157655) {
                                                ai_157656 = ai_150632;
                                            } else {
                                                ai_157656 = gt_rhs_150410;
                                            }
                                            
                                            bool x_157669 = sle64((int64_t) 0, ai_157656);
                                            bool y_157670 = slt64(ai_157656, nR_116230);
                                            bool bounds_check_157671 = x_157669 && y_157670;
                                            bool index_certs_157672;
                                            
                                            if (!bounds_check_157671) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_157656, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:234:8-14\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int16_t b_prev_157658;
                                            
                                            if (cond_150635) {
                                                int64_t tmp_157659 = sub64(max_res_150634, (int64_t) 1);
                                                bool x_157660 = sle64((int64_t) 0, tmp_157659);
                                                bool y_157661 = slt64(tmp_157659, nR_116230);
                                                bool bounds_check_157662 = x_157660 && y_157661;
                                                bool index_certs_157663;
                                                
                                                if (!bounds_check_157662) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157659, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:232:31-39\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_157664 = tS_start_150427 + tmp_157659;
                                                int16_t b_prev_t_res_157665 = ((int16_t *) tS_mem_164929.mem)[slice_157664];
                                                
                                                b_prev_157658 = b_prev_t_res_157665;
                                            } else {
                                                bool index_certs_157667;
                                                
                                                if (!y_150575) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:232:45-50\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                b_prev_157658 = gt_lhs_150446;
                                            }
                                            
                                            int16_t gt_lhs_157673 = ((int16_t *) tR_mem_164928.mem)[ai_157656];
                                            bool defunc_0_gt_res_157674 = slt16(b_prev_157658, gt_lhs_157673);
                                            int64_t defunc_0_partFunc_sequential_search_res_157675;
                                            int64_t defunc_0_partFunc_sequential_search_res_157676;
                                            
                                            if (defunc_0_gt_res_157674) {
                                                int64_t zl_rhs_157677 = sub64(nR_116230, max_res_150634);
                                                bool loop_cond_157678 = slt64((int64_t) 0, zl_rhs_157677);
                                                bool defunc_0_partFunc_sequential_search_res_t_res_157679;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157681;
                                                int64_t defunc_0_partFunc_sequential_search_res_t_res_157682;
                                                bool loop_while_157683;
                                                int64_t p_157684;
                                                int64_t p_157685;
                                                int64_t p_157686;
                                                
                                                loop_while_157683 = loop_cond_157678;
                                                p_157684 = ai_157656;
                                                p_157685 = max_res_150634;
                                                p_157686 = (int64_t) 0;
                                                while (loop_while_157683) {
                                                    int64_t i_a_157687 = sub64(ai_157656, p_157686);
                                                    int64_t i_b_157688 = add64(max_res_150634, p_157686);
                                                    int64_t leq_lhs_157689 = sub64(i_a_157687, (int64_t) 1);
                                                    bool x_157690 = sle64((int64_t) 0, leq_lhs_157689);
                                                    bool y_157691 = slt64(leq_lhs_157689, nR_116230);
                                                    bool bounds_check_157692 = x_157690 && y_157691;
                                                    bool index_certs_157693;
                                                    
                                                    if (!bounds_check_157692) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157689, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:240:15-24\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157695 = sle64((int64_t) 0, i_b_157688);
                                                    bool y_157696 = slt64(i_b_157688, nR_116230);
                                                    bool bounds_check_157697 = x_157695 && y_157696;
                                                    bool index_certs_157698;
                                                    
                                                    if (!bounds_check_157697) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157688, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:240:31-38\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    int16_t leq_lhs_157694 = ((int16_t *) tR_mem_164928.mem)[leq_lhs_157689];
                                                    int64_t slice_157699 = tS_start_150427 + i_b_157688;
                                                    int16_t leq_rhs_157700 = ((int16_t *) tS_mem_164929.mem)[slice_157699];
                                                    bool defunc_0_leq_res_157701 = sle16(leq_lhs_157694, leq_rhs_157700);
                                                    int64_t loopres_157702;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157702 = i_a_157687;
                                                    } else {
                                                        loopres_157702 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157703;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157703 = i_b_157688;
                                                    } else {
                                                        loopres_157703 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157704;
                                                    
                                                    if (defunc_0_leq_res_157701) {
                                                        loopres_157704 = zl_rhs_157677;
                                                    } else {
                                                        int64_t tmp_157705 = add64((int64_t) 1, p_157686);
                                                        
                                                        loopres_157704 = tmp_157705;
                                                    }
                                                    
                                                    bool loop_cond_157706 = slt64(loopres_157704, zl_rhs_157677);
                                                    bool loop_while_tmp_165732 = loop_cond_157706;
                                                    int64_t p_tmp_165733 = loopres_157702;
                                                    int64_t p_tmp_165734 = loopres_157703;
                                                    int64_t p_tmp_165735 = loopres_157704;
                                                    
                                                    loop_while_157683 = loop_while_tmp_165732;
                                                    p_157684 = p_tmp_165733;
                                                    p_157685 = p_tmp_165734;
                                                    p_157686 = p_tmp_165735;
                                                }
                                                defunc_0_partFunc_sequential_search_res_t_res_157679 = loop_while_157683;
                                                defunc_0_partFunc_sequential_search_res_t_res_157680 = p_157684;
                                                defunc_0_partFunc_sequential_search_res_t_res_157681 = p_157685;
                                                defunc_0_partFunc_sequential_search_res_t_res_157682 = p_157686;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_t_res_157680;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_t_res_157681;
                                            } else {
                                                int64_t zl_rhs_157707 = sub64(max_res_150634, (int64_t) 1);
                                                bool loop_cond_157708 = slt64((int64_t) 0, zl_rhs_157707);
                                                bool defunc_0_partFunc_sequential_search_res_f_res_157709;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157711;
                                                int64_t defunc_0_partFunc_sequential_search_res_f_res_157712;
                                                bool loop_while_157713;
                                                int64_t p_157714;
                                                int64_t p_157715;
                                                int64_t p_157716;
                                                
                                                loop_while_157713 = loop_cond_157708;
                                                p_157714 = ai_157656;
                                                p_157715 = max_res_150634;
                                                p_157716 = (int64_t) 0;
                                                while (loop_while_157713) {
                                                    int64_t zp_lhs_157717 = add64(ai_157656, p_157716);
                                                    int64_t hi_a_157718 = add64((int64_t) 1, zp_lhs_157717);
                                                    bool cond_157719 = slt64(hi_a_157718, nR_116230);
                                                    int64_t i_a_157720;
                                                    
                                                    if (cond_157719) {
                                                        i_a_157720 = hi_a_157718;
                                                    } else {
                                                        i_a_157720 = gt_rhs_150410;
                                                    }
                                                    
                                                    int64_t zm_lhs_157722 = sub64(max_res_150634, p_157716);
                                                    int64_t i_b_157723 = sub64(zm_lhs_157722, (int64_t) 1);
                                                    bool x_157724 = sle64((int64_t) 0, i_a_157720);
                                                    bool y_157725 = slt64(i_a_157720, nR_116230);
                                                    bool bounds_check_157726 = x_157724 && y_157725;
                                                    bool index_certs_157727;
                                                    
                                                    if (!bounds_check_157726) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_a_157720, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:250:15-22\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    bool x_157729 = sle64((int64_t) 0, i_b_157723);
                                                    bool y_157730 = slt64(i_b_157723, nR_116230);
                                                    bool bounds_check_157731 = x_157729 && y_157730;
                                                    bool index_certs_157732;
                                                    
                                                    if (!bounds_check_157731) {
                                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_b_157723, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:250:28-35\n   #1  ftbasics.fut:304:80-82\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:269:8-329:8\n   #4  ftRelational.fut:158:133-136\n   #5  ftRelational.fut:147:1-158:136\n"));
                                                        err = FUTHARK_PROGRAM_ERROR;
                                                        goto cleanup;
                                                    }
                                                    
                                                    int16_t gt_lhs_157728 = ((int16_t *) tR_mem_164928.mem)[i_a_157720];
                                                    int64_t slice_157733 = tS_start_150427 + i_b_157723;
                                                    int16_t gt_rhs_157734 = ((int16_t *) tS_mem_164929.mem)[slice_157733];
                                                    bool defunc_0_gt_res_157735 = slt16(gt_rhs_157734, gt_lhs_157728);
                                                    int64_t loopres_157736;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157736 = i_a_157720;
                                                    } else {
                                                        loopres_157736 = ai_157656;
                                                    }
                                                    
                                                    int64_t loopres_157737;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157737 = zm_lhs_157722;
                                                    } else {
                                                        loopres_157737 = max_res_150634;
                                                    }
                                                    
                                                    int64_t loopres_157738;
                                                    
                                                    if (defunc_0_gt_res_157735) {
                                                        loopres_157738 = zl_rhs_157707;
                                                    } else {
                                                        int64_t tmp_157739 = add64((int64_t) 1, p_157716);
                                                        
                                                        loopres_157738 = tmp_157739;
                                                    }
                                                    
                                                    bool loop_cond_157740 = slt64(loopres_157738, zl_rhs_157707);
                                                    bool loop_while_tmp_165736 = loop_cond_157740;
                                                    int64_t p_tmp_165737 = loopres_157736;
                                                    int64_t p_tmp_165738 = loopres_157737;
                                                    int64_t p_tmp_165739 = loopres_157738;
                                                    
                                                    loop_while_157713 = loop_while_tmp_165736;
                                                    p_157714 = p_tmp_165737;
                                                    p_157715 = p_tmp_165738;
                                                    p_157716 = p_tmp_165739;
                                                }
                                                defunc_0_partFunc_sequential_search_res_f_res_157709 = loop_while_157713;
                                                defunc_0_partFunc_sequential_search_res_f_res_157710 = p_157714;
                                                defunc_0_partFunc_sequential_search_res_f_res_157711 = p_157715;
                                                defunc_0_partFunc_sequential_search_res_f_res_157712 = p_157716;
                                                defunc_0_partFunc_sequential_search_res_157675 = defunc_0_partFunc_sequential_search_res_f_res_157710;
                                                defunc_0_partFunc_sequential_search_res_157676 = defunc_0_partFunc_sequential_search_res_f_res_157711;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = p_150627;
                                            loopres_f_res_f_res_f_res_150693 = defunc_0_partFunc_sequential_search_res_157675;
                                            loopres_f_res_f_res_f_res_150694 = defunc_0_partFunc_sequential_search_res_157676;
                                            loopres_f_res_f_res_f_res_150695 = 0;
                                        } else {
                                            bool x_150779 = sle64((int64_t) 0, ai_150632);
                                            bool y_150780 = slt64(ai_150632, nR_116230);
                                            bool bounds_check_150781 = x_150779 && y_150780;
                                            bool index_certs_150782;
                                            
                                            if (!bounds_check_150781) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ai_150632, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:308:17-23\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int16_t gt_lhs_150783 = ((int16_t *) tR_mem_164928.mem)[ai_150632];
                                            bool defunc_0_gt_res_150784 = slt16(b_prev_150636, gt_lhs_150783);
                                            int64_t loopres_f_res_f_res_f_res_f_res_150785;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150786;
                                            int64_t loopres_f_res_f_res_f_res_f_res_150787;
                                            bool loopres_f_res_f_res_f_res_f_res_150788;
                                            
                                            if (defunc_0_gt_res_150784) {
                                                int64_t leq_lhs_157741 = sub64(ai_150632, (int64_t) 1);
                                                bool x_157742 = sle64((int64_t) 0, leq_lhs_157741);
                                                bool y_157743 = slt64(leq_lhs_157741, nR_116230);
                                                bool bounds_check_157744 = x_157742 && y_157743;
                                                bool index_certs_157745;
                                                
                                                if (!bounds_check_157744) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_lhs_157741, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:309:19-27\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                bool x_157747 = sle64((int64_t) 0, max_res_150634);
                                                bool y_157748 = slt64(max_res_150634, nR_116230);
                                                bool bounds_check_157749 = x_157747 && y_157748;
                                                bool index_certs_157750;
                                                
                                                if (!bounds_check_157749) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150634, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftbasics.fut:309:34-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:269:8-329:8\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int16_t leq_lhs_157746 = ((int16_t *) tR_mem_164928.mem)[leq_lhs_157741];
                                                int64_t slice_157751 = tS_start_150427 + max_res_150634;
                                                int16_t leq_rhs_157752 = ((int16_t *) tS_mem_164929.mem)[slice_157751];
                                                bool defunc_0_leq_res_157753 = sle16(leq_lhs_157746, leq_rhs_157752);
                                                bool x_157754 = !defunc_0_leq_res_157753;
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = ai_150632;
                                                } else {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157755 = leq_lhs_157741;
                                                }
                                                
                                                int64_t loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                
                                                if (defunc_0_leq_res_157753) {
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = max_res_150634;
                                                } else {
                                                    int64_t tmp_157757 = add64((int64_t) 1, max_res_150634);
                                                    
                                                    loopres_f_res_f_res_f_res_f_res_t_res_157756 = tmp_157757;
                                                }
                                                loopres_f_res_f_res_f_res_f_res_150785 = p_150627;
                                                loopres_f_res_f_res_f_res_f_res_150786 = loopres_f_res_f_res_f_res_f_res_t_res_157755;
                                                loopres_f_res_f_res_f_res_f_res_150787 = loopres_f_res_f_res_f_res_f_res_t_res_157756;
                                                loopres_f_res_f_res_f_res_f_res_150788 = x_157754;
                                            } else {
                                                int64_t tmp_150805 = add64((int64_t) 1, ai_150632);
                                                
                                                loopres_f_res_f_res_f_res_f_res_150785 = tmp_150805;
                                                loopres_f_res_f_res_f_res_f_res_150786 = p_150628;
                                                loopres_f_res_f_res_f_res_f_res_150787 = p_150629;
                                                loopres_f_res_f_res_f_res_f_res_150788 = 1;
                                            }
                                            loopres_f_res_f_res_f_res_150692 = loopres_f_res_f_res_f_res_f_res_150785;
                                            loopres_f_res_f_res_f_res_150693 = loopres_f_res_f_res_f_res_f_res_150786;
                                            loopres_f_res_f_res_f_res_150694 = loopres_f_res_f_res_f_res_f_res_150787;
                                            loopres_f_res_f_res_f_res_150695 = loopres_f_res_f_res_f_res_f_res_150788;
                                        }
                                        loopres_f_res_f_res_150671 = loopres_f_res_f_res_f_res_150692;
                                        loopres_f_res_f_res_150672 = loopres_f_res_f_res_f_res_150693;
                                        loopres_f_res_f_res_150673 = loopres_f_res_f_res_f_res_150694;
                                        loopres_f_res_f_res_150674 = loopres_f_res_f_res_f_res_150695;
                                    }
                                    loopres_f_res_150649 = loopres_f_res_f_res_150671;
                                    loopres_f_res_150650 = loopres_f_res_f_res_150672;
                                    loopres_f_res_150651 = loopres_f_res_f_res_150673;
                                    loopres_f_res_150652 = loopres_f_res_f_res_150674;
                                }
                                loopres_150644 = loopres_f_res_150649;
                                loopres_150645 = loopres_f_res_150650;
                                loopres_150646 = loopres_f_res_150651;
                                loopres_150647 = loopres_f_res_150652;
                            }
                            
                            bool loop_while_tmp_165728 = loopres_150647;
                            int64_t p_tmp_165729 = loopres_150644;
                            int64_t p_tmp_165730 = loopres_150645;
                            int64_t p_tmp_165731 = loopres_150646;
                            
                            loop_while_150626 = loop_while_tmp_165728;
                            p_150627 = p_tmp_165729;
                            p_150628 = p_tmp_165730;
                            p_150629 = p_tmp_165731;
                        }
                        defunc_0_f_res_150622 = loop_while_150626;
                        defunc_0_f_res_150623 = p_150627;
                        defunc_0_f_res_150624 = p_150628;
                        defunc_0_f_res_150625 = p_150629;
                        ((int64_t *) mem_164952.mem)[i_164726] = defunc_0_f_res_150624;
                        ((int64_t *) mem_164954.mem)[i_164726] = defunc_0_f_res_150625;
                    }
                    
                    int64_t bytes_164968 = (int64_t) 8 * ret_150812;
                    
                    if (cond_150810) {
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164952, "mem_164952") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164954, "mem_164954") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc(ctx, &mem_164971, bytes_164968, "mem_164971")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_165740 = 0; nest_i_165740 < (int64_t) 1; nest_i_165740++) {
                            ((int64_t *) mem_164971.mem)[nest_i_165740] = (int64_t) 0;
                        }
                        if (memblock_alloc(ctx, &mem_164969, bytes_164968, "mem_164969")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t tmp_offs_165741 = (int64_t) 0;
                        
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        tmp_offs_165741 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165741, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165741 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        
                        int64_t tmp_offs_165742 = (int64_t) 0;
                        
                        if (!(tmp_offs_165742 == (int64_t) 0)) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164971.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
                        }
                        tmp_offs_165742 += (int64_t) 1;
                        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164971.mem, tmp_offs_165742, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164954.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601});
                        tmp_offs_165742 += dzlz7bUZLzmZRz20UZLupToThreadZRz20UZLfirstThrZRz7dUzg_150601;
                        if (memblock_set(ctx, &ext_mem_164977, &mem_164969, "mem_164969") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_164974, &mem_164971, "mem_164971") != 0)
                            return 1;
                    }
                    if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
                        return 1;
                    if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
                        return 1;
                    
                    int64_t tmp_150827 = add64((int64_t) 1, p_150595);
                    
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164942, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164977.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164944, start_150598, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164974.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ret_150812});
                    if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
                        return 1;
                    
                    bool loop_cond_150840 = slt64(tmp_150827, numberOfWindows_116237);
                    bool loop_while_tmp_165722 = loop_cond_150840;
                    int64_t p_tmp_165723 = tmp_150827;
                    
                    loop_while_150594 = loop_while_tmp_165722;
                    p_150595 = p_tmp_165723;
                }
                defunc_0_windowed_partitionFunc_res_150590 = loop_while_150594;
                defunc_0_windowed_partitionFunc_res_150591 = p_150595;
                if (mem_164985_cached_sizze_166124 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164985, &mem_164985_cached_sizze_166124, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_164987_cached_sizze_166125 < bytes_164941) {
                    err = lexical_realloc(ctx, &mem_164987, &mem_164987_cached_sizze_166125, bytes_164941);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_164733 = 0; i_164733 < dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569; i_164733++) {
                    int64_t eta_p_150847 = ((int64_t *) mem_164942)[i_164733];
                    int64_t min_res_150848 = smin64(gt_rhs_150410, eta_p_150847);
                    bool x_150849 = sle64((int64_t) 0, min_res_150848);
                    bool y_150850 = slt64(min_res_150848, nR_116230);
                    bool bounds_check_150851 = x_150849 && y_150850;
                    bool index_certs_150852;
                    
                    if (!bounds_check_150851) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150848, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:274:19-41\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool cond_150854 = i_164733 == zeze_rhs_150843;
                    int64_t ri_next_150855;
                    
                    if (cond_150854) {
                        ri_next_150855 = nR_116230;
                    } else {
                        int64_t tmp_150856 = add64((int64_t) 1, i_164733);
                        bool x_150857 = sle64((int64_t) 0, tmp_150856);
                        bool y_150858 = slt64(tmp_150856, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150859 = x_150857 && y_150858;
                        bool index_certs_150860;
                        
                        if (!bounds_check_150859) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150856, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:275:44-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t ri_next_f_res_150861 = ((int64_t *) mem_164942)[tmp_150856];
                        
                        ri_next_150855 = ri_next_f_res_150861;
                    }
                    
                    int64_t max_arg1_150862 = sub64(ri_next_150855, (int64_t) 1);
                    int64_t max_res_150863 = smax64((int64_t) 0, max_arg1_150862);
                    bool x_150864 = sle64((int64_t) 0, max_res_150863);
                    bool y_150865 = slt64(max_res_150863, nR_116230);
                    bool bounds_check_150866 = x_150864 && y_150865;
                    bool index_certs_150867;
                    
                    if (!bounds_check_150866) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150863, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:276:19-46\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t r_min_150853 = ((int16_t *) tR_mem_164928.mem)[min_res_150848];
                    int16_t r_max_150868 = ((int16_t *) tR_mem_164928.mem)[max_res_150863];
                    bool defunc_0_f_res_150869;
                    int64_t defunc_0_f_res_150870;
                    bool loop_while_150871;
                    int64_t fm_150872;
                    
                    loop_while_150871 = 1;
                    fm_150872 = i_164733;
                    while (loop_while_150871) {
                        bool x_150873 = sle64((int64_t) 0, fm_150872);
                        bool y_150874 = slt64(fm_150872, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150875 = x_150873 && y_150874;
                        bool index_certs_150876;
                        
                        if (!bounds_check_150875) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) fm_150872, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:281:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150877 = ((int64_t *) mem_164944)[fm_150872];
                        int64_t min_res_150878 = smin64(gt_rhs_150410, loopres_150877);
                        bool x_150879 = sle64((int64_t) 0, min_res_150878);
                        bool y_150880 = slt64(min_res_150878, nR_116230);
                        bool bounds_check_150881 = x_150879 && y_150880;
                        bool index_certs_150882;
                        
                        if (!bounds_check_150881) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150878, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:282:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150884 = sle64(zeze_rhs_150843, fm_150872);
                        int64_t si_next_150885;
                        
                        if (cond_150884) {
                            si_next_150885 = nR_116230;
                        } else {
                            int64_t tmp_150886 = add64((int64_t) 1, fm_150872);
                            bool x_150887 = sle64((int64_t) 0, tmp_150886);
                            bool y_150888 = slt64(tmp_150886, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150889 = x_150887 && y_150888;
                            bool index_certs_150890;
                            
                            if (!bounds_check_150889) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150886, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:283:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150891 = ((int64_t *) mem_164944)[tmp_150886];
                            
                            si_next_150885 = si_next_f_res_150891;
                        }
                        
                        int64_t max_arg1_150892 = sub64(si_next_150885, (int64_t) 1);
                        int64_t max_res_150893 = smax64(min_res_150878, max_arg1_150892);
                        bool x_150894 = sle64((int64_t) 0, max_res_150893);
                        bool y_150895 = slt64(max_res_150893, nR_116230);
                        bool bounds_check_150896 = x_150894 && y_150895;
                        bool index_certs_150897;
                        
                        if (!bounds_check_150896) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150893, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:284:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150899 = smin64(zeze_rhs_150843, si_next_150885);
                        bool x_150900 = sle64((int64_t) 0, min_res_150899);
                        bool y_150901 = slt64(min_res_150899, nR_116230);
                        bool bounds_check_150902 = x_150900 && y_150901;
                        bool index_certs_150903;
                        
                        if (!bounds_check_150902) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150899, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:285:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150905 = sub64(min_res_150878, (int64_t) 1);
                        int64_t max_res_150906 = smax64((int64_t) 0, max_arg1_150905);
                        bool x_150907 = sle64((int64_t) 0, max_res_150906);
                        bool y_150908 = slt64(max_res_150906, nR_116230);
                        bool bounds_check_150909 = x_150907 && y_150908;
                        bool index_certs_150910;
                        
                        if (!bounds_check_150909) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150906, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:286:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151506 = tS_start_150427 + min_res_150878;
                        int16_t s_min_150883 = ((int16_t *) tS_mem_164929.mem)[slice_151506];
                        int64_t slice_151505 = tS_start_150427 + max_res_150893;
                        int16_t s_max_150898 = ((int16_t *) tS_mem_164929.mem)[slice_151505];
                        int64_t slice_151504 = tS_start_150427 + min_res_150899;
                        int16_t s_nextMin_150904 = ((int16_t *) tS_mem_164929.mem)[slice_151504];
                        int64_t slice_151503 = tS_start_150427 + max_res_150906;
                        int16_t s_prevMax_150911 = ((int16_t *) tS_mem_164929.mem)[slice_151503];
                        bool defunc_0_gt_res_150912 = slt16(s_min_150883, r_min_150853);
                        bool loopres_150913;
                        int64_t loopres_150914;
                        
                        if (defunc_0_gt_res_150912) {
                            bool defunc_0_leq_res_157760 = sle16(r_min_150853, s_max_150898);
                            bool loopres_t_res_157761;
                            int64_t loopres_t_res_157762;
                            
                            if (defunc_0_leq_res_157760) {
                                loopres_t_res_157761 = 0;
                                loopres_t_res_157762 = fm_150872;
                            } else {
                                bool defunc_0_leq_res_157763 = sle16(r_min_150853, s_nextMin_150904);
                                int64_t zgze_lhs_157764 = add64((int64_t) 1, fm_150872);
                                bool tmp_f_res_157765 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, zgze_lhs_157764);
                                bool x_157766 = !defunc_0_leq_res_157763;
                                bool y_157767 = tmp_f_res_157765 && x_157766;
                                bool tmp_157768 = defunc_0_leq_res_157763 || y_157767;
                                bool loopres_t_res_f_res_157769 = !tmp_157768;
                                
                                loopres_t_res_157761 = loopres_t_res_f_res_157769;
                                loopres_t_res_157762 = zgze_lhs_157764;
                            }
                            loopres_150913 = loopres_t_res_157761;
                            loopres_150914 = loopres_t_res_157762;
                        } else {
                            bool defunc_0_leq_res_150925 = sle16(s_prevMax_150911, r_min_150853);
                            int64_t zlze_lhs_150926 = sub64(fm_150872, (int64_t) 1);
                            bool tmp_f_res_150927 = sle64(zlze_lhs_150926, (int64_t) 0);
                            bool x_150928 = !defunc_0_leq_res_150925;
                            bool y_150929 = tmp_f_res_150927 && x_150928;
                            bool tmp_150930 = defunc_0_leq_res_150925 || y_150929;
                            int64_t max_res_150931 = smax64((int64_t) 0, zlze_lhs_150926);
                            bool loopres_f_res_150932 = !tmp_150930;
                            
                            loopres_150913 = loopres_f_res_150932;
                            loopres_150914 = max_res_150931;
                        }
                        
                        bool loop_while_tmp_165745 = loopres_150913;
                        int64_t fm_tmp_165746 = loopres_150914;
                        
                        loop_while_150871 = loop_while_tmp_165745;
                        fm_150872 = fm_tmp_165746;
                    }
                    defunc_0_f_res_150869 = loop_while_150871;
                    defunc_0_f_res_150870 = fm_150872;
                    
                    bool defunc_0_f_res_150934;
                    int64_t defunc_0_f_res_150935;
                    bool loop_while_150936;
                    int64_t lm_150937;
                    
                    loop_while_150936 = 1;
                    lm_150937 = i_164733;
                    while (loop_while_150936) {
                        bool x_150938 = sle64((int64_t) 0, lm_150937);
                        bool y_150939 = slt64(lm_150937, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool bounds_check_150940 = x_150938 && y_150939;
                        bool index_certs_150941;
                        
                        if (!bounds_check_150940) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lm_150937, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:297:36-61\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t loopres_150942 = ((int64_t *) mem_164944)[lm_150937];
                        int64_t min_res_150943 = smin64(gt_rhs_150410, loopres_150942);
                        bool x_150944 = sle64((int64_t) 0, min_res_150943);
                        bool y_150945 = slt64(min_res_150943, nR_116230);
                        bool bounds_check_150946 = x_150944 && y_150945;
                        bool index_certs_150947;
                        
                        if (!bounds_check_150946) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150943, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:298:23-29\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_150949 = sle64(zeze_rhs_150843, lm_150937);
                        int64_t si_next_150950;
                        
                        if (cond_150949) {
                            si_next_150950 = nR_116230;
                        } else {
                            int64_t tmp_150951 = add64((int64_t) 1, lm_150937);
                            bool x_150952 = sle64((int64_t) 0, tmp_150951);
                            bool y_150953 = slt64(tmp_150951, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                            bool bounds_check_150954 = x_150952 && y_150953;
                            bool index_certs_150955;
                            
                            if (!bounds_check_150954) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_150951, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:299:56-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t si_next_f_res_150956 = ((int64_t *) mem_164944)[tmp_150951];
                            
                            si_next_150950 = si_next_f_res_150956;
                        }
                        
                        int64_t max_arg1_150957 = sub64(si_next_150950, (int64_t) 1);
                        int64_t max_res_150958 = smax64(min_res_150943, max_arg1_150957);
                        bool x_150959 = sle64((int64_t) 0, max_res_150958);
                        bool y_150960 = slt64(max_res_150958, nR_116230);
                        bool bounds_check_150961 = x_150959 && y_150960;
                        bool index_certs_150962;
                        
                        if (!bounds_check_150961) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150958, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:300:23-51\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t min_res_150964 = smin64(zeze_rhs_150843, si_next_150950);
                        bool x_150965 = sle64((int64_t) 0, min_res_150964);
                        bool y_150966 = slt64(min_res_150964, nR_116230);
                        bool bounds_check_150967 = x_150965 && y_150966;
                        bool index_certs_150968;
                        
                        if (!bounds_check_150967) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_150964, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:301:27-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t max_arg1_150970 = sub64(min_res_150943, (int64_t) 1);
                        int64_t max_res_150971 = smax64((int64_t) 0, max_arg1_150970);
                        bool x_150972 = sle64((int64_t) 0, max_res_150971);
                        bool y_150973 = slt64(max_res_150971, nR_116230);
                        bool bounds_check_150974 = x_150972 && y_150973;
                        bool index_certs_150975;
                        
                        if (!bounds_check_150974) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) max_res_150971, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:302:27-49\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:273:8-311:6\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t slice_151502 = tS_start_150427 + min_res_150943;
                        int16_t s_min_150948 = ((int16_t *) tS_mem_164929.mem)[slice_151502];
                        int64_t slice_151501 = tS_start_150427 + max_res_150958;
                        int16_t s_max_150963 = ((int16_t *) tS_mem_164929.mem)[slice_151501];
                        int64_t slice_151500 = tS_start_150427 + min_res_150964;
                        int16_t s_nextMin_150969 = ((int16_t *) tS_mem_164929.mem)[slice_151500];
                        int64_t slice_151499 = tS_start_150427 + max_res_150971;
                        int16_t s_prevMax_150976 = ((int16_t *) tS_mem_164929.mem)[slice_151499];
                        bool defunc_0_gt_res_150977 = slt16(r_max_150868, s_max_150963);
                        bool loopres_150978;
                        int64_t loopres_150979;
                        
                        if (defunc_0_gt_res_150977) {
                            bool defunc_0_leq_res_157770 = sle16(s_min_150948, r_max_150868);
                            bool loopres_t_res_157771;
                            int64_t loopres_t_res_157772;
                            
                            if (defunc_0_leq_res_157770) {
                                loopres_t_res_157771 = 0;
                                loopres_t_res_157772 = lm_150937;
                            } else {
                                bool defunc_0_leq_res_157773 = sle16(s_prevMax_150976, r_max_150868);
                                int64_t zlze_lhs_157774 = sub64(lm_150937, (int64_t) 1);
                                bool tmp_f_res_157775 = sle64(zlze_lhs_157774, (int64_t) 0);
                                bool x_157776 = !defunc_0_leq_res_157773;
                                bool y_157777 = tmp_f_res_157775 && x_157776;
                                bool tmp_157778 = defunc_0_leq_res_157773 || y_157777;
                                int64_t max_res_157779 = smax64((int64_t) 0, zlze_lhs_157774);
                                bool loopres_t_res_f_res_157780 = !tmp_157778;
                                
                                loopres_t_res_157771 = loopres_t_res_f_res_157780;
                                loopres_t_res_157772 = max_res_157779;
                            }
                            loopres_150978 = loopres_t_res_157771;
                            loopres_150979 = loopres_t_res_157772;
                        } else {
                            bool defunc_0_leq_res_150991 = sle16(r_max_150868, s_nextMin_150969);
                            int64_t tmp_150992 = add64((int64_t) 1, lm_150937);
                            bool loopres_f_res_150993 = !defunc_0_leq_res_150991;
                            
                            loopres_150978 = loopres_f_res_150993;
                            loopres_150979 = tmp_150992;
                        }
                        
                        bool loop_cond_t_res_150994 = slt64(loopres_150979, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                        bool x_150995 = loopres_150978 && loop_cond_t_res_150994;
                        bool loop_while_tmp_165747 = x_150995;
                        int64_t lm_tmp_165748 = loopres_150979;
                        
                        loop_while_150936 = loop_while_tmp_165747;
                        lm_150937 = lm_tmp_165748;
                    }
                    defunc_0_f_res_150934 = loop_while_150936;
                    defunc_0_f_res_150935 = lm_150937;
                    ((int64_t *) mem_164985)[i_164733] = defunc_0_f_res_150870;
                    ((int64_t *) mem_164987)[i_164733] = defunc_0_f_res_150935;
                }
                
                int64_t ext_165121;
                int64_t ext_165120;
                int64_t ext_165119;
                int64_t ext_165118;
                bool defunc_0_join_chunks_res_150999;
                int64_t defunc_0_join_chunks_res_151000;
                bool loop_while_151003;
                int64_t p_151004;
                int64_t ctx_param_ext_165000;
                int64_t ctx_param_ext_165001;
                int64_t ctx_param_ext_165003;
                int64_t ctx_param_ext_165004;
                
                if (memblock_set(ctx, &mem_param_165002, &mem_164934, "mem_164934") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_165005, &mem_164932, "mem_164932") != 0)
                    return 1;
                ctx_param_ext_165000 = (int64_t) 0;
                ctx_param_ext_165001 = (int64_t) 1;
                ctx_param_ext_165003 = (int64_t) 0;
                ctx_param_ext_165004 = (int64_t) 1;
                loop_while_151003 = loop_cond_150998;
                p_151004 = (int64_t) 0;
                while (loop_while_151003) {
                    bool x_151007 = sle64((int64_t) 0, p_151004);
                    bool y_151008 = slt64(p_151004, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151009 = x_151007 && y_151008;
                    bool index_certs_151010;
                    
                    if (!bounds_check_151009) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:334:22-34\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t loopres_151011 = ((int64_t *) mem_164985)[p_151004];
                    int64_t loopres_151012 = ((int64_t *) mem_164987)[p_151004];
                    int64_t min_res_151013 = smin64(zeze_rhs_150843, loopres_151012);
                    bool cond_151014 = sle64(dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, loopres_151011);
                    bool cond_151018 = slt64(min_res_151013, (int64_t) 0);
                    bool protect_assert_disj_151020 = bounds_check_151009 || cond_151018;
                    bool protect_assert_disj_165535 = cond_151014 || protect_assert_disj_151020;
                    bool index_certs_151021;
                    
                    if (!protect_assert_disj_165535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151004, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:338:19-32\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t zeze_lhs_151024 = add64((int64_t) 1, p_151004);
                    bool cond_151025 = zeze_lhs_151024 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    bool x_151027 = sle64((int64_t) 0, zeze_lhs_151024);
                    bool y_151028 = slt64(zeze_lhs_151024, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    bool bounds_check_151029 = x_151027 && y_151028;
                    bool protect_assert_disj_151030 = cond_151025 || bounds_check_151029;
                    bool protect_assert_disj_151031 = cond_151018 || protect_assert_disj_151030;
                    bool protect_assert_disj_165538 = cond_151014 || protect_assert_disj_151031;
                    bool index_certs_151032;
                    
                    if (!protect_assert_disj_165538) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151024, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:339:49-64\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool x_165532 = !cond_151014;
                    bool x_151019 = !cond_151018;
                    bool protect_cond_conj_165536 = x_151019 && x_165532;
                    int64_t loopres_f_res_f_res_151022;
                    
                    if (protect_cond_conj_165536) {
                        int64_t x_157781 = ((int64_t *) mem_164942)[p_151004];
                        
                        loopres_f_res_f_res_151022 = x_157781;
                    } else {
                        loopres_f_res_f_res_151022 = (int64_t) 0;
                    }
                    
                    bool x_151026 = !cond_151025;
                    bool protect_cond_conj_151033 = x_151019 && x_151026;
                    bool protect_cond_conj_165539 = protect_cond_conj_151033 && x_165532;
                    int64_t r_end_f_res_151034;
                    
                    if (protect_cond_conj_165539) {
                        int64_t x_157782 = ((int64_t *) mem_164942)[zeze_lhs_151024];
                        
                        r_end_f_res_151034 = x_157782;
                    } else {
                        r_end_f_res_151034 = (int64_t) 0;
                    }
                    
                    int64_t r_end_151036;
                    
                    if (cond_151025) {
                        r_end_151036 = nR_116230;
                    } else {
                        r_end_151036 = r_end_f_res_151034;
                    }
                    
                    int64_t dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 = sub64(r_end_151036, loopres_f_res_f_res_151022);
                    int64_t ext_165110;
                    
                    if (cond_151018) {
                        ext_165110 = ctx_param_ext_165000;
                    } else {
                        ext_165110 = (int64_t) 0;
                    }
                    
                    int64_t ext_165109;
                    
                    if (cond_151018) {
                        ext_165109 = ctx_param_ext_165001;
                    } else {
                        ext_165109 = (int64_t) 1;
                    }
                    
                    int64_t ext_165107;
                    
                    if (cond_151018) {
                        ext_165107 = ctx_param_ext_165003;
                    } else {
                        ext_165107 = (int64_t) 0;
                    }
                    
                    int64_t ext_165106;
                    
                    if (cond_151018) {
                        ext_165106 = ctx_param_ext_165004;
                    } else {
                        ext_165106 = (int64_t) 1;
                    }
                    
                    int64_t bytes_165006 = (int64_t) 8 * dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037;
                    int64_t ext_165116;
                    
                    if (cond_151014) {
                        ext_165116 = ctx_param_ext_165000;
                    } else {
                        ext_165116 = ext_165110;
                    }
                    
                    int64_t ext_165115;
                    
                    if (cond_151014) {
                        ext_165115 = ctx_param_ext_165001;
                    } else {
                        ext_165115 = ext_165109;
                    }
                    
                    int64_t ext_165113;
                    
                    if (cond_151014) {
                        ext_165113 = ctx_param_ext_165003;
                    } else {
                        ext_165113 = ext_165107;
                    }
                    
                    int64_t ext_165112;
                    
                    if (cond_151014) {
                        ext_165112 = ctx_param_ext_165004;
                    } else {
                        ext_165112 = ext_165106;
                    }
                    
                    int64_t loopres_151015;
                    
                    if (cond_151014) {
                        loopres_151015 = dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                    } else {
                        loopres_151015 = zeze_lhs_151024;
                    }
                    if (cond_151014) {
                        if (memblock_set(ctx, &ext_mem_165117, &mem_param_165002, "mem_param_165002") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &mem_param_165005, "mem_param_165005") != 0)
                            return 1;
                    } else {
                        if (cond_151018) {
                            if (memblock_set(ctx, &ext_mem_165111, &mem_param_165002, "mem_param_165002") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_param_165005, "mem_param_165005") != 0)
                                return 1;
                        } else {
                            bool empty_slice_151040 = dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037 == (int64_t) 0;
                            int64_t m_151041 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, (int64_t) 1);
                            int64_t i_p_m_t_s_151042 = add64(loopres_f_res_f_res_151022, m_151041);
                            bool zzero_leq_i_p_m_t_s_151043 = sle64((int64_t) 0, i_p_m_t_s_151042);
                            bool i_p_m_t_s_leq_w_151044 = slt64(i_p_m_t_s_151042, nR_116230);
                            bool zzero_lte_i_151045 = sle64((int64_t) 0, loopres_f_res_f_res_151022);
                            bool i_lte_j_151046 = sle64(loopres_f_res_f_res_151022, r_end_151036);
                            bool y_151047 = i_p_m_t_s_leq_w_151044 && zzero_lte_i_151045;
                            bool y_151048 = zzero_leq_i_p_m_t_s_151043 && y_151047;
                            bool forwards_ok_151049 = i_lte_j_151046 && y_151048;
                            bool ok_or_empty_151050 = empty_slice_151040 || forwards_ok_151049;
                            bool index_certs_151051;
                            
                            if (!ok_or_empty_151050) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_f_res_f_res_151022, ":", (long long) r_end_151036, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:340:16-33\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool loop_cond_151054 = sle64(loopres_151011, min_res_151013);
                            bool loop_not_taken_151059 = !loop_cond_151054;
                            bool protect_assert_disj_151060 = loop_not_taken_151059 || nonzzero_157453;
                            bool nonzzero_cert_151061;
                            
                            if (!protect_assert_disj_151060) {
                                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:216:39-55\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165759 = 0; nest_i_165759 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165759++) {
                                ((int64_t *) mem_165007.mem)[nest_i_165759] = (int64_t) -1;
                            }
                            if (memblock_alloc(ctx, &mem_165009, bytes_165006, "mem_165009")) {
                                err = 1;
                                goto cleanup;
                            }
                            for (int64_t nest_i_165760 = 0; nest_i_165760 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; nest_i_165760++) {
                                ((int64_t *) mem_165009.mem)[nest_i_165760] = (int64_t) 0;
                            }
                            
                            int64_t zm_lhs_151055 = add64(extParallelism_116238, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                            int64_t zs_lhs_151056 = sub64(zm_lhs_151055, (int64_t) 1);
                            int64_t numIter_151062 = sdiv_safe64(zs_lhs_151056, extParallelism_116238);
                            bool loop_cond_151063 = slt64((int64_t) 0, numIter_151062);
                            bool loop_not_taken_151064 = !loop_cond_151063;
                            bool loopres_f_res_f_res_151065;
                            int64_t loopres_f_res_f_res_151066;
                            bool loop_while_151069;
                            int64_t dp_151070;
                            
                            if (memblock_set(ctx, &mem_param_165012, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (memblock_set(ctx, &mem_param_165015, &mem_165007, "mem_165007") != 0)
                                return 1;
                            loop_while_151069 = loop_cond_151054;
                            dp_151070 = loopres_151011;
                            while (loop_while_151069) {
                                bool x_151073 = sle64((int64_t) 0, dp_151070);
                                bool y_151074 = slt64(dp_151070, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151075 = x_151073 && y_151074;
                                bool index_certs_151076;
                                
                                if (!bounds_check_151075) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) dp_151070, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:344:21-38\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t loopres_151077 = ((int64_t *) mem_164944)[dp_151070];
                                int64_t zeze_lhs_151078 = add64((int64_t) 1, dp_151070);
                                bool cond_151079 = zeze_lhs_151078 == dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569;
                                bool x_151080 = !cond_151079;
                                bool x_151081 = sle64((int64_t) 0, zeze_lhs_151078);
                                bool y_151082 = slt64(zeze_lhs_151078, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                                bool bounds_check_151083 = x_151081 && y_151082;
                                bool protect_assert_disj_151084 = cond_151079 || bounds_check_151083;
                                bool index_certs_151085;
                                
                                if (!protect_assert_disj_151084) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_lhs_151078, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569, "].", "-> #0  ftSMJ.fut:345:55-74\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t s_end_f_res_151086;
                                
                                if (x_151080) {
                                    int64_t x_157783 = ((int64_t *) mem_164944)[zeze_lhs_151078];
                                    
                                    s_end_f_res_151086 = x_157783;
                                } else {
                                    s_end_f_res_151086 = (int64_t) 0;
                                }
                                
                                int64_t s_end_151088;
                                
                                if (cond_151079) {
                                    s_end_151088 = nR_116230;
                                } else {
                                    s_end_151088 = s_end_f_res_151086;
                                }
                                
                                int64_t j_m_i_151089 = sub64(s_end_151088, loopres_151077);
                                bool empty_slice_151090 = j_m_i_151089 == (int64_t) 0;
                                int64_t m_151091 = sub64(j_m_i_151089, (int64_t) 1);
                                int64_t i_p_m_t_s_151092 = add64(loopres_151077, m_151091);
                                bool zzero_leq_i_p_m_t_s_151093 = sle64((int64_t) 0, i_p_m_t_s_151092);
                                bool i_p_m_t_s_leq_w_151094 = slt64(i_p_m_t_s_151092, nR_116230);
                                bool zzero_lte_i_151095 = sle64((int64_t) 0, loopres_151077);
                                bool i_lte_j_151096 = sle64(loopres_151077, s_end_151088);
                                bool y_151097 = i_p_m_t_s_leq_w_151094 && zzero_lte_i_151095;
                                bool y_151098 = zzero_leq_i_p_m_t_s_151093 && y_151097;
                                bool forwards_ok_151099 = i_lte_j_151096 && y_151098;
                                bool ok_or_empty_151100 = empty_slice_151090 || forwards_ok_151099;
                                bool index_certs_151101;
                                
                                if (!ok_or_empty_151100) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151077, ":", (long long) s_end_151088, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  ftSMJ.fut:346:18-35\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool cond_151104 = slt64((int64_t) 0, j_m_i_151089);
                                bool loop_not_taken_151105 = !cond_151104;
                                bool x_151106 = sle64((int64_t) 0, m_151091);
                                bool y_151107 = slt64(m_151091, j_m_i_151089);
                                bool bounds_check_151111 = x_151106 && y_151107;
                                bool protect_assert_disj_151112 = loop_not_taken_151105 || bounds_check_151111;
                                bool protect_assert_disj_151113 = loop_not_taken_151064 || protect_assert_disj_151112;
                                bool index_certs_151114;
                                
                                if (!protect_assert_disj_151113) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151091, "] out of bounds for array of shape [", (long long) j_m_i_151089, "].", "-> #0  ftSMJ.fut:228:34-42\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_151498 = tS_start_150427 + loopres_151077;
                                int64_t find_joinTuples_arg3_151103 = add64(join_chunks_arg3_150568, loopres_151077);
                                bool protect_cond_conj_151108 = loop_cond_151063 && cond_151104;
                                int16_t s_min_t_res_151109;
                                
                                if (protect_cond_conj_151108) {
                                    int16_t x_157784 = ((int16_t *) tS_mem_164929.mem)[slice_151498];
                                    
                                    s_min_t_res_151109 = x_157784;
                                } else {
                                    s_min_t_res_151109 = (int16_t) 0;
                                }
                                
                                int16_t s_max_t_res_151115;
                                
                                if (protect_cond_conj_151108) {
                                    int64_t slice_157785 = tS_start_150427 + i_p_m_t_s_151092;
                                    int16_t x_157786 = ((int16_t *) tS_mem_164929.mem)[slice_157785];
                                    
                                    s_max_t_res_151115 = x_157786;
                                } else {
                                    s_max_t_res_151115 = (int16_t) 0;
                                }
                                
                                int64_t bytes_165022 = (int64_t) 2 * j_m_i_151089;
                                int64_t ext_165061;
                                int64_t ext_165060;
                                int64_t ext_165059;
                                int64_t ext_165058;
                                bool defunc_0_find_joinTuples_res_151117;
                                int64_t defunc_0_find_joinTuples_res_151118;
                                bool loop_while_151121;
                                int64_t p_151122;
                                int64_t ctx_param_ext_165016;
                                int64_t ctx_param_ext_165017;
                                int64_t ctx_param_ext_165019;
                                int64_t ctx_param_ext_165020;
                                
                                if (memblock_set(ctx, &mem_param_165018, &mem_165009, "mem_165009") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165021, &mem_165007, "mem_165007") != 0)
                                    return 1;
                                ctx_param_ext_165016 = (int64_t) 0;
                                ctx_param_ext_165017 = (int64_t) 1;
                                ctx_param_ext_165019 = (int64_t) 0;
                                ctx_param_ext_165020 = (int64_t) 1;
                                loop_while_151121 = loop_cond_151063;
                                p_151122 = (int64_t) 0;
                                while (loop_while_151121) {
                                    int64_t start_151125 = mul64(extParallelism_116238, p_151122);
                                    int64_t min_arg1_151126 = sub64(dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, start_151125);
                                    int64_t min_res_151127 = smin64(extParallelism_116238, min_arg1_151126);
                                    int64_t iter_R_151128 = add64(start_151125, min_res_151127);
                                    bool empty_slice_151129 = min_res_151127 == (int64_t) 0;
                                    int64_t m_151130 = sub64(min_res_151127, (int64_t) 1);
                                    int64_t i_p_m_t_s_151131 = add64(start_151125, m_151130);
                                    bool zzero_leq_i_p_m_t_s_151132 = sle64((int64_t) 0, i_p_m_t_s_151131);
                                    bool i_p_m_t_s_leq_w_151133 = slt64(i_p_m_t_s_151131, dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037);
                                    bool zzero_lte_i_151134 = sle64((int64_t) 0, start_151125);
                                    bool i_lte_j_151135 = sle64(start_151125, iter_R_151128);
                                    bool y_151136 = i_p_m_t_s_leq_w_151133 && zzero_lte_i_151134;
                                    bool y_151137 = zzero_leq_i_p_m_t_s_151132 && y_151136;
                                    bool forwards_ok_151138 = i_lte_j_151135 && y_151137;
                                    bool ok_or_empty_151139 = empty_slice_151129 || forwards_ok_151138;
                                    bool index_certs_151140;
                                    
                                    if (!ok_or_empty_151139) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_151125, ":", (long long) iter_R_151128, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037, "].", "-> #0  ftSMJ.fut:223:20-49\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151147 = slt64(m_151130, min_res_151127);
                                    bool x_151146 = sle64((int64_t) 0, m_151130);
                                    bool bounds_check_151148 = x_151146 && y_151147;
                                    bool index_certs_151149;
                                    
                                    if (!bounds_check_151148) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151130, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:226:21-40\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool y_151143 = slt64((int64_t) 0, min_res_151127);
                                    bool index_certs_151144;
                                    
                                    if (!y_151143) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) min_res_151127, "].", "-> #0  ftSMJ.fut:225:21-30\n   #1  ftRelational.fut:158:133-136\n   #2  ftRelational.fut:147:1-158:136\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_151141 = loopres_f_res_f_res_151022 + start_151125;
                                    int64_t slice_151150 = loopres_f_res_f_res_151022 + i_p_m_t_s_151131;
                                    int16_t r_max_151151 = ((int16_t *) tR_mem_164928.mem)[slice_151150];
                                    int16_t s_max_151153;
                                    
                                    if (cond_151104) {
                                        s_max_151153 = s_max_t_res_151115;
                                    } else {
                                        s_max_151153 = r_max_151151;
                                    }
                                    
                                    int16_t r_min_151145 = ((int16_t *) tR_mem_164928.mem)[slice_151141];
                                    bool defunc_0_gt_res_151154 = slt16(s_max_151153, r_min_151145);
                                    int16_t s_min_151152;
                                    
                                    if (cond_151104) {
                                        s_min_151152 = s_min_t_res_151109;
                                    } else {
                                        s_min_151152 = r_min_151145;
                                    }
                                    
                                    bool defunc_0_gt_res_151158 = slt16(r_max_151151, s_min_151152);
                                    int64_t ext_165050;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165050 = ctx_param_ext_165016;
                                    } else {
                                        ext_165050 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165049;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165049 = ctx_param_ext_165017;
                                    } else {
                                        ext_165049 = (int64_t) 1;
                                    }
                                    
                                    int64_t ext_165047;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165047 = ctx_param_ext_165019;
                                    } else {
                                        ext_165047 = (int64_t) 0;
                                    }
                                    
                                    int64_t ext_165046;
                                    
                                    if (defunc_0_gt_res_151158) {
                                        ext_165046 = ctx_param_ext_165020;
                                    } else {
                                        ext_165046 = (int64_t) 1;
                                    }
                                    
                                    int64_t bytes_165026 = (int64_t) 8 * min_res_151127;
                                    int64_t ext_165056;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165056 = ctx_param_ext_165016;
                                    } else {
                                        ext_165056 = ext_165050;
                                    }
                                    
                                    int64_t ext_165055;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165055 = ctx_param_ext_165017;
                                    } else {
                                        ext_165055 = ext_165049;
                                    }
                                    
                                    int64_t ext_165053;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165053 = ctx_param_ext_165019;
                                    } else {
                                        ext_165053 = ext_165047;
                                    }
                                    
                                    int64_t ext_165052;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        ext_165052 = ctx_param_ext_165020;
                                    } else {
                                        ext_165052 = ext_165046;
                                    }
                                    
                                    int64_t loopres_151155;
                                    
                                    if (defunc_0_gt_res_151154) {
                                        if (memblock_set(ctx, &ext_mem_165057, &mem_param_165018, "mem_param_165018") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &mem_param_165021, "mem_param_165021") != 0)
                                            return 1;
                                        loopres_151155 = numIter_151062;
                                    } else {
                                        int64_t loopres_f_res_151159;
                                        
                                        if (defunc_0_gt_res_151158) {
                                            int64_t tmp_157789 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_param_165018, "mem_param_165018") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_param_165021, "mem_param_165021") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_157789;
                                        } else {
                                            if (memblock_alloc(ctx, &mem_165023, bytes_165022, "mem_165023")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_2b(ctx, 1, (uint16_t *) mem_165023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) tS_mem_164929.mem, slice_151498, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151089});
                                            if (futrts_indicesWithIncrement_12141(ctx, &ext_mem_165025, mem_165023, j_m_i_151089, find_joinTuples_arg3_151103) != 0) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
                                                return 1;
                                            if (mem_165027_cached_sizze_166126 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165027, &mem_165027_cached_sizze_166126, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            if (mem_165029_cached_sizze_166127 < bytes_165026) {
                                                err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166127, bytes_165026);
                                                if (err != FUTHARK_SUCCESS)
                                                    goto cleanup;
                                            }
                                            for (int64_t i_164744 = 0; i_164744 < min_res_151127; i_164744++) {
                                                int64_t slice_164903 = slice_151141 + i_164744;
                                                int16_t eta_p_151167 = ((int16_t *) tR_mem_164928.mem)[slice_164903];
                                                int64_t defunc_0_reduce_comm_res_157790;
                                                int16_t defunc_0_reduce_comm_res_157791;
                                                int64_t defunc_0_reduce_comm_res_157792;
                                                int64_t redout_164736;
                                                int16_t redout_164737;
                                                int64_t redout_164738;
                                                
                                                redout_164736 = (int64_t) -1;
                                                redout_164737 = eta_p_151167;
                                                redout_164738 = (int64_t) 0;
                                                for (int64_t i_164739 = 0; i_164739 < j_m_i_151089; i_164739++) {
                                                    int64_t x_151171 = ((int64_t *) ext_mem_165025.mem)[i_164739];
                                                    int64_t slice_164902 = slice_151498 + i_164739;
                                                    int16_t x_151172 = ((int16_t *) tS_mem_164929.mem)[slice_164902];
                                                    bool defunc_0_neq_res_151180 = redout_164737 == eta_p_151167;
                                                    bool defunc_0_neq_res_151181 = !defunc_0_neq_res_151180;
                                                    bool cond_f_res_151182 = slt64(redout_164736, (int64_t) 0);
                                                    bool y_151183 = defunc_0_neq_res_151180 && cond_f_res_151182;
                                                    bool cond_151184 = defunc_0_neq_res_151181 || y_151183;
                                                    bool defunc_0_neq_res_151185 = x_151172 == eta_p_151167;
                                                    bool defunc_0_neq_res_151186 = !defunc_0_neq_res_151185;
                                                    bool cond_t_res_f_res_151187 = slt64(x_151171, (int64_t) 0);
                                                    bool y_151188 = defunc_0_neq_res_151185 && cond_t_res_f_res_151187;
                                                    bool cond_t_res_151189 = defunc_0_neq_res_151186 || y_151188;
                                                    bool x_151190 = cond_151184 && cond_t_res_151189;
                                                    int64_t defunc_0_op_res_151191;
                                                    int16_t defunc_0_op_res_151192;
                                                    int64_t defunc_0_op_res_151193;
                                                    
                                                    if (x_151190) {
                                                        defunc_0_op_res_151191 = (int64_t) -1;
                                                        defunc_0_op_res_151192 = eta_p_151167;
                                                        defunc_0_op_res_151193 = (int64_t) 0;
                                                    } else {
                                                        int64_t defunc_0_op_res_f_res_151194;
                                                        int16_t defunc_0_op_res_f_res_151195;
                                                        int64_t defunc_0_op_res_f_res_151196;
                                                        
                                                        if (cond_151184) {
                                                            defunc_0_op_res_f_res_151194 = x_151171;
                                                            defunc_0_op_res_f_res_151195 = x_151172;
                                                            defunc_0_op_res_f_res_151196 = (int64_t) 1;
                                                        } else {
                                                            int16_t defunc_0_op_res_f_res_f_res_151197;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151197 = redout_164737;
                                                            } else {
                                                                defunc_0_op_res_f_res_f_res_151197 = eta_p_151167;
                                                            }
                                                            
                                                            int64_t defunc_0_op_res_f_res_f_res_151198;
                                                            int64_t defunc_0_op_res_f_res_f_res_151199;
                                                            
                                                            if (cond_t_res_151189) {
                                                                defunc_0_op_res_f_res_f_res_151198 = redout_164736;
                                                                defunc_0_op_res_f_res_f_res_151199 = redout_164738;
                                                            } else {
                                                                int64_t min_res_151200 = smin64(x_151171, redout_164736);
                                                                int64_t tmp_151201 = add64((int64_t) 1, redout_164738);
                                                                
                                                                defunc_0_op_res_f_res_f_res_151198 = min_res_151200;
                                                                defunc_0_op_res_f_res_f_res_151199 = tmp_151201;
                                                            }
                                                            defunc_0_op_res_f_res_151194 = defunc_0_op_res_f_res_f_res_151198;
                                                            defunc_0_op_res_f_res_151195 = defunc_0_op_res_f_res_f_res_151197;
                                                            defunc_0_op_res_f_res_151196 = defunc_0_op_res_f_res_f_res_151199;
                                                        }
                                                        defunc_0_op_res_151191 = defunc_0_op_res_f_res_151194;
                                                        defunc_0_op_res_151192 = defunc_0_op_res_f_res_151195;
                                                        defunc_0_op_res_151193 = defunc_0_op_res_f_res_151196;
                                                    }
                                                    
                                                    int64_t redout_tmp_165779 = defunc_0_op_res_151191;
                                                    int16_t redout_tmp_165780 = defunc_0_op_res_151192;
                                                    int64_t redout_tmp_165781 = defunc_0_op_res_151193;
                                                    
                                                    redout_164736 = redout_tmp_165779;
                                                    redout_164737 = redout_tmp_165780;
                                                    redout_164738 = redout_tmp_165781;
                                                }
                                                defunc_0_reduce_comm_res_157790 = redout_164736;
                                                defunc_0_reduce_comm_res_157791 = redout_164737;
                                                defunc_0_reduce_comm_res_157792 = redout_164738;
                                                ((int64_t *) mem_165027)[i_164744] = defunc_0_reduce_comm_res_157790;
                                                ((int64_t *) mem_165029)[i_164744] = defunc_0_reduce_comm_res_157792;
                                            }
                                            if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
                                                return 1;
                                            if (memblock_alloc(ctx, &mem_165043, bytes_165006, "mem_165043")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165021.mem, ctx_param_ext_165019, (int64_t []) {ctx_param_ext_165020}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165043.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165027, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            if (memblock_alloc(ctx, &mem_165045, bytes_165006, "mem_165045")) {
                                                err = 1;
                                                goto cleanup;
                                            }
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165018.mem, ctx_param_ext_165016, (int64_t []) {ctx_param_ext_165017}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165045.mem, start_151125, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165029, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {min_res_151127});
                                            
                                            int64_t tmp_151206 = add64((int64_t) 1, p_151122);
                                            
                                            if (memblock_set(ctx, &ext_mem_165051, &mem_165045, "mem_165045") != 0)
                                                return 1;
                                            if (memblock_set(ctx, &ext_mem_165048, &mem_165043, "mem_165043") != 0)
                                                return 1;
                                            loopres_f_res_151159 = tmp_151206;
                                        }
                                        if (memblock_set(ctx, &ext_mem_165057, &ext_mem_165051, "ext_mem_165051") != 0)
                                            return 1;
                                        if (memblock_set(ctx, &ext_mem_165054, &ext_mem_165048, "ext_mem_165048") != 0)
                                            return 1;
                                        loopres_151155 = loopres_f_res_151159;
                                    }
                                    
                                    bool loop_cond_151207 = slt64(loopres_151155, numIter_151062);
                                    
                                    if (memblock_set(ctx, &mem_param_tmp_165767, &ext_mem_165057, "ext_mem_165057") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_tmp_165768, &ext_mem_165054, "ext_mem_165054") != 0)
                                        return 1;
                                    
                                    int64_t ctx_param_ext_tmp_165769 = ext_165056;
                                    int64_t ctx_param_ext_tmp_165770 = ext_165055;
                                    int64_t ctx_param_ext_tmp_165771 = ext_165053;
                                    int64_t ctx_param_ext_tmp_165772 = ext_165052;
                                    bool loop_while_tmp_165773 = loop_cond_151207;
                                    int64_t p_tmp_165774 = loopres_151155;
                                    
                                    if (memblock_set(ctx, &mem_param_165018, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
                                        return 1;
                                    if (memblock_set(ctx, &mem_param_165021, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
                                        return 1;
                                    ctx_param_ext_165016 = ctx_param_ext_tmp_165769;
                                    ctx_param_ext_165017 = ctx_param_ext_tmp_165770;
                                    ctx_param_ext_165019 = ctx_param_ext_tmp_165771;
                                    ctx_param_ext_165020 = ctx_param_ext_tmp_165772;
                                    loop_while_151121 = loop_while_tmp_165773;
                                    p_151122 = p_tmp_165774;
                                }
                                if (memblock_set(ctx, &ext_mem_165063, &mem_param_165018, "mem_param_165018") != 0)
                                    return 1;
                                if (memblock_set(ctx, &ext_mem_165062, &mem_param_165021, "mem_param_165021") != 0)
                                    return 1;
                                ext_165061 = ctx_param_ext_165016;
                                ext_165060 = ctx_param_ext_165017;
                                ext_165059 = ctx_param_ext_165019;
                                ext_165058 = ctx_param_ext_165020;
                                defunc_0_find_joinTuples_res_151117 = loop_while_151121;
                                defunc_0_find_joinTuples_res_151118 = p_151122;
                                if (memblock_alloc(ctx, &mem_165065, bytes_165006, "mem_165065")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164749 = 0; i_164749 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164749++) {
                                    int64_t eta_p_151209 = ((int64_t *) mem_param_165015.mem)[i_164749];
                                    int64_t eta_p_151210 = ((int64_t *) ext_mem_165062.mem)[ext_165059 + i_164749 * ext_165058];
                                    bool cond_151211 = slt64(eta_p_151209, (int64_t) 0);
                                    int64_t lifted_lambda_res_151212;
                                    
                                    if (cond_151211) {
                                        lifted_lambda_res_151212 = eta_p_151210;
                                    } else {
                                        lifted_lambda_res_151212 = eta_p_151209;
                                    }
                                    ((int64_t *) mem_165065.mem)[i_164749] = lifted_lambda_res_151212;
                                }
                                if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
                                    return 1;
                                if (memblock_alloc(ctx, &mem_165073, bytes_165006, "mem_165073")) {
                                    err = 1;
                                    goto cleanup;
                                }
                                for (int64_t i_164753 = 0; i_164753 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164753++) {
                                    int64_t eta_p_151214 = ((int64_t *) mem_param_165012.mem)[i_164753];
                                    int64_t eta_p_151215 = ((int64_t *) ext_mem_165063.mem)[ext_165061 + i_164753 * ext_165060];
                                    int64_t defunc_0_f_res_151216 = add64(eta_p_151214, eta_p_151215);
                                    
                                    ((int64_t *) mem_165073.mem)[i_164753] = defunc_0_f_res_151216;
                                }
                                if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
                                    return 1;
                                
                                bool loop_cond_151217 = sle64(zeze_lhs_151078, min_res_151013);
                                
                                if (memblock_set(ctx, &mem_param_tmp_165761, &mem_165073, "mem_165073") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_tmp_165762, &mem_165065, "mem_165065") != 0)
                                    return 1;
                                
                                bool loop_while_tmp_165763 = loop_cond_151217;
                                int64_t dp_tmp_165764 = zeze_lhs_151078;
                                
                                if (memblock_set(ctx, &mem_param_165012, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
                                    return 1;
                                if (memblock_set(ctx, &mem_param_165015, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
                                    return 1;
                                loop_while_151069 = loop_while_tmp_165763;
                                dp_151070 = dp_tmp_165764;
                            }
                            if (memblock_set(ctx, &ext_mem_165085, &mem_param_165012, "mem_param_165012") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165084, &mem_param_165015, "mem_param_165015") != 0)
                                return 1;
                            loopres_f_res_f_res_151065 = loop_while_151069;
                            loopres_f_res_f_res_151066 = dp_151070;
                            if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
                                return 1;
                            if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
                                return 1;
                            if (mem_165087_cached_sizze_166128 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165087, &mem_165087_cached_sizze_166128, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164757 = 0; i_164757 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164757++) {
                                int64_t slice_164901 = loopres_f_res_f_res_151022 + i_164757;
                                int64_t eta_p_151220 = ((int64_t *) mem_param_165005.mem)[ctx_param_ext_165003 + slice_164901 * ctx_param_ext_165004];
                                int64_t eta_p_151221 = ((int64_t *) ext_mem_165084.mem)[i_164757];
                                bool cond_151222 = slt64(eta_p_151220, (int64_t) 0);
                                int64_t lifted_lambda_res_151223;
                                
                                if (cond_151222) {
                                    lifted_lambda_res_151223 = eta_p_151221;
                                } else {
                                    lifted_lambda_res_151223 = eta_p_151220;
                                }
                                ((int64_t *) mem_165087)[i_164757] = lifted_lambda_res_151223;
                            }
                            if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
                                return 1;
                            if (mem_165095_cached_sizze_166129 < bytes_165006) {
                                err = lexical_realloc(ctx, &mem_165095, &mem_165095_cached_sizze_166129, bytes_165006);
                                if (err != FUTHARK_SUCCESS)
                                    goto cleanup;
                            }
                            for (int64_t i_164761 = 0; i_164761 < dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037; i_164761++) {
                                int64_t slice_164900 = loopres_f_res_f_res_151022 + i_164761;
                                int64_t eta_p_151226 = ((int64_t *) mem_param_165002.mem)[ctx_param_ext_165000 + slice_164900 * ctx_param_ext_165001];
                                int64_t eta_p_151227 = ((int64_t *) ext_mem_165085.mem)[i_164761];
                                int64_t defunc_0_f_res_151228 = add64(eta_p_151226, eta_p_151227);
                                
                                ((int64_t *) mem_165095)[i_164761] = defunc_0_f_res_151228;
                            }
                            if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
                                return 1;
                            if (memblock_alloc(ctx, &mem_165103, bytes_164931, "mem_165103")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165005.mem, ctx_param_ext_165003, (int64_t []) {ctx_param_ext_165004}, (int64_t []) {nR_116230});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165103.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165087, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_alloc(ctx, &mem_165105, bytes_164931, "mem_165105")) {
                                err = 1;
                                goto cleanup;
                            }
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165002.mem, ctx_param_ext_165000, (int64_t []) {ctx_param_ext_165001}, (int64_t []) {nR_116230});
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165105.mem, loopres_f_res_f_res_151022, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165095, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Ur_endz20Ur_startz7dUzg_151037});
                            if (memblock_set(ctx, &ext_mem_165111, &mem_165105, "mem_165105") != 0)
                                return 1;
                            if (memblock_set(ctx, &ext_mem_165108, &mem_165103, "mem_165103") != 0)
                                return 1;
                        }
                        if (memblock_set(ctx, &ext_mem_165117, &ext_mem_165111, "ext_mem_165111") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_165114, &ext_mem_165108, "ext_mem_165108") != 0)
                            return 1;
                    }
                    
                    bool loop_cond_151233 = slt64(loopres_151015, dzlz7bUZLztZRz20UpartitionsPerWindowz20UnumberOfWindowsz7dUzg_150569);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165749, &ext_mem_165117, "ext_mem_165117") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_165750, &ext_mem_165114, "ext_mem_165114") != 0)
                        return 1;
                    
                    int64_t ctx_param_ext_tmp_165751 = ext_165116;
                    int64_t ctx_param_ext_tmp_165752 = ext_165115;
                    int64_t ctx_param_ext_tmp_165753 = ext_165113;
                    int64_t ctx_param_ext_tmp_165754 = ext_165112;
                    bool loop_while_tmp_165755 = loop_cond_151233;
                    int64_t p_tmp_165756 = loopres_151015;
                    
                    if (memblock_set(ctx, &mem_param_165002, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_165005, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
                        return 1;
                    ctx_param_ext_165000 = ctx_param_ext_tmp_165751;
                    ctx_param_ext_165001 = ctx_param_ext_tmp_165752;
                    ctx_param_ext_165003 = ctx_param_ext_tmp_165753;
                    ctx_param_ext_165004 = ctx_param_ext_tmp_165754;
                    loop_while_151003 = loop_while_tmp_165755;
                    p_151004 = p_tmp_165756;
                }
                if (memblock_set(ctx, &ext_mem_165123, &mem_param_165002, "mem_param_165002") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_165122, &mem_param_165005, "mem_param_165005") != 0)
                    return 1;
                ext_165121 = ctx_param_ext_165000;
                ext_165120 = ctx_param_ext_165001;
                ext_165119 = ctx_param_ext_165003;
                ext_165118 = ctx_param_ext_165004;
                defunc_0_join_chunks_res_150999 = loop_while_151003;
                defunc_0_join_chunks_res_151000 = p_151004;
                if (memblock_set(ctx, &ext_mem_165177, &ext_mem_165123, "ext_mem_165123") != 0)
                    return 1;
                ext_165176 = ext_165121;
                ext_165175 = ext_165120;
                if (memblock_set(ctx, &ext_mem_165174, &ext_mem_165122, "ext_mem_165122") != 0)
                    return 1;
                ext_165173 = ext_165119;
                ext_165172 = ext_165118;
            }
            if (memblock_alloc(ctx, &mem_165179, bytes_164931, "mem_165179")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164765 = 0; i_164765 < nR_116230; i_164765++) {
                int64_t eta_p_151235 = ((int64_t *) mem_param_164940.mem)[i_164765];
                int64_t eta_p_151236 = ((int64_t *) ext_mem_165174.mem)[ext_165173 + i_164765 * ext_165172];
                bool cond_151237 = slt64(eta_p_151235, (int64_t) 0);
                int64_t lifted_lambda_res_151238;
                
                if (cond_151237) {
                    lifted_lambda_res_151238 = eta_p_151236;
                } else {
                    lifted_lambda_res_151238 = eta_p_151235;
                }
                ((int64_t *) mem_165179.mem)[i_164765] = lifted_lambda_res_151238;
            }
            if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165187, bytes_164931, "mem_165187")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < nR_116230; i_164769++) {
                int64_t eta_p_151240 = ((int64_t *) mem_param_164937.mem)[i_164769];
                int64_t eta_p_151241 = ((int64_t *) ext_mem_165177.mem)[ext_165176 + i_164769 * ext_165175];
                int64_t defunc_0_f_res_151242 = add64(eta_p_151240, eta_p_151241);
                
                ((int64_t *) mem_165187.mem)[i_164769] = defunc_0_f_res_151242;
            }
            if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
                return 1;
            
            int16_t leq_lhs_151247 = ((int16_t *) tS_mem_164929.mem)[i_p_m_t_s_150433];
            int16_t leq_rhs_151249 = ((int16_t *) tR_mem_164928.mem)[gt_rhs_150410];
            bool defunc_0_leq_res_151250 = sle16(leq_lhs_151247, leq_rhs_151249);
            int64_t nextIter_151251;
            
            if (defunc_0_leq_res_151250) {
                int64_t nextIter_t_res_157804 = add64((int64_t) 1, p_150424);
                
                nextIter_151251 = nextIter_t_res_157804;
            } else {
                nextIter_151251 = numIter_150404;
            }
            if (memblock_set(ctx, &ext_mem_165199, &mem_165187, "mem_165187") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165196, &mem_165179, "mem_165179") != 0)
                return 1;
            loopres_150448 = nextIter_151251;
        }
        
        bool loop_cond_151253 = slt64(loopres_150448, numIter_150404);
        
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        
        bool loop_while_tmp_165701 = loop_cond_151253;
        int64_t p_tmp_165702 = loopres_150448;
        
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        loop_while_150423 = loop_while_tmp_165701;
        p_150424 = p_tmp_165702;
    }
    if (memblock_set(ctx, &ext_mem_165205, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165204, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    defunc_0_mergeJoin_res_150419 = loop_while_150423;
    defunc_0_mergeJoin_res_150420 = p_150424;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
        return 1;
    if (mem_165207_cached_sizze_166132 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165207, &mem_165207_cached_sizze_166132, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165209_cached_sizze_166133 < bytes_164931) {
        err = lexical_realloc(ctx, &mem_165209, &mem_165209_cached_sizze_166133, bytes_164931);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164779;
    int64_t scanacc_164773 = (int64_t) 0;
    
    for (int64_t i_164776 = 0; i_164776 < nR_116230; i_164776++) {
        int64_t eta_p_157038 = ((int64_t *) ext_mem_165205.mem)[i_164776];
        bool lifted_lambda_res_157039 = slt64((int64_t) 0, eta_p_157038);
        int64_t defunc_0_f_res_157040 = btoi_bool_i64(lifted_lambda_res_157039);
        int64_t defunc_0_op_res_151262 = add64(defunc_0_f_res_157040, scanacc_164773);
        
        ((int64_t *) mem_165207)[i_164776] = defunc_0_op_res_151262;
        ((int64_t *) mem_165209)[i_164776] = defunc_0_f_res_157040;
        
        int64_t scanacc_tmp_165788 = defunc_0_op_res_151262;
        
        scanacc_164773 = scanacc_tmp_165788;
    }
    discard_164779 = scanacc_164773;
    
    bool protect_assert_disj_151269 = zzero_150401 || bounds_check_150413;
    bool index_certs_151270;
    
    if (!protect_assert_disj_151269) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_rhs_150410, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151271;
    
    if (nonzzero_150402) {
        int64_t x_157807 = ((int64_t *) mem_165207)[gt_rhs_150410];
        
        m_f_res_151271 = x_157807;
    } else {
        m_f_res_151271 = (int64_t) 0;
    }
    
    int64_t m_151273;
    
    if (zzero_150401) {
        m_151273 = (int64_t) 0;
    } else {
        m_151273 = m_f_res_151271;
    }
    
    int64_t m_151283 = sub64(m_151273, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151285 = slt64(m_151283, nR_116230);
    bool zzero_leq_i_p_m_t_s_151284 = sle64((int64_t) 0, m_151283);
    bool y_151287 = zzero_leq_i_p_m_t_s_151284 && i_p_m_t_s_leq_w_151285;
    bool i_lte_j_151286 = sle64((int64_t) 0, m_151273);
    bool forwards_ok_151288 = i_lte_j_151286 && y_151287;
    bool eq_x_zz_151280 = (int64_t) 0 == m_f_res_151271;
    bool p_and_eq_x_y_151281 = nonzzero_150402 && eq_x_zz_151280;
    bool empty_slice_151282 = zzero_150401 || p_and_eq_x_y_151281;
    bool ok_or_empty_151289 = empty_slice_151282 || forwards_ok_151288;
    bool index_certs_151290;
    
    if (!ok_or_empty_151289) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151273, "] out of bounds for array of shape [", (long long) nR_116230, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165222 = (int64_t) 8 * m_151273;
    
    if (mem_165223_cached_sizze_166134 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165223, &mem_165223_cached_sizze_166134, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165225_cached_sizze_166135 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165225, &mem_165225_cached_sizze_166135, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165225, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165204.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    if (mem_165227_cached_sizze_166136 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165227, &mem_165227_cached_sizze_166136, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165227, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164930.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    
    int64_t bytes_165228 = (int64_t) 2 * m_151273;
    
    if (mem_165229_cached_sizze_166137 < bytes_165228) {
        err = lexical_realloc(ctx, &mem_165229, &mem_165229_cached_sizze_166137, bytes_165228);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_165229, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) tR_mem_164928.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151273});
    for (int64_t write_iter_164780 = 0; write_iter_164780 < nR_116230; write_iter_164780++) {
        int64_t write_iv_164785 = ((int64_t *) mem_165209)[write_iter_164780];
        int64_t write_iv_164786 = ((int64_t *) mem_165207)[write_iter_164780];
        int16_t write_iv_164787 = ((int16_t *) tR_mem_164928.mem)[write_iter_164780];
        int64_t write_iv_164788 = ((int64_t *) ext_mem_164930.mem)[write_iter_164780];
        int64_t write_iv_164789 = ((int64_t *) ext_mem_165204.mem)[write_iter_164780];
        int64_t write_iv_164790 = ((int64_t *) ext_mem_165205.mem)[write_iter_164780];
        bool cond_157033 = write_iv_164785 == (int64_t) 1;
        int64_t lifted_lambda_res_157034;
        
        if (cond_157033) {
            int64_t lifted_lambda_res_t_res_157808 = sub64(write_iv_164786, (int64_t) 1);
            
            lifted_lambda_res_157034 = lifted_lambda_res_t_res_157808;
        } else {
            lifted_lambda_res_157034 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int16_t *) mem_165229)[lifted_lambda_res_157034] = write_iv_164787;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165227)[lifted_lambda_res_157034] = write_iv_164788;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165225)[lifted_lambda_res_157034] = write_iv_164789;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157034) && slt64(lifted_lambda_res_157034, m_151273)) {
            ((int64_t *) mem_165223)[lifted_lambda_res_157034] = write_iv_164790;
        }
    }
    if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
        return 1;
    if (mem_165255_cached_sizze_166138 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165255, &mem_165255_cached_sizze_166138, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165257_cached_sizze_166139 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165257, &mem_165257_cached_sizze_166139, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165259_cached_sizze_166140 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165259, &mem_165259_cached_sizze_166140, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164807;
    int64_t discard_164808;
    int64_t scanacc_164798;
    int64_t scanacc_164799;
    
    scanacc_164798 = (int64_t) 0;
    scanacc_164799 = (int64_t) 0;
    for (int64_t i_164803 = 0; i_164803 < m_151273; i_164803++) {
        int64_t x_157043 = ((int64_t *) mem_165223)[i_164803];
        bool lifted_lambda_res_157045 = slt64((int64_t) 1, x_157043);
        int64_t defunc_0_f_res_157046 = btoi_bool_i64(lifted_lambda_res_157045);
        int64_t lifted_lambda_res_151312 = add64(x_157043, scanacc_164798);
        int64_t defunc_0_op_res_151405 = add64(defunc_0_f_res_157046, scanacc_164799);
        
        ((int64_t *) mem_165255)[i_164803] = lifted_lambda_res_151312;
        ((int64_t *) mem_165257)[i_164803] = defunc_0_op_res_151405;
        ((int64_t *) mem_165259)[i_164803] = defunc_0_f_res_157046;
        
        int64_t scanacc_tmp_165795 = lifted_lambda_res_151312;
        int64_t scanacc_tmp_165796 = defunc_0_op_res_151405;
        
        scanacc_164798 = scanacc_tmp_165795;
        scanacc_164799 = scanacc_tmp_165796;
    }
    discard_164807 = scanacc_164798;
    discard_164808 = scanacc_164799;
    if (mem_165279_cached_sizze_166141 < bytes_165222) {
        err = lexical_realloc(ctx, &mem_165279, &mem_165279_cached_sizze_166141, bytes_165222);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_164811 = 0; i_164811 < m_151273; i_164811++) {
        int64_t zv_lhs_157020 = add64((int64_t) -1, i_164811);
        int64_t tmp_157021 = smod64(zv_lhs_157020, m_151273);
        int64_t lifted_lambda_res_157022 = ((int64_t *) mem_165255)[tmp_157021];
        bool cond_157024 = i_164811 == (int64_t) 0;
        int64_t lifted_lambda_res_157025;
        
        if (cond_157024) {
            lifted_lambda_res_157025 = (int64_t) 0;
        } else {
            lifted_lambda_res_157025 = lifted_lambda_res_157022;
        }
        ((int64_t *) mem_165279)[i_164811] = lifted_lambda_res_157025;
    }
    
    bool cond_151324 = slt64((int64_t) 0, m_151273);
    bool y_151325 = slt64(m_151283, m_151273);
    bool bounds_check_151326 = zzero_leq_i_p_m_t_s_151284 && y_151325;
    bool loop_not_taken_151327 = !cond_151324;
    bool protect_assert_disj_151328 = bounds_check_151326 || loop_not_taken_151327;
    bool index_certs_151329;
    
    if (!protect_assert_disj_151328) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  ftSMJ.fut:432:10-41\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:158:133-136\n   #3  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_lhs_151330;
    
    if (cond_151324) {
        int64_t x_157809 = ((int64_t *) mem_165279)[m_151283];
        
        zp_lhs_151330 = x_157809;
    } else {
        zp_lhs_151330 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151332;
    
    if (cond_151324) {
        int64_t x_157810 = ((int64_t *) mem_165223)[m_151283];
        
        n_pairs_t_res_151332 = x_157810;
    } else {
        n_pairs_t_res_151332 = (int64_t) 0;
    }
    
    int64_t n_pairs_t_res_151334 = add64(zp_lhs_151330, n_pairs_t_res_151332);
    int64_t n_pairs_151335;
    
    if (cond_151324) {
        n_pairs_151335 = n_pairs_t_res_151334;
    } else {
        n_pairs_151335 = (int64_t) 0;
    }
    
    int64_t bytes_165286 = (int64_t) 2 * n_pairs_151335;
    int64_t bytes_165288 = (int64_t) 8 * n_pairs_151335;
    bool zzero_151341 = scatter_psizze_116239 == (int64_t) 0;
    bool nonzzero_151342 = !zzero_151341;
    bool nonzzero_cert_151343;
    
    if (!nonzzero_151342) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:158:133-136\n   #3  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_151408 = !empty_slice_151282;
    bool protect_assert_disj_151409 = empty_slice_151282 || bounds_check_151326;
    bool index_certs_151410;
    
    if (!protect_assert_disj_151409) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_151283, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_151411;
    
    if (x_151408) {
        int64_t x_157815 = ((int64_t *) mem_165257)[m_151283];
        
        m_f_res_151411 = x_157815;
    } else {
        m_f_res_151411 = (int64_t) 0;
    }
    
    int64_t m_151413;
    
    if (empty_slice_151282) {
        m_151413 = (int64_t) 0;
    } else {
        m_151413 = m_f_res_151411;
    }
    
    int64_t m_151423 = sub64(m_151413, (int64_t) 1);
    bool i_p_m_t_s_leq_w_151425 = slt64(m_151423, m_151273);
    bool zzero_leq_i_p_m_t_s_151424 = sle64((int64_t) 0, m_151423);
    bool y_151427 = zzero_leq_i_p_m_t_s_151424 && i_p_m_t_s_leq_w_151425;
    bool i_lte_j_151426 = sle64((int64_t) 0, m_151413);
    bool forwards_ok_151428 = i_lte_j_151426 && y_151427;
    bool eq_x_zz_151420 = (int64_t) 0 == m_f_res_151411;
    bool p_and_eq_x_y_151421 = x_151408 && eq_x_zz_151420;
    bool empty_slice_151422 = empty_slice_151282 || p_and_eq_x_y_151421;
    bool ok_or_empty_151429 = empty_slice_151422 || forwards_ok_151428;
    bool index_certs_151430;
    
    if (!ok_or_empty_151429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_151413, "] out of bounds for array of shape [", (long long) m_151273, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:473:7-474:73\n   #3  ftRelational.fut:158:133-136\n   #4  ftRelational.fut:147:1-158:136\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165334 = (int64_t) 8 * m_151413;
    
    if (memblock_alloc(ctx, &mem_165287, bytes_165286, "mem_165287")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165801 = 0; nest_i_165801 < n_pairs_151335; nest_i_165801++) {
        ((int16_t *) mem_165287.mem)[nest_i_165801] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_165289, bytes_165288, "mem_165289")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165802 = 0; nest_i_165802 < n_pairs_151335; nest_i_165802++) {
        ((int64_t *) mem_165289.mem)[nest_i_165802] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_165291, bytes_165288, "mem_165291")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165803 = 0; nest_i_165803 < n_pairs_151335; nest_i_165803++) {
        ((int64_t *) mem_165291.mem)[nest_i_165803] = (int64_t) -1;
    }
    
    int64_t zm_lhs_151339 = add64(scatter_psizze_116239, n_pairs_151335);
    int64_t zs_lhs_151340 = sub64(zm_lhs_151339, (int64_t) 1);
    int64_t m_151344 = sdiv64(zs_lhs_151340, scatter_psizze_116239);
    bool loop_cond_151345 = slt64((int64_t) 0, m_151344);
    bool partitioned_scatter_res_151346;
    int64_t partitioned_scatter_res_151350;
    bool loop_while_151351;
    int64_t p_151355;
    
    loop_while_151351 = loop_cond_151345;
    p_151355 = (int64_t) 0;
    while (loop_while_151351) {
        int64_t lower_bound_151356 = mul64(scatter_psizze_116239, p_151355);
        int64_t min_arg1_151357 = add64(scatter_psizze_116239, lower_bound_151356);
        int64_t min_res_151358 = smin64(n_pairs_151335, min_arg1_151357);
        int64_t j_m_i_151359 = sub64(min_res_151358, lower_bound_151356);
        bool empty_slice_151360 = j_m_i_151359 == (int64_t) 0;
        int64_t m_151361 = sub64(j_m_i_151359, (int64_t) 1);
        int64_t i_p_m_t_s_151362 = add64(lower_bound_151356, m_151361);
        bool zzero_leq_i_p_m_t_s_151363 = sle64((int64_t) 0, i_p_m_t_s_151362);
        bool i_p_m_t_s_leq_w_151364 = slt64(i_p_m_t_s_151362, n_pairs_151335);
        bool zzero_lte_i_151365 = sle64((int64_t) 0, lower_bound_151356);
        bool i_lte_j_151366 = sle64(lower_bound_151356, min_res_151358);
        bool y_151367 = i_p_m_t_s_leq_w_151364 && zzero_lte_i_151365;
        bool y_151368 = zzero_leq_i_p_m_t_s_151363 && y_151367;
        bool forwards_ok_151369 = i_lte_j_151366 && y_151368;
        bool ok_or_empty_151370 = empty_slice_151360 || forwards_ok_151369;
        bool index_certs_151371;
        
        if (!ok_or_empty_151370) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_151356, ":", (long long) min_res_151358, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:158:133-136\n   #3  ftRelational.fut:147:1-158:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165301 = (int64_t) 2 * j_m_i_151359;
        int64_t bytes_165303 = (int64_t) 8 * j_m_i_151359;
        
        if (mem_165302_cached_sizze_166142 < bytes_165301) {
            err = lexical_realloc(ctx, &mem_165302, &mem_165302_cached_sizze_166142, bytes_165301);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_165287.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165304_cached_sizze_166143 < bytes_165303) {
            err = lexical_realloc(ctx, &mem_165304, &mem_165304_cached_sizze_166143, bytes_165303);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165289.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        if (mem_165306_cached_sizze_166144 < bytes_165303) {
            err = lexical_realloc(ctx, &mem_165306, &mem_165306_cached_sizze_166144, bytes_165303);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165291.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_151356, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        for (int64_t write_iter_164813 = 0; write_iter_164813 < m_151273; write_iter_164813++) {
            int64_t write_iv_164817 = ((int64_t *) mem_165279)[write_iter_164813];
            int16_t write_iv_164818 = ((int16_t *) mem_165229)[write_iter_164813];
            int64_t write_iv_164819 = ((int64_t *) mem_165227)[write_iter_164813];
            int64_t write_iv_164820 = ((int64_t *) mem_165225)[write_iter_164813];
            bool cond_157424 = sle64(lower_bound_151356, write_iv_164817);
            bool cond_t_res_157425 = slt64(write_iv_164817, min_res_151358);
            bool x_157426 = cond_157424 && cond_t_res_157425;
            int64_t lifted_lambda_res_157427;
            
            if (x_157426) {
                int64_t lifted_lambda_res_t_res_157811 = sub64(write_iv_164817, lower_bound_151356);
                
                lifted_lambda_res_157427 = lifted_lambda_res_t_res_157811;
            } else {
                lifted_lambda_res_157427 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int16_t *) mem_165302)[lifted_lambda_res_157427] = write_iv_164818;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165304)[lifted_lambda_res_157427] = write_iv_164819;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157427) && slt64(lifted_lambda_res_157427, j_m_i_151359)) {
                ((int64_t *) mem_165306)[lifted_lambda_res_157427] = write_iv_164820;
            }
        }
        
        int64_t tmp_151385 = add64((int64_t) 1, p_151355);
        
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_165287.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_165302, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165289.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165304, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165291.mem, lower_bound_151356, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165306, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_151359});
        
        bool loop_cond_151396 = slt64(tmp_151385, m_151344);
        bool loop_while_tmp_165804 = loop_cond_151396;
        int64_t p_tmp_165808 = tmp_151385;
        
        loop_while_151351 = loop_while_tmp_165804;
        p_151355 = p_tmp_165808;
    }
    partitioned_scatter_res_151346 = loop_while_151351;
    partitioned_scatter_res_151350 = p_151355;
    if (mem_165335_cached_sizze_166145 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165335, &mem_165335_cached_sizze_166145, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165335, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165223, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    if (mem_165337_cached_sizze_166146 < bytes_165334) {
        err = lexical_realloc(ctx, &mem_165337, &mem_165337_cached_sizze_166146, bytes_165334);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165337, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165279, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_151413});
    for (int64_t write_iter_164824 = 0; write_iter_164824 < m_151273; write_iter_164824++) {
        int64_t write_iv_164827 = ((int64_t *) mem_165259)[write_iter_164824];
        int64_t write_iv_164828 = ((int64_t *) mem_165257)[write_iter_164824];
        int64_t write_iv_164829 = ((int64_t *) mem_165279)[write_iter_164824];
        int64_t write_iv_164830 = ((int64_t *) mem_165223)[write_iter_164824];
        bool cond_157008 = write_iv_164827 == (int64_t) 1;
        int64_t lifted_lambda_res_157009;
        
        if (cond_157008) {
            int64_t lifted_lambda_res_t_res_157816 = sub64(write_iv_164828, (int64_t) 1);
            
            lifted_lambda_res_157009 = lifted_lambda_res_t_res_157816;
        } else {
            lifted_lambda_res_157009 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165337)[lifted_lambda_res_157009] = write_iv_164829;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_151413)) {
            ((int64_t *) mem_165335)[lifted_lambda_res_157009] = write_iv_164830;
        }
    }
    
    bool cond_151440 = slt64((int64_t) 0, m_151413);
    bool loop_cond_t_res_151441 = slt64(m_151273, n_pairs_151335);
    bool x_151442 = cond_151440 && loop_cond_t_res_151441;
    bool joinTups_to_joinPairs_InnerJoin_res_151443;
    int64_t joinTups_to_joinPairs_InnerJoin_res_151447;
    bool loop_while_151448;
    int64_t p_151452;
    
    if (memblock_set(ctx, &mem_param_165352, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165355, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_165358, &mem_165291, "mem_165291") != 0)
        return 1;
    loop_while_151448 = x_151442;
    p_151452 = (int64_t) 0;
    while (loop_while_151448) {
        bool x_151453 = sle64((int64_t) 0, p_151452);
        bool y_151454 = slt64(p_151452, m_151413);
        bool bounds_check_151455 = x_151453 && y_151454;
        bool index_certs_151456;
        
        if (!bounds_check_151455) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) p_151452, "] out of bounds for array of shape [", (long long) m_151413, "].", "-> #0  ftSMJ.fut:447:13-42\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:158:133-136\n   #3  ftRelational.fut:147:1-158:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_151457 = ((int64_t *) mem_165337)[p_151452];
        int64_t loopres_151458 = ((int64_t *) mem_165335)[p_151452];
        bool x_151459 = sle64((int64_t) 0, loopres_151457);
        bool y_151460 = slt64(loopres_151457, n_pairs_151335);
        bool bounds_check_151461 = x_151459 && y_151460;
        bool index_certs_151462;
        
        if (!bounds_check_151461) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:449:52-61\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:158:133-136\n   #3  ftRelational.fut:147:1-158:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_165359 = (int64_t) 2 * loopres_151458;
        int64_t bytes_165361 = (int64_t) 8 * loopres_151458;
        int64_t tmp_151473 = add64(loopres_151457, loopres_151458);
        bool empty_slice_151477 = loopres_151458 == (int64_t) 0;
        int64_t m_151478 = sub64(loopres_151458, (int64_t) 1);
        int64_t i_p_m_t_s_151479 = add64(loopres_151457, m_151478);
        bool zzero_leq_i_p_m_t_s_151480 = sle64((int64_t) 0, i_p_m_t_s_151479);
        bool i_p_m_t_s_leq_w_151481 = slt64(i_p_m_t_s_151479, n_pairs_151335);
        bool i_lte_j_151482 = sle64(loopres_151457, tmp_151473);
        bool y_151483 = x_151459 && i_p_m_t_s_leq_w_151481;
        bool y_151484 = zzero_leq_i_p_m_t_s_151480 && y_151483;
        bool forwards_ok_151485 = i_lte_j_151482 && y_151484;
        bool ok_or_empty_151486 = empty_slice_151477 || forwards_ok_151485;
        bool index_certs_151487;
        
        if (!ok_or_empty_151486) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) loopres_151457, ":", (long long) tmp_151473, "] out of bounds for array of shape [", (long long) n_pairs_151335, "].", "-> #0  ftSMJ.fut:453:14-55\n   #1  ftSMJ.fut:473:7-474:73\n   #2  ftRelational.fut:158:133-136\n   #3  ftRelational.fut:147:1-158:136\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t loopres_151463 = ((int16_t *) mem_param_165352.mem)[loopres_151457];
        int64_t loopres_151464 = ((int64_t *) mem_param_165355.mem)[loopres_151457];
        int64_t loopres_151465 = ((int64_t *) mem_param_165358.mem)[loopres_151457];
        
        if (mem_165360_cached_sizze_166147 < bytes_165359) {
            err = lexical_realloc(ctx, &mem_165360, &mem_165360_cached_sizze_166147, bytes_165359);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165822 = 0; nest_i_165822 < loopres_151458; nest_i_165822++) {
            ((int16_t *) mem_165360)[nest_i_165822] = loopres_151463;
        }
        if (mem_165362_cached_sizze_166148 < bytes_165361) {
            err = lexical_realloc(ctx, &mem_165362, &mem_165362_cached_sizze_166148, bytes_165361);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_165823 = 0; nest_i_165823 < loopres_151458; nest_i_165823++) {
            ((int64_t *) mem_165362)[nest_i_165823] = loopres_151464;
        }
        if (mem_165364_cached_sizze_166149 < bytes_165361) {
            err = lexical_realloc(ctx, &mem_165364, &mem_165364_cached_sizze_166149, bytes_165361);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164835 = 0; i_164835 < loopres_151458; i_164835++) {
            int64_t tmp_151471 = add64(loopres_151465, i_164835);
            
            ((int64_t *) mem_165364)[i_164835] = tmp_151471;
        }
        
        int64_t tmp_151472 = add64((int64_t) 1, p_151452);
        
        if (memblock_alloc(ctx, &mem_165372, bytes_165286, "mem_165372")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_165372.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_165352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165374, bytes_165288, "mem_165374")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165355.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        if (memblock_alloc(ctx, &mem_165376, bytes_165288, "mem_165376")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_165358.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_165372.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_165360, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165374.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165362, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_165376.mem, loopres_151457, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165364, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_151458});
        
        bool cond_151491 = slt64(tmp_151472, m_151413);
        bool x_151492 = loop_cond_t_res_151441 && cond_151491;
        
        if (memblock_set(ctx, &mem_param_tmp_165814, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165815, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165816, &mem_165376, "mem_165376") != 0)
            return 1;
        
        bool loop_while_tmp_165817 = x_151492;
        int64_t p_tmp_165821 = tmp_151472;
        
        if (memblock_set(ctx, &mem_param_165352, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165355, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165358, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        loop_while_151448 = loop_while_tmp_165817;
        p_151452 = p_tmp_165821;
    }
    if (memblock_set(ctx, &ext_mem_165385, &mem_param_165352, "mem_param_165352") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165384, &mem_param_165355, "mem_param_165355") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165383, &mem_param_165358, "mem_param_165358") != 0)
        return 1;
    joinTups_to_joinPairs_InnerJoin_res_151443 = loop_while_151448;
    joinTups_to_joinPairs_InnerJoin_res_151447 = p_151452;
    if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165387, bytes_165286, "mem_165387")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_165387.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_165385.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165389, bytes_165288, "mem_165389")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165384.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165391, bytes_165288, "mem_165391")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165383.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_pairs_151335});
    if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165389, "mem_165389") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165391, "mem_165391") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165695, &mem_165387, "mem_165387") != 0)
        return 1;
    prim_out_165696 = n_pairs_151335;
    if (memblock_set(ctx, &*mem_out_p_166118, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166119, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166120, &mem_out_165695, "mem_out_165695") != 0)
        return 1;
    *out_prim_out_166121 = prim_out_165696;
    
  cleanup:
    {
        free(mem_164942);
        free(mem_164944);
        free(mem_164985);
        free(mem_164987);
        free(mem_165027);
        free(mem_165029);
        free(mem_165087);
        free(mem_165095);
        free(mem_165135);
        free(mem_165137);
        free(mem_165207);
        free(mem_165209);
        free(mem_165223);
        free(mem_165225);
        free(mem_165227);
        free(mem_165229);
        free(mem_165255);
        free(mem_165257);
        free(mem_165259);
        free(mem_165279);
        free(mem_165302);
        free(mem_165304);
        free(mem_165306);
        free(mem_165335);
        free(mem_165337);
        free(mem_165360);
        free(mem_165362);
        free(mem_165364);
        if (memblock_unref(ctx, &mem_165391, "mem_165391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165389, "mem_165389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165387, "mem_165387") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165816, "mem_param_tmp_165816") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165815, "mem_param_tmp_165815") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165814, "mem_param_tmp_165814") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165376, "mem_165376") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165374, "mem_165374") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165372, "mem_165372") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165358, "mem_param_165358") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165355, "mem_param_165355") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165352, "mem_param_165352") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165383, "ext_mem_165383") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165384, "ext_mem_165384") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165385, "ext_mem_165385") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165291, "mem_165291") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165289, "mem_165289") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165287, "mem_165287") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165187, "mem_165187") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165179, "mem_165179") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165750, "mem_param_tmp_165750") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165749, "mem_param_tmp_165749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165105, "mem_165105") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165103, "mem_165103") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165762, "mem_param_tmp_165762") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165761, "mem_param_tmp_165761") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165073, "mem_165073") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165065, "mem_165065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165768, "mem_param_tmp_165768") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165767, "mem_param_tmp_165767") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165045, "mem_165045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165043, "mem_165043") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165025, "ext_mem_165025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165023, "mem_165023") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165048, "ext_mem_165048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165051, "ext_mem_165051") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165054, "ext_mem_165054") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165057, "ext_mem_165057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165021, "mem_param_165021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165018, "mem_param_165018") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165062, "ext_mem_165062") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165063, "ext_mem_165063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165015, "mem_param_165015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165012, "mem_param_165012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165084, "ext_mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165085, "ext_mem_165085") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165009, "mem_165009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165114, "ext_mem_165114") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165117, "ext_mem_165117") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165005, "mem_param_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165002, "mem_param_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165122, "ext_mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165123, "ext_mem_165123") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164969, "mem_164969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164971, "mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164974, "ext_mem_164974") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164977, "ext_mem_164977") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164954, "mem_164954") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164952, "mem_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165706, "mem_param_tmp_165706") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165705, "mem_param_tmp_165705") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165153, "mem_165153") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165151, "mem_165151") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165131, "mem_165131") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165156, "ext_mem_165156") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165159, "ext_mem_165159") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165162, "ext_mem_165162") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165165, "ext_mem_165165") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165129, "mem_param_165129") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165126, "mem_param_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165170, "ext_mem_165170") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165171, "ext_mem_165171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165174, "ext_mem_165174") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165177, "ext_mem_165177") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165196, "ext_mem_165196") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165199, "ext_mem_165199") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165204, "ext_mem_165204") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165205, "ext_mem_165205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164934, "mem_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164930, "ext_mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165695, "mem_out_165695") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_166150, struct memblock eta_p_mem_164928, int64_t nz2080U_74372)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_res_157003;
    int64_t redout_164711 = (int64_t) -9223372036854775808;
    
    for (int64_t i_164712 = 0; i_164712 < nz2080U_74372; i_164712++) {
        int64_t x_145616 = ((int64_t *) eta_p_mem_164928.mem)[i_164712];
        int64_t max_res_145619 = smax64(x_145616, redout_164711);
        int64_t redout_tmp_165694 = max_res_145619;
        
        redout_164711 = redout_tmp_165694;
    }
    defunc_0_reduce_res_157003 = redout_164711;
    prim_out_165693 = defunc_0_reduce_res_157003;
    *out_prim_out_166150 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_166151, struct memblock *mem_out_p_166152, struct memblock xs_mem_164928, int64_t n_111087, int64_t incr_111088)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166153 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166154 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166155 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166156 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166157 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166158 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166159 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166160 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166161 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166162 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_111087;
    bool cond_154910 = sle64(n_111087, (int64_t) 1);
    int64_t zs_lhs_154911 = sub64(n_111087, (int64_t) 1);
    int64_t zp_rhs_154912 = sdiv_safe64(zs_lhs_154911, (int64_t) 20);
    int64_t min_num_blocks_154913 = add64((int64_t) 1, zp_rhs_154912);
    bool loop_cond_154914 = slt64((int64_t) 1, min_num_blocks_154913);
    bool smallest_pow_2_geq_than_res_154915;
    int64_t smallest_pow_2_geq_than_res_154916;
    bool loop_while_154917;
    int64_t x_154918;
    
    loop_while_154917 = loop_cond_154914;
    x_154918 = (int64_t) 1;
    while (loop_while_154917) {
        int64_t loopres_154919 = mul64((int64_t) 2, x_154918);
        bool loop_cond_154920 = slt64(loopres_154919, min_num_blocks_154913);
        bool loop_while_tmp_165695 = loop_cond_154920;
        int64_t x_tmp_165696 = loopres_154919;
        
        loop_while_154917 = loop_while_tmp_165695;
        x_154918 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154915 = loop_while_154917;
    smallest_pow_2_geq_than_res_154916 = x_154918;
    
    bool zzero_154921 = smallest_pow_2_geq_than_res_154916 == (int64_t) 0;
    bool nonzzero_154922 = !zzero_154921;
    bool protect_assert_disj_154923 = cond_154910 || nonzzero_154922;
    bool nonzzero_cert_154924;
    
    if (!protect_assert_disj_154923) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154925 = sdiv_safe64(zs_lhs_154911, smallest_pow_2_geq_than_res_154916);
    int64_t block_sizze_154926 = add64((int64_t) 1, zp_rhs_154925);
    bool y_154932 = slt64((int64_t) 0, n_111087);
    bool protect_assert_disj_165536 = cond_154910 || y_154932;
    bool index_certs_154933;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_111087, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154947 = slt64(smallest_pow_2_geq_than_res_154916, (int64_t) 0);
    bool valid_154948 = !bounds_invalid_upwards_154947;
    bool protect_assert_disj_165544 = cond_154910 || valid_154948;
    bool range_valid_c_154949;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154916, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:143:35-39\n   #6  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154951 = slt64(block_sizze_154926, (int64_t) 0);
    bool valid_154952 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_165546 = cond_154910 || valid_154952;
    bool range_valid_c_154953;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154926, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154955 = sle64(block_sizze_154926, (int64_t) 1);
    int64_t tmp_154956 = sub64(block_sizze_154926, (int64_t) 2);
    bool bounds_invalid_upwards_154957 = slt64(tmp_154956, (int64_t) 0);
    bool valid_154959 = !bounds_invalid_upwards_154957;
    bool protect_assert_disj_154960 = cond_154955 || valid_154959;
    bool protect_assert_disj_165548 = cond_154910 || protect_assert_disj_154960;
    bool range_valid_c_154961;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154956, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_12227(ctx, &ext_mem_164929, xs_mem_164928, n_111087, incr_111088) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_111087; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154927 = smallest_pow_2_geq_than_res_154916 * block_sizze_154926;
    bool x_165531 = !cond_154910;
    int64_t greatest_divisor_leq_than_arg1_154930 = mul64((int64_t) 2, block_sizze_154926);
    int64_t merge_block_sizze_154931;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154930) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154931 = x_165533;
    } else {
        merge_block_sizze_154931 = (int64_t) 0;
    }
    
    double reduce_arg1_154934;
    
    if (x_165531) {
        double x_165537 = ((double *) xs_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154934 = x_165537;
    } else {
        reduce_arg1_154934 = 0.0;
    }
    
    double defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        double x_165539;
        int64_t x_165540;
        double redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154934;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_111087; i_164713++) {
            double x_154938 = ((double *) xs_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154944 = redout_164711 <= x_154938;
            double defunc_0_op_res_154945;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154945 = x_154938;
            } else {
                defunc_0_op_res_154945 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154946;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154946 = i_164713;
            } else {
                defunc_0_op_res_154946 = redout_164712;
            }
            
            double redout_tmp_165699 = defunc_0_op_res_154945;
            int64_t redout_tmp_165700 = defunc_0_op_res_154946;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = 0.0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154958 = add64((int64_t) 1, tmp_154956);
    int64_t binop_x_164932 = (int64_t) 8 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164933 = block_sizze_154926 * binop_x_164932;
    int64_t bytes_164946 = (int64_t) 8 * block_sizze_154926;
    bool loop_cond_155033 = slt64(block_sizze_154926, flat_dim_154927);
    bool zzero_155034 = merge_block_sizze_154931 == (int64_t) 0;
    bool nonzzero_155035 = !zzero_155034;
    
    if (cond_154910) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166153 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166153, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166154 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166154, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166155 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166155, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166156 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166156, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154916; i_164725++) {
            int64_t zp_lhs_154965 = mul64(block_sizze_154926, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154926; i_164718++) {
                int64_t k_154969 = add64(zp_lhs_154965, i_164718);
                bool cond_154970 = slt64(k_154969, n_111087);
                double lifted_lambda_res_154971;
                int64_t lifted_lambda_res_154972;
                
                if (cond_154970) {
                    bool x_157003 = sle64((int64_t) 0, k_154969);
                    bool bounds_check_157004 = cond_154970 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154969, "] out of bounds for array of shape [", (long long) n_111087, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_157006 = ((double *) xs_mem_164928.mem)[k_154969];
                    
                    lifted_lambda_res_154971 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154972 = k_154969;
                } else {
                    lifted_lambda_res_154971 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154972 = defunc_0_reduce_res_157151;
                }
                ((double *) mem_164947)[i_164718] = lifted_lambda_res_154971;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154972;
            }
            if (!cond_154955) {
                for (int64_t i_154982 = 0; i_154982 < distance_154958; i_154982++) {
                    int64_t gt_arg1_154985 = add64((int64_t) 1, i_154982);
                    bool x_154986 = sle64((int64_t) 0, gt_arg1_154985);
                    bool y_154987 = slt64(gt_arg1_154985, block_sizze_154926);
                    bool bounds_check_154988 = x_154986 && y_154987;
                    bool index_certs_154989;
                    
                    if (!bounds_check_154988) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154985, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154991 = slt64(i_154982, block_sizze_154926);
                    bool index_certs_154992;
                    
                    if (!y_154991) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154982, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_154990 = ((double *) mem_164947)[gt_arg1_154985];
                    double gt_arg0_154993 = ((double *) mem_164947)[i_154982];
                    bool defunc_0_leq_res_154994 = gt_arg0_154993 <= gt_arg1_154990;
                    bool defunc_0_lifted_gt_res_154995 = !defunc_0_leq_res_154994;
                    bool s_154996;
                    int64_t s_154999;
                    bool loop_while_155000;
                    int64_t j_155003;
                    
                    loop_while_155000 = defunc_0_lifted_gt_res_154995;
                    j_155003 = i_154982;
                    while (loop_while_155000) {
                        bool x_155004 = sle64((int64_t) 0, j_155003);
                        bool y_155005 = slt64(j_155003, block_sizze_154926);
                        bool bounds_check_155006 = x_155004 && y_155005;
                        bool index_certs_155007;
                        
                        if (!bounds_check_155006) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155003, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155010 = add64((int64_t) 1, j_155003);
                        bool x_155011 = sle64((int64_t) 0, copy_arg0_155010);
                        bool y_155012 = slt64(copy_arg0_155010, block_sizze_154926);
                        bool bounds_check_155013 = x_155011 && y_155012;
                        bool index_certs_155014;
                        
                        if (!bounds_check_155013) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155010, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_155008 = ((double *) mem_164947)[j_155003];
                        int64_t copy_arg0_155009 = ((int64_t *) mem_164949)[j_155003];
                        double copy_arg0_155015 = ((double *) mem_164947)[copy_arg0_155010];
                        int64_t copy_arg0_155016 = ((int64_t *) mem_164949)[copy_arg0_155010];
                        
                        ((double *) mem_164947)[j_155003] = copy_arg0_155015;
                        ((int64_t *) mem_164949)[j_155003] = copy_arg0_155016;
                        ((double *) mem_164947)[copy_arg0_155010] = copy_arg0_155008;
                        ((int64_t *) mem_164949)[copy_arg0_155010] = copy_arg0_155009;
                        
                        int64_t tmp_155021 = sub64(j_155003, (int64_t) 1);
                        bool cond_155022 = sle64((int64_t) 0, tmp_155021);
                        bool loop_cond_155023;
                        
                        if (cond_155022) {
                            bool y_157008 = slt64(tmp_155021, block_sizze_154926);
                            bool bounds_check_157009 = cond_155022 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155021, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_157007 = ((double *) mem_164947)[j_155003];
                            double gt_arg0_157011 = ((double *) mem_164947)[tmp_155021];
                            bool defunc_0_leq_res_157012 = gt_arg0_157011 <= gt_arg1_157007;
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155023 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155023 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155023;
                        int64_t j_tmp_165710 = tmp_155021;
                        
                        loop_while_155000 = loop_while_tmp_165707;
                        j_155003 = j_tmp_165710;
                    }
                    s_154996 = loop_while_155000;
                    s_154999 = j_155003;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164934, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        if (memblock_alloc(ctx, &mem_165006, bytes_164933, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        
        int64_t data_155036;
        bool data_155037;
        int64_t data_155040;
        int64_t loop_dz2084Uz2082U_155041;
        bool loop_while_155042;
        int64_t stride_155045;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155041 = flat_dim_154927;
        loop_while_155042 = loop_cond_155033;
        stride_155045 = block_sizze_154926;
        while (loop_while_155042) {
            int64_t next_stride_155046 = mul64((int64_t) 2, stride_155045);
            bool zzero_155047 = next_stride_155046 == (int64_t) 0;
            bool nonzzero_155048 = !zzero_155047;
            bool nonzzero_cert_155049;
            
            if (!nonzzero_155048) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155050 = sdiv64(flat_dim_154927, next_stride_155046);
            bool bounds_invalid_upwards_155051 = slt64(num_merges_155050, (int64_t) 0);
            bool valid_155052 = !bounds_invalid_upwards_155051;
            bool range_valid_c_155053;
            
            if (!valid_155052) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155050, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:143:35-39\n   #6  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155055 = sub64(next_stride_155046, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155056 = sle64((int64_t) 0, m_155055);
            bool cond_155058 = slt64(next_stride_155046, (int64_t) 10);
            bool protect_assert_disj_155059 = nonzzero_155035 || cond_155058;
            bool nonzzero_cert_155060;
            
            if (!protect_assert_disj_155059) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155061 = smod_safe64(next_stride_155046, merge_block_sizze_154931);
            bool num_blocks_155062 = zeze_lhs_155061 == (int64_t) 0;
            bool protect_assert_disj_155063 = cond_155058 || num_blocks_155062;
            bool assert_c_155064;
            
            if (!protect_assert_disj_155063) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155066 = sdiv_safe64(next_stride_155046, merge_block_sizze_154931);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067 = add64((int64_t) 1, num_blocks_155066);
            int64_t j_m_i_155068 = sub64(next_stride_155046, stride_155045);
            int64_t flat_dim_155069 = merge_block_sizze_154931 * num_blocks_155066;
            bool bounds_invalid_upwards_155070 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, (int64_t) 0);
            bool empty_slice_155071 = j_m_i_155068 == (int64_t) 0;
            int64_t m_155072 = sub64(j_m_i_155068, (int64_t) 1);
            bool zzero_lte_i_155073 = sle64((int64_t) 0, stride_155045);
            bool i_lte_j_155074 = sle64(stride_155045, next_stride_155046);
            bool empty_slice_155075 = stride_155045 == (int64_t) 0;
            int64_t m_155076 = sub64(stride_155045, (int64_t) 1);
            bool bounds_invalid_upwards_155077 = slt64(num_blocks_155066, (int64_t) 0);
            bool cond_155078 = slt64((int64_t) 0, stride_155045);
            bool valid_155079 = !bounds_invalid_upwards_155070;
            int64_t i_p_m_t_s_155080 = add64(stride_155045, m_155072);
            bool zzero_leq_i_p_m_t_s_155081 = sle64((int64_t) 0, m_155076);
            bool i_p_m_t_s_leq_w_155082 = slt64(m_155076, next_stride_155046);
            bool valid_155083 = !bounds_invalid_upwards_155077;
            bool i_p_m_t_s_leq_w_155084 = slt64(m_155055, flat_dim_155069);
            bool y_155085 = slt64((int64_t) 0, j_m_i_155068);
            bool protect_assert_disj_155086 = cond_155058 || valid_155079;
            bool range_valid_c_155087;
            
            if (!protect_assert_disj_155086) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155088 = sle64((int64_t) 0, i_p_m_t_s_155080);
            bool i_p_m_t_s_leq_w_155089 = slt64(i_p_m_t_s_155080, next_stride_155046);
            bool y_155090 = zzero_leq_i_p_m_t_s_155081 && i_p_m_t_s_leq_w_155082;
            bool protect_assert_disj_155091 = cond_155058 || valid_155083;
            bool range_valid_c_155092;
            
            if (!protect_assert_disj_155091) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155093 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155084;
            bool y_155094 = zzero_lte_i_155073 && i_p_m_t_s_leq_w_155089;
            bool forwards_ok_155095 = zzero_lte_i_155073 && y_155090;
            bool ok_or_empty_155096 = zzero_155047 || y_155093;
            bool protect_assert_disj_155097 = cond_155078 || y_155085;
            bool y_155098 = zzero_leq_i_p_m_t_s_155088 && y_155094;
            bool ok_or_empty_155099 = empty_slice_155075 || forwards_ok_155095;
            bool protect_assert_disj_155100 = cond_155058 || ok_or_empty_155096;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) flat_dim_155069, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155102 = !cond_155058;
            bool protect_assert_disj_155103 = protect_assert_disj_155097 || loop_not_taken_155102;
            bool index_certs_155104;
            
            if (!protect_assert_disj_155103) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155105 = i_lte_j_155074 && y_155098;
            bool protect_assert_disj_155106 = cond_155058 || ok_or_empty_155099;
            bool index_certs_155107;
            
            if (!protect_assert_disj_155106) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155108 = ok_or_empty_155099 || loop_not_taken_155102;
            bool index_certs_155109;
            
            if (!protect_assert_disj_155108) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155110 = empty_slice_155071 || forwards_ok_155105;
            bool protect_assert_disj_155111 = cond_155058 || ok_or_empty_155110;
            bool index_certs_155112;
            
            if (!protect_assert_disj_155111) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155113 = loop_not_taken_155102 || ok_or_empty_155110;
            bool index_certs_155114;
            
            if (!protect_assert_disj_155113) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 8 * num_merges_155050;
            int64_t bytes_165015 = next_stride_155046 * binop_x_165014;
            bool i_lte_j_155057 = sle64((int64_t) 0, next_stride_155046);
            
            if (mem_165016_cached_sizze_166157 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166157, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166158 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166158, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067;
            int64_t binop_x_165044 = (int64_t) 8 * num_blocks_155066;
            int64_t bytes_165045 = merge_block_sizze_154931 * binop_x_165044;
            int64_t bytes_165090 = (int64_t) 16 * stride_155045;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155050; i_164746++) {
                int64_t start_155118 = mul64(next_stride_155046, i_164746);
                int64_t j_m_i_155119 = sub64(loop_dz2084Uz2082U_155041, start_155118);
                bool empty_slice_155120 = j_m_i_155119 == (int64_t) 0;
                int64_t m_155121 = sub64(j_m_i_155119, (int64_t) 1);
                int64_t i_p_m_t_s_155122 = add64(start_155118, m_155121);
                bool zzero_leq_i_p_m_t_s_155123 = sle64((int64_t) 0, i_p_m_t_s_155122);
                bool i_p_m_t_s_leq_w_155124 = slt64(i_p_m_t_s_155122, loop_dz2084Uz2082U_155041);
                bool zzero_lte_i_155125 = sle64((int64_t) 0, start_155118);
                bool i_lte_j_155126 = sle64(start_155118, loop_dz2084Uz2082U_155041);
                bool y_155127 = i_p_m_t_s_leq_w_155124 && zzero_lte_i_155125;
                bool y_155128 = zzero_leq_i_p_m_t_s_155123 && y_155127;
                bool forwards_ok_155129 = i_lte_j_155126 && y_155128;
                bool ok_or_empty_155130 = empty_slice_155120 || forwards_ok_155129;
                bool index_certs_155131;
                
                if (!ok_or_empty_155130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155118, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155041, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155132 = slt64(m_155055, j_m_i_155119);
                bool y_155133 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155132;
                bool forwards_ok_155134 = i_lte_j_155057 && y_155133;
                bool ok_or_empty_155135 = zzero_155047 || forwards_ok_155134;
                bool index_certs_155136;
                
                if (!ok_or_empty_155135) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) j_m_i_155119, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:143:35-39\n   #8  ftRelational.fut:142:9-143:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155058) {
                    double dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155078) {
                        double head_res_157041 = ((double *) mem_param_165010.mem)[start_155118];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155118];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155045 + start_155118;
                        double head_res_157044 = ((double *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155046; nest_i_165720++) {
                        ((double *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165090, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155046; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155046; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155068;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155045);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155068);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155045 + j_157055;
                                int64_t slice_157065 = start_155118 + slice_157064;
                                double leq_arg1_157066 = ((double *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155118 + i_157052;
                                double leq_arg0_157071 = ((double *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = leq_arg0_157071 <= leq_arg1_157066;
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        double loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155045);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155118 + i_157052;
                            double tmp_157082 = ((double *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155068);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:143:35-39\n   #9  ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155045 + j_157055;
                            int64_t slice_157089 = start_155118 + slice_157088;
                            double tmp_157090 = ((double *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((double *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166159 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166159, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166160 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166160, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067; i_164732++) {
                        int64_t split_count_arg3_155198 = mul64(merge_block_sizze_154931, i_164732);
                        int64_t defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155199, &defunc_0_split_count_res_155200, &defunc_0_split_count_res_155201, &defunc_0_split_count_res_155202, &defunc_0_split_count_res_155203, (int64_t) 0, stride_155045, (int64_t) 0, j_m_i_155068, split_count_arg3_155198) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155204 = slt64((int64_t) 0, defunc_0_split_count_res_155203);
                        bool defunc_0_split_count_res_155205;
                        int64_t defunc_0_split_count_res_155206;
                        int64_t defunc_0_split_count_res_155207;
                        int64_t defunc_0_split_count_res_155208;
                        int64_t defunc_0_split_count_res_155209;
                        int64_t defunc_0_split_count_res_155210;
                        bool loop_while_155211;
                        int64_t ss_155212;
                        int64_t ss_155213;
                        int64_t tt_155214;
                        int64_t tt_155215;
                        int64_t count_155216;
                        
                        loop_while_155211 = loop_cond_155204;
                        ss_155212 = defunc_0_split_count_res_155199;
                        ss_155213 = defunc_0_split_count_res_155200;
                        tt_155214 = defunc_0_split_count_res_155201;
                        tt_155215 = defunc_0_split_count_res_155202;
                        count_155216 = defunc_0_split_count_res_155203;
                        while (loop_while_155211) {
                            int64_t zlze_lhs_155217 = sub64(ss_155213, ss_155212);
                            bool cond_155218 = sle64(zlze_lhs_155217, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155219;
                            int64_t defunc_0_lifted_step_res_155220;
                            int64_t defunc_0_lifted_step_res_155221;
                            int64_t defunc_0_lifted_step_res_155222;
                            
                            if (cond_155218) {
                                int64_t tmp_157094 = add64(tt_155214, count_155216);
                                
                                defunc_0_lifted_step_res_155219 = ss_155212;
                                defunc_0_lifted_step_res_155220 = tmp_157094;
                                defunc_0_lifted_step_res_155221 = tt_155215;
                                defunc_0_lifted_step_res_155222 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155224 = sub64(tt_155215, tt_155214);
                                bool cond_155225 = sle64(zlze_lhs_155224, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155226;
                                int64_t defunc_0_lifted_step_res_f_res_155227;
                                int64_t defunc_0_lifted_step_res_f_res_155228;
                                int64_t defunc_0_lifted_step_res_f_res_155229;
                                
                                if (cond_155225) {
                                    int64_t tmp_157095 = add64(ss_155212, count_155216);
                                    
                                    defunc_0_lifted_step_res_f_res_155226 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155227 = tt_155214;
                                    defunc_0_lifted_step_res_f_res_155228 = tt_155215;
                                    defunc_0_lifted_step_res_f_res_155229 = (int64_t) 0;
                                } else {
                                    bool cond_155231 = count_155216 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155232;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155233;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155234;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155235;
                                    
                                    if (cond_155231) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155212);
                                        bool y_157098 = slt64(ss_155212, stride_155045);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155212, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155214);
                                        bool y_157104 = slt64(tt_155214, j_m_i_155068);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155214, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155118 + ss_155212;
                                        double leq_arg1_157102 = ((double *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155045 + tt_155214;
                                        int64_t slice_157108 = start_155118 + slice_157107;
                                        double leq_arg0_157109 = ((double *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = leq_arg0_157109 <= leq_arg1_157102;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155214);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155212;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155212);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155214;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = tt_155215;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = (int64_t) 0;
                                    } else {
                                        int64_t m_155254 = sdiv64(count_155216, (int64_t) 2);
                                        int64_t n_155255 = sub64(count_155216, m_155254);
                                        bool cond_155256 = n_155255 == (int64_t) 0;
                                        int64_t zgze_lhs_155257 = add64(ss_155212, m_155254);
                                        bool cond_f_res_155258 = sle64(ss_155213, zgze_lhs_155257);
                                        bool x_155259 = !cond_155256;
                                        bool y_155260 = cond_f_res_155258 && x_155259;
                                        bool cond_155261 = cond_155256 || y_155260;
                                        bool leq_y_x_155262;
                                        
                                        if (cond_155261) {
                                            leq_y_x_155262 = 1;
                                        } else {
                                            bool x_155263 = sle64((int64_t) 0, zgze_lhs_155257);
                                            bool y_155264 = slt64(zgze_lhs_155257, stride_155045);
                                            bool bounds_check_155265 = x_155263 && y_155264;
                                            bool index_certs_155266;
                                            
                                            if (!bounds_check_155265) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155257, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155269 = add64(tt_155214, n_155255);
                                            int64_t leq_arg0_155270 = sub64(zm_lhs_155269, (int64_t) 1);
                                            bool x_155271 = sle64((int64_t) 0, leq_arg0_155270);
                                            bool y_155272 = slt64(leq_arg0_155270, j_m_i_155068);
                                            bool bounds_check_155273 = x_155271 && y_155272;
                                            bool index_certs_155274;
                                            
                                            if (!bounds_check_155273) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155270, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:143:35-39\n   #13 ftRelational.fut:142:9-143:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155267 = start_155118 + zgze_lhs_155257;
                                            double leq_arg1_155268 = ((double *) mem_param_165010.mem)[slice_155267];
                                            int64_t slice_155275 = stride_155045 + leq_arg0_155270;
                                            int64_t slice_155276 = start_155118 + slice_155275;
                                            double leq_arg0_155277 = ((double *) mem_param_165010.mem)[slice_155276];
                                            bool defunc_0_leq_res_155278 = leq_arg0_155277 <= leq_arg1_155268;
                                            
                                            leq_y_x_155262 = defunc_0_leq_res_155278;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                        
                                        if (leq_y_x_155262) {
                                            int64_t tmp_157115 = add64(tt_155214, n_155255);
                                            int64_t tmp_157116 = sub64(count_155216, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tt_155215;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = tmp_157116;
                                        } else {
                                            int64_t tmp_155284 = add64(tt_155214, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tt_155214;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tmp_155284;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = count_155216;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = ss_155212;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                    }
                                    defunc_0_lifted_step_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_155232;
                                    defunc_0_lifted_step_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_155233;
                                    defunc_0_lifted_step_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_155234;
                                    defunc_0_lifted_step_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_155235;
                                }
                                defunc_0_lifted_step_res_155219 = defunc_0_lifted_step_res_f_res_155226;
                                defunc_0_lifted_step_res_155220 = defunc_0_lifted_step_res_f_res_155227;
                                defunc_0_lifted_step_res_155221 = defunc_0_lifted_step_res_f_res_155228;
                                defunc_0_lifted_step_res_155222 = defunc_0_lifted_step_res_f_res_155229;
                            }
                            
                            int64_t loopres_155285;
                            int64_t loopres_155286;
                            int64_t loopres_155287;
                            int64_t loopres_155288;
                            int64_t loopres_155289;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155285, &loopres_155286, &loopres_155287, &loopres_155288, &loopres_155289, defunc_0_lifted_step_res_155219, ss_155213, defunc_0_lifted_step_res_155220, defunc_0_lifted_step_res_155221, defunc_0_lifted_step_res_155222) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155290 = slt64((int64_t) 0, loopres_155289);
                            bool loop_while_tmp_165727 = loop_cond_155290;
                            int64_t ss_tmp_165728 = loopres_155285;
                            int64_t ss_tmp_165729 = loopres_155286;
                            int64_t tt_tmp_165730 = loopres_155287;
                            int64_t tt_tmp_165731 = loopres_155288;
                            int64_t count_tmp_165732 = loopres_155289;
                            
                            loop_while_155211 = loop_while_tmp_165727;
                            ss_155212 = ss_tmp_165728;
                            ss_155213 = ss_tmp_165729;
                            tt_155214 = tt_tmp_165730;
                            tt_155215 = tt_tmp_165731;
                            count_155216 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155205 = loop_while_155211;
                        defunc_0_split_count_res_155206 = ss_155212;
                        defunc_0_split_count_res_155207 = ss_155213;
                        defunc_0_split_count_res_155208 = tt_155214;
                        defunc_0_split_count_res_155209 = tt_155215;
                        defunc_0_split_count_res_155210 = count_155216;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155206;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155208;
                    }
                    if (mem_165046_cached_sizze_166161 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166161, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166162 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166162, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155066; i_164739++) {
                        bool y_155296 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool index_certs_155298;
                        
                        if (!y_155296) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155299 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155301 = add64((int64_t) 1, i_164739);
                        bool x_155302 = sle64((int64_t) 0, tmp_155301);
                        bool y_155303 = slt64(tmp_155301, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool bounds_check_155304 = x_155302 && y_155303;
                        bool index_certs_155305;
                        
                        if (!bounds_check_155304) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155301, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155306 = ((int64_t *) mem_165029)[tmp_155301];
                        int64_t defunc_0_f_res_155307 = ((int64_t *) mem_165031)[tmp_155301];
                        int64_t merge_sequential_arg2_155308 = add64(stride_155045, defunc_0_f_res_155300);
                        int64_t merge_sequential_arg2_155309 = add64(stride_155045, defunc_0_f_res_155307);
                        int64_t j_m_i_155310 = sub64(merge_sequential_arg2_155309, merge_sequential_arg2_155308);
                        bool empty_slice_155311 = j_m_i_155310 == (int64_t) 0;
                        int64_t m_155312 = sub64(j_m_i_155310, (int64_t) 1);
                        int64_t i_p_m_t_s_155313 = add64(merge_sequential_arg2_155308, m_155312);
                        bool zzero_leq_i_p_m_t_s_155314 = sle64((int64_t) 0, i_p_m_t_s_155313);
                        bool i_p_m_t_s_leq_w_155315 = slt64(i_p_m_t_s_155313, next_stride_155046);
                        bool zzero_lte_i_155316 = sle64((int64_t) 0, merge_sequential_arg2_155308);
                        bool i_lte_j_155317 = sle64(merge_sequential_arg2_155308, merge_sequential_arg2_155309);
                        bool y_155318 = i_p_m_t_s_leq_w_155315 && zzero_lte_i_155316;
                        bool y_155319 = zzero_leq_i_p_m_t_s_155314 && y_155318;
                        bool forwards_ok_155320 = i_lte_j_155317 && y_155319;
                        bool ok_or_empty_155321 = empty_slice_155311 || forwards_ok_155320;
                        bool index_certs_155322;
                        
                        if (!ok_or_empty_155321) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155308, ":", (long long) merge_sequential_arg2_155309, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155323 = sub64(defunc_0_f_res_155306, defunc_0_f_res_155299);
                        bool empty_slice_155324 = j_m_i_155323 == (int64_t) 0;
                        int64_t m_155325 = sub64(j_m_i_155323, (int64_t) 1);
                        int64_t i_p_m_t_s_155326 = add64(defunc_0_f_res_155299, m_155325);
                        bool zzero_leq_i_p_m_t_s_155327 = sle64((int64_t) 0, i_p_m_t_s_155326);
                        bool i_p_m_t_s_leq_w_155328 = slt64(i_p_m_t_s_155326, next_stride_155046);
                        bool zzero_lte_i_155329 = sle64((int64_t) 0, defunc_0_f_res_155299);
                        bool i_lte_j_155330 = sle64(defunc_0_f_res_155299, defunc_0_f_res_155306);
                        bool y_155331 = i_p_m_t_s_leq_w_155328 && zzero_lte_i_155329;
                        bool y_155332 = zzero_leq_i_p_m_t_s_155327 && y_155331;
                        bool forwards_ok_155333 = i_lte_j_155330 && y_155332;
                        bool ok_or_empty_155334 = empty_slice_155324 || forwards_ok_155333;
                        bool index_certs_155335;
                        
                        if (!ok_or_empty_155334) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155299, ":", (long long) defunc_0_f_res_155306, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:143:35-39\n   #10 ftRelational.fut:142:9-143:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155336 = slt64((int64_t) 0, j_m_i_155323);
                        double dummy_155337;
                        int64_t dummy_155338;
                        
                        if (cond_155336) {
                            bool index_certs_157117;
                            
                            if (!cond_155336) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:143:35-39\n   #12 ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155118 + defunc_0_f_res_155299;
                            double head_res_157119 = ((double *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155337 = head_res_157119;
                            dummy_155338 = head_res_157120;
                        } else {
                            bool y_155343 = slt64((int64_t) 0, j_m_i_155310);
                            bool index_certs_155344;
                            
                            if (!y_155343) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:143:35-39\n   #12 ftRelational.fut:142:9-143:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155345 = start_155118 + merge_sequential_arg2_155308;
                            double head_res_155346 = ((double *) mem_param_165010.mem)[slice_155345];
                            int64_t head_res_155347 = ((int64_t *) mem_param_165013.mem)[slice_155345];
                            
                            dummy_155337 = head_res_155346;
                            dummy_155338 = head_res_155347;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154931; nest_i_165735++) {
                            ((double *) mem_165046)[i_164739 * merge_block_sizze_154931 + nest_i_165735] = dummy_155337;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154931; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + nest_i_165736] = dummy_155338;
                        }
                        
                        int64_t data_155350;
                        int64_t i_155354 = (int64_t) 0;
                        
                        for (int64_t k_155353 = 0; k_155353 < merge_block_sizze_154931; k_155353++) {
                            int64_t j_155357 = sub64(k_155353, i_155354);
                            bool cond_155358 = j_155357 == j_m_i_155310;
                            bool cond_155359;
                            
                            if (cond_155358) {
                                cond_155359 = 1;
                            } else {
                                bool cond_155360 = slt64(i_155354, j_m_i_155323);
                                bool cond_f_res_155361;
                                
                                if (cond_155360) {
                                    bool x_157121 = sle64((int64_t) 0, j_155357);
                                    bool y_157122 = slt64(j_155357, j_m_i_155310);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155354);
                                    bool bounds_check_157129 = cond_155360 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155308 + j_155357;
                                    int64_t slice_157126 = start_155118 + slice_157125;
                                    double leq_arg1_157127 = ((double *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155299 + i_155354;
                                    int64_t slice_157132 = start_155118 + slice_157131;
                                    double leq_arg0_157133 = ((double *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = leq_arg0_157133 <= leq_arg1_157127;
                                    
                                    cond_f_res_155361 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155361 = 0;
                                }
                                cond_155359 = cond_f_res_155361;
                            }
                            
                            int64_t loopres_155376;
                            double loopres_155377;
                            int64_t loopres_155378;
                            
                            if (cond_155359) {
                                bool x_157136 = sle64((int64_t) 0, i_155354);
                                bool y_157137 = slt64(i_155354, j_m_i_155323);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155354);
                                int64_t slice_157140 = defunc_0_f_res_155299 + i_155354;
                                int64_t slice_157141 = start_155118 + slice_157140;
                                double tmp_157142 = ((double *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155376 = tmp_157135;
                                loopres_155377 = tmp_157142;
                                loopres_155378 = tmp_157143;
                            } else {
                                bool x_155388 = sle64((int64_t) 0, j_155357);
                                bool y_155389 = slt64(j_155357, j_m_i_155310);
                                bool bounds_check_155390 = x_155388 && y_155389;
                                bool index_certs_155391;
                                
                                if (!bounds_check_155390) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:143:35-39\n   #11 ftRelational.fut:142:9-143:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155392 = merge_sequential_arg2_155308 + j_155357;
                                int64_t slice_155393 = start_155118 + slice_155392;
                                double tmp_155394 = ((double *) mem_param_165010.mem)[slice_155393];
                                int64_t tmp_155395 = ((int64_t *) mem_param_165013.mem)[slice_155393];
                                
                                loopres_155376 = i_155354;
                                loopres_155377 = tmp_155394;
                                loopres_155378 = tmp_155395;
                            }
                            ((double *) mem_165046)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155377;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155378;
                            
                            int64_t i_tmp_165737 = loopres_155376;
                            
                            i_155354 = i_tmp_165737;
                        }
                        data_155350 = i_155354;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165045, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165016, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155402 = next_stride_155046 * num_merges_155050;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            if (memblock_alloc(ctx, &mem_165126, bytes_165015, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            
            bool loop_cond_155405 = slt64(next_stride_155046, flat_dim_154927);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155402;
            bool loop_while_tmp_165714 = loop_cond_155405;
            int64_t stride_tmp_165717 = next_stride_155046;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155041 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155042 = loop_while_tmp_165714;
            stride_155045 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155036 = loop_dz2084Uz2082U_155041;
        data_155037 = loop_while_155042;
        data_155040 = stride_155045;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155406 = n_111087 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155407 = sle64((int64_t) 0, zs_lhs_154911);
        bool i_p_m_t_s_leq_w_155408 = slt64(zs_lhs_154911, data_155036);
        bool y_155409 = zzero_leq_i_p_m_t_s_155407 && i_p_m_t_s_leq_w_155408;
        bool ok_or_empty_155410 = empty_slice_155406 || y_155409;
        bool index_certs_155411;
        
        if (!ok_or_empty_155410) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_111087, "] out of bounds for array of shape [", (long long) data_155036, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:143:35-39\n   #6  ftRelational.fut:142:9-143:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_164930, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_111087; i_164753++) {
        int64_t eta_p_155419 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155420 = sle64((int64_t) 0, eta_p_155419);
        bool y_155421 = slt64(eta_p_155419, n_111087);
        bool bounds_check_155422 = x_155420 && y_155421;
        bool index_certs_155423;
        
        if (!bounds_check_155422) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155419, "] out of bounds for array of shape [", (long long) n_111087, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:143:35-39\n   #5  ftRelational.fut:142:9-143:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_155424 = ((int64_t *) ext_mem_164929.mem)[eta_p_155419];
        double lifted_lambda_res_155425 = ((double *) xs_mem_164928.mem)[eta_p_155419];
        
        ((int64_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155424;
        ((double *) mem_165140.mem)[i_164753] = lifted_lambda_res_155425;
    }
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166151, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166152, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_166163, struct memblock *mem_out_p_166164, struct memblock xs_mem_164928, int64_t n_108942, int64_t incr_108943)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166165 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166166 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166167 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166168 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166169 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166170 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166171 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166172 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166173 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166174 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_108942;
    bool cond_154910 = sle64(n_108942, (int64_t) 1);
    int64_t zs_lhs_154911 = sub64(n_108942, (int64_t) 1);
    int64_t zp_rhs_154912 = sdiv_safe64(zs_lhs_154911, (int64_t) 20);
    int64_t min_num_blocks_154913 = add64((int64_t) 1, zp_rhs_154912);
    bool loop_cond_154914 = slt64((int64_t) 1, min_num_blocks_154913);
    bool smallest_pow_2_geq_than_res_154915;
    int64_t smallest_pow_2_geq_than_res_154916;
    bool loop_while_154917;
    int64_t x_154918;
    
    loop_while_154917 = loop_cond_154914;
    x_154918 = (int64_t) 1;
    while (loop_while_154917) {
        int64_t loopres_154919 = mul64((int64_t) 2, x_154918);
        bool loop_cond_154920 = slt64(loopres_154919, min_num_blocks_154913);
        bool loop_while_tmp_165695 = loop_cond_154920;
        int64_t x_tmp_165696 = loopres_154919;
        
        loop_while_154917 = loop_while_tmp_165695;
        x_154918 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154915 = loop_while_154917;
    smallest_pow_2_geq_than_res_154916 = x_154918;
    
    bool zzero_154921 = smallest_pow_2_geq_than_res_154916 == (int64_t) 0;
    bool nonzzero_154922 = !zzero_154921;
    bool protect_assert_disj_154923 = cond_154910 || nonzzero_154922;
    bool nonzzero_cert_154924;
    
    if (!protect_assert_disj_154923) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154925 = sdiv_safe64(zs_lhs_154911, smallest_pow_2_geq_than_res_154916);
    int64_t block_sizze_154926 = add64((int64_t) 1, zp_rhs_154925);
    bool y_154932 = slt64((int64_t) 0, n_108942);
    bool protect_assert_disj_165536 = cond_154910 || y_154932;
    bool index_certs_154933;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_108942, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154947 = slt64(smallest_pow_2_geq_than_res_154916, (int64_t) 0);
    bool valid_154948 = !bounds_invalid_upwards_154947;
    bool protect_assert_disj_165544 = cond_154910 || valid_154948;
    bool range_valid_c_154949;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154916, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:141:35-39\n   #6  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154951 = slt64(block_sizze_154926, (int64_t) 0);
    bool valid_154952 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_165546 = cond_154910 || valid_154952;
    bool range_valid_c_154953;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154926, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154955 = sle64(block_sizze_154926, (int64_t) 1);
    int64_t tmp_154956 = sub64(block_sizze_154926, (int64_t) 2);
    bool bounds_invalid_upwards_154957 = slt64(tmp_154956, (int64_t) 0);
    bool valid_154959 = !bounds_invalid_upwards_154957;
    bool protect_assert_disj_154960 = cond_154955 || valid_154959;
    bool protect_assert_disj_165548 = cond_154910 || protect_assert_disj_154960;
    bool range_valid_c_154961;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154956, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165139 = (int64_t) 4 * n_108942;
    
    if (futrts_indicesWithIncrement_12206(ctx, &ext_mem_164929, xs_mem_164928, n_108942, incr_108943) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_108942; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154927 = smallest_pow_2_geq_than_res_154916 * block_sizze_154926;
    bool x_165531 = !cond_154910;
    int64_t greatest_divisor_leq_than_arg1_154930 = mul64((int64_t) 2, block_sizze_154926);
    int64_t merge_block_sizze_154931;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154930) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154931 = x_165533;
    } else {
        merge_block_sizze_154931 = (int64_t) 0;
    }
    
    float reduce_arg1_154934;
    
    if (x_165531) {
        float x_165537 = ((float *) xs_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154934 = x_165537;
    } else {
        reduce_arg1_154934 = 0.0F;
    }
    
    float defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        float x_165539;
        int64_t x_165540;
        float redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154934;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_108942; i_164713++) {
            float x_154938 = ((float *) xs_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154944 = redout_164711 <= x_154938;
            float defunc_0_op_res_154945;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154945 = x_154938;
            } else {
                defunc_0_op_res_154945 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154946;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154946 = i_164713;
            } else {
                defunc_0_op_res_154946 = redout_164712;
            }
            
            float redout_tmp_165699 = defunc_0_op_res_154945;
            int64_t redout_tmp_165700 = defunc_0_op_res_154946;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = 0.0F;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154958 = add64((int64_t) 1, tmp_154956);
    int64_t binop_x_164932 = (int64_t) 4 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164933 = block_sizze_154926 * binop_x_164932;
    int64_t binop_x_164935 = (int64_t) 8 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164936 = block_sizze_154926 * binop_x_164935;
    int64_t bytes_164946 = (int64_t) 4 * block_sizze_154926;
    int64_t bytes_164948 = (int64_t) 8 * block_sizze_154926;
    bool loop_cond_155033 = slt64(block_sizze_154926, flat_dim_154927);
    bool zzero_155034 = merge_block_sizze_154931 == (int64_t) 0;
    bool nonzzero_155035 = !zzero_155034;
    
    if (cond_154910) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166165 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166165, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166166 < bytes_164936) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166166, bytes_164936);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166167 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166167, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166168 < bytes_164948) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166168, bytes_164948);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154916; i_164725++) {
            int64_t zp_lhs_154965 = mul64(block_sizze_154926, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154926; i_164718++) {
                int64_t k_154969 = add64(zp_lhs_154965, i_164718);
                bool cond_154970 = slt64(k_154969, n_108942);
                float lifted_lambda_res_154971;
                int64_t lifted_lambda_res_154972;
                
                if (cond_154970) {
                    bool x_157003 = sle64((int64_t) 0, k_154969);
                    bool bounds_check_157004 = cond_154970 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154969, "] out of bounds for array of shape [", (long long) n_108942, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_157006 = ((float *) xs_mem_164928.mem)[k_154969];
                    
                    lifted_lambda_res_154971 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154972 = k_154969;
                } else {
                    lifted_lambda_res_154971 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154972 = defunc_0_reduce_res_157151;
                }
                ((float *) mem_164947)[i_164718] = lifted_lambda_res_154971;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154972;
            }
            if (!cond_154955) {
                for (int64_t i_154982 = 0; i_154982 < distance_154958; i_154982++) {
                    int64_t gt_arg1_154985 = add64((int64_t) 1, i_154982);
                    bool x_154986 = sle64((int64_t) 0, gt_arg1_154985);
                    bool y_154987 = slt64(gt_arg1_154985, block_sizze_154926);
                    bool bounds_check_154988 = x_154986 && y_154987;
                    bool index_certs_154989;
                    
                    if (!bounds_check_154988) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154985, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154991 = slt64(i_154982, block_sizze_154926);
                    bool index_certs_154992;
                    
                    if (!y_154991) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154982, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_154990 = ((float *) mem_164947)[gt_arg1_154985];
                    float gt_arg0_154993 = ((float *) mem_164947)[i_154982];
                    bool defunc_0_leq_res_154994 = gt_arg0_154993 <= gt_arg1_154990;
                    bool defunc_0_lifted_gt_res_154995 = !defunc_0_leq_res_154994;
                    bool s_154996;
                    int64_t s_154999;
                    bool loop_while_155000;
                    int64_t j_155003;
                    
                    loop_while_155000 = defunc_0_lifted_gt_res_154995;
                    j_155003 = i_154982;
                    while (loop_while_155000) {
                        bool x_155004 = sle64((int64_t) 0, j_155003);
                        bool y_155005 = slt64(j_155003, block_sizze_154926);
                        bool bounds_check_155006 = x_155004 && y_155005;
                        bool index_certs_155007;
                        
                        if (!bounds_check_155006) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155003, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155010 = add64((int64_t) 1, j_155003);
                        bool x_155011 = sle64((int64_t) 0, copy_arg0_155010);
                        bool y_155012 = slt64(copy_arg0_155010, block_sizze_154926);
                        bool bounds_check_155013 = x_155011 && y_155012;
                        bool index_certs_155014;
                        
                        if (!bounds_check_155013) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155010, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_155008 = ((float *) mem_164947)[j_155003];
                        int64_t copy_arg0_155009 = ((int64_t *) mem_164949)[j_155003];
                        float copy_arg0_155015 = ((float *) mem_164947)[copy_arg0_155010];
                        int64_t copy_arg0_155016 = ((int64_t *) mem_164949)[copy_arg0_155010];
                        
                        ((float *) mem_164947)[j_155003] = copy_arg0_155015;
                        ((int64_t *) mem_164949)[j_155003] = copy_arg0_155016;
                        ((float *) mem_164947)[copy_arg0_155010] = copy_arg0_155008;
                        ((int64_t *) mem_164949)[copy_arg0_155010] = copy_arg0_155009;
                        
                        int64_t tmp_155021 = sub64(j_155003, (int64_t) 1);
                        bool cond_155022 = sle64((int64_t) 0, tmp_155021);
                        bool loop_cond_155023;
                        
                        if (cond_155022) {
                            bool y_157008 = slt64(tmp_155021, block_sizze_154926);
                            bool bounds_check_157009 = cond_155022 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155021, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_157007 = ((float *) mem_164947)[j_155003];
                            float gt_arg0_157011 = ((float *) mem_164947)[tmp_155021];
                            bool defunc_0_leq_res_157012 = gt_arg0_157011 <= gt_arg1_157007;
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155023 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155023 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155023;
                        int64_t j_tmp_165710 = tmp_155021;
                        
                        loop_while_155000 = loop_while_tmp_165707;
                        j_155003 = j_tmp_165710;
                    }
                    s_154996 = loop_while_155000;
                    s_154999 = j_155003;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164934, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint32_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        if (memblock_alloc(ctx, &mem_165006, bytes_164936, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        
        int64_t data_155036;
        bool data_155037;
        int64_t data_155040;
        int64_t loop_dz2084Uz2082U_155041;
        bool loop_while_155042;
        int64_t stride_155045;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155041 = flat_dim_154927;
        loop_while_155042 = loop_cond_155033;
        stride_155045 = block_sizze_154926;
        while (loop_while_155042) {
            int64_t next_stride_155046 = mul64((int64_t) 2, stride_155045);
            bool zzero_155047 = next_stride_155046 == (int64_t) 0;
            bool nonzzero_155048 = !zzero_155047;
            bool nonzzero_cert_155049;
            
            if (!nonzzero_155048) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155050 = sdiv64(flat_dim_154927, next_stride_155046);
            bool bounds_invalid_upwards_155051 = slt64(num_merges_155050, (int64_t) 0);
            bool valid_155052 = !bounds_invalid_upwards_155051;
            bool range_valid_c_155053;
            
            if (!valid_155052) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155050, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:141:35-39\n   #6  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155055 = sub64(next_stride_155046, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155056 = sle64((int64_t) 0, m_155055);
            bool cond_155058 = slt64(next_stride_155046, (int64_t) 10);
            bool protect_assert_disj_155059 = nonzzero_155035 || cond_155058;
            bool nonzzero_cert_155060;
            
            if (!protect_assert_disj_155059) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155061 = smod_safe64(next_stride_155046, merge_block_sizze_154931);
            bool num_blocks_155062 = zeze_lhs_155061 == (int64_t) 0;
            bool protect_assert_disj_155063 = cond_155058 || num_blocks_155062;
            bool assert_c_155064;
            
            if (!protect_assert_disj_155063) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155066 = sdiv_safe64(next_stride_155046, merge_block_sizze_154931);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067 = add64((int64_t) 1, num_blocks_155066);
            int64_t j_m_i_155068 = sub64(next_stride_155046, stride_155045);
            int64_t flat_dim_155069 = merge_block_sizze_154931 * num_blocks_155066;
            bool bounds_invalid_upwards_155070 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, (int64_t) 0);
            bool empty_slice_155071 = j_m_i_155068 == (int64_t) 0;
            int64_t m_155072 = sub64(j_m_i_155068, (int64_t) 1);
            bool zzero_lte_i_155073 = sle64((int64_t) 0, stride_155045);
            bool i_lte_j_155074 = sle64(stride_155045, next_stride_155046);
            bool empty_slice_155075 = stride_155045 == (int64_t) 0;
            int64_t m_155076 = sub64(stride_155045, (int64_t) 1);
            bool bounds_invalid_upwards_155077 = slt64(num_blocks_155066, (int64_t) 0);
            bool cond_155078 = slt64((int64_t) 0, stride_155045);
            bool valid_155079 = !bounds_invalid_upwards_155070;
            int64_t i_p_m_t_s_155080 = add64(stride_155045, m_155072);
            bool zzero_leq_i_p_m_t_s_155081 = sle64((int64_t) 0, m_155076);
            bool i_p_m_t_s_leq_w_155082 = slt64(m_155076, next_stride_155046);
            bool valid_155083 = !bounds_invalid_upwards_155077;
            bool i_p_m_t_s_leq_w_155084 = slt64(m_155055, flat_dim_155069);
            bool y_155085 = slt64((int64_t) 0, j_m_i_155068);
            bool protect_assert_disj_155086 = cond_155058 || valid_155079;
            bool range_valid_c_155087;
            
            if (!protect_assert_disj_155086) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155088 = sle64((int64_t) 0, i_p_m_t_s_155080);
            bool i_p_m_t_s_leq_w_155089 = slt64(i_p_m_t_s_155080, next_stride_155046);
            bool y_155090 = zzero_leq_i_p_m_t_s_155081 && i_p_m_t_s_leq_w_155082;
            bool protect_assert_disj_155091 = cond_155058 || valid_155083;
            bool range_valid_c_155092;
            
            if (!protect_assert_disj_155091) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155093 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155084;
            bool y_155094 = zzero_lte_i_155073 && i_p_m_t_s_leq_w_155089;
            bool forwards_ok_155095 = zzero_lte_i_155073 && y_155090;
            bool ok_or_empty_155096 = zzero_155047 || y_155093;
            bool protect_assert_disj_155097 = cond_155078 || y_155085;
            bool y_155098 = zzero_leq_i_p_m_t_s_155088 && y_155094;
            bool ok_or_empty_155099 = empty_slice_155075 || forwards_ok_155095;
            bool protect_assert_disj_155100 = cond_155058 || ok_or_empty_155096;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) flat_dim_155069, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155102 = !cond_155058;
            bool protect_assert_disj_155103 = protect_assert_disj_155097 || loop_not_taken_155102;
            bool index_certs_155104;
            
            if (!protect_assert_disj_155103) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155105 = i_lte_j_155074 && y_155098;
            bool protect_assert_disj_155106 = cond_155058 || ok_or_empty_155099;
            bool index_certs_155107;
            
            if (!protect_assert_disj_155106) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155108 = ok_or_empty_155099 || loop_not_taken_155102;
            bool index_certs_155109;
            
            if (!protect_assert_disj_155108) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155110 = empty_slice_155071 || forwards_ok_155105;
            bool protect_assert_disj_155111 = cond_155058 || ok_or_empty_155110;
            bool index_certs_155112;
            
            if (!protect_assert_disj_155111) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155113 = loop_not_taken_155102 || ok_or_empty_155110;
            bool index_certs_155114;
            
            if (!protect_assert_disj_155113) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 4 * num_merges_155050;
            int64_t bytes_165015 = next_stride_155046 * binop_x_165014;
            int64_t binop_x_165017 = (int64_t) 8 * num_merges_155050;
            int64_t bytes_165018 = next_stride_155046 * binop_x_165017;
            bool i_lte_j_155057 = sle64((int64_t) 0, next_stride_155046);
            
            if (mem_165016_cached_sizze_166169 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166169, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166170 < bytes_165018) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166170, bytes_165018);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067;
            int64_t binop_x_165044 = (int64_t) 4 * num_blocks_155066;
            int64_t bytes_165045 = merge_block_sizze_154931 * binop_x_165044;
            int64_t binop_x_165047 = (int64_t) 8 * num_blocks_155066;
            int64_t bytes_165048 = merge_block_sizze_154931 * binop_x_165047;
            int64_t bytes_165090 = (int64_t) 8 * stride_155045;
            int64_t bytes_165092 = (int64_t) 16 * stride_155045;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155050; i_164746++) {
                int64_t start_155118 = mul64(next_stride_155046, i_164746);
                int64_t j_m_i_155119 = sub64(loop_dz2084Uz2082U_155041, start_155118);
                bool empty_slice_155120 = j_m_i_155119 == (int64_t) 0;
                int64_t m_155121 = sub64(j_m_i_155119, (int64_t) 1);
                int64_t i_p_m_t_s_155122 = add64(start_155118, m_155121);
                bool zzero_leq_i_p_m_t_s_155123 = sle64((int64_t) 0, i_p_m_t_s_155122);
                bool i_p_m_t_s_leq_w_155124 = slt64(i_p_m_t_s_155122, loop_dz2084Uz2082U_155041);
                bool zzero_lte_i_155125 = sle64((int64_t) 0, start_155118);
                bool i_lte_j_155126 = sle64(start_155118, loop_dz2084Uz2082U_155041);
                bool y_155127 = i_p_m_t_s_leq_w_155124 && zzero_lte_i_155125;
                bool y_155128 = zzero_leq_i_p_m_t_s_155123 && y_155127;
                bool forwards_ok_155129 = i_lte_j_155126 && y_155128;
                bool ok_or_empty_155130 = empty_slice_155120 || forwards_ok_155129;
                bool index_certs_155131;
                
                if (!ok_or_empty_155130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155118, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155041, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155132 = slt64(m_155055, j_m_i_155119);
                bool y_155133 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155132;
                bool forwards_ok_155134 = i_lte_j_155057 && y_155133;
                bool ok_or_empty_155135 = zzero_155047 || forwards_ok_155134;
                bool index_certs_155136;
                
                if (!ok_or_empty_155135) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) j_m_i_155119, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:141:35-39\n   #8  ftRelational.fut:140:9-141:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155058) {
                    float dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155078) {
                        float head_res_157041 = ((float *) mem_param_165010.mem)[start_155118];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155118];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155045 + start_155118;
                        float head_res_157044 = ((float *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155046; nest_i_165720++) {
                        ((float *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165092, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155046; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155046; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155068;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155045);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155068);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155045 + j_157055;
                                int64_t slice_157065 = start_155118 + slice_157064;
                                float leq_arg1_157066 = ((float *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155118 + i_157052;
                                float leq_arg0_157071 = ((float *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = leq_arg0_157071 <= leq_arg1_157066;
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        float loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155045);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155118 + i_157052;
                            float tmp_157082 = ((float *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155068);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:141:35-39\n   #9  ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155045 + j_157055;
                            int64_t slice_157089 = start_155118 + slice_157088;
                            float tmp_157090 = ((float *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((float *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166171 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166171, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166172 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166172, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067; i_164732++) {
                        int64_t split_count_arg3_155198 = mul64(merge_block_sizze_154931, i_164732);
                        int64_t defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155199, &defunc_0_split_count_res_155200, &defunc_0_split_count_res_155201, &defunc_0_split_count_res_155202, &defunc_0_split_count_res_155203, (int64_t) 0, stride_155045, (int64_t) 0, j_m_i_155068, split_count_arg3_155198) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155204 = slt64((int64_t) 0, defunc_0_split_count_res_155203);
                        bool defunc_0_split_count_res_155205;
                        int64_t defunc_0_split_count_res_155206;
                        int64_t defunc_0_split_count_res_155207;
                        int64_t defunc_0_split_count_res_155208;
                        int64_t defunc_0_split_count_res_155209;
                        int64_t defunc_0_split_count_res_155210;
                        bool loop_while_155211;
                        int64_t ss_155212;
                        int64_t ss_155213;
                        int64_t tt_155214;
                        int64_t tt_155215;
                        int64_t count_155216;
                        
                        loop_while_155211 = loop_cond_155204;
                        ss_155212 = defunc_0_split_count_res_155199;
                        ss_155213 = defunc_0_split_count_res_155200;
                        tt_155214 = defunc_0_split_count_res_155201;
                        tt_155215 = defunc_0_split_count_res_155202;
                        count_155216 = defunc_0_split_count_res_155203;
                        while (loop_while_155211) {
                            int64_t zlze_lhs_155217 = sub64(ss_155213, ss_155212);
                            bool cond_155218 = sle64(zlze_lhs_155217, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155219;
                            int64_t defunc_0_lifted_step_res_155220;
                            int64_t defunc_0_lifted_step_res_155221;
                            int64_t defunc_0_lifted_step_res_155222;
                            
                            if (cond_155218) {
                                int64_t tmp_157094 = add64(tt_155214, count_155216);
                                
                                defunc_0_lifted_step_res_155219 = ss_155212;
                                defunc_0_lifted_step_res_155220 = tmp_157094;
                                defunc_0_lifted_step_res_155221 = tt_155215;
                                defunc_0_lifted_step_res_155222 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155224 = sub64(tt_155215, tt_155214);
                                bool cond_155225 = sle64(zlze_lhs_155224, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155226;
                                int64_t defunc_0_lifted_step_res_f_res_155227;
                                int64_t defunc_0_lifted_step_res_f_res_155228;
                                int64_t defunc_0_lifted_step_res_f_res_155229;
                                
                                if (cond_155225) {
                                    int64_t tmp_157095 = add64(ss_155212, count_155216);
                                    
                                    defunc_0_lifted_step_res_f_res_155226 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155227 = tt_155214;
                                    defunc_0_lifted_step_res_f_res_155228 = tt_155215;
                                    defunc_0_lifted_step_res_f_res_155229 = (int64_t) 0;
                                } else {
                                    bool cond_155231 = count_155216 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155232;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155233;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155234;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155235;
                                    
                                    if (cond_155231) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155212);
                                        bool y_157098 = slt64(ss_155212, stride_155045);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155212, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155214);
                                        bool y_157104 = slt64(tt_155214, j_m_i_155068);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155214, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155118 + ss_155212;
                                        float leq_arg1_157102 = ((float *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155045 + tt_155214;
                                        int64_t slice_157108 = start_155118 + slice_157107;
                                        float leq_arg0_157109 = ((float *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = leq_arg0_157109 <= leq_arg1_157102;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155214);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155212;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155212);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155214;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = tt_155215;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = (int64_t) 0;
                                    } else {
                                        int64_t m_155254 = sdiv64(count_155216, (int64_t) 2);
                                        int64_t n_155255 = sub64(count_155216, m_155254);
                                        bool cond_155256 = n_155255 == (int64_t) 0;
                                        int64_t zgze_lhs_155257 = add64(ss_155212, m_155254);
                                        bool cond_f_res_155258 = sle64(ss_155213, zgze_lhs_155257);
                                        bool x_155259 = !cond_155256;
                                        bool y_155260 = cond_f_res_155258 && x_155259;
                                        bool cond_155261 = cond_155256 || y_155260;
                                        bool leq_y_x_155262;
                                        
                                        if (cond_155261) {
                                            leq_y_x_155262 = 1;
                                        } else {
                                            bool x_155263 = sle64((int64_t) 0, zgze_lhs_155257);
                                            bool y_155264 = slt64(zgze_lhs_155257, stride_155045);
                                            bool bounds_check_155265 = x_155263 && y_155264;
                                            bool index_certs_155266;
                                            
                                            if (!bounds_check_155265) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155257, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155269 = add64(tt_155214, n_155255);
                                            int64_t leq_arg0_155270 = sub64(zm_lhs_155269, (int64_t) 1);
                                            bool x_155271 = sle64((int64_t) 0, leq_arg0_155270);
                                            bool y_155272 = slt64(leq_arg0_155270, j_m_i_155068);
                                            bool bounds_check_155273 = x_155271 && y_155272;
                                            bool index_certs_155274;
                                            
                                            if (!bounds_check_155273) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155270, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:141:35-39\n   #13 ftRelational.fut:140:9-141:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155267 = start_155118 + zgze_lhs_155257;
                                            float leq_arg1_155268 = ((float *) mem_param_165010.mem)[slice_155267];
                                            int64_t slice_155275 = stride_155045 + leq_arg0_155270;
                                            int64_t slice_155276 = start_155118 + slice_155275;
                                            float leq_arg0_155277 = ((float *) mem_param_165010.mem)[slice_155276];
                                            bool defunc_0_leq_res_155278 = leq_arg0_155277 <= leq_arg1_155268;
                                            
                                            leq_y_x_155262 = defunc_0_leq_res_155278;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                        
                                        if (leq_y_x_155262) {
                                            int64_t tmp_157115 = add64(tt_155214, n_155255);
                                            int64_t tmp_157116 = sub64(count_155216, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tt_155215;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = tmp_157116;
                                        } else {
                                            int64_t tmp_155284 = add64(tt_155214, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tt_155214;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tmp_155284;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = count_155216;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = ss_155212;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                    }
                                    defunc_0_lifted_step_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_155232;
                                    defunc_0_lifted_step_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_155233;
                                    defunc_0_lifted_step_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_155234;
                                    defunc_0_lifted_step_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_155235;
                                }
                                defunc_0_lifted_step_res_155219 = defunc_0_lifted_step_res_f_res_155226;
                                defunc_0_lifted_step_res_155220 = defunc_0_lifted_step_res_f_res_155227;
                                defunc_0_lifted_step_res_155221 = defunc_0_lifted_step_res_f_res_155228;
                                defunc_0_lifted_step_res_155222 = defunc_0_lifted_step_res_f_res_155229;
                            }
                            
                            int64_t loopres_155285;
                            int64_t loopres_155286;
                            int64_t loopres_155287;
                            int64_t loopres_155288;
                            int64_t loopres_155289;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155285, &loopres_155286, &loopres_155287, &loopres_155288, &loopres_155289, defunc_0_lifted_step_res_155219, ss_155213, defunc_0_lifted_step_res_155220, defunc_0_lifted_step_res_155221, defunc_0_lifted_step_res_155222) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155290 = slt64((int64_t) 0, loopres_155289);
                            bool loop_while_tmp_165727 = loop_cond_155290;
                            int64_t ss_tmp_165728 = loopres_155285;
                            int64_t ss_tmp_165729 = loopres_155286;
                            int64_t tt_tmp_165730 = loopres_155287;
                            int64_t tt_tmp_165731 = loopres_155288;
                            int64_t count_tmp_165732 = loopres_155289;
                            
                            loop_while_155211 = loop_while_tmp_165727;
                            ss_155212 = ss_tmp_165728;
                            ss_155213 = ss_tmp_165729;
                            tt_155214 = tt_tmp_165730;
                            tt_155215 = tt_tmp_165731;
                            count_155216 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155205 = loop_while_155211;
                        defunc_0_split_count_res_155206 = ss_155212;
                        defunc_0_split_count_res_155207 = ss_155213;
                        defunc_0_split_count_res_155208 = tt_155214;
                        defunc_0_split_count_res_155209 = tt_155215;
                        defunc_0_split_count_res_155210 = count_155216;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155206;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155208;
                    }
                    if (mem_165046_cached_sizze_166173 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166173, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166174 < bytes_165048) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166174, bytes_165048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155066; i_164739++) {
                        bool y_155296 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool index_certs_155298;
                        
                        if (!y_155296) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155299 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155301 = add64((int64_t) 1, i_164739);
                        bool x_155302 = sle64((int64_t) 0, tmp_155301);
                        bool y_155303 = slt64(tmp_155301, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool bounds_check_155304 = x_155302 && y_155303;
                        bool index_certs_155305;
                        
                        if (!bounds_check_155304) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155301, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155306 = ((int64_t *) mem_165029)[tmp_155301];
                        int64_t defunc_0_f_res_155307 = ((int64_t *) mem_165031)[tmp_155301];
                        int64_t merge_sequential_arg2_155308 = add64(stride_155045, defunc_0_f_res_155300);
                        int64_t merge_sequential_arg2_155309 = add64(stride_155045, defunc_0_f_res_155307);
                        int64_t j_m_i_155310 = sub64(merge_sequential_arg2_155309, merge_sequential_arg2_155308);
                        bool empty_slice_155311 = j_m_i_155310 == (int64_t) 0;
                        int64_t m_155312 = sub64(j_m_i_155310, (int64_t) 1);
                        int64_t i_p_m_t_s_155313 = add64(merge_sequential_arg2_155308, m_155312);
                        bool zzero_leq_i_p_m_t_s_155314 = sle64((int64_t) 0, i_p_m_t_s_155313);
                        bool i_p_m_t_s_leq_w_155315 = slt64(i_p_m_t_s_155313, next_stride_155046);
                        bool zzero_lte_i_155316 = sle64((int64_t) 0, merge_sequential_arg2_155308);
                        bool i_lte_j_155317 = sle64(merge_sequential_arg2_155308, merge_sequential_arg2_155309);
                        bool y_155318 = i_p_m_t_s_leq_w_155315 && zzero_lte_i_155316;
                        bool y_155319 = zzero_leq_i_p_m_t_s_155314 && y_155318;
                        bool forwards_ok_155320 = i_lte_j_155317 && y_155319;
                        bool ok_or_empty_155321 = empty_slice_155311 || forwards_ok_155320;
                        bool index_certs_155322;
                        
                        if (!ok_or_empty_155321) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155308, ":", (long long) merge_sequential_arg2_155309, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155323 = sub64(defunc_0_f_res_155306, defunc_0_f_res_155299);
                        bool empty_slice_155324 = j_m_i_155323 == (int64_t) 0;
                        int64_t m_155325 = sub64(j_m_i_155323, (int64_t) 1);
                        int64_t i_p_m_t_s_155326 = add64(defunc_0_f_res_155299, m_155325);
                        bool zzero_leq_i_p_m_t_s_155327 = sle64((int64_t) 0, i_p_m_t_s_155326);
                        bool i_p_m_t_s_leq_w_155328 = slt64(i_p_m_t_s_155326, next_stride_155046);
                        bool zzero_lte_i_155329 = sle64((int64_t) 0, defunc_0_f_res_155299);
                        bool i_lte_j_155330 = sle64(defunc_0_f_res_155299, defunc_0_f_res_155306);
                        bool y_155331 = i_p_m_t_s_leq_w_155328 && zzero_lte_i_155329;
                        bool y_155332 = zzero_leq_i_p_m_t_s_155327 && y_155331;
                        bool forwards_ok_155333 = i_lte_j_155330 && y_155332;
                        bool ok_or_empty_155334 = empty_slice_155324 || forwards_ok_155333;
                        bool index_certs_155335;
                        
                        if (!ok_or_empty_155334) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155299, ":", (long long) defunc_0_f_res_155306, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:141:35-39\n   #10 ftRelational.fut:140:9-141:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155336 = slt64((int64_t) 0, j_m_i_155323);
                        float dummy_155337;
                        int64_t dummy_155338;
                        
                        if (cond_155336) {
                            bool index_certs_157117;
                            
                            if (!cond_155336) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:141:35-39\n   #12 ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155118 + defunc_0_f_res_155299;
                            float head_res_157119 = ((float *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155337 = head_res_157119;
                            dummy_155338 = head_res_157120;
                        } else {
                            bool y_155343 = slt64((int64_t) 0, j_m_i_155310);
                            bool index_certs_155344;
                            
                            if (!y_155343) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:141:35-39\n   #12 ftRelational.fut:140:9-141:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155345 = start_155118 + merge_sequential_arg2_155308;
                            float head_res_155346 = ((float *) mem_param_165010.mem)[slice_155345];
                            int64_t head_res_155347 = ((int64_t *) mem_param_165013.mem)[slice_155345];
                            
                            dummy_155337 = head_res_155346;
                            dummy_155338 = head_res_155347;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154931; nest_i_165735++) {
                            ((float *) mem_165046)[i_164739 * merge_block_sizze_154931 + nest_i_165735] = dummy_155337;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154931; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + nest_i_165736] = dummy_155338;
                        }
                        
                        int64_t data_155350;
                        int64_t i_155354 = (int64_t) 0;
                        
                        for (int64_t k_155353 = 0; k_155353 < merge_block_sizze_154931; k_155353++) {
                            int64_t j_155357 = sub64(k_155353, i_155354);
                            bool cond_155358 = j_155357 == j_m_i_155310;
                            bool cond_155359;
                            
                            if (cond_155358) {
                                cond_155359 = 1;
                            } else {
                                bool cond_155360 = slt64(i_155354, j_m_i_155323);
                                bool cond_f_res_155361;
                                
                                if (cond_155360) {
                                    bool x_157121 = sle64((int64_t) 0, j_155357);
                                    bool y_157122 = slt64(j_155357, j_m_i_155310);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155354);
                                    bool bounds_check_157129 = cond_155360 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155308 + j_155357;
                                    int64_t slice_157126 = start_155118 + slice_157125;
                                    float leq_arg1_157127 = ((float *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155299 + i_155354;
                                    int64_t slice_157132 = start_155118 + slice_157131;
                                    float leq_arg0_157133 = ((float *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = leq_arg0_157133 <= leq_arg1_157127;
                                    
                                    cond_f_res_155361 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155361 = 0;
                                }
                                cond_155359 = cond_f_res_155361;
                            }
                            
                            int64_t loopres_155376;
                            float loopres_155377;
                            int64_t loopres_155378;
                            
                            if (cond_155359) {
                                bool x_157136 = sle64((int64_t) 0, i_155354);
                                bool y_157137 = slt64(i_155354, j_m_i_155323);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155354);
                                int64_t slice_157140 = defunc_0_f_res_155299 + i_155354;
                                int64_t slice_157141 = start_155118 + slice_157140;
                                float tmp_157142 = ((float *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155376 = tmp_157135;
                                loopres_155377 = tmp_157142;
                                loopres_155378 = tmp_157143;
                            } else {
                                bool x_155388 = sle64((int64_t) 0, j_155357);
                                bool y_155389 = slt64(j_155357, j_m_i_155310);
                                bool bounds_check_155390 = x_155388 && y_155389;
                                bool index_certs_155391;
                                
                                if (!bounds_check_155390) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:141:35-39\n   #11 ftRelational.fut:140:9-141:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155392 = merge_sequential_arg2_155308 + j_155357;
                                int64_t slice_155393 = start_155118 + slice_155392;
                                float tmp_155394 = ((float *) mem_param_165010.mem)[slice_155393];
                                int64_t tmp_155395 = ((int64_t *) mem_param_165013.mem)[slice_155393];
                                
                                loopres_155376 = i_155354;
                                loopres_155377 = tmp_155394;
                                loopres_155378 = tmp_155395;
                            }
                            ((float *) mem_165046)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155377;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155378;
                            
                            int64_t i_tmp_165737 = loopres_155376;
                            
                            i_155354 = i_tmp_165737;
                        }
                        data_155350 = i_155354;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint32_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165048, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_165016, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155402 = next_stride_155046 * num_merges_155050;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint32_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            if (memblock_alloc(ctx, &mem_165126, bytes_165018, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            
            bool loop_cond_155405 = slt64(next_stride_155046, flat_dim_154927);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155402;
            bool loop_while_tmp_165714 = loop_cond_155405;
            int64_t stride_tmp_165717 = next_stride_155046;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155041 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155042 = loop_while_tmp_165714;
            stride_155045 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155036 = loop_dz2084Uz2082U_155041;
        data_155037 = loop_while_155042;
        data_155040 = stride_155045;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155406 = n_108942 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155407 = sle64((int64_t) 0, zs_lhs_154911);
        bool i_p_m_t_s_leq_w_155408 = slt64(zs_lhs_154911, data_155036);
        bool y_155409 = zzero_leq_i_p_m_t_s_155407 && i_p_m_t_s_leq_w_155408;
        bool ok_or_empty_155410 = empty_slice_155406 || y_155409;
        bool index_certs_155411;
        
        if (!ok_or_empty_155410) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_108942, "] out of bounds for array of shape [", (long long) data_155036, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:141:35-39\n   #6  ftRelational.fut:140:9-141:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_108942; i_164753++) {
        int64_t eta_p_155419 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155420 = sle64((int64_t) 0, eta_p_155419);
        bool y_155421 = slt64(eta_p_155419, n_108942);
        bool bounds_check_155422 = x_155420 && y_155421;
        bool index_certs_155423;
        
        if (!bounds_check_155422) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155419, "] out of bounds for array of shape [", (long long) n_108942, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:141:35-39\n   #5  ftRelational.fut:140:9-141:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_155424 = ((int64_t *) ext_mem_164929.mem)[eta_p_155419];
        float lifted_lambda_res_155425 = ((float *) xs_mem_164928.mem)[eta_p_155419];
        
        ((int64_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155424;
        ((float *) mem_165140.mem)[i_164753] = lifted_lambda_res_155425;
    }
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166163, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166164, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_166175, struct memblock *mem_out_p_166176, struct memblock xs_mem_164928, int64_t n_104656, int64_t incr_104657)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166177 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166178 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166179 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166180 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166181 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166182 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166183 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166184 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166185 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166186 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_104656;
    bool cond_154910 = sle64(n_104656, (int64_t) 1);
    int64_t zs_lhs_154911 = sub64(n_104656, (int64_t) 1);
    int64_t zp_rhs_154912 = sdiv_safe64(zs_lhs_154911, (int64_t) 20);
    int64_t min_num_blocks_154913 = add64((int64_t) 1, zp_rhs_154912);
    bool loop_cond_154914 = slt64((int64_t) 1, min_num_blocks_154913);
    bool smallest_pow_2_geq_than_res_154915;
    int64_t smallest_pow_2_geq_than_res_154916;
    bool loop_while_154917;
    int64_t x_154918;
    
    loop_while_154917 = loop_cond_154914;
    x_154918 = (int64_t) 1;
    while (loop_while_154917) {
        int64_t loopres_154919 = mul64((int64_t) 2, x_154918);
        bool loop_cond_154920 = slt64(loopres_154919, min_num_blocks_154913);
        bool loop_while_tmp_165695 = loop_cond_154920;
        int64_t x_tmp_165696 = loopres_154919;
        
        loop_while_154917 = loop_while_tmp_165695;
        x_154918 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154915 = loop_while_154917;
    smallest_pow_2_geq_than_res_154916 = x_154918;
    
    bool zzero_154921 = smallest_pow_2_geq_than_res_154916 == (int64_t) 0;
    bool nonzzero_154922 = !zzero_154921;
    bool protect_assert_disj_154923 = cond_154910 || nonzzero_154922;
    bool nonzzero_cert_154924;
    
    if (!protect_assert_disj_154923) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154925 = sdiv_safe64(zs_lhs_154911, smallest_pow_2_geq_than_res_154916);
    int64_t block_sizze_154926 = add64((int64_t) 1, zp_rhs_154925);
    bool y_154932 = slt64((int64_t) 0, n_104656);
    bool protect_assert_disj_165536 = cond_154910 || y_154932;
    bool index_certs_154933;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_104656, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154947 = slt64(smallest_pow_2_geq_than_res_154916, (int64_t) 0);
    bool valid_154948 = !bounds_invalid_upwards_154947;
    bool protect_assert_disj_165544 = cond_154910 || valid_154948;
    bool range_valid_c_154949;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154916, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:137:35-39\n   #6  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154951 = slt64(block_sizze_154926, (int64_t) 0);
    bool valid_154952 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_165546 = cond_154910 || valid_154952;
    bool range_valid_c_154953;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154926, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154955 = sle64(block_sizze_154926, (int64_t) 1);
    int64_t tmp_154956 = sub64(block_sizze_154926, (int64_t) 2);
    bool bounds_invalid_upwards_154957 = slt64(tmp_154956, (int64_t) 0);
    bool valid_154959 = !bounds_invalid_upwards_154957;
    bool protect_assert_disj_154960 = cond_154955 || valid_154959;
    bool protect_assert_disj_165548 = cond_154910 || protect_assert_disj_154960;
    bool range_valid_c_154961;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154956, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165139 = (int64_t) 4 * n_104656;
    
    if (futrts_indicesWithIncrement_12162(ctx, &ext_mem_164929, xs_mem_164928, n_104656, incr_104657) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_104656; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154927 = smallest_pow_2_geq_than_res_154916 * block_sizze_154926;
    bool x_165531 = !cond_154910;
    int64_t greatest_divisor_leq_than_arg1_154930 = mul64((int64_t) 2, block_sizze_154926);
    int64_t merge_block_sizze_154931;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154930) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154931 = x_165533;
    } else {
        merge_block_sizze_154931 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_154934;
    
    if (x_165531) {
        int32_t x_165537 = ((int32_t *) xs_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154934 = x_165537;
    } else {
        reduce_arg1_154934 = 0;
    }
    
    int32_t defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        int32_t x_165539;
        int64_t x_165540;
        int32_t redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154934;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_104656; i_164713++) {
            int32_t x_154938 = ((int32_t *) xs_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154944 = sle32(redout_164711, x_154938);
            int32_t defunc_0_op_res_154945;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154945 = x_154938;
            } else {
                defunc_0_op_res_154945 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154946;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154946 = i_164713;
            } else {
                defunc_0_op_res_154946 = redout_164712;
            }
            
            int32_t redout_tmp_165699 = defunc_0_op_res_154945;
            int64_t redout_tmp_165700 = defunc_0_op_res_154946;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = 0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154958 = add64((int64_t) 1, tmp_154956);
    int64_t binop_x_164932 = (int64_t) 4 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164933 = block_sizze_154926 * binop_x_164932;
    int64_t binop_x_164935 = (int64_t) 8 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164936 = block_sizze_154926 * binop_x_164935;
    int64_t bytes_164946 = (int64_t) 4 * block_sizze_154926;
    int64_t bytes_164948 = (int64_t) 8 * block_sizze_154926;
    bool loop_cond_155033 = slt64(block_sizze_154926, flat_dim_154927);
    bool zzero_155034 = merge_block_sizze_154931 == (int64_t) 0;
    bool nonzzero_155035 = !zzero_155034;
    
    if (cond_154910) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166177 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166177, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166178 < bytes_164936) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166178, bytes_164936);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166179 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166179, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166180 < bytes_164948) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166180, bytes_164948);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154916; i_164725++) {
            int64_t zp_lhs_154965 = mul64(block_sizze_154926, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154926; i_164718++) {
                int64_t k_154969 = add64(zp_lhs_154965, i_164718);
                bool cond_154970 = slt64(k_154969, n_104656);
                int32_t lifted_lambda_res_154971;
                int64_t lifted_lambda_res_154972;
                
                if (cond_154970) {
                    bool x_157003 = sle64((int64_t) 0, k_154969);
                    bool bounds_check_157004 = cond_154970 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154969, "] out of bounds for array of shape [", (long long) n_104656, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_157006 = ((int32_t *) xs_mem_164928.mem)[k_154969];
                    
                    lifted_lambda_res_154971 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154972 = k_154969;
                } else {
                    lifted_lambda_res_154971 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154972 = defunc_0_reduce_res_157151;
                }
                ((int32_t *) mem_164947)[i_164718] = lifted_lambda_res_154971;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154972;
            }
            if (!cond_154955) {
                for (int64_t i_154982 = 0; i_154982 < distance_154958; i_154982++) {
                    int64_t gt_arg1_154985 = add64((int64_t) 1, i_154982);
                    bool x_154986 = sle64((int64_t) 0, gt_arg1_154985);
                    bool y_154987 = slt64(gt_arg1_154985, block_sizze_154926);
                    bool bounds_check_154988 = x_154986 && y_154987;
                    bool index_certs_154989;
                    
                    if (!bounds_check_154988) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154985, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154991 = slt64(i_154982, block_sizze_154926);
                    bool index_certs_154992;
                    
                    if (!y_154991) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154982, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_154990 = ((int32_t *) mem_164947)[gt_arg1_154985];
                    int32_t gt_arg0_154993 = ((int32_t *) mem_164947)[i_154982];
                    bool defunc_0_leq_res_154994 = sle32(gt_arg0_154993, gt_arg1_154990);
                    bool defunc_0_lifted_gt_res_154995 = !defunc_0_leq_res_154994;
                    bool s_154996;
                    int64_t s_154999;
                    bool loop_while_155000;
                    int64_t j_155003;
                    
                    loop_while_155000 = defunc_0_lifted_gt_res_154995;
                    j_155003 = i_154982;
                    while (loop_while_155000) {
                        bool x_155004 = sle64((int64_t) 0, j_155003);
                        bool y_155005 = slt64(j_155003, block_sizze_154926);
                        bool bounds_check_155006 = x_155004 && y_155005;
                        bool index_certs_155007;
                        
                        if (!bounds_check_155006) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155003, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155010 = add64((int64_t) 1, j_155003);
                        bool x_155011 = sle64((int64_t) 0, copy_arg0_155010);
                        bool y_155012 = slt64(copy_arg0_155010, block_sizze_154926);
                        bool bounds_check_155013 = x_155011 && y_155012;
                        bool index_certs_155014;
                        
                        if (!bounds_check_155013) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155010, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_155008 = ((int32_t *) mem_164947)[j_155003];
                        int64_t copy_arg0_155009 = ((int64_t *) mem_164949)[j_155003];
                        int32_t copy_arg0_155015 = ((int32_t *) mem_164947)[copy_arg0_155010];
                        int64_t copy_arg0_155016 = ((int64_t *) mem_164949)[copy_arg0_155010];
                        
                        ((int32_t *) mem_164947)[j_155003] = copy_arg0_155015;
                        ((int64_t *) mem_164949)[j_155003] = copy_arg0_155016;
                        ((int32_t *) mem_164947)[copy_arg0_155010] = copy_arg0_155008;
                        ((int64_t *) mem_164949)[copy_arg0_155010] = copy_arg0_155009;
                        
                        int64_t tmp_155021 = sub64(j_155003, (int64_t) 1);
                        bool cond_155022 = sle64((int64_t) 0, tmp_155021);
                        bool loop_cond_155023;
                        
                        if (cond_155022) {
                            bool y_157008 = slt64(tmp_155021, block_sizze_154926);
                            bool bounds_check_157009 = cond_155022 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155021, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_157007 = ((int32_t *) mem_164947)[j_155003];
                            int32_t gt_arg0_157011 = ((int32_t *) mem_164947)[tmp_155021];
                            bool defunc_0_leq_res_157012 = sle32(gt_arg0_157011, gt_arg1_157007);
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155023 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155023 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155023;
                        int64_t j_tmp_165710 = tmp_155021;
                        
                        loop_while_155000 = loop_while_tmp_165707;
                        j_155003 = j_tmp_165710;
                    }
                    s_154996 = loop_while_155000;
                    s_154999 = j_155003;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164934, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint32_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        if (memblock_alloc(ctx, &mem_165006, bytes_164936, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        
        int64_t data_155036;
        bool data_155037;
        int64_t data_155040;
        int64_t loop_dz2084Uz2082U_155041;
        bool loop_while_155042;
        int64_t stride_155045;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155041 = flat_dim_154927;
        loop_while_155042 = loop_cond_155033;
        stride_155045 = block_sizze_154926;
        while (loop_while_155042) {
            int64_t next_stride_155046 = mul64((int64_t) 2, stride_155045);
            bool zzero_155047 = next_stride_155046 == (int64_t) 0;
            bool nonzzero_155048 = !zzero_155047;
            bool nonzzero_cert_155049;
            
            if (!nonzzero_155048) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155050 = sdiv64(flat_dim_154927, next_stride_155046);
            bool bounds_invalid_upwards_155051 = slt64(num_merges_155050, (int64_t) 0);
            bool valid_155052 = !bounds_invalid_upwards_155051;
            bool range_valid_c_155053;
            
            if (!valid_155052) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155050, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:137:35-39\n   #6  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155055 = sub64(next_stride_155046, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155056 = sle64((int64_t) 0, m_155055);
            bool cond_155058 = slt64(next_stride_155046, (int64_t) 10);
            bool protect_assert_disj_155059 = nonzzero_155035 || cond_155058;
            bool nonzzero_cert_155060;
            
            if (!protect_assert_disj_155059) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155061 = smod_safe64(next_stride_155046, merge_block_sizze_154931);
            bool num_blocks_155062 = zeze_lhs_155061 == (int64_t) 0;
            bool protect_assert_disj_155063 = cond_155058 || num_blocks_155062;
            bool assert_c_155064;
            
            if (!protect_assert_disj_155063) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155066 = sdiv_safe64(next_stride_155046, merge_block_sizze_154931);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067 = add64((int64_t) 1, num_blocks_155066);
            int64_t j_m_i_155068 = sub64(next_stride_155046, stride_155045);
            int64_t flat_dim_155069 = merge_block_sizze_154931 * num_blocks_155066;
            bool bounds_invalid_upwards_155070 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, (int64_t) 0);
            bool empty_slice_155071 = j_m_i_155068 == (int64_t) 0;
            int64_t m_155072 = sub64(j_m_i_155068, (int64_t) 1);
            bool zzero_lte_i_155073 = sle64((int64_t) 0, stride_155045);
            bool i_lte_j_155074 = sle64(stride_155045, next_stride_155046);
            bool empty_slice_155075 = stride_155045 == (int64_t) 0;
            int64_t m_155076 = sub64(stride_155045, (int64_t) 1);
            bool bounds_invalid_upwards_155077 = slt64(num_blocks_155066, (int64_t) 0);
            bool cond_155078 = slt64((int64_t) 0, stride_155045);
            bool valid_155079 = !bounds_invalid_upwards_155070;
            int64_t i_p_m_t_s_155080 = add64(stride_155045, m_155072);
            bool zzero_leq_i_p_m_t_s_155081 = sle64((int64_t) 0, m_155076);
            bool i_p_m_t_s_leq_w_155082 = slt64(m_155076, next_stride_155046);
            bool valid_155083 = !bounds_invalid_upwards_155077;
            bool i_p_m_t_s_leq_w_155084 = slt64(m_155055, flat_dim_155069);
            bool y_155085 = slt64((int64_t) 0, j_m_i_155068);
            bool protect_assert_disj_155086 = cond_155058 || valid_155079;
            bool range_valid_c_155087;
            
            if (!protect_assert_disj_155086) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155088 = sle64((int64_t) 0, i_p_m_t_s_155080);
            bool i_p_m_t_s_leq_w_155089 = slt64(i_p_m_t_s_155080, next_stride_155046);
            bool y_155090 = zzero_leq_i_p_m_t_s_155081 && i_p_m_t_s_leq_w_155082;
            bool protect_assert_disj_155091 = cond_155058 || valid_155083;
            bool range_valid_c_155092;
            
            if (!protect_assert_disj_155091) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155093 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155084;
            bool y_155094 = zzero_lte_i_155073 && i_p_m_t_s_leq_w_155089;
            bool forwards_ok_155095 = zzero_lte_i_155073 && y_155090;
            bool ok_or_empty_155096 = zzero_155047 || y_155093;
            bool protect_assert_disj_155097 = cond_155078 || y_155085;
            bool y_155098 = zzero_leq_i_p_m_t_s_155088 && y_155094;
            bool ok_or_empty_155099 = empty_slice_155075 || forwards_ok_155095;
            bool protect_assert_disj_155100 = cond_155058 || ok_or_empty_155096;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) flat_dim_155069, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155102 = !cond_155058;
            bool protect_assert_disj_155103 = protect_assert_disj_155097 || loop_not_taken_155102;
            bool index_certs_155104;
            
            if (!protect_assert_disj_155103) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155105 = i_lte_j_155074 && y_155098;
            bool protect_assert_disj_155106 = cond_155058 || ok_or_empty_155099;
            bool index_certs_155107;
            
            if (!protect_assert_disj_155106) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155108 = ok_or_empty_155099 || loop_not_taken_155102;
            bool index_certs_155109;
            
            if (!protect_assert_disj_155108) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155110 = empty_slice_155071 || forwards_ok_155105;
            bool protect_assert_disj_155111 = cond_155058 || ok_or_empty_155110;
            bool index_certs_155112;
            
            if (!protect_assert_disj_155111) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155113 = loop_not_taken_155102 || ok_or_empty_155110;
            bool index_certs_155114;
            
            if (!protect_assert_disj_155113) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 4 * num_merges_155050;
            int64_t bytes_165015 = next_stride_155046 * binop_x_165014;
            int64_t binop_x_165017 = (int64_t) 8 * num_merges_155050;
            int64_t bytes_165018 = next_stride_155046 * binop_x_165017;
            bool i_lte_j_155057 = sle64((int64_t) 0, next_stride_155046);
            
            if (mem_165016_cached_sizze_166181 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166181, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166182 < bytes_165018) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166182, bytes_165018);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067;
            int64_t binop_x_165044 = (int64_t) 4 * num_blocks_155066;
            int64_t bytes_165045 = merge_block_sizze_154931 * binop_x_165044;
            int64_t binop_x_165047 = (int64_t) 8 * num_blocks_155066;
            int64_t bytes_165048 = merge_block_sizze_154931 * binop_x_165047;
            int64_t bytes_165090 = (int64_t) 8 * stride_155045;
            int64_t bytes_165092 = (int64_t) 16 * stride_155045;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155050; i_164746++) {
                int64_t start_155118 = mul64(next_stride_155046, i_164746);
                int64_t j_m_i_155119 = sub64(loop_dz2084Uz2082U_155041, start_155118);
                bool empty_slice_155120 = j_m_i_155119 == (int64_t) 0;
                int64_t m_155121 = sub64(j_m_i_155119, (int64_t) 1);
                int64_t i_p_m_t_s_155122 = add64(start_155118, m_155121);
                bool zzero_leq_i_p_m_t_s_155123 = sle64((int64_t) 0, i_p_m_t_s_155122);
                bool i_p_m_t_s_leq_w_155124 = slt64(i_p_m_t_s_155122, loop_dz2084Uz2082U_155041);
                bool zzero_lte_i_155125 = sle64((int64_t) 0, start_155118);
                bool i_lte_j_155126 = sle64(start_155118, loop_dz2084Uz2082U_155041);
                bool y_155127 = i_p_m_t_s_leq_w_155124 && zzero_lte_i_155125;
                bool y_155128 = zzero_leq_i_p_m_t_s_155123 && y_155127;
                bool forwards_ok_155129 = i_lte_j_155126 && y_155128;
                bool ok_or_empty_155130 = empty_slice_155120 || forwards_ok_155129;
                bool index_certs_155131;
                
                if (!ok_or_empty_155130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155118, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155041, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155132 = slt64(m_155055, j_m_i_155119);
                bool y_155133 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155132;
                bool forwards_ok_155134 = i_lte_j_155057 && y_155133;
                bool ok_or_empty_155135 = zzero_155047 || forwards_ok_155134;
                bool index_certs_155136;
                
                if (!ok_or_empty_155135) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) j_m_i_155119, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:137:35-39\n   #8  ftRelational.fut:136:9-137:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155058) {
                    int32_t dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155078) {
                        int32_t head_res_157041 = ((int32_t *) mem_param_165010.mem)[start_155118];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155118];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155045 + start_155118;
                        int32_t head_res_157044 = ((int32_t *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155046; nest_i_165720++) {
                        ((int32_t *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165092, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155046; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155046; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155068;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155045);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155068);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155045 + j_157055;
                                int64_t slice_157065 = start_155118 + slice_157064;
                                int32_t leq_arg1_157066 = ((int32_t *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155118 + i_157052;
                                int32_t leq_arg0_157071 = ((int32_t *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = sle32(leq_arg0_157071, leq_arg1_157066);
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        int32_t loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155045);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155118 + i_157052;
                            int32_t tmp_157082 = ((int32_t *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155068);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:137:35-39\n   #9  ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155045 + j_157055;
                            int64_t slice_157089 = start_155118 + slice_157088;
                            int32_t tmp_157090 = ((int32_t *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((int32_t *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166183 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166183, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166184 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166184, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067; i_164732++) {
                        int64_t split_count_arg3_155198 = mul64(merge_block_sizze_154931, i_164732);
                        int64_t defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155199, &defunc_0_split_count_res_155200, &defunc_0_split_count_res_155201, &defunc_0_split_count_res_155202, &defunc_0_split_count_res_155203, (int64_t) 0, stride_155045, (int64_t) 0, j_m_i_155068, split_count_arg3_155198) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155204 = slt64((int64_t) 0, defunc_0_split_count_res_155203);
                        bool defunc_0_split_count_res_155205;
                        int64_t defunc_0_split_count_res_155206;
                        int64_t defunc_0_split_count_res_155207;
                        int64_t defunc_0_split_count_res_155208;
                        int64_t defunc_0_split_count_res_155209;
                        int64_t defunc_0_split_count_res_155210;
                        bool loop_while_155211;
                        int64_t ss_155212;
                        int64_t ss_155213;
                        int64_t tt_155214;
                        int64_t tt_155215;
                        int64_t count_155216;
                        
                        loop_while_155211 = loop_cond_155204;
                        ss_155212 = defunc_0_split_count_res_155199;
                        ss_155213 = defunc_0_split_count_res_155200;
                        tt_155214 = defunc_0_split_count_res_155201;
                        tt_155215 = defunc_0_split_count_res_155202;
                        count_155216 = defunc_0_split_count_res_155203;
                        while (loop_while_155211) {
                            int64_t zlze_lhs_155217 = sub64(ss_155213, ss_155212);
                            bool cond_155218 = sle64(zlze_lhs_155217, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155219;
                            int64_t defunc_0_lifted_step_res_155220;
                            int64_t defunc_0_lifted_step_res_155221;
                            int64_t defunc_0_lifted_step_res_155222;
                            
                            if (cond_155218) {
                                int64_t tmp_157094 = add64(tt_155214, count_155216);
                                
                                defunc_0_lifted_step_res_155219 = ss_155212;
                                defunc_0_lifted_step_res_155220 = tmp_157094;
                                defunc_0_lifted_step_res_155221 = tt_155215;
                                defunc_0_lifted_step_res_155222 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155224 = sub64(tt_155215, tt_155214);
                                bool cond_155225 = sle64(zlze_lhs_155224, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155226;
                                int64_t defunc_0_lifted_step_res_f_res_155227;
                                int64_t defunc_0_lifted_step_res_f_res_155228;
                                int64_t defunc_0_lifted_step_res_f_res_155229;
                                
                                if (cond_155225) {
                                    int64_t tmp_157095 = add64(ss_155212, count_155216);
                                    
                                    defunc_0_lifted_step_res_f_res_155226 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155227 = tt_155214;
                                    defunc_0_lifted_step_res_f_res_155228 = tt_155215;
                                    defunc_0_lifted_step_res_f_res_155229 = (int64_t) 0;
                                } else {
                                    bool cond_155231 = count_155216 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155232;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155233;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155234;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155235;
                                    
                                    if (cond_155231) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155212);
                                        bool y_157098 = slt64(ss_155212, stride_155045);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155212, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155214);
                                        bool y_157104 = slt64(tt_155214, j_m_i_155068);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155214, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155118 + ss_155212;
                                        int32_t leq_arg1_157102 = ((int32_t *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155045 + tt_155214;
                                        int64_t slice_157108 = start_155118 + slice_157107;
                                        int32_t leq_arg0_157109 = ((int32_t *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = sle32(leq_arg0_157109, leq_arg1_157102);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155214);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155212;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155212);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155214;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = tt_155215;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = (int64_t) 0;
                                    } else {
                                        int64_t m_155254 = sdiv64(count_155216, (int64_t) 2);
                                        int64_t n_155255 = sub64(count_155216, m_155254);
                                        bool cond_155256 = n_155255 == (int64_t) 0;
                                        int64_t zgze_lhs_155257 = add64(ss_155212, m_155254);
                                        bool cond_f_res_155258 = sle64(ss_155213, zgze_lhs_155257);
                                        bool x_155259 = !cond_155256;
                                        bool y_155260 = cond_f_res_155258 && x_155259;
                                        bool cond_155261 = cond_155256 || y_155260;
                                        bool leq_y_x_155262;
                                        
                                        if (cond_155261) {
                                            leq_y_x_155262 = 1;
                                        } else {
                                            bool x_155263 = sle64((int64_t) 0, zgze_lhs_155257);
                                            bool y_155264 = slt64(zgze_lhs_155257, stride_155045);
                                            bool bounds_check_155265 = x_155263 && y_155264;
                                            bool index_certs_155266;
                                            
                                            if (!bounds_check_155265) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155257, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155269 = add64(tt_155214, n_155255);
                                            int64_t leq_arg0_155270 = sub64(zm_lhs_155269, (int64_t) 1);
                                            bool x_155271 = sle64((int64_t) 0, leq_arg0_155270);
                                            bool y_155272 = slt64(leq_arg0_155270, j_m_i_155068);
                                            bool bounds_check_155273 = x_155271 && y_155272;
                                            bool index_certs_155274;
                                            
                                            if (!bounds_check_155273) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155270, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:137:35-39\n   #13 ftRelational.fut:136:9-137:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155267 = start_155118 + zgze_lhs_155257;
                                            int32_t leq_arg1_155268 = ((int32_t *) mem_param_165010.mem)[slice_155267];
                                            int64_t slice_155275 = stride_155045 + leq_arg0_155270;
                                            int64_t slice_155276 = start_155118 + slice_155275;
                                            int32_t leq_arg0_155277 = ((int32_t *) mem_param_165010.mem)[slice_155276];
                                            bool defunc_0_leq_res_155278 = sle32(leq_arg0_155277, leq_arg1_155268);
                                            
                                            leq_y_x_155262 = defunc_0_leq_res_155278;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                        
                                        if (leq_y_x_155262) {
                                            int64_t tmp_157115 = add64(tt_155214, n_155255);
                                            int64_t tmp_157116 = sub64(count_155216, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tt_155215;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = tmp_157116;
                                        } else {
                                            int64_t tmp_155284 = add64(tt_155214, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tt_155214;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tmp_155284;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = count_155216;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = ss_155212;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                    }
                                    defunc_0_lifted_step_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_155232;
                                    defunc_0_lifted_step_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_155233;
                                    defunc_0_lifted_step_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_155234;
                                    defunc_0_lifted_step_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_155235;
                                }
                                defunc_0_lifted_step_res_155219 = defunc_0_lifted_step_res_f_res_155226;
                                defunc_0_lifted_step_res_155220 = defunc_0_lifted_step_res_f_res_155227;
                                defunc_0_lifted_step_res_155221 = defunc_0_lifted_step_res_f_res_155228;
                                defunc_0_lifted_step_res_155222 = defunc_0_lifted_step_res_f_res_155229;
                            }
                            
                            int64_t loopres_155285;
                            int64_t loopres_155286;
                            int64_t loopres_155287;
                            int64_t loopres_155288;
                            int64_t loopres_155289;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155285, &loopres_155286, &loopres_155287, &loopres_155288, &loopres_155289, defunc_0_lifted_step_res_155219, ss_155213, defunc_0_lifted_step_res_155220, defunc_0_lifted_step_res_155221, defunc_0_lifted_step_res_155222) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155290 = slt64((int64_t) 0, loopres_155289);
                            bool loop_while_tmp_165727 = loop_cond_155290;
                            int64_t ss_tmp_165728 = loopres_155285;
                            int64_t ss_tmp_165729 = loopres_155286;
                            int64_t tt_tmp_165730 = loopres_155287;
                            int64_t tt_tmp_165731 = loopres_155288;
                            int64_t count_tmp_165732 = loopres_155289;
                            
                            loop_while_155211 = loop_while_tmp_165727;
                            ss_155212 = ss_tmp_165728;
                            ss_155213 = ss_tmp_165729;
                            tt_155214 = tt_tmp_165730;
                            tt_155215 = tt_tmp_165731;
                            count_155216 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155205 = loop_while_155211;
                        defunc_0_split_count_res_155206 = ss_155212;
                        defunc_0_split_count_res_155207 = ss_155213;
                        defunc_0_split_count_res_155208 = tt_155214;
                        defunc_0_split_count_res_155209 = tt_155215;
                        defunc_0_split_count_res_155210 = count_155216;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155206;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155208;
                    }
                    if (mem_165046_cached_sizze_166185 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166185, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166186 < bytes_165048) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166186, bytes_165048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155066; i_164739++) {
                        bool y_155296 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool index_certs_155298;
                        
                        if (!y_155296) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155299 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155301 = add64((int64_t) 1, i_164739);
                        bool x_155302 = sle64((int64_t) 0, tmp_155301);
                        bool y_155303 = slt64(tmp_155301, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool bounds_check_155304 = x_155302 && y_155303;
                        bool index_certs_155305;
                        
                        if (!bounds_check_155304) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155301, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155306 = ((int64_t *) mem_165029)[tmp_155301];
                        int64_t defunc_0_f_res_155307 = ((int64_t *) mem_165031)[tmp_155301];
                        int64_t merge_sequential_arg2_155308 = add64(stride_155045, defunc_0_f_res_155300);
                        int64_t merge_sequential_arg2_155309 = add64(stride_155045, defunc_0_f_res_155307);
                        int64_t j_m_i_155310 = sub64(merge_sequential_arg2_155309, merge_sequential_arg2_155308);
                        bool empty_slice_155311 = j_m_i_155310 == (int64_t) 0;
                        int64_t m_155312 = sub64(j_m_i_155310, (int64_t) 1);
                        int64_t i_p_m_t_s_155313 = add64(merge_sequential_arg2_155308, m_155312);
                        bool zzero_leq_i_p_m_t_s_155314 = sle64((int64_t) 0, i_p_m_t_s_155313);
                        bool i_p_m_t_s_leq_w_155315 = slt64(i_p_m_t_s_155313, next_stride_155046);
                        bool zzero_lte_i_155316 = sle64((int64_t) 0, merge_sequential_arg2_155308);
                        bool i_lte_j_155317 = sle64(merge_sequential_arg2_155308, merge_sequential_arg2_155309);
                        bool y_155318 = i_p_m_t_s_leq_w_155315 && zzero_lte_i_155316;
                        bool y_155319 = zzero_leq_i_p_m_t_s_155314 && y_155318;
                        bool forwards_ok_155320 = i_lte_j_155317 && y_155319;
                        bool ok_or_empty_155321 = empty_slice_155311 || forwards_ok_155320;
                        bool index_certs_155322;
                        
                        if (!ok_or_empty_155321) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155308, ":", (long long) merge_sequential_arg2_155309, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155323 = sub64(defunc_0_f_res_155306, defunc_0_f_res_155299);
                        bool empty_slice_155324 = j_m_i_155323 == (int64_t) 0;
                        int64_t m_155325 = sub64(j_m_i_155323, (int64_t) 1);
                        int64_t i_p_m_t_s_155326 = add64(defunc_0_f_res_155299, m_155325);
                        bool zzero_leq_i_p_m_t_s_155327 = sle64((int64_t) 0, i_p_m_t_s_155326);
                        bool i_p_m_t_s_leq_w_155328 = slt64(i_p_m_t_s_155326, next_stride_155046);
                        bool zzero_lte_i_155329 = sle64((int64_t) 0, defunc_0_f_res_155299);
                        bool i_lte_j_155330 = sle64(defunc_0_f_res_155299, defunc_0_f_res_155306);
                        bool y_155331 = i_p_m_t_s_leq_w_155328 && zzero_lte_i_155329;
                        bool y_155332 = zzero_leq_i_p_m_t_s_155327 && y_155331;
                        bool forwards_ok_155333 = i_lte_j_155330 && y_155332;
                        bool ok_or_empty_155334 = empty_slice_155324 || forwards_ok_155333;
                        bool index_certs_155335;
                        
                        if (!ok_or_empty_155334) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155299, ":", (long long) defunc_0_f_res_155306, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:137:35-39\n   #10 ftRelational.fut:136:9-137:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155336 = slt64((int64_t) 0, j_m_i_155323);
                        int32_t dummy_155337;
                        int64_t dummy_155338;
                        
                        if (cond_155336) {
                            bool index_certs_157117;
                            
                            if (!cond_155336) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:137:35-39\n   #12 ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155118 + defunc_0_f_res_155299;
                            int32_t head_res_157119 = ((int32_t *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155337 = head_res_157119;
                            dummy_155338 = head_res_157120;
                        } else {
                            bool y_155343 = slt64((int64_t) 0, j_m_i_155310);
                            bool index_certs_155344;
                            
                            if (!y_155343) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:137:35-39\n   #12 ftRelational.fut:136:9-137:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155345 = start_155118 + merge_sequential_arg2_155308;
                            int32_t head_res_155346 = ((int32_t *) mem_param_165010.mem)[slice_155345];
                            int64_t head_res_155347 = ((int64_t *) mem_param_165013.mem)[slice_155345];
                            
                            dummy_155337 = head_res_155346;
                            dummy_155338 = head_res_155347;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154931; nest_i_165735++) {
                            ((int32_t *) mem_165046)[i_164739 * merge_block_sizze_154931 + nest_i_165735] = dummy_155337;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154931; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + nest_i_165736] = dummy_155338;
                        }
                        
                        int64_t data_155350;
                        int64_t i_155354 = (int64_t) 0;
                        
                        for (int64_t k_155353 = 0; k_155353 < merge_block_sizze_154931; k_155353++) {
                            int64_t j_155357 = sub64(k_155353, i_155354);
                            bool cond_155358 = j_155357 == j_m_i_155310;
                            bool cond_155359;
                            
                            if (cond_155358) {
                                cond_155359 = 1;
                            } else {
                                bool cond_155360 = slt64(i_155354, j_m_i_155323);
                                bool cond_f_res_155361;
                                
                                if (cond_155360) {
                                    bool x_157121 = sle64((int64_t) 0, j_155357);
                                    bool y_157122 = slt64(j_155357, j_m_i_155310);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155354);
                                    bool bounds_check_157129 = cond_155360 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155308 + j_155357;
                                    int64_t slice_157126 = start_155118 + slice_157125;
                                    int32_t leq_arg1_157127 = ((int32_t *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155299 + i_155354;
                                    int64_t slice_157132 = start_155118 + slice_157131;
                                    int32_t leq_arg0_157133 = ((int32_t *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = sle32(leq_arg0_157133, leq_arg1_157127);
                                    
                                    cond_f_res_155361 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155361 = 0;
                                }
                                cond_155359 = cond_f_res_155361;
                            }
                            
                            int64_t loopres_155376;
                            int32_t loopres_155377;
                            int64_t loopres_155378;
                            
                            if (cond_155359) {
                                bool x_157136 = sle64((int64_t) 0, i_155354);
                                bool y_157137 = slt64(i_155354, j_m_i_155323);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155354);
                                int64_t slice_157140 = defunc_0_f_res_155299 + i_155354;
                                int64_t slice_157141 = start_155118 + slice_157140;
                                int32_t tmp_157142 = ((int32_t *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155376 = tmp_157135;
                                loopres_155377 = tmp_157142;
                                loopres_155378 = tmp_157143;
                            } else {
                                bool x_155388 = sle64((int64_t) 0, j_155357);
                                bool y_155389 = slt64(j_155357, j_m_i_155310);
                                bool bounds_check_155390 = x_155388 && y_155389;
                                bool index_certs_155391;
                                
                                if (!bounds_check_155390) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:137:35-39\n   #11 ftRelational.fut:136:9-137:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155392 = merge_sequential_arg2_155308 + j_155357;
                                int64_t slice_155393 = start_155118 + slice_155392;
                                int32_t tmp_155394 = ((int32_t *) mem_param_165010.mem)[slice_155393];
                                int64_t tmp_155395 = ((int64_t *) mem_param_165013.mem)[slice_155393];
                                
                                loopres_155376 = i_155354;
                                loopres_155377 = tmp_155394;
                                loopres_155378 = tmp_155395;
                            }
                            ((int32_t *) mem_165046)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155377;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155378;
                            
                            int64_t i_tmp_165737 = loopres_155376;
                            
                            i_155354 = i_tmp_165737;
                        }
                        data_155350 = i_155354;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint32_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165048, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_165016, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155402 = next_stride_155046 * num_merges_155050;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint32_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            if (memblock_alloc(ctx, &mem_165126, bytes_165018, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            
            bool loop_cond_155405 = slt64(next_stride_155046, flat_dim_154927);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155402;
            bool loop_while_tmp_165714 = loop_cond_155405;
            int64_t stride_tmp_165717 = next_stride_155046;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155041 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155042 = loop_while_tmp_165714;
            stride_155045 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155036 = loop_dz2084Uz2082U_155041;
        data_155037 = loop_while_155042;
        data_155040 = stride_155045;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155406 = n_104656 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155407 = sle64((int64_t) 0, zs_lhs_154911);
        bool i_p_m_t_s_leq_w_155408 = slt64(zs_lhs_154911, data_155036);
        bool y_155409 = zzero_leq_i_p_m_t_s_155407 && i_p_m_t_s_leq_w_155408;
        bool ok_or_empty_155410 = empty_slice_155406 || y_155409;
        bool index_certs_155411;
        
        if (!ok_or_empty_155410) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_104656, "] out of bounds for array of shape [", (long long) data_155036, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:137:35-39\n   #6  ftRelational.fut:136:9-137:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_104656; i_164753++) {
        int64_t eta_p_155419 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155420 = sle64((int64_t) 0, eta_p_155419);
        bool y_155421 = slt64(eta_p_155419, n_104656);
        bool bounds_check_155422 = x_155420 && y_155421;
        bool index_certs_155423;
        
        if (!bounds_check_155422) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155419, "] out of bounds for array of shape [", (long long) n_104656, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:137:35-39\n   #5  ftRelational.fut:136:9-137:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_155424 = ((int64_t *) ext_mem_164929.mem)[eta_p_155419];
        int32_t lifted_lambda_res_155425 = ((int32_t *) xs_mem_164928.mem)[eta_p_155419];
        
        ((int64_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155424;
        ((int32_t *) mem_165140.mem)[i_164753] = lifted_lambda_res_155425;
    }
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166175, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166176, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_166187, struct memblock *mem_out_p_166188, struct memblock xs_mem_164928, int64_t n_106797, int64_t incr_106798)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166189 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166190 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166191 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166192 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166193 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166194 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166195 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166196 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166197 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166198 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_106797;
    bool cond_154910 = sle64(n_106797, (int64_t) 1);
    int64_t zs_lhs_154911 = sub64(n_106797, (int64_t) 1);
    int64_t zp_rhs_154912 = sdiv_safe64(zs_lhs_154911, (int64_t) 20);
    int64_t min_num_blocks_154913 = add64((int64_t) 1, zp_rhs_154912);
    bool loop_cond_154914 = slt64((int64_t) 1, min_num_blocks_154913);
    bool smallest_pow_2_geq_than_res_154915;
    int64_t smallest_pow_2_geq_than_res_154916;
    bool loop_while_154917;
    int64_t x_154918;
    
    loop_while_154917 = loop_cond_154914;
    x_154918 = (int64_t) 1;
    while (loop_while_154917) {
        int64_t loopres_154919 = mul64((int64_t) 2, x_154918);
        bool loop_cond_154920 = slt64(loopres_154919, min_num_blocks_154913);
        bool loop_while_tmp_165695 = loop_cond_154920;
        int64_t x_tmp_165696 = loopres_154919;
        
        loop_while_154917 = loop_while_tmp_165695;
        x_154918 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154915 = loop_while_154917;
    smallest_pow_2_geq_than_res_154916 = x_154918;
    
    bool zzero_154921 = smallest_pow_2_geq_than_res_154916 == (int64_t) 0;
    bool nonzzero_154922 = !zzero_154921;
    bool protect_assert_disj_154923 = cond_154910 || nonzzero_154922;
    bool nonzzero_cert_154924;
    
    if (!protect_assert_disj_154923) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154925 = sdiv_safe64(zs_lhs_154911, smallest_pow_2_geq_than_res_154916);
    int64_t block_sizze_154926 = add64((int64_t) 1, zp_rhs_154925);
    bool y_154932 = slt64((int64_t) 0, n_106797);
    bool protect_assert_disj_165536 = cond_154910 || y_154932;
    bool index_certs_154933;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_106797, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154947 = slt64(smallest_pow_2_geq_than_res_154916, (int64_t) 0);
    bool valid_154948 = !bounds_invalid_upwards_154947;
    bool protect_assert_disj_165544 = cond_154910 || valid_154948;
    bool range_valid_c_154949;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154916, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:139:35-39\n   #6  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154951 = slt64(block_sizze_154926, (int64_t) 0);
    bool valid_154952 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_165546 = cond_154910 || valid_154952;
    bool range_valid_c_154953;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154926, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154955 = sle64(block_sizze_154926, (int64_t) 1);
    int64_t tmp_154956 = sub64(block_sizze_154926, (int64_t) 2);
    bool bounds_invalid_upwards_154957 = slt64(tmp_154956, (int64_t) 0);
    bool valid_154959 = !bounds_invalid_upwards_154957;
    bool protect_assert_disj_154960 = cond_154955 || valid_154959;
    bool protect_assert_disj_165548 = cond_154910 || protect_assert_disj_154960;
    bool range_valid_c_154961;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154956, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_12184(ctx, &ext_mem_164929, xs_mem_164928, n_106797, incr_106798) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_106797; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154927 = smallest_pow_2_geq_than_res_154916 * block_sizze_154926;
    bool x_165531 = !cond_154910;
    int64_t greatest_divisor_leq_than_arg1_154930 = mul64((int64_t) 2, block_sizze_154926);
    int64_t merge_block_sizze_154931;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154930) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154931 = x_165533;
    } else {
        merge_block_sizze_154931 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_154934;
    
    if (x_165531) {
        int64_t x_165537 = ((int64_t *) xs_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154934 = x_165537;
    } else {
        reduce_arg1_154934 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        int64_t x_165539;
        int64_t x_165540;
        int64_t redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154934;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_106797; i_164713++) {
            int64_t x_154938 = ((int64_t *) xs_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154944 = sle64(redout_164711, x_154938);
            int64_t defunc_0_op_res_154945;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154945 = x_154938;
            } else {
                defunc_0_op_res_154945 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154946;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154946 = i_164713;
            } else {
                defunc_0_op_res_154946 = redout_164712;
            }
            
            int64_t redout_tmp_165699 = defunc_0_op_res_154945;
            int64_t redout_tmp_165700 = defunc_0_op_res_154946;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = (int64_t) 0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154958 = add64((int64_t) 1, tmp_154956);
    int64_t binop_x_164932 = (int64_t) 8 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164933 = block_sizze_154926 * binop_x_164932;
    int64_t bytes_164946 = (int64_t) 8 * block_sizze_154926;
    bool loop_cond_155033 = slt64(block_sizze_154926, flat_dim_154927);
    bool zzero_155034 = merge_block_sizze_154931 == (int64_t) 0;
    bool nonzzero_155035 = !zzero_155034;
    
    if (cond_154910) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166189 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166189, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166190 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166190, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166191 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166191, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166192 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166192, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154916; i_164725++) {
            int64_t zp_lhs_154965 = mul64(block_sizze_154926, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154926; i_164718++) {
                int64_t k_154969 = add64(zp_lhs_154965, i_164718);
                bool cond_154970 = slt64(k_154969, n_106797);
                int64_t lifted_lambda_res_154971;
                int64_t lifted_lambda_res_154972;
                
                if (cond_154970) {
                    bool x_157003 = sle64((int64_t) 0, k_154969);
                    bool bounds_check_157004 = cond_154970 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154969, "] out of bounds for array of shape [", (long long) n_106797, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_157006 = ((int64_t *) xs_mem_164928.mem)[k_154969];
                    
                    lifted_lambda_res_154971 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154972 = k_154969;
                } else {
                    lifted_lambda_res_154971 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154972 = defunc_0_reduce_res_157151;
                }
                ((int64_t *) mem_164947)[i_164718] = lifted_lambda_res_154971;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154972;
            }
            if (!cond_154955) {
                for (int64_t i_154982 = 0; i_154982 < distance_154958; i_154982++) {
                    int64_t gt_arg1_154985 = add64((int64_t) 1, i_154982);
                    bool x_154986 = sle64((int64_t) 0, gt_arg1_154985);
                    bool y_154987 = slt64(gt_arg1_154985, block_sizze_154926);
                    bool bounds_check_154988 = x_154986 && y_154987;
                    bool index_certs_154989;
                    
                    if (!bounds_check_154988) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154985, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154991 = slt64(i_154982, block_sizze_154926);
                    bool index_certs_154992;
                    
                    if (!y_154991) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154982, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_154990 = ((int64_t *) mem_164947)[gt_arg1_154985];
                    int64_t gt_arg0_154993 = ((int64_t *) mem_164947)[i_154982];
                    bool defunc_0_leq_res_154994 = sle64(gt_arg0_154993, gt_arg1_154990);
                    bool defunc_0_lifted_gt_res_154995 = !defunc_0_leq_res_154994;
                    bool s_154996;
                    int64_t s_154999;
                    bool loop_while_155000;
                    int64_t j_155003;
                    
                    loop_while_155000 = defunc_0_lifted_gt_res_154995;
                    j_155003 = i_154982;
                    while (loop_while_155000) {
                        bool x_155004 = sle64((int64_t) 0, j_155003);
                        bool y_155005 = slt64(j_155003, block_sizze_154926);
                        bool bounds_check_155006 = x_155004 && y_155005;
                        bool index_certs_155007;
                        
                        if (!bounds_check_155006) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155003, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155010 = add64((int64_t) 1, j_155003);
                        bool x_155011 = sle64((int64_t) 0, copy_arg0_155010);
                        bool y_155012 = slt64(copy_arg0_155010, block_sizze_154926);
                        bool bounds_check_155013 = x_155011 && y_155012;
                        bool index_certs_155014;
                        
                        if (!bounds_check_155013) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155010, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155008 = ((int64_t *) mem_164947)[j_155003];
                        int64_t copy_arg0_155009 = ((int64_t *) mem_164949)[j_155003];
                        int64_t copy_arg0_155015 = ((int64_t *) mem_164947)[copy_arg0_155010];
                        int64_t copy_arg0_155016 = ((int64_t *) mem_164949)[copy_arg0_155010];
                        
                        ((int64_t *) mem_164947)[j_155003] = copy_arg0_155015;
                        ((int64_t *) mem_164949)[j_155003] = copy_arg0_155016;
                        ((int64_t *) mem_164947)[copy_arg0_155010] = copy_arg0_155008;
                        ((int64_t *) mem_164949)[copy_arg0_155010] = copy_arg0_155009;
                        
                        int64_t tmp_155021 = sub64(j_155003, (int64_t) 1);
                        bool cond_155022 = sle64((int64_t) 0, tmp_155021);
                        bool loop_cond_155023;
                        
                        if (cond_155022) {
                            bool y_157008 = slt64(tmp_155021, block_sizze_154926);
                            bool bounds_check_157009 = cond_155022 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155021, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_157007 = ((int64_t *) mem_164947)[j_155003];
                            int64_t gt_arg0_157011 = ((int64_t *) mem_164947)[tmp_155021];
                            bool defunc_0_leq_res_157012 = sle64(gt_arg0_157011, gt_arg1_157007);
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155023 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155023 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155023;
                        int64_t j_tmp_165710 = tmp_155021;
                        
                        loop_while_155000 = loop_while_tmp_165707;
                        j_155003 = j_tmp_165710;
                    }
                    s_154996 = loop_while_155000;
                    s_154999 = j_155003;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164934, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        if (memblock_alloc(ctx, &mem_165006, bytes_164933, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        
        int64_t data_155036;
        bool data_155037;
        int64_t data_155040;
        int64_t loop_dz2084Uz2082U_155041;
        bool loop_while_155042;
        int64_t stride_155045;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155041 = flat_dim_154927;
        loop_while_155042 = loop_cond_155033;
        stride_155045 = block_sizze_154926;
        while (loop_while_155042) {
            int64_t next_stride_155046 = mul64((int64_t) 2, stride_155045);
            bool zzero_155047 = next_stride_155046 == (int64_t) 0;
            bool nonzzero_155048 = !zzero_155047;
            bool nonzzero_cert_155049;
            
            if (!nonzzero_155048) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155050 = sdiv64(flat_dim_154927, next_stride_155046);
            bool bounds_invalid_upwards_155051 = slt64(num_merges_155050, (int64_t) 0);
            bool valid_155052 = !bounds_invalid_upwards_155051;
            bool range_valid_c_155053;
            
            if (!valid_155052) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155050, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:139:35-39\n   #6  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155055 = sub64(next_stride_155046, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155056 = sle64((int64_t) 0, m_155055);
            bool cond_155058 = slt64(next_stride_155046, (int64_t) 10);
            bool protect_assert_disj_155059 = nonzzero_155035 || cond_155058;
            bool nonzzero_cert_155060;
            
            if (!protect_assert_disj_155059) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155061 = smod_safe64(next_stride_155046, merge_block_sizze_154931);
            bool num_blocks_155062 = zeze_lhs_155061 == (int64_t) 0;
            bool protect_assert_disj_155063 = cond_155058 || num_blocks_155062;
            bool assert_c_155064;
            
            if (!protect_assert_disj_155063) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155066 = sdiv_safe64(next_stride_155046, merge_block_sizze_154931);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067 = add64((int64_t) 1, num_blocks_155066);
            int64_t j_m_i_155068 = sub64(next_stride_155046, stride_155045);
            int64_t flat_dim_155069 = merge_block_sizze_154931 * num_blocks_155066;
            bool bounds_invalid_upwards_155070 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, (int64_t) 0);
            bool empty_slice_155071 = j_m_i_155068 == (int64_t) 0;
            int64_t m_155072 = sub64(j_m_i_155068, (int64_t) 1);
            bool zzero_lte_i_155073 = sle64((int64_t) 0, stride_155045);
            bool i_lte_j_155074 = sle64(stride_155045, next_stride_155046);
            bool empty_slice_155075 = stride_155045 == (int64_t) 0;
            int64_t m_155076 = sub64(stride_155045, (int64_t) 1);
            bool bounds_invalid_upwards_155077 = slt64(num_blocks_155066, (int64_t) 0);
            bool cond_155078 = slt64((int64_t) 0, stride_155045);
            bool valid_155079 = !bounds_invalid_upwards_155070;
            int64_t i_p_m_t_s_155080 = add64(stride_155045, m_155072);
            bool zzero_leq_i_p_m_t_s_155081 = sle64((int64_t) 0, m_155076);
            bool i_p_m_t_s_leq_w_155082 = slt64(m_155076, next_stride_155046);
            bool valid_155083 = !bounds_invalid_upwards_155077;
            bool i_p_m_t_s_leq_w_155084 = slt64(m_155055, flat_dim_155069);
            bool y_155085 = slt64((int64_t) 0, j_m_i_155068);
            bool protect_assert_disj_155086 = cond_155058 || valid_155079;
            bool range_valid_c_155087;
            
            if (!protect_assert_disj_155086) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155088 = sle64((int64_t) 0, i_p_m_t_s_155080);
            bool i_p_m_t_s_leq_w_155089 = slt64(i_p_m_t_s_155080, next_stride_155046);
            bool y_155090 = zzero_leq_i_p_m_t_s_155081 && i_p_m_t_s_leq_w_155082;
            bool protect_assert_disj_155091 = cond_155058 || valid_155083;
            bool range_valid_c_155092;
            
            if (!protect_assert_disj_155091) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155093 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155084;
            bool y_155094 = zzero_lte_i_155073 && i_p_m_t_s_leq_w_155089;
            bool forwards_ok_155095 = zzero_lte_i_155073 && y_155090;
            bool ok_or_empty_155096 = zzero_155047 || y_155093;
            bool protect_assert_disj_155097 = cond_155078 || y_155085;
            bool y_155098 = zzero_leq_i_p_m_t_s_155088 && y_155094;
            bool ok_or_empty_155099 = empty_slice_155075 || forwards_ok_155095;
            bool protect_assert_disj_155100 = cond_155058 || ok_or_empty_155096;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) flat_dim_155069, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155102 = !cond_155058;
            bool protect_assert_disj_155103 = protect_assert_disj_155097 || loop_not_taken_155102;
            bool index_certs_155104;
            
            if (!protect_assert_disj_155103) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155105 = i_lte_j_155074 && y_155098;
            bool protect_assert_disj_155106 = cond_155058 || ok_or_empty_155099;
            bool index_certs_155107;
            
            if (!protect_assert_disj_155106) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155108 = ok_or_empty_155099 || loop_not_taken_155102;
            bool index_certs_155109;
            
            if (!protect_assert_disj_155108) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155110 = empty_slice_155071 || forwards_ok_155105;
            bool protect_assert_disj_155111 = cond_155058 || ok_or_empty_155110;
            bool index_certs_155112;
            
            if (!protect_assert_disj_155111) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155113 = loop_not_taken_155102 || ok_or_empty_155110;
            bool index_certs_155114;
            
            if (!protect_assert_disj_155113) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 8 * num_merges_155050;
            int64_t bytes_165015 = next_stride_155046 * binop_x_165014;
            bool i_lte_j_155057 = sle64((int64_t) 0, next_stride_155046);
            
            if (mem_165016_cached_sizze_166193 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166193, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166194 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166194, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067;
            int64_t binop_x_165044 = (int64_t) 8 * num_blocks_155066;
            int64_t bytes_165045 = merge_block_sizze_154931 * binop_x_165044;
            int64_t bytes_165090 = (int64_t) 16 * stride_155045;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155050; i_164746++) {
                int64_t start_155118 = mul64(next_stride_155046, i_164746);
                int64_t j_m_i_155119 = sub64(loop_dz2084Uz2082U_155041, start_155118);
                bool empty_slice_155120 = j_m_i_155119 == (int64_t) 0;
                int64_t m_155121 = sub64(j_m_i_155119, (int64_t) 1);
                int64_t i_p_m_t_s_155122 = add64(start_155118, m_155121);
                bool zzero_leq_i_p_m_t_s_155123 = sle64((int64_t) 0, i_p_m_t_s_155122);
                bool i_p_m_t_s_leq_w_155124 = slt64(i_p_m_t_s_155122, loop_dz2084Uz2082U_155041);
                bool zzero_lte_i_155125 = sle64((int64_t) 0, start_155118);
                bool i_lte_j_155126 = sle64(start_155118, loop_dz2084Uz2082U_155041);
                bool y_155127 = i_p_m_t_s_leq_w_155124 && zzero_lte_i_155125;
                bool y_155128 = zzero_leq_i_p_m_t_s_155123 && y_155127;
                bool forwards_ok_155129 = i_lte_j_155126 && y_155128;
                bool ok_or_empty_155130 = empty_slice_155120 || forwards_ok_155129;
                bool index_certs_155131;
                
                if (!ok_or_empty_155130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155118, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155041, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155132 = slt64(m_155055, j_m_i_155119);
                bool y_155133 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155132;
                bool forwards_ok_155134 = i_lte_j_155057 && y_155133;
                bool ok_or_empty_155135 = zzero_155047 || forwards_ok_155134;
                bool index_certs_155136;
                
                if (!ok_or_empty_155135) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) j_m_i_155119, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:139:35-39\n   #8  ftRelational.fut:138:9-139:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155058) {
                    int64_t dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155078) {
                        int64_t head_res_157041 = ((int64_t *) mem_param_165010.mem)[start_155118];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155118];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155045 + start_155118;
                        int64_t head_res_157044 = ((int64_t *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155046; nest_i_165720++) {
                        ((int64_t *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165090, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155046; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155046; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155068;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155045);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155068);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155045 + j_157055;
                                int64_t slice_157065 = start_155118 + slice_157064;
                                int64_t leq_arg1_157066 = ((int64_t *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155118 + i_157052;
                                int64_t leq_arg0_157071 = ((int64_t *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = sle64(leq_arg0_157071, leq_arg1_157066);
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        int64_t loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155045);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155118 + i_157052;
                            int64_t tmp_157082 = ((int64_t *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155068);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:139:35-39\n   #9  ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155045 + j_157055;
                            int64_t slice_157089 = start_155118 + slice_157088;
                            int64_t tmp_157090 = ((int64_t *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((int64_t *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166195 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166195, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166196 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166196, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067; i_164732++) {
                        int64_t split_count_arg3_155198 = mul64(merge_block_sizze_154931, i_164732);
                        int64_t defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155199, &defunc_0_split_count_res_155200, &defunc_0_split_count_res_155201, &defunc_0_split_count_res_155202, &defunc_0_split_count_res_155203, (int64_t) 0, stride_155045, (int64_t) 0, j_m_i_155068, split_count_arg3_155198) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155204 = slt64((int64_t) 0, defunc_0_split_count_res_155203);
                        bool defunc_0_split_count_res_155205;
                        int64_t defunc_0_split_count_res_155206;
                        int64_t defunc_0_split_count_res_155207;
                        int64_t defunc_0_split_count_res_155208;
                        int64_t defunc_0_split_count_res_155209;
                        int64_t defunc_0_split_count_res_155210;
                        bool loop_while_155211;
                        int64_t ss_155212;
                        int64_t ss_155213;
                        int64_t tt_155214;
                        int64_t tt_155215;
                        int64_t count_155216;
                        
                        loop_while_155211 = loop_cond_155204;
                        ss_155212 = defunc_0_split_count_res_155199;
                        ss_155213 = defunc_0_split_count_res_155200;
                        tt_155214 = defunc_0_split_count_res_155201;
                        tt_155215 = defunc_0_split_count_res_155202;
                        count_155216 = defunc_0_split_count_res_155203;
                        while (loop_while_155211) {
                            int64_t zlze_lhs_155217 = sub64(ss_155213, ss_155212);
                            bool cond_155218 = sle64(zlze_lhs_155217, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155219;
                            int64_t defunc_0_lifted_step_res_155220;
                            int64_t defunc_0_lifted_step_res_155221;
                            int64_t defunc_0_lifted_step_res_155222;
                            
                            if (cond_155218) {
                                int64_t tmp_157094 = add64(tt_155214, count_155216);
                                
                                defunc_0_lifted_step_res_155219 = ss_155212;
                                defunc_0_lifted_step_res_155220 = tmp_157094;
                                defunc_0_lifted_step_res_155221 = tt_155215;
                                defunc_0_lifted_step_res_155222 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155224 = sub64(tt_155215, tt_155214);
                                bool cond_155225 = sle64(zlze_lhs_155224, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155226;
                                int64_t defunc_0_lifted_step_res_f_res_155227;
                                int64_t defunc_0_lifted_step_res_f_res_155228;
                                int64_t defunc_0_lifted_step_res_f_res_155229;
                                
                                if (cond_155225) {
                                    int64_t tmp_157095 = add64(ss_155212, count_155216);
                                    
                                    defunc_0_lifted_step_res_f_res_155226 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155227 = tt_155214;
                                    defunc_0_lifted_step_res_f_res_155228 = tt_155215;
                                    defunc_0_lifted_step_res_f_res_155229 = (int64_t) 0;
                                } else {
                                    bool cond_155231 = count_155216 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155232;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155233;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155234;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155235;
                                    
                                    if (cond_155231) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155212);
                                        bool y_157098 = slt64(ss_155212, stride_155045);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155212, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155214);
                                        bool y_157104 = slt64(tt_155214, j_m_i_155068);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155214, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155118 + ss_155212;
                                        int64_t leq_arg1_157102 = ((int64_t *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155045 + tt_155214;
                                        int64_t slice_157108 = start_155118 + slice_157107;
                                        int64_t leq_arg0_157109 = ((int64_t *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = sle64(leq_arg0_157109, leq_arg1_157102);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155214);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155212;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155212);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155214;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = tt_155215;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = (int64_t) 0;
                                    } else {
                                        int64_t m_155254 = sdiv64(count_155216, (int64_t) 2);
                                        int64_t n_155255 = sub64(count_155216, m_155254);
                                        bool cond_155256 = n_155255 == (int64_t) 0;
                                        int64_t zgze_lhs_155257 = add64(ss_155212, m_155254);
                                        bool cond_f_res_155258 = sle64(ss_155213, zgze_lhs_155257);
                                        bool x_155259 = !cond_155256;
                                        bool y_155260 = cond_f_res_155258 && x_155259;
                                        bool cond_155261 = cond_155256 || y_155260;
                                        bool leq_y_x_155262;
                                        
                                        if (cond_155261) {
                                            leq_y_x_155262 = 1;
                                        } else {
                                            bool x_155263 = sle64((int64_t) 0, zgze_lhs_155257);
                                            bool y_155264 = slt64(zgze_lhs_155257, stride_155045);
                                            bool bounds_check_155265 = x_155263 && y_155264;
                                            bool index_certs_155266;
                                            
                                            if (!bounds_check_155265) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155257, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155269 = add64(tt_155214, n_155255);
                                            int64_t leq_arg0_155270 = sub64(zm_lhs_155269, (int64_t) 1);
                                            bool x_155271 = sle64((int64_t) 0, leq_arg0_155270);
                                            bool y_155272 = slt64(leq_arg0_155270, j_m_i_155068);
                                            bool bounds_check_155273 = x_155271 && y_155272;
                                            bool index_certs_155274;
                                            
                                            if (!bounds_check_155273) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155270, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:139:35-39\n   #13 ftRelational.fut:138:9-139:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155267 = start_155118 + zgze_lhs_155257;
                                            int64_t leq_arg1_155268 = ((int64_t *) mem_param_165010.mem)[slice_155267];
                                            int64_t slice_155275 = stride_155045 + leq_arg0_155270;
                                            int64_t slice_155276 = start_155118 + slice_155275;
                                            int64_t leq_arg0_155277 = ((int64_t *) mem_param_165010.mem)[slice_155276];
                                            bool defunc_0_leq_res_155278 = sle64(leq_arg0_155277, leq_arg1_155268);
                                            
                                            leq_y_x_155262 = defunc_0_leq_res_155278;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                        
                                        if (leq_y_x_155262) {
                                            int64_t tmp_157115 = add64(tt_155214, n_155255);
                                            int64_t tmp_157116 = sub64(count_155216, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tt_155215;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = tmp_157116;
                                        } else {
                                            int64_t tmp_155284 = add64(tt_155214, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tt_155214;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tmp_155284;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = count_155216;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = ss_155212;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                    }
                                    defunc_0_lifted_step_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_155232;
                                    defunc_0_lifted_step_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_155233;
                                    defunc_0_lifted_step_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_155234;
                                    defunc_0_lifted_step_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_155235;
                                }
                                defunc_0_lifted_step_res_155219 = defunc_0_lifted_step_res_f_res_155226;
                                defunc_0_lifted_step_res_155220 = defunc_0_lifted_step_res_f_res_155227;
                                defunc_0_lifted_step_res_155221 = defunc_0_lifted_step_res_f_res_155228;
                                defunc_0_lifted_step_res_155222 = defunc_0_lifted_step_res_f_res_155229;
                            }
                            
                            int64_t loopres_155285;
                            int64_t loopres_155286;
                            int64_t loopres_155287;
                            int64_t loopres_155288;
                            int64_t loopres_155289;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155285, &loopres_155286, &loopres_155287, &loopres_155288, &loopres_155289, defunc_0_lifted_step_res_155219, ss_155213, defunc_0_lifted_step_res_155220, defunc_0_lifted_step_res_155221, defunc_0_lifted_step_res_155222) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155290 = slt64((int64_t) 0, loopres_155289);
                            bool loop_while_tmp_165727 = loop_cond_155290;
                            int64_t ss_tmp_165728 = loopres_155285;
                            int64_t ss_tmp_165729 = loopres_155286;
                            int64_t tt_tmp_165730 = loopres_155287;
                            int64_t tt_tmp_165731 = loopres_155288;
                            int64_t count_tmp_165732 = loopres_155289;
                            
                            loop_while_155211 = loop_while_tmp_165727;
                            ss_155212 = ss_tmp_165728;
                            ss_155213 = ss_tmp_165729;
                            tt_155214 = tt_tmp_165730;
                            tt_155215 = tt_tmp_165731;
                            count_155216 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155205 = loop_while_155211;
                        defunc_0_split_count_res_155206 = ss_155212;
                        defunc_0_split_count_res_155207 = ss_155213;
                        defunc_0_split_count_res_155208 = tt_155214;
                        defunc_0_split_count_res_155209 = tt_155215;
                        defunc_0_split_count_res_155210 = count_155216;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155206;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155208;
                    }
                    if (mem_165046_cached_sizze_166197 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166197, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166198 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166198, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155066; i_164739++) {
                        bool y_155296 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool index_certs_155298;
                        
                        if (!y_155296) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155299 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155301 = add64((int64_t) 1, i_164739);
                        bool x_155302 = sle64((int64_t) 0, tmp_155301);
                        bool y_155303 = slt64(tmp_155301, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool bounds_check_155304 = x_155302 && y_155303;
                        bool index_certs_155305;
                        
                        if (!bounds_check_155304) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155301, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155306 = ((int64_t *) mem_165029)[tmp_155301];
                        int64_t defunc_0_f_res_155307 = ((int64_t *) mem_165031)[tmp_155301];
                        int64_t merge_sequential_arg2_155308 = add64(stride_155045, defunc_0_f_res_155300);
                        int64_t merge_sequential_arg2_155309 = add64(stride_155045, defunc_0_f_res_155307);
                        int64_t j_m_i_155310 = sub64(merge_sequential_arg2_155309, merge_sequential_arg2_155308);
                        bool empty_slice_155311 = j_m_i_155310 == (int64_t) 0;
                        int64_t m_155312 = sub64(j_m_i_155310, (int64_t) 1);
                        int64_t i_p_m_t_s_155313 = add64(merge_sequential_arg2_155308, m_155312);
                        bool zzero_leq_i_p_m_t_s_155314 = sle64((int64_t) 0, i_p_m_t_s_155313);
                        bool i_p_m_t_s_leq_w_155315 = slt64(i_p_m_t_s_155313, next_stride_155046);
                        bool zzero_lte_i_155316 = sle64((int64_t) 0, merge_sequential_arg2_155308);
                        bool i_lte_j_155317 = sle64(merge_sequential_arg2_155308, merge_sequential_arg2_155309);
                        bool y_155318 = i_p_m_t_s_leq_w_155315 && zzero_lte_i_155316;
                        bool y_155319 = zzero_leq_i_p_m_t_s_155314 && y_155318;
                        bool forwards_ok_155320 = i_lte_j_155317 && y_155319;
                        bool ok_or_empty_155321 = empty_slice_155311 || forwards_ok_155320;
                        bool index_certs_155322;
                        
                        if (!ok_or_empty_155321) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155308, ":", (long long) merge_sequential_arg2_155309, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155323 = sub64(defunc_0_f_res_155306, defunc_0_f_res_155299);
                        bool empty_slice_155324 = j_m_i_155323 == (int64_t) 0;
                        int64_t m_155325 = sub64(j_m_i_155323, (int64_t) 1);
                        int64_t i_p_m_t_s_155326 = add64(defunc_0_f_res_155299, m_155325);
                        bool zzero_leq_i_p_m_t_s_155327 = sle64((int64_t) 0, i_p_m_t_s_155326);
                        bool i_p_m_t_s_leq_w_155328 = slt64(i_p_m_t_s_155326, next_stride_155046);
                        bool zzero_lte_i_155329 = sle64((int64_t) 0, defunc_0_f_res_155299);
                        bool i_lte_j_155330 = sle64(defunc_0_f_res_155299, defunc_0_f_res_155306);
                        bool y_155331 = i_p_m_t_s_leq_w_155328 && zzero_lte_i_155329;
                        bool y_155332 = zzero_leq_i_p_m_t_s_155327 && y_155331;
                        bool forwards_ok_155333 = i_lte_j_155330 && y_155332;
                        bool ok_or_empty_155334 = empty_slice_155324 || forwards_ok_155333;
                        bool index_certs_155335;
                        
                        if (!ok_or_empty_155334) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155299, ":", (long long) defunc_0_f_res_155306, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:139:35-39\n   #10 ftRelational.fut:138:9-139:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155336 = slt64((int64_t) 0, j_m_i_155323);
                        int64_t dummy_155337;
                        int64_t dummy_155338;
                        
                        if (cond_155336) {
                            bool index_certs_157117;
                            
                            if (!cond_155336) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:139:35-39\n   #12 ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155118 + defunc_0_f_res_155299;
                            int64_t head_res_157119 = ((int64_t *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155337 = head_res_157119;
                            dummy_155338 = head_res_157120;
                        } else {
                            bool y_155343 = slt64((int64_t) 0, j_m_i_155310);
                            bool index_certs_155344;
                            
                            if (!y_155343) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:139:35-39\n   #12 ftRelational.fut:138:9-139:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155345 = start_155118 + merge_sequential_arg2_155308;
                            int64_t head_res_155346 = ((int64_t *) mem_param_165010.mem)[slice_155345];
                            int64_t head_res_155347 = ((int64_t *) mem_param_165013.mem)[slice_155345];
                            
                            dummy_155337 = head_res_155346;
                            dummy_155338 = head_res_155347;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154931; nest_i_165735++) {
                            ((int64_t *) mem_165046)[i_164739 * merge_block_sizze_154931 + nest_i_165735] = dummy_155337;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154931; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + nest_i_165736] = dummy_155338;
                        }
                        
                        int64_t data_155350;
                        int64_t i_155354 = (int64_t) 0;
                        
                        for (int64_t k_155353 = 0; k_155353 < merge_block_sizze_154931; k_155353++) {
                            int64_t j_155357 = sub64(k_155353, i_155354);
                            bool cond_155358 = j_155357 == j_m_i_155310;
                            bool cond_155359;
                            
                            if (cond_155358) {
                                cond_155359 = 1;
                            } else {
                                bool cond_155360 = slt64(i_155354, j_m_i_155323);
                                bool cond_f_res_155361;
                                
                                if (cond_155360) {
                                    bool x_157121 = sle64((int64_t) 0, j_155357);
                                    bool y_157122 = slt64(j_155357, j_m_i_155310);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155354);
                                    bool bounds_check_157129 = cond_155360 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155308 + j_155357;
                                    int64_t slice_157126 = start_155118 + slice_157125;
                                    int64_t leq_arg1_157127 = ((int64_t *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155299 + i_155354;
                                    int64_t slice_157132 = start_155118 + slice_157131;
                                    int64_t leq_arg0_157133 = ((int64_t *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = sle64(leq_arg0_157133, leq_arg1_157127);
                                    
                                    cond_f_res_155361 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155361 = 0;
                                }
                                cond_155359 = cond_f_res_155361;
                            }
                            
                            int64_t loopres_155376;
                            int64_t loopres_155377;
                            int64_t loopres_155378;
                            
                            if (cond_155359) {
                                bool x_157136 = sle64((int64_t) 0, i_155354);
                                bool y_157137 = slt64(i_155354, j_m_i_155323);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155354);
                                int64_t slice_157140 = defunc_0_f_res_155299 + i_155354;
                                int64_t slice_157141 = start_155118 + slice_157140;
                                int64_t tmp_157142 = ((int64_t *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155376 = tmp_157135;
                                loopres_155377 = tmp_157142;
                                loopres_155378 = tmp_157143;
                            } else {
                                bool x_155388 = sle64((int64_t) 0, j_155357);
                                bool y_155389 = slt64(j_155357, j_m_i_155310);
                                bool bounds_check_155390 = x_155388 && y_155389;
                                bool index_certs_155391;
                                
                                if (!bounds_check_155390) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:139:35-39\n   #11 ftRelational.fut:138:9-139:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155392 = merge_sequential_arg2_155308 + j_155357;
                                int64_t slice_155393 = start_155118 + slice_155392;
                                int64_t tmp_155394 = ((int64_t *) mem_param_165010.mem)[slice_155393];
                                int64_t tmp_155395 = ((int64_t *) mem_param_165013.mem)[slice_155393];
                                
                                loopres_155376 = i_155354;
                                loopres_155377 = tmp_155394;
                                loopres_155378 = tmp_155395;
                            }
                            ((int64_t *) mem_165046)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155377;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155378;
                            
                            int64_t i_tmp_165737 = loopres_155376;
                            
                            i_155354 = i_tmp_165737;
                        }
                        data_155350 = i_155354;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165045, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165016, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155402 = next_stride_155046 * num_merges_155050;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            if (memblock_alloc(ctx, &mem_165126, bytes_165015, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            
            bool loop_cond_155405 = slt64(next_stride_155046, flat_dim_154927);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155402;
            bool loop_while_tmp_165714 = loop_cond_155405;
            int64_t stride_tmp_165717 = next_stride_155046;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155041 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155042 = loop_while_tmp_165714;
            stride_155045 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155036 = loop_dz2084Uz2082U_155041;
        data_155037 = loop_while_155042;
        data_155040 = stride_155045;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155406 = n_106797 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155407 = sle64((int64_t) 0, zs_lhs_154911);
        bool i_p_m_t_s_leq_w_155408 = slt64(zs_lhs_154911, data_155036);
        bool y_155409 = zzero_leq_i_p_m_t_s_155407 && i_p_m_t_s_leq_w_155408;
        bool ok_or_empty_155410 = empty_slice_155406 || y_155409;
        bool index_certs_155411;
        
        if (!ok_or_empty_155410) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_106797, "] out of bounds for array of shape [", (long long) data_155036, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:139:35-39\n   #6  ftRelational.fut:138:9-139:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_164930, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_106797; i_164753++) {
        int64_t eta_p_155419 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155420 = sle64((int64_t) 0, eta_p_155419);
        bool y_155421 = slt64(eta_p_155419, n_106797);
        bool bounds_check_155422 = x_155420 && y_155421;
        bool index_certs_155423;
        
        if (!bounds_check_155422) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155419, "] out of bounds for array of shape [", (long long) n_106797, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:139:35-39\n   #5  ftRelational.fut:138:9-139:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_155424 = ((int64_t *) ext_mem_164929.mem)[eta_p_155419];
        int64_t lifted_lambda_res_155425 = ((int64_t *) xs_mem_164928.mem)[eta_p_155419];
        
        ((int64_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155424;
        ((int64_t *) mem_165140.mem)[i_164753] = lifted_lambda_res_155425;
    }
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166187, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166188, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_166199, struct memblock *mem_out_p_166200, struct memblock xs_mem_164928, int64_t n_102511, int64_t incr_102512)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166201 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166202 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166203 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166204 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166205 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166206 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166207 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166208 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166209 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166210 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_102511;
    bool cond_154910 = sle64(n_102511, (int64_t) 1);
    int64_t zs_lhs_154911 = sub64(n_102511, (int64_t) 1);
    int64_t zp_rhs_154912 = sdiv_safe64(zs_lhs_154911, (int64_t) 20);
    int64_t min_num_blocks_154913 = add64((int64_t) 1, zp_rhs_154912);
    bool loop_cond_154914 = slt64((int64_t) 1, min_num_blocks_154913);
    bool smallest_pow_2_geq_than_res_154915;
    int64_t smallest_pow_2_geq_than_res_154916;
    bool loop_while_154917;
    int64_t x_154918;
    
    loop_while_154917 = loop_cond_154914;
    x_154918 = (int64_t) 1;
    while (loop_while_154917) {
        int64_t loopres_154919 = mul64((int64_t) 2, x_154918);
        bool loop_cond_154920 = slt64(loopres_154919, min_num_blocks_154913);
        bool loop_while_tmp_165695 = loop_cond_154920;
        int64_t x_tmp_165696 = loopres_154919;
        
        loop_while_154917 = loop_while_tmp_165695;
        x_154918 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154915 = loop_while_154917;
    smallest_pow_2_geq_than_res_154916 = x_154918;
    
    bool zzero_154921 = smallest_pow_2_geq_than_res_154916 == (int64_t) 0;
    bool nonzzero_154922 = !zzero_154921;
    bool protect_assert_disj_154923 = cond_154910 || nonzzero_154922;
    bool nonzzero_cert_154924;
    
    if (!protect_assert_disj_154923) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154925 = sdiv_safe64(zs_lhs_154911, smallest_pow_2_geq_than_res_154916);
    int64_t block_sizze_154926 = add64((int64_t) 1, zp_rhs_154925);
    bool y_154932 = slt64((int64_t) 0, n_102511);
    bool protect_assert_disj_165536 = cond_154910 || y_154932;
    bool index_certs_154933;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_102511, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154947 = slt64(smallest_pow_2_geq_than_res_154916, (int64_t) 0);
    bool valid_154948 = !bounds_invalid_upwards_154947;
    bool protect_assert_disj_165544 = cond_154910 || valid_154948;
    bool range_valid_c_154949;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154916, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:135:35-39\n   #6  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154951 = slt64(block_sizze_154926, (int64_t) 0);
    bool valid_154952 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_165546 = cond_154910 || valid_154952;
    bool range_valid_c_154953;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154926, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154955 = sle64(block_sizze_154926, (int64_t) 1);
    int64_t tmp_154956 = sub64(block_sizze_154926, (int64_t) 2);
    bool bounds_invalid_upwards_154957 = slt64(tmp_154956, (int64_t) 0);
    bool valid_154959 = !bounds_invalid_upwards_154957;
    bool protect_assert_disj_154960 = cond_154955 || valid_154959;
    bool protect_assert_disj_165548 = cond_154910 || protect_assert_disj_154960;
    bool range_valid_c_154961;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154956, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165139 = (int64_t) 2 * n_102511;
    
    if (futrts_indicesWithIncrement_12141(ctx, &ext_mem_164929, xs_mem_164928, n_102511, incr_102512) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_102511; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154927 = smallest_pow_2_geq_than_res_154916 * block_sizze_154926;
    bool x_165531 = !cond_154910;
    int64_t greatest_divisor_leq_than_arg1_154930 = mul64((int64_t) 2, block_sizze_154926);
    int64_t merge_block_sizze_154931;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154930) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154931 = x_165533;
    } else {
        merge_block_sizze_154931 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_154934;
    
    if (x_165531) {
        int16_t x_165537 = ((int16_t *) xs_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154934 = x_165537;
    } else {
        reduce_arg1_154934 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        int16_t x_165539;
        int64_t x_165540;
        int16_t redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154934;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_102511; i_164713++) {
            int16_t x_154938 = ((int16_t *) xs_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154944 = sle16(redout_164711, x_154938);
            int16_t defunc_0_op_res_154945;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154945 = x_154938;
            } else {
                defunc_0_op_res_154945 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154946;
            
            if (defunc_0_leq_res_154944) {
                defunc_0_op_res_154946 = i_164713;
            } else {
                defunc_0_op_res_154946 = redout_164712;
            }
            
            int16_t redout_tmp_165699 = defunc_0_op_res_154945;
            int64_t redout_tmp_165700 = defunc_0_op_res_154946;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = (int16_t) 0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154958 = add64((int64_t) 1, tmp_154956);
    int64_t binop_x_164932 = (int64_t) 2 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164933 = block_sizze_154926 * binop_x_164932;
    int64_t binop_x_164935 = (int64_t) 8 * smallest_pow_2_geq_than_res_154916;
    int64_t bytes_164936 = block_sizze_154926 * binop_x_164935;
    int64_t bytes_164948 = (int64_t) 8 * block_sizze_154926;
    bool loop_cond_155033 = slt64(block_sizze_154926, flat_dim_154927);
    bool zzero_155034 = merge_block_sizze_154931 == (int64_t) 0;
    bool nonzzero_155035 = !zzero_155034;
    
    if (cond_154910) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166201 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166201, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166202 < bytes_164936) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166202, bytes_164936);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166203 < greatest_divisor_leq_than_arg1_154930) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166203, greatest_divisor_leq_than_arg1_154930);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166204 < bytes_164948) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166204, bytes_164948);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154916; i_164725++) {
            int64_t zp_lhs_154965 = mul64(block_sizze_154926, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154926; i_164718++) {
                int64_t k_154969 = add64(zp_lhs_154965, i_164718);
                bool cond_154970 = slt64(k_154969, n_102511);
                int16_t lifted_lambda_res_154971;
                int64_t lifted_lambda_res_154972;
                
                if (cond_154970) {
                    bool x_157003 = sle64((int64_t) 0, k_154969);
                    bool bounds_check_157004 = cond_154970 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154969, "] out of bounds for array of shape [", (long long) n_102511, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_157006 = ((int16_t *) xs_mem_164928.mem)[k_154969];
                    
                    lifted_lambda_res_154971 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154972 = k_154969;
                } else {
                    lifted_lambda_res_154971 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154972 = defunc_0_reduce_res_157151;
                }
                ((int16_t *) mem_164947)[i_164718] = lifted_lambda_res_154971;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154972;
            }
            if (!cond_154955) {
                for (int64_t i_154982 = 0; i_154982 < distance_154958; i_154982++) {
                    int64_t gt_arg1_154985 = add64((int64_t) 1, i_154982);
                    bool x_154986 = sle64((int64_t) 0, gt_arg1_154985);
                    bool y_154987 = slt64(gt_arg1_154985, block_sizze_154926);
                    bool bounds_check_154988 = x_154986 && y_154987;
                    bool index_certs_154989;
                    
                    if (!bounds_check_154988) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154985, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154991 = slt64(i_154982, block_sizze_154926);
                    bool index_certs_154992;
                    
                    if (!y_154991) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154982, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_154990 = ((int16_t *) mem_164947)[gt_arg1_154985];
                    int16_t gt_arg0_154993 = ((int16_t *) mem_164947)[i_154982];
                    bool defunc_0_leq_res_154994 = sle16(gt_arg0_154993, gt_arg1_154990);
                    bool defunc_0_lifted_gt_res_154995 = !defunc_0_leq_res_154994;
                    bool s_154996;
                    int64_t s_154999;
                    bool loop_while_155000;
                    int64_t j_155003;
                    
                    loop_while_155000 = defunc_0_lifted_gt_res_154995;
                    j_155003 = i_154982;
                    while (loop_while_155000) {
                        bool x_155004 = sle64((int64_t) 0, j_155003);
                        bool y_155005 = slt64(j_155003, block_sizze_154926);
                        bool bounds_check_155006 = x_155004 && y_155005;
                        bool index_certs_155007;
                        
                        if (!bounds_check_155006) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155003, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155010 = add64((int64_t) 1, j_155003);
                        bool x_155011 = sle64((int64_t) 0, copy_arg0_155010);
                        bool y_155012 = slt64(copy_arg0_155010, block_sizze_154926);
                        bool bounds_check_155013 = x_155011 && y_155012;
                        bool index_certs_155014;
                        
                        if (!bounds_check_155013) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155010, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_155008 = ((int16_t *) mem_164947)[j_155003];
                        int64_t copy_arg0_155009 = ((int64_t *) mem_164949)[j_155003];
                        int16_t copy_arg0_155015 = ((int16_t *) mem_164947)[copy_arg0_155010];
                        int64_t copy_arg0_155016 = ((int64_t *) mem_164949)[copy_arg0_155010];
                        
                        ((int16_t *) mem_164947)[j_155003] = copy_arg0_155015;
                        ((int64_t *) mem_164949)[j_155003] = copy_arg0_155016;
                        ((int16_t *) mem_164947)[copy_arg0_155010] = copy_arg0_155008;
                        ((int64_t *) mem_164949)[copy_arg0_155010] = copy_arg0_155009;
                        
                        int64_t tmp_155021 = sub64(j_155003, (int64_t) 1);
                        bool cond_155022 = sle64((int64_t) 0, tmp_155021);
                        bool loop_cond_155023;
                        
                        if (cond_155022) {
                            bool y_157008 = slt64(tmp_155021, block_sizze_154926);
                            bool bounds_check_157009 = cond_155022 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155021, "] out of bounds for array of shape [", (long long) block_sizze_154926, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_157007 = ((int16_t *) mem_164947)[j_155003];
                            int16_t gt_arg0_157011 = ((int16_t *) mem_164947)[tmp_155021];
                            bool defunc_0_leq_res_157012 = sle16(gt_arg0_157011, gt_arg1_157007);
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155023 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155023 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155023;
                        int64_t j_tmp_165710 = tmp_155021;
                        
                        loop_while_155000 = loop_while_tmp_165707;
                        j_155003 = j_tmp_165710;
                    }
                    s_154996 = loop_while_155000;
                    s_154999 = j_155003;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_164934, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154926, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154926});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint16_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        if (memblock_alloc(ctx, &mem_165006, bytes_164936, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154926, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154916, block_sizze_154926});
        
        int64_t data_155036;
        bool data_155037;
        int64_t data_155040;
        int64_t loop_dz2084Uz2082U_155041;
        bool loop_while_155042;
        int64_t stride_155045;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155041 = flat_dim_154927;
        loop_while_155042 = loop_cond_155033;
        stride_155045 = block_sizze_154926;
        while (loop_while_155042) {
            int64_t next_stride_155046 = mul64((int64_t) 2, stride_155045);
            bool zzero_155047 = next_stride_155046 == (int64_t) 0;
            bool nonzzero_155048 = !zzero_155047;
            bool nonzzero_cert_155049;
            
            if (!nonzzero_155048) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155050 = sdiv64(flat_dim_154927, next_stride_155046);
            bool bounds_invalid_upwards_155051 = slt64(num_merges_155050, (int64_t) 0);
            bool valid_155052 = !bounds_invalid_upwards_155051;
            bool range_valid_c_155053;
            
            if (!valid_155052) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155050, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:135:35-39\n   #6  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155055 = sub64(next_stride_155046, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155056 = sle64((int64_t) 0, m_155055);
            bool cond_155058 = slt64(next_stride_155046, (int64_t) 10);
            bool protect_assert_disj_155059 = nonzzero_155035 || cond_155058;
            bool nonzzero_cert_155060;
            
            if (!protect_assert_disj_155059) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155061 = smod_safe64(next_stride_155046, merge_block_sizze_154931);
            bool num_blocks_155062 = zeze_lhs_155061 == (int64_t) 0;
            bool protect_assert_disj_155063 = cond_155058 || num_blocks_155062;
            bool assert_c_155064;
            
            if (!protect_assert_disj_155063) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155066 = sdiv_safe64(next_stride_155046, merge_block_sizze_154931);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067 = add64((int64_t) 1, num_blocks_155066);
            int64_t j_m_i_155068 = sub64(next_stride_155046, stride_155045);
            int64_t flat_dim_155069 = merge_block_sizze_154931 * num_blocks_155066;
            bool bounds_invalid_upwards_155070 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, (int64_t) 0);
            bool empty_slice_155071 = j_m_i_155068 == (int64_t) 0;
            int64_t m_155072 = sub64(j_m_i_155068, (int64_t) 1);
            bool zzero_lte_i_155073 = sle64((int64_t) 0, stride_155045);
            bool i_lte_j_155074 = sle64(stride_155045, next_stride_155046);
            bool empty_slice_155075 = stride_155045 == (int64_t) 0;
            int64_t m_155076 = sub64(stride_155045, (int64_t) 1);
            bool bounds_invalid_upwards_155077 = slt64(num_blocks_155066, (int64_t) 0);
            bool cond_155078 = slt64((int64_t) 0, stride_155045);
            bool valid_155079 = !bounds_invalid_upwards_155070;
            int64_t i_p_m_t_s_155080 = add64(stride_155045, m_155072);
            bool zzero_leq_i_p_m_t_s_155081 = sle64((int64_t) 0, m_155076);
            bool i_p_m_t_s_leq_w_155082 = slt64(m_155076, next_stride_155046);
            bool valid_155083 = !bounds_invalid_upwards_155077;
            bool i_p_m_t_s_leq_w_155084 = slt64(m_155055, flat_dim_155069);
            bool y_155085 = slt64((int64_t) 0, j_m_i_155068);
            bool protect_assert_disj_155086 = cond_155058 || valid_155079;
            bool range_valid_c_155087;
            
            if (!protect_assert_disj_155086) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155088 = sle64((int64_t) 0, i_p_m_t_s_155080);
            bool i_p_m_t_s_leq_w_155089 = slt64(i_p_m_t_s_155080, next_stride_155046);
            bool y_155090 = zzero_leq_i_p_m_t_s_155081 && i_p_m_t_s_leq_w_155082;
            bool protect_assert_disj_155091 = cond_155058 || valid_155083;
            bool range_valid_c_155092;
            
            if (!protect_assert_disj_155091) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155093 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155084;
            bool y_155094 = zzero_lte_i_155073 && i_p_m_t_s_leq_w_155089;
            bool forwards_ok_155095 = zzero_lte_i_155073 && y_155090;
            bool ok_or_empty_155096 = zzero_155047 || y_155093;
            bool protect_assert_disj_155097 = cond_155078 || y_155085;
            bool y_155098 = zzero_leq_i_p_m_t_s_155088 && y_155094;
            bool ok_or_empty_155099 = empty_slice_155075 || forwards_ok_155095;
            bool protect_assert_disj_155100 = cond_155058 || ok_or_empty_155096;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) flat_dim_155069, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155102 = !cond_155058;
            bool protect_assert_disj_155103 = protect_assert_disj_155097 || loop_not_taken_155102;
            bool index_certs_155104;
            
            if (!protect_assert_disj_155103) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155105 = i_lte_j_155074 && y_155098;
            bool protect_assert_disj_155106 = cond_155058 || ok_or_empty_155099;
            bool index_certs_155107;
            
            if (!protect_assert_disj_155106) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155108 = ok_or_empty_155099 || loop_not_taken_155102;
            bool index_certs_155109;
            
            if (!protect_assert_disj_155108) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155045, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155110 = empty_slice_155071 || forwards_ok_155105;
            bool protect_assert_disj_155111 = cond_155058 || ok_or_empty_155110;
            bool index_certs_155112;
            
            if (!protect_assert_disj_155111) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155113 = loop_not_taken_155102 || ok_or_empty_155110;
            bool index_certs_155114;
            
            if (!protect_assert_disj_155113) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155045, ":] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 2 * num_merges_155050;
            int64_t bytes_165015 = next_stride_155046 * binop_x_165014;
            int64_t binop_x_165017 = (int64_t) 8 * num_merges_155050;
            int64_t bytes_165018 = next_stride_155046 * binop_x_165017;
            bool i_lte_j_155057 = sle64((int64_t) 0, next_stride_155046);
            
            if (mem_165016_cached_sizze_166205 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166205, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166206 < bytes_165018) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166206, bytes_165018);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067;
            int64_t binop_x_165044 = (int64_t) 2 * num_blocks_155066;
            int64_t bytes_165045 = merge_block_sizze_154931 * binop_x_165044;
            int64_t binop_x_165047 = (int64_t) 8 * num_blocks_155066;
            int64_t bytes_165048 = merge_block_sizze_154931 * binop_x_165047;
            int64_t bytes_165090 = (int64_t) 4 * stride_155045;
            int64_t bytes_165092 = (int64_t) 16 * stride_155045;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155050; i_164746++) {
                int64_t start_155118 = mul64(next_stride_155046, i_164746);
                int64_t j_m_i_155119 = sub64(loop_dz2084Uz2082U_155041, start_155118);
                bool empty_slice_155120 = j_m_i_155119 == (int64_t) 0;
                int64_t m_155121 = sub64(j_m_i_155119, (int64_t) 1);
                int64_t i_p_m_t_s_155122 = add64(start_155118, m_155121);
                bool zzero_leq_i_p_m_t_s_155123 = sle64((int64_t) 0, i_p_m_t_s_155122);
                bool i_p_m_t_s_leq_w_155124 = slt64(i_p_m_t_s_155122, loop_dz2084Uz2082U_155041);
                bool zzero_lte_i_155125 = sle64((int64_t) 0, start_155118);
                bool i_lte_j_155126 = sle64(start_155118, loop_dz2084Uz2082U_155041);
                bool y_155127 = i_p_m_t_s_leq_w_155124 && zzero_lte_i_155125;
                bool y_155128 = zzero_leq_i_p_m_t_s_155123 && y_155127;
                bool forwards_ok_155129 = i_lte_j_155126 && y_155128;
                bool ok_or_empty_155130 = empty_slice_155120 || forwards_ok_155129;
                bool index_certs_155131;
                
                if (!ok_or_empty_155130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155118, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155041, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155132 = slt64(m_155055, j_m_i_155119);
                bool y_155133 = zzero_leq_i_p_m_t_s_155056 && i_p_m_t_s_leq_w_155132;
                bool forwards_ok_155134 = i_lte_j_155057 && y_155133;
                bool ok_or_empty_155135 = zzero_155047 || forwards_ok_155134;
                bool index_certs_155136;
                
                if (!ok_or_empty_155135) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155046, "] out of bounds for array of shape [", (long long) j_m_i_155119, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:152:60-63\n   #7  ftRelational.fut:135:35-39\n   #8  ftRelational.fut:134:9-135:39\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155058) {
                    int16_t dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155078) {
                        int16_t head_res_157041 = ((int16_t *) mem_param_165010.mem)[start_155118];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155118];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155045 + start_155118;
                        int16_t head_res_157044 = ((int16_t *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155046; nest_i_165720++) {
                        ((int16_t *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165092, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155046; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155046; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155068;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155045);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155068);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155045 + j_157055;
                                int64_t slice_157065 = start_155118 + slice_157064;
                                int16_t leq_arg1_157066 = ((int16_t *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155118 + i_157052;
                                int16_t leq_arg0_157071 = ((int16_t *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = sle16(leq_arg0_157071, leq_arg1_157066);
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        int16_t loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155045);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155118 + i_157052;
                            int16_t tmp_157082 = ((int16_t *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155068);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:152:60-63\n   #8  ftRelational.fut:135:35-39\n   #9  ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155045 + j_157055;
                            int64_t slice_157089 = start_155118 + slice_157088;
                            int16_t tmp_157090 = ((int16_t *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((int16_t *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166207 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166207, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166208 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166208, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067; i_164732++) {
                        int64_t split_count_arg3_155198 = mul64(merge_block_sizze_154931, i_164732);
                        int64_t defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155199, &defunc_0_split_count_res_155200, &defunc_0_split_count_res_155201, &defunc_0_split_count_res_155202, &defunc_0_split_count_res_155203, (int64_t) 0, stride_155045, (int64_t) 0, j_m_i_155068, split_count_arg3_155198) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155204 = slt64((int64_t) 0, defunc_0_split_count_res_155203);
                        bool defunc_0_split_count_res_155205;
                        int64_t defunc_0_split_count_res_155206;
                        int64_t defunc_0_split_count_res_155207;
                        int64_t defunc_0_split_count_res_155208;
                        int64_t defunc_0_split_count_res_155209;
                        int64_t defunc_0_split_count_res_155210;
                        bool loop_while_155211;
                        int64_t ss_155212;
                        int64_t ss_155213;
                        int64_t tt_155214;
                        int64_t tt_155215;
                        int64_t count_155216;
                        
                        loop_while_155211 = loop_cond_155204;
                        ss_155212 = defunc_0_split_count_res_155199;
                        ss_155213 = defunc_0_split_count_res_155200;
                        tt_155214 = defunc_0_split_count_res_155201;
                        tt_155215 = defunc_0_split_count_res_155202;
                        count_155216 = defunc_0_split_count_res_155203;
                        while (loop_while_155211) {
                            int64_t zlze_lhs_155217 = sub64(ss_155213, ss_155212);
                            bool cond_155218 = sle64(zlze_lhs_155217, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155219;
                            int64_t defunc_0_lifted_step_res_155220;
                            int64_t defunc_0_lifted_step_res_155221;
                            int64_t defunc_0_lifted_step_res_155222;
                            
                            if (cond_155218) {
                                int64_t tmp_157094 = add64(tt_155214, count_155216);
                                
                                defunc_0_lifted_step_res_155219 = ss_155212;
                                defunc_0_lifted_step_res_155220 = tmp_157094;
                                defunc_0_lifted_step_res_155221 = tt_155215;
                                defunc_0_lifted_step_res_155222 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155224 = sub64(tt_155215, tt_155214);
                                bool cond_155225 = sle64(zlze_lhs_155224, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155226;
                                int64_t defunc_0_lifted_step_res_f_res_155227;
                                int64_t defunc_0_lifted_step_res_f_res_155228;
                                int64_t defunc_0_lifted_step_res_f_res_155229;
                                
                                if (cond_155225) {
                                    int64_t tmp_157095 = add64(ss_155212, count_155216);
                                    
                                    defunc_0_lifted_step_res_f_res_155226 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155227 = tt_155214;
                                    defunc_0_lifted_step_res_f_res_155228 = tt_155215;
                                    defunc_0_lifted_step_res_f_res_155229 = (int64_t) 0;
                                } else {
                                    bool cond_155231 = count_155216 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155232;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155233;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155234;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155235;
                                    
                                    if (cond_155231) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155212);
                                        bool y_157098 = slt64(ss_155212, stride_155045);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155212, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155214);
                                        bool y_157104 = slt64(tt_155214, j_m_i_155068);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155214, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155118 + ss_155212;
                                        int16_t leq_arg1_157102 = ((int16_t *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155045 + tt_155214;
                                        int64_t slice_157108 = start_155118 + slice_157107;
                                        int16_t leq_arg0_157109 = ((int16_t *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = sle16(leq_arg0_157109, leq_arg1_157102);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155214);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155212;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155212);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155214;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = tt_155215;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = (int64_t) 0;
                                    } else {
                                        int64_t m_155254 = sdiv64(count_155216, (int64_t) 2);
                                        int64_t n_155255 = sub64(count_155216, m_155254);
                                        bool cond_155256 = n_155255 == (int64_t) 0;
                                        int64_t zgze_lhs_155257 = add64(ss_155212, m_155254);
                                        bool cond_f_res_155258 = sle64(ss_155213, zgze_lhs_155257);
                                        bool x_155259 = !cond_155256;
                                        bool y_155260 = cond_f_res_155258 && x_155259;
                                        bool cond_155261 = cond_155256 || y_155260;
                                        bool leq_y_x_155262;
                                        
                                        if (cond_155261) {
                                            leq_y_x_155262 = 1;
                                        } else {
                                            bool x_155263 = sle64((int64_t) 0, zgze_lhs_155257);
                                            bool y_155264 = slt64(zgze_lhs_155257, stride_155045);
                                            bool bounds_check_155265 = x_155263 && y_155264;
                                            bool index_certs_155266;
                                            
                                            if (!bounds_check_155265) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155257, "] out of bounds for array of shape [", (long long) stride_155045, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155269 = add64(tt_155214, n_155255);
                                            int64_t leq_arg0_155270 = sub64(zm_lhs_155269, (int64_t) 1);
                                            bool x_155271 = sle64((int64_t) 0, leq_arg0_155270);
                                            bool y_155272 = slt64(leq_arg0_155270, j_m_i_155068);
                                            bool bounds_check_155273 = x_155271 && y_155272;
                                            bool index_certs_155274;
                                            
                                            if (!bounds_check_155273) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155270, "] out of bounds for array of shape [", (long long) j_m_i_155068, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:152:60-63\n   #12 ftRelational.fut:135:35-39\n   #13 ftRelational.fut:134:9-135:39\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155267 = start_155118 + zgze_lhs_155257;
                                            int16_t leq_arg1_155268 = ((int16_t *) mem_param_165010.mem)[slice_155267];
                                            int64_t slice_155275 = stride_155045 + leq_arg0_155270;
                                            int64_t slice_155276 = start_155118 + slice_155275;
                                            int16_t leq_arg0_155277 = ((int16_t *) mem_param_165010.mem)[slice_155276];
                                            bool defunc_0_leq_res_155278 = sle16(leq_arg0_155277, leq_arg1_155268);
                                            
                                            leq_y_x_155262 = defunc_0_leq_res_155278;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                        
                                        if (leq_y_x_155262) {
                                            int64_t tmp_157115 = add64(tt_155214, n_155255);
                                            int64_t tmp_157116 = sub64(count_155216, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tt_155215;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = tmp_157116;
                                        } else {
                                            int64_t tmp_155284 = add64(tt_155214, n_155255);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155279 = tt_155214;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155280 = tmp_155284;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155281 = count_155216;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155232 = ss_155212;
                                        defunc_0_lifted_step_res_f_res_f_res_155233 = defunc_0_lifted_step_res_f_res_f_res_f_res_155279;
                                        defunc_0_lifted_step_res_f_res_f_res_155234 = defunc_0_lifted_step_res_f_res_f_res_f_res_155280;
                                        defunc_0_lifted_step_res_f_res_f_res_155235 = defunc_0_lifted_step_res_f_res_f_res_f_res_155281;
                                    }
                                    defunc_0_lifted_step_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_155232;
                                    defunc_0_lifted_step_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_155233;
                                    defunc_0_lifted_step_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_155234;
                                    defunc_0_lifted_step_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_155235;
                                }
                                defunc_0_lifted_step_res_155219 = defunc_0_lifted_step_res_f_res_155226;
                                defunc_0_lifted_step_res_155220 = defunc_0_lifted_step_res_f_res_155227;
                                defunc_0_lifted_step_res_155221 = defunc_0_lifted_step_res_f_res_155228;
                                defunc_0_lifted_step_res_155222 = defunc_0_lifted_step_res_f_res_155229;
                            }
                            
                            int64_t loopres_155285;
                            int64_t loopres_155286;
                            int64_t loopres_155287;
                            int64_t loopres_155288;
                            int64_t loopres_155289;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155285, &loopres_155286, &loopres_155287, &loopres_155288, &loopres_155289, defunc_0_lifted_step_res_155219, ss_155213, defunc_0_lifted_step_res_155220, defunc_0_lifted_step_res_155221, defunc_0_lifted_step_res_155222) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155290 = slt64((int64_t) 0, loopres_155289);
                            bool loop_while_tmp_165727 = loop_cond_155290;
                            int64_t ss_tmp_165728 = loopres_155285;
                            int64_t ss_tmp_165729 = loopres_155286;
                            int64_t tt_tmp_165730 = loopres_155287;
                            int64_t tt_tmp_165731 = loopres_155288;
                            int64_t count_tmp_165732 = loopres_155289;
                            
                            loop_while_155211 = loop_while_tmp_165727;
                            ss_155212 = ss_tmp_165728;
                            ss_155213 = ss_tmp_165729;
                            tt_155214 = tt_tmp_165730;
                            tt_155215 = tt_tmp_165731;
                            count_155216 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155205 = loop_while_155211;
                        defunc_0_split_count_res_155206 = ss_155212;
                        defunc_0_split_count_res_155207 = ss_155213;
                        defunc_0_split_count_res_155208 = tt_155214;
                        defunc_0_split_count_res_155209 = tt_155215;
                        defunc_0_split_count_res_155210 = count_155216;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155206;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155208;
                    }
                    if (mem_165046_cached_sizze_166209 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166209, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166210 < bytes_165048) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166210, bytes_165048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155066; i_164739++) {
                        bool y_155296 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool index_certs_155298;
                        
                        if (!y_155296) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155299 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155301 = add64((int64_t) 1, i_164739);
                        bool x_155302 = sle64((int64_t) 0, tmp_155301);
                        bool y_155303 = slt64(tmp_155301, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067);
                        bool bounds_check_155304 = x_155302 && y_155303;
                        bool index_certs_155305;
                        
                        if (!bounds_check_155304) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155301, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155067, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155306 = ((int64_t *) mem_165029)[tmp_155301];
                        int64_t defunc_0_f_res_155307 = ((int64_t *) mem_165031)[tmp_155301];
                        int64_t merge_sequential_arg2_155308 = add64(stride_155045, defunc_0_f_res_155300);
                        int64_t merge_sequential_arg2_155309 = add64(stride_155045, defunc_0_f_res_155307);
                        int64_t j_m_i_155310 = sub64(merge_sequential_arg2_155309, merge_sequential_arg2_155308);
                        bool empty_slice_155311 = j_m_i_155310 == (int64_t) 0;
                        int64_t m_155312 = sub64(j_m_i_155310, (int64_t) 1);
                        int64_t i_p_m_t_s_155313 = add64(merge_sequential_arg2_155308, m_155312);
                        bool zzero_leq_i_p_m_t_s_155314 = sle64((int64_t) 0, i_p_m_t_s_155313);
                        bool i_p_m_t_s_leq_w_155315 = slt64(i_p_m_t_s_155313, next_stride_155046);
                        bool zzero_lte_i_155316 = sle64((int64_t) 0, merge_sequential_arg2_155308);
                        bool i_lte_j_155317 = sle64(merge_sequential_arg2_155308, merge_sequential_arg2_155309);
                        bool y_155318 = i_p_m_t_s_leq_w_155315 && zzero_lte_i_155316;
                        bool y_155319 = zzero_leq_i_p_m_t_s_155314 && y_155318;
                        bool forwards_ok_155320 = i_lte_j_155317 && y_155319;
                        bool ok_or_empty_155321 = empty_slice_155311 || forwards_ok_155320;
                        bool index_certs_155322;
                        
                        if (!ok_or_empty_155321) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155308, ":", (long long) merge_sequential_arg2_155309, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155323 = sub64(defunc_0_f_res_155306, defunc_0_f_res_155299);
                        bool empty_slice_155324 = j_m_i_155323 == (int64_t) 0;
                        int64_t m_155325 = sub64(j_m_i_155323, (int64_t) 1);
                        int64_t i_p_m_t_s_155326 = add64(defunc_0_f_res_155299, m_155325);
                        bool zzero_leq_i_p_m_t_s_155327 = sle64((int64_t) 0, i_p_m_t_s_155326);
                        bool i_p_m_t_s_leq_w_155328 = slt64(i_p_m_t_s_155326, next_stride_155046);
                        bool zzero_lte_i_155329 = sle64((int64_t) 0, defunc_0_f_res_155299);
                        bool i_lte_j_155330 = sle64(defunc_0_f_res_155299, defunc_0_f_res_155306);
                        bool y_155331 = i_p_m_t_s_leq_w_155328 && zzero_lte_i_155329;
                        bool y_155332 = zzero_leq_i_p_m_t_s_155327 && y_155331;
                        bool forwards_ok_155333 = i_lte_j_155330 && y_155332;
                        bool ok_or_empty_155334 = empty_slice_155324 || forwards_ok_155333;
                        bool index_certs_155335;
                        
                        if (!ok_or_empty_155334) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155299, ":", (long long) defunc_0_f_res_155306, "] out of bounds for array of shape [", (long long) next_stride_155046, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:152:60-63\n   #9  ftRelational.fut:135:35-39\n   #10 ftRelational.fut:134:9-135:39\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155336 = slt64((int64_t) 0, j_m_i_155323);
                        int16_t dummy_155337;
                        int64_t dummy_155338;
                        
                        if (cond_155336) {
                            bool index_certs_157117;
                            
                            if (!cond_155336) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:135:35-39\n   #12 ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155118 + defunc_0_f_res_155299;
                            int16_t head_res_157119 = ((int16_t *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155337 = head_res_157119;
                            dummy_155338 = head_res_157120;
                        } else {
                            bool y_155343 = slt64((int64_t) 0, j_m_i_155310);
                            bool index_certs_155344;
                            
                            if (!y_155343) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:152:60-63\n   #11 ftRelational.fut:135:35-39\n   #12 ftRelational.fut:134:9-135:39\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155345 = start_155118 + merge_sequential_arg2_155308;
                            int16_t head_res_155346 = ((int16_t *) mem_param_165010.mem)[slice_155345];
                            int64_t head_res_155347 = ((int64_t *) mem_param_165013.mem)[slice_155345];
                            
                            dummy_155337 = head_res_155346;
                            dummy_155338 = head_res_155347;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154931; nest_i_165735++) {
                            ((int16_t *) mem_165046)[i_164739 * merge_block_sizze_154931 + nest_i_165735] = dummy_155337;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154931; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + nest_i_165736] = dummy_155338;
                        }
                        
                        int64_t data_155350;
                        int64_t i_155354 = (int64_t) 0;
                        
                        for (int64_t k_155353 = 0; k_155353 < merge_block_sizze_154931; k_155353++) {
                            int64_t j_155357 = sub64(k_155353, i_155354);
                            bool cond_155358 = j_155357 == j_m_i_155310;
                            bool cond_155359;
                            
                            if (cond_155358) {
                                cond_155359 = 1;
                            } else {
                                bool cond_155360 = slt64(i_155354, j_m_i_155323);
                                bool cond_f_res_155361;
                                
                                if (cond_155360) {
                                    bool x_157121 = sle64((int64_t) 0, j_155357);
                                    bool y_157122 = slt64(j_155357, j_m_i_155310);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155354);
                                    bool bounds_check_157129 = cond_155360 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155308 + j_155357;
                                    int64_t slice_157126 = start_155118 + slice_157125;
                                    int16_t leq_arg1_157127 = ((int16_t *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155299 + i_155354;
                                    int64_t slice_157132 = start_155118 + slice_157131;
                                    int16_t leq_arg0_157133 = ((int16_t *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = sle16(leq_arg0_157133, leq_arg1_157127);
                                    
                                    cond_f_res_155361 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155361 = 0;
                                }
                                cond_155359 = cond_f_res_155361;
                            }
                            
                            int64_t loopres_155376;
                            int16_t loopres_155377;
                            int64_t loopres_155378;
                            
                            if (cond_155359) {
                                bool x_157136 = sle64((int64_t) 0, i_155354);
                                bool y_157137 = slt64(i_155354, j_m_i_155323);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155354, "] out of bounds for array of shape [", (long long) j_m_i_155323, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155354);
                                int64_t slice_157140 = defunc_0_f_res_155299 + i_155354;
                                int64_t slice_157141 = start_155118 + slice_157140;
                                int16_t tmp_157142 = ((int16_t *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155376 = tmp_157135;
                                loopres_155377 = tmp_157142;
                                loopres_155378 = tmp_157143;
                            } else {
                                bool x_155388 = sle64((int64_t) 0, j_155357);
                                bool y_155389 = slt64(j_155357, j_m_i_155310);
                                bool bounds_check_155390 = x_155388 && y_155389;
                                bool index_certs_155391;
                                
                                if (!bounds_check_155390) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155357, "] out of bounds for array of shape [", (long long) j_m_i_155310, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:152:60-63\n   #10 ftRelational.fut:135:35-39\n   #11 ftRelational.fut:134:9-135:39\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155392 = merge_sequential_arg2_155308 + j_155357;
                                int64_t slice_155393 = start_155118 + slice_155392;
                                int16_t tmp_155394 = ((int16_t *) mem_param_165010.mem)[slice_155393];
                                int64_t tmp_155395 = ((int64_t *) mem_param_165013.mem)[slice_155393];
                                
                                loopres_155376 = i_155354;
                                loopres_155377 = tmp_155394;
                                loopres_155378 = tmp_155395;
                            }
                            ((int16_t *) mem_165046)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155377;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154931 + k_155353] = loopres_155378;
                            
                            int64_t i_tmp_165737 = loopres_155376;
                            
                            i_155354 = i_tmp_165737;
                        }
                        data_155350 = i_155354;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint16_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165048, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154931, (int64_t) 1}, (int64_t []) {num_blocks_155066, merge_block_sizze_154931});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_165016, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155046, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155046});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155402 = next_stride_155046 * num_merges_155050;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint16_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            if (memblock_alloc(ctx, &mem_165126, bytes_165018, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155046, (int64_t) 1}, (int64_t []) {num_merges_155050, next_stride_155046});
            
            bool loop_cond_155405 = slt64(next_stride_155046, flat_dim_154927);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155402;
            bool loop_while_tmp_165714 = loop_cond_155405;
            int64_t stride_tmp_165717 = next_stride_155046;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155041 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155042 = loop_while_tmp_165714;
            stride_155045 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155036 = loop_dz2084Uz2082U_155041;
        data_155037 = loop_while_155042;
        data_155040 = stride_155045;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155406 = n_102511 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155407 = sle64((int64_t) 0, zs_lhs_154911);
        bool i_p_m_t_s_leq_w_155408 = slt64(zs_lhs_154911, data_155036);
        bool y_155409 = zzero_leq_i_p_m_t_s_155407 && i_p_m_t_s_leq_w_155408;
        bool ok_or_empty_155410 = empty_slice_155406 || y_155409;
        bool index_certs_155411;
        
        if (!ok_or_empty_155410) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_102511, "] out of bounds for array of shape [", (long long) data_155036, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:152:60-63\n   #5  ftRelational.fut:135:35-39\n   #6  ftRelational.fut:134:9-135:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_102511; i_164753++) {
        int64_t eta_p_155419 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155420 = sle64((int64_t) 0, eta_p_155419);
        bool y_155421 = slt64(eta_p_155419, n_102511);
        bool bounds_check_155422 = x_155420 && y_155421;
        bool index_certs_155423;
        
        if (!bounds_check_155422) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155419, "] out of bounds for array of shape [", (long long) n_102511, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:152:60-63\n   #4  ftRelational.fut:135:35-39\n   #5  ftRelational.fut:134:9-135:39\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_155424 = ((int64_t *) ext_mem_164929.mem)[eta_p_155419];
        int16_t lifted_lambda_res_155425 = ((int16_t *) xs_mem_164928.mem)[eta_p_155419];
        
        ((int64_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155424;
        ((int16_t *) mem_165140.mem)[i_164753] = lifted_lambda_res_155425;
    }
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166199, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166200, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_166211, struct memblock *mem_out_p_166212, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_95983, int64_t b_95984)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166213 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166214 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166215 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166216 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166217 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166218 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166219 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166220 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166221 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166222 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_95983;
    bool cond_154904 = sle64(n_95983, (int64_t) 1);
    int64_t zs_lhs_154905 = sub64(n_95983, (int64_t) 1);
    int64_t zp_rhs_154906 = sdiv_safe64(zs_lhs_154905, (int64_t) 20);
    int64_t min_num_blocks_154907 = add64((int64_t) 1, zp_rhs_154906);
    bool loop_cond_154908 = slt64((int64_t) 1, min_num_blocks_154907);
    bool smallest_pow_2_geq_than_res_154909;
    int64_t smallest_pow_2_geq_than_res_154910;
    bool loop_while_154911;
    int64_t x_154912;
    
    loop_while_154911 = loop_cond_154908;
    x_154912 = (int64_t) 1;
    while (loop_while_154911) {
        int64_t loopres_154913 = mul64((int64_t) 2, x_154912);
        bool loop_cond_154914 = slt64(loopres_154913, min_num_blocks_154907);
        bool loop_while_tmp_165695 = loop_cond_154914;
        int64_t x_tmp_165696 = loopres_154913;
        
        loop_while_154911 = loop_while_tmp_165695;
        x_154912 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154909 = loop_while_154911;
    smallest_pow_2_geq_than_res_154910 = x_154912;
    
    bool zzero_154915 = smallest_pow_2_geq_than_res_154910 == (int64_t) 0;
    bool nonzzero_154916 = !zzero_154915;
    bool protect_assert_disj_154917 = cond_154904 || nonzzero_154916;
    bool nonzzero_cert_154918;
    
    if (!protect_assert_disj_154917) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154919 = sdiv_safe64(zs_lhs_154905, smallest_pow_2_geq_than_res_154910);
    int64_t block_sizze_154920 = add64((int64_t) 1, zp_rhs_154919);
    bool y_154926 = slt64((int64_t) 0, n_95983);
    bool protect_assert_disj_165536 = cond_154904 || y_154926;
    bool index_certs_154927;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_95983, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154941 = slt64(smallest_pow_2_geq_than_res_154910, (int64_t) 0);
    bool valid_154942 = !bounds_invalid_upwards_154941;
    bool protect_assert_disj_165544 = cond_154904 || valid_154942;
    bool range_valid_c_154943;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154910, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:117:36-40\n   #6  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154945 = slt64(block_sizze_154920, (int64_t) 0);
    bool valid_154946 = !bounds_invalid_upwards_154945;
    bool protect_assert_disj_165546 = cond_154904 || valid_154946;
    bool range_valid_c_154947;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154920, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154949 = sle64(block_sizze_154920, (int64_t) 1);
    int64_t tmp_154950 = sub64(block_sizze_154920, (int64_t) 2);
    bool bounds_invalid_upwards_154951 = slt64(tmp_154950, (int64_t) 0);
    bool valid_154953 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_154954 = cond_154949 || valid_154953;
    bool protect_assert_disj_165548 = cond_154904 || protect_assert_disj_154954;
    bool range_valid_c_154955;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154950, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165139 = n_95983 * b_95984;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_95983; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154921 = smallest_pow_2_geq_than_res_154910 * block_sizze_154920;
    bool x_165531 = !cond_154904;
    int64_t greatest_divisor_leq_than_arg1_154924 = mul64((int64_t) 2, block_sizze_154920);
    int64_t merge_block_sizze_154925;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154924) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154925 = x_165533;
    } else {
        merge_block_sizze_154925 = (int64_t) 0;
    }
    
    double reduce_arg1_154928;
    
    if (x_165531) {
        double x_165537 = ((double *) k_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154928 = x_165537;
    } else {
        reduce_arg1_154928 = 0.0;
    }
    
    double defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        double x_165539;
        int64_t x_165540;
        double redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154928;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_95983; i_164713++) {
            double x_154932 = ((double *) k_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154938 = redout_164711 <= x_154932;
            double defunc_0_op_res_154939;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154939 = x_154932;
            } else {
                defunc_0_op_res_154939 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154940;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154940 = i_164713;
            } else {
                defunc_0_op_res_154940 = redout_164712;
            }
            
            double redout_tmp_165699 = defunc_0_op_res_154939;
            int64_t redout_tmp_165700 = defunc_0_op_res_154940;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = 0.0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154952 = add64((int64_t) 1, tmp_154950);
    int64_t binop_x_164932 = (int64_t) 8 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164933 = block_sizze_154920 * binop_x_164932;
    int64_t bytes_164946 = (int64_t) 8 * block_sizze_154920;
    bool loop_cond_155027 = slt64(block_sizze_154920, flat_dim_154921);
    bool zzero_155028 = merge_block_sizze_154925 == (int64_t) 0;
    bool nonzzero_155029 = !zzero_155028;
    
    if (cond_154904) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166213 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166213, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166214 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166214, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166215 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166215, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166216 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166216, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154910; i_164725++) {
            int64_t zp_lhs_154959 = mul64(block_sizze_154920, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154920; i_164718++) {
                int64_t k_154963 = add64(zp_lhs_154959, i_164718);
                bool cond_154964 = slt64(k_154963, n_95983);
                double lifted_lambda_res_154965;
                int64_t lifted_lambda_res_154966;
                
                if (cond_154964) {
                    bool x_157003 = sle64((int64_t) 0, k_154963);
                    bool bounds_check_157004 = cond_154964 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154963, "] out of bounds for array of shape [", (long long) n_95983, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_157006 = ((double *) k_mem_164928.mem)[k_154963];
                    
                    lifted_lambda_res_154965 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154966 = k_154963;
                } else {
                    lifted_lambda_res_154965 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154966 = defunc_0_reduce_res_157151;
                }
                ((double *) mem_164947)[i_164718] = lifted_lambda_res_154965;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154966;
            }
            if (!cond_154949) {
                for (int64_t i_154976 = 0; i_154976 < distance_154952; i_154976++) {
                    int64_t gt_arg1_154979 = add64((int64_t) 1, i_154976);
                    bool x_154980 = sle64((int64_t) 0, gt_arg1_154979);
                    bool y_154981 = slt64(gt_arg1_154979, block_sizze_154920);
                    bool bounds_check_154982 = x_154980 && y_154981;
                    bool index_certs_154983;
                    
                    if (!bounds_check_154982) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154979, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154985 = slt64(i_154976, block_sizze_154920);
                    bool index_certs_154986;
                    
                    if (!y_154985) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154976, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_154984 = ((double *) mem_164947)[gt_arg1_154979];
                    double gt_arg0_154987 = ((double *) mem_164947)[i_154976];
                    bool defunc_0_leq_res_154988 = gt_arg0_154987 <= gt_arg1_154984;
                    bool defunc_0_lifted_gt_res_154989 = !defunc_0_leq_res_154988;
                    bool s_154990;
                    int64_t s_154993;
                    bool loop_while_154994;
                    int64_t j_154997;
                    
                    loop_while_154994 = defunc_0_lifted_gt_res_154989;
                    j_154997 = i_154976;
                    while (loop_while_154994) {
                        bool x_154998 = sle64((int64_t) 0, j_154997);
                        bool y_154999 = slt64(j_154997, block_sizze_154920);
                        bool bounds_check_155000 = x_154998 && y_154999;
                        bool index_certs_155001;
                        
                        if (!bounds_check_155000) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_154997, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155004 = add64((int64_t) 1, j_154997);
                        bool x_155005 = sle64((int64_t) 0, copy_arg0_155004);
                        bool y_155006 = slt64(copy_arg0_155004, block_sizze_154920);
                        bool bounds_check_155007 = x_155005 && y_155006;
                        bool index_certs_155008;
                        
                        if (!bounds_check_155007) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155004, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_155002 = ((double *) mem_164947)[j_154997];
                        int64_t copy_arg0_155003 = ((int64_t *) mem_164949)[j_154997];
                        double copy_arg0_155009 = ((double *) mem_164947)[copy_arg0_155004];
                        int64_t copy_arg0_155010 = ((int64_t *) mem_164949)[copy_arg0_155004];
                        
                        ((double *) mem_164947)[j_154997] = copy_arg0_155009;
                        ((int64_t *) mem_164949)[j_154997] = copy_arg0_155010;
                        ((double *) mem_164947)[copy_arg0_155004] = copy_arg0_155002;
                        ((int64_t *) mem_164949)[copy_arg0_155004] = copy_arg0_155003;
                        
                        int64_t tmp_155015 = sub64(j_154997, (int64_t) 1);
                        bool cond_155016 = sle64((int64_t) 0, tmp_155015);
                        bool loop_cond_155017;
                        
                        if (cond_155016) {
                            bool y_157008 = slt64(tmp_155015, block_sizze_154920);
                            bool bounds_check_157009 = cond_155016 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155015, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_157007 = ((double *) mem_164947)[j_154997];
                            double gt_arg0_157011 = ((double *) mem_164947)[tmp_155015];
                            bool defunc_0_leq_res_157012 = gt_arg0_157011 <= gt_arg1_157007;
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155017 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155017 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155017;
                        int64_t j_tmp_165710 = tmp_155015;
                        
                        loop_while_154994 = loop_while_tmp_165707;
                        j_154997 = j_tmp_165710;
                    }
                    s_154990 = loop_while_154994;
                    s_154993 = j_154997;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164934, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        if (memblock_alloc(ctx, &mem_165006, bytes_164933, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        
        int64_t data_155030;
        bool data_155031;
        int64_t data_155034;
        int64_t loop_dz2084Uz2082U_155035;
        bool loop_while_155036;
        int64_t stride_155039;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155035 = flat_dim_154921;
        loop_while_155036 = loop_cond_155027;
        stride_155039 = block_sizze_154920;
        while (loop_while_155036) {
            int64_t next_stride_155040 = mul64((int64_t) 2, stride_155039);
            bool zzero_155041 = next_stride_155040 == (int64_t) 0;
            bool nonzzero_155042 = !zzero_155041;
            bool nonzzero_cert_155043;
            
            if (!nonzzero_155042) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155044 = sdiv64(flat_dim_154921, next_stride_155040);
            bool bounds_invalid_upwards_155045 = slt64(num_merges_155044, (int64_t) 0);
            bool valid_155046 = !bounds_invalid_upwards_155045;
            bool range_valid_c_155047;
            
            if (!valid_155046) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155044, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:117:36-40\n   #6  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155049 = sub64(next_stride_155040, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155050 = sle64((int64_t) 0, m_155049);
            bool cond_155052 = slt64(next_stride_155040, (int64_t) 10);
            bool protect_assert_disj_155053 = nonzzero_155029 || cond_155052;
            bool nonzzero_cert_155054;
            
            if (!protect_assert_disj_155053) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155055 = smod_safe64(next_stride_155040, merge_block_sizze_154925);
            bool num_blocks_155056 = zeze_lhs_155055 == (int64_t) 0;
            bool protect_assert_disj_155057 = cond_155052 || num_blocks_155056;
            bool assert_c_155058;
            
            if (!protect_assert_disj_155057) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155060 = sdiv_safe64(next_stride_155040, merge_block_sizze_154925);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061 = add64((int64_t) 1, num_blocks_155060);
            int64_t j_m_i_155062 = sub64(next_stride_155040, stride_155039);
            int64_t flat_dim_155063 = merge_block_sizze_154925 * num_blocks_155060;
            bool bounds_invalid_upwards_155064 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, (int64_t) 0);
            bool empty_slice_155065 = j_m_i_155062 == (int64_t) 0;
            int64_t m_155066 = sub64(j_m_i_155062, (int64_t) 1);
            bool zzero_lte_i_155067 = sle64((int64_t) 0, stride_155039);
            bool i_lte_j_155068 = sle64(stride_155039, next_stride_155040);
            bool empty_slice_155069 = stride_155039 == (int64_t) 0;
            int64_t m_155070 = sub64(stride_155039, (int64_t) 1);
            bool bounds_invalid_upwards_155071 = slt64(num_blocks_155060, (int64_t) 0);
            bool cond_155072 = slt64((int64_t) 0, stride_155039);
            bool valid_155073 = !bounds_invalid_upwards_155064;
            int64_t i_p_m_t_s_155074 = add64(stride_155039, m_155066);
            bool zzero_leq_i_p_m_t_s_155075 = sle64((int64_t) 0, m_155070);
            bool i_p_m_t_s_leq_w_155076 = slt64(m_155070, next_stride_155040);
            bool valid_155077 = !bounds_invalid_upwards_155071;
            bool i_p_m_t_s_leq_w_155078 = slt64(m_155049, flat_dim_155063);
            bool y_155079 = slt64((int64_t) 0, j_m_i_155062);
            bool protect_assert_disj_155080 = cond_155052 || valid_155073;
            bool range_valid_c_155081;
            
            if (!protect_assert_disj_155080) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155082 = sle64((int64_t) 0, i_p_m_t_s_155074);
            bool i_p_m_t_s_leq_w_155083 = slt64(i_p_m_t_s_155074, next_stride_155040);
            bool y_155084 = zzero_leq_i_p_m_t_s_155075 && i_p_m_t_s_leq_w_155076;
            bool protect_assert_disj_155085 = cond_155052 || valid_155077;
            bool range_valid_c_155086;
            
            if (!protect_assert_disj_155085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155060, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155087 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155078;
            bool y_155088 = zzero_lte_i_155067 && i_p_m_t_s_leq_w_155083;
            bool forwards_ok_155089 = zzero_lte_i_155067 && y_155084;
            bool ok_or_empty_155090 = zzero_155041 || y_155087;
            bool protect_assert_disj_155091 = cond_155072 || y_155079;
            bool y_155092 = zzero_leq_i_p_m_t_s_155082 && y_155088;
            bool ok_or_empty_155093 = empty_slice_155069 || forwards_ok_155089;
            bool protect_assert_disj_155094 = cond_155052 || ok_or_empty_155090;
            bool index_certs_155095;
            
            if (!protect_assert_disj_155094) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) flat_dim_155063, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155096 = !cond_155052;
            bool protect_assert_disj_155097 = protect_assert_disj_155091 || loop_not_taken_155096;
            bool index_certs_155098;
            
            if (!protect_assert_disj_155097) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155099 = i_lte_j_155068 && y_155092;
            bool protect_assert_disj_155100 = cond_155052 || ok_or_empty_155093;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155102 = ok_or_empty_155093 || loop_not_taken_155096;
            bool index_certs_155103;
            
            if (!protect_assert_disj_155102) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155104 = empty_slice_155065 || forwards_ok_155099;
            bool protect_assert_disj_155105 = cond_155052 || ok_or_empty_155104;
            bool index_certs_155106;
            
            if (!protect_assert_disj_155105) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155107 = loop_not_taken_155096 || ok_or_empty_155104;
            bool index_certs_155108;
            
            if (!protect_assert_disj_155107) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 8 * num_merges_155044;
            int64_t bytes_165015 = next_stride_155040 * binop_x_165014;
            bool i_lte_j_155051 = sle64((int64_t) 0, next_stride_155040);
            
            if (mem_165016_cached_sizze_166217 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166217, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166218 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166218, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061;
            int64_t binop_x_165044 = (int64_t) 8 * num_blocks_155060;
            int64_t bytes_165045 = merge_block_sizze_154925 * binop_x_165044;
            int64_t bytes_165090 = (int64_t) 16 * stride_155039;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155044; i_164746++) {
                int64_t start_155112 = mul64(next_stride_155040, i_164746);
                int64_t j_m_i_155113 = sub64(loop_dz2084Uz2082U_155035, start_155112);
                bool empty_slice_155114 = j_m_i_155113 == (int64_t) 0;
                int64_t m_155115 = sub64(j_m_i_155113, (int64_t) 1);
                int64_t i_p_m_t_s_155116 = add64(start_155112, m_155115);
                bool zzero_leq_i_p_m_t_s_155117 = sle64((int64_t) 0, i_p_m_t_s_155116);
                bool i_p_m_t_s_leq_w_155118 = slt64(i_p_m_t_s_155116, loop_dz2084Uz2082U_155035);
                bool zzero_lte_i_155119 = sle64((int64_t) 0, start_155112);
                bool i_lte_j_155120 = sle64(start_155112, loop_dz2084Uz2082U_155035);
                bool y_155121 = i_p_m_t_s_leq_w_155118 && zzero_lte_i_155119;
                bool y_155122 = zzero_leq_i_p_m_t_s_155117 && y_155121;
                bool forwards_ok_155123 = i_lte_j_155120 && y_155122;
                bool ok_or_empty_155124 = empty_slice_155114 || forwards_ok_155123;
                bool index_certs_155125;
                
                if (!ok_or_empty_155124) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155112, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155035, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155126 = slt64(m_155049, j_m_i_155113);
                bool y_155127 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155126;
                bool forwards_ok_155128 = i_lte_j_155051 && y_155127;
                bool ok_or_empty_155129 = zzero_155041 || forwards_ok_155128;
                bool index_certs_155130;
                
                if (!ok_or_empty_155129) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) j_m_i_155113, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:117:36-40\n   #8  ftRelational.fut:114:9-117:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155052) {
                    double dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155072) {
                        double head_res_157041 = ((double *) mem_param_165010.mem)[start_155112];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155112];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155039 + start_155112;
                        double head_res_157044 = ((double *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155040; nest_i_165720++) {
                        ((double *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165090, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155040; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155040; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155062;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155039);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155062);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155039 + j_157055;
                                int64_t slice_157065 = start_155112 + slice_157064;
                                double leq_arg1_157066 = ((double *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155112 + i_157052;
                                double leq_arg0_157071 = ((double *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = leq_arg0_157071 <= leq_arg1_157066;
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        double loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155039);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155112 + i_157052;
                            double tmp_157082 = ((double *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155062);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:117:36-40\n   #9  ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155039 + j_157055;
                            int64_t slice_157089 = start_155112 + slice_157088;
                            double tmp_157090 = ((double *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((double *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166219 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166219, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166220 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166220, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061; i_164732++) {
                        int64_t split_count_arg3_155192 = mul64(merge_block_sizze_154925, i_164732);
                        int64_t defunc_0_split_count_res_155193;
                        int64_t defunc_0_split_count_res_155194;
                        int64_t defunc_0_split_count_res_155195;
                        int64_t defunc_0_split_count_res_155196;
                        int64_t defunc_0_split_count_res_155197;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155193, &defunc_0_split_count_res_155194, &defunc_0_split_count_res_155195, &defunc_0_split_count_res_155196, &defunc_0_split_count_res_155197, (int64_t) 0, stride_155039, (int64_t) 0, j_m_i_155062, split_count_arg3_155192) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155198 = slt64((int64_t) 0, defunc_0_split_count_res_155197);
                        bool defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        int64_t defunc_0_split_count_res_155204;
                        bool loop_while_155205;
                        int64_t ss_155206;
                        int64_t ss_155207;
                        int64_t tt_155208;
                        int64_t tt_155209;
                        int64_t count_155210;
                        
                        loop_while_155205 = loop_cond_155198;
                        ss_155206 = defunc_0_split_count_res_155193;
                        ss_155207 = defunc_0_split_count_res_155194;
                        tt_155208 = defunc_0_split_count_res_155195;
                        tt_155209 = defunc_0_split_count_res_155196;
                        count_155210 = defunc_0_split_count_res_155197;
                        while (loop_while_155205) {
                            int64_t zlze_lhs_155211 = sub64(ss_155207, ss_155206);
                            bool cond_155212 = sle64(zlze_lhs_155211, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155213;
                            int64_t defunc_0_lifted_step_res_155214;
                            int64_t defunc_0_lifted_step_res_155215;
                            int64_t defunc_0_lifted_step_res_155216;
                            
                            if (cond_155212) {
                                int64_t tmp_157094 = add64(tt_155208, count_155210);
                                
                                defunc_0_lifted_step_res_155213 = ss_155206;
                                defunc_0_lifted_step_res_155214 = tmp_157094;
                                defunc_0_lifted_step_res_155215 = tt_155209;
                                defunc_0_lifted_step_res_155216 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155218 = sub64(tt_155209, tt_155208);
                                bool cond_155219 = sle64(zlze_lhs_155218, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155220;
                                int64_t defunc_0_lifted_step_res_f_res_155221;
                                int64_t defunc_0_lifted_step_res_f_res_155222;
                                int64_t defunc_0_lifted_step_res_f_res_155223;
                                
                                if (cond_155219) {
                                    int64_t tmp_157095 = add64(ss_155206, count_155210);
                                    
                                    defunc_0_lifted_step_res_f_res_155220 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155221 = tt_155208;
                                    defunc_0_lifted_step_res_f_res_155222 = tt_155209;
                                    defunc_0_lifted_step_res_f_res_155223 = (int64_t) 0;
                                } else {
                                    bool cond_155225 = count_155210 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155226;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155227;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155228;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155229;
                                    
                                    if (cond_155225) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155206);
                                        bool y_157098 = slt64(ss_155206, stride_155039);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155206, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155208);
                                        bool y_157104 = slt64(tt_155208, j_m_i_155062);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155208, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155112 + ss_155206;
                                        double leq_arg1_157102 = ((double *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155039 + tt_155208;
                                        int64_t slice_157108 = start_155112 + slice_157107;
                                        double leq_arg0_157109 = ((double *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = leq_arg0_157109 <= leq_arg1_157102;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155208);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155206;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155206);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155208;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = tt_155209;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = (int64_t) 0;
                                    } else {
                                        int64_t m_155248 = sdiv64(count_155210, (int64_t) 2);
                                        int64_t n_155249 = sub64(count_155210, m_155248);
                                        bool cond_155250 = n_155249 == (int64_t) 0;
                                        int64_t zgze_lhs_155251 = add64(ss_155206, m_155248);
                                        bool cond_f_res_155252 = sle64(ss_155207, zgze_lhs_155251);
                                        bool x_155253 = !cond_155250;
                                        bool y_155254 = cond_f_res_155252 && x_155253;
                                        bool cond_155255 = cond_155250 || y_155254;
                                        bool leq_y_x_155256;
                                        
                                        if (cond_155255) {
                                            leq_y_x_155256 = 1;
                                        } else {
                                            bool x_155257 = sle64((int64_t) 0, zgze_lhs_155251);
                                            bool y_155258 = slt64(zgze_lhs_155251, stride_155039);
                                            bool bounds_check_155259 = x_155257 && y_155258;
                                            bool index_certs_155260;
                                            
                                            if (!bounds_check_155259) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155251, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155263 = add64(tt_155208, n_155249);
                                            int64_t leq_arg0_155264 = sub64(zm_lhs_155263, (int64_t) 1);
                                            bool x_155265 = sle64((int64_t) 0, leq_arg0_155264);
                                            bool y_155266 = slt64(leq_arg0_155264, j_m_i_155062);
                                            bool bounds_check_155267 = x_155265 && y_155266;
                                            bool index_certs_155268;
                                            
                                            if (!bounds_check_155267) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155264, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:117:36-40\n   #13 ftRelational.fut:114:9-117:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155261 = start_155112 + zgze_lhs_155251;
                                            double leq_arg1_155262 = ((double *) mem_param_165010.mem)[slice_155261];
                                            int64_t slice_155269 = stride_155039 + leq_arg0_155264;
                                            int64_t slice_155270 = start_155112 + slice_155269;
                                            double leq_arg0_155271 = ((double *) mem_param_165010.mem)[slice_155270];
                                            bool defunc_0_leq_res_155272 = leq_arg0_155271 <= leq_arg1_155262;
                                            
                                            leq_y_x_155256 = defunc_0_leq_res_155272;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                        
                                        if (leq_y_x_155256) {
                                            int64_t tmp_157115 = add64(tt_155208, n_155249);
                                            int64_t tmp_157116 = sub64(count_155210, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tt_155209;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = tmp_157116;
                                        } else {
                                            int64_t tmp_155278 = add64(tt_155208, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tt_155208;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tmp_155278;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = count_155210;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = ss_155206;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                    }
                                    defunc_0_lifted_step_res_f_res_155220 = defunc_0_lifted_step_res_f_res_f_res_155226;
                                    defunc_0_lifted_step_res_f_res_155221 = defunc_0_lifted_step_res_f_res_f_res_155227;
                                    defunc_0_lifted_step_res_f_res_155222 = defunc_0_lifted_step_res_f_res_f_res_155228;
                                    defunc_0_lifted_step_res_f_res_155223 = defunc_0_lifted_step_res_f_res_f_res_155229;
                                }
                                defunc_0_lifted_step_res_155213 = defunc_0_lifted_step_res_f_res_155220;
                                defunc_0_lifted_step_res_155214 = defunc_0_lifted_step_res_f_res_155221;
                                defunc_0_lifted_step_res_155215 = defunc_0_lifted_step_res_f_res_155222;
                                defunc_0_lifted_step_res_155216 = defunc_0_lifted_step_res_f_res_155223;
                            }
                            
                            int64_t loopres_155279;
                            int64_t loopres_155280;
                            int64_t loopres_155281;
                            int64_t loopres_155282;
                            int64_t loopres_155283;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155279, &loopres_155280, &loopres_155281, &loopres_155282, &loopres_155283, defunc_0_lifted_step_res_155213, ss_155207, defunc_0_lifted_step_res_155214, defunc_0_lifted_step_res_155215, defunc_0_lifted_step_res_155216) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155284 = slt64((int64_t) 0, loopres_155283);
                            bool loop_while_tmp_165727 = loop_cond_155284;
                            int64_t ss_tmp_165728 = loopres_155279;
                            int64_t ss_tmp_165729 = loopres_155280;
                            int64_t tt_tmp_165730 = loopres_155281;
                            int64_t tt_tmp_165731 = loopres_155282;
                            int64_t count_tmp_165732 = loopres_155283;
                            
                            loop_while_155205 = loop_while_tmp_165727;
                            ss_155206 = ss_tmp_165728;
                            ss_155207 = ss_tmp_165729;
                            tt_155208 = tt_tmp_165730;
                            tt_155209 = tt_tmp_165731;
                            count_155210 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155199 = loop_while_155205;
                        defunc_0_split_count_res_155200 = ss_155206;
                        defunc_0_split_count_res_155201 = ss_155207;
                        defunc_0_split_count_res_155202 = tt_155208;
                        defunc_0_split_count_res_155203 = tt_155209;
                        defunc_0_split_count_res_155204 = count_155210;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155200;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155202;
                    }
                    if (mem_165046_cached_sizze_166221 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166221, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166222 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166222, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155060; i_164739++) {
                        bool y_155290 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool index_certs_155292;
                        
                        if (!y_155290) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155293 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155294 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155295 = add64((int64_t) 1, i_164739);
                        bool x_155296 = sle64((int64_t) 0, tmp_155295);
                        bool y_155297 = slt64(tmp_155295, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool bounds_check_155298 = x_155296 && y_155297;
                        bool index_certs_155299;
                        
                        if (!bounds_check_155298) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155295, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165029)[tmp_155295];
                        int64_t defunc_0_f_res_155301 = ((int64_t *) mem_165031)[tmp_155295];
                        int64_t merge_sequential_arg2_155302 = add64(stride_155039, defunc_0_f_res_155294);
                        int64_t merge_sequential_arg2_155303 = add64(stride_155039, defunc_0_f_res_155301);
                        int64_t j_m_i_155304 = sub64(merge_sequential_arg2_155303, merge_sequential_arg2_155302);
                        bool empty_slice_155305 = j_m_i_155304 == (int64_t) 0;
                        int64_t m_155306 = sub64(j_m_i_155304, (int64_t) 1);
                        int64_t i_p_m_t_s_155307 = add64(merge_sequential_arg2_155302, m_155306);
                        bool zzero_leq_i_p_m_t_s_155308 = sle64((int64_t) 0, i_p_m_t_s_155307);
                        bool i_p_m_t_s_leq_w_155309 = slt64(i_p_m_t_s_155307, next_stride_155040);
                        bool zzero_lte_i_155310 = sle64((int64_t) 0, merge_sequential_arg2_155302);
                        bool i_lte_j_155311 = sle64(merge_sequential_arg2_155302, merge_sequential_arg2_155303);
                        bool y_155312 = i_p_m_t_s_leq_w_155309 && zzero_lte_i_155310;
                        bool y_155313 = zzero_leq_i_p_m_t_s_155308 && y_155312;
                        bool forwards_ok_155314 = i_lte_j_155311 && y_155313;
                        bool ok_or_empty_155315 = empty_slice_155305 || forwards_ok_155314;
                        bool index_certs_155316;
                        
                        if (!ok_or_empty_155315) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155302, ":", (long long) merge_sequential_arg2_155303, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155317 = sub64(defunc_0_f_res_155300, defunc_0_f_res_155293);
                        bool empty_slice_155318 = j_m_i_155317 == (int64_t) 0;
                        int64_t m_155319 = sub64(j_m_i_155317, (int64_t) 1);
                        int64_t i_p_m_t_s_155320 = add64(defunc_0_f_res_155293, m_155319);
                        bool zzero_leq_i_p_m_t_s_155321 = sle64((int64_t) 0, i_p_m_t_s_155320);
                        bool i_p_m_t_s_leq_w_155322 = slt64(i_p_m_t_s_155320, next_stride_155040);
                        bool zzero_lte_i_155323 = sle64((int64_t) 0, defunc_0_f_res_155293);
                        bool i_lte_j_155324 = sle64(defunc_0_f_res_155293, defunc_0_f_res_155300);
                        bool y_155325 = i_p_m_t_s_leq_w_155322 && zzero_lte_i_155323;
                        bool y_155326 = zzero_leq_i_p_m_t_s_155321 && y_155325;
                        bool forwards_ok_155327 = i_lte_j_155324 && y_155326;
                        bool ok_or_empty_155328 = empty_slice_155318 || forwards_ok_155327;
                        bool index_certs_155329;
                        
                        if (!ok_or_empty_155328) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155293, ":", (long long) defunc_0_f_res_155300, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:117:36-40\n   #10 ftRelational.fut:114:9-117:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155330 = slt64((int64_t) 0, j_m_i_155317);
                        double dummy_155331;
                        int64_t dummy_155332;
                        
                        if (cond_155330) {
                            bool index_certs_157117;
                            
                            if (!cond_155330) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:117:36-40\n   #12 ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155112 + defunc_0_f_res_155293;
                            double head_res_157119 = ((double *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155331 = head_res_157119;
                            dummy_155332 = head_res_157120;
                        } else {
                            bool y_155337 = slt64((int64_t) 0, j_m_i_155304);
                            bool index_certs_155338;
                            
                            if (!y_155337) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:117:36-40\n   #12 ftRelational.fut:114:9-117:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155339 = start_155112 + merge_sequential_arg2_155302;
                            double head_res_155340 = ((double *) mem_param_165010.mem)[slice_155339];
                            int64_t head_res_155341 = ((int64_t *) mem_param_165013.mem)[slice_155339];
                            
                            dummy_155331 = head_res_155340;
                            dummy_155332 = head_res_155341;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154925; nest_i_165735++) {
                            ((double *) mem_165046)[i_164739 * merge_block_sizze_154925 + nest_i_165735] = dummy_155331;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154925; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + nest_i_165736] = dummy_155332;
                        }
                        
                        int64_t data_155344;
                        int64_t i_155348 = (int64_t) 0;
                        
                        for (int64_t k_155347 = 0; k_155347 < merge_block_sizze_154925; k_155347++) {
                            int64_t j_155351 = sub64(k_155347, i_155348);
                            bool cond_155352 = j_155351 == j_m_i_155304;
                            bool cond_155353;
                            
                            if (cond_155352) {
                                cond_155353 = 1;
                            } else {
                                bool cond_155354 = slt64(i_155348, j_m_i_155317);
                                bool cond_f_res_155355;
                                
                                if (cond_155354) {
                                    bool x_157121 = sle64((int64_t) 0, j_155351);
                                    bool y_157122 = slt64(j_155351, j_m_i_155304);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155348);
                                    bool bounds_check_157129 = cond_155354 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155302 + j_155351;
                                    int64_t slice_157126 = start_155112 + slice_157125;
                                    double leq_arg1_157127 = ((double *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155293 + i_155348;
                                    int64_t slice_157132 = start_155112 + slice_157131;
                                    double leq_arg0_157133 = ((double *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = leq_arg0_157133 <= leq_arg1_157127;
                                    
                                    cond_f_res_155355 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155355 = 0;
                                }
                                cond_155353 = cond_f_res_155355;
                            }
                            
                            int64_t loopres_155370;
                            double loopres_155371;
                            int64_t loopres_155372;
                            
                            if (cond_155353) {
                                bool x_157136 = sle64((int64_t) 0, i_155348);
                                bool y_157137 = slt64(i_155348, j_m_i_155317);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155348);
                                int64_t slice_157140 = defunc_0_f_res_155293 + i_155348;
                                int64_t slice_157141 = start_155112 + slice_157140;
                                double tmp_157142 = ((double *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155370 = tmp_157135;
                                loopres_155371 = tmp_157142;
                                loopres_155372 = tmp_157143;
                            } else {
                                bool x_155382 = sle64((int64_t) 0, j_155351);
                                bool y_155383 = slt64(j_155351, j_m_i_155304);
                                bool bounds_check_155384 = x_155382 && y_155383;
                                bool index_certs_155385;
                                
                                if (!bounds_check_155384) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:117:36-40\n   #11 ftRelational.fut:114:9-117:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155386 = merge_sequential_arg2_155302 + j_155351;
                                int64_t slice_155387 = start_155112 + slice_155386;
                                double tmp_155388 = ((double *) mem_param_165010.mem)[slice_155387];
                                int64_t tmp_155389 = ((int64_t *) mem_param_165013.mem)[slice_155387];
                                
                                loopres_155370 = i_155348;
                                loopres_155371 = tmp_155388;
                                loopres_155372 = tmp_155389;
                            }
                            ((double *) mem_165046)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155371;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155372;
                            
                            int64_t i_tmp_165737 = loopres_155370;
                            
                            i_155348 = i_tmp_165737;
                        }
                        data_155344 = i_155348;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165045, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165016, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155396 = next_stride_155040 * num_merges_155044;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            if (memblock_alloc(ctx, &mem_165126, bytes_165015, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            
            bool loop_cond_155399 = slt64(next_stride_155040, flat_dim_154921);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155396;
            bool loop_while_tmp_165714 = loop_cond_155399;
            int64_t stride_tmp_165717 = next_stride_155040;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155035 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155036 = loop_while_tmp_165714;
            stride_155039 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155030 = loop_dz2084Uz2082U_155035;
        data_155031 = loop_while_155036;
        data_155034 = stride_155039;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155400 = n_95983 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155401 = sle64((int64_t) 0, zs_lhs_154905);
        bool i_p_m_t_s_leq_w_155402 = slt64(zs_lhs_154905, data_155030);
        bool y_155403 = zzero_leq_i_p_m_t_s_155401 && i_p_m_t_s_leq_w_155402;
        bool ok_or_empty_155404 = empty_slice_155400 || y_155403;
        bool index_certs_155405;
        
        if (!ok_or_empty_155404) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_95983, "] out of bounds for array of shape [", (long long) data_155030, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:117:36-40\n   #6  ftRelational.fut:114:9-117:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_95983; i_164753++) {
        int64_t eta_p_155413 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155414 = sle64((int64_t) 0, eta_p_155413);
        bool y_155415 = slt64(eta_p_155413, n_95983);
        bool bounds_check_155416 = x_155414 && y_155415;
        bool index_certs_155417;
        
        if (!bounds_check_155416) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155413, "] out of bounds for array of shape [", (long long) n_95983, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:117:36-40\n   #5  ftRelational.fut:114:9-117:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double lifted_lambda_res_155418 = ((double *) k_mem_164928.mem)[eta_p_155413];
        
        ((double *) mem_165138.mem)[i_164753] = lifted_lambda_res_155418;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165140.mem, i_164753 * b_95984, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_164929.mem, eta_p_155413 * b_95984, (int64_t []) {(int64_t) 1}, (int64_t []) {b_95984});
    }
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166211, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166212, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_166223, struct memblock *mem_out_p_166224, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_93618, int64_t b_93619)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166225 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166226 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166227 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166228 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166229 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166230 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166231 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166232 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166233 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166234 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_93618;
    bool cond_154904 = sle64(n_93618, (int64_t) 1);
    int64_t zs_lhs_154905 = sub64(n_93618, (int64_t) 1);
    int64_t zp_rhs_154906 = sdiv_safe64(zs_lhs_154905, (int64_t) 20);
    int64_t min_num_blocks_154907 = add64((int64_t) 1, zp_rhs_154906);
    bool loop_cond_154908 = slt64((int64_t) 1, min_num_blocks_154907);
    bool smallest_pow_2_geq_than_res_154909;
    int64_t smallest_pow_2_geq_than_res_154910;
    bool loop_while_154911;
    int64_t x_154912;
    
    loop_while_154911 = loop_cond_154908;
    x_154912 = (int64_t) 1;
    while (loop_while_154911) {
        int64_t loopres_154913 = mul64((int64_t) 2, x_154912);
        bool loop_cond_154914 = slt64(loopres_154913, min_num_blocks_154907);
        bool loop_while_tmp_165695 = loop_cond_154914;
        int64_t x_tmp_165696 = loopres_154913;
        
        loop_while_154911 = loop_while_tmp_165695;
        x_154912 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154909 = loop_while_154911;
    smallest_pow_2_geq_than_res_154910 = x_154912;
    
    bool zzero_154915 = smallest_pow_2_geq_than_res_154910 == (int64_t) 0;
    bool nonzzero_154916 = !zzero_154915;
    bool protect_assert_disj_154917 = cond_154904 || nonzzero_154916;
    bool nonzzero_cert_154918;
    
    if (!protect_assert_disj_154917) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154919 = sdiv_safe64(zs_lhs_154905, smallest_pow_2_geq_than_res_154910);
    int64_t block_sizze_154920 = add64((int64_t) 1, zp_rhs_154919);
    bool y_154926 = slt64((int64_t) 0, n_93618);
    bool protect_assert_disj_165536 = cond_154904 || y_154926;
    bool index_certs_154927;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_93618, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154941 = slt64(smallest_pow_2_geq_than_res_154910, (int64_t) 0);
    bool valid_154942 = !bounds_invalid_upwards_154941;
    bool protect_assert_disj_165544 = cond_154904 || valid_154942;
    bool range_valid_c_154943;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154910, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:113:36-40\n   #6  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154945 = slt64(block_sizze_154920, (int64_t) 0);
    bool valid_154946 = !bounds_invalid_upwards_154945;
    bool protect_assert_disj_165546 = cond_154904 || valid_154946;
    bool range_valid_c_154947;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154920, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154949 = sle64(block_sizze_154920, (int64_t) 1);
    int64_t tmp_154950 = sub64(block_sizze_154920, (int64_t) 2);
    bool bounds_invalid_upwards_154951 = slt64(tmp_154950, (int64_t) 0);
    bool valid_154953 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_154954 = cond_154949 || valid_154953;
    bool protect_assert_disj_165548 = cond_154904 || protect_assert_disj_154954;
    bool range_valid_c_154955;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154950, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165137 = (int64_t) 4 * n_93618;
    int64_t bytes_165139 = n_93618 * b_93619;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_93618; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154921 = smallest_pow_2_geq_than_res_154910 * block_sizze_154920;
    bool x_165531 = !cond_154904;
    int64_t greatest_divisor_leq_than_arg1_154924 = mul64((int64_t) 2, block_sizze_154920);
    int64_t merge_block_sizze_154925;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154924) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154925 = x_165533;
    } else {
        merge_block_sizze_154925 = (int64_t) 0;
    }
    
    float reduce_arg1_154928;
    
    if (x_165531) {
        float x_165537 = ((float *) k_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154928 = x_165537;
    } else {
        reduce_arg1_154928 = 0.0F;
    }
    
    float defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        float x_165539;
        int64_t x_165540;
        float redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154928;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_93618; i_164713++) {
            float x_154932 = ((float *) k_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154938 = redout_164711 <= x_154932;
            float defunc_0_op_res_154939;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154939 = x_154932;
            } else {
                defunc_0_op_res_154939 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154940;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154940 = i_164713;
            } else {
                defunc_0_op_res_154940 = redout_164712;
            }
            
            float redout_tmp_165699 = defunc_0_op_res_154939;
            int64_t redout_tmp_165700 = defunc_0_op_res_154940;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = 0.0F;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154952 = add64((int64_t) 1, tmp_154950);
    int64_t binop_x_164932 = (int64_t) 4 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164933 = block_sizze_154920 * binop_x_164932;
    int64_t binop_x_164935 = (int64_t) 8 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164936 = block_sizze_154920 * binop_x_164935;
    int64_t bytes_164946 = (int64_t) 4 * block_sizze_154920;
    int64_t bytes_164948 = (int64_t) 8 * block_sizze_154920;
    bool loop_cond_155027 = slt64(block_sizze_154920, flat_dim_154921);
    bool zzero_155028 = merge_block_sizze_154925 == (int64_t) 0;
    bool nonzzero_155029 = !zzero_155028;
    
    if (cond_154904) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166225 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166225, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166226 < bytes_164936) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166226, bytes_164936);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166227 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166227, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166228 < bytes_164948) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166228, bytes_164948);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154910; i_164725++) {
            int64_t zp_lhs_154959 = mul64(block_sizze_154920, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154920; i_164718++) {
                int64_t k_154963 = add64(zp_lhs_154959, i_164718);
                bool cond_154964 = slt64(k_154963, n_93618);
                float lifted_lambda_res_154965;
                int64_t lifted_lambda_res_154966;
                
                if (cond_154964) {
                    bool x_157003 = sle64((int64_t) 0, k_154963);
                    bool bounds_check_157004 = cond_154964 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154963, "] out of bounds for array of shape [", (long long) n_93618, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_157006 = ((float *) k_mem_164928.mem)[k_154963];
                    
                    lifted_lambda_res_154965 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154966 = k_154963;
                } else {
                    lifted_lambda_res_154965 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154966 = defunc_0_reduce_res_157151;
                }
                ((float *) mem_164947)[i_164718] = lifted_lambda_res_154965;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154966;
            }
            if (!cond_154949) {
                for (int64_t i_154976 = 0; i_154976 < distance_154952; i_154976++) {
                    int64_t gt_arg1_154979 = add64((int64_t) 1, i_154976);
                    bool x_154980 = sle64((int64_t) 0, gt_arg1_154979);
                    bool y_154981 = slt64(gt_arg1_154979, block_sizze_154920);
                    bool bounds_check_154982 = x_154980 && y_154981;
                    bool index_certs_154983;
                    
                    if (!bounds_check_154982) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154979, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154985 = slt64(i_154976, block_sizze_154920);
                    bool index_certs_154986;
                    
                    if (!y_154985) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154976, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_154984 = ((float *) mem_164947)[gt_arg1_154979];
                    float gt_arg0_154987 = ((float *) mem_164947)[i_154976];
                    bool defunc_0_leq_res_154988 = gt_arg0_154987 <= gt_arg1_154984;
                    bool defunc_0_lifted_gt_res_154989 = !defunc_0_leq_res_154988;
                    bool s_154990;
                    int64_t s_154993;
                    bool loop_while_154994;
                    int64_t j_154997;
                    
                    loop_while_154994 = defunc_0_lifted_gt_res_154989;
                    j_154997 = i_154976;
                    while (loop_while_154994) {
                        bool x_154998 = sle64((int64_t) 0, j_154997);
                        bool y_154999 = slt64(j_154997, block_sizze_154920);
                        bool bounds_check_155000 = x_154998 && y_154999;
                        bool index_certs_155001;
                        
                        if (!bounds_check_155000) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_154997, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155004 = add64((int64_t) 1, j_154997);
                        bool x_155005 = sle64((int64_t) 0, copy_arg0_155004);
                        bool y_155006 = slt64(copy_arg0_155004, block_sizze_154920);
                        bool bounds_check_155007 = x_155005 && y_155006;
                        bool index_certs_155008;
                        
                        if (!bounds_check_155007) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155004, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_155002 = ((float *) mem_164947)[j_154997];
                        int64_t copy_arg0_155003 = ((int64_t *) mem_164949)[j_154997];
                        float copy_arg0_155009 = ((float *) mem_164947)[copy_arg0_155004];
                        int64_t copy_arg0_155010 = ((int64_t *) mem_164949)[copy_arg0_155004];
                        
                        ((float *) mem_164947)[j_154997] = copy_arg0_155009;
                        ((int64_t *) mem_164949)[j_154997] = copy_arg0_155010;
                        ((float *) mem_164947)[copy_arg0_155004] = copy_arg0_155002;
                        ((int64_t *) mem_164949)[copy_arg0_155004] = copy_arg0_155003;
                        
                        int64_t tmp_155015 = sub64(j_154997, (int64_t) 1);
                        bool cond_155016 = sle64((int64_t) 0, tmp_155015);
                        bool loop_cond_155017;
                        
                        if (cond_155016) {
                            bool y_157008 = slt64(tmp_155015, block_sizze_154920);
                            bool bounds_check_157009 = cond_155016 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155015, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_157007 = ((float *) mem_164947)[j_154997];
                            float gt_arg0_157011 = ((float *) mem_164947)[tmp_155015];
                            bool defunc_0_leq_res_157012 = gt_arg0_157011 <= gt_arg1_157007;
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155017 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155017 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155017;
                        int64_t j_tmp_165710 = tmp_155015;
                        
                        loop_while_154994 = loop_while_tmp_165707;
                        j_154997 = j_tmp_165710;
                    }
                    s_154990 = loop_while_154994;
                    s_154993 = j_154997;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164934, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint32_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        if (memblock_alloc(ctx, &mem_165006, bytes_164936, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        
        int64_t data_155030;
        bool data_155031;
        int64_t data_155034;
        int64_t loop_dz2084Uz2082U_155035;
        bool loop_while_155036;
        int64_t stride_155039;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155035 = flat_dim_154921;
        loop_while_155036 = loop_cond_155027;
        stride_155039 = block_sizze_154920;
        while (loop_while_155036) {
            int64_t next_stride_155040 = mul64((int64_t) 2, stride_155039);
            bool zzero_155041 = next_stride_155040 == (int64_t) 0;
            bool nonzzero_155042 = !zzero_155041;
            bool nonzzero_cert_155043;
            
            if (!nonzzero_155042) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155044 = sdiv64(flat_dim_154921, next_stride_155040);
            bool bounds_invalid_upwards_155045 = slt64(num_merges_155044, (int64_t) 0);
            bool valid_155046 = !bounds_invalid_upwards_155045;
            bool range_valid_c_155047;
            
            if (!valid_155046) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155044, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:113:36-40\n   #6  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155049 = sub64(next_stride_155040, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155050 = sle64((int64_t) 0, m_155049);
            bool cond_155052 = slt64(next_stride_155040, (int64_t) 10);
            bool protect_assert_disj_155053 = nonzzero_155029 || cond_155052;
            bool nonzzero_cert_155054;
            
            if (!protect_assert_disj_155053) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155055 = smod_safe64(next_stride_155040, merge_block_sizze_154925);
            bool num_blocks_155056 = zeze_lhs_155055 == (int64_t) 0;
            bool protect_assert_disj_155057 = cond_155052 || num_blocks_155056;
            bool assert_c_155058;
            
            if (!protect_assert_disj_155057) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155060 = sdiv_safe64(next_stride_155040, merge_block_sizze_154925);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061 = add64((int64_t) 1, num_blocks_155060);
            int64_t j_m_i_155062 = sub64(next_stride_155040, stride_155039);
            int64_t flat_dim_155063 = merge_block_sizze_154925 * num_blocks_155060;
            bool bounds_invalid_upwards_155064 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, (int64_t) 0);
            bool empty_slice_155065 = j_m_i_155062 == (int64_t) 0;
            int64_t m_155066 = sub64(j_m_i_155062, (int64_t) 1);
            bool zzero_lte_i_155067 = sle64((int64_t) 0, stride_155039);
            bool i_lte_j_155068 = sle64(stride_155039, next_stride_155040);
            bool empty_slice_155069 = stride_155039 == (int64_t) 0;
            int64_t m_155070 = sub64(stride_155039, (int64_t) 1);
            bool bounds_invalid_upwards_155071 = slt64(num_blocks_155060, (int64_t) 0);
            bool cond_155072 = slt64((int64_t) 0, stride_155039);
            bool valid_155073 = !bounds_invalid_upwards_155064;
            int64_t i_p_m_t_s_155074 = add64(stride_155039, m_155066);
            bool zzero_leq_i_p_m_t_s_155075 = sle64((int64_t) 0, m_155070);
            bool i_p_m_t_s_leq_w_155076 = slt64(m_155070, next_stride_155040);
            bool valid_155077 = !bounds_invalid_upwards_155071;
            bool i_p_m_t_s_leq_w_155078 = slt64(m_155049, flat_dim_155063);
            bool y_155079 = slt64((int64_t) 0, j_m_i_155062);
            bool protect_assert_disj_155080 = cond_155052 || valid_155073;
            bool range_valid_c_155081;
            
            if (!protect_assert_disj_155080) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155082 = sle64((int64_t) 0, i_p_m_t_s_155074);
            bool i_p_m_t_s_leq_w_155083 = slt64(i_p_m_t_s_155074, next_stride_155040);
            bool y_155084 = zzero_leq_i_p_m_t_s_155075 && i_p_m_t_s_leq_w_155076;
            bool protect_assert_disj_155085 = cond_155052 || valid_155077;
            bool range_valid_c_155086;
            
            if (!protect_assert_disj_155085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155060, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155087 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155078;
            bool y_155088 = zzero_lte_i_155067 && i_p_m_t_s_leq_w_155083;
            bool forwards_ok_155089 = zzero_lte_i_155067 && y_155084;
            bool ok_or_empty_155090 = zzero_155041 || y_155087;
            bool protect_assert_disj_155091 = cond_155072 || y_155079;
            bool y_155092 = zzero_leq_i_p_m_t_s_155082 && y_155088;
            bool ok_or_empty_155093 = empty_slice_155069 || forwards_ok_155089;
            bool protect_assert_disj_155094 = cond_155052 || ok_or_empty_155090;
            bool index_certs_155095;
            
            if (!protect_assert_disj_155094) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) flat_dim_155063, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155096 = !cond_155052;
            bool protect_assert_disj_155097 = protect_assert_disj_155091 || loop_not_taken_155096;
            bool index_certs_155098;
            
            if (!protect_assert_disj_155097) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155099 = i_lte_j_155068 && y_155092;
            bool protect_assert_disj_155100 = cond_155052 || ok_or_empty_155093;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155102 = ok_or_empty_155093 || loop_not_taken_155096;
            bool index_certs_155103;
            
            if (!protect_assert_disj_155102) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155104 = empty_slice_155065 || forwards_ok_155099;
            bool protect_assert_disj_155105 = cond_155052 || ok_or_empty_155104;
            bool index_certs_155106;
            
            if (!protect_assert_disj_155105) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155107 = loop_not_taken_155096 || ok_or_empty_155104;
            bool index_certs_155108;
            
            if (!protect_assert_disj_155107) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 4 * num_merges_155044;
            int64_t bytes_165015 = next_stride_155040 * binop_x_165014;
            int64_t binop_x_165017 = (int64_t) 8 * num_merges_155044;
            int64_t bytes_165018 = next_stride_155040 * binop_x_165017;
            bool i_lte_j_155051 = sle64((int64_t) 0, next_stride_155040);
            
            if (mem_165016_cached_sizze_166229 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166229, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166230 < bytes_165018) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166230, bytes_165018);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061;
            int64_t binop_x_165044 = (int64_t) 4 * num_blocks_155060;
            int64_t bytes_165045 = merge_block_sizze_154925 * binop_x_165044;
            int64_t binop_x_165047 = (int64_t) 8 * num_blocks_155060;
            int64_t bytes_165048 = merge_block_sizze_154925 * binop_x_165047;
            int64_t bytes_165090 = (int64_t) 8 * stride_155039;
            int64_t bytes_165092 = (int64_t) 16 * stride_155039;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155044; i_164746++) {
                int64_t start_155112 = mul64(next_stride_155040, i_164746);
                int64_t j_m_i_155113 = sub64(loop_dz2084Uz2082U_155035, start_155112);
                bool empty_slice_155114 = j_m_i_155113 == (int64_t) 0;
                int64_t m_155115 = sub64(j_m_i_155113, (int64_t) 1);
                int64_t i_p_m_t_s_155116 = add64(start_155112, m_155115);
                bool zzero_leq_i_p_m_t_s_155117 = sle64((int64_t) 0, i_p_m_t_s_155116);
                bool i_p_m_t_s_leq_w_155118 = slt64(i_p_m_t_s_155116, loop_dz2084Uz2082U_155035);
                bool zzero_lte_i_155119 = sle64((int64_t) 0, start_155112);
                bool i_lte_j_155120 = sle64(start_155112, loop_dz2084Uz2082U_155035);
                bool y_155121 = i_p_m_t_s_leq_w_155118 && zzero_lte_i_155119;
                bool y_155122 = zzero_leq_i_p_m_t_s_155117 && y_155121;
                bool forwards_ok_155123 = i_lte_j_155120 && y_155122;
                bool ok_or_empty_155124 = empty_slice_155114 || forwards_ok_155123;
                bool index_certs_155125;
                
                if (!ok_or_empty_155124) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155112, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155035, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155126 = slt64(m_155049, j_m_i_155113);
                bool y_155127 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155126;
                bool forwards_ok_155128 = i_lte_j_155051 && y_155127;
                bool ok_or_empty_155129 = zzero_155041 || forwards_ok_155128;
                bool index_certs_155130;
                
                if (!ok_or_empty_155129) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) j_m_i_155113, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:113:36-40\n   #8  ftRelational.fut:110:9-113:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155052) {
                    float dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155072) {
                        float head_res_157041 = ((float *) mem_param_165010.mem)[start_155112];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155112];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155039 + start_155112;
                        float head_res_157044 = ((float *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155040; nest_i_165720++) {
                        ((float *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165092, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155040; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155040; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155062;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155039);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155062);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155039 + j_157055;
                                int64_t slice_157065 = start_155112 + slice_157064;
                                float leq_arg1_157066 = ((float *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155112 + i_157052;
                                float leq_arg0_157071 = ((float *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = leq_arg0_157071 <= leq_arg1_157066;
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        float loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155039);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155112 + i_157052;
                            float tmp_157082 = ((float *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155062);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:113:36-40\n   #9  ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155039 + j_157055;
                            int64_t slice_157089 = start_155112 + slice_157088;
                            float tmp_157090 = ((float *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((float *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166231 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166231, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166232 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166232, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061; i_164732++) {
                        int64_t split_count_arg3_155192 = mul64(merge_block_sizze_154925, i_164732);
                        int64_t defunc_0_split_count_res_155193;
                        int64_t defunc_0_split_count_res_155194;
                        int64_t defunc_0_split_count_res_155195;
                        int64_t defunc_0_split_count_res_155196;
                        int64_t defunc_0_split_count_res_155197;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155193, &defunc_0_split_count_res_155194, &defunc_0_split_count_res_155195, &defunc_0_split_count_res_155196, &defunc_0_split_count_res_155197, (int64_t) 0, stride_155039, (int64_t) 0, j_m_i_155062, split_count_arg3_155192) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155198 = slt64((int64_t) 0, defunc_0_split_count_res_155197);
                        bool defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        int64_t defunc_0_split_count_res_155204;
                        bool loop_while_155205;
                        int64_t ss_155206;
                        int64_t ss_155207;
                        int64_t tt_155208;
                        int64_t tt_155209;
                        int64_t count_155210;
                        
                        loop_while_155205 = loop_cond_155198;
                        ss_155206 = defunc_0_split_count_res_155193;
                        ss_155207 = defunc_0_split_count_res_155194;
                        tt_155208 = defunc_0_split_count_res_155195;
                        tt_155209 = defunc_0_split_count_res_155196;
                        count_155210 = defunc_0_split_count_res_155197;
                        while (loop_while_155205) {
                            int64_t zlze_lhs_155211 = sub64(ss_155207, ss_155206);
                            bool cond_155212 = sle64(zlze_lhs_155211, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155213;
                            int64_t defunc_0_lifted_step_res_155214;
                            int64_t defunc_0_lifted_step_res_155215;
                            int64_t defunc_0_lifted_step_res_155216;
                            
                            if (cond_155212) {
                                int64_t tmp_157094 = add64(tt_155208, count_155210);
                                
                                defunc_0_lifted_step_res_155213 = ss_155206;
                                defunc_0_lifted_step_res_155214 = tmp_157094;
                                defunc_0_lifted_step_res_155215 = tt_155209;
                                defunc_0_lifted_step_res_155216 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155218 = sub64(tt_155209, tt_155208);
                                bool cond_155219 = sle64(zlze_lhs_155218, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155220;
                                int64_t defunc_0_lifted_step_res_f_res_155221;
                                int64_t defunc_0_lifted_step_res_f_res_155222;
                                int64_t defunc_0_lifted_step_res_f_res_155223;
                                
                                if (cond_155219) {
                                    int64_t tmp_157095 = add64(ss_155206, count_155210);
                                    
                                    defunc_0_lifted_step_res_f_res_155220 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155221 = tt_155208;
                                    defunc_0_lifted_step_res_f_res_155222 = tt_155209;
                                    defunc_0_lifted_step_res_f_res_155223 = (int64_t) 0;
                                } else {
                                    bool cond_155225 = count_155210 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155226;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155227;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155228;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155229;
                                    
                                    if (cond_155225) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155206);
                                        bool y_157098 = slt64(ss_155206, stride_155039);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155206, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155208);
                                        bool y_157104 = slt64(tt_155208, j_m_i_155062);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155208, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155112 + ss_155206;
                                        float leq_arg1_157102 = ((float *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155039 + tt_155208;
                                        int64_t slice_157108 = start_155112 + slice_157107;
                                        float leq_arg0_157109 = ((float *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = leq_arg0_157109 <= leq_arg1_157102;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155208);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155206;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155206);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155208;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = tt_155209;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = (int64_t) 0;
                                    } else {
                                        int64_t m_155248 = sdiv64(count_155210, (int64_t) 2);
                                        int64_t n_155249 = sub64(count_155210, m_155248);
                                        bool cond_155250 = n_155249 == (int64_t) 0;
                                        int64_t zgze_lhs_155251 = add64(ss_155206, m_155248);
                                        bool cond_f_res_155252 = sle64(ss_155207, zgze_lhs_155251);
                                        bool x_155253 = !cond_155250;
                                        bool y_155254 = cond_f_res_155252 && x_155253;
                                        bool cond_155255 = cond_155250 || y_155254;
                                        bool leq_y_x_155256;
                                        
                                        if (cond_155255) {
                                            leq_y_x_155256 = 1;
                                        } else {
                                            bool x_155257 = sle64((int64_t) 0, zgze_lhs_155251);
                                            bool y_155258 = slt64(zgze_lhs_155251, stride_155039);
                                            bool bounds_check_155259 = x_155257 && y_155258;
                                            bool index_certs_155260;
                                            
                                            if (!bounds_check_155259) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155251, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155263 = add64(tt_155208, n_155249);
                                            int64_t leq_arg0_155264 = sub64(zm_lhs_155263, (int64_t) 1);
                                            bool x_155265 = sle64((int64_t) 0, leq_arg0_155264);
                                            bool y_155266 = slt64(leq_arg0_155264, j_m_i_155062);
                                            bool bounds_check_155267 = x_155265 && y_155266;
                                            bool index_certs_155268;
                                            
                                            if (!bounds_check_155267) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155264, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:113:36-40\n   #13 ftRelational.fut:110:9-113:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155261 = start_155112 + zgze_lhs_155251;
                                            float leq_arg1_155262 = ((float *) mem_param_165010.mem)[slice_155261];
                                            int64_t slice_155269 = stride_155039 + leq_arg0_155264;
                                            int64_t slice_155270 = start_155112 + slice_155269;
                                            float leq_arg0_155271 = ((float *) mem_param_165010.mem)[slice_155270];
                                            bool defunc_0_leq_res_155272 = leq_arg0_155271 <= leq_arg1_155262;
                                            
                                            leq_y_x_155256 = defunc_0_leq_res_155272;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                        
                                        if (leq_y_x_155256) {
                                            int64_t tmp_157115 = add64(tt_155208, n_155249);
                                            int64_t tmp_157116 = sub64(count_155210, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tt_155209;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = tmp_157116;
                                        } else {
                                            int64_t tmp_155278 = add64(tt_155208, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tt_155208;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tmp_155278;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = count_155210;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = ss_155206;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                    }
                                    defunc_0_lifted_step_res_f_res_155220 = defunc_0_lifted_step_res_f_res_f_res_155226;
                                    defunc_0_lifted_step_res_f_res_155221 = defunc_0_lifted_step_res_f_res_f_res_155227;
                                    defunc_0_lifted_step_res_f_res_155222 = defunc_0_lifted_step_res_f_res_f_res_155228;
                                    defunc_0_lifted_step_res_f_res_155223 = defunc_0_lifted_step_res_f_res_f_res_155229;
                                }
                                defunc_0_lifted_step_res_155213 = defunc_0_lifted_step_res_f_res_155220;
                                defunc_0_lifted_step_res_155214 = defunc_0_lifted_step_res_f_res_155221;
                                defunc_0_lifted_step_res_155215 = defunc_0_lifted_step_res_f_res_155222;
                                defunc_0_lifted_step_res_155216 = defunc_0_lifted_step_res_f_res_155223;
                            }
                            
                            int64_t loopres_155279;
                            int64_t loopres_155280;
                            int64_t loopres_155281;
                            int64_t loopres_155282;
                            int64_t loopres_155283;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155279, &loopres_155280, &loopres_155281, &loopres_155282, &loopres_155283, defunc_0_lifted_step_res_155213, ss_155207, defunc_0_lifted_step_res_155214, defunc_0_lifted_step_res_155215, defunc_0_lifted_step_res_155216) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155284 = slt64((int64_t) 0, loopres_155283);
                            bool loop_while_tmp_165727 = loop_cond_155284;
                            int64_t ss_tmp_165728 = loopres_155279;
                            int64_t ss_tmp_165729 = loopres_155280;
                            int64_t tt_tmp_165730 = loopres_155281;
                            int64_t tt_tmp_165731 = loopres_155282;
                            int64_t count_tmp_165732 = loopres_155283;
                            
                            loop_while_155205 = loop_while_tmp_165727;
                            ss_155206 = ss_tmp_165728;
                            ss_155207 = ss_tmp_165729;
                            tt_155208 = tt_tmp_165730;
                            tt_155209 = tt_tmp_165731;
                            count_155210 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155199 = loop_while_155205;
                        defunc_0_split_count_res_155200 = ss_155206;
                        defunc_0_split_count_res_155201 = ss_155207;
                        defunc_0_split_count_res_155202 = tt_155208;
                        defunc_0_split_count_res_155203 = tt_155209;
                        defunc_0_split_count_res_155204 = count_155210;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155200;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155202;
                    }
                    if (mem_165046_cached_sizze_166233 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166233, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166234 < bytes_165048) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166234, bytes_165048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155060; i_164739++) {
                        bool y_155290 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool index_certs_155292;
                        
                        if (!y_155290) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155293 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155294 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155295 = add64((int64_t) 1, i_164739);
                        bool x_155296 = sle64((int64_t) 0, tmp_155295);
                        bool y_155297 = slt64(tmp_155295, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool bounds_check_155298 = x_155296 && y_155297;
                        bool index_certs_155299;
                        
                        if (!bounds_check_155298) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155295, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165029)[tmp_155295];
                        int64_t defunc_0_f_res_155301 = ((int64_t *) mem_165031)[tmp_155295];
                        int64_t merge_sequential_arg2_155302 = add64(stride_155039, defunc_0_f_res_155294);
                        int64_t merge_sequential_arg2_155303 = add64(stride_155039, defunc_0_f_res_155301);
                        int64_t j_m_i_155304 = sub64(merge_sequential_arg2_155303, merge_sequential_arg2_155302);
                        bool empty_slice_155305 = j_m_i_155304 == (int64_t) 0;
                        int64_t m_155306 = sub64(j_m_i_155304, (int64_t) 1);
                        int64_t i_p_m_t_s_155307 = add64(merge_sequential_arg2_155302, m_155306);
                        bool zzero_leq_i_p_m_t_s_155308 = sle64((int64_t) 0, i_p_m_t_s_155307);
                        bool i_p_m_t_s_leq_w_155309 = slt64(i_p_m_t_s_155307, next_stride_155040);
                        bool zzero_lte_i_155310 = sle64((int64_t) 0, merge_sequential_arg2_155302);
                        bool i_lte_j_155311 = sle64(merge_sequential_arg2_155302, merge_sequential_arg2_155303);
                        bool y_155312 = i_p_m_t_s_leq_w_155309 && zzero_lte_i_155310;
                        bool y_155313 = zzero_leq_i_p_m_t_s_155308 && y_155312;
                        bool forwards_ok_155314 = i_lte_j_155311 && y_155313;
                        bool ok_or_empty_155315 = empty_slice_155305 || forwards_ok_155314;
                        bool index_certs_155316;
                        
                        if (!ok_or_empty_155315) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155302, ":", (long long) merge_sequential_arg2_155303, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155317 = sub64(defunc_0_f_res_155300, defunc_0_f_res_155293);
                        bool empty_slice_155318 = j_m_i_155317 == (int64_t) 0;
                        int64_t m_155319 = sub64(j_m_i_155317, (int64_t) 1);
                        int64_t i_p_m_t_s_155320 = add64(defunc_0_f_res_155293, m_155319);
                        bool zzero_leq_i_p_m_t_s_155321 = sle64((int64_t) 0, i_p_m_t_s_155320);
                        bool i_p_m_t_s_leq_w_155322 = slt64(i_p_m_t_s_155320, next_stride_155040);
                        bool zzero_lte_i_155323 = sle64((int64_t) 0, defunc_0_f_res_155293);
                        bool i_lte_j_155324 = sle64(defunc_0_f_res_155293, defunc_0_f_res_155300);
                        bool y_155325 = i_p_m_t_s_leq_w_155322 && zzero_lte_i_155323;
                        bool y_155326 = zzero_leq_i_p_m_t_s_155321 && y_155325;
                        bool forwards_ok_155327 = i_lte_j_155324 && y_155326;
                        bool ok_or_empty_155328 = empty_slice_155318 || forwards_ok_155327;
                        bool index_certs_155329;
                        
                        if (!ok_or_empty_155328) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155293, ":", (long long) defunc_0_f_res_155300, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:113:36-40\n   #10 ftRelational.fut:110:9-113:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155330 = slt64((int64_t) 0, j_m_i_155317);
                        float dummy_155331;
                        int64_t dummy_155332;
                        
                        if (cond_155330) {
                            bool index_certs_157117;
                            
                            if (!cond_155330) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:113:36-40\n   #12 ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155112 + defunc_0_f_res_155293;
                            float head_res_157119 = ((float *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155331 = head_res_157119;
                            dummy_155332 = head_res_157120;
                        } else {
                            bool y_155337 = slt64((int64_t) 0, j_m_i_155304);
                            bool index_certs_155338;
                            
                            if (!y_155337) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:113:36-40\n   #12 ftRelational.fut:110:9-113:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155339 = start_155112 + merge_sequential_arg2_155302;
                            float head_res_155340 = ((float *) mem_param_165010.mem)[slice_155339];
                            int64_t head_res_155341 = ((int64_t *) mem_param_165013.mem)[slice_155339];
                            
                            dummy_155331 = head_res_155340;
                            dummy_155332 = head_res_155341;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154925; nest_i_165735++) {
                            ((float *) mem_165046)[i_164739 * merge_block_sizze_154925 + nest_i_165735] = dummy_155331;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154925; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + nest_i_165736] = dummy_155332;
                        }
                        
                        int64_t data_155344;
                        int64_t i_155348 = (int64_t) 0;
                        
                        for (int64_t k_155347 = 0; k_155347 < merge_block_sizze_154925; k_155347++) {
                            int64_t j_155351 = sub64(k_155347, i_155348);
                            bool cond_155352 = j_155351 == j_m_i_155304;
                            bool cond_155353;
                            
                            if (cond_155352) {
                                cond_155353 = 1;
                            } else {
                                bool cond_155354 = slt64(i_155348, j_m_i_155317);
                                bool cond_f_res_155355;
                                
                                if (cond_155354) {
                                    bool x_157121 = sle64((int64_t) 0, j_155351);
                                    bool y_157122 = slt64(j_155351, j_m_i_155304);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155348);
                                    bool bounds_check_157129 = cond_155354 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155302 + j_155351;
                                    int64_t slice_157126 = start_155112 + slice_157125;
                                    float leq_arg1_157127 = ((float *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155293 + i_155348;
                                    int64_t slice_157132 = start_155112 + slice_157131;
                                    float leq_arg0_157133 = ((float *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = leq_arg0_157133 <= leq_arg1_157127;
                                    
                                    cond_f_res_155355 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155355 = 0;
                                }
                                cond_155353 = cond_f_res_155355;
                            }
                            
                            int64_t loopres_155370;
                            float loopres_155371;
                            int64_t loopres_155372;
                            
                            if (cond_155353) {
                                bool x_157136 = sle64((int64_t) 0, i_155348);
                                bool y_157137 = slt64(i_155348, j_m_i_155317);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155348);
                                int64_t slice_157140 = defunc_0_f_res_155293 + i_155348;
                                int64_t slice_157141 = start_155112 + slice_157140;
                                float tmp_157142 = ((float *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155370 = tmp_157135;
                                loopres_155371 = tmp_157142;
                                loopres_155372 = tmp_157143;
                            } else {
                                bool x_155382 = sle64((int64_t) 0, j_155351);
                                bool y_155383 = slt64(j_155351, j_m_i_155304);
                                bool bounds_check_155384 = x_155382 && y_155383;
                                bool index_certs_155385;
                                
                                if (!bounds_check_155384) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:113:36-40\n   #11 ftRelational.fut:110:9-113:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155386 = merge_sequential_arg2_155302 + j_155351;
                                int64_t slice_155387 = start_155112 + slice_155386;
                                float tmp_155388 = ((float *) mem_param_165010.mem)[slice_155387];
                                int64_t tmp_155389 = ((int64_t *) mem_param_165013.mem)[slice_155387];
                                
                                loopres_155370 = i_155348;
                                loopres_155371 = tmp_155388;
                                loopres_155372 = tmp_155389;
                            }
                            ((float *) mem_165046)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155371;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155372;
                            
                            int64_t i_tmp_165737 = loopres_155370;
                            
                            i_155348 = i_tmp_165737;
                        }
                        data_155344 = i_155348;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint32_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165048, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_165016, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155396 = next_stride_155040 * num_merges_155044;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint32_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            if (memblock_alloc(ctx, &mem_165126, bytes_165018, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            
            bool loop_cond_155399 = slt64(next_stride_155040, flat_dim_154921);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155396;
            bool loop_while_tmp_165714 = loop_cond_155399;
            int64_t stride_tmp_165717 = next_stride_155040;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155035 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155036 = loop_while_tmp_165714;
            stride_155039 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155030 = loop_dz2084Uz2082U_155035;
        data_155031 = loop_while_155036;
        data_155034 = stride_155039;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155400 = n_93618 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155401 = sle64((int64_t) 0, zs_lhs_154905);
        bool i_p_m_t_s_leq_w_155402 = slt64(zs_lhs_154905, data_155030);
        bool y_155403 = zzero_leq_i_p_m_t_s_155401 && i_p_m_t_s_leq_w_155402;
        bool ok_or_empty_155404 = empty_slice_155400 || y_155403;
        bool index_certs_155405;
        
        if (!ok_or_empty_155404) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_93618, "] out of bounds for array of shape [", (long long) data_155030, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:113:36-40\n   #6  ftRelational.fut:110:9-113:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_165137, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_93618; i_164753++) {
        int64_t eta_p_155413 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155414 = sle64((int64_t) 0, eta_p_155413);
        bool y_155415 = slt64(eta_p_155413, n_93618);
        bool bounds_check_155416 = x_155414 && y_155415;
        bool index_certs_155417;
        
        if (!bounds_check_155416) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155413, "] out of bounds for array of shape [", (long long) n_93618, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:113:36-40\n   #5  ftRelational.fut:110:9-113:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float lifted_lambda_res_155418 = ((float *) k_mem_164928.mem)[eta_p_155413];
        
        ((float *) mem_165138.mem)[i_164753] = lifted_lambda_res_155418;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165140.mem, i_164753 * b_93619, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_164929.mem, eta_p_155413 * b_93619, (int64_t []) {(int64_t) 1}, (int64_t []) {b_93619});
    }
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166223, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166224, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_166235, struct memblock *mem_out_p_166236, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_88898, int64_t b_88899)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166237 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166238 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166239 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166240 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166241 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166242 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166243 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166244 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166245 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166246 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_88898;
    bool cond_154904 = sle64(n_88898, (int64_t) 1);
    int64_t zs_lhs_154905 = sub64(n_88898, (int64_t) 1);
    int64_t zp_rhs_154906 = sdiv_safe64(zs_lhs_154905, (int64_t) 20);
    int64_t min_num_blocks_154907 = add64((int64_t) 1, zp_rhs_154906);
    bool loop_cond_154908 = slt64((int64_t) 1, min_num_blocks_154907);
    bool smallest_pow_2_geq_than_res_154909;
    int64_t smallest_pow_2_geq_than_res_154910;
    bool loop_while_154911;
    int64_t x_154912;
    
    loop_while_154911 = loop_cond_154908;
    x_154912 = (int64_t) 1;
    while (loop_while_154911) {
        int64_t loopres_154913 = mul64((int64_t) 2, x_154912);
        bool loop_cond_154914 = slt64(loopres_154913, min_num_blocks_154907);
        bool loop_while_tmp_165695 = loop_cond_154914;
        int64_t x_tmp_165696 = loopres_154913;
        
        loop_while_154911 = loop_while_tmp_165695;
        x_154912 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154909 = loop_while_154911;
    smallest_pow_2_geq_than_res_154910 = x_154912;
    
    bool zzero_154915 = smallest_pow_2_geq_than_res_154910 == (int64_t) 0;
    bool nonzzero_154916 = !zzero_154915;
    bool protect_assert_disj_154917 = cond_154904 || nonzzero_154916;
    bool nonzzero_cert_154918;
    
    if (!protect_assert_disj_154917) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154919 = sdiv_safe64(zs_lhs_154905, smallest_pow_2_geq_than_res_154910);
    int64_t block_sizze_154920 = add64((int64_t) 1, zp_rhs_154919);
    bool y_154926 = slt64((int64_t) 0, n_88898);
    bool protect_assert_disj_165536 = cond_154904 || y_154926;
    bool index_certs_154927;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_88898, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154941 = slt64(smallest_pow_2_geq_than_res_154910, (int64_t) 0);
    bool valid_154942 = !bounds_invalid_upwards_154941;
    bool protect_assert_disj_165544 = cond_154904 || valid_154942;
    bool range_valid_c_154943;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154910, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:105:36-40\n   #6  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154945 = slt64(block_sizze_154920, (int64_t) 0);
    bool valid_154946 = !bounds_invalid_upwards_154945;
    bool protect_assert_disj_165546 = cond_154904 || valid_154946;
    bool range_valid_c_154947;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154920, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154949 = sle64(block_sizze_154920, (int64_t) 1);
    int64_t tmp_154950 = sub64(block_sizze_154920, (int64_t) 2);
    bool bounds_invalid_upwards_154951 = slt64(tmp_154950, (int64_t) 0);
    bool valid_154953 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_154954 = cond_154949 || valid_154953;
    bool protect_assert_disj_165548 = cond_154904 || protect_assert_disj_154954;
    bool range_valid_c_154955;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154950, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165137 = (int64_t) 4 * n_88898;
    int64_t bytes_165139 = n_88898 * b_88899;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_88898; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154921 = smallest_pow_2_geq_than_res_154910 * block_sizze_154920;
    bool x_165531 = !cond_154904;
    int64_t greatest_divisor_leq_than_arg1_154924 = mul64((int64_t) 2, block_sizze_154920);
    int64_t merge_block_sizze_154925;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154924) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154925 = x_165533;
    } else {
        merge_block_sizze_154925 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_154928;
    
    if (x_165531) {
        int32_t x_165537 = ((int32_t *) k_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154928 = x_165537;
    } else {
        reduce_arg1_154928 = 0;
    }
    
    int32_t defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        int32_t x_165539;
        int64_t x_165540;
        int32_t redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154928;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_88898; i_164713++) {
            int32_t x_154932 = ((int32_t *) k_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154938 = sle32(redout_164711, x_154932);
            int32_t defunc_0_op_res_154939;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154939 = x_154932;
            } else {
                defunc_0_op_res_154939 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154940;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154940 = i_164713;
            } else {
                defunc_0_op_res_154940 = redout_164712;
            }
            
            int32_t redout_tmp_165699 = defunc_0_op_res_154939;
            int64_t redout_tmp_165700 = defunc_0_op_res_154940;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = 0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154952 = add64((int64_t) 1, tmp_154950);
    int64_t binop_x_164932 = (int64_t) 4 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164933 = block_sizze_154920 * binop_x_164932;
    int64_t binop_x_164935 = (int64_t) 8 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164936 = block_sizze_154920 * binop_x_164935;
    int64_t bytes_164946 = (int64_t) 4 * block_sizze_154920;
    int64_t bytes_164948 = (int64_t) 8 * block_sizze_154920;
    bool loop_cond_155027 = slt64(block_sizze_154920, flat_dim_154921);
    bool zzero_155028 = merge_block_sizze_154925 == (int64_t) 0;
    bool nonzzero_155029 = !zzero_155028;
    
    if (cond_154904) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166237 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166237, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166238 < bytes_164936) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166238, bytes_164936);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166239 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166239, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166240 < bytes_164948) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166240, bytes_164948);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154910; i_164725++) {
            int64_t zp_lhs_154959 = mul64(block_sizze_154920, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154920; i_164718++) {
                int64_t k_154963 = add64(zp_lhs_154959, i_164718);
                bool cond_154964 = slt64(k_154963, n_88898);
                int32_t lifted_lambda_res_154965;
                int64_t lifted_lambda_res_154966;
                
                if (cond_154964) {
                    bool x_157003 = sle64((int64_t) 0, k_154963);
                    bool bounds_check_157004 = cond_154964 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154963, "] out of bounds for array of shape [", (long long) n_88898, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_157006 = ((int32_t *) k_mem_164928.mem)[k_154963];
                    
                    lifted_lambda_res_154965 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154966 = k_154963;
                } else {
                    lifted_lambda_res_154965 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154966 = defunc_0_reduce_res_157151;
                }
                ((int32_t *) mem_164947)[i_164718] = lifted_lambda_res_154965;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154966;
            }
            if (!cond_154949) {
                for (int64_t i_154976 = 0; i_154976 < distance_154952; i_154976++) {
                    int64_t gt_arg1_154979 = add64((int64_t) 1, i_154976);
                    bool x_154980 = sle64((int64_t) 0, gt_arg1_154979);
                    bool y_154981 = slt64(gt_arg1_154979, block_sizze_154920);
                    bool bounds_check_154982 = x_154980 && y_154981;
                    bool index_certs_154983;
                    
                    if (!bounds_check_154982) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154979, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154985 = slt64(i_154976, block_sizze_154920);
                    bool index_certs_154986;
                    
                    if (!y_154985) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154976, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_154984 = ((int32_t *) mem_164947)[gt_arg1_154979];
                    int32_t gt_arg0_154987 = ((int32_t *) mem_164947)[i_154976];
                    bool defunc_0_leq_res_154988 = sle32(gt_arg0_154987, gt_arg1_154984);
                    bool defunc_0_lifted_gt_res_154989 = !defunc_0_leq_res_154988;
                    bool s_154990;
                    int64_t s_154993;
                    bool loop_while_154994;
                    int64_t j_154997;
                    
                    loop_while_154994 = defunc_0_lifted_gt_res_154989;
                    j_154997 = i_154976;
                    while (loop_while_154994) {
                        bool x_154998 = sle64((int64_t) 0, j_154997);
                        bool y_154999 = slt64(j_154997, block_sizze_154920);
                        bool bounds_check_155000 = x_154998 && y_154999;
                        bool index_certs_155001;
                        
                        if (!bounds_check_155000) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_154997, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155004 = add64((int64_t) 1, j_154997);
                        bool x_155005 = sle64((int64_t) 0, copy_arg0_155004);
                        bool y_155006 = slt64(copy_arg0_155004, block_sizze_154920);
                        bool bounds_check_155007 = x_155005 && y_155006;
                        bool index_certs_155008;
                        
                        if (!bounds_check_155007) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155004, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_155002 = ((int32_t *) mem_164947)[j_154997];
                        int64_t copy_arg0_155003 = ((int64_t *) mem_164949)[j_154997];
                        int32_t copy_arg0_155009 = ((int32_t *) mem_164947)[copy_arg0_155004];
                        int64_t copy_arg0_155010 = ((int64_t *) mem_164949)[copy_arg0_155004];
                        
                        ((int32_t *) mem_164947)[j_154997] = copy_arg0_155009;
                        ((int64_t *) mem_164949)[j_154997] = copy_arg0_155010;
                        ((int32_t *) mem_164947)[copy_arg0_155004] = copy_arg0_155002;
                        ((int64_t *) mem_164949)[copy_arg0_155004] = copy_arg0_155003;
                        
                        int64_t tmp_155015 = sub64(j_154997, (int64_t) 1);
                        bool cond_155016 = sle64((int64_t) 0, tmp_155015);
                        bool loop_cond_155017;
                        
                        if (cond_155016) {
                            bool y_157008 = slt64(tmp_155015, block_sizze_154920);
                            bool bounds_check_157009 = cond_155016 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155015, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_157007 = ((int32_t *) mem_164947)[j_154997];
                            int32_t gt_arg0_157011 = ((int32_t *) mem_164947)[tmp_155015];
                            bool defunc_0_leq_res_157012 = sle32(gt_arg0_157011, gt_arg1_157007);
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155017 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155017 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155017;
                        int64_t j_tmp_165710 = tmp_155015;
                        
                        loop_while_154994 = loop_while_tmp_165707;
                        j_154997 = j_tmp_165710;
                    }
                    s_154990 = loop_while_154994;
                    s_154993 = j_154997;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164934, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint32_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        if (memblock_alloc(ctx, &mem_165006, bytes_164936, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        
        int64_t data_155030;
        bool data_155031;
        int64_t data_155034;
        int64_t loop_dz2084Uz2082U_155035;
        bool loop_while_155036;
        int64_t stride_155039;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155035 = flat_dim_154921;
        loop_while_155036 = loop_cond_155027;
        stride_155039 = block_sizze_154920;
        while (loop_while_155036) {
            int64_t next_stride_155040 = mul64((int64_t) 2, stride_155039);
            bool zzero_155041 = next_stride_155040 == (int64_t) 0;
            bool nonzzero_155042 = !zzero_155041;
            bool nonzzero_cert_155043;
            
            if (!nonzzero_155042) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155044 = sdiv64(flat_dim_154921, next_stride_155040);
            bool bounds_invalid_upwards_155045 = slt64(num_merges_155044, (int64_t) 0);
            bool valid_155046 = !bounds_invalid_upwards_155045;
            bool range_valid_c_155047;
            
            if (!valid_155046) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155044, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:105:36-40\n   #6  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155049 = sub64(next_stride_155040, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155050 = sle64((int64_t) 0, m_155049);
            bool cond_155052 = slt64(next_stride_155040, (int64_t) 10);
            bool protect_assert_disj_155053 = nonzzero_155029 || cond_155052;
            bool nonzzero_cert_155054;
            
            if (!protect_assert_disj_155053) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155055 = smod_safe64(next_stride_155040, merge_block_sizze_154925);
            bool num_blocks_155056 = zeze_lhs_155055 == (int64_t) 0;
            bool protect_assert_disj_155057 = cond_155052 || num_blocks_155056;
            bool assert_c_155058;
            
            if (!protect_assert_disj_155057) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155060 = sdiv_safe64(next_stride_155040, merge_block_sizze_154925);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061 = add64((int64_t) 1, num_blocks_155060);
            int64_t j_m_i_155062 = sub64(next_stride_155040, stride_155039);
            int64_t flat_dim_155063 = merge_block_sizze_154925 * num_blocks_155060;
            bool bounds_invalid_upwards_155064 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, (int64_t) 0);
            bool empty_slice_155065 = j_m_i_155062 == (int64_t) 0;
            int64_t m_155066 = sub64(j_m_i_155062, (int64_t) 1);
            bool zzero_lte_i_155067 = sle64((int64_t) 0, stride_155039);
            bool i_lte_j_155068 = sle64(stride_155039, next_stride_155040);
            bool empty_slice_155069 = stride_155039 == (int64_t) 0;
            int64_t m_155070 = sub64(stride_155039, (int64_t) 1);
            bool bounds_invalid_upwards_155071 = slt64(num_blocks_155060, (int64_t) 0);
            bool cond_155072 = slt64((int64_t) 0, stride_155039);
            bool valid_155073 = !bounds_invalid_upwards_155064;
            int64_t i_p_m_t_s_155074 = add64(stride_155039, m_155066);
            bool zzero_leq_i_p_m_t_s_155075 = sle64((int64_t) 0, m_155070);
            bool i_p_m_t_s_leq_w_155076 = slt64(m_155070, next_stride_155040);
            bool valid_155077 = !bounds_invalid_upwards_155071;
            bool i_p_m_t_s_leq_w_155078 = slt64(m_155049, flat_dim_155063);
            bool y_155079 = slt64((int64_t) 0, j_m_i_155062);
            bool protect_assert_disj_155080 = cond_155052 || valid_155073;
            bool range_valid_c_155081;
            
            if (!protect_assert_disj_155080) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155082 = sle64((int64_t) 0, i_p_m_t_s_155074);
            bool i_p_m_t_s_leq_w_155083 = slt64(i_p_m_t_s_155074, next_stride_155040);
            bool y_155084 = zzero_leq_i_p_m_t_s_155075 && i_p_m_t_s_leq_w_155076;
            bool protect_assert_disj_155085 = cond_155052 || valid_155077;
            bool range_valid_c_155086;
            
            if (!protect_assert_disj_155085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155060, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155087 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155078;
            bool y_155088 = zzero_lte_i_155067 && i_p_m_t_s_leq_w_155083;
            bool forwards_ok_155089 = zzero_lte_i_155067 && y_155084;
            bool ok_or_empty_155090 = zzero_155041 || y_155087;
            bool protect_assert_disj_155091 = cond_155072 || y_155079;
            bool y_155092 = zzero_leq_i_p_m_t_s_155082 && y_155088;
            bool ok_or_empty_155093 = empty_slice_155069 || forwards_ok_155089;
            bool protect_assert_disj_155094 = cond_155052 || ok_or_empty_155090;
            bool index_certs_155095;
            
            if (!protect_assert_disj_155094) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) flat_dim_155063, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155096 = !cond_155052;
            bool protect_assert_disj_155097 = protect_assert_disj_155091 || loop_not_taken_155096;
            bool index_certs_155098;
            
            if (!protect_assert_disj_155097) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155099 = i_lte_j_155068 && y_155092;
            bool protect_assert_disj_155100 = cond_155052 || ok_or_empty_155093;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155102 = ok_or_empty_155093 || loop_not_taken_155096;
            bool index_certs_155103;
            
            if (!protect_assert_disj_155102) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155104 = empty_slice_155065 || forwards_ok_155099;
            bool protect_assert_disj_155105 = cond_155052 || ok_or_empty_155104;
            bool index_certs_155106;
            
            if (!protect_assert_disj_155105) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155107 = loop_not_taken_155096 || ok_or_empty_155104;
            bool index_certs_155108;
            
            if (!protect_assert_disj_155107) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 4 * num_merges_155044;
            int64_t bytes_165015 = next_stride_155040 * binop_x_165014;
            int64_t binop_x_165017 = (int64_t) 8 * num_merges_155044;
            int64_t bytes_165018 = next_stride_155040 * binop_x_165017;
            bool i_lte_j_155051 = sle64((int64_t) 0, next_stride_155040);
            
            if (mem_165016_cached_sizze_166241 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166241, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166242 < bytes_165018) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166242, bytes_165018);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061;
            int64_t binop_x_165044 = (int64_t) 4 * num_blocks_155060;
            int64_t bytes_165045 = merge_block_sizze_154925 * binop_x_165044;
            int64_t binop_x_165047 = (int64_t) 8 * num_blocks_155060;
            int64_t bytes_165048 = merge_block_sizze_154925 * binop_x_165047;
            int64_t bytes_165090 = (int64_t) 8 * stride_155039;
            int64_t bytes_165092 = (int64_t) 16 * stride_155039;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155044; i_164746++) {
                int64_t start_155112 = mul64(next_stride_155040, i_164746);
                int64_t j_m_i_155113 = sub64(loop_dz2084Uz2082U_155035, start_155112);
                bool empty_slice_155114 = j_m_i_155113 == (int64_t) 0;
                int64_t m_155115 = sub64(j_m_i_155113, (int64_t) 1);
                int64_t i_p_m_t_s_155116 = add64(start_155112, m_155115);
                bool zzero_leq_i_p_m_t_s_155117 = sle64((int64_t) 0, i_p_m_t_s_155116);
                bool i_p_m_t_s_leq_w_155118 = slt64(i_p_m_t_s_155116, loop_dz2084Uz2082U_155035);
                bool zzero_lte_i_155119 = sle64((int64_t) 0, start_155112);
                bool i_lte_j_155120 = sle64(start_155112, loop_dz2084Uz2082U_155035);
                bool y_155121 = i_p_m_t_s_leq_w_155118 && zzero_lte_i_155119;
                bool y_155122 = zzero_leq_i_p_m_t_s_155117 && y_155121;
                bool forwards_ok_155123 = i_lte_j_155120 && y_155122;
                bool ok_or_empty_155124 = empty_slice_155114 || forwards_ok_155123;
                bool index_certs_155125;
                
                if (!ok_or_empty_155124) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155112, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155035, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155126 = slt64(m_155049, j_m_i_155113);
                bool y_155127 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155126;
                bool forwards_ok_155128 = i_lte_j_155051 && y_155127;
                bool ok_or_empty_155129 = zzero_155041 || forwards_ok_155128;
                bool index_certs_155130;
                
                if (!ok_or_empty_155129) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) j_m_i_155113, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:105:36-40\n   #8  ftRelational.fut:102:9-105:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155052) {
                    int32_t dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155072) {
                        int32_t head_res_157041 = ((int32_t *) mem_param_165010.mem)[start_155112];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155112];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155039 + start_155112;
                        int32_t head_res_157044 = ((int32_t *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155040; nest_i_165720++) {
                        ((int32_t *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165092, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155040; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155040; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155062;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155039);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155062);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155039 + j_157055;
                                int64_t slice_157065 = start_155112 + slice_157064;
                                int32_t leq_arg1_157066 = ((int32_t *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155112 + i_157052;
                                int32_t leq_arg0_157071 = ((int32_t *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = sle32(leq_arg0_157071, leq_arg1_157066);
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        int32_t loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155039);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155112 + i_157052;
                            int32_t tmp_157082 = ((int32_t *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155062);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:105:36-40\n   #9  ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155039 + j_157055;
                            int64_t slice_157089 = start_155112 + slice_157088;
                            int32_t tmp_157090 = ((int32_t *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((int32_t *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166243 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166243, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166244 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166244, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061; i_164732++) {
                        int64_t split_count_arg3_155192 = mul64(merge_block_sizze_154925, i_164732);
                        int64_t defunc_0_split_count_res_155193;
                        int64_t defunc_0_split_count_res_155194;
                        int64_t defunc_0_split_count_res_155195;
                        int64_t defunc_0_split_count_res_155196;
                        int64_t defunc_0_split_count_res_155197;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155193, &defunc_0_split_count_res_155194, &defunc_0_split_count_res_155195, &defunc_0_split_count_res_155196, &defunc_0_split_count_res_155197, (int64_t) 0, stride_155039, (int64_t) 0, j_m_i_155062, split_count_arg3_155192) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155198 = slt64((int64_t) 0, defunc_0_split_count_res_155197);
                        bool defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        int64_t defunc_0_split_count_res_155204;
                        bool loop_while_155205;
                        int64_t ss_155206;
                        int64_t ss_155207;
                        int64_t tt_155208;
                        int64_t tt_155209;
                        int64_t count_155210;
                        
                        loop_while_155205 = loop_cond_155198;
                        ss_155206 = defunc_0_split_count_res_155193;
                        ss_155207 = defunc_0_split_count_res_155194;
                        tt_155208 = defunc_0_split_count_res_155195;
                        tt_155209 = defunc_0_split_count_res_155196;
                        count_155210 = defunc_0_split_count_res_155197;
                        while (loop_while_155205) {
                            int64_t zlze_lhs_155211 = sub64(ss_155207, ss_155206);
                            bool cond_155212 = sle64(zlze_lhs_155211, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155213;
                            int64_t defunc_0_lifted_step_res_155214;
                            int64_t defunc_0_lifted_step_res_155215;
                            int64_t defunc_0_lifted_step_res_155216;
                            
                            if (cond_155212) {
                                int64_t tmp_157094 = add64(tt_155208, count_155210);
                                
                                defunc_0_lifted_step_res_155213 = ss_155206;
                                defunc_0_lifted_step_res_155214 = tmp_157094;
                                defunc_0_lifted_step_res_155215 = tt_155209;
                                defunc_0_lifted_step_res_155216 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155218 = sub64(tt_155209, tt_155208);
                                bool cond_155219 = sle64(zlze_lhs_155218, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155220;
                                int64_t defunc_0_lifted_step_res_f_res_155221;
                                int64_t defunc_0_lifted_step_res_f_res_155222;
                                int64_t defunc_0_lifted_step_res_f_res_155223;
                                
                                if (cond_155219) {
                                    int64_t tmp_157095 = add64(ss_155206, count_155210);
                                    
                                    defunc_0_lifted_step_res_f_res_155220 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155221 = tt_155208;
                                    defunc_0_lifted_step_res_f_res_155222 = tt_155209;
                                    defunc_0_lifted_step_res_f_res_155223 = (int64_t) 0;
                                } else {
                                    bool cond_155225 = count_155210 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155226;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155227;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155228;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155229;
                                    
                                    if (cond_155225) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155206);
                                        bool y_157098 = slt64(ss_155206, stride_155039);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155206, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155208);
                                        bool y_157104 = slt64(tt_155208, j_m_i_155062);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155208, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155112 + ss_155206;
                                        int32_t leq_arg1_157102 = ((int32_t *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155039 + tt_155208;
                                        int64_t slice_157108 = start_155112 + slice_157107;
                                        int32_t leq_arg0_157109 = ((int32_t *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = sle32(leq_arg0_157109, leq_arg1_157102);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155208);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155206;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155206);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155208;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = tt_155209;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = (int64_t) 0;
                                    } else {
                                        int64_t m_155248 = sdiv64(count_155210, (int64_t) 2);
                                        int64_t n_155249 = sub64(count_155210, m_155248);
                                        bool cond_155250 = n_155249 == (int64_t) 0;
                                        int64_t zgze_lhs_155251 = add64(ss_155206, m_155248);
                                        bool cond_f_res_155252 = sle64(ss_155207, zgze_lhs_155251);
                                        bool x_155253 = !cond_155250;
                                        bool y_155254 = cond_f_res_155252 && x_155253;
                                        bool cond_155255 = cond_155250 || y_155254;
                                        bool leq_y_x_155256;
                                        
                                        if (cond_155255) {
                                            leq_y_x_155256 = 1;
                                        } else {
                                            bool x_155257 = sle64((int64_t) 0, zgze_lhs_155251);
                                            bool y_155258 = slt64(zgze_lhs_155251, stride_155039);
                                            bool bounds_check_155259 = x_155257 && y_155258;
                                            bool index_certs_155260;
                                            
                                            if (!bounds_check_155259) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155251, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155263 = add64(tt_155208, n_155249);
                                            int64_t leq_arg0_155264 = sub64(zm_lhs_155263, (int64_t) 1);
                                            bool x_155265 = sle64((int64_t) 0, leq_arg0_155264);
                                            bool y_155266 = slt64(leq_arg0_155264, j_m_i_155062);
                                            bool bounds_check_155267 = x_155265 && y_155266;
                                            bool index_certs_155268;
                                            
                                            if (!bounds_check_155267) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155264, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:105:36-40\n   #13 ftRelational.fut:102:9-105:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155261 = start_155112 + zgze_lhs_155251;
                                            int32_t leq_arg1_155262 = ((int32_t *) mem_param_165010.mem)[slice_155261];
                                            int64_t slice_155269 = stride_155039 + leq_arg0_155264;
                                            int64_t slice_155270 = start_155112 + slice_155269;
                                            int32_t leq_arg0_155271 = ((int32_t *) mem_param_165010.mem)[slice_155270];
                                            bool defunc_0_leq_res_155272 = sle32(leq_arg0_155271, leq_arg1_155262);
                                            
                                            leq_y_x_155256 = defunc_0_leq_res_155272;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                        
                                        if (leq_y_x_155256) {
                                            int64_t tmp_157115 = add64(tt_155208, n_155249);
                                            int64_t tmp_157116 = sub64(count_155210, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tt_155209;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = tmp_157116;
                                        } else {
                                            int64_t tmp_155278 = add64(tt_155208, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tt_155208;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tmp_155278;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = count_155210;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = ss_155206;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                    }
                                    defunc_0_lifted_step_res_f_res_155220 = defunc_0_lifted_step_res_f_res_f_res_155226;
                                    defunc_0_lifted_step_res_f_res_155221 = defunc_0_lifted_step_res_f_res_f_res_155227;
                                    defunc_0_lifted_step_res_f_res_155222 = defunc_0_lifted_step_res_f_res_f_res_155228;
                                    defunc_0_lifted_step_res_f_res_155223 = defunc_0_lifted_step_res_f_res_f_res_155229;
                                }
                                defunc_0_lifted_step_res_155213 = defunc_0_lifted_step_res_f_res_155220;
                                defunc_0_lifted_step_res_155214 = defunc_0_lifted_step_res_f_res_155221;
                                defunc_0_lifted_step_res_155215 = defunc_0_lifted_step_res_f_res_155222;
                                defunc_0_lifted_step_res_155216 = defunc_0_lifted_step_res_f_res_155223;
                            }
                            
                            int64_t loopres_155279;
                            int64_t loopres_155280;
                            int64_t loopres_155281;
                            int64_t loopres_155282;
                            int64_t loopres_155283;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155279, &loopres_155280, &loopres_155281, &loopres_155282, &loopres_155283, defunc_0_lifted_step_res_155213, ss_155207, defunc_0_lifted_step_res_155214, defunc_0_lifted_step_res_155215, defunc_0_lifted_step_res_155216) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155284 = slt64((int64_t) 0, loopres_155283);
                            bool loop_while_tmp_165727 = loop_cond_155284;
                            int64_t ss_tmp_165728 = loopres_155279;
                            int64_t ss_tmp_165729 = loopres_155280;
                            int64_t tt_tmp_165730 = loopres_155281;
                            int64_t tt_tmp_165731 = loopres_155282;
                            int64_t count_tmp_165732 = loopres_155283;
                            
                            loop_while_155205 = loop_while_tmp_165727;
                            ss_155206 = ss_tmp_165728;
                            ss_155207 = ss_tmp_165729;
                            tt_155208 = tt_tmp_165730;
                            tt_155209 = tt_tmp_165731;
                            count_155210 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155199 = loop_while_155205;
                        defunc_0_split_count_res_155200 = ss_155206;
                        defunc_0_split_count_res_155201 = ss_155207;
                        defunc_0_split_count_res_155202 = tt_155208;
                        defunc_0_split_count_res_155203 = tt_155209;
                        defunc_0_split_count_res_155204 = count_155210;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155200;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155202;
                    }
                    if (mem_165046_cached_sizze_166245 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166245, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166246 < bytes_165048) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166246, bytes_165048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155060; i_164739++) {
                        bool y_155290 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool index_certs_155292;
                        
                        if (!y_155290) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155293 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155294 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155295 = add64((int64_t) 1, i_164739);
                        bool x_155296 = sle64((int64_t) 0, tmp_155295);
                        bool y_155297 = slt64(tmp_155295, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool bounds_check_155298 = x_155296 && y_155297;
                        bool index_certs_155299;
                        
                        if (!bounds_check_155298) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155295, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165029)[tmp_155295];
                        int64_t defunc_0_f_res_155301 = ((int64_t *) mem_165031)[tmp_155295];
                        int64_t merge_sequential_arg2_155302 = add64(stride_155039, defunc_0_f_res_155294);
                        int64_t merge_sequential_arg2_155303 = add64(stride_155039, defunc_0_f_res_155301);
                        int64_t j_m_i_155304 = sub64(merge_sequential_arg2_155303, merge_sequential_arg2_155302);
                        bool empty_slice_155305 = j_m_i_155304 == (int64_t) 0;
                        int64_t m_155306 = sub64(j_m_i_155304, (int64_t) 1);
                        int64_t i_p_m_t_s_155307 = add64(merge_sequential_arg2_155302, m_155306);
                        bool zzero_leq_i_p_m_t_s_155308 = sle64((int64_t) 0, i_p_m_t_s_155307);
                        bool i_p_m_t_s_leq_w_155309 = slt64(i_p_m_t_s_155307, next_stride_155040);
                        bool zzero_lte_i_155310 = sle64((int64_t) 0, merge_sequential_arg2_155302);
                        bool i_lte_j_155311 = sle64(merge_sequential_arg2_155302, merge_sequential_arg2_155303);
                        bool y_155312 = i_p_m_t_s_leq_w_155309 && zzero_lte_i_155310;
                        bool y_155313 = zzero_leq_i_p_m_t_s_155308 && y_155312;
                        bool forwards_ok_155314 = i_lte_j_155311 && y_155313;
                        bool ok_or_empty_155315 = empty_slice_155305 || forwards_ok_155314;
                        bool index_certs_155316;
                        
                        if (!ok_or_empty_155315) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155302, ":", (long long) merge_sequential_arg2_155303, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155317 = sub64(defunc_0_f_res_155300, defunc_0_f_res_155293);
                        bool empty_slice_155318 = j_m_i_155317 == (int64_t) 0;
                        int64_t m_155319 = sub64(j_m_i_155317, (int64_t) 1);
                        int64_t i_p_m_t_s_155320 = add64(defunc_0_f_res_155293, m_155319);
                        bool zzero_leq_i_p_m_t_s_155321 = sle64((int64_t) 0, i_p_m_t_s_155320);
                        bool i_p_m_t_s_leq_w_155322 = slt64(i_p_m_t_s_155320, next_stride_155040);
                        bool zzero_lte_i_155323 = sle64((int64_t) 0, defunc_0_f_res_155293);
                        bool i_lte_j_155324 = sle64(defunc_0_f_res_155293, defunc_0_f_res_155300);
                        bool y_155325 = i_p_m_t_s_leq_w_155322 && zzero_lte_i_155323;
                        bool y_155326 = zzero_leq_i_p_m_t_s_155321 && y_155325;
                        bool forwards_ok_155327 = i_lte_j_155324 && y_155326;
                        bool ok_or_empty_155328 = empty_slice_155318 || forwards_ok_155327;
                        bool index_certs_155329;
                        
                        if (!ok_or_empty_155328) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155293, ":", (long long) defunc_0_f_res_155300, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:105:36-40\n   #10 ftRelational.fut:102:9-105:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155330 = slt64((int64_t) 0, j_m_i_155317);
                        int32_t dummy_155331;
                        int64_t dummy_155332;
                        
                        if (cond_155330) {
                            bool index_certs_157117;
                            
                            if (!cond_155330) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:105:36-40\n   #12 ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155112 + defunc_0_f_res_155293;
                            int32_t head_res_157119 = ((int32_t *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155331 = head_res_157119;
                            dummy_155332 = head_res_157120;
                        } else {
                            bool y_155337 = slt64((int64_t) 0, j_m_i_155304);
                            bool index_certs_155338;
                            
                            if (!y_155337) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:105:36-40\n   #12 ftRelational.fut:102:9-105:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155339 = start_155112 + merge_sequential_arg2_155302;
                            int32_t head_res_155340 = ((int32_t *) mem_param_165010.mem)[slice_155339];
                            int64_t head_res_155341 = ((int64_t *) mem_param_165013.mem)[slice_155339];
                            
                            dummy_155331 = head_res_155340;
                            dummy_155332 = head_res_155341;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154925; nest_i_165735++) {
                            ((int32_t *) mem_165046)[i_164739 * merge_block_sizze_154925 + nest_i_165735] = dummy_155331;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154925; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + nest_i_165736] = dummy_155332;
                        }
                        
                        int64_t data_155344;
                        int64_t i_155348 = (int64_t) 0;
                        
                        for (int64_t k_155347 = 0; k_155347 < merge_block_sizze_154925; k_155347++) {
                            int64_t j_155351 = sub64(k_155347, i_155348);
                            bool cond_155352 = j_155351 == j_m_i_155304;
                            bool cond_155353;
                            
                            if (cond_155352) {
                                cond_155353 = 1;
                            } else {
                                bool cond_155354 = slt64(i_155348, j_m_i_155317);
                                bool cond_f_res_155355;
                                
                                if (cond_155354) {
                                    bool x_157121 = sle64((int64_t) 0, j_155351);
                                    bool y_157122 = slt64(j_155351, j_m_i_155304);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155348);
                                    bool bounds_check_157129 = cond_155354 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155302 + j_155351;
                                    int64_t slice_157126 = start_155112 + slice_157125;
                                    int32_t leq_arg1_157127 = ((int32_t *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155293 + i_155348;
                                    int64_t slice_157132 = start_155112 + slice_157131;
                                    int32_t leq_arg0_157133 = ((int32_t *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = sle32(leq_arg0_157133, leq_arg1_157127);
                                    
                                    cond_f_res_155355 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155355 = 0;
                                }
                                cond_155353 = cond_f_res_155355;
                            }
                            
                            int64_t loopres_155370;
                            int32_t loopres_155371;
                            int64_t loopres_155372;
                            
                            if (cond_155353) {
                                bool x_157136 = sle64((int64_t) 0, i_155348);
                                bool y_157137 = slt64(i_155348, j_m_i_155317);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155348);
                                int64_t slice_157140 = defunc_0_f_res_155293 + i_155348;
                                int64_t slice_157141 = start_155112 + slice_157140;
                                int32_t tmp_157142 = ((int32_t *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155370 = tmp_157135;
                                loopres_155371 = tmp_157142;
                                loopres_155372 = tmp_157143;
                            } else {
                                bool x_155382 = sle64((int64_t) 0, j_155351);
                                bool y_155383 = slt64(j_155351, j_m_i_155304);
                                bool bounds_check_155384 = x_155382 && y_155383;
                                bool index_certs_155385;
                                
                                if (!bounds_check_155384) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:105:36-40\n   #11 ftRelational.fut:102:9-105:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155386 = merge_sequential_arg2_155302 + j_155351;
                                int64_t slice_155387 = start_155112 + slice_155386;
                                int32_t tmp_155388 = ((int32_t *) mem_param_165010.mem)[slice_155387];
                                int64_t tmp_155389 = ((int64_t *) mem_param_165013.mem)[slice_155387];
                                
                                loopres_155370 = i_155348;
                                loopres_155371 = tmp_155388;
                                loopres_155372 = tmp_155389;
                            }
                            ((int32_t *) mem_165046)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155371;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155372;
                            
                            int64_t i_tmp_165737 = loopres_155370;
                            
                            i_155348 = i_tmp_165737;
                        }
                        data_155344 = i_155348;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint32_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165048, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_165016, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155396 = next_stride_155040 * num_merges_155044;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint32_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            if (memblock_alloc(ctx, &mem_165126, bytes_165018, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            
            bool loop_cond_155399 = slt64(next_stride_155040, flat_dim_154921);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155396;
            bool loop_while_tmp_165714 = loop_cond_155399;
            int64_t stride_tmp_165717 = next_stride_155040;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155035 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155036 = loop_while_tmp_165714;
            stride_155039 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155030 = loop_dz2084Uz2082U_155035;
        data_155031 = loop_while_155036;
        data_155034 = stride_155039;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155400 = n_88898 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155401 = sle64((int64_t) 0, zs_lhs_154905);
        bool i_p_m_t_s_leq_w_155402 = slt64(zs_lhs_154905, data_155030);
        bool y_155403 = zzero_leq_i_p_m_t_s_155401 && i_p_m_t_s_leq_w_155402;
        bool ok_or_empty_155404 = empty_slice_155400 || y_155403;
        bool index_certs_155405;
        
        if (!ok_or_empty_155404) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_88898, "] out of bounds for array of shape [", (long long) data_155030, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:105:36-40\n   #6  ftRelational.fut:102:9-105:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_165137, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_88898; i_164753++) {
        int64_t eta_p_155413 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155414 = sle64((int64_t) 0, eta_p_155413);
        bool y_155415 = slt64(eta_p_155413, n_88898);
        bool bounds_check_155416 = x_155414 && y_155415;
        bool index_certs_155417;
        
        if (!bounds_check_155416) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155413, "] out of bounds for array of shape [", (long long) n_88898, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:105:36-40\n   #5  ftRelational.fut:102:9-105:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t lifted_lambda_res_155418 = ((int32_t *) k_mem_164928.mem)[eta_p_155413];
        
        ((int32_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155418;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165140.mem, i_164753 * b_88899, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_164929.mem, eta_p_155413 * b_88899, (int64_t []) {(int64_t) 1}, (int64_t []) {b_88899});
    }
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166235, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166236, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_166247, struct memblock *mem_out_p_166248, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_91253, int64_t b_91254)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166249 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166250 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166251 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166252 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166253 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166254 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166255 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166256 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166257 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166258 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_91253;
    bool cond_154904 = sle64(n_91253, (int64_t) 1);
    int64_t zs_lhs_154905 = sub64(n_91253, (int64_t) 1);
    int64_t zp_rhs_154906 = sdiv_safe64(zs_lhs_154905, (int64_t) 20);
    int64_t min_num_blocks_154907 = add64((int64_t) 1, zp_rhs_154906);
    bool loop_cond_154908 = slt64((int64_t) 1, min_num_blocks_154907);
    bool smallest_pow_2_geq_than_res_154909;
    int64_t smallest_pow_2_geq_than_res_154910;
    bool loop_while_154911;
    int64_t x_154912;
    
    loop_while_154911 = loop_cond_154908;
    x_154912 = (int64_t) 1;
    while (loop_while_154911) {
        int64_t loopres_154913 = mul64((int64_t) 2, x_154912);
        bool loop_cond_154914 = slt64(loopres_154913, min_num_blocks_154907);
        bool loop_while_tmp_165695 = loop_cond_154914;
        int64_t x_tmp_165696 = loopres_154913;
        
        loop_while_154911 = loop_while_tmp_165695;
        x_154912 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154909 = loop_while_154911;
    smallest_pow_2_geq_than_res_154910 = x_154912;
    
    bool zzero_154915 = smallest_pow_2_geq_than_res_154910 == (int64_t) 0;
    bool nonzzero_154916 = !zzero_154915;
    bool protect_assert_disj_154917 = cond_154904 || nonzzero_154916;
    bool nonzzero_cert_154918;
    
    if (!protect_assert_disj_154917) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154919 = sdiv_safe64(zs_lhs_154905, smallest_pow_2_geq_than_res_154910);
    int64_t block_sizze_154920 = add64((int64_t) 1, zp_rhs_154919);
    bool y_154926 = slt64((int64_t) 0, n_91253);
    bool protect_assert_disj_165536 = cond_154904 || y_154926;
    bool index_certs_154927;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_91253, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154941 = slt64(smallest_pow_2_geq_than_res_154910, (int64_t) 0);
    bool valid_154942 = !bounds_invalid_upwards_154941;
    bool protect_assert_disj_165544 = cond_154904 || valid_154942;
    bool range_valid_c_154943;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154910, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:109:36-40\n   #6  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154945 = slt64(block_sizze_154920, (int64_t) 0);
    bool valid_154946 = !bounds_invalid_upwards_154945;
    bool protect_assert_disj_165546 = cond_154904 || valid_154946;
    bool range_valid_c_154947;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154920, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154949 = sle64(block_sizze_154920, (int64_t) 1);
    int64_t tmp_154950 = sub64(block_sizze_154920, (int64_t) 2);
    bool bounds_invalid_upwards_154951 = slt64(tmp_154950, (int64_t) 0);
    bool valid_154953 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_154954 = cond_154949 || valid_154953;
    bool protect_assert_disj_165548 = cond_154904 || protect_assert_disj_154954;
    bool range_valid_c_154955;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154950, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165139 = n_91253 * b_91254;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_91253; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154921 = smallest_pow_2_geq_than_res_154910 * block_sizze_154920;
    bool x_165531 = !cond_154904;
    int64_t greatest_divisor_leq_than_arg1_154924 = mul64((int64_t) 2, block_sizze_154920);
    int64_t merge_block_sizze_154925;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154924) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154925 = x_165533;
    } else {
        merge_block_sizze_154925 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_154928;
    
    if (x_165531) {
        int64_t x_165537 = ((int64_t *) k_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154928 = x_165537;
    } else {
        reduce_arg1_154928 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        int64_t x_165539;
        int64_t x_165540;
        int64_t redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154928;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_91253; i_164713++) {
            int64_t x_154932 = ((int64_t *) k_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154938 = sle64(redout_164711, x_154932);
            int64_t defunc_0_op_res_154939;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154939 = x_154932;
            } else {
                defunc_0_op_res_154939 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154940;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154940 = i_164713;
            } else {
                defunc_0_op_res_154940 = redout_164712;
            }
            
            int64_t redout_tmp_165699 = defunc_0_op_res_154939;
            int64_t redout_tmp_165700 = defunc_0_op_res_154940;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = (int64_t) 0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154952 = add64((int64_t) 1, tmp_154950);
    int64_t binop_x_164932 = (int64_t) 8 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164933 = block_sizze_154920 * binop_x_164932;
    int64_t bytes_164946 = (int64_t) 8 * block_sizze_154920;
    bool loop_cond_155027 = slt64(block_sizze_154920, flat_dim_154921);
    bool zzero_155028 = merge_block_sizze_154925 == (int64_t) 0;
    bool nonzzero_155029 = !zzero_155028;
    
    if (cond_154904) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166249 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166249, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166250 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166250, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166251 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166251, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166252 < bytes_164946) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166252, bytes_164946);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154910; i_164725++) {
            int64_t zp_lhs_154959 = mul64(block_sizze_154920, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154920; i_164718++) {
                int64_t k_154963 = add64(zp_lhs_154959, i_164718);
                bool cond_154964 = slt64(k_154963, n_91253);
                int64_t lifted_lambda_res_154965;
                int64_t lifted_lambda_res_154966;
                
                if (cond_154964) {
                    bool x_157003 = sle64((int64_t) 0, k_154963);
                    bool bounds_check_157004 = cond_154964 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154963, "] out of bounds for array of shape [", (long long) n_91253, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_157006 = ((int64_t *) k_mem_164928.mem)[k_154963];
                    
                    lifted_lambda_res_154965 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154966 = k_154963;
                } else {
                    lifted_lambda_res_154965 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154966 = defunc_0_reduce_res_157151;
                }
                ((int64_t *) mem_164947)[i_164718] = lifted_lambda_res_154965;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154966;
            }
            if (!cond_154949) {
                for (int64_t i_154976 = 0; i_154976 < distance_154952; i_154976++) {
                    int64_t gt_arg1_154979 = add64((int64_t) 1, i_154976);
                    bool x_154980 = sle64((int64_t) 0, gt_arg1_154979);
                    bool y_154981 = slt64(gt_arg1_154979, block_sizze_154920);
                    bool bounds_check_154982 = x_154980 && y_154981;
                    bool index_certs_154983;
                    
                    if (!bounds_check_154982) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154979, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154985 = slt64(i_154976, block_sizze_154920);
                    bool index_certs_154986;
                    
                    if (!y_154985) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154976, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_154984 = ((int64_t *) mem_164947)[gt_arg1_154979];
                    int64_t gt_arg0_154987 = ((int64_t *) mem_164947)[i_154976];
                    bool defunc_0_leq_res_154988 = sle64(gt_arg0_154987, gt_arg1_154984);
                    bool defunc_0_lifted_gt_res_154989 = !defunc_0_leq_res_154988;
                    bool s_154990;
                    int64_t s_154993;
                    bool loop_while_154994;
                    int64_t j_154997;
                    
                    loop_while_154994 = defunc_0_lifted_gt_res_154989;
                    j_154997 = i_154976;
                    while (loop_while_154994) {
                        bool x_154998 = sle64((int64_t) 0, j_154997);
                        bool y_154999 = slt64(j_154997, block_sizze_154920);
                        bool bounds_check_155000 = x_154998 && y_154999;
                        bool index_certs_155001;
                        
                        if (!bounds_check_155000) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_154997, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155004 = add64((int64_t) 1, j_154997);
                        bool x_155005 = sle64((int64_t) 0, copy_arg0_155004);
                        bool y_155006 = slt64(copy_arg0_155004, block_sizze_154920);
                        bool bounds_check_155007 = x_155005 && y_155006;
                        bool index_certs_155008;
                        
                        if (!bounds_check_155007) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155004, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155002 = ((int64_t *) mem_164947)[j_154997];
                        int64_t copy_arg0_155003 = ((int64_t *) mem_164949)[j_154997];
                        int64_t copy_arg0_155009 = ((int64_t *) mem_164947)[copy_arg0_155004];
                        int64_t copy_arg0_155010 = ((int64_t *) mem_164949)[copy_arg0_155004];
                        
                        ((int64_t *) mem_164947)[j_154997] = copy_arg0_155009;
                        ((int64_t *) mem_164949)[j_154997] = copy_arg0_155010;
                        ((int64_t *) mem_164947)[copy_arg0_155004] = copy_arg0_155002;
                        ((int64_t *) mem_164949)[copy_arg0_155004] = copy_arg0_155003;
                        
                        int64_t tmp_155015 = sub64(j_154997, (int64_t) 1);
                        bool cond_155016 = sle64((int64_t) 0, tmp_155015);
                        bool loop_cond_155017;
                        
                        if (cond_155016) {
                            bool y_157008 = slt64(tmp_155015, block_sizze_154920);
                            bool bounds_check_157009 = cond_155016 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155015, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_157007 = ((int64_t *) mem_164947)[j_154997];
                            int64_t gt_arg0_157011 = ((int64_t *) mem_164947)[tmp_155015];
                            bool defunc_0_leq_res_157012 = sle64(gt_arg0_157011, gt_arg1_157007);
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155017 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155017 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155017;
                        int64_t j_tmp_165710 = tmp_155015;
                        
                        loop_while_154994 = loop_while_tmp_165707;
                        j_154997 = j_tmp_165710;
                    }
                    s_154990 = loop_while_154994;
                    s_154993 = j_154997;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164934, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        if (memblock_alloc(ctx, &mem_165006, bytes_164933, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        
        int64_t data_155030;
        bool data_155031;
        int64_t data_155034;
        int64_t loop_dz2084Uz2082U_155035;
        bool loop_while_155036;
        int64_t stride_155039;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155035 = flat_dim_154921;
        loop_while_155036 = loop_cond_155027;
        stride_155039 = block_sizze_154920;
        while (loop_while_155036) {
            int64_t next_stride_155040 = mul64((int64_t) 2, stride_155039);
            bool zzero_155041 = next_stride_155040 == (int64_t) 0;
            bool nonzzero_155042 = !zzero_155041;
            bool nonzzero_cert_155043;
            
            if (!nonzzero_155042) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155044 = sdiv64(flat_dim_154921, next_stride_155040);
            bool bounds_invalid_upwards_155045 = slt64(num_merges_155044, (int64_t) 0);
            bool valid_155046 = !bounds_invalid_upwards_155045;
            bool range_valid_c_155047;
            
            if (!valid_155046) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155044, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:109:36-40\n   #6  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155049 = sub64(next_stride_155040, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155050 = sle64((int64_t) 0, m_155049);
            bool cond_155052 = slt64(next_stride_155040, (int64_t) 10);
            bool protect_assert_disj_155053 = nonzzero_155029 || cond_155052;
            bool nonzzero_cert_155054;
            
            if (!protect_assert_disj_155053) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155055 = smod_safe64(next_stride_155040, merge_block_sizze_154925);
            bool num_blocks_155056 = zeze_lhs_155055 == (int64_t) 0;
            bool protect_assert_disj_155057 = cond_155052 || num_blocks_155056;
            bool assert_c_155058;
            
            if (!protect_assert_disj_155057) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155060 = sdiv_safe64(next_stride_155040, merge_block_sizze_154925);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061 = add64((int64_t) 1, num_blocks_155060);
            int64_t j_m_i_155062 = sub64(next_stride_155040, stride_155039);
            int64_t flat_dim_155063 = merge_block_sizze_154925 * num_blocks_155060;
            bool bounds_invalid_upwards_155064 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, (int64_t) 0);
            bool empty_slice_155065 = j_m_i_155062 == (int64_t) 0;
            int64_t m_155066 = sub64(j_m_i_155062, (int64_t) 1);
            bool zzero_lte_i_155067 = sle64((int64_t) 0, stride_155039);
            bool i_lte_j_155068 = sle64(stride_155039, next_stride_155040);
            bool empty_slice_155069 = stride_155039 == (int64_t) 0;
            int64_t m_155070 = sub64(stride_155039, (int64_t) 1);
            bool bounds_invalid_upwards_155071 = slt64(num_blocks_155060, (int64_t) 0);
            bool cond_155072 = slt64((int64_t) 0, stride_155039);
            bool valid_155073 = !bounds_invalid_upwards_155064;
            int64_t i_p_m_t_s_155074 = add64(stride_155039, m_155066);
            bool zzero_leq_i_p_m_t_s_155075 = sle64((int64_t) 0, m_155070);
            bool i_p_m_t_s_leq_w_155076 = slt64(m_155070, next_stride_155040);
            bool valid_155077 = !bounds_invalid_upwards_155071;
            bool i_p_m_t_s_leq_w_155078 = slt64(m_155049, flat_dim_155063);
            bool y_155079 = slt64((int64_t) 0, j_m_i_155062);
            bool protect_assert_disj_155080 = cond_155052 || valid_155073;
            bool range_valid_c_155081;
            
            if (!protect_assert_disj_155080) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155082 = sle64((int64_t) 0, i_p_m_t_s_155074);
            bool i_p_m_t_s_leq_w_155083 = slt64(i_p_m_t_s_155074, next_stride_155040);
            bool y_155084 = zzero_leq_i_p_m_t_s_155075 && i_p_m_t_s_leq_w_155076;
            bool protect_assert_disj_155085 = cond_155052 || valid_155077;
            bool range_valid_c_155086;
            
            if (!protect_assert_disj_155085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155060, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155087 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155078;
            bool y_155088 = zzero_lte_i_155067 && i_p_m_t_s_leq_w_155083;
            bool forwards_ok_155089 = zzero_lte_i_155067 && y_155084;
            bool ok_or_empty_155090 = zzero_155041 || y_155087;
            bool protect_assert_disj_155091 = cond_155072 || y_155079;
            bool y_155092 = zzero_leq_i_p_m_t_s_155082 && y_155088;
            bool ok_or_empty_155093 = empty_slice_155069 || forwards_ok_155089;
            bool protect_assert_disj_155094 = cond_155052 || ok_or_empty_155090;
            bool index_certs_155095;
            
            if (!protect_assert_disj_155094) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) flat_dim_155063, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155096 = !cond_155052;
            bool protect_assert_disj_155097 = protect_assert_disj_155091 || loop_not_taken_155096;
            bool index_certs_155098;
            
            if (!protect_assert_disj_155097) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155099 = i_lte_j_155068 && y_155092;
            bool protect_assert_disj_155100 = cond_155052 || ok_or_empty_155093;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155102 = ok_or_empty_155093 || loop_not_taken_155096;
            bool index_certs_155103;
            
            if (!protect_assert_disj_155102) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155104 = empty_slice_155065 || forwards_ok_155099;
            bool protect_assert_disj_155105 = cond_155052 || ok_or_empty_155104;
            bool index_certs_155106;
            
            if (!protect_assert_disj_155105) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155107 = loop_not_taken_155096 || ok_or_empty_155104;
            bool index_certs_155108;
            
            if (!protect_assert_disj_155107) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 8 * num_merges_155044;
            int64_t bytes_165015 = next_stride_155040 * binop_x_165014;
            bool i_lte_j_155051 = sle64((int64_t) 0, next_stride_155040);
            
            if (mem_165016_cached_sizze_166253 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166253, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166254 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166254, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061;
            int64_t binop_x_165044 = (int64_t) 8 * num_blocks_155060;
            int64_t bytes_165045 = merge_block_sizze_154925 * binop_x_165044;
            int64_t bytes_165090 = (int64_t) 16 * stride_155039;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155044; i_164746++) {
                int64_t start_155112 = mul64(next_stride_155040, i_164746);
                int64_t j_m_i_155113 = sub64(loop_dz2084Uz2082U_155035, start_155112);
                bool empty_slice_155114 = j_m_i_155113 == (int64_t) 0;
                int64_t m_155115 = sub64(j_m_i_155113, (int64_t) 1);
                int64_t i_p_m_t_s_155116 = add64(start_155112, m_155115);
                bool zzero_leq_i_p_m_t_s_155117 = sle64((int64_t) 0, i_p_m_t_s_155116);
                bool i_p_m_t_s_leq_w_155118 = slt64(i_p_m_t_s_155116, loop_dz2084Uz2082U_155035);
                bool zzero_lte_i_155119 = sle64((int64_t) 0, start_155112);
                bool i_lte_j_155120 = sle64(start_155112, loop_dz2084Uz2082U_155035);
                bool y_155121 = i_p_m_t_s_leq_w_155118 && zzero_lte_i_155119;
                bool y_155122 = zzero_leq_i_p_m_t_s_155117 && y_155121;
                bool forwards_ok_155123 = i_lte_j_155120 && y_155122;
                bool ok_or_empty_155124 = empty_slice_155114 || forwards_ok_155123;
                bool index_certs_155125;
                
                if (!ok_or_empty_155124) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155112, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155035, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155126 = slt64(m_155049, j_m_i_155113);
                bool y_155127 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155126;
                bool forwards_ok_155128 = i_lte_j_155051 && y_155127;
                bool ok_or_empty_155129 = zzero_155041 || forwards_ok_155128;
                bool index_certs_155130;
                
                if (!ok_or_empty_155129) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) j_m_i_155113, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:109:36-40\n   #8  ftRelational.fut:106:9-109:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155052) {
                    int64_t dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155072) {
                        int64_t head_res_157041 = ((int64_t *) mem_param_165010.mem)[start_155112];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155112];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155039 + start_155112;
                        int64_t head_res_157044 = ((int64_t *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155040; nest_i_165720++) {
                        ((int64_t *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165090, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155040; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155040; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155062;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155039);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155062);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155039 + j_157055;
                                int64_t slice_157065 = start_155112 + slice_157064;
                                int64_t leq_arg1_157066 = ((int64_t *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155112 + i_157052;
                                int64_t leq_arg0_157071 = ((int64_t *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = sle64(leq_arg0_157071, leq_arg1_157066);
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        int64_t loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155039);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155112 + i_157052;
                            int64_t tmp_157082 = ((int64_t *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155062);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:109:36-40\n   #9  ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155039 + j_157055;
                            int64_t slice_157089 = start_155112 + slice_157088;
                            int64_t tmp_157090 = ((int64_t *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((int64_t *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166255 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166255, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166256 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166256, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061; i_164732++) {
                        int64_t split_count_arg3_155192 = mul64(merge_block_sizze_154925, i_164732);
                        int64_t defunc_0_split_count_res_155193;
                        int64_t defunc_0_split_count_res_155194;
                        int64_t defunc_0_split_count_res_155195;
                        int64_t defunc_0_split_count_res_155196;
                        int64_t defunc_0_split_count_res_155197;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155193, &defunc_0_split_count_res_155194, &defunc_0_split_count_res_155195, &defunc_0_split_count_res_155196, &defunc_0_split_count_res_155197, (int64_t) 0, stride_155039, (int64_t) 0, j_m_i_155062, split_count_arg3_155192) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155198 = slt64((int64_t) 0, defunc_0_split_count_res_155197);
                        bool defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        int64_t defunc_0_split_count_res_155204;
                        bool loop_while_155205;
                        int64_t ss_155206;
                        int64_t ss_155207;
                        int64_t tt_155208;
                        int64_t tt_155209;
                        int64_t count_155210;
                        
                        loop_while_155205 = loop_cond_155198;
                        ss_155206 = defunc_0_split_count_res_155193;
                        ss_155207 = defunc_0_split_count_res_155194;
                        tt_155208 = defunc_0_split_count_res_155195;
                        tt_155209 = defunc_0_split_count_res_155196;
                        count_155210 = defunc_0_split_count_res_155197;
                        while (loop_while_155205) {
                            int64_t zlze_lhs_155211 = sub64(ss_155207, ss_155206);
                            bool cond_155212 = sle64(zlze_lhs_155211, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155213;
                            int64_t defunc_0_lifted_step_res_155214;
                            int64_t defunc_0_lifted_step_res_155215;
                            int64_t defunc_0_lifted_step_res_155216;
                            
                            if (cond_155212) {
                                int64_t tmp_157094 = add64(tt_155208, count_155210);
                                
                                defunc_0_lifted_step_res_155213 = ss_155206;
                                defunc_0_lifted_step_res_155214 = tmp_157094;
                                defunc_0_lifted_step_res_155215 = tt_155209;
                                defunc_0_lifted_step_res_155216 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155218 = sub64(tt_155209, tt_155208);
                                bool cond_155219 = sle64(zlze_lhs_155218, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155220;
                                int64_t defunc_0_lifted_step_res_f_res_155221;
                                int64_t defunc_0_lifted_step_res_f_res_155222;
                                int64_t defunc_0_lifted_step_res_f_res_155223;
                                
                                if (cond_155219) {
                                    int64_t tmp_157095 = add64(ss_155206, count_155210);
                                    
                                    defunc_0_lifted_step_res_f_res_155220 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155221 = tt_155208;
                                    defunc_0_lifted_step_res_f_res_155222 = tt_155209;
                                    defunc_0_lifted_step_res_f_res_155223 = (int64_t) 0;
                                } else {
                                    bool cond_155225 = count_155210 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155226;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155227;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155228;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155229;
                                    
                                    if (cond_155225) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155206);
                                        bool y_157098 = slt64(ss_155206, stride_155039);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155206, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155208);
                                        bool y_157104 = slt64(tt_155208, j_m_i_155062);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155208, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155112 + ss_155206;
                                        int64_t leq_arg1_157102 = ((int64_t *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155039 + tt_155208;
                                        int64_t slice_157108 = start_155112 + slice_157107;
                                        int64_t leq_arg0_157109 = ((int64_t *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = sle64(leq_arg0_157109, leq_arg1_157102);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155208);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155206;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155206);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155208;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = tt_155209;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = (int64_t) 0;
                                    } else {
                                        int64_t m_155248 = sdiv64(count_155210, (int64_t) 2);
                                        int64_t n_155249 = sub64(count_155210, m_155248);
                                        bool cond_155250 = n_155249 == (int64_t) 0;
                                        int64_t zgze_lhs_155251 = add64(ss_155206, m_155248);
                                        bool cond_f_res_155252 = sle64(ss_155207, zgze_lhs_155251);
                                        bool x_155253 = !cond_155250;
                                        bool y_155254 = cond_f_res_155252 && x_155253;
                                        bool cond_155255 = cond_155250 || y_155254;
                                        bool leq_y_x_155256;
                                        
                                        if (cond_155255) {
                                            leq_y_x_155256 = 1;
                                        } else {
                                            bool x_155257 = sle64((int64_t) 0, zgze_lhs_155251);
                                            bool y_155258 = slt64(zgze_lhs_155251, stride_155039);
                                            bool bounds_check_155259 = x_155257 && y_155258;
                                            bool index_certs_155260;
                                            
                                            if (!bounds_check_155259) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155251, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155263 = add64(tt_155208, n_155249);
                                            int64_t leq_arg0_155264 = sub64(zm_lhs_155263, (int64_t) 1);
                                            bool x_155265 = sle64((int64_t) 0, leq_arg0_155264);
                                            bool y_155266 = slt64(leq_arg0_155264, j_m_i_155062);
                                            bool bounds_check_155267 = x_155265 && y_155266;
                                            bool index_certs_155268;
                                            
                                            if (!bounds_check_155267) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155264, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:109:36-40\n   #13 ftRelational.fut:106:9-109:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155261 = start_155112 + zgze_lhs_155251;
                                            int64_t leq_arg1_155262 = ((int64_t *) mem_param_165010.mem)[slice_155261];
                                            int64_t slice_155269 = stride_155039 + leq_arg0_155264;
                                            int64_t slice_155270 = start_155112 + slice_155269;
                                            int64_t leq_arg0_155271 = ((int64_t *) mem_param_165010.mem)[slice_155270];
                                            bool defunc_0_leq_res_155272 = sle64(leq_arg0_155271, leq_arg1_155262);
                                            
                                            leq_y_x_155256 = defunc_0_leq_res_155272;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                        
                                        if (leq_y_x_155256) {
                                            int64_t tmp_157115 = add64(tt_155208, n_155249);
                                            int64_t tmp_157116 = sub64(count_155210, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tt_155209;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = tmp_157116;
                                        } else {
                                            int64_t tmp_155278 = add64(tt_155208, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tt_155208;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tmp_155278;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = count_155210;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = ss_155206;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                    }
                                    defunc_0_lifted_step_res_f_res_155220 = defunc_0_lifted_step_res_f_res_f_res_155226;
                                    defunc_0_lifted_step_res_f_res_155221 = defunc_0_lifted_step_res_f_res_f_res_155227;
                                    defunc_0_lifted_step_res_f_res_155222 = defunc_0_lifted_step_res_f_res_f_res_155228;
                                    defunc_0_lifted_step_res_f_res_155223 = defunc_0_lifted_step_res_f_res_f_res_155229;
                                }
                                defunc_0_lifted_step_res_155213 = defunc_0_lifted_step_res_f_res_155220;
                                defunc_0_lifted_step_res_155214 = defunc_0_lifted_step_res_f_res_155221;
                                defunc_0_lifted_step_res_155215 = defunc_0_lifted_step_res_f_res_155222;
                                defunc_0_lifted_step_res_155216 = defunc_0_lifted_step_res_f_res_155223;
                            }
                            
                            int64_t loopres_155279;
                            int64_t loopres_155280;
                            int64_t loopres_155281;
                            int64_t loopres_155282;
                            int64_t loopres_155283;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155279, &loopres_155280, &loopres_155281, &loopres_155282, &loopres_155283, defunc_0_lifted_step_res_155213, ss_155207, defunc_0_lifted_step_res_155214, defunc_0_lifted_step_res_155215, defunc_0_lifted_step_res_155216) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155284 = slt64((int64_t) 0, loopres_155283);
                            bool loop_while_tmp_165727 = loop_cond_155284;
                            int64_t ss_tmp_165728 = loopres_155279;
                            int64_t ss_tmp_165729 = loopres_155280;
                            int64_t tt_tmp_165730 = loopres_155281;
                            int64_t tt_tmp_165731 = loopres_155282;
                            int64_t count_tmp_165732 = loopres_155283;
                            
                            loop_while_155205 = loop_while_tmp_165727;
                            ss_155206 = ss_tmp_165728;
                            ss_155207 = ss_tmp_165729;
                            tt_155208 = tt_tmp_165730;
                            tt_155209 = tt_tmp_165731;
                            count_155210 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155199 = loop_while_155205;
                        defunc_0_split_count_res_155200 = ss_155206;
                        defunc_0_split_count_res_155201 = ss_155207;
                        defunc_0_split_count_res_155202 = tt_155208;
                        defunc_0_split_count_res_155203 = tt_155209;
                        defunc_0_split_count_res_155204 = count_155210;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155200;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155202;
                    }
                    if (mem_165046_cached_sizze_166257 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166257, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166258 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166258, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155060; i_164739++) {
                        bool y_155290 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool index_certs_155292;
                        
                        if (!y_155290) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155293 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155294 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155295 = add64((int64_t) 1, i_164739);
                        bool x_155296 = sle64((int64_t) 0, tmp_155295);
                        bool y_155297 = slt64(tmp_155295, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool bounds_check_155298 = x_155296 && y_155297;
                        bool index_certs_155299;
                        
                        if (!bounds_check_155298) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155295, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165029)[tmp_155295];
                        int64_t defunc_0_f_res_155301 = ((int64_t *) mem_165031)[tmp_155295];
                        int64_t merge_sequential_arg2_155302 = add64(stride_155039, defunc_0_f_res_155294);
                        int64_t merge_sequential_arg2_155303 = add64(stride_155039, defunc_0_f_res_155301);
                        int64_t j_m_i_155304 = sub64(merge_sequential_arg2_155303, merge_sequential_arg2_155302);
                        bool empty_slice_155305 = j_m_i_155304 == (int64_t) 0;
                        int64_t m_155306 = sub64(j_m_i_155304, (int64_t) 1);
                        int64_t i_p_m_t_s_155307 = add64(merge_sequential_arg2_155302, m_155306);
                        bool zzero_leq_i_p_m_t_s_155308 = sle64((int64_t) 0, i_p_m_t_s_155307);
                        bool i_p_m_t_s_leq_w_155309 = slt64(i_p_m_t_s_155307, next_stride_155040);
                        bool zzero_lte_i_155310 = sle64((int64_t) 0, merge_sequential_arg2_155302);
                        bool i_lte_j_155311 = sle64(merge_sequential_arg2_155302, merge_sequential_arg2_155303);
                        bool y_155312 = i_p_m_t_s_leq_w_155309 && zzero_lte_i_155310;
                        bool y_155313 = zzero_leq_i_p_m_t_s_155308 && y_155312;
                        bool forwards_ok_155314 = i_lte_j_155311 && y_155313;
                        bool ok_or_empty_155315 = empty_slice_155305 || forwards_ok_155314;
                        bool index_certs_155316;
                        
                        if (!ok_or_empty_155315) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155302, ":", (long long) merge_sequential_arg2_155303, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155317 = sub64(defunc_0_f_res_155300, defunc_0_f_res_155293);
                        bool empty_slice_155318 = j_m_i_155317 == (int64_t) 0;
                        int64_t m_155319 = sub64(j_m_i_155317, (int64_t) 1);
                        int64_t i_p_m_t_s_155320 = add64(defunc_0_f_res_155293, m_155319);
                        bool zzero_leq_i_p_m_t_s_155321 = sle64((int64_t) 0, i_p_m_t_s_155320);
                        bool i_p_m_t_s_leq_w_155322 = slt64(i_p_m_t_s_155320, next_stride_155040);
                        bool zzero_lte_i_155323 = sle64((int64_t) 0, defunc_0_f_res_155293);
                        bool i_lte_j_155324 = sle64(defunc_0_f_res_155293, defunc_0_f_res_155300);
                        bool y_155325 = i_p_m_t_s_leq_w_155322 && zzero_lte_i_155323;
                        bool y_155326 = zzero_leq_i_p_m_t_s_155321 && y_155325;
                        bool forwards_ok_155327 = i_lte_j_155324 && y_155326;
                        bool ok_or_empty_155328 = empty_slice_155318 || forwards_ok_155327;
                        bool index_certs_155329;
                        
                        if (!ok_or_empty_155328) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155293, ":", (long long) defunc_0_f_res_155300, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:109:36-40\n   #10 ftRelational.fut:106:9-109:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155330 = slt64((int64_t) 0, j_m_i_155317);
                        int64_t dummy_155331;
                        int64_t dummy_155332;
                        
                        if (cond_155330) {
                            bool index_certs_157117;
                            
                            if (!cond_155330) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:109:36-40\n   #12 ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155112 + defunc_0_f_res_155293;
                            int64_t head_res_157119 = ((int64_t *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155331 = head_res_157119;
                            dummy_155332 = head_res_157120;
                        } else {
                            bool y_155337 = slt64((int64_t) 0, j_m_i_155304);
                            bool index_certs_155338;
                            
                            if (!y_155337) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:109:36-40\n   #12 ftRelational.fut:106:9-109:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155339 = start_155112 + merge_sequential_arg2_155302;
                            int64_t head_res_155340 = ((int64_t *) mem_param_165010.mem)[slice_155339];
                            int64_t head_res_155341 = ((int64_t *) mem_param_165013.mem)[slice_155339];
                            
                            dummy_155331 = head_res_155340;
                            dummy_155332 = head_res_155341;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154925; nest_i_165735++) {
                            ((int64_t *) mem_165046)[i_164739 * merge_block_sizze_154925 + nest_i_165735] = dummy_155331;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154925; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + nest_i_165736] = dummy_155332;
                        }
                        
                        int64_t data_155344;
                        int64_t i_155348 = (int64_t) 0;
                        
                        for (int64_t k_155347 = 0; k_155347 < merge_block_sizze_154925; k_155347++) {
                            int64_t j_155351 = sub64(k_155347, i_155348);
                            bool cond_155352 = j_155351 == j_m_i_155304;
                            bool cond_155353;
                            
                            if (cond_155352) {
                                cond_155353 = 1;
                            } else {
                                bool cond_155354 = slt64(i_155348, j_m_i_155317);
                                bool cond_f_res_155355;
                                
                                if (cond_155354) {
                                    bool x_157121 = sle64((int64_t) 0, j_155351);
                                    bool y_157122 = slt64(j_155351, j_m_i_155304);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155348);
                                    bool bounds_check_157129 = cond_155354 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155302 + j_155351;
                                    int64_t slice_157126 = start_155112 + slice_157125;
                                    int64_t leq_arg1_157127 = ((int64_t *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155293 + i_155348;
                                    int64_t slice_157132 = start_155112 + slice_157131;
                                    int64_t leq_arg0_157133 = ((int64_t *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = sle64(leq_arg0_157133, leq_arg1_157127);
                                    
                                    cond_f_res_155355 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155355 = 0;
                                }
                                cond_155353 = cond_f_res_155355;
                            }
                            
                            int64_t loopres_155370;
                            int64_t loopres_155371;
                            int64_t loopres_155372;
                            
                            if (cond_155353) {
                                bool x_157136 = sle64((int64_t) 0, i_155348);
                                bool y_157137 = slt64(i_155348, j_m_i_155317);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155348);
                                int64_t slice_157140 = defunc_0_f_res_155293 + i_155348;
                                int64_t slice_157141 = start_155112 + slice_157140;
                                int64_t tmp_157142 = ((int64_t *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155370 = tmp_157135;
                                loopres_155371 = tmp_157142;
                                loopres_155372 = tmp_157143;
                            } else {
                                bool x_155382 = sle64((int64_t) 0, j_155351);
                                bool y_155383 = slt64(j_155351, j_m_i_155304);
                                bool bounds_check_155384 = x_155382 && y_155383;
                                bool index_certs_155385;
                                
                                if (!bounds_check_155384) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:109:36-40\n   #11 ftRelational.fut:106:9-109:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155386 = merge_sequential_arg2_155302 + j_155351;
                                int64_t slice_155387 = start_155112 + slice_155386;
                                int64_t tmp_155388 = ((int64_t *) mem_param_165010.mem)[slice_155387];
                                int64_t tmp_155389 = ((int64_t *) mem_param_165013.mem)[slice_155387];
                                
                                loopres_155370 = i_155348;
                                loopres_155371 = tmp_155388;
                                loopres_155372 = tmp_155389;
                            }
                            ((int64_t *) mem_165046)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155371;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155372;
                            
                            int64_t i_tmp_165737 = loopres_155370;
                            
                            i_155348 = i_tmp_165737;
                        }
                        data_155344 = i_155348;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165045, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165016, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155396 = next_stride_155040 * num_merges_155044;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            if (memblock_alloc(ctx, &mem_165126, bytes_165015, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            
            bool loop_cond_155399 = slt64(next_stride_155040, flat_dim_154921);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155396;
            bool loop_while_tmp_165714 = loop_cond_155399;
            int64_t stride_tmp_165717 = next_stride_155040;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155035 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155036 = loop_while_tmp_165714;
            stride_155039 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155030 = loop_dz2084Uz2082U_155035;
        data_155031 = loop_while_155036;
        data_155034 = stride_155039;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155400 = n_91253 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155401 = sle64((int64_t) 0, zs_lhs_154905);
        bool i_p_m_t_s_leq_w_155402 = slt64(zs_lhs_154905, data_155030);
        bool y_155403 = zzero_leq_i_p_m_t_s_155401 && i_p_m_t_s_leq_w_155402;
        bool ok_or_empty_155404 = empty_slice_155400 || y_155403;
        bool index_certs_155405;
        
        if (!ok_or_empty_155404) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_91253, "] out of bounds for array of shape [", (long long) data_155030, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:109:36-40\n   #6  ftRelational.fut:106:9-109:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_164930, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_91253; i_164753++) {
        int64_t eta_p_155413 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155414 = sle64((int64_t) 0, eta_p_155413);
        bool y_155415 = slt64(eta_p_155413, n_91253);
        bool bounds_check_155416 = x_155414 && y_155415;
        bool index_certs_155417;
        
        if (!bounds_check_155416) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155413, "] out of bounds for array of shape [", (long long) n_91253, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:109:36-40\n   #5  ftRelational.fut:106:9-109:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_155418 = ((int64_t *) k_mem_164928.mem)[eta_p_155413];
        
        ((int64_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155418;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165140.mem, i_164753 * b_91254, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_164929.mem, eta_p_155413 * b_91254, (int64_t []) {(int64_t) 1}, (int64_t []) {b_91254});
    }
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166247, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166248, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_166259, struct memblock *mem_out_p_166260, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_86533, int64_t b_86534)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164934_cached_sizze_166261 = 0;
    unsigned char *mem_164934 = NULL;
    int64_t mem_164937_cached_sizze_166262 = 0;
    unsigned char *mem_164937 = NULL;
    int64_t mem_164947_cached_sizze_166263 = 0;
    unsigned char *mem_164947 = NULL;
    int64_t mem_164949_cached_sizze_166264 = 0;
    unsigned char *mem_164949 = NULL;
    int64_t mem_165016_cached_sizze_166265 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165019_cached_sizze_166266 = 0;
    unsigned char *mem_165019 = NULL;
    int64_t mem_165029_cached_sizze_166267 = 0;
    unsigned char *mem_165029 = NULL;
    int64_t mem_165031_cached_sizze_166268 = 0;
    unsigned char *mem_165031 = NULL;
    int64_t mem_165046_cached_sizze_166269 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165049_cached_sizze_166270 = 0;
    unsigned char *mem_165049 = NULL;
    struct memblock mem_165140;
    
    mem_165140.references = NULL;
    
    struct memblock mem_165138;
    
    mem_165138.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_165126;
    
    mem_165126.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165088;
    
    mem_165088.references = NULL;
    
    struct memblock mem_165084;
    
    mem_165084.references = NULL;
    
    struct memblock mem_165093;
    
    mem_165093.references = NULL;
    
    struct memblock mem_165091;
    
    mem_165091.references = NULL;
    
    struct memblock ext_mem_165108;
    
    ext_mem_165108.references = NULL;
    
    struct memblock ext_mem_165111;
    
    ext_mem_165111.references = NULL;
    
    struct memblock mem_param_165013;
    
    mem_param_165013.references = NULL;
    
    struct memblock mem_param_165010;
    
    mem_param_165010.references = NULL;
    
    struct memblock ext_mem_165132;
    
    ext_mem_165132.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock mem_165006;
    
    mem_165006.references = NULL;
    
    struct memblock mem_165002;
    
    mem_165002.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_86533;
    bool cond_154904 = sle64(n_86533, (int64_t) 1);
    int64_t zs_lhs_154905 = sub64(n_86533, (int64_t) 1);
    int64_t zp_rhs_154906 = sdiv_safe64(zs_lhs_154905, (int64_t) 20);
    int64_t min_num_blocks_154907 = add64((int64_t) 1, zp_rhs_154906);
    bool loop_cond_154908 = slt64((int64_t) 1, min_num_blocks_154907);
    bool smallest_pow_2_geq_than_res_154909;
    int64_t smallest_pow_2_geq_than_res_154910;
    bool loop_while_154911;
    int64_t x_154912;
    
    loop_while_154911 = loop_cond_154908;
    x_154912 = (int64_t) 1;
    while (loop_while_154911) {
        int64_t loopres_154913 = mul64((int64_t) 2, x_154912);
        bool loop_cond_154914 = slt64(loopres_154913, min_num_blocks_154907);
        bool loop_while_tmp_165695 = loop_cond_154914;
        int64_t x_tmp_165696 = loopres_154913;
        
        loop_while_154911 = loop_while_tmp_165695;
        x_154912 = x_tmp_165696;
    }
    smallest_pow_2_geq_than_res_154909 = loop_while_154911;
    smallest_pow_2_geq_than_res_154910 = x_154912;
    
    bool zzero_154915 = smallest_pow_2_geq_than_res_154910 == (int64_t) 0;
    bool nonzzero_154916 = !zzero_154915;
    bool protect_assert_disj_154917 = cond_154904 || nonzzero_154916;
    bool nonzzero_cert_154918;
    
    if (!protect_assert_disj_154917) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_154919 = sdiv_safe64(zs_lhs_154905, smallest_pow_2_geq_than_res_154910);
    int64_t block_sizze_154920 = add64((int64_t) 1, zp_rhs_154919);
    bool y_154926 = slt64((int64_t) 0, n_86533);
    bool protect_assert_disj_165536 = cond_154904 || y_154926;
    bool index_certs_154927;
    
    if (!protect_assert_disj_165536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_86533, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154941 = slt64(smallest_pow_2_geq_than_res_154910, (int64_t) 0);
    bool valid_154942 = !bounds_invalid_upwards_154941;
    bool protect_assert_disj_165544 = cond_154904 || valid_154942;
    bool range_valid_c_154943;
    
    if (!protect_assert_disj_165544) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_154910, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:101:36-40\n   #6  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_154945 = slt64(block_sizze_154920, (int64_t) 0);
    bool valid_154946 = !bounds_invalid_upwards_154945;
    bool protect_assert_disj_165546 = cond_154904 || valid_154946;
    bool range_valid_c_154947;
    
    if (!protect_assert_disj_165546) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_154920, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_154949 = sle64(block_sizze_154920, (int64_t) 1);
    int64_t tmp_154950 = sub64(block_sizze_154920, (int64_t) 2);
    bool bounds_invalid_upwards_154951 = slt64(tmp_154950, (int64_t) 0);
    bool valid_154953 = !bounds_invalid_upwards_154951;
    bool protect_assert_disj_154954 = cond_154949 || valid_154953;
    bool protect_assert_disj_165548 = cond_154904 || protect_assert_disj_154954;
    bool range_valid_c_154955;
    
    if (!protect_assert_disj_165548) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154950, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165137 = (int64_t) 2 * n_86533;
    int64_t bytes_165139 = n_86533 * b_86534;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165697 = 0; i_165697 < n_86533; i_165697++) {
        int64_t x_165698 = (int64_t) 0 + i_165697 * (int64_t) 1;
        
        ((int64_t *) mem_164931.mem)[i_165697] = x_165698;
    }
    
    int64_t flat_dim_154921 = smallest_pow_2_geq_than_res_154910 * block_sizze_154920;
    bool x_165531 = !cond_154904;
    int64_t greatest_divisor_leq_than_arg1_154924 = mul64((int64_t) 2, block_sizze_154920);
    int64_t merge_block_sizze_154925;
    
    if (x_165531) {
        int64_t x_165533;
        
        if (futrts_greatest_divisor_leq_than_5624(ctx, &x_165533, (int64_t) 8, greatest_divisor_leq_than_arg1_154924) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_154925 = x_165533;
    } else {
        merge_block_sizze_154925 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_154928;
    
    if (x_165531) {
        int16_t x_165537 = ((int16_t *) k_mem_164928.mem)[(int64_t) 0];
        
        reduce_arg1_154928 = x_165537;
    } else {
        reduce_arg1_154928 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_157150;
    int64_t defunc_0_reduce_res_157151;
    
    if (x_165531) {
        int16_t x_165539;
        int64_t x_165540;
        int16_t redout_164711;
        int64_t redout_164712;
        
        redout_164711 = reduce_arg1_154928;
        redout_164712 = (int64_t) 0;
        for (int64_t i_164713 = 0; i_164713 < n_86533; i_164713++) {
            int16_t x_154932 = ((int16_t *) k_mem_164928.mem)[i_164713];
            bool defunc_0_leq_res_154938 = sle16(redout_164711, x_154932);
            int16_t defunc_0_op_res_154939;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154939 = x_154932;
            } else {
                defunc_0_op_res_154939 = redout_164711;
            }
            
            int64_t defunc_0_op_res_154940;
            
            if (defunc_0_leq_res_154938) {
                defunc_0_op_res_154940 = i_164713;
            } else {
                defunc_0_op_res_154940 = redout_164712;
            }
            
            int16_t redout_tmp_165699 = defunc_0_op_res_154939;
            int64_t redout_tmp_165700 = defunc_0_op_res_154940;
            
            redout_164711 = redout_tmp_165699;
            redout_164712 = redout_tmp_165700;
        }
        x_165539 = redout_164711;
        x_165540 = redout_164712;
        defunc_0_reduce_res_157150 = x_165539;
        defunc_0_reduce_res_157151 = x_165540;
    } else {
        defunc_0_reduce_res_157150 = (int16_t) 0;
        defunc_0_reduce_res_157151 = (int64_t) 0;
    }
    
    int64_t distance_154952 = add64((int64_t) 1, tmp_154950);
    int64_t binop_x_164932 = (int64_t) 2 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164933 = block_sizze_154920 * binop_x_164932;
    int64_t binop_x_164935 = (int64_t) 8 * smallest_pow_2_geq_than_res_154910;
    int64_t bytes_164936 = block_sizze_154920 * binop_x_164935;
    int64_t bytes_164948 = (int64_t) 8 * block_sizze_154920;
    bool loop_cond_155027 = slt64(block_sizze_154920, flat_dim_154921);
    bool zzero_155028 = merge_block_sizze_154925 == (int64_t) 0;
    bool nonzzero_155029 = !zzero_155028;
    
    if (cond_154904) {
        if (memblock_set(ctx, &ext_mem_165136, &mem_164931, "mem_164931") != 0)
            return 1;
    } else {
        if (mem_164934_cached_sizze_166261 < bytes_164933) {
            err = lexical_realloc(ctx, &mem_164934, &mem_164934_cached_sizze_166261, bytes_164933);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164937_cached_sizze_166262 < bytes_164936) {
            err = lexical_realloc(ctx, &mem_164937, &mem_164937_cached_sizze_166262, bytes_164936);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164947_cached_sizze_166263 < greatest_divisor_leq_than_arg1_154924) {
            err = lexical_realloc(ctx, &mem_164947, &mem_164947_cached_sizze_166263, greatest_divisor_leq_than_arg1_154924);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_164949_cached_sizze_166264 < bytes_164948) {
            err = lexical_realloc(ctx, &mem_164949, &mem_164949_cached_sizze_166264, bytes_164948);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_164725 = 0; i_164725 < smallest_pow_2_geq_than_res_154910; i_164725++) {
            int64_t zp_lhs_154959 = mul64(block_sizze_154920, i_164725);
            
            for (int64_t i_164718 = 0; i_164718 < block_sizze_154920; i_164718++) {
                int64_t k_154963 = add64(zp_lhs_154959, i_164718);
                bool cond_154964 = slt64(k_154963, n_86533);
                int16_t lifted_lambda_res_154965;
                int64_t lifted_lambda_res_154966;
                
                if (cond_154964) {
                    bool x_157003 = sle64((int64_t) 0, k_154963);
                    bool bounds_check_157004 = cond_154964 && x_157003;
                    bool index_certs_157005;
                    
                    if (!bounds_check_157004) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_154963, "] out of bounds for array of shape [", (long long) n_86533, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_157006 = ((int16_t *) k_mem_164928.mem)[k_154963];
                    
                    lifted_lambda_res_154965 = lifted_lambda_res_t_res_157006;
                    lifted_lambda_res_154966 = k_154963;
                } else {
                    lifted_lambda_res_154965 = defunc_0_reduce_res_157150;
                    lifted_lambda_res_154966 = defunc_0_reduce_res_157151;
                }
                ((int16_t *) mem_164947)[i_164718] = lifted_lambda_res_154965;
                ((int64_t *) mem_164949)[i_164718] = lifted_lambda_res_154966;
            }
            if (!cond_154949) {
                for (int64_t i_154976 = 0; i_154976 < distance_154952; i_154976++) {
                    int64_t gt_arg1_154979 = add64((int64_t) 1, i_154976);
                    bool x_154980 = sle64((int64_t) 0, gt_arg1_154979);
                    bool y_154981 = slt64(gt_arg1_154979, block_sizze_154920);
                    bool bounds_check_154982 = x_154980 && y_154981;
                    bool index_certs_154983;
                    
                    if (!bounds_check_154982) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_154979, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_154985 = slt64(i_154976, block_sizze_154920);
                    bool index_certs_154986;
                    
                    if (!y_154985) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_154976, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_154984 = ((int16_t *) mem_164947)[gt_arg1_154979];
                    int16_t gt_arg0_154987 = ((int16_t *) mem_164947)[i_154976];
                    bool defunc_0_leq_res_154988 = sle16(gt_arg0_154987, gt_arg1_154984);
                    bool defunc_0_lifted_gt_res_154989 = !defunc_0_leq_res_154988;
                    bool s_154990;
                    int64_t s_154993;
                    bool loop_while_154994;
                    int64_t j_154997;
                    
                    loop_while_154994 = defunc_0_lifted_gt_res_154989;
                    j_154997 = i_154976;
                    while (loop_while_154994) {
                        bool x_154998 = sle64((int64_t) 0, j_154997);
                        bool y_154999 = slt64(j_154997, block_sizze_154920);
                        bool bounds_check_155000 = x_154998 && y_154999;
                        bool index_certs_155001;
                        
                        if (!bounds_check_155000) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_154997, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_155004 = add64((int64_t) 1, j_154997);
                        bool x_155005 = sle64((int64_t) 0, copy_arg0_155004);
                        bool y_155006 = slt64(copy_arg0_155004, block_sizze_154920);
                        bool bounds_check_155007 = x_155005 && y_155006;
                        bool index_certs_155008;
                        
                        if (!bounds_check_155007) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_155004, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_155002 = ((int16_t *) mem_164947)[j_154997];
                        int64_t copy_arg0_155003 = ((int64_t *) mem_164949)[j_154997];
                        int16_t copy_arg0_155009 = ((int16_t *) mem_164947)[copy_arg0_155004];
                        int64_t copy_arg0_155010 = ((int64_t *) mem_164949)[copy_arg0_155004];
                        
                        ((int16_t *) mem_164947)[j_154997] = copy_arg0_155009;
                        ((int64_t *) mem_164949)[j_154997] = copy_arg0_155010;
                        ((int16_t *) mem_164947)[copy_arg0_155004] = copy_arg0_155002;
                        ((int64_t *) mem_164949)[copy_arg0_155004] = copy_arg0_155003;
                        
                        int64_t tmp_155015 = sub64(j_154997, (int64_t) 1);
                        bool cond_155016 = sle64((int64_t) 0, tmp_155015);
                        bool loop_cond_155017;
                        
                        if (cond_155016) {
                            bool y_157008 = slt64(tmp_155015, block_sizze_154920);
                            bool bounds_check_157009 = cond_155016 && y_157008;
                            bool index_certs_157010;
                            
                            if (!bounds_check_157009) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155015, "] out of bounds for array of shape [", (long long) block_sizze_154920, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_157007 = ((int16_t *) mem_164947)[j_154997];
                            int16_t gt_arg0_157011 = ((int16_t *) mem_164947)[tmp_155015];
                            bool defunc_0_leq_res_157012 = sle16(gt_arg0_157011, gt_arg1_157007);
                            bool defunc_0_lifted_gt_res_157013 = !defunc_0_leq_res_157012;
                            
                            loop_cond_155017 = defunc_0_lifted_gt_res_157013;
                        } else {
                            loop_cond_155017 = 0;
                        }
                        
                        bool loop_while_tmp_165707 = loop_cond_155017;
                        int64_t j_tmp_165710 = tmp_155015;
                        
                        loop_while_154994 = loop_while_tmp_165707;
                        j_154997 = j_tmp_165710;
                    }
                    s_154990 = loop_while_154994;
                    s_154993 = j_154997;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_164934, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_164947, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164937, i_164725 * block_sizze_154920, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164949, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_154920});
        }
        if (memblock_alloc(ctx, &mem_165002, bytes_164933, "mem_165002")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_165002.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint16_t *) mem_164934, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        if (memblock_alloc(ctx, &mem_165006, bytes_164936, "mem_165006")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_165006.mem, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (uint64_t *) mem_164937, (int64_t) 0, (int64_t []) {block_sizze_154920, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_154910, block_sizze_154920});
        
        int64_t data_155030;
        bool data_155031;
        int64_t data_155034;
        int64_t loop_dz2084Uz2082U_155035;
        bool loop_while_155036;
        int64_t stride_155039;
        
        if (memblock_set(ctx, &mem_param_165010, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_165013, &mem_165006, "mem_165006") != 0)
            return 1;
        loop_dz2084Uz2082U_155035 = flat_dim_154921;
        loop_while_155036 = loop_cond_155027;
        stride_155039 = block_sizze_154920;
        while (loop_while_155036) {
            int64_t next_stride_155040 = mul64((int64_t) 2, stride_155039);
            bool zzero_155041 = next_stride_155040 == (int64_t) 0;
            bool nonzzero_155042 = !zzero_155041;
            bool nonzzero_cert_155043;
            
            if (!nonzzero_155042) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_155044 = sdiv64(flat_dim_154921, next_stride_155040);
            bool bounds_invalid_upwards_155045 = slt64(num_merges_155044, (int64_t) 0);
            bool valid_155046 = !bounds_invalid_upwards_155045;
            bool range_valid_c_155047;
            
            if (!valid_155046) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_155044, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:101:36-40\n   #6  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_155049 = sub64(next_stride_155040, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_155050 = sle64((int64_t) 0, m_155049);
            bool cond_155052 = slt64(next_stride_155040, (int64_t) 10);
            bool protect_assert_disj_155053 = nonzzero_155029 || cond_155052;
            bool nonzzero_cert_155054;
            
            if (!protect_assert_disj_155053) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_155055 = smod_safe64(next_stride_155040, merge_block_sizze_154925);
            bool num_blocks_155056 = zeze_lhs_155055 == (int64_t) 0;
            bool protect_assert_disj_155057 = cond_155052 || num_blocks_155056;
            bool assert_c_155058;
            
            if (!protect_assert_disj_155057) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_155060 = sdiv_safe64(next_stride_155040, merge_block_sizze_154925);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061 = add64((int64_t) 1, num_blocks_155060);
            int64_t j_m_i_155062 = sub64(next_stride_155040, stride_155039);
            int64_t flat_dim_155063 = merge_block_sizze_154925 * num_blocks_155060;
            bool bounds_invalid_upwards_155064 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, (int64_t) 0);
            bool empty_slice_155065 = j_m_i_155062 == (int64_t) 0;
            int64_t m_155066 = sub64(j_m_i_155062, (int64_t) 1);
            bool zzero_lte_i_155067 = sle64((int64_t) 0, stride_155039);
            bool i_lte_j_155068 = sle64(stride_155039, next_stride_155040);
            bool empty_slice_155069 = stride_155039 == (int64_t) 0;
            int64_t m_155070 = sub64(stride_155039, (int64_t) 1);
            bool bounds_invalid_upwards_155071 = slt64(num_blocks_155060, (int64_t) 0);
            bool cond_155072 = slt64((int64_t) 0, stride_155039);
            bool valid_155073 = !bounds_invalid_upwards_155064;
            int64_t i_p_m_t_s_155074 = add64(stride_155039, m_155066);
            bool zzero_leq_i_p_m_t_s_155075 = sle64((int64_t) 0, m_155070);
            bool i_p_m_t_s_leq_w_155076 = slt64(m_155070, next_stride_155040);
            bool valid_155077 = !bounds_invalid_upwards_155071;
            bool i_p_m_t_s_leq_w_155078 = slt64(m_155049, flat_dim_155063);
            bool y_155079 = slt64((int64_t) 0, j_m_i_155062);
            bool protect_assert_disj_155080 = cond_155052 || valid_155073;
            bool range_valid_c_155081;
            
            if (!protect_assert_disj_155080) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_155082 = sle64((int64_t) 0, i_p_m_t_s_155074);
            bool i_p_m_t_s_leq_w_155083 = slt64(i_p_m_t_s_155074, next_stride_155040);
            bool y_155084 = zzero_leq_i_p_m_t_s_155075 && i_p_m_t_s_leq_w_155076;
            bool protect_assert_disj_155085 = cond_155052 || valid_155077;
            bool range_valid_c_155086;
            
            if (!protect_assert_disj_155085) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_155060, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_155087 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155078;
            bool y_155088 = zzero_lte_i_155067 && i_p_m_t_s_leq_w_155083;
            bool forwards_ok_155089 = zzero_lte_i_155067 && y_155084;
            bool ok_or_empty_155090 = zzero_155041 || y_155087;
            bool protect_assert_disj_155091 = cond_155072 || y_155079;
            bool y_155092 = zzero_leq_i_p_m_t_s_155082 && y_155088;
            bool ok_or_empty_155093 = empty_slice_155069 || forwards_ok_155089;
            bool protect_assert_disj_155094 = cond_155052 || ok_or_empty_155090;
            bool index_certs_155095;
            
            if (!protect_assert_disj_155094) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) flat_dim_155063, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_155096 = !cond_155052;
            bool protect_assert_disj_155097 = protect_assert_disj_155091 || loop_not_taken_155096;
            bool index_certs_155098;
            
            if (!protect_assert_disj_155097) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_155099 = i_lte_j_155068 && y_155092;
            bool protect_assert_disj_155100 = cond_155052 || ok_or_empty_155093;
            bool index_certs_155101;
            
            if (!protect_assert_disj_155100) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155102 = ok_or_empty_155093 || loop_not_taken_155096;
            bool index_certs_155103;
            
            if (!protect_assert_disj_155102) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_155039, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_155104 = empty_slice_155065 || forwards_ok_155099;
            bool protect_assert_disj_155105 = cond_155052 || ok_or_empty_155104;
            bool index_certs_155106;
            
            if (!protect_assert_disj_155105) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_155107 = loop_not_taken_155096 || ok_or_empty_155104;
            bool index_certs_155108;
            
            if (!protect_assert_disj_155107) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_155039, ":] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_165014 = (int64_t) 2 * num_merges_155044;
            int64_t bytes_165015 = next_stride_155040 * binop_x_165014;
            int64_t binop_x_165017 = (int64_t) 8 * num_merges_155044;
            int64_t bytes_165018 = next_stride_155040 * binop_x_165017;
            bool i_lte_j_155051 = sle64((int64_t) 0, next_stride_155040);
            
            if (mem_165016_cached_sizze_166265 < bytes_165015) {
                err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166265, bytes_165015);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165019_cached_sizze_166266 < bytes_165018) {
                err = lexical_realloc(ctx, &mem_165019, &mem_165019_cached_sizze_166266, bytes_165018);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_165028 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061;
            int64_t binop_x_165044 = (int64_t) 2 * num_blocks_155060;
            int64_t bytes_165045 = merge_block_sizze_154925 * binop_x_165044;
            int64_t binop_x_165047 = (int64_t) 8 * num_blocks_155060;
            int64_t bytes_165048 = merge_block_sizze_154925 * binop_x_165047;
            int64_t bytes_165090 = (int64_t) 4 * stride_155039;
            int64_t bytes_165092 = (int64_t) 16 * stride_155039;
            
            for (int64_t i_164746 = 0; i_164746 < num_merges_155044; i_164746++) {
                int64_t start_155112 = mul64(next_stride_155040, i_164746);
                int64_t j_m_i_155113 = sub64(loop_dz2084Uz2082U_155035, start_155112);
                bool empty_slice_155114 = j_m_i_155113 == (int64_t) 0;
                int64_t m_155115 = sub64(j_m_i_155113, (int64_t) 1);
                int64_t i_p_m_t_s_155116 = add64(start_155112, m_155115);
                bool zzero_leq_i_p_m_t_s_155117 = sle64((int64_t) 0, i_p_m_t_s_155116);
                bool i_p_m_t_s_leq_w_155118 = slt64(i_p_m_t_s_155116, loop_dz2084Uz2082U_155035);
                bool zzero_lte_i_155119 = sle64((int64_t) 0, start_155112);
                bool i_lte_j_155120 = sle64(start_155112, loop_dz2084Uz2082U_155035);
                bool y_155121 = i_p_m_t_s_leq_w_155118 && zzero_lte_i_155119;
                bool y_155122 = zzero_leq_i_p_m_t_s_155117 && y_155121;
                bool forwards_ok_155123 = i_lte_j_155120 && y_155122;
                bool ok_or_empty_155124 = empty_slice_155114 || forwards_ok_155123;
                bool index_certs_155125;
                
                if (!ok_or_empty_155124) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_155112, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_155035, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_155126 = slt64(m_155049, j_m_i_155113);
                bool y_155127 = zzero_leq_i_p_m_t_s_155050 && i_p_m_t_s_leq_w_155126;
                bool forwards_ok_155128 = i_lte_j_155051 && y_155127;
                bool ok_or_empty_155129 = zzero_155041 || forwards_ok_155128;
                bool index_certs_155130;
                
                if (!ok_or_empty_155129) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_155040, "] out of bounds for array of shape [", (long long) j_m_i_155113, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:105:58-61\n   #7  ftRelational.fut:101:36-40\n   #8  ftRelational.fut:98:9-101:40\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_155052) {
                    int16_t dummy_157039;
                    int64_t dummy_157040;
                    
                    if (cond_155072) {
                        int16_t head_res_157041 = ((int16_t *) mem_param_165010.mem)[start_155112];
                        int64_t head_res_157042 = ((int64_t *) mem_param_165013.mem)[start_155112];
                        
                        dummy_157039 = head_res_157041;
                        dummy_157040 = head_res_157042;
                    } else {
                        int64_t slice_157043 = stride_155039 + start_155112;
                        int16_t head_res_157044 = ((int16_t *) mem_param_165010.mem)[slice_157043];
                        int64_t head_res_157045 = ((int64_t *) mem_param_165013.mem)[slice_157043];
                        
                        dummy_157039 = head_res_157044;
                        dummy_157040 = head_res_157045;
                    }
                    if (memblock_alloc(ctx, &mem_165091, bytes_165090, "mem_165091")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165720 = 0; nest_i_165720 < next_stride_155040; nest_i_165720++) {
                        ((int16_t *) mem_165091.mem)[nest_i_165720] = dummy_157039;
                    }
                    if (memblock_alloc(ctx, &mem_165093, bytes_165092, "mem_165093")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_165721 = 0; nest_i_165721 < next_stride_155040; nest_i_165721++) {
                        ((int64_t *) mem_165093.mem)[nest_i_165721] = dummy_157040;
                    }
                    
                    int64_t data_157048;
                    int64_t i_157052 = (int64_t) 0;
                    
                    for (int64_t k_157051 = 0; k_157051 < next_stride_155040; k_157051++) {
                        int64_t j_157055 = sub64(k_157051, i_157052);
                        bool cond_157056 = j_157055 == j_m_i_155062;
                        bool cond_157057;
                        
                        if (cond_157056) {
                            cond_157057 = 1;
                        } else {
                            bool cond_157058 = slt64(i_157052, stride_155039);
                            bool cond_f_res_157059;
                            
                            if (cond_157058) {
                                bool x_157060 = sle64((int64_t) 0, j_157055);
                                bool y_157061 = slt64(j_157055, j_m_i_155062);
                                bool bounds_check_157062 = x_157060 && y_157061;
                                bool index_certs_157063;
                                
                                if (!bounds_check_157062) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_157067 = sle64((int64_t) 0, i_157052);
                                bool bounds_check_157068 = cond_157058 && x_157067;
                                bool index_certs_157069;
                                
                                if (!bounds_check_157068) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_157064 = stride_155039 + j_157055;
                                int64_t slice_157065 = start_155112 + slice_157064;
                                int16_t leq_arg1_157066 = ((int16_t *) mem_param_165010.mem)[slice_157065];
                                int64_t slice_157070 = start_155112 + i_157052;
                                int16_t leq_arg0_157071 = ((int16_t *) mem_param_165010.mem)[slice_157070];
                                bool defunc_0_leq_res_157072 = sle16(leq_arg0_157071, leq_arg1_157066);
                                
                                cond_f_res_157059 = defunc_0_leq_res_157072;
                            } else {
                                cond_f_res_157059 = 0;
                            }
                            cond_157057 = cond_f_res_157059;
                        }
                        
                        int64_t loopres_157073;
                        int16_t loopres_157074;
                        int64_t loopres_157075;
                        
                        if (cond_157057) {
                            bool x_157077 = sle64((int64_t) 0, i_157052);
                            bool y_157078 = slt64(i_157052, stride_155039);
                            bool bounds_check_157079 = x_157077 && y_157078;
                            bool index_certs_157080;
                            
                            if (!bounds_check_157079) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_157052, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_157076 = add64((int64_t) 1, i_157052);
                            int64_t slice_157081 = start_155112 + i_157052;
                            int16_t tmp_157082 = ((int16_t *) mem_param_165010.mem)[slice_157081];
                            int64_t tmp_157083 = ((int64_t *) mem_param_165013.mem)[slice_157081];
                            
                            loopres_157073 = tmp_157076;
                            loopres_157074 = tmp_157082;
                            loopres_157075 = tmp_157083;
                        } else {
                            bool x_157084 = sle64((int64_t) 0, j_157055);
                            bool y_157085 = slt64(j_157055, j_m_i_155062);
                            bool bounds_check_157086 = x_157084 && y_157085;
                            bool index_certs_157087;
                            
                            if (!bounds_check_157086) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_157055, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:105:58-61\n   #8  ftRelational.fut:101:36-40\n   #9  ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157088 = stride_155039 + j_157055;
                            int64_t slice_157089 = start_155112 + slice_157088;
                            int16_t tmp_157090 = ((int16_t *) mem_param_165010.mem)[slice_157089];
                            int64_t tmp_157091 = ((int64_t *) mem_param_165013.mem)[slice_157089];
                            
                            loopres_157073 = i_157052;
                            loopres_157074 = tmp_157090;
                            loopres_157075 = tmp_157091;
                        }
                        ((int16_t *) mem_165091.mem)[k_157051] = loopres_157074;
                        ((int64_t *) mem_165093.mem)[k_157051] = loopres_157075;
                        
                        int64_t i_tmp_165722 = loopres_157073;
                        
                        i_157052 = i_tmp_165722;
                    }
                    data_157048 = i_157052;
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165091, "mem_165091") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165093, "mem_165093") != 0)
                        return 1;
                } else {
                    if (mem_165029_cached_sizze_166267 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165029, &mem_165029_cached_sizze_166267, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165031_cached_sizze_166268 < bytes_165028) {
                        err = lexical_realloc(ctx, &mem_165031, &mem_165031_cached_sizze_166268, bytes_165028);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164732 = 0; i_164732 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061; i_164732++) {
                        int64_t split_count_arg3_155192 = mul64(merge_block_sizze_154925, i_164732);
                        int64_t defunc_0_split_count_res_155193;
                        int64_t defunc_0_split_count_res_155194;
                        int64_t defunc_0_split_count_res_155195;
                        int64_t defunc_0_split_count_res_155196;
                        int64_t defunc_0_split_count_res_155197;
                        
                        if (futrts_lifted_normalizze_11249(ctx, &defunc_0_split_count_res_155193, &defunc_0_split_count_res_155194, &defunc_0_split_count_res_155195, &defunc_0_split_count_res_155196, &defunc_0_split_count_res_155197, (int64_t) 0, stride_155039, (int64_t) 0, j_m_i_155062, split_count_arg3_155192) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_155198 = slt64((int64_t) 0, defunc_0_split_count_res_155197);
                        bool defunc_0_split_count_res_155199;
                        int64_t defunc_0_split_count_res_155200;
                        int64_t defunc_0_split_count_res_155201;
                        int64_t defunc_0_split_count_res_155202;
                        int64_t defunc_0_split_count_res_155203;
                        int64_t defunc_0_split_count_res_155204;
                        bool loop_while_155205;
                        int64_t ss_155206;
                        int64_t ss_155207;
                        int64_t tt_155208;
                        int64_t tt_155209;
                        int64_t count_155210;
                        
                        loop_while_155205 = loop_cond_155198;
                        ss_155206 = defunc_0_split_count_res_155193;
                        ss_155207 = defunc_0_split_count_res_155194;
                        tt_155208 = defunc_0_split_count_res_155195;
                        tt_155209 = defunc_0_split_count_res_155196;
                        count_155210 = defunc_0_split_count_res_155197;
                        while (loop_while_155205) {
                            int64_t zlze_lhs_155211 = sub64(ss_155207, ss_155206);
                            bool cond_155212 = sle64(zlze_lhs_155211, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_155213;
                            int64_t defunc_0_lifted_step_res_155214;
                            int64_t defunc_0_lifted_step_res_155215;
                            int64_t defunc_0_lifted_step_res_155216;
                            
                            if (cond_155212) {
                                int64_t tmp_157094 = add64(tt_155208, count_155210);
                                
                                defunc_0_lifted_step_res_155213 = ss_155206;
                                defunc_0_lifted_step_res_155214 = tmp_157094;
                                defunc_0_lifted_step_res_155215 = tt_155209;
                                defunc_0_lifted_step_res_155216 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_155218 = sub64(tt_155209, tt_155208);
                                bool cond_155219 = sle64(zlze_lhs_155218, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_155220;
                                int64_t defunc_0_lifted_step_res_f_res_155221;
                                int64_t defunc_0_lifted_step_res_f_res_155222;
                                int64_t defunc_0_lifted_step_res_f_res_155223;
                                
                                if (cond_155219) {
                                    int64_t tmp_157095 = add64(ss_155206, count_155210);
                                    
                                    defunc_0_lifted_step_res_f_res_155220 = tmp_157095;
                                    defunc_0_lifted_step_res_f_res_155221 = tt_155208;
                                    defunc_0_lifted_step_res_f_res_155222 = tt_155209;
                                    defunc_0_lifted_step_res_f_res_155223 = (int64_t) 0;
                                } else {
                                    bool cond_155225 = count_155210 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155226;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155227;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155228;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_155229;
                                    
                                    if (cond_155225) {
                                        bool x_157097 = sle64((int64_t) 0, ss_155206);
                                        bool y_157098 = slt64(ss_155206, stride_155039);
                                        bool bounds_check_157099 = x_157097 && y_157098;
                                        bool index_certs_157100;
                                        
                                        if (!bounds_check_157099) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_155206, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_157103 = sle64((int64_t) 0, tt_155208);
                                        bool y_157104 = slt64(tt_155208, j_m_i_155062);
                                        bool bounds_check_157105 = x_157103 && y_157104;
                                        bool index_certs_157106;
                                        
                                        if (!bounds_check_157105) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_155208, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_157101 = start_155112 + ss_155206;
                                        int16_t leq_arg1_157102 = ((int16_t *) mem_param_165010.mem)[slice_157101];
                                        int64_t slice_157107 = stride_155039 + tt_155208;
                                        int64_t slice_157108 = start_155112 + slice_157107;
                                        int16_t leq_arg0_157109 = ((int16_t *) mem_param_165010.mem)[slice_157108];
                                        bool defunc_0_leq_res_157110 = sle16(leq_arg0_157109, leq_arg1_157102);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        
                                        if (defunc_0_leq_res_157110) {
                                            int64_t tmp_157113 = add64((int64_t) 1, tt_155208);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = ss_155206;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tmp_157113;
                                        } else {
                                            int64_t tmp_157114 = add64((int64_t) 1, ss_155206);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157111 = tmp_157114;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_157112 = tt_155208;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = defunc_0_lifted_step_res_f_res_f_res_t_res_157111;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_t_res_157112;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = tt_155209;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = (int64_t) 0;
                                    } else {
                                        int64_t m_155248 = sdiv64(count_155210, (int64_t) 2);
                                        int64_t n_155249 = sub64(count_155210, m_155248);
                                        bool cond_155250 = n_155249 == (int64_t) 0;
                                        int64_t zgze_lhs_155251 = add64(ss_155206, m_155248);
                                        bool cond_f_res_155252 = sle64(ss_155207, zgze_lhs_155251);
                                        bool x_155253 = !cond_155250;
                                        bool y_155254 = cond_f_res_155252 && x_155253;
                                        bool cond_155255 = cond_155250 || y_155254;
                                        bool leq_y_x_155256;
                                        
                                        if (cond_155255) {
                                            leq_y_x_155256 = 1;
                                        } else {
                                            bool x_155257 = sle64((int64_t) 0, zgze_lhs_155251);
                                            bool y_155258 = slt64(zgze_lhs_155251, stride_155039);
                                            bool bounds_check_155259 = x_155257 && y_155258;
                                            bool index_certs_155260;
                                            
                                            if (!bounds_check_155259) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_155251, "] out of bounds for array of shape [", (long long) stride_155039, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_155263 = add64(tt_155208, n_155249);
                                            int64_t leq_arg0_155264 = sub64(zm_lhs_155263, (int64_t) 1);
                                            bool x_155265 = sle64((int64_t) 0, leq_arg0_155264);
                                            bool y_155266 = slt64(leq_arg0_155264, j_m_i_155062);
                                            bool bounds_check_155267 = x_155265 && y_155266;
                                            bool index_certs_155268;
                                            
                                            if (!bounds_check_155267) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_155264, "] out of bounds for array of shape [", (long long) j_m_i_155062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:105:58-61\n   #12 ftRelational.fut:101:36-40\n   #13 ftRelational.fut:98:9-101:40\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_155261 = start_155112 + zgze_lhs_155251;
                                            int16_t leq_arg1_155262 = ((int16_t *) mem_param_165010.mem)[slice_155261];
                                            int64_t slice_155269 = stride_155039 + leq_arg0_155264;
                                            int64_t slice_155270 = start_155112 + slice_155269;
                                            int16_t leq_arg0_155271 = ((int16_t *) mem_param_165010.mem)[slice_155270];
                                            bool defunc_0_leq_res_155272 = sle16(leq_arg0_155271, leq_arg1_155262);
                                            
                                            leq_y_x_155256 = defunc_0_leq_res_155272;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                        
                                        if (leq_y_x_155256) {
                                            int64_t tmp_157115 = add64(tt_155208, n_155249);
                                            int64_t tmp_157116 = sub64(count_155210, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tmp_157115;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tt_155209;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = tmp_157116;
                                        } else {
                                            int64_t tmp_155278 = add64(tt_155208, n_155249);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155273 = tt_155208;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155274 = tmp_155278;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_155275 = count_155210;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_155226 = ss_155206;
                                        defunc_0_lifted_step_res_f_res_f_res_155227 = defunc_0_lifted_step_res_f_res_f_res_f_res_155273;
                                        defunc_0_lifted_step_res_f_res_f_res_155228 = defunc_0_lifted_step_res_f_res_f_res_f_res_155274;
                                        defunc_0_lifted_step_res_f_res_f_res_155229 = defunc_0_lifted_step_res_f_res_f_res_f_res_155275;
                                    }
                                    defunc_0_lifted_step_res_f_res_155220 = defunc_0_lifted_step_res_f_res_f_res_155226;
                                    defunc_0_lifted_step_res_f_res_155221 = defunc_0_lifted_step_res_f_res_f_res_155227;
                                    defunc_0_lifted_step_res_f_res_155222 = defunc_0_lifted_step_res_f_res_f_res_155228;
                                    defunc_0_lifted_step_res_f_res_155223 = defunc_0_lifted_step_res_f_res_f_res_155229;
                                }
                                defunc_0_lifted_step_res_155213 = defunc_0_lifted_step_res_f_res_155220;
                                defunc_0_lifted_step_res_155214 = defunc_0_lifted_step_res_f_res_155221;
                                defunc_0_lifted_step_res_155215 = defunc_0_lifted_step_res_f_res_155222;
                                defunc_0_lifted_step_res_155216 = defunc_0_lifted_step_res_f_res_155223;
                            }
                            
                            int64_t loopres_155279;
                            int64_t loopres_155280;
                            int64_t loopres_155281;
                            int64_t loopres_155282;
                            int64_t loopres_155283;
                            
                            if (futrts_lifted_normalizze_11249(ctx, &loopres_155279, &loopres_155280, &loopres_155281, &loopres_155282, &loopres_155283, defunc_0_lifted_step_res_155213, ss_155207, defunc_0_lifted_step_res_155214, defunc_0_lifted_step_res_155215, defunc_0_lifted_step_res_155216) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_155284 = slt64((int64_t) 0, loopres_155283);
                            bool loop_while_tmp_165727 = loop_cond_155284;
                            int64_t ss_tmp_165728 = loopres_155279;
                            int64_t ss_tmp_165729 = loopres_155280;
                            int64_t tt_tmp_165730 = loopres_155281;
                            int64_t tt_tmp_165731 = loopres_155282;
                            int64_t count_tmp_165732 = loopres_155283;
                            
                            loop_while_155205 = loop_while_tmp_165727;
                            ss_155206 = ss_tmp_165728;
                            ss_155207 = ss_tmp_165729;
                            tt_155208 = tt_tmp_165730;
                            tt_155209 = tt_tmp_165731;
                            count_155210 = count_tmp_165732;
                        }
                        defunc_0_split_count_res_155199 = loop_while_155205;
                        defunc_0_split_count_res_155200 = ss_155206;
                        defunc_0_split_count_res_155201 = ss_155207;
                        defunc_0_split_count_res_155202 = tt_155208;
                        defunc_0_split_count_res_155203 = tt_155209;
                        defunc_0_split_count_res_155204 = count_155210;
                        ((int64_t *) mem_165029)[i_164732] = defunc_0_split_count_res_155200;
                        ((int64_t *) mem_165031)[i_164732] = defunc_0_split_count_res_155202;
                    }
                    if (mem_165046_cached_sizze_166269 < bytes_165045) {
                        err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166269, bytes_165045);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_165049_cached_sizze_166270 < bytes_165048) {
                        err = lexical_realloc(ctx, &mem_165049, &mem_165049_cached_sizze_166270, bytes_165048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_164739 = 0; i_164739 < num_blocks_155060; i_164739++) {
                        bool y_155290 = slt64(i_164739, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool index_certs_155292;
                        
                        if (!y_155290) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164739, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155293 = ((int64_t *) mem_165029)[i_164739];
                        int64_t defunc_0_f_res_155294 = ((int64_t *) mem_165031)[i_164739];
                        int64_t tmp_155295 = add64((int64_t) 1, i_164739);
                        bool x_155296 = sle64((int64_t) 0, tmp_155295);
                        bool y_155297 = slt64(tmp_155295, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061);
                        bool bounds_check_155298 = x_155296 && y_155297;
                        bool index_certs_155299;
                        
                        if (!bounds_check_155298) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_155295, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_155061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_155300 = ((int64_t *) mem_165029)[tmp_155295];
                        int64_t defunc_0_f_res_155301 = ((int64_t *) mem_165031)[tmp_155295];
                        int64_t merge_sequential_arg2_155302 = add64(stride_155039, defunc_0_f_res_155294);
                        int64_t merge_sequential_arg2_155303 = add64(stride_155039, defunc_0_f_res_155301);
                        int64_t j_m_i_155304 = sub64(merge_sequential_arg2_155303, merge_sequential_arg2_155302);
                        bool empty_slice_155305 = j_m_i_155304 == (int64_t) 0;
                        int64_t m_155306 = sub64(j_m_i_155304, (int64_t) 1);
                        int64_t i_p_m_t_s_155307 = add64(merge_sequential_arg2_155302, m_155306);
                        bool zzero_leq_i_p_m_t_s_155308 = sle64((int64_t) 0, i_p_m_t_s_155307);
                        bool i_p_m_t_s_leq_w_155309 = slt64(i_p_m_t_s_155307, next_stride_155040);
                        bool zzero_lte_i_155310 = sle64((int64_t) 0, merge_sequential_arg2_155302);
                        bool i_lte_j_155311 = sle64(merge_sequential_arg2_155302, merge_sequential_arg2_155303);
                        bool y_155312 = i_p_m_t_s_leq_w_155309 && zzero_lte_i_155310;
                        bool y_155313 = zzero_leq_i_p_m_t_s_155308 && y_155312;
                        bool forwards_ok_155314 = i_lte_j_155311 && y_155313;
                        bool ok_or_empty_155315 = empty_slice_155305 || forwards_ok_155314;
                        bool index_certs_155316;
                        
                        if (!ok_or_empty_155315) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_155302, ":", (long long) merge_sequential_arg2_155303, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_155317 = sub64(defunc_0_f_res_155300, defunc_0_f_res_155293);
                        bool empty_slice_155318 = j_m_i_155317 == (int64_t) 0;
                        int64_t m_155319 = sub64(j_m_i_155317, (int64_t) 1);
                        int64_t i_p_m_t_s_155320 = add64(defunc_0_f_res_155293, m_155319);
                        bool zzero_leq_i_p_m_t_s_155321 = sle64((int64_t) 0, i_p_m_t_s_155320);
                        bool i_p_m_t_s_leq_w_155322 = slt64(i_p_m_t_s_155320, next_stride_155040);
                        bool zzero_lte_i_155323 = sle64((int64_t) 0, defunc_0_f_res_155293);
                        bool i_lte_j_155324 = sle64(defunc_0_f_res_155293, defunc_0_f_res_155300);
                        bool y_155325 = i_p_m_t_s_leq_w_155322 && zzero_lte_i_155323;
                        bool y_155326 = zzero_leq_i_p_m_t_s_155321 && y_155325;
                        bool forwards_ok_155327 = i_lte_j_155324 && y_155326;
                        bool ok_or_empty_155328 = empty_slice_155318 || forwards_ok_155327;
                        bool index_certs_155329;
                        
                        if (!ok_or_empty_155328) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_155293, ":", (long long) defunc_0_f_res_155300, "] out of bounds for array of shape [", (long long) next_stride_155040, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:105:58-61\n   #9  ftRelational.fut:101:36-40\n   #10 ftRelational.fut:98:9-101:40\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_155330 = slt64((int64_t) 0, j_m_i_155317);
                        int16_t dummy_155331;
                        int64_t dummy_155332;
                        
                        if (cond_155330) {
                            bool index_certs_157117;
                            
                            if (!cond_155330) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:101:36-40\n   #12 ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_157118 = start_155112 + defunc_0_f_res_155293;
                            int16_t head_res_157119 = ((int16_t *) mem_param_165010.mem)[slice_157118];
                            int64_t head_res_157120 = ((int64_t *) mem_param_165013.mem)[slice_157118];
                            
                            dummy_155331 = head_res_157119;
                            dummy_155332 = head_res_157120;
                        } else {
                            bool y_155337 = slt64((int64_t) 0, j_m_i_155304);
                            bool index_certs_155338;
                            
                            if (!y_155337) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:105:58-61\n   #11 ftRelational.fut:101:36-40\n   #12 ftRelational.fut:98:9-101:40\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_155339 = start_155112 + merge_sequential_arg2_155302;
                            int16_t head_res_155340 = ((int16_t *) mem_param_165010.mem)[slice_155339];
                            int64_t head_res_155341 = ((int64_t *) mem_param_165013.mem)[slice_155339];
                            
                            dummy_155331 = head_res_155340;
                            dummy_155332 = head_res_155341;
                        }
                        for (int64_t nest_i_165735 = 0; nest_i_165735 < merge_block_sizze_154925; nest_i_165735++) {
                            ((int16_t *) mem_165046)[i_164739 * merge_block_sizze_154925 + nest_i_165735] = dummy_155331;
                        }
                        for (int64_t nest_i_165736 = 0; nest_i_165736 < merge_block_sizze_154925; nest_i_165736++) {
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + nest_i_165736] = dummy_155332;
                        }
                        
                        int64_t data_155344;
                        int64_t i_155348 = (int64_t) 0;
                        
                        for (int64_t k_155347 = 0; k_155347 < merge_block_sizze_154925; k_155347++) {
                            int64_t j_155351 = sub64(k_155347, i_155348);
                            bool cond_155352 = j_155351 == j_m_i_155304;
                            bool cond_155353;
                            
                            if (cond_155352) {
                                cond_155353 = 1;
                            } else {
                                bool cond_155354 = slt64(i_155348, j_m_i_155317);
                                bool cond_f_res_155355;
                                
                                if (cond_155354) {
                                    bool x_157121 = sle64((int64_t) 0, j_155351);
                                    bool y_157122 = slt64(j_155351, j_m_i_155304);
                                    bool bounds_check_157123 = x_157121 && y_157122;
                                    bool index_certs_157124;
                                    
                                    if (!bounds_check_157123) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_157128 = sle64((int64_t) 0, i_155348);
                                    bool bounds_check_157129 = cond_155354 && x_157128;
                                    bool index_certs_157130;
                                    
                                    if (!bounds_check_157129) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_157125 = merge_sequential_arg2_155302 + j_155351;
                                    int64_t slice_157126 = start_155112 + slice_157125;
                                    int16_t leq_arg1_157127 = ((int16_t *) mem_param_165010.mem)[slice_157126];
                                    int64_t slice_157131 = defunc_0_f_res_155293 + i_155348;
                                    int64_t slice_157132 = start_155112 + slice_157131;
                                    int16_t leq_arg0_157133 = ((int16_t *) mem_param_165010.mem)[slice_157132];
                                    bool defunc_0_leq_res_157134 = sle16(leq_arg0_157133, leq_arg1_157127);
                                    
                                    cond_f_res_155355 = defunc_0_leq_res_157134;
                                } else {
                                    cond_f_res_155355 = 0;
                                }
                                cond_155353 = cond_f_res_155355;
                            }
                            
                            int64_t loopres_155370;
                            int16_t loopres_155371;
                            int64_t loopres_155372;
                            
                            if (cond_155353) {
                                bool x_157136 = sle64((int64_t) 0, i_155348);
                                bool y_157137 = slt64(i_155348, j_m_i_155317);
                                bool bounds_check_157138 = x_157136 && y_157137;
                                bool index_certs_157139;
                                
                                if (!bounds_check_157138) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_155348, "] out of bounds for array of shape [", (long long) j_m_i_155317, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_157135 = add64((int64_t) 1, i_155348);
                                int64_t slice_157140 = defunc_0_f_res_155293 + i_155348;
                                int64_t slice_157141 = start_155112 + slice_157140;
                                int16_t tmp_157142 = ((int16_t *) mem_param_165010.mem)[slice_157141];
                                int64_t tmp_157143 = ((int64_t *) mem_param_165013.mem)[slice_157141];
                                
                                loopres_155370 = tmp_157135;
                                loopres_155371 = tmp_157142;
                                loopres_155372 = tmp_157143;
                            } else {
                                bool x_155382 = sle64((int64_t) 0, j_155351);
                                bool y_155383 = slt64(j_155351, j_m_i_155304);
                                bool bounds_check_155384 = x_155382 && y_155383;
                                bool index_certs_155385;
                                
                                if (!bounds_check_155384) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_155351, "] out of bounds for array of shape [", (long long) j_m_i_155304, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:105:58-61\n   #10 ftRelational.fut:101:36-40\n   #11 ftRelational.fut:98:9-101:40\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_155386 = merge_sequential_arg2_155302 + j_155351;
                                int64_t slice_155387 = start_155112 + slice_155386;
                                int16_t tmp_155388 = ((int16_t *) mem_param_165010.mem)[slice_155387];
                                int64_t tmp_155389 = ((int64_t *) mem_param_165013.mem)[slice_155387];
                                
                                loopres_155370 = i_155348;
                                loopres_155371 = tmp_155388;
                                loopres_155372 = tmp_155389;
                            }
                            ((int16_t *) mem_165046)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155371;
                            ((int64_t *) mem_165049)[i_164739 * merge_block_sizze_154925 + k_155347] = loopres_155372;
                            
                            int64_t i_tmp_165737 = loopres_155370;
                            
                            i_155348 = i_tmp_165737;
                        }
                        data_155344 = i_155348;
                    }
                    if (memblock_alloc(ctx, &mem_165084, bytes_165045, "mem_165084")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_165084.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint16_t *) mem_165046, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_alloc(ctx, &mem_165088, bytes_165048, "mem_165088")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_165088.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (uint64_t *) mem_165049, (int64_t) 0, (int64_t []) {merge_block_sizze_154925, (int64_t) 1}, (int64_t []) {num_blocks_155060, merge_block_sizze_154925});
                    if (memblock_set(ctx, &ext_mem_165111, &mem_165084, "mem_165084") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_165108, &mem_165088, "mem_165088") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_165016, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_165111.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165019, i_164746 * next_stride_155040, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165108.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_155040});
                if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
                    return 1;
            }
            
            int64_t flat_dim_155396 = next_stride_155040 * num_merges_155044;
            
            if (memblock_alloc(ctx, &mem_165122, bytes_165015, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_165122.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint16_t *) mem_165016, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            if (memblock_alloc(ctx, &mem_165126, bytes_165018, "mem_165126")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_165126.mem, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (uint64_t *) mem_165019, (int64_t) 0, (int64_t []) {next_stride_155040, (int64_t) 1}, (int64_t []) {num_merges_155044, next_stride_155040});
            
            bool loop_cond_155399 = slt64(next_stride_155040, flat_dim_154921);
            
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165126, "mem_165126") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_165713 = flat_dim_155396;
            bool loop_while_tmp_165714 = loop_cond_155399;
            int64_t stride_tmp_165717 = next_stride_155040;
            
            if (memblock_set(ctx, &mem_param_165010, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_165013, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            loop_dz2084Uz2082U_155035 = loop_dz2084Uz2082U_tmp_165713;
            loop_while_155036 = loop_while_tmp_165714;
            stride_155039 = stride_tmp_165717;
        }
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165132, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        data_155030 = loop_dz2084Uz2082U_155035;
        data_155031 = loop_while_155036;
        data_155034 = stride_155039;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        
        bool empty_slice_155400 = n_86533 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_155401 = sle64((int64_t) 0, zs_lhs_154905);
        bool i_p_m_t_s_leq_w_155402 = slt64(zs_lhs_154905, data_155030);
        bool y_155403 = zzero_leq_i_p_m_t_s_155401 && i_p_m_t_s_leq_w_155402;
        bool ok_or_empty_155404 = empty_slice_155400 || y_155403;
        bool index_certs_155405;
        
        if (!ok_or_empty_155404) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_86533, "] out of bounds for array of shape [", (long long) data_155030, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:105:58-61\n   #5  ftRelational.fut:101:36-40\n   #6  ftRelational.fut:98:9-101:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_165136, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165138, bytes_165137, "mem_165138")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_165140, bytes_165139, "mem_165140")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164753 = 0; i_164753 < n_86533; i_164753++) {
        int64_t eta_p_155413 = ((int64_t *) ext_mem_165136.mem)[i_164753];
        bool x_155414 = sle64((int64_t) 0, eta_p_155413);
        bool y_155415 = slt64(eta_p_155413, n_86533);
        bool bounds_check_155416 = x_155414 && y_155415;
        bool index_certs_155417;
        
        if (!bounds_check_155416) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_155413, "] out of bounds for array of shape [", (long long) n_86533, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:105:58-61\n   #4  ftRelational.fut:101:36-40\n   #5  ftRelational.fut:98:9-101:40\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t lifted_lambda_res_155418 = ((int16_t *) k_mem_164928.mem)[eta_p_155413];
        
        ((int16_t *) mem_165138.mem)[i_164753] = lifted_lambda_res_155418;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165140.mem, i_164753 * b_86534, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_164929.mem, eta_p_155413 * b_86534, (int64_t []) {(int64_t) 1}, (int64_t []) {b_86534});
    }
    if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165138, "mem_165138") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165140, "mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166259, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166260, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164934);
        free(mem_164937);
        free(mem_164947);
        free(mem_164949);
        free(mem_165016);
        free(mem_165019);
        free(mem_165029);
        free(mem_165031);
        free(mem_165046);
        free(mem_165049);
        if (memblock_unref(ctx, &mem_165140, "mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165138, "mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165126, "mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165088, "mem_165088") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165084, "mem_165084") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165093, "mem_165093") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165091, "mem_165091") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165108, "ext_mem_165108") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165111, "ext_mem_165111") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165013, "mem_param_165013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_165010, "mem_param_165010") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165132, "ext_mem_165132") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165006, "mem_165006") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165002, "mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_166271, struct memblock eta_p_mem_164928, int64_t nz2080U_74332)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t defunc_0_reduce_res_157003;
    int64_t redout_164711 = (int64_t) 9223372036854775807;
    
    for (int64_t i_164712 = 0; i_164712 < nz2080U_74332; i_164712++) {
        int64_t x_145616 = ((int64_t *) eta_p_mem_164928.mem)[i_164712];
        int64_t min_res_145619 = smin64(x_145616, redout_164711);
        int64_t redout_tmp_165694 = min_res_145619;
        
        redout_164711 = redout_tmp_165694;
    }
    defunc_0_reduce_res_157003 = redout_164711;
    prim_out_165693 = defunc_0_reduce_res_157003;
    *out_prim_out_166271 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_166272, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_76042, int64_t incr_76043, int64_t block_sizze_76044)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_76042;
    bool zzero_145873 = block_sizze_76044 == (int64_t) 0;
    bool nonzzero_145874 = !zzero_145873;
    bool nonzzero_cert_145875;
    
    if (!nonzzero_145874) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:37:1-39:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < n_76042; i_164713++) {
        int64_t eta_p_145869 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145870 = sub64(eta_p_145869, incr_76043);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145870;
    }
    
    int64_t zm_lhs_145871 = add64(n_76042, block_sizze_76044);
    int64_t zs_lhs_145872 = sub64(zm_lhs_145871, (int64_t) 1);
    int64_t m_145876 = sdiv64(zs_lhs_145872, block_sizze_76044);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164930, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_76042; nest_i_165695++) {
        ((double *) mem_164939.mem)[nest_i_165695] = 0.0;
    }
    
    bool loop_cond_145878 = slt64((int64_t) 0, m_145876);
    bool partitioned_gather_res_145879;
    int64_t partitioned_gather_res_145882;
    bool loop_while_145883;
    int64_t p_145886;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145883 = loop_cond_145878;
    p_145886 = (int64_t) 0;
    while (loop_while_145883) {
        int64_t lower_bound_145887 = mul64(block_sizze_76044, p_145886);
        int64_t min_arg1_145888 = add64(block_sizze_76044, lower_bound_145887);
        int64_t min_res_145889 = smin64(n_76042, min_arg1_145888);
        int64_t j_m_i_145890 = sub64(min_res_145889, lower_bound_145887);
        bool empty_slice_145891 = j_m_i_145890 == (int64_t) 0;
        int64_t m_145892 = sub64(j_m_i_145890, (int64_t) 1);
        int64_t i_p_m_t_s_145893 = add64(lower_bound_145887, m_145892);
        bool zzero_leq_i_p_m_t_s_145894 = sle64((int64_t) 0, i_p_m_t_s_145893);
        bool i_p_m_t_s_leq_w_145895 = slt64(i_p_m_t_s_145893, n_76042);
        bool zzero_lte_i_145896 = sle64((int64_t) 0, lower_bound_145887);
        bool i_lte_j_145897 = sle64(lower_bound_145887, min_res_145889);
        bool y_145898 = i_p_m_t_s_leq_w_145895 && zzero_lte_i_145896;
        bool y_145899 = zzero_leq_i_p_m_t_s_145894 && y_145898;
        bool forwards_ok_145900 = i_lte_j_145897 && y_145899;
        bool ok_or_empty_145901 = empty_slice_145891 || forwards_ok_145900;
        bool index_certs_145902;
        
        if (!ok_or_empty_145901) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145887, ":", (long long) min_res_145889, "] out of bounds for array of shape [", (long long) n_76042, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:37:1-39:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_76042});
        if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < n_76042; i_164717++) {
            int64_t eta_p_145905 = ((int64_t *) mem_param_164942.mem)[i_164717];
            double eta_p_145906 = ((double *) mem_param_164945.mem)[i_164717];
            bool cond_145907 = sle64(lower_bound_145887, eta_p_145905);
            bool cond_t_res_145908 = slt64(eta_p_145905, min_res_145889);
            bool x_145909 = cond_145907 && cond_t_res_145908;
            double lifted_lambda_res_145910;
            
            if (x_145909) {
                int64_t tmp_157003 = sub64(eta_p_145905, lower_bound_145887);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145890);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145890, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:158:3-49\n   #4  ftRelational.fut:37:1-39:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double tmp_157008 = ((double *) ys_mem_164929.mem)[eta_p_145905];
                
                lifted_lambda_res_145910 = tmp_157008;
            } else {
                lifted_lambda_res_145910 = eta_p_145906;
            }
            ((double *) mem_164949.mem)[i_164717] = lifted_lambda_res_145910;
        }
        
        int64_t tmp_145917 = add64((int64_t) 1, p_145886);
        bool loop_cond_145918 = slt64(tmp_145917, m_145876);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145918;
        int64_t p_tmp_165701 = tmp_145917;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145883 = loop_while_tmp_165698;
        p_145886 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145879 = loop_while_145883;
    partitioned_gather_res_145882 = p_145886;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164930, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_76042});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166272, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_166273, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_75708, int64_t incr_75709, int64_t block_sizze_75710)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_75708;
    bool zzero_145873 = block_sizze_75710 == (int64_t) 0;
    bool nonzzero_145874 = !zzero_145873;
    bool nonzzero_cert_145875;
    
    if (!nonzzero_145874) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:34:1-36:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = (int64_t) 4 * n_75708;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < n_75708; i_164713++) {
        int64_t eta_p_145869 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145870 = sub64(eta_p_145869, incr_75709);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145870;
    }
    
    int64_t zm_lhs_145871 = add64(n_75708, block_sizze_75710);
    int64_t zs_lhs_145872 = sub64(zm_lhs_145871, (int64_t) 1);
    int64_t m_145876 = sdiv64(zs_lhs_145872, block_sizze_75710);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_75708; nest_i_165695++) {
        ((float *) mem_164939.mem)[nest_i_165695] = 0.0F;
    }
    
    bool loop_cond_145878 = slt64((int64_t) 0, m_145876);
    bool partitioned_gather_res_145879;
    int64_t partitioned_gather_res_145882;
    bool loop_while_145883;
    int64_t p_145886;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145883 = loop_cond_145878;
    p_145886 = (int64_t) 0;
    while (loop_while_145883) {
        int64_t lower_bound_145887 = mul64(block_sizze_75710, p_145886);
        int64_t min_arg1_145888 = add64(block_sizze_75710, lower_bound_145887);
        int64_t min_res_145889 = smin64(n_75708, min_arg1_145888);
        int64_t j_m_i_145890 = sub64(min_res_145889, lower_bound_145887);
        bool empty_slice_145891 = j_m_i_145890 == (int64_t) 0;
        int64_t m_145892 = sub64(j_m_i_145890, (int64_t) 1);
        int64_t i_p_m_t_s_145893 = add64(lower_bound_145887, m_145892);
        bool zzero_leq_i_p_m_t_s_145894 = sle64((int64_t) 0, i_p_m_t_s_145893);
        bool i_p_m_t_s_leq_w_145895 = slt64(i_p_m_t_s_145893, n_75708);
        bool zzero_lte_i_145896 = sle64((int64_t) 0, lower_bound_145887);
        bool i_lte_j_145897 = sle64(lower_bound_145887, min_res_145889);
        bool y_145898 = i_p_m_t_s_leq_w_145895 && zzero_lte_i_145896;
        bool y_145899 = zzero_leq_i_p_m_t_s_145894 && y_145898;
        bool forwards_ok_145900 = i_lte_j_145897 && y_145899;
        bool ok_or_empty_145901 = empty_slice_145891 || forwards_ok_145900;
        bool index_certs_145902;
        
        if (!ok_or_empty_145901) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145887, ":", (long long) min_res_145889, "] out of bounds for array of shape [", (long long) n_75708, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:34:1-36:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_75708});
        if (memblock_alloc(ctx, &mem_164949, bytes_164938, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < n_75708; i_164717++) {
            int64_t eta_p_145905 = ((int64_t *) mem_param_164942.mem)[i_164717];
            float eta_p_145906 = ((float *) mem_param_164945.mem)[i_164717];
            bool cond_145907 = sle64(lower_bound_145887, eta_p_145905);
            bool cond_t_res_145908 = slt64(eta_p_145905, min_res_145889);
            bool x_145909 = cond_145907 && cond_t_res_145908;
            float lifted_lambda_res_145910;
            
            if (x_145909) {
                int64_t tmp_157003 = sub64(eta_p_145905, lower_bound_145887);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145890);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145890, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:158:3-49\n   #4  ftRelational.fut:34:1-36:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float tmp_157008 = ((float *) ys_mem_164929.mem)[eta_p_145905];
                
                lifted_lambda_res_145910 = tmp_157008;
            } else {
                lifted_lambda_res_145910 = eta_p_145906;
            }
            ((float *) mem_164949.mem)[i_164717] = lifted_lambda_res_145910;
        }
        
        int64_t tmp_145917 = add64((int64_t) 1, p_145886);
        bool loop_cond_145918 = slt64(tmp_145917, m_145876);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145918;
        int64_t p_tmp_165701 = tmp_145917;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145883 = loop_while_tmp_165698;
        p_145886 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145879 = loop_while_145883;
    partitioned_gather_res_145882 = p_145886;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164938, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_75708});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166273, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_166274, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_75040, int64_t incr_75041, int64_t block_sizze_75042)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_75040;
    bool zzero_145873 = block_sizze_75042 == (int64_t) 0;
    bool nonzzero_145874 = !zzero_145873;
    bool nonzzero_cert_145875;
    
    if (!nonzzero_145874) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:28:1-30:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = (int64_t) 4 * n_75040;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < n_75040; i_164713++) {
        int64_t eta_p_145869 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145870 = sub64(eta_p_145869, incr_75041);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145870;
    }
    
    int64_t zm_lhs_145871 = add64(n_75040, block_sizze_75042);
    int64_t zs_lhs_145872 = sub64(zm_lhs_145871, (int64_t) 1);
    int64_t m_145876 = sdiv64(zs_lhs_145872, block_sizze_75042);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_75040; nest_i_165695++) {
        ((int32_t *) mem_164939.mem)[nest_i_165695] = 0;
    }
    
    bool loop_cond_145878 = slt64((int64_t) 0, m_145876);
    bool partitioned_gather_res_145879;
    int64_t partitioned_gather_res_145882;
    bool loop_while_145883;
    int64_t p_145886;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145883 = loop_cond_145878;
    p_145886 = (int64_t) 0;
    while (loop_while_145883) {
        int64_t lower_bound_145887 = mul64(block_sizze_75042, p_145886);
        int64_t min_arg1_145888 = add64(block_sizze_75042, lower_bound_145887);
        int64_t min_res_145889 = smin64(n_75040, min_arg1_145888);
        int64_t j_m_i_145890 = sub64(min_res_145889, lower_bound_145887);
        bool empty_slice_145891 = j_m_i_145890 == (int64_t) 0;
        int64_t m_145892 = sub64(j_m_i_145890, (int64_t) 1);
        int64_t i_p_m_t_s_145893 = add64(lower_bound_145887, m_145892);
        bool zzero_leq_i_p_m_t_s_145894 = sle64((int64_t) 0, i_p_m_t_s_145893);
        bool i_p_m_t_s_leq_w_145895 = slt64(i_p_m_t_s_145893, n_75040);
        bool zzero_lte_i_145896 = sle64((int64_t) 0, lower_bound_145887);
        bool i_lte_j_145897 = sle64(lower_bound_145887, min_res_145889);
        bool y_145898 = i_p_m_t_s_leq_w_145895 && zzero_lte_i_145896;
        bool y_145899 = zzero_leq_i_p_m_t_s_145894 && y_145898;
        bool forwards_ok_145900 = i_lte_j_145897 && y_145899;
        bool ok_or_empty_145901 = empty_slice_145891 || forwards_ok_145900;
        bool index_certs_145902;
        
        if (!ok_or_empty_145901) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145887, ":", (long long) min_res_145889, "] out of bounds for array of shape [", (long long) n_75040, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:28:1-30:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_75040});
        if (memblock_alloc(ctx, &mem_164949, bytes_164938, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < n_75040; i_164717++) {
            int64_t eta_p_145905 = ((int64_t *) mem_param_164942.mem)[i_164717];
            int32_t eta_p_145906 = ((int32_t *) mem_param_164945.mem)[i_164717];
            bool cond_145907 = sle64(lower_bound_145887, eta_p_145905);
            bool cond_t_res_145908 = slt64(eta_p_145905, min_res_145889);
            bool x_145909 = cond_145907 && cond_t_res_145908;
            int32_t lifted_lambda_res_145910;
            
            if (x_145909) {
                int64_t tmp_157003 = sub64(eta_p_145905, lower_bound_145887);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145890);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145890, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:158:3-49\n   #4  ftRelational.fut:28:1-30:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t tmp_157008 = ((int32_t *) ys_mem_164929.mem)[eta_p_145905];
                
                lifted_lambda_res_145910 = tmp_157008;
            } else {
                lifted_lambda_res_145910 = eta_p_145906;
            }
            ((int32_t *) mem_164949.mem)[i_164717] = lifted_lambda_res_145910;
        }
        
        int64_t tmp_145917 = add64((int64_t) 1, p_145886);
        bool loop_cond_145918 = slt64(tmp_145917, m_145876);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145918;
        int64_t p_tmp_165701 = tmp_145917;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145883 = loop_while_tmp_165698;
        p_145886 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145879 = loop_while_145883;
    partitioned_gather_res_145882 = p_145886;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164938, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_75040});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166274, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_166275, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_75374, int64_t incr_75375, int64_t block_sizze_75376)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_75374;
    bool zzero_145873 = block_sizze_75376 == (int64_t) 0;
    bool nonzzero_145874 = !zzero_145873;
    bool nonzzero_cert_145875;
    
    if (!nonzzero_145874) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:31:1-33:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < n_75374; i_164713++) {
        int64_t eta_p_145869 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145870 = sub64(eta_p_145869, incr_75375);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145870;
    }
    
    int64_t zm_lhs_145871 = add64(n_75374, block_sizze_75376);
    int64_t zs_lhs_145872 = sub64(zm_lhs_145871, (int64_t) 1);
    int64_t m_145876 = sdiv64(zs_lhs_145872, block_sizze_75376);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164930, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_75374; nest_i_165695++) {
        ((int64_t *) mem_164939.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    bool loop_cond_145878 = slt64((int64_t) 0, m_145876);
    bool partitioned_gather_res_145879;
    int64_t partitioned_gather_res_145882;
    bool loop_while_145883;
    int64_t p_145886;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145883 = loop_cond_145878;
    p_145886 = (int64_t) 0;
    while (loop_while_145883) {
        int64_t lower_bound_145887 = mul64(block_sizze_75376, p_145886);
        int64_t min_arg1_145888 = add64(block_sizze_75376, lower_bound_145887);
        int64_t min_res_145889 = smin64(n_75374, min_arg1_145888);
        int64_t j_m_i_145890 = sub64(min_res_145889, lower_bound_145887);
        bool empty_slice_145891 = j_m_i_145890 == (int64_t) 0;
        int64_t m_145892 = sub64(j_m_i_145890, (int64_t) 1);
        int64_t i_p_m_t_s_145893 = add64(lower_bound_145887, m_145892);
        bool zzero_leq_i_p_m_t_s_145894 = sle64((int64_t) 0, i_p_m_t_s_145893);
        bool i_p_m_t_s_leq_w_145895 = slt64(i_p_m_t_s_145893, n_75374);
        bool zzero_lte_i_145896 = sle64((int64_t) 0, lower_bound_145887);
        bool i_lte_j_145897 = sle64(lower_bound_145887, min_res_145889);
        bool y_145898 = i_p_m_t_s_leq_w_145895 && zzero_lte_i_145896;
        bool y_145899 = zzero_leq_i_p_m_t_s_145894 && y_145898;
        bool forwards_ok_145900 = i_lte_j_145897 && y_145899;
        bool ok_or_empty_145901 = empty_slice_145891 || forwards_ok_145900;
        bool index_certs_145902;
        
        if (!ok_or_empty_145901) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145887, ":", (long long) min_res_145889, "] out of bounds for array of shape [", (long long) n_75374, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:31:1-33:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_75374});
        if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < n_75374; i_164717++) {
            int64_t eta_p_145905 = ((int64_t *) mem_param_164942.mem)[i_164717];
            int64_t eta_p_145906 = ((int64_t *) mem_param_164945.mem)[i_164717];
            bool cond_145907 = sle64(lower_bound_145887, eta_p_145905);
            bool cond_t_res_145908 = slt64(eta_p_145905, min_res_145889);
            bool x_145909 = cond_145907 && cond_t_res_145908;
            int64_t lifted_lambda_res_145910;
            
            if (x_145909) {
                int64_t tmp_157003 = sub64(eta_p_145905, lower_bound_145887);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145890);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145890, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:158:3-49\n   #4  ftRelational.fut:31:1-33:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_157008 = ((int64_t *) ys_mem_164929.mem)[eta_p_145905];
                
                lifted_lambda_res_145910 = tmp_157008;
            } else {
                lifted_lambda_res_145910 = eta_p_145906;
            }
            ((int64_t *) mem_164949.mem)[i_164717] = lifted_lambda_res_145910;
        }
        
        int64_t tmp_145917 = add64((int64_t) 1, p_145886);
        bool loop_cond_145918 = slt64(tmp_145917, m_145876);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145918;
        int64_t p_tmp_165701 = tmp_145917;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145883 = loop_while_tmp_165698;
        p_145886 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145879 = loop_while_145883;
    partitioned_gather_res_145882 = p_145886;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164930, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_75374});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166275, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_166276, struct memblock is_mem_164928, struct memblock ys_mem_164929, int64_t n_74706, int64_t incr_74707, int64_t block_sizze_74708)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_164947;
    
    mem_164947.references = NULL;
    
    struct memblock mem_param_164945;
    
    mem_param_164945.references = NULL;
    
    struct memblock mem_param_164942;
    
    mem_param_164942.references = NULL;
    
    struct memblock ext_mem_164960;
    
    ext_mem_164960.references = NULL;
    
    struct memblock ext_mem_164961;
    
    ext_mem_164961.references = NULL;
    
    struct memblock mem_164939;
    
    mem_164939.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t bytes_164930 = (int64_t) 8 * n_74706;
    bool zzero_145873 = block_sizze_74708 == (int64_t) 0;
    bool nonzzero_145874 = !zzero_145873;
    bool nonzzero_cert_145875;
    
    if (!nonzzero_145874) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:24:22-28\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:25:1-27:48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164938 = (int64_t) 2 * n_74706;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_164713 = 0; i_164713 < n_74706; i_164713++) {
        int64_t eta_p_145869 = ((int64_t *) is_mem_164928.mem)[i_164713];
        int64_t lifted_lambda_res_145870 = sub64(eta_p_145869, incr_74707);
        
        ((int64_t *) mem_164931.mem)[i_164713] = lifted_lambda_res_145870;
    }
    
    int64_t zm_lhs_145871 = add64(n_74706, block_sizze_74708);
    int64_t zs_lhs_145872 = sub64(zm_lhs_145871, (int64_t) 1);
    int64_t m_145876 = sdiv64(zs_lhs_145872, block_sizze_74708);
    
    if (memblock_alloc(ctx, &mem_164939, bytes_164938, "mem_164939")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_74706; nest_i_165695++) {
        ((int16_t *) mem_164939.mem)[nest_i_165695] = (int16_t) 0;
    }
    
    bool loop_cond_145878 = slt64((int64_t) 0, m_145876);
    bool partitioned_gather_res_145879;
    int64_t partitioned_gather_res_145882;
    bool loop_while_145883;
    int64_t p_145886;
    
    if (memblock_set(ctx, &mem_param_164942, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164945, &mem_164939, "mem_164939") != 0)
        return 1;
    loop_while_145883 = loop_cond_145878;
    p_145886 = (int64_t) 0;
    while (loop_while_145883) {
        int64_t lower_bound_145887 = mul64(block_sizze_74708, p_145886);
        int64_t min_arg1_145888 = add64(block_sizze_74708, lower_bound_145887);
        int64_t min_res_145889 = smin64(n_74706, min_arg1_145888);
        int64_t j_m_i_145890 = sub64(min_res_145889, lower_bound_145887);
        bool empty_slice_145891 = j_m_i_145890 == (int64_t) 0;
        int64_t m_145892 = sub64(j_m_i_145890, (int64_t) 1);
        int64_t i_p_m_t_s_145893 = add64(lower_bound_145887, m_145892);
        bool zzero_leq_i_p_m_t_s_145894 = sle64((int64_t) 0, i_p_m_t_s_145893);
        bool i_p_m_t_s_leq_w_145895 = slt64(i_p_m_t_s_145893, n_74706);
        bool zzero_lte_i_145896 = sle64((int64_t) 0, lower_bound_145887);
        bool i_lte_j_145897 = sle64(lower_bound_145887, min_res_145889);
        bool y_145898 = i_p_m_t_s_leq_w_145895 && zzero_lte_i_145896;
        bool y_145899 = zzero_leq_i_p_m_t_s_145894 && y_145898;
        bool forwards_ok_145900 = i_lte_j_145897 && y_145899;
        bool ok_or_empty_145901 = empty_slice_145891 || forwards_ok_145900;
        bool index_certs_145902;
        
        if (!ok_or_empty_145901) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_145887, ":", (long long) min_res_145889, "] out of bounds for array of shape [", (long long) n_74706, "].", "-> #0  ftbasics.fut:31:18-45\n   #1  ftSMJ.fut:158:3-49\n   #2  ftRelational.fut:25:1-27:48\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_164947, bytes_164930, "mem_164947")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164947.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164942.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_74706});
        if (memblock_alloc(ctx, &mem_164949, bytes_164938, "mem_164949")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_164717 = 0; i_164717 < n_74706; i_164717++) {
            int64_t eta_p_145905 = ((int64_t *) mem_param_164942.mem)[i_164717];
            int16_t eta_p_145906 = ((int16_t *) mem_param_164945.mem)[i_164717];
            bool cond_145907 = sle64(lower_bound_145887, eta_p_145905);
            bool cond_t_res_145908 = slt64(eta_p_145905, min_res_145889);
            bool x_145909 = cond_145907 && cond_t_res_145908;
            int16_t lifted_lambda_res_145910;
            
            if (x_145909) {
                int64_t tmp_157003 = sub64(eta_p_145905, lower_bound_145887);
                bool x_157004 = sle64((int64_t) 0, tmp_157003);
                bool y_157005 = slt64(tmp_157003, j_m_i_145890);
                bool bounds_check_157006 = x_157004 && y_157005;
                bool index_certs_157007;
                
                if (!bounds_check_157006) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157003, "] out of bounds for array of shape [", (long long) j_m_i_145890, "].", "-> #0  ftbasics.fut:34:16-37\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:32:30-36:6\n   #3  ftSMJ.fut:158:3-49\n   #4  ftRelational.fut:25:1-27:48\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t tmp_157008 = ((int16_t *) ys_mem_164929.mem)[eta_p_145905];
                
                lifted_lambda_res_145910 = tmp_157008;
            } else {
                lifted_lambda_res_145910 = eta_p_145906;
            }
            ((int16_t *) mem_164949.mem)[i_164717] = lifted_lambda_res_145910;
        }
        
        int64_t tmp_145917 = add64((int64_t) 1, p_145886);
        bool loop_cond_145918 = slt64(tmp_145917, m_145876);
        
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164949, "mem_164949") != 0)
            return 1;
        
        bool loop_while_tmp_165698 = loop_cond_145918;
        int64_t p_tmp_165701 = tmp_145917;
        
        if (memblock_set(ctx, &mem_param_164942, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164945, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        loop_while_145883 = loop_while_tmp_165698;
        p_145886 = p_tmp_165701;
    }
    if (memblock_set(ctx, &ext_mem_164961, &mem_param_164942, "mem_param_164942") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164960, &mem_param_164945, "mem_param_164945") != 0)
        return 1;
    partitioned_gather_res_145879 = loop_while_145883;
    partitioned_gather_res_145882 = p_145886;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164963, bytes_164938, "mem_164963")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_74706});
    if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164963, "mem_164963") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166276, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164947, "mem_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164945, "mem_param_164945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164942, "mem_param_164942") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164960, "ext_mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164961, "ext_mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164939, "mem_164939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_166277, struct memblock *mem_out_p_166278, struct memblock xs_mem_164928, struct memblock pL_mem_164929, int64_t n_138594, int64_t b_138595, int64_t pL_b_138596, int16_t block_sizze_138597, int64_t gather_psizze_138598, int32_t radix_sizze_138599, int64_t sizze_thresh_138602, int32_t max_depth_138603)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164975_cached_sizze_166279 = 0;
    unsigned char *mem_164975 = NULL;
    int64_t mem_165009_cached_sizze_166280 = 0;
    unsigned char *mem_165009 = NULL;
    int64_t mem_165011_cached_sizze_166281 = 0;
    unsigned char *mem_165011 = NULL;
    int64_t mem_165020_cached_sizze_166282 = 0;
    unsigned char *mem_165020 = NULL;
    int64_t mem_165021_cached_sizze_166283 = 0;
    unsigned char *mem_165021 = NULL;
    int64_t mem_165052_cached_sizze_166284 = 0;
    unsigned char *mem_165052 = NULL;
    int64_t mem_165054_cached_sizze_166285 = 0;
    unsigned char *mem_165054 = NULL;
    int64_t mem_165056_cached_sizze_166286 = 0;
    unsigned char *mem_165056 = NULL;
    int64_t mem_165058_cached_sizze_166287 = 0;
    unsigned char *mem_165058 = NULL;
    int64_t mem_165084_cached_sizze_166288 = 0;
    unsigned char *mem_165084 = NULL;
    int64_t mem_165086_cached_sizze_166289 = 0;
    unsigned char *mem_165086 = NULL;
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_param_tmp_165698;
    
    mem_param_tmp_165698.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_param_tmp_165710;
    
    mem_param_tmp_165710.references = NULL;
    
    struct memblock mem_param_tmp_165709;
    
    mem_param_tmp_165709.references = NULL;
    
    struct memblock mem_param_tmp_165708;
    
    mem_param_tmp_165708.references = NULL;
    
    struct memblock mem_165122;
    
    mem_165122.references = NULL;
    
    struct memblock mem_165120;
    
    mem_165120.references = NULL;
    
    struct memblock mem_165102;
    
    mem_165102.references = NULL;
    
    struct memblock mem_165100;
    
    mem_165100.references = NULL;
    
    struct memblock ext_mem_165049;
    
    ext_mem_165049.references = NULL;
    
    struct memblock ext_mem_165050;
    
    ext_mem_165050.references = NULL;
    
    struct memblock mem_165047;
    
    mem_165047.references = NULL;
    
    struct memblock mem_param_tmp_165719;
    
    mem_param_tmp_165719.references = NULL;
    
    struct memblock mem_param_tmp_165718;
    
    mem_param_tmp_165718.references = NULL;
    
    struct memblock mem_164999;
    
    mem_164999.references = NULL;
    
    struct memblock mem_164997;
    
    mem_164997.references = NULL;
    
    struct memblock mem_param_tmp_165726;
    
    mem_param_tmp_165726.references = NULL;
    
    struct memblock mem_164986;
    
    mem_164986.references = NULL;
    
    struct memblock mem_param_164984;
    
    mem_param_164984.references = NULL;
    
    struct memblock ext_mem_164995;
    
    ext_mem_164995.references = NULL;
    
    struct memblock mem_param_164970;
    
    mem_param_164970.references = NULL;
    
    struct memblock mem_param_164966;
    
    mem_param_164966.references = NULL;
    
    struct memblock ext_mem_165044;
    
    ext_mem_165044.references = NULL;
    
    struct memblock ext_mem_165045;
    
    ext_mem_165045.references = NULL;
    
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_param_164960;
    
    mem_param_164960.references = NULL;
    
    struct memblock mem_param_164956;
    
    mem_param_164956.references = NULL;
    
    struct memblock mem_param_164952;
    
    mem_param_164952.references = NULL;
    
    struct memblock mem_param_164949;
    
    mem_param_164949.references = NULL;
    
    struct memblock ext_mem_165133;
    
    ext_mem_165133.references = NULL;
    
    struct memblock ext_mem_165134;
    
    ext_mem_165134.references = NULL;
    
    struct memblock ext_mem_165135;
    
    ext_mem_165135.references = NULL;
    
    struct memblock ext_mem_165136;
    
    ext_mem_165136.references = NULL;
    
    struct memblock mem_param_164946;
    
    mem_param_164946.references = NULL;
    
    struct memblock mem_param_164943;
    
    mem_param_164943.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164936;
    
    mem_param_164936.references = NULL;
    
    struct memblock ext_mem_165147;
    
    ext_mem_165147.references = NULL;
    
    struct memblock ext_mem_165148;
    
    ext_mem_165148.references = NULL;
    
    struct memblock ext_mem_165149;
    
    ext_mem_165149.references = NULL;
    
    struct memblock ext_mem_165150;
    
    ext_mem_165150.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    if (memblock_alloc(ctx, &mem_164930, (int64_t) 8, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < (int64_t) 1; nest_i_165695++) {
        ((int64_t *) mem_164930.mem)[nest_i_165695] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_164931, (int64_t) 8, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165696 = 0; nest_i_165696 < (int64_t) 1; nest_i_165696++) {
        ((int64_t *) mem_164931.mem)[nest_i_165696] = n_138594;
    }
    
    bool loop_cond_t_res_149290 = slt32(0, max_depth_138603);
    
    if (memblock_alloc(ctx, &mem_164932, (int64_t) 0, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_149341 = sext_i64_i32(b_138595);
    int32_t zm_lhs_149342 = mul32(8, i64_res_149341);
    int32_t min_arg1_149343 = sub32(zm_lhs_149342, 1);
    bool zzero_149362 = gather_psizze_138598 == (int64_t) 0;
    bool nonzzero_149363 = !zzero_149362;
    int64_t bytes_165099 = n_138594 * b_138595;
    int64_t bytes_165101 = n_138594 * pL_b_138596;
    
    if (mem_165020_cached_sizze_166282 < b_138595) {
        err = lexical_realloc(ctx, &mem_165020, &mem_165020_cached_sizze_166282, b_138595);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_165021_cached_sizze_166283 < pL_b_138596) {
        err = lexical_realloc(ctx, &mem_165021, &mem_165021_cached_sizze_166283, pL_b_138596);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_149292;
    bool partition_and_deepen_res_149293;
    int32_t partition_and_deepen_res_149294;
    int64_t loop_dz2087U_149299;
    bool loop_while_149300;
    int32_t p_149301;
    
    if (memblock_set(ctx, &mem_param_164936, &pL_mem_164929, "pL_mem_164929") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164943, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164946, &mem_164931, "mem_164931") != 0)
        return 1;
    loop_dz2087U_149299 = (int64_t) 1;
    loop_while_149300 = loop_cond_t_res_149290;
    p_149301 = 0;
    while (loop_while_149300) {
        bool loop_nonempty_155438 = slt64((int64_t) 0, loop_dz2087U_149299);
        int32_t newDepth_149337 = add32(1, p_149301);
        int32_t new_i_149338 = mul32(radix_sizze_138599, p_149301);
        int32_t zm_lhs_149339 = mul32(radix_sizze_138599, newDepth_149337);
        int32_t new_j_149340 = sub32(zm_lhs_149339, 1);
        int32_t min_res_149344 = smin32(new_j_149340, min_arg1_149343);
        int32_t tmp_149345 = add32(2, new_i_149338);
        int64_t i_149346 = sext_i32_i64(new_i_149338);
        int64_t j__149347 = sext_i32_i64(min_res_149344);
        int64_t tmp_149348 = sext_i32_i64(tmp_149345);
        bool step_zzero_149349 = new_i_149338 == tmp_149345;
        bool bounds_invalid_upwards_149350 = slt32(min_res_149344, new_i_149338);
        int32_t distance_upwards_exclusive_149351 = sub32(min_res_149344, new_i_149338);
        int64_t distance_exclusive_149352 = sext_i32_i64(distance_upwards_exclusive_149351);
        int64_t distance_149353 = add64((int64_t) 1, distance_exclusive_149352);
        bool range_invalid_149354 = step_zzero_149349 || bounds_invalid_upwards_149350;
        bool valid_149355 = !range_invalid_149354;
        bool loop_not_taken_155439 = !loop_nonempty_155438;
        bool protect_assert_disj_155440 = valid_149355 || loop_not_taken_155439;
        bool range_valid_c_149356;
        
        if (!protect_assert_disj_155440) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_149346, "..", (long long) tmp_149348, "...", (long long) j__149347, " is invalid.", "-> #0  ftHashJoin.fut:207:15-37\n   #1  ftHashJoin.fut:252:20-258:6\n   #2  ftRelational.fut:225:5-88\n   #3  ftRelational.fut:215:1-226:30\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_149357 = sdiv_up64(distance_149353, (int64_t) 2);
        bool loop_nonempty_149358 = slt64((int64_t) 0, num_elems_149357);
        bool loop_not_taken_149364 = !loop_nonempty_149358;
        bool protect_assert_disj_149365 = nonzzero_149363 || loop_not_taken_149364;
        bool protect_assert_disj_155442 = protect_assert_disj_149365 || loop_not_taken_155439;
        bool nonzzero_cert_149366;
        
        if (!protect_assert_disj_155442) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftHashJoin.fut:194:87-90\n   #2  ftHashJoin.fut:208:6-71\n   #3  ftHashJoin.fut:252:20-258:6\n   #4  ftRelational.fut:225:5-88\n   #5  ftRelational.fut:215:1-226:30\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_149306;
        int64_t loop_dz2081Uz2089U_149312;
        
        if (memblock_set(ctx, &mem_param_164949, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164952, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164956, &mem_param_164936, "mem_param_164936") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164960, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        loop_dz2081Uz2089U_149312 = (int64_t) 0;
        for (int64_t i_149311 = 0; i_149311 < loop_dz2087U_149299; i_149311++) {
            int64_t bounds_149317 = ((int64_t *) mem_param_164943.mem)[i_149311];
            int64_t bounds_149318 = ((int64_t *) mem_param_164946.mem)[i_149311];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319 = sub64(bounds_149318, bounds_149317);
            bool empty_slice_149320 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319 == (int64_t) 0;
            int64_t m_149321 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, (int64_t) 1);
            int64_t i_p_m_t_s_149322 = add64(bounds_149317, m_149321);
            bool zzero_leq_i_p_m_t_s_149323 = sle64((int64_t) 0, i_p_m_t_s_149322);
            bool i_p_m_t_s_leq_w_149324 = slt64(i_p_m_t_s_149322, n_138594);
            bool zzero_lte_i_149325 = sle64((int64_t) 0, bounds_149317);
            bool i_lte_j_149326 = sle64(bounds_149317, bounds_149318);
            bool y_149327 = i_p_m_t_s_leq_w_149324 && zzero_lte_i_149325;
            bool y_149328 = zzero_leq_i_p_m_t_s_149323 && y_149327;
            bool forwards_ok_149329 = i_lte_j_149326 && y_149328;
            bool ok_or_empty_149330 = empty_slice_149320 || forwards_ok_149329;
            bool index_certs_149331;
            
            if (!ok_or_empty_149330) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_149317, ":", (long long) bounds_149318, "] out of bounds for array of shape [", (long long) n_138594, "].", "-> #0  ftHashJoin.fut:285:21-47\n   #1  ftRelational.fut:225:5-88\n   #2  ftRelational.fut:215:1-226:30\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164961 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319;
            
            if (memblock_alloc(ctx, &mem_164962, bytes_164961, "mem_164962")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_165717 = 0; nest_i_165717 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319; nest_i_165717++) {
                ((int64_t *) mem_164962.mem)[nest_i_165717] = (int64_t) 0;
            }
            
            int64_t zm_lhs_149360 = add64(gather_psizze_138598, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319);
            int64_t zs_lhs_149361 = sub64(zm_lhs_149360, (int64_t) 1);
            int64_t m_149367 = sdiv_safe64(zs_lhs_149361, gather_psizze_138598);
            bool loop_cond_149368 = slt64((int64_t) 0, m_149367);
            int64_t binop_y_164971 = b_138595 * bounds_149317;
            int64_t binop_y_164973 = pL_b_138596 * bounds_149317;
            int64_t bytes_164996 = b_138595 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319;
            int64_t bytes_164998 = pL_b_138596 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319;
            
            if (mem_164975_cached_sizze_166279 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319) {
                err = lexical_realloc(ctx, &mem_164975, &mem_164975_cached_sizze_166279, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_165043;
            int64_t ext_165040;
            int64_t ctx_param_ext_164963;
            int64_t ctx_param_ext_164967;
            
            if (memblock_set(ctx, &mem_param_164966, &mem_param_164960, "mem_param_164960") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164970, &mem_param_164956, "mem_param_164956") != 0)
                return 1;
            ctx_param_ext_164963 = binop_y_164971;
            ctx_param_ext_164967 = binop_y_164973;
            for (int64_t i_149371 = 0; i_149371 < num_elems_149357; i_149371++) {
                int32_t binop_x_149374 = sext_i64_i32(i_149371);
                int32_t binop_x_149375 = mul32(2, binop_x_149374);
                int32_t index_primexp_149376 = add32(new_i_149338, binop_x_149375);
                int32_t zm_lhs_149377 = add32(2, index_primexp_149376);
                int32_t min_arg1_149378 = sub32(zm_lhs_149377, 1);
                int32_t min_res_149379 = smin32(min_res_149344, min_arg1_149378);
                int32_t zp_lhs_149380 = sub32(min_res_149379, index_primexp_149376);
                int32_t ij_bits_149381 = add32(1, zp_lhs_149380);
                int32_t up_to_149382 = shl32(1, ij_bits_149381);
                int64_t tmp_149383 = sext_i32_i64(zp_lhs_149380);
                bool bounds_invalid_upwards_149384 = slt32(zp_lhs_149380, 0);
                bool valid_149386 = !bounds_invalid_upwards_149384;
                bool range_valid_c_149387;
                
                if (!valid_149386) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149383, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:194:87-90\n   #3  ftHashJoin.fut:208:6-71\n   #4  ftHashJoin.fut:252:20-258:6\n   #5  ftRelational.fut:225:5-88\n   #6  ftRelational.fut:215:1-226:30\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_149397 = sext_i32_i64(up_to_149382);
                bool bounds_invalid_upwards_149398 = slt32(up_to_149382, 0);
                bool valid_149399 = !bounds_invalid_upwards_149398;
                bool range_valid_c_149400;
                
                if (!valid_149399) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149397, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftHashJoin.fut:194:87-90\n   #2  ftHashJoin.fut:208:6-71\n   #3  ftHashJoin.fut:252:20-258:6\n   #4  ftRelational.fut:225:5-88\n   #5  ftRelational.fut:215:1-226:30\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_149385 = add64((int64_t) 1, tmp_149383);
                
                for (int64_t i_164713 = 0; i_164713 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319; i_164713++) {
                    int8_t defunc_0_f_res_149390;
                    int8_t y_149392 = (int8_t) 0;
                    
                    for (int64_t i_149391 = 0; i_149391 < distance_149385; i_149391++) {
                        int32_t binop_x_149393 = sext_i64_i32(i_149391);
                        int32_t get_bit_arg0_149394 = add32(index_primexp_149376, binop_x_149393);
                        int32_t zm_rhs_156627 = sdiv32(get_bit_arg0_149394, 8);
                        int32_t zm_lhs_156628 = sub32(i64_res_149341, zm_rhs_156627);
                        int32_t whichByte_156629 = sub32(zm_lhs_156628, 1);
                        int64_t whichByte_156631 = sext_i32_i64(whichByte_156629);
                        bool x_156632 = sle64((int64_t) 0, whichByte_156631);
                        bool y_156633 = slt64(whichByte_156631, b_138595);
                        bool bounds_check_156634 = x_156632 && y_156633;
                        bool index_certs_156635;
                        
                        if (!bounds_check_156634) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_156631, "] out of bounds for array of shape [", (long long) b_138595, "].", "-> #0  ftHashJoin.fut:17:6-18\n   #1  ftRelational.fut:225:5-88\n   #2  ftRelational.fut:215:1-226:30\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_156630 = smod32(get_bit_arg0_149394, 8);
                        int8_t zbzg_lhs_156636 = ((int8_t *) mem_param_164966.mem)[ctx_param_ext_164963 + (i_164713 * b_138595 + whichByte_156631)];
                        int8_t unsign_arg0_156637 = zext_i32_i8(whichBit_156630);
                        int8_t unsign_arg0_156638 = ashr8(zbzg_lhs_156636, unsign_arg0_156637);
                        int8_t unsign_arg0_156639 = (int8_t) 1 & unsign_arg0_156638;
                        int32_t to_i32_res_156640 = zext_i8_i32(unsign_arg0_156639);
                        int8_t loopres_149396;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_149396, binop_x_149393, y_149392, to_i32_res_156640) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_165725 = loopres_149396;
                        
                        y_149392 = y_tmp_165725;
                    }
                    defunc_0_f_res_149390 = y_149392;
                    ((int8_t *) mem_164975)[i_164713] = defunc_0_f_res_149390;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_149401;
                int64_t offs_149404;
                
                if (memblock_set(ctx, &mem_param_164984, &mem_164962, "mem_164962") != 0)
                    return 1;
                offs_149404 = (int64_t) 0;
                for (int64_t i_149403 = 0; i_149403 < up_to_149397; i_149403++) {
                    int32_t binop_x_149406 = sext_i64_i32(i_149403);
                    int8_t index_primexp_149407 = zext_i32_i8(binop_x_149406);
                    
                    if (memblock_alloc(ctx, &mem_164986, bytes_164961, "mem_164986")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_157416;
                    int64_t defunc_0_reduce_res_157417;
                    int64_t inpacc_157237;
                    int64_t inpacc_157238;
                    
                    inpacc_157237 = (int64_t) 0;
                    inpacc_157238 = (int64_t) 0;
                    for (int64_t i_164731 = 0; i_164731 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319; i_164731++) {
                        int8_t eta_p_164901 = ((int8_t *) mem_164975)[i_164731];
                        bool lifted_lambda_res_164902 = eta_p_164901 == index_primexp_149407;
                        int64_t bool_res_164903 = btoi_bool_i64(lifted_lambda_res_164902);
                        int64_t eta_p_164916 = ((int64_t *) mem_param_164984.mem)[i_164731];
                        int64_t defunc_0_op_res_164917 = add64(inpacc_157237, bool_res_164903);
                        int64_t zm_lhs_164918 = add64(offs_149404, defunc_0_op_res_164917);
                        int64_t lifted_lambda_res_164919 = sub64(zm_lhs_164918, (int64_t) 1);
                        int64_t defunc_0_f_res_164920 = mul64(bool_res_164903, lifted_lambda_res_164919);
                        int64_t defunc_0_f_res_164921 = add64(eta_p_164916, defunc_0_f_res_164920);
                        int64_t defunc_0_op_res_157286 = add64(inpacc_157238, bool_res_164903);
                        
                        ((int64_t *) mem_164986.mem)[i_164731] = defunc_0_f_res_164921;
                        
                        int64_t inpacc_tmp_165729 = defunc_0_op_res_164917;
                        int64_t inpacc_tmp_165730 = defunc_0_op_res_157286;
                        
                        inpacc_157237 = inpacc_tmp_165729;
                        inpacc_157238 = inpacc_tmp_165730;
                    }
                    inpacc_157416 = inpacc_157237;
                    defunc_0_reduce_res_157417 = inpacc_157238;
                    
                    int64_t tmp_149432 = add64(offs_149404, defunc_0_reduce_res_157417);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165726, &mem_164986, "mem_164986") != 0)
                        return 1;
                    
                    int64_t offs_tmp_165727 = tmp_149432;
                    
                    if (memblock_set(ctx, &mem_param_164984, &mem_param_tmp_165726, "mem_param_tmp_165726") != 0)
                        return 1;
                    offs_149404 = offs_tmp_165727;
                }
                if (memblock_set(ctx, &ext_mem_164995, &mem_param_164984, "mem_param_164984") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_149401 = offs_149404;
                if (memblock_alloc(ctx, &mem_164997, bytes_164996, "mem_164997")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_164997.mem, (int64_t) 0, (int64_t []) {b_138595, (int64_t) 1}, (uint8_t *) mem_param_164966.mem, ctx_param_ext_164963, (int64_t []) {b_138595, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, b_138595});
                if (memblock_alloc(ctx, &mem_164999, bytes_164998, "mem_164999")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_164999.mem, (int64_t) 0, (int64_t []) {pL_b_138596, (int64_t) 1}, (uint8_t *) mem_param_164970.mem, ctx_param_ext_164967, (int64_t []) {pL_b_138596, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, pL_b_138596});
                
                bool partitioned_scatter_res_149439;
                int64_t partitioned_scatter_res_149442;
                bool loop_while_149443;
                int64_t p_149446;
                
                loop_while_149443 = loop_cond_149368;
                p_149446 = (int64_t) 0;
                while (loop_while_149443) {
                    int64_t lower_bound_149447 = mul64(gather_psizze_138598, p_149446);
                    int64_t min_arg1_149448 = add64(gather_psizze_138598, lower_bound_149447);
                    int64_t min_res_149449 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, min_arg1_149448);
                    int64_t j_m_i_149450 = sub64(min_res_149449, lower_bound_149447);
                    bool empty_slice_149451 = j_m_i_149450 == (int64_t) 0;
                    int64_t m_149452 = sub64(j_m_i_149450, (int64_t) 1);
                    int64_t i_p_m_t_s_149453 = add64(lower_bound_149447, m_149452);
                    bool zzero_leq_i_p_m_t_s_149454 = sle64((int64_t) 0, i_p_m_t_s_149453);
                    bool i_p_m_t_s_leq_w_149455 = slt64(i_p_m_t_s_149453, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319);
                    bool zzero_lte_i_149456 = sle64((int64_t) 0, lower_bound_149447);
                    bool i_lte_j_149457 = sle64(lower_bound_149447, min_res_149449);
                    bool y_149458 = i_p_m_t_s_leq_w_149455 && zzero_lte_i_149456;
                    bool y_149459 = zzero_leq_i_p_m_t_s_149454 && y_149458;
                    bool forwards_ok_149460 = i_lte_j_149457 && y_149459;
                    bool ok_or_empty_149461 = empty_slice_149451 || forwards_ok_149460;
                    bool index_certs_149462;
                    
                    if (!ok_or_empty_149461) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149447, ":", (long long) min_res_149449, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftHashJoin.fut:194:87-90\n   #2  ftHashJoin.fut:208:6-71\n   #3  ftHashJoin.fut:252:20-258:6\n   #4  ftRelational.fut:225:5-88\n   #5  ftRelational.fut:215:1-226:30\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_165008 = b_138595 * j_m_i_149450;
                    int64_t bytes_165010 = pL_b_138596 * j_m_i_149450;
                    
                    if (mem_165009_cached_sizze_166280 < bytes_165008) {
                        err = lexical_realloc(ctx, &mem_165009, &mem_165009_cached_sizze_166280, bytes_165008);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165009, (int64_t) 0, (int64_t []) {b_138595, (int64_t) 1}, (uint8_t *) mem_164997.mem, (int64_t) 0 + b_138595 * lower_bound_149447, (int64_t []) {b_138595, (int64_t) 1}, (int64_t []) {j_m_i_149450, b_138595});
                    if (mem_165011_cached_sizze_166281 < bytes_165010) {
                        err = lexical_realloc(ctx, &mem_165011, &mem_165011_cached_sizze_166281, bytes_165010);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165011, (int64_t) 0, (int64_t []) {pL_b_138596, (int64_t) 1}, (uint8_t *) mem_164999.mem, (int64_t) 0 + pL_b_138596 * lower_bound_149447, (int64_t []) {pL_b_138596, (int64_t) 1}, (int64_t []) {j_m_i_149450, pL_b_138596});
                    for (int64_t write_iter_164733 = 0; write_iter_164733 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319; write_iter_164733++) {
                        int64_t write_iv_164736 = ((int64_t *) ext_mem_164995.mem)[write_iter_164733];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165020, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164966.mem, ctx_param_ext_164963 + write_iter_164733 * b_138595, (int64_t []) {(int64_t) 1}, (int64_t []) {b_138595});
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165021, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164970.mem, ctx_param_ext_164967 + write_iter_164733 * pL_b_138596, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_138596});
                        
                        bool cond_157329 = sle64(lower_bound_149447, write_iv_164736);
                        bool cond_t_res_157330 = slt64(write_iv_164736, min_res_149449);
                        bool x_157331 = cond_157329 && cond_t_res_157330;
                        int64_t lifted_lambda_res_157332;
                        
                        if (x_157331) {
                            int64_t lifted_lambda_res_t_res_157419 = sub64(write_iv_164736, lower_bound_149447);
                            
                            lifted_lambda_res_157332 = lifted_lambda_res_t_res_157419;
                        } else {
                            lifted_lambda_res_157332 = (int64_t) -1;
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_157332) && slt64(lifted_lambda_res_157332, j_m_i_149450)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_138595 - (int64_t) 1, b_138595))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165009, lifted_lambda_res_157332 * b_138595, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_165020, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_138595});
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_157332) && slt64(lifted_lambda_res_157332, j_m_i_149450)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(pL_b_138596 - (int64_t) 1, pL_b_138596))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165011, lifted_lambda_res_157332 * pL_b_138596, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_165021, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_138596});
                        }
                    }
                    
                    int64_t tmp_149474 = add64((int64_t) 1, p_149446);
                    
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_164997.mem, b_138595 * lower_bound_149447, (int64_t []) {b_138595, (int64_t) 1}, (uint8_t *) mem_165009, (int64_t) 0, (int64_t []) {b_138595, (int64_t) 1}, (int64_t []) {j_m_i_149450, b_138595});
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_164999.mem, pL_b_138596 * lower_bound_149447, (int64_t []) {pL_b_138596, (int64_t) 1}, (uint8_t *) mem_165011, (int64_t) 0, (int64_t []) {pL_b_138596, (int64_t) 1}, (int64_t []) {j_m_i_149450, pL_b_138596});
                    
                    bool loop_cond_149482 = slt64(tmp_149474, m_149367);
                    bool loop_while_tmp_165732 = loop_cond_149482;
                    int64_t p_tmp_165735 = tmp_149474;
                    
                    loop_while_149443 = loop_while_tmp_165732;
                    p_149446 = p_tmp_165735;
                }
                partitioned_scatter_res_149439 = loop_while_149443;
                partitioned_scatter_res_149442 = p_149446;
                if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_165718, &mem_164997, "mem_164997") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_165719, &mem_164999, "mem_164999") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_165720 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_165721 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_164966, &mem_param_tmp_165718, "mem_param_tmp_165718") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_164970, &mem_param_tmp_165719, "mem_param_tmp_165719") != 0)
                    return 1;
                ctx_param_ext_164963 = ctx_param_ext_tmp_165720;
                ctx_param_ext_164967 = ctx_param_ext_tmp_165721;
            }
            if (memblock_set(ctx, &ext_mem_165045, &mem_param_164966, "mem_param_164966") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165044, &mem_param_164970, "mem_param_164970") != 0)
                return 1;
            ext_165043 = ctx_param_ext_164963;
            ext_165040 = ctx_param_ext_164967;
            if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165047, bytes_164996, "mem_165047")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165047.mem, (int64_t) 0, (int64_t []) {b_138595, (int64_t) 1}, (uint8_t *) ext_mem_165045.mem, ext_165043, (int64_t []) {b_138595, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, b_138595});
            
            int64_t deepen_step_res_149483;
            int64_t deepen_step_res_149484;
            int32_t deepen_step_res_149487;
            
            if (futrts_getPartitionBounds_12923(ctx, &ext_mem_165050, &ext_mem_165049, &deepen_step_res_149483, &deepen_step_res_149484, &deepen_step_res_149487, mem_165047, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, b_138595, newDepth_149337, new_i_149338, new_j_149340) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_165047, "mem_165047") != 0)
                return 1;
            
            int64_t zl_rhs_155452 = sub64(deepen_step_res_149483, (int64_t) 1);
            int64_t bytes_165051 = (int64_t) 8 * deepen_step_res_149483;
            
            if (mem_165052_cached_sizze_166284 < bytes_165051) {
                err = lexical_realloc(ctx, &mem_165052, &mem_165052_cached_sizze_166284, bytes_165051);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165054_cached_sizze_166285 < bytes_165051) {
                err = lexical_realloc(ctx, &mem_165054, &mem_165054_cached_sizze_166285, bytes_165051);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165056_cached_sizze_166286 < bytes_165051) {
                err = lexical_realloc(ctx, &mem_165056, &mem_165056_cached_sizze_166286, bytes_165051);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165058_cached_sizze_166287 < bytes_165051) {
                err = lexical_realloc(ctx, &mem_165058, &mem_165058_cached_sizze_166287, bytes_165051);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_164755;
            int64_t scanacc_164745 = (int64_t) 0;
            
            for (int64_t i_164750 = 0; i_164750 < deepen_step_res_149483; i_164750++) {
                int64_t tmp_157026 = ((int64_t *) ext_mem_165050.mem)[i_164750];
                bool cond_157027 = slt64(i_164750, zl_rhs_155452);
                int64_t tmp_157028;
                
                if (cond_157027) {
                    int64_t tmp_157423 = add64((int64_t) 1, i_164750);
                    bool x_157424 = sle64((int64_t) 0, tmp_157423);
                    bool y_157425 = slt64(tmp_157423, deepen_step_res_149483);
                    bool bounds_check_157426 = x_157424 && y_157425;
                    bool index_certs_157427;
                    
                    if (!bounds_check_157426) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157423, "] out of bounds for array of shape [", (long long) deepen_step_res_149483, "].", "-> #0  ftHashJoin.fut:262:67-81\n   #1  ftRelational.fut:225:5-88\n   #2  ftRelational.fut:215:1-226:30\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_157428 = ((int64_t *) ext_mem_165050.mem)[tmp_157423];
                    
                    tmp_157028 = tmp_t_res_157428;
                } else {
                    tmp_157028 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319;
                }
                
                int64_t zg_lhs_157037 = sub64(tmp_157028, tmp_157026);
                bool lifted_lambda_res_157038 = slt64(sizze_thresh_138602, zg_lhs_157037);
                int64_t defunc_0_f_res_157039 = btoi_bool_i64(lifted_lambda_res_157038);
                int64_t defunc_0_op_res_149504 = add64(defunc_0_f_res_157039, scanacc_164745);
                
                ((int64_t *) mem_165052)[i_164750] = defunc_0_op_res_149504;
                ((int64_t *) mem_165054)[i_164750] = defunc_0_f_res_157039;
                ((int64_t *) mem_165056)[i_164750] = tmp_157026;
                ((int64_t *) mem_165058)[i_164750] = tmp_157028;
                
                int64_t scanacc_tmp_165738 = defunc_0_op_res_149504;
                
                scanacc_164745 = scanacc_tmp_165738;
            }
            discard_164755 = scanacc_164745;
            if (memblock_unref(ctx, &ext_mem_165050, "ext_mem_165050") != 0)
                return 1;
            
            bool cond_149505 = deepen_step_res_149483 == (int64_t) 0;
            bool x_149506 = !cond_149505;
            bool x_149508 = sle64((int64_t) 0, zl_rhs_155452);
            bool y_149509 = slt64(zl_rhs_155452, deepen_step_res_149483);
            bool bounds_check_149510 = x_149508 && y_149509;
            bool protect_assert_disj_149511 = cond_149505 || bounds_check_149510;
            bool index_certs_149512;
            
            if (!protect_assert_disj_149511) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_155452, "] out of bounds for array of shape [", (long long) deepen_step_res_149483, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:263:8-49\n   #3  ftRelational.fut:225:5-88\n   #4  ftRelational.fut:215:1-226:30\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_149513;
            
            if (x_149506) {
                int64_t x_157429 = ((int64_t *) mem_165052)[zl_rhs_155452];
                
                m_f_res_149513 = x_157429;
            } else {
                m_f_res_149513 = (int64_t) 0;
            }
            
            int64_t m_149515;
            
            if (cond_149505) {
                m_149515 = (int64_t) 0;
            } else {
                m_149515 = m_f_res_149513;
            }
            
            int64_t m_149525 = sub64(m_149515, (int64_t) 1);
            bool i_p_m_t_s_leq_w_149527 = slt64(m_149525, deepen_step_res_149483);
            bool zzero_leq_i_p_m_t_s_149526 = sle64((int64_t) 0, m_149525);
            bool y_149529 = zzero_leq_i_p_m_t_s_149526 && i_p_m_t_s_leq_w_149527;
            bool i_lte_j_149528 = sle64((int64_t) 0, m_149515);
            bool forwards_ok_149530 = i_lte_j_149528 && y_149529;
            bool eq_x_zz_149522 = (int64_t) 0 == m_f_res_149513;
            bool p_and_eq_x_y_149523 = x_149506 && eq_x_zz_149522;
            bool empty_slice_149524 = cond_149505 || p_and_eq_x_y_149523;
            bool ok_or_empty_149531 = empty_slice_149524 || forwards_ok_149530;
            bool index_certs_149532;
            
            if (!ok_or_empty_149531) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_149515, "] out of bounds for array of shape [", (long long) deepen_step_res_149483, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:263:8-49\n   #3  ftRelational.fut:225:5-88\n   #4  ftRelational.fut:215:1-226:30\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_165083 = (int64_t) 8 * m_149515;
            int64_t conc_tmp_149554 = loop_dz2081Uz2089U_149312 + m_149515;
            int64_t bytes_165119 = (int64_t) 8 * conc_tmp_149554;
            
            if (mem_165084_cached_sizze_166288 < bytes_165083) {
                err = lexical_realloc(ctx, &mem_165084, &mem_165084_cached_sizze_166288, bytes_165083);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165084, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165058, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149515});
            if (mem_165086_cached_sizze_166289 < bytes_165083) {
                err = lexical_realloc(ctx, &mem_165086, &mem_165086_cached_sizze_166289, bytes_165083);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165086, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165056, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149515});
            for (int64_t write_iter_164756 = 0; write_iter_164756 < deepen_step_res_149483; write_iter_164756++) {
                int64_t write_iv_164759 = ((int64_t *) mem_165054)[write_iter_164756];
                int64_t write_iv_164760 = ((int64_t *) mem_165052)[write_iter_164756];
                int64_t write_iv_164761 = ((int64_t *) mem_165056)[write_iter_164756];
                int64_t write_iv_164762 = ((int64_t *) mem_165058)[write_iter_164756];
                bool cond_157008 = write_iv_164759 == (int64_t) 1;
                int64_t lifted_lambda_res_157009;
                
                if (cond_157008) {
                    int64_t lifted_lambda_res_t_res_157430 = sub64(write_iv_164760, (int64_t) 1);
                    
                    lifted_lambda_res_157009 = lifted_lambda_res_t_res_157430;
                } else {
                    lifted_lambda_res_157009 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_149515)) {
                    ((int64_t *) mem_165086)[lifted_lambda_res_157009] = write_iv_164761;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_149515)) {
                    ((int64_t *) mem_165084)[lifted_lambda_res_157009] = write_iv_164762;
                }
            }
            if (memblock_alloc(ctx, &mem_165100, bytes_165099, "mem_165100")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165100.mem, (int64_t) 0, (int64_t []) {b_138595, (int64_t) 1}, (uint8_t *) mem_param_164960.mem, (int64_t) 0, (int64_t []) {b_138595, (int64_t) 1}, (int64_t []) {n_138594, b_138595});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165100.mem, b_138595 * bounds_149317, (int64_t []) {b_138595, (int64_t) 1}, (uint8_t *) ext_mem_165045.mem, ext_165043, (int64_t []) {b_138595, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, b_138595});
            if (memblock_unref(ctx, &ext_mem_165045, "ext_mem_165045") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165102, bytes_165101, "mem_165102")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165102.mem, (int64_t) 0, (int64_t []) {pL_b_138596, (int64_t) 1}, (uint8_t *) mem_param_164956.mem, (int64_t) 0, (int64_t []) {pL_b_138596, (int64_t) 1}, (int64_t []) {n_138594, pL_b_138596});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165102.mem, pL_b_138596 * bounds_149317, (int64_t []) {pL_b_138596, (int64_t) 1}, (uint8_t *) ext_mem_165044.mem, ext_165040, (int64_t []) {pL_b_138596, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149319, pL_b_138596});
            if (memblock_unref(ctx, &ext_mem_165044, "ext_mem_165044") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165120, bytes_165119, "mem_165120")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_165122, bytes_165119, "mem_165122")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < m_149515; i_164769++) {
                int64_t eta_p_149550 = ((int64_t *) mem_165086)[i_164769];
                int64_t eta_p_149551 = ((int64_t *) mem_165084)[i_164769];
                int64_t tmp_149552 = add64(bounds_149317, eta_p_149550);
                int64_t tmp_149553 = add64(bounds_149317, eta_p_149551);
                
                ((int64_t *) mem_165120.mem)[loop_dz2081Uz2089U_149312 + i_164769] = tmp_149552;
                ((int64_t *) mem_165122.mem)[loop_dz2081Uz2089U_149312 + i_164769] = tmp_149553;
            }
            
            int64_t tmp_offs_165747 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165120.mem, tmp_offs_165747, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_149312});
            tmp_offs_165747 += loop_dz2081Uz2089U_149312;
            if (!(tmp_offs_165747 == loop_dz2081Uz2089U_149312)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165120.mem, tmp_offs_165747, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165120.mem, loop_dz2081Uz2089U_149312, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149515});
            }
            tmp_offs_165747 += m_149515;
            
            int64_t tmp_offs_165748 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165122.mem, tmp_offs_165748, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_149312});
            tmp_offs_165748 += loop_dz2081Uz2089U_149312;
            if (!(tmp_offs_165748 == loop_dz2081Uz2089U_149312)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165122.mem, tmp_offs_165748, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165122.mem, loop_dz2081Uz2089U_149312, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149515});
            }
            tmp_offs_165748 += m_149515;
            if (memblock_set(ctx, &mem_param_tmp_165708, &mem_165120, "mem_165120") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165709, &mem_165122, "mem_165122") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165710, &mem_165102, "mem_165102") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165100, "mem_165100") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_165712 = conc_tmp_149554;
            
            if (memblock_set(ctx, &mem_param_164949, &mem_param_tmp_165708, "mem_param_tmp_165708") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164952, &mem_param_tmp_165709, "mem_param_tmp_165709") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164956, &mem_param_tmp_165710, "mem_param_tmp_165710") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164960, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            loop_dz2081Uz2089U_149312 = loop_dz2081Uz2089U_tmp_165712;
        }
        if (memblock_set(ctx, &ext_mem_165136, &mem_param_164949, "mem_param_164949") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165135, &mem_param_164952, "mem_param_164952") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165134, &mem_param_164956, "mem_param_164956") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165133, &mem_param_164960, "mem_param_164960") != 0)
            return 1;
        loopres_149306 = loop_dz2081Uz2089U_149312;
        
        bool cond_149558 = slt64((int64_t) 0, loopres_149306);
        bool loop_cond_t_res_149559 = slt32(newDepth_149337, max_depth_138603);
        bool x_149560 = cond_149558 && loop_cond_t_res_149559;
        
        if (memblock_set(ctx, &mem_param_tmp_165697, &ext_mem_165134, "ext_mem_165134") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165698, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165135, "ext_mem_165135") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_165701 = loopres_149306;
        bool loop_while_tmp_165702 = x_149560;
        int32_t p_tmp_165703 = newDepth_149337;
        
        if (memblock_set(ctx, &mem_param_164936, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165698, "mem_param_tmp_165698") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164943, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164946, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        loop_dz2087U_149299 = loop_dz2087U_tmp_165701;
        loop_while_149300 = loop_while_tmp_165702;
        p_149301 = p_tmp_165703;
    }
    if (memblock_set(ctx, &ext_mem_165150, &mem_param_164936, "mem_param_164936") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165149, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165148, &mem_param_164943, "mem_param_164943") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165147, &mem_param_164946, "mem_param_164946") != 0)
        return 1;
    partition_and_deepen_res_149292 = loop_dz2087U_149299;
    partition_and_deepen_res_149293 = loop_while_149300;
    partition_and_deepen_res_149294 = p_149301;
    if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &ext_mem_165149, "ext_mem_165149") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &ext_mem_165150, "ext_mem_165150") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166277, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166278, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164975);
        free(mem_165009);
        free(mem_165011);
        free(mem_165020);
        free(mem_165021);
        free(mem_165052);
        free(mem_165054);
        free(mem_165056);
        free(mem_165058);
        free(mem_165084);
        free(mem_165086);
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165698, "mem_param_tmp_165698") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165710, "mem_param_tmp_165710") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165709, "mem_param_tmp_165709") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165708, "mem_param_tmp_165708") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165122, "mem_165122") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165120, "mem_165120") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165102, "mem_165102") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165100, "mem_165100") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165049, "ext_mem_165049") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165050, "ext_mem_165050") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165047, "mem_165047") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165719, "mem_param_tmp_165719") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165718, "mem_param_tmp_165718") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164999, "mem_164999") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164997, "mem_164997") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165726, "mem_param_tmp_165726") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164986, "mem_164986") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164984, "mem_param_164984") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164970, "mem_param_164970") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164966, "mem_param_164966") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165044, "ext_mem_165044") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165045, "ext_mem_165045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164960, "mem_param_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164956, "mem_param_164956") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164952, "mem_param_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164949, "mem_param_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165133, "ext_mem_165133") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165134, "ext_mem_165134") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165135, "ext_mem_165135") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165136, "ext_mem_165136") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164946, "mem_param_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164943, "mem_param_164943") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164936, "mem_param_164936") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165147, "ext_mem_165147") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165148, "ext_mem_165148") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165149, "ext_mem_165149") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165150, "ext_mem_165150") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_166290, struct memblock *mem_out_p_166291, struct memblock xs_mem_164928, int64_t n_139961, int64_t b_139962, int16_t block_sizze_139963, int64_t gather_psizze_139964, int32_t radix_sizze_139965, int64_t offset_139967, int64_t sizze_thresh_139968, int32_t max_depth_139969)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164973_cached_sizze_166292 = 0;
    unsigned char *mem_164973 = NULL;
    int64_t mem_165006_cached_sizze_166293 = 0;
    unsigned char *mem_165006 = NULL;
    int64_t mem_165008_cached_sizze_166294 = 0;
    unsigned char *mem_165008 = NULL;
    int64_t mem_165016_cached_sizze_166295 = 0;
    unsigned char *mem_165016 = NULL;
    int64_t mem_165044_cached_sizze_166296 = 0;
    unsigned char *mem_165044 = NULL;
    int64_t mem_165046_cached_sizze_166297 = 0;
    unsigned char *mem_165046 = NULL;
    int64_t mem_165048_cached_sizze_166298 = 0;
    unsigned char *mem_165048 = NULL;
    int64_t mem_165050_cached_sizze_166299 = 0;
    unsigned char *mem_165050 = NULL;
    int64_t mem_165076_cached_sizze_166300 = 0;
    unsigned char *mem_165076 = NULL;
    int64_t mem_165078_cached_sizze_166301 = 0;
    unsigned char *mem_165078 = NULL;
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_param_tmp_165701;
    
    mem_param_tmp_165701.references = NULL;
    
    struct memblock mem_param_tmp_165700;
    
    mem_param_tmp_165700.references = NULL;
    
    struct memblock mem_param_tmp_165699;
    
    mem_param_tmp_165699.references = NULL;
    
    struct memblock mem_param_tmp_165713;
    
    mem_param_tmp_165713.references = NULL;
    
    struct memblock mem_param_tmp_165712;
    
    mem_param_tmp_165712.references = NULL;
    
    struct memblock mem_param_tmp_165711;
    
    mem_param_tmp_165711.references = NULL;
    
    struct memblock mem_param_tmp_165710;
    
    mem_param_tmp_165710.references = NULL;
    
    struct memblock mem_165114;
    
    mem_165114.references = NULL;
    
    struct memblock mem_165112;
    
    mem_165112.references = NULL;
    
    struct memblock mem_165094;
    
    mem_165094.references = NULL;
    
    struct memblock mem_165092;
    
    mem_165092.references = NULL;
    
    struct memblock ext_mem_165041;
    
    ext_mem_165041.references = NULL;
    
    struct memblock ext_mem_165042;
    
    ext_mem_165042.references = NULL;
    
    struct memblock mem_165039;
    
    mem_165039.references = NULL;
    
    struct memblock mem_param_tmp_165721;
    
    mem_param_tmp_165721.references = NULL;
    
    struct memblock mem_param_tmp_165720;
    
    mem_param_tmp_165720.references = NULL;
    
    struct memblock mem_164997;
    
    mem_164997.references = NULL;
    
    struct memblock mem_164995;
    
    mem_164995.references = NULL;
    
    struct memblock mem_param_tmp_165728;
    
    mem_param_tmp_165728.references = NULL;
    
    struct memblock mem_164984;
    
    mem_164984.references = NULL;
    
    struct memblock mem_param_164982;
    
    mem_param_164982.references = NULL;
    
    struct memblock ext_mem_164993;
    
    ext_mem_164993.references = NULL;
    
    struct memblock mem_param_164968;
    
    mem_param_164968.references = NULL;
    
    struct memblock mem_param_164965;
    
    mem_param_164965.references = NULL;
    
    struct memblock ext_mem_165036;
    
    ext_mem_165036.references = NULL;
    
    struct memblock ext_mem_165037;
    
    ext_mem_165037.references = NULL;
    
    struct memblock mem_164961;
    
    mem_164961.references = NULL;
    
    struct memblock mem_param_164959;
    
    mem_param_164959.references = NULL;
    
    struct memblock mem_param_164955;
    
    mem_param_164955.references = NULL;
    
    struct memblock mem_param_164952;
    
    mem_param_164952.references = NULL;
    
    struct memblock mem_param_164949;
    
    mem_param_164949.references = NULL;
    
    struct memblock ext_mem_165124;
    
    ext_mem_165124.references = NULL;
    
    struct memblock ext_mem_165125;
    
    ext_mem_165125.references = NULL;
    
    struct memblock ext_mem_165126;
    
    ext_mem_165126.references = NULL;
    
    struct memblock ext_mem_165127;
    
    ext_mem_165127.references = NULL;
    
    struct memblock mem_param_164946;
    
    mem_param_164946.references = NULL;
    
    struct memblock mem_param_164943;
    
    mem_param_164943.references = NULL;
    
    struct memblock mem_param_164940;
    
    mem_param_164940.references = NULL;
    
    struct memblock mem_param_164936;
    
    mem_param_164936.references = NULL;
    
    struct memblock ext_mem_165137;
    
    ext_mem_165137.references = NULL;
    
    struct memblock ext_mem_165138;
    
    ext_mem_165138.references = NULL;
    
    struct memblock ext_mem_165139;
    
    ext_mem_165139.references = NULL;
    
    struct memblock ext_mem_165140;
    
    ext_mem_165140.references = NULL;
    
    struct memblock mem_164933;
    
    mem_164933.references = NULL;
    
    struct memblock mem_164932;
    
    mem_164932.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t is_149287 = add64(n_139961, offset_139967);
    bool bounds_invalid_upwards_149288 = slt64(is_149287, offset_139967);
    bool valid_149289 = !bounds_invalid_upwards_149288;
    bool range_valid_c_149290;
    
    if (!valid_149289) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) offset_139967, "..<", (long long) is_149287, " is invalid.", "-> #0  ftRelational.fut:237:13-32\n   #1  ftRelational.fut:228:1-240:31\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164929 = (int64_t) 8 * n_139961;
    
    if (memblock_alloc(ctx, &mem_164930, bytes_164929, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165695 = 0; i_165695 < n_139961; i_165695++) {
        int64_t x_165696 = offset_139967 + i_165695 * (int64_t) 1;
        
        ((int64_t *) mem_164930.mem)[i_165695] = x_165696;
    }
    if (memblock_alloc(ctx, &mem_164931, (int64_t) 8, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165697 = 0; nest_i_165697 < (int64_t) 1; nest_i_165697++) {
        ((int64_t *) mem_164931.mem)[nest_i_165697] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_164932, (int64_t) 8, "mem_164932")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165698 = 0; nest_i_165698 < (int64_t) 1; nest_i_165698++) {
        ((int64_t *) mem_164932.mem)[nest_i_165698] = n_139961;
    }
    
    bool loop_cond_t_res_149294 = slt32(0, max_depth_139969);
    
    if (memblock_alloc(ctx, &mem_164933, (int64_t) 0, "mem_164933")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_149345 = sext_i64_i32(b_139962);
    int32_t zm_lhs_149346 = mul32(8, i64_res_149345);
    int32_t min_arg1_149347 = sub32(zm_lhs_149346, 1);
    bool zzero_149366 = gather_psizze_139964 == (int64_t) 0;
    bool nonzzero_149367 = !zzero_149366;
    int64_t bytes_165091 = n_139961 * b_139962;
    
    if (mem_165016_cached_sizze_166295 < b_139962) {
        err = lexical_realloc(ctx, &mem_165016, &mem_165016_cached_sizze_166295, b_139962);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_149296;
    bool partition_and_deepen_res_149297;
    int32_t partition_and_deepen_res_149298;
    int64_t loop_dz2087U_149303;
    bool loop_while_149304;
    int32_t p_149305;
    
    if (memblock_set(ctx, &mem_param_164936, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164940, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164943, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164946, &mem_164932, "mem_164932") != 0)
        return 1;
    loop_dz2087U_149303 = (int64_t) 1;
    loop_while_149304 = loop_cond_t_res_149294;
    p_149305 = 0;
    while (loop_while_149304) {
        bool loop_nonempty_155438 = slt64((int64_t) 0, loop_dz2087U_149303);
        int32_t newDepth_149341 = add32(1, p_149305);
        int32_t new_i_149342 = mul32(radix_sizze_139965, p_149305);
        int32_t zm_lhs_149343 = mul32(radix_sizze_139965, newDepth_149341);
        int32_t new_j_149344 = sub32(zm_lhs_149343, 1);
        int32_t min_res_149348 = smin32(new_j_149344, min_arg1_149347);
        int32_t tmp_149349 = add32(2, new_i_149342);
        int64_t i_149350 = sext_i32_i64(new_i_149342);
        int64_t j__149351 = sext_i32_i64(min_res_149348);
        int64_t tmp_149352 = sext_i32_i64(tmp_149349);
        bool step_zzero_149353 = new_i_149342 == tmp_149349;
        bool bounds_invalid_upwards_149354 = slt32(min_res_149348, new_i_149342);
        int32_t distance_upwards_exclusive_149355 = sub32(min_res_149348, new_i_149342);
        int64_t distance_exclusive_149356 = sext_i32_i64(distance_upwards_exclusive_149355);
        int64_t distance_149357 = add64((int64_t) 1, distance_exclusive_149356);
        bool range_invalid_149358 = step_zzero_149353 || bounds_invalid_upwards_149354;
        bool valid_149359 = !range_invalid_149358;
        bool loop_not_taken_155439 = !loop_nonempty_155438;
        bool protect_assert_disj_155440 = valid_149359 || loop_not_taken_155439;
        bool range_valid_c_149360;
        
        if (!protect_assert_disj_155440) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_149350, "..", (long long) tmp_149352, "...", (long long) j__149351, " is invalid.", "-> #0  ftHashJoin.fut:207:15-37\n   #1  ftHashJoin.fut:252:20-258:6\n   #2  ftRelational.fut:239:5-88\n   #3  ftRelational.fut:228:1-240:31\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_149361 = sdiv_up64(distance_149357, (int64_t) 2);
        bool loop_nonempty_149362 = slt64((int64_t) 0, num_elems_149361);
        bool loop_not_taken_149368 = !loop_nonempty_149362;
        bool protect_assert_disj_149369 = nonzzero_149367 || loop_not_taken_149368;
        bool protect_assert_disj_155442 = protect_assert_disj_149369 || loop_not_taken_155439;
        bool nonzzero_cert_149370;
        
        if (!protect_assert_disj_155442) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftHashJoin.fut:194:87-90\n   #2  ftHashJoin.fut:208:6-71\n   #3  ftHashJoin.fut:252:20-258:6\n   #4  ftRelational.fut:239:5-88\n   #5  ftRelational.fut:228:1-240:31\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_149310;
        int64_t loop_dz2081Uz2089U_149316;
        
        if (memblock_set(ctx, &mem_param_164949, &mem_164933, "mem_164933") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164952, &mem_164933, "mem_164933") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164955, &mem_param_164936, "mem_param_164936") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164959, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        loop_dz2081Uz2089U_149316 = (int64_t) 0;
        for (int64_t i_149315 = 0; i_149315 < loop_dz2087U_149303; i_149315++) {
            int64_t bounds_149321 = ((int64_t *) mem_param_164943.mem)[i_149315];
            int64_t bounds_149322 = ((int64_t *) mem_param_164946.mem)[i_149315];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323 = sub64(bounds_149322, bounds_149321);
            bool empty_slice_149324 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323 == (int64_t) 0;
            int64_t m_149325 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, (int64_t) 1);
            int64_t i_p_m_t_s_149326 = add64(bounds_149321, m_149325);
            bool zzero_leq_i_p_m_t_s_149327 = sle64((int64_t) 0, i_p_m_t_s_149326);
            bool i_p_m_t_s_leq_w_149328 = slt64(i_p_m_t_s_149326, n_139961);
            bool zzero_lte_i_149329 = sle64((int64_t) 0, bounds_149321);
            bool i_lte_j_149330 = sle64(bounds_149321, bounds_149322);
            bool y_149331 = i_p_m_t_s_leq_w_149328 && zzero_lte_i_149329;
            bool y_149332 = zzero_leq_i_p_m_t_s_149327 && y_149331;
            bool forwards_ok_149333 = i_lte_j_149330 && y_149332;
            bool ok_or_empty_149334 = empty_slice_149324 || forwards_ok_149333;
            bool index_certs_149335;
            
            if (!ok_or_empty_149334) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_149321, ":", (long long) bounds_149322, "] out of bounds for array of shape [", (long long) n_139961, "].", "-> #0  ftHashJoin.fut:285:21-47\n   #1  ftRelational.fut:239:5-88\n   #2  ftRelational.fut:228:1-240:31\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164960 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323;
            
            if (memblock_alloc(ctx, &mem_164961, bytes_164960, "mem_164961")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_165719 = 0; nest_i_165719 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323; nest_i_165719++) {
                ((int64_t *) mem_164961.mem)[nest_i_165719] = (int64_t) 0;
            }
            
            int64_t zm_lhs_149364 = add64(gather_psizze_139964, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323);
            int64_t zs_lhs_149365 = sub64(zm_lhs_149364, (int64_t) 1);
            int64_t m_149371 = sdiv_safe64(zs_lhs_149365, gather_psizze_139964);
            bool loop_cond_149372 = slt64((int64_t) 0, m_149371);
            int64_t binop_y_164969 = b_139962 * bounds_149321;
            int64_t bytes_164994 = b_139962 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323;
            
            if (mem_164973_cached_sizze_166292 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323) {
                err = lexical_realloc(ctx, &mem_164973, &mem_164973_cached_sizze_166292, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_165035;
            int64_t ext_165032;
            int64_t ctx_param_ext_164962;
            int64_t ctx_param_ext_164966;
            
            if (memblock_set(ctx, &mem_param_164965, &mem_param_164959, "mem_param_164959") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164968, &mem_param_164955, "mem_param_164955") != 0)
                return 1;
            ctx_param_ext_164962 = binop_y_164969;
            ctx_param_ext_164966 = bounds_149321;
            for (int64_t i_149375 = 0; i_149375 < num_elems_149361; i_149375++) {
                int32_t binop_x_149378 = sext_i64_i32(i_149375);
                int32_t binop_x_149379 = mul32(2, binop_x_149378);
                int32_t index_primexp_149380 = add32(new_i_149342, binop_x_149379);
                int32_t zm_lhs_149381 = add32(2, index_primexp_149380);
                int32_t min_arg1_149382 = sub32(zm_lhs_149381, 1);
                int32_t min_res_149383 = smin32(min_res_149348, min_arg1_149382);
                int32_t zp_lhs_149384 = sub32(min_res_149383, index_primexp_149380);
                int32_t ij_bits_149385 = add32(1, zp_lhs_149384);
                int32_t up_to_149386 = shl32(1, ij_bits_149385);
                int64_t tmp_149387 = sext_i32_i64(zp_lhs_149384);
                bool bounds_invalid_upwards_149388 = slt32(zp_lhs_149384, 0);
                bool valid_149390 = !bounds_invalid_upwards_149388;
                bool range_valid_c_149391;
                
                if (!valid_149390) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149387, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:194:87-90\n   #3  ftHashJoin.fut:208:6-71\n   #4  ftHashJoin.fut:252:20-258:6\n   #5  ftRelational.fut:239:5-88\n   #6  ftRelational.fut:228:1-240:31\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_149401 = sext_i32_i64(up_to_149386);
                bool bounds_invalid_upwards_149402 = slt32(up_to_149386, 0);
                bool valid_149403 = !bounds_invalid_upwards_149402;
                bool range_valid_c_149404;
                
                if (!valid_149403) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149401, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftHashJoin.fut:194:87-90\n   #2  ftHashJoin.fut:208:6-71\n   #3  ftHashJoin.fut:252:20-258:6\n   #4  ftRelational.fut:239:5-88\n   #5  ftRelational.fut:228:1-240:31\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_149389 = add64((int64_t) 1, tmp_149387);
                
                for (int64_t i_164713 = 0; i_164713 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323; i_164713++) {
                    int8_t defunc_0_f_res_149394;
                    int8_t y_149396 = (int8_t) 0;
                    
                    for (int64_t i_149395 = 0; i_149395 < distance_149389; i_149395++) {
                        int32_t binop_x_149397 = sext_i64_i32(i_149395);
                        int32_t get_bit_arg0_149398 = add32(index_primexp_149380, binop_x_149397);
                        int32_t zm_rhs_156627 = sdiv32(get_bit_arg0_149398, 8);
                        int32_t zm_lhs_156628 = sub32(i64_res_149345, zm_rhs_156627);
                        int32_t whichByte_156629 = sub32(zm_lhs_156628, 1);
                        int64_t whichByte_156631 = sext_i32_i64(whichByte_156629);
                        bool x_156632 = sle64((int64_t) 0, whichByte_156631);
                        bool y_156633 = slt64(whichByte_156631, b_139962);
                        bool bounds_check_156634 = x_156632 && y_156633;
                        bool index_certs_156635;
                        
                        if (!bounds_check_156634) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_156631, "] out of bounds for array of shape [", (long long) b_139962, "].", "-> #0  ftHashJoin.fut:17:6-18\n   #1  ftRelational.fut:239:5-88\n   #2  ftRelational.fut:228:1-240:31\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_156630 = smod32(get_bit_arg0_149398, 8);
                        int8_t zbzg_lhs_156636 = ((int8_t *) mem_param_164965.mem)[ctx_param_ext_164962 + (i_164713 * b_139962 + whichByte_156631)];
                        int8_t unsign_arg0_156637 = zext_i32_i8(whichBit_156630);
                        int8_t unsign_arg0_156638 = ashr8(zbzg_lhs_156636, unsign_arg0_156637);
                        int8_t unsign_arg0_156639 = (int8_t) 1 & unsign_arg0_156638;
                        int32_t to_i32_res_156640 = zext_i8_i32(unsign_arg0_156639);
                        int8_t loopres_149400;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_149400, binop_x_149397, y_149396, to_i32_res_156640) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_165727 = loopres_149400;
                        
                        y_149396 = y_tmp_165727;
                    }
                    defunc_0_f_res_149394 = y_149396;
                    ((int8_t *) mem_164973)[i_164713] = defunc_0_f_res_149394;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_149405;
                int64_t offs_149408;
                
                if (memblock_set(ctx, &mem_param_164982, &mem_164961, "mem_164961") != 0)
                    return 1;
                offs_149408 = (int64_t) 0;
                for (int64_t i_149407 = 0; i_149407 < up_to_149401; i_149407++) {
                    int32_t binop_x_149410 = sext_i64_i32(i_149407);
                    int8_t index_primexp_149411 = zext_i32_i8(binop_x_149410);
                    
                    if (memblock_alloc(ctx, &mem_164984, bytes_164960, "mem_164984")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_157416;
                    int64_t defunc_0_reduce_res_157417;
                    int64_t inpacc_157237;
                    int64_t inpacc_157238;
                    
                    inpacc_157237 = (int64_t) 0;
                    inpacc_157238 = (int64_t) 0;
                    for (int64_t i_164731 = 0; i_164731 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323; i_164731++) {
                        int8_t eta_p_164901 = ((int8_t *) mem_164973)[i_164731];
                        bool lifted_lambda_res_164902 = eta_p_164901 == index_primexp_149411;
                        int64_t bool_res_164903 = btoi_bool_i64(lifted_lambda_res_164902);
                        int64_t eta_p_164916 = ((int64_t *) mem_param_164982.mem)[i_164731];
                        int64_t defunc_0_op_res_164917 = add64(inpacc_157237, bool_res_164903);
                        int64_t zm_lhs_164918 = add64(offs_149408, defunc_0_op_res_164917);
                        int64_t lifted_lambda_res_164919 = sub64(zm_lhs_164918, (int64_t) 1);
                        int64_t defunc_0_f_res_164920 = mul64(bool_res_164903, lifted_lambda_res_164919);
                        int64_t defunc_0_f_res_164921 = add64(eta_p_164916, defunc_0_f_res_164920);
                        int64_t defunc_0_op_res_157286 = add64(inpacc_157238, bool_res_164903);
                        
                        ((int64_t *) mem_164984.mem)[i_164731] = defunc_0_f_res_164921;
                        
                        int64_t inpacc_tmp_165731 = defunc_0_op_res_164917;
                        int64_t inpacc_tmp_165732 = defunc_0_op_res_157286;
                        
                        inpacc_157237 = inpacc_tmp_165731;
                        inpacc_157238 = inpacc_tmp_165732;
                    }
                    inpacc_157416 = inpacc_157237;
                    defunc_0_reduce_res_157417 = inpacc_157238;
                    
                    int64_t tmp_149436 = add64(offs_149408, defunc_0_reduce_res_157417);
                    
                    if (memblock_set(ctx, &mem_param_tmp_165728, &mem_164984, "mem_164984") != 0)
                        return 1;
                    
                    int64_t offs_tmp_165729 = tmp_149436;
                    
                    if (memblock_set(ctx, &mem_param_164982, &mem_param_tmp_165728, "mem_param_tmp_165728") != 0)
                        return 1;
                    offs_149408 = offs_tmp_165729;
                }
                if (memblock_set(ctx, &ext_mem_164993, &mem_param_164982, "mem_param_164982") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_149405 = offs_149408;
                if (memblock_alloc(ctx, &mem_164995, bytes_164994, "mem_164995")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_164995.mem, (int64_t) 0, (int64_t []) {b_139962, (int64_t) 1}, (uint8_t *) mem_param_164965.mem, ctx_param_ext_164962, (int64_t []) {b_139962, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, b_139962});
                if (memblock_alloc(ctx, &mem_164997, bytes_164960, "mem_164997")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_164997.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164968.mem, ctx_param_ext_164966, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323});
                
                bool partitioned_scatter_res_149443;
                int64_t partitioned_scatter_res_149446;
                bool loop_while_149447;
                int64_t p_149450;
                
                loop_while_149447 = loop_cond_149372;
                p_149450 = (int64_t) 0;
                while (loop_while_149447) {
                    int64_t lower_bound_149451 = mul64(gather_psizze_139964, p_149450);
                    int64_t min_arg1_149452 = add64(gather_psizze_139964, lower_bound_149451);
                    int64_t min_res_149453 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, min_arg1_149452);
                    int64_t j_m_i_149454 = sub64(min_res_149453, lower_bound_149451);
                    bool empty_slice_149455 = j_m_i_149454 == (int64_t) 0;
                    int64_t m_149456 = sub64(j_m_i_149454, (int64_t) 1);
                    int64_t i_p_m_t_s_149457 = add64(lower_bound_149451, m_149456);
                    bool zzero_leq_i_p_m_t_s_149458 = sle64((int64_t) 0, i_p_m_t_s_149457);
                    bool i_p_m_t_s_leq_w_149459 = slt64(i_p_m_t_s_149457, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323);
                    bool zzero_lte_i_149460 = sle64((int64_t) 0, lower_bound_149451);
                    bool i_lte_j_149461 = sle64(lower_bound_149451, min_res_149453);
                    bool y_149462 = i_p_m_t_s_leq_w_149459 && zzero_lte_i_149460;
                    bool y_149463 = zzero_leq_i_p_m_t_s_149458 && y_149462;
                    bool forwards_ok_149464 = i_lte_j_149461 && y_149463;
                    bool ok_or_empty_149465 = empty_slice_149455 || forwards_ok_149464;
                    bool index_certs_149466;
                    
                    if (!ok_or_empty_149465) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149451, ":", (long long) min_res_149453, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftHashJoin.fut:194:87-90\n   #2  ftHashJoin.fut:208:6-71\n   #3  ftHashJoin.fut:252:20-258:6\n   #4  ftRelational.fut:239:5-88\n   #5  ftRelational.fut:228:1-240:31\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_165005 = b_139962 * j_m_i_149454;
                    int64_t bytes_165007 = (int64_t) 8 * j_m_i_149454;
                    
                    if (mem_165006_cached_sizze_166293 < bytes_165005) {
                        err = lexical_realloc(ctx, &mem_165006, &mem_165006_cached_sizze_166293, bytes_165005);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165006, (int64_t) 0, (int64_t []) {b_139962, (int64_t) 1}, (uint8_t *) mem_164995.mem, (int64_t) 0 + b_139962 * lower_bound_149451, (int64_t []) {b_139962, (int64_t) 1}, (int64_t []) {j_m_i_149454, b_139962});
                    if (mem_165008_cached_sizze_166294 < bytes_165007) {
                        err = lexical_realloc(ctx, &mem_165008, &mem_165008_cached_sizze_166294, bytes_165007);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165008, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164997.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149451, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149454});
                    for (int64_t write_iter_164733 = 0; write_iter_164733 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323; write_iter_164733++) {
                        int64_t write_iv_164736 = ((int64_t *) ext_mem_164993.mem)[write_iter_164733];
                        int64_t write_iv_164738 = ((int64_t *) mem_param_164968.mem)[ctx_param_ext_164966 + write_iter_164733];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_165016, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164965.mem, ctx_param_ext_164962 + write_iter_164733 * b_139962, (int64_t []) {(int64_t) 1}, (int64_t []) {b_139962});
                        
                        bool cond_157329 = sle64(lower_bound_149451, write_iv_164736);
                        bool cond_t_res_157330 = slt64(write_iv_164736, min_res_149453);
                        bool x_157331 = cond_157329 && cond_t_res_157330;
                        int64_t lifted_lambda_res_157332;
                        
                        if (x_157331) {
                            int64_t lifted_lambda_res_t_res_157419 = sub64(write_iv_164736, lower_bound_149451);
                            
                            lifted_lambda_res_157332 = lifted_lambda_res_t_res_157419;
                        } else {
                            lifted_lambda_res_157332 = (int64_t) -1;
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_157332) && slt64(lifted_lambda_res_157332, j_m_i_149454)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_139962 - (int64_t) 1, b_139962))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_165006, lifted_lambda_res_157332 * b_139962, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_165016, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_139962});
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_157332) && slt64(lifted_lambda_res_157332, j_m_i_149454)) {
                            ((int64_t *) mem_165008)[lifted_lambda_res_157332] = write_iv_164738;
                        }
                    }
                    
                    int64_t tmp_149478 = add64((int64_t) 1, p_149450);
                    
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_164995.mem, b_139962 * lower_bound_149451, (int64_t []) {b_139962, (int64_t) 1}, (uint8_t *) mem_165006, (int64_t) 0, (int64_t []) {b_139962, (int64_t) 1}, (int64_t []) {j_m_i_149454, b_139962});
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164997.mem, lower_bound_149451, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165008, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149454});
                    
                    bool loop_cond_149486 = slt64(tmp_149478, m_149371);
                    bool loop_while_tmp_165734 = loop_cond_149486;
                    int64_t p_tmp_165737 = tmp_149478;
                    
                    loop_while_149447 = loop_while_tmp_165734;
                    p_149450 = p_tmp_165737;
                }
                partitioned_scatter_res_149443 = loop_while_149447;
                partitioned_scatter_res_149446 = p_149450;
                if (memblock_unref(ctx, &ext_mem_164993, "ext_mem_164993") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_165720, &mem_164995, "mem_164995") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_165721, &mem_164997, "mem_164997") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_165722 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_165723 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_164965, &mem_param_tmp_165720, "mem_param_tmp_165720") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_164968, &mem_param_tmp_165721, "mem_param_tmp_165721") != 0)
                    return 1;
                ctx_param_ext_164962 = ctx_param_ext_tmp_165722;
                ctx_param_ext_164966 = ctx_param_ext_tmp_165723;
            }
            if (memblock_set(ctx, &ext_mem_165037, &mem_param_164965, "mem_param_164965") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_165036, &mem_param_164968, "mem_param_164968") != 0)
                return 1;
            ext_165035 = ctx_param_ext_164962;
            ext_165032 = ctx_param_ext_164966;
            if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165039, bytes_164994, "mem_165039")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165039.mem, (int64_t) 0, (int64_t []) {b_139962, (int64_t) 1}, (uint8_t *) ext_mem_165037.mem, ext_165035, (int64_t []) {b_139962, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, b_139962});
            
            int64_t deepen_step_res_149487;
            int64_t deepen_step_res_149488;
            int32_t deepen_step_res_149491;
            
            if (futrts_getPartitionBounds_12923(ctx, &ext_mem_165042, &ext_mem_165041, &deepen_step_res_149487, &deepen_step_res_149488, &deepen_step_res_149491, mem_165039, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, b_139962, newDepth_149341, new_i_149342, new_j_149344) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_165039, "mem_165039") != 0)
                return 1;
            
            int64_t zl_rhs_155452 = sub64(deepen_step_res_149487, (int64_t) 1);
            int64_t bytes_165043 = (int64_t) 8 * deepen_step_res_149487;
            
            if (mem_165044_cached_sizze_166296 < bytes_165043) {
                err = lexical_realloc(ctx, &mem_165044, &mem_165044_cached_sizze_166296, bytes_165043);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165046_cached_sizze_166297 < bytes_165043) {
                err = lexical_realloc(ctx, &mem_165046, &mem_165046_cached_sizze_166297, bytes_165043);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165048_cached_sizze_166298 < bytes_165043) {
                err = lexical_realloc(ctx, &mem_165048, &mem_165048_cached_sizze_166298, bytes_165043);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_165050_cached_sizze_166299 < bytes_165043) {
                err = lexical_realloc(ctx, &mem_165050, &mem_165050_cached_sizze_166299, bytes_165043);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_164755;
            int64_t scanacc_164745 = (int64_t) 0;
            
            for (int64_t i_164750 = 0; i_164750 < deepen_step_res_149487; i_164750++) {
                int64_t tmp_157026 = ((int64_t *) ext_mem_165042.mem)[i_164750];
                bool cond_157027 = slt64(i_164750, zl_rhs_155452);
                int64_t tmp_157028;
                
                if (cond_157027) {
                    int64_t tmp_157423 = add64((int64_t) 1, i_164750);
                    bool x_157424 = sle64((int64_t) 0, tmp_157423);
                    bool y_157425 = slt64(tmp_157423, deepen_step_res_149487);
                    bool bounds_check_157426 = x_157424 && y_157425;
                    bool index_certs_157427;
                    
                    if (!bounds_check_157426) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_157423, "] out of bounds for array of shape [", (long long) deepen_step_res_149487, "].", "-> #0  ftHashJoin.fut:262:67-81\n   #1  ftRelational.fut:239:5-88\n   #2  ftRelational.fut:228:1-240:31\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_157428 = ((int64_t *) ext_mem_165042.mem)[tmp_157423];
                    
                    tmp_157028 = tmp_t_res_157428;
                } else {
                    tmp_157028 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323;
                }
                
                int64_t zg_lhs_157037 = sub64(tmp_157028, tmp_157026);
                bool lifted_lambda_res_157038 = slt64(sizze_thresh_139968, zg_lhs_157037);
                int64_t defunc_0_f_res_157039 = btoi_bool_i64(lifted_lambda_res_157038);
                int64_t defunc_0_op_res_149508 = add64(defunc_0_f_res_157039, scanacc_164745);
                
                ((int64_t *) mem_165044)[i_164750] = defunc_0_op_res_149508;
                ((int64_t *) mem_165046)[i_164750] = defunc_0_f_res_157039;
                ((int64_t *) mem_165048)[i_164750] = tmp_157026;
                ((int64_t *) mem_165050)[i_164750] = tmp_157028;
                
                int64_t scanacc_tmp_165740 = defunc_0_op_res_149508;
                
                scanacc_164745 = scanacc_tmp_165740;
            }
            discard_164755 = scanacc_164745;
            if (memblock_unref(ctx, &ext_mem_165042, "ext_mem_165042") != 0)
                return 1;
            
            bool cond_149509 = deepen_step_res_149487 == (int64_t) 0;
            bool x_149510 = !cond_149509;
            bool x_149512 = sle64((int64_t) 0, zl_rhs_155452);
            bool y_149513 = slt64(zl_rhs_155452, deepen_step_res_149487);
            bool bounds_check_149514 = x_149512 && y_149513;
            bool protect_assert_disj_149515 = cond_149509 || bounds_check_149514;
            bool index_certs_149516;
            
            if (!protect_assert_disj_149515) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_155452, "] out of bounds for array of shape [", (long long) deepen_step_res_149487, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:263:8-49\n   #3  ftRelational.fut:239:5-88\n   #4  ftRelational.fut:228:1-240:31\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_149517;
            
            if (x_149510) {
                int64_t x_157429 = ((int64_t *) mem_165044)[zl_rhs_155452];
                
                m_f_res_149517 = x_157429;
            } else {
                m_f_res_149517 = (int64_t) 0;
            }
            
            int64_t m_149519;
            
            if (cond_149509) {
                m_149519 = (int64_t) 0;
            } else {
                m_149519 = m_f_res_149517;
            }
            
            int64_t m_149529 = sub64(m_149519, (int64_t) 1);
            bool i_p_m_t_s_leq_w_149531 = slt64(m_149529, deepen_step_res_149487);
            bool zzero_leq_i_p_m_t_s_149530 = sle64((int64_t) 0, m_149529);
            bool y_149533 = zzero_leq_i_p_m_t_s_149530 && i_p_m_t_s_leq_w_149531;
            bool i_lte_j_149532 = sle64((int64_t) 0, m_149519);
            bool forwards_ok_149534 = i_lte_j_149532 && y_149533;
            bool eq_x_zz_149526 = (int64_t) 0 == m_f_res_149517;
            bool p_and_eq_x_y_149527 = x_149510 && eq_x_zz_149526;
            bool empty_slice_149528 = cond_149509 || p_and_eq_x_y_149527;
            bool ok_or_empty_149535 = empty_slice_149528 || forwards_ok_149534;
            bool index_certs_149536;
            
            if (!ok_or_empty_149535) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_149519, "] out of bounds for array of shape [", (long long) deepen_step_res_149487, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:263:8-49\n   #3  ftRelational.fut:239:5-88\n   #4  ftRelational.fut:228:1-240:31\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_165075 = (int64_t) 8 * m_149519;
            int64_t conc_tmp_149558 = loop_dz2081Uz2089U_149316 + m_149519;
            int64_t bytes_165111 = (int64_t) 8 * conc_tmp_149558;
            
            if (mem_165076_cached_sizze_166300 < bytes_165075) {
                err = lexical_realloc(ctx, &mem_165076, &mem_165076_cached_sizze_166300, bytes_165075);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165076, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165050, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149519});
            if (mem_165078_cached_sizze_166301 < bytes_165075) {
                err = lexical_realloc(ctx, &mem_165078, &mem_165078_cached_sizze_166301, bytes_165075);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165078, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165048, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149519});
            for (int64_t write_iter_164756 = 0; write_iter_164756 < deepen_step_res_149487; write_iter_164756++) {
                int64_t write_iv_164759 = ((int64_t *) mem_165046)[write_iter_164756];
                int64_t write_iv_164760 = ((int64_t *) mem_165044)[write_iter_164756];
                int64_t write_iv_164761 = ((int64_t *) mem_165048)[write_iter_164756];
                int64_t write_iv_164762 = ((int64_t *) mem_165050)[write_iter_164756];
                bool cond_157008 = write_iv_164759 == (int64_t) 1;
                int64_t lifted_lambda_res_157009;
                
                if (cond_157008) {
                    int64_t lifted_lambda_res_t_res_157430 = sub64(write_iv_164760, (int64_t) 1);
                    
                    lifted_lambda_res_157009 = lifted_lambda_res_t_res_157430;
                } else {
                    lifted_lambda_res_157009 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_149519)) {
                    ((int64_t *) mem_165078)[lifted_lambda_res_157009] = write_iv_164761;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, m_149519)) {
                    ((int64_t *) mem_165076)[lifted_lambda_res_157009] = write_iv_164762;
                }
            }
            if (memblock_alloc(ctx, &mem_165092, bytes_165091, "mem_165092")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165092.mem, (int64_t) 0, (int64_t []) {b_139962, (int64_t) 1}, (uint8_t *) mem_param_164959.mem, (int64_t) 0, (int64_t []) {b_139962, (int64_t) 1}, (int64_t []) {n_139961, b_139962});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_165092.mem, b_139962 * bounds_149321, (int64_t []) {b_139962, (int64_t) 1}, (uint8_t *) ext_mem_165037.mem, ext_165035, (int64_t []) {b_139962, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323, b_139962});
            if (memblock_unref(ctx, &ext_mem_165037, "ext_mem_165037") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165094, bytes_164929, "mem_165094")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165094.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164955.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_139961});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165094.mem, bounds_149321, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165036.mem, ext_165032, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_149323});
            if (memblock_unref(ctx, &ext_mem_165036, "ext_mem_165036") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_165112, bytes_165111, "mem_165112")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_165114, bytes_165111, "mem_165114")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_164769 = 0; i_164769 < m_149519; i_164769++) {
                int64_t eta_p_149554 = ((int64_t *) mem_165078)[i_164769];
                int64_t eta_p_149555 = ((int64_t *) mem_165076)[i_164769];
                int64_t tmp_149556 = add64(bounds_149321, eta_p_149554);
                int64_t tmp_149557 = add64(bounds_149321, eta_p_149555);
                
                ((int64_t *) mem_165112.mem)[loop_dz2081Uz2089U_149316 + i_164769] = tmp_149556;
                ((int64_t *) mem_165114.mem)[loop_dz2081Uz2089U_149316 + i_164769] = tmp_149557;
            }
            
            int64_t tmp_offs_165749 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165112.mem, tmp_offs_165749, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_149316});
            tmp_offs_165749 += loop_dz2081Uz2089U_149316;
            if (!(tmp_offs_165749 == loop_dz2081Uz2089U_149316)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165112.mem, tmp_offs_165749, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165112.mem, loop_dz2081Uz2089U_149316, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149519});
            }
            tmp_offs_165749 += m_149519;
            
            int64_t tmp_offs_165750 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_165114.mem, tmp_offs_165750, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_149316});
            tmp_offs_165750 += loop_dz2081Uz2089U_149316;
            if (!(tmp_offs_165750 == loop_dz2081Uz2089U_149316)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_165114.mem, tmp_offs_165750, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_165114.mem, loop_dz2081Uz2089U_149316, (int64_t []) {(int64_t) 1}, (int64_t []) {m_149519});
            }
            tmp_offs_165750 += m_149519;
            if (memblock_set(ctx, &mem_param_tmp_165710, &mem_165112, "mem_165112") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165711, &mem_165114, "mem_165114") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165712, &mem_165094, "mem_165094") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_165713, &mem_165092, "mem_165092") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_165714 = conc_tmp_149558;
            
            if (memblock_set(ctx, &mem_param_164949, &mem_param_tmp_165710, "mem_param_tmp_165710") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164952, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164955, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_164959, &mem_param_tmp_165713, "mem_param_tmp_165713") != 0)
                return 1;
            loop_dz2081Uz2089U_149316 = loop_dz2081Uz2089U_tmp_165714;
        }
        if (memblock_set(ctx, &ext_mem_165127, &mem_param_164949, "mem_param_164949") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165126, &mem_param_164952, "mem_param_164952") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165125, &mem_param_164955, "mem_param_164955") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_165124, &mem_param_164959, "mem_param_164959") != 0)
            return 1;
        loopres_149310 = loop_dz2081Uz2089U_149316;
        
        bool cond_149562 = slt64((int64_t) 0, loopres_149310);
        bool loop_cond_t_res_149563 = slt32(newDepth_149341, max_depth_139969);
        bool x_149564 = cond_149562 && loop_cond_t_res_149563;
        
        if (memblock_set(ctx, &mem_param_tmp_165699, &ext_mem_165125, "ext_mem_165125") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165700, &ext_mem_165124, "ext_mem_165124") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165701, &ext_mem_165127, "ext_mem_165127") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165702, &ext_mem_165126, "ext_mem_165126") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_165703 = loopres_149310;
        bool loop_while_tmp_165704 = x_149564;
        int32_t p_tmp_165705 = newDepth_149341;
        
        if (memblock_set(ctx, &mem_param_164936, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164940, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164943, &mem_param_tmp_165701, "mem_param_tmp_165701") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164946, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        loop_dz2087U_149303 = loop_dz2087U_tmp_165703;
        loop_while_149304 = loop_while_tmp_165704;
        p_149305 = p_tmp_165705;
    }
    if (memblock_set(ctx, &ext_mem_165140, &mem_param_164936, "mem_param_164936") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165139, &mem_param_164940, "mem_param_164940") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165138, &mem_param_164943, "mem_param_164943") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165137, &mem_param_164946, "mem_param_164946") != 0)
        return 1;
    partition_and_deepen_res_149296 = loop_dz2087U_149303;
    partition_and_deepen_res_149297 = loop_while_149304;
    partition_and_deepen_res_149298 = p_149305;
    if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164933, "mem_164933") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &ext_mem_165140, "ext_mem_165140") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &ext_mem_165139, "ext_mem_165139") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166290, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166291, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164973);
        free(mem_165006);
        free(mem_165008);
        free(mem_165016);
        free(mem_165044);
        free(mem_165046);
        free(mem_165048);
        free(mem_165050);
        free(mem_165076);
        free(mem_165078);
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165701, "mem_param_tmp_165701") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165700, "mem_param_tmp_165700") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165699, "mem_param_tmp_165699") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165713, "mem_param_tmp_165713") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165712, "mem_param_tmp_165712") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165711, "mem_param_tmp_165711") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165710, "mem_param_tmp_165710") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165114, "mem_165114") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165112, "mem_165112") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165094, "mem_165094") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165092, "mem_165092") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165041, "ext_mem_165041") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165042, "ext_mem_165042") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165039, "mem_165039") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165721, "mem_param_tmp_165721") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165720, "mem_param_tmp_165720") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164997, "mem_164997") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164995, "mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165728, "mem_param_tmp_165728") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164984, "mem_164984") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164982, "mem_param_164982") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164993, "ext_mem_164993") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164968, "mem_param_164968") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164965, "mem_param_164965") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165036, "ext_mem_165036") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165037, "ext_mem_165037") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164959, "mem_param_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164955, "mem_param_164955") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164952, "mem_param_164952") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164949, "mem_param_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165124, "ext_mem_165124") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165125, "ext_mem_165125") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165126, "ext_mem_165126") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165127, "ext_mem_165127") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164946, "mem_param_164946") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164943, "mem_param_164943") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164940, "mem_param_164940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164936, "mem_param_164936") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165137, "ext_mem_165137") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165138, "ext_mem_165138") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165139, "ext_mem_165139") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165140, "ext_mem_165140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164933, "mem_164933") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164932, "mem_164932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_166302, struct memblock *mem_out_p_166303, struct memblock xs_mem_164928, int64_t n_100365, int64_t incr_100366, int16_t block_sizze_100367)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164938_cached_sizze_166304 = 0;
    unsigned char *mem_164938 = NULL;
    int64_t mem_164970_cached_sizze_166305 = 0;
    unsigned char *mem_164970 = NULL;
    int64_t mem_164972_cached_sizze_166306 = 0;
    unsigned char *mem_164972 = NULL;
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock mem_164998;
    
    mem_164998.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_164960;
    
    mem_164960.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_param_164947;
    
    mem_param_164947.references = NULL;
    
    struct memblock ext_mem_164958;
    
    ext_mem_164958.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_164995;
    
    ext_mem_164995.references = NULL;
    
    struct memblock ext_mem_164996;
    
    ext_mem_164996.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_152266 = sext_i16_i64(block_sizze_100367);
    int64_t bytes_164930 = (int64_t) 8 * n_100365;
    bool zzero_152286 = i16_res_152266 == (int64_t) 0;
    bool nonzzero_152287 = !zzero_152286;
    bool nonzzero_cert_152290;
    
    if (!nonzzero_152287) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:143:98-101\n   #4  ftRelational.fut:132:75-86\n   #5  ftRelational.fut:131:9-132:87\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_12227(ctx, &ext_mem_164929, xs_mem_164928, n_100365, incr_100366) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_100365; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_152284 = add64(n_100365, i16_res_152266);
    int64_t zs_lhs_152285 = sub64(zm_lhs_152284, (int64_t) 1);
    int64_t m_152291 = sdiv_safe64(zs_lhs_152285, i16_res_152266);
    bool loop_cond_152292 = slt64((int64_t) 0, m_152291);
    
    if (mem_164938_cached_sizze_166304 < n_100365) {
        err = lexical_realloc(ctx, &mem_164938, &mem_164938_cached_sizze_166304, n_100365);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164937, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    for (int64_t i_152295 = 0; i_152295 < (int64_t) 32; i_152295++) {
        int32_t binop_x_152298 = sext_i64_i32(i_152295);
        int32_t binop_x_152299 = mul32(2, binop_x_152298);
        int32_t zm_lhs_152300 = add32(2, binop_x_152299);
        int32_t min_arg1_152301 = sub32(zm_lhs_152300, 1);
        int32_t min_res_152302 = smin32(64, min_arg1_152301);
        int32_t zp_lhs_152303 = sub32(min_res_152302, binop_x_152299);
        int32_t ij_bits_152304 = add32(1, zp_lhs_152303);
        int32_t up_to_152305 = shl32(1, ij_bits_152304);
        int64_t tmp_152306 = sext_i32_i64(zp_lhs_152303);
        bool bounds_invalid_upwards_152307 = slt32(zp_lhs_152303, 0);
        bool valid_152309 = !bounds_invalid_upwards_152307;
        bool range_valid_c_152310;
        
        if (!valid_152309) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_152306, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:143:98-101\n   #5  ftRelational.fut:132:75-86\n   #6  ftRelational.fut:131:9-132:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_152334 = sext_i32_i64(up_to_152305);
        bool bounds_invalid_upwards_152335 = slt32(up_to_152305, 0);
        bool valid_152336 = !bounds_invalid_upwards_152335;
        bool range_valid_c_152337;
        
        if (!valid_152336) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_152334, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:143:98-101\n   #4  ftRelational.fut:132:75-86\n   #5  ftRelational.fut:131:9-132:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_152308 = add64((int64_t) 1, tmp_152306);
        
        for (int64_t i_164713 = 0; i_164713 < n_100365; i_164713++) {
            double eta_p_152312 = ((double *) mem_param_164937.mem)[i_164713];
            int64_t i64_arg0_152313 = futrts_to_bits64(eta_p_152312);
            int64_t unsign_arg0_152314 = ashr64(i64_arg0_152313, (int64_t) 63);
            int64_t unsign_arg0_152315 = (int64_t) 1 & unsign_arg0_152314;
            int32_t to_i32_res_152316 = zext_i64_i32(unsign_arg0_152315);
            bool cond_152317 = to_i32_res_152316 == 1;
            bool x_152318 = !cond_152317;
            int8_t defunc_0_f_res_152319;
            int8_t y_152321 = (int8_t) 0;
            
            for (int64_t i_152320 = 0; i_152320 < distance_152308; i_152320++) {
                int32_t binop_x_152322 = sext_i64_i32(i_152320);
                int32_t get_bit_arg0_152323 = add32(binop_x_152299, binop_x_152322);
                int64_t unsign_arg0_152324 = zext_i32_i64(get_bit_arg0_152323);
                int64_t unsign_arg0_152325 = ashr64(i64_arg0_152313, unsign_arg0_152324);
                int64_t unsign_arg0_152326 = (int64_t) 1 & unsign_arg0_152325;
                int32_t to_i32_res_152327 = zext_i64_i32(unsign_arg0_152326);
                bool cond_f_res_152328 = get_bit_arg0_152323 == 63;
                bool y_152329 = x_152318 && cond_f_res_152328;
                bool cond_152330 = cond_152317 || y_152329;
                int32_t defunc_0_get_bit_res_152331;
                
                if (cond_152330) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ to_i32_res_152327;
                    
                    defunc_0_get_bit_res_152331 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_152331 = to_i32_res_152327;
                }
                
                int8_t loopres_152333;
                
                if (futrts_set_bit_2464(ctx, &loopres_152333, binop_x_152322, y_152321, defunc_0_get_bit_res_152331) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_152333;
                
                y_152321 = y_tmp_165701;
            }
            defunc_0_f_res_152319 = y_152321;
            ((int8_t *) mem_164938)[i_164713] = defunc_0_f_res_152319;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_152338;
        int64_t offs_152341;
        
        if (memblock_set(ctx, &mem_param_164947, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_152341 = (int64_t) 0;
        for (int64_t i_152340 = 0; i_152340 < up_to_152334; i_152340++) {
            int32_t binop_x_152343 = sext_i64_i32(i_152340);
            int8_t index_primexp_152344 = zext_i32_i8(binop_x_152343);
            
            if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_100365; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164938)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_152344;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164947.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_152341, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164949.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_152369 = add64(offs_152341, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164949, "mem_164949") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_152369;
            
            if (memblock_set(ctx, &mem_param_164947, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_152341 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164958, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_152338 = offs_152341;
        if (memblock_alloc(ctx, &mem_164960, bytes_164930, "mem_164960")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100365});
        if (memblock_alloc(ctx, &mem_164962, bytes_164930, "mem_164962")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100365});
        
        bool partitioned_scatter_res_152376;
        int64_t partitioned_scatter_res_152379;
        bool loop_while_152380;
        int64_t p_152383;
        
        loop_while_152380 = loop_cond_152292;
        p_152383 = (int64_t) 0;
        while (loop_while_152380) {
            int64_t lower_bound_152384 = mul64(i16_res_152266, p_152383);
            int64_t min_arg1_152385 = add64(i16_res_152266, lower_bound_152384);
            int64_t min_res_152386 = smin64(n_100365, min_arg1_152385);
            int64_t j_m_i_152387 = sub64(min_res_152386, lower_bound_152384);
            bool empty_slice_152388 = j_m_i_152387 == (int64_t) 0;
            int64_t m_152389 = sub64(j_m_i_152387, (int64_t) 1);
            int64_t i_p_m_t_s_152390 = add64(lower_bound_152384, m_152389);
            bool zzero_leq_i_p_m_t_s_152391 = sle64((int64_t) 0, i_p_m_t_s_152390);
            bool i_p_m_t_s_leq_w_152392 = slt64(i_p_m_t_s_152390, n_100365);
            bool zzero_lte_i_152393 = sle64((int64_t) 0, lower_bound_152384);
            bool i_lte_j_152394 = sle64(lower_bound_152384, min_res_152386);
            bool y_152395 = i_p_m_t_s_leq_w_152392 && zzero_lte_i_152393;
            bool y_152396 = zzero_leq_i_p_m_t_s_152391 && y_152395;
            bool forwards_ok_152397 = i_lte_j_152394 && y_152396;
            bool ok_or_empty_152398 = empty_slice_152388 || forwards_ok_152397;
            bool index_certs_152399;
            
            if (!ok_or_empty_152398) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_152384, ":", (long long) min_res_152386, "] out of bounds for array of shape [", (long long) n_100365, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:143:98-101\n   #4  ftRelational.fut:132:75-86\n   #5  ftRelational.fut:131:9-132:87\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164969 = (int64_t) 8 * j_m_i_152387;
            
            if (mem_164970_cached_sizze_166305 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164970, &mem_164970_cached_sizze_166305, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164960.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_152384, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152387});
            if (mem_164972_cached_sizze_166306 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166306, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164962.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_152384, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152387});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_100365; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164958.mem)[write_iter_164733];
                int64_t write_iv_164737 = ((int64_t *) mem_param_164934.mem)[write_iter_164733];
                double write_iv_164738 = ((double *) mem_param_164937.mem)[write_iter_164733];
                bool cond_157292 = sle64(lower_bound_152384, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_152386);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_152384);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152387)) {
                    ((int64_t *) mem_164970)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152387)) {
                    ((double *) mem_164972)[lifted_lambda_res_157295] = write_iv_164738;
                }
            }
            
            int64_t tmp_152411 = add64((int64_t) 1, p_152383);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, lower_bound_152384, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152387});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164962.mem, lower_bound_152384, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152387});
            
            bool loop_cond_152419 = slt64(tmp_152411, m_152291);
            bool loop_while_tmp_165708 = loop_cond_152419;
            int64_t p_tmp_165711 = tmp_152411;
            
            loop_while_152380 = loop_while_tmp_165708;
            p_152383 = p_tmp_165711;
        }
        partitioned_scatter_res_152376 = loop_while_152380;
        partitioned_scatter_res_152379 = p_152383;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_164996, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164995, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164998, bytes_164930, "mem_164998")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164996.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100365});
    if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165000, bytes_164930, "mem_165000")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165000.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100365});
    if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164998, "mem_164998") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165000, "mem_165000") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166302, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166303, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164938);
        free(mem_164970);
        free(mem_164972);
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164998, "mem_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_166307, struct memblock *mem_out_p_166308, struct memblock xs_mem_164928, int64_t n_99476, int64_t incr_99477, int16_t block_sizze_99478)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164938_cached_sizze_166309 = 0;
    unsigned char *mem_164938 = NULL;
    int64_t mem_164970_cached_sizze_166310 = 0;
    unsigned char *mem_164970 = NULL;
    int64_t mem_164972_cached_sizze_166311 = 0;
    unsigned char *mem_164972 = NULL;
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock mem_164998;
    
    mem_164998.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_164960;
    
    mem_164960.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_param_164947;
    
    mem_param_164947.references = NULL;
    
    struct memblock ext_mem_164958;
    
    ext_mem_164958.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_164995;
    
    ext_mem_164995.references = NULL;
    
    struct memblock ext_mem_164996;
    
    ext_mem_164996.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_152266 = sext_i16_i64(block_sizze_99478);
    int64_t bytes_164930 = (int64_t) 8 * n_99476;
    bool zzero_152285 = i16_res_152266 == (int64_t) 0;
    bool nonzzero_152286 = !zzero_152285;
    bool nonzzero_cert_152289;
    
    if (!nonzzero_152286) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:143:98-101\n   #4  ftRelational.fut:130:75-86\n   #5  ftRelational.fut:129:9-130:87\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164999 = (int64_t) 4 * n_99476;
    
    if (futrts_indicesWithIncrement_12206(ctx, &ext_mem_164929, xs_mem_164928, n_99476, incr_99477) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_99476; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_152283 = add64(n_99476, i16_res_152266);
    int64_t zs_lhs_152284 = sub64(zm_lhs_152283, (int64_t) 1);
    int64_t m_152290 = sdiv_safe64(zs_lhs_152284, i16_res_152266);
    bool loop_cond_152291 = slt64((int64_t) 0, m_152290);
    
    if (mem_164938_cached_sizze_166309 < n_99476) {
        err = lexical_realloc(ctx, &mem_164938, &mem_164938_cached_sizze_166309, n_99476);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164937, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    for (int64_t i_152294 = 0; i_152294 < (int64_t) 16; i_152294++) {
        int32_t binop_x_152297 = sext_i64_i32(i_152294);
        int32_t binop_x_152298 = mul32(2, binop_x_152297);
        int32_t zm_lhs_152299 = add32(2, binop_x_152298);
        int32_t min_arg1_152300 = sub32(zm_lhs_152299, 1);
        int32_t min_res_152301 = smin32(32, min_arg1_152300);
        int32_t zp_lhs_152302 = sub32(min_res_152301, binop_x_152298);
        int32_t ij_bits_152303 = add32(1, zp_lhs_152302);
        int32_t up_to_152304 = shl32(1, ij_bits_152303);
        int64_t tmp_152305 = sext_i32_i64(zp_lhs_152302);
        bool bounds_invalid_upwards_152306 = slt32(zp_lhs_152302, 0);
        bool valid_152308 = !bounds_invalid_upwards_152306;
        bool range_valid_c_152309;
        
        if (!valid_152308) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_152305, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:143:98-101\n   #5  ftRelational.fut:130:75-86\n   #6  ftRelational.fut:129:9-130:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_152330 = sext_i32_i64(up_to_152304);
        bool bounds_invalid_upwards_152331 = slt32(up_to_152304, 0);
        bool valid_152332 = !bounds_invalid_upwards_152331;
        bool range_valid_c_152333;
        
        if (!valid_152332) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_152330, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:143:98-101\n   #4  ftRelational.fut:130:75-86\n   #5  ftRelational.fut:129:9-130:87\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_152307 = add64((int64_t) 1, tmp_152305);
        
        for (int64_t i_164713 = 0; i_164713 < n_99476; i_164713++) {
            float eta_p_152311 = ((float *) mem_param_164937.mem)[i_164713];
            int32_t i32_arg0_152312 = futrts_to_bits32(eta_p_152311);
            int32_t unsign_arg0_152313 = ashr32(i32_arg0_152312, 31);
            int32_t unsign_arg0_152314 = 1 & unsign_arg0_152313;
            bool cond_152315 = unsign_arg0_152314 == 1;
            bool x_152316 = !cond_152315;
            int8_t defunc_0_f_res_152317;
            int8_t y_152319 = (int8_t) 0;
            
            for (int64_t i_152318 = 0; i_152318 < distance_152307; i_152318++) {
                int32_t binop_x_152320 = sext_i64_i32(i_152318);
                int32_t get_bit_arg0_152321 = add32(binop_x_152298, binop_x_152320);
                int32_t unsign_arg0_152322 = ashr32(i32_arg0_152312, get_bit_arg0_152321);
                int32_t unsign_arg0_152323 = 1 & unsign_arg0_152322;
                bool cond_f_res_152324 = get_bit_arg0_152321 == 31;
                bool y_152325 = x_152316 && cond_f_res_152324;
                bool cond_152326 = cond_152315 || y_152325;
                int32_t defunc_0_get_bit_res_152327;
                
                if (cond_152326) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ unsign_arg0_152323;
                    
                    defunc_0_get_bit_res_152327 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_152327 = unsign_arg0_152323;
                }
                
                int8_t loopres_152329;
                
                if (futrts_set_bit_2464(ctx, &loopres_152329, binop_x_152320, y_152319, defunc_0_get_bit_res_152327) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_152329;
                
                y_152319 = y_tmp_165701;
            }
            defunc_0_f_res_152317 = y_152319;
            ((int8_t *) mem_164938)[i_164713] = defunc_0_f_res_152317;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_152334;
        int64_t offs_152337;
        
        if (memblock_set(ctx, &mem_param_164947, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_152337 = (int64_t) 0;
        for (int64_t i_152336 = 0; i_152336 < up_to_152330; i_152336++) {
            int32_t binop_x_152339 = sext_i64_i32(i_152336);
            int8_t index_primexp_152340 = zext_i32_i8(binop_x_152339);
            
            if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_99476; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164938)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_152340;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164947.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_152337, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164949.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_152365 = add64(offs_152337, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164949, "mem_164949") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_152365;
            
            if (memblock_set(ctx, &mem_param_164947, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_152337 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164958, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_152334 = offs_152337;
        if (memblock_alloc(ctx, &mem_164960, bytes_164930, "mem_164960")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99476});
        if (memblock_alloc(ctx, &mem_164962, bytes_164999, "mem_164962")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_164937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99476});
        
        bool partitioned_scatter_res_152372;
        int64_t partitioned_scatter_res_152375;
        bool loop_while_152376;
        int64_t p_152379;
        
        loop_while_152376 = loop_cond_152291;
        p_152379 = (int64_t) 0;
        while (loop_while_152376) {
            int64_t lower_bound_152380 = mul64(i16_res_152266, p_152379);
            int64_t min_arg1_152381 = add64(i16_res_152266, lower_bound_152380);
            int64_t min_res_152382 = smin64(n_99476, min_arg1_152381);
            int64_t j_m_i_152383 = sub64(min_res_152382, lower_bound_152380);
            bool empty_slice_152384 = j_m_i_152383 == (int64_t) 0;
            int64_t m_152385 = sub64(j_m_i_152383, (int64_t) 1);
            int64_t i_p_m_t_s_152386 = add64(lower_bound_152380, m_152385);
            bool zzero_leq_i_p_m_t_s_152387 = sle64((int64_t) 0, i_p_m_t_s_152386);
            bool i_p_m_t_s_leq_w_152388 = slt64(i_p_m_t_s_152386, n_99476);
            bool zzero_lte_i_152389 = sle64((int64_t) 0, lower_bound_152380);
            bool i_lte_j_152390 = sle64(lower_bound_152380, min_res_152382);
            bool y_152391 = i_p_m_t_s_leq_w_152388 && zzero_lte_i_152389;
            bool y_152392 = zzero_leq_i_p_m_t_s_152387 && y_152391;
            bool forwards_ok_152393 = i_lte_j_152390 && y_152392;
            bool ok_or_empty_152394 = empty_slice_152384 || forwards_ok_152393;
            bool index_certs_152395;
            
            if (!ok_or_empty_152394) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_152380, ":", (long long) min_res_152382, "] out of bounds for array of shape [", (long long) n_99476, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:143:98-101\n   #4  ftRelational.fut:130:75-86\n   #5  ftRelational.fut:129:9-130:87\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164969 = (int64_t) 8 * j_m_i_152383;
            int64_t bytes_164971 = (int64_t) 4 * j_m_i_152383;
            
            if (mem_164970_cached_sizze_166310 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164970, &mem_164970_cached_sizze_166310, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164960.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_152380, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152383});
            if (mem_164972_cached_sizze_166311 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166311, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164962.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_152380, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152383});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_99476; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164958.mem)[write_iter_164733];
                int64_t write_iv_164737 = ((int64_t *) mem_param_164934.mem)[write_iter_164733];
                float write_iv_164738 = ((float *) mem_param_164937.mem)[write_iter_164733];
                bool cond_157292 = sle64(lower_bound_152380, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_152382);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_152380);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152383)) {
                    ((int64_t *) mem_164970)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152383)) {
                    ((float *) mem_164972)[lifted_lambda_res_157295] = write_iv_164738;
                }
            }
            
            int64_t tmp_152407 = add64((int64_t) 1, p_152379);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, lower_bound_152380, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152383});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164962.mem, lower_bound_152380, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152383});
            
            bool loop_cond_152415 = slt64(tmp_152407, m_152290);
            bool loop_while_tmp_165708 = loop_cond_152415;
            int64_t p_tmp_165711 = tmp_152407;
            
            loop_while_152376 = loop_while_tmp_165708;
            p_152379 = p_tmp_165711;
        }
        partitioned_scatter_res_152372 = loop_while_152376;
        partitioned_scatter_res_152375 = p_152379;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_164996, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164995, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164998, bytes_164930, "mem_164998")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164996.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99476});
    if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165000, bytes_164999, "mem_165000")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165000.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99476});
    if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164998, "mem_164998") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165000, "mem_165000") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166307, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166308, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164938);
        free(mem_164970);
        free(mem_164972);
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164998, "mem_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_166312, struct memblock *mem_out_p_166313, struct memblock xs_mem_164928, int64_t n_97719, int64_t incr_97720, int16_t block_sizze_97721)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164938_cached_sizze_166314 = 0;
    unsigned char *mem_164938 = NULL;
    int64_t mem_164970_cached_sizze_166315 = 0;
    unsigned char *mem_164970 = NULL;
    int64_t mem_164972_cached_sizze_166316 = 0;
    unsigned char *mem_164972 = NULL;
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock mem_164998;
    
    mem_164998.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_164960;
    
    mem_164960.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_param_164947;
    
    mem_param_164947.references = NULL;
    
    struct memblock ext_mem_164958;
    
    ext_mem_164958.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_164995;
    
    ext_mem_164995.references = NULL;
    
    struct memblock ext_mem_164996;
    
    ext_mem_164996.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_149291 = sext_i16_i64(block_sizze_97721);
    int64_t bytes_164930 = (int64_t) 8 * n_97719;
    bool zzero_149310 = i16_res_149291 == (int64_t) 0;
    bool nonzzero_149311 = !zzero_149310;
    bool nonzzero_cert_149314;
    
    if (!nonzzero_149311) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:126:78-89\n   #5  ftRelational.fut:125:9-126:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164999 = (int64_t) 4 * n_97719;
    
    if (futrts_indicesWithIncrement_12162(ctx, &ext_mem_164929, xs_mem_164928, n_97719, incr_97720) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_97719; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_149308 = add64(n_97719, i16_res_149291);
    int64_t zs_lhs_149309 = sub64(zm_lhs_149308, (int64_t) 1);
    int64_t m_149315 = sdiv_safe64(zs_lhs_149309, i16_res_149291);
    bool loop_cond_149316 = slt64((int64_t) 0, m_149315);
    
    if (mem_164938_cached_sizze_166314 < n_97719) {
        err = lexical_realloc(ctx, &mem_164938, &mem_164938_cached_sizze_166314, n_97719);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164937, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    for (int64_t i_149319 = 0; i_149319 < (int64_t) 16; i_149319++) {
        int32_t binop_x_149322 = sext_i64_i32(i_149319);
        int32_t binop_x_149323 = mul32(2, binop_x_149322);
        int32_t zm_lhs_149324 = add32(2, binop_x_149323);
        int32_t min_arg1_149325 = sub32(zm_lhs_149324, 1);
        int32_t min_res_149326 = smin32(32, min_arg1_149325);
        int32_t zp_lhs_149327 = sub32(min_res_149326, binop_x_149323);
        int32_t ij_bits_149328 = add32(1, zp_lhs_149327);
        int32_t up_to_149329 = shl32(1, ij_bits_149328);
        int64_t tmp_149330 = sext_i32_i64(zp_lhs_149327);
        bool bounds_invalid_upwards_149331 = slt32(zp_lhs_149327, 0);
        bool valid_149333 = !bounds_invalid_upwards_149331;
        bool range_valid_c_149334;
        
        if (!valid_149333) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149330, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:132:96-99\n   #5  ftRelational.fut:126:78-89\n   #6  ftRelational.fut:125:9-126:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_149347 = sext_i32_i64(up_to_149329);
        bool bounds_invalid_upwards_149348 = slt32(up_to_149329, 0);
        bool valid_149349 = !bounds_invalid_upwards_149348;
        bool range_valid_c_149350;
        
        if (!valid_149349) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149347, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:126:78-89\n   #5  ftRelational.fut:125:9-126:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_149332 = add64((int64_t) 1, tmp_149330);
        
        for (int64_t i_164713 = 0; i_164713 < n_97719; i_164713++) {
            int32_t eta_p_149336 = ((int32_t *) mem_param_164937.mem)[i_164713];
            int8_t defunc_0_f_res_149337;
            int8_t y_149339 = (int8_t) 0;
            
            for (int64_t i_149338 = 0; i_149338 < distance_149332; i_149338++) {
                int32_t binop_x_149340 = sext_i64_i32(i_149338);
                int32_t get_bit_arg0_149341 = add32(binop_x_149323, binop_x_149340);
                int32_t zgzg_res_155445 = ashr32(eta_p_149336, get_bit_arg0_149341);
                int32_t za_res_155446 = 1 & zgzg_res_155445;
                bool cond_149343 = get_bit_arg0_149341 == 31;
                int32_t defunc_0_get_bit_res_149344;
                
                if (cond_149343) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ za_res_155446;
                    
                    defunc_0_get_bit_res_149344 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_149344 = za_res_155446;
                }
                
                int8_t loopres_149346;
                
                if (futrts_set_bit_2464(ctx, &loopres_149346, binop_x_149340, y_149339, defunc_0_get_bit_res_149344) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_149346;
                
                y_149339 = y_tmp_165701;
            }
            defunc_0_f_res_149337 = y_149339;
            ((int8_t *) mem_164938)[i_164713] = defunc_0_f_res_149337;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_149351;
        int64_t offs_149354;
        
        if (memblock_set(ctx, &mem_param_164947, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_149354 = (int64_t) 0;
        for (int64_t i_149353 = 0; i_149353 < up_to_149347; i_149353++) {
            int32_t binop_x_149356 = sext_i64_i32(i_149353);
            int8_t index_primexp_149357 = zext_i32_i8(binop_x_149356);
            
            if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_97719; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164938)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_149357;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164947.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_149354, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164949.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_149382 = add64(offs_149354, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164949, "mem_164949") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_149382;
            
            if (memblock_set(ctx, &mem_param_164947, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_149354 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164958, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_149351 = offs_149354;
        if (memblock_alloc(ctx, &mem_164960, bytes_164930, "mem_164960")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_97719});
        if (memblock_alloc(ctx, &mem_164962, bytes_164999, "mem_164962")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_164937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_97719});
        
        bool partitioned_scatter_res_149389;
        int64_t partitioned_scatter_res_149392;
        bool loop_while_149393;
        int64_t p_149396;
        
        loop_while_149393 = loop_cond_149316;
        p_149396 = (int64_t) 0;
        while (loop_while_149393) {
            int64_t lower_bound_149397 = mul64(i16_res_149291, p_149396);
            int64_t min_arg1_149398 = add64(i16_res_149291, lower_bound_149397);
            int64_t min_res_149399 = smin64(n_97719, min_arg1_149398);
            int64_t j_m_i_149400 = sub64(min_res_149399, lower_bound_149397);
            bool empty_slice_149401 = j_m_i_149400 == (int64_t) 0;
            int64_t m_149402 = sub64(j_m_i_149400, (int64_t) 1);
            int64_t i_p_m_t_s_149403 = add64(lower_bound_149397, m_149402);
            bool zzero_leq_i_p_m_t_s_149404 = sle64((int64_t) 0, i_p_m_t_s_149403);
            bool i_p_m_t_s_leq_w_149405 = slt64(i_p_m_t_s_149403, n_97719);
            bool zzero_lte_i_149406 = sle64((int64_t) 0, lower_bound_149397);
            bool i_lte_j_149407 = sle64(lower_bound_149397, min_res_149399);
            bool y_149408 = i_p_m_t_s_leq_w_149405 && zzero_lte_i_149406;
            bool y_149409 = zzero_leq_i_p_m_t_s_149404 && y_149408;
            bool forwards_ok_149410 = i_lte_j_149407 && y_149409;
            bool ok_or_empty_149411 = empty_slice_149401 || forwards_ok_149410;
            bool index_certs_149412;
            
            if (!ok_or_empty_149411) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149397, ":", (long long) min_res_149399, "] out of bounds for array of shape [", (long long) n_97719, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:126:78-89\n   #5  ftRelational.fut:125:9-126:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164969 = (int64_t) 8 * j_m_i_149400;
            int64_t bytes_164971 = (int64_t) 4 * j_m_i_149400;
            
            if (mem_164970_cached_sizze_166315 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164970, &mem_164970_cached_sizze_166315, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164960.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149397, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            if (mem_164972_cached_sizze_166316 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166316, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164962.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149397, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_97719; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164958.mem)[write_iter_164733];
                int64_t write_iv_164737 = ((int64_t *) mem_param_164934.mem)[write_iter_164733];
                int32_t write_iv_164738 = ((int32_t *) mem_param_164937.mem)[write_iter_164733];
                bool cond_157292 = sle64(lower_bound_149397, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_149399);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_149397);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149400)) {
                    ((int64_t *) mem_164970)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149400)) {
                    ((int32_t *) mem_164972)[lifted_lambda_res_157295] = write_iv_164738;
                }
            }
            
            int64_t tmp_149424 = add64((int64_t) 1, p_149396);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, lower_bound_149397, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164962.mem, lower_bound_149397, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            
            bool loop_cond_149432 = slt64(tmp_149424, m_149315);
            bool loop_while_tmp_165708 = loop_cond_149432;
            int64_t p_tmp_165711 = tmp_149424;
            
            loop_while_149393 = loop_while_tmp_165708;
            p_149396 = p_tmp_165711;
        }
        partitioned_scatter_res_149389 = loop_while_149393;
        partitioned_scatter_res_149392 = p_149396;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_164996, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164995, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164998, bytes_164930, "mem_164998")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164996.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_97719});
    if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165000, bytes_164999, "mem_165000")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165000.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_164995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_97719});
    if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164998, "mem_164998") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165000, "mem_165000") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166312, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166313, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164938);
        free(mem_164970);
        free(mem_164972);
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164998, "mem_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_166317, struct memblock *mem_out_p_166318, struct memblock xs_mem_164928, int64_t n_98587, int64_t incr_98588, int16_t block_sizze_98589)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164938_cached_sizze_166319 = 0;
    unsigned char *mem_164938 = NULL;
    int64_t mem_164970_cached_sizze_166320 = 0;
    unsigned char *mem_164970 = NULL;
    int64_t mem_164972_cached_sizze_166321 = 0;
    unsigned char *mem_164972 = NULL;
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock mem_164998;
    
    mem_164998.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_164960;
    
    mem_164960.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_param_164947;
    
    mem_param_164947.references = NULL;
    
    struct memblock ext_mem_164958;
    
    ext_mem_164958.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_164995;
    
    ext_mem_164995.references = NULL;
    
    struct memblock ext_mem_164996;
    
    ext_mem_164996.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_149291 = sext_i16_i64(block_sizze_98589);
    int64_t bytes_164930 = (int64_t) 8 * n_98587;
    bool zzero_149310 = i16_res_149291 == (int64_t) 0;
    bool nonzzero_149311 = !zzero_149310;
    bool nonzzero_cert_149314;
    
    if (!nonzzero_149311) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:128:78-89\n   #5  ftRelational.fut:127:9-128:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_12184(ctx, &ext_mem_164929, xs_mem_164928, n_98587, incr_98588) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_98587; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_149308 = add64(n_98587, i16_res_149291);
    int64_t zs_lhs_149309 = sub64(zm_lhs_149308, (int64_t) 1);
    int64_t m_149315 = sdiv_safe64(zs_lhs_149309, i16_res_149291);
    bool loop_cond_149316 = slt64((int64_t) 0, m_149315);
    
    if (mem_164938_cached_sizze_166319 < n_98587) {
        err = lexical_realloc(ctx, &mem_164938, &mem_164938_cached_sizze_166319, n_98587);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164937, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    for (int64_t i_149319 = 0; i_149319 < (int64_t) 32; i_149319++) {
        int32_t binop_x_149322 = sext_i64_i32(i_149319);
        int32_t binop_x_149323 = mul32(2, binop_x_149322);
        int32_t zm_lhs_149324 = add32(2, binop_x_149323);
        int32_t min_arg1_149325 = sub32(zm_lhs_149324, 1);
        int32_t min_res_149326 = smin32(64, min_arg1_149325);
        int32_t zp_lhs_149327 = sub32(min_res_149326, binop_x_149323);
        int32_t ij_bits_149328 = add32(1, zp_lhs_149327);
        int32_t up_to_149329 = shl32(1, ij_bits_149328);
        int64_t tmp_149330 = sext_i32_i64(zp_lhs_149327);
        bool bounds_invalid_upwards_149331 = slt32(zp_lhs_149327, 0);
        bool valid_149333 = !bounds_invalid_upwards_149331;
        bool range_valid_c_149334;
        
        if (!valid_149333) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149330, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:132:96-99\n   #5  ftRelational.fut:128:78-89\n   #6  ftRelational.fut:127:9-128:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_149347 = sext_i32_i64(up_to_149329);
        bool bounds_invalid_upwards_149348 = slt32(up_to_149329, 0);
        bool valid_149349 = !bounds_invalid_upwards_149348;
        bool range_valid_c_149350;
        
        if (!valid_149349) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149347, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:128:78-89\n   #5  ftRelational.fut:127:9-128:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_149332 = add64((int64_t) 1, tmp_149330);
        
        for (int64_t i_164713 = 0; i_164713 < n_98587; i_164713++) {
            int64_t eta_p_149336 = ((int64_t *) mem_param_164937.mem)[i_164713];
            int8_t defunc_0_f_res_149337;
            int8_t y_149339 = (int8_t) 0;
            
            for (int64_t i_149338 = 0; i_149338 < distance_149332; i_149338++) {
                int32_t binop_x_149340 = sext_i64_i32(i_149338);
                int32_t get_bit_arg0_149341 = add32(binop_x_149323, binop_x_149340);
                int32_t defunc_0_get_bit_res_149342;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_149342, get_bit_arg0_149341, eta_p_149336) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_149343 = get_bit_arg0_149341 == 63;
                int32_t defunc_0_get_bit_res_149344;
                
                if (cond_149343) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ defunc_0_get_bit_res_149342;
                    
                    defunc_0_get_bit_res_149344 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_149344 = defunc_0_get_bit_res_149342;
                }
                
                int8_t loopres_149346;
                
                if (futrts_set_bit_2464(ctx, &loopres_149346, binop_x_149340, y_149339, defunc_0_get_bit_res_149344) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_149346;
                
                y_149339 = y_tmp_165701;
            }
            defunc_0_f_res_149337 = y_149339;
            ((int8_t *) mem_164938)[i_164713] = defunc_0_f_res_149337;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_149351;
        int64_t offs_149354;
        
        if (memblock_set(ctx, &mem_param_164947, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_149354 = (int64_t) 0;
        for (int64_t i_149353 = 0; i_149353 < up_to_149347; i_149353++) {
            int32_t binop_x_149356 = sext_i64_i32(i_149353);
            int8_t index_primexp_149357 = zext_i32_i8(binop_x_149356);
            
            if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_98587; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164938)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_149357;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164947.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_149354, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164949.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_149382 = add64(offs_149354, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164949, "mem_164949") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_149382;
            
            if (memblock_set(ctx, &mem_param_164947, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_149354 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164958, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_149351 = offs_149354;
        if (memblock_alloc(ctx, &mem_164960, bytes_164930, "mem_164960")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_98587});
        if (memblock_alloc(ctx, &mem_164962, bytes_164930, "mem_164962")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_98587});
        
        bool partitioned_scatter_res_149389;
        int64_t partitioned_scatter_res_149392;
        bool loop_while_149393;
        int64_t p_149396;
        
        loop_while_149393 = loop_cond_149316;
        p_149396 = (int64_t) 0;
        while (loop_while_149393) {
            int64_t lower_bound_149397 = mul64(i16_res_149291, p_149396);
            int64_t min_arg1_149398 = add64(i16_res_149291, lower_bound_149397);
            int64_t min_res_149399 = smin64(n_98587, min_arg1_149398);
            int64_t j_m_i_149400 = sub64(min_res_149399, lower_bound_149397);
            bool empty_slice_149401 = j_m_i_149400 == (int64_t) 0;
            int64_t m_149402 = sub64(j_m_i_149400, (int64_t) 1);
            int64_t i_p_m_t_s_149403 = add64(lower_bound_149397, m_149402);
            bool zzero_leq_i_p_m_t_s_149404 = sle64((int64_t) 0, i_p_m_t_s_149403);
            bool i_p_m_t_s_leq_w_149405 = slt64(i_p_m_t_s_149403, n_98587);
            bool zzero_lte_i_149406 = sle64((int64_t) 0, lower_bound_149397);
            bool i_lte_j_149407 = sle64(lower_bound_149397, min_res_149399);
            bool y_149408 = i_p_m_t_s_leq_w_149405 && zzero_lte_i_149406;
            bool y_149409 = zzero_leq_i_p_m_t_s_149404 && y_149408;
            bool forwards_ok_149410 = i_lte_j_149407 && y_149409;
            bool ok_or_empty_149411 = empty_slice_149401 || forwards_ok_149410;
            bool index_certs_149412;
            
            if (!ok_or_empty_149411) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149397, ":", (long long) min_res_149399, "] out of bounds for array of shape [", (long long) n_98587, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:128:78-89\n   #5  ftRelational.fut:127:9-128:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164969 = (int64_t) 8 * j_m_i_149400;
            
            if (mem_164970_cached_sizze_166320 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164970, &mem_164970_cached_sizze_166320, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164960.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149397, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            if (mem_164972_cached_sizze_166321 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166321, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164962.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149397, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_98587; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164958.mem)[write_iter_164733];
                int64_t write_iv_164737 = ((int64_t *) mem_param_164934.mem)[write_iter_164733];
                int64_t write_iv_164738 = ((int64_t *) mem_param_164937.mem)[write_iter_164733];
                bool cond_157292 = sle64(lower_bound_149397, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_149399);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_149397);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149400)) {
                    ((int64_t *) mem_164970)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149400)) {
                    ((int64_t *) mem_164972)[lifted_lambda_res_157295] = write_iv_164738;
                }
            }
            
            int64_t tmp_149424 = add64((int64_t) 1, p_149396);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, lower_bound_149397, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164962.mem, lower_bound_149397, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            
            bool loop_cond_149432 = slt64(tmp_149424, m_149315);
            bool loop_while_tmp_165708 = loop_cond_149432;
            int64_t p_tmp_165711 = tmp_149424;
            
            loop_while_149393 = loop_while_tmp_165708;
            p_149396 = p_tmp_165711;
        }
        partitioned_scatter_res_149389 = loop_while_149393;
        partitioned_scatter_res_149392 = p_149396;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_164996, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164995, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164998, bytes_164930, "mem_164998")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164996.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_98587});
    if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165000, bytes_164930, "mem_165000")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165000.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_98587});
    if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164998, "mem_164998") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165000, "mem_165000") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166317, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166318, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164938);
        free(mem_164970);
        free(mem_164972);
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164998, "mem_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_166322, struct memblock *mem_out_p_166323, struct memblock xs_mem_164928, int64_t n_96851, int64_t incr_96852, int16_t block_sizze_96853)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164938_cached_sizze_166324 = 0;
    unsigned char *mem_164938 = NULL;
    int64_t mem_164970_cached_sizze_166325 = 0;
    unsigned char *mem_164970 = NULL;
    int64_t mem_164972_cached_sizze_166326 = 0;
    unsigned char *mem_164972 = NULL;
    struct memblock mem_165000;
    
    mem_165000.references = NULL;
    
    struct memblock mem_164998;
    
    mem_164998.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164962;
    
    mem_164962.references = NULL;
    
    struct memblock mem_164960;
    
    mem_164960.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164949;
    
    mem_164949.references = NULL;
    
    struct memblock mem_param_164947;
    
    mem_param_164947.references = NULL;
    
    struct memblock ext_mem_164958;
    
    ext_mem_164958.references = NULL;
    
    struct memblock mem_param_164937;
    
    mem_param_164937.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_164995;
    
    ext_mem_164995.references = NULL;
    
    struct memblock ext_mem_164996;
    
    ext_mem_164996.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock ext_mem_164929;
    
    ext_mem_164929.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_149291 = sext_i16_i64(block_sizze_96853);
    int64_t bytes_164930 = (int64_t) 8 * n_96851;
    bool zzero_149310 = i16_res_149291 == (int64_t) 0;
    bool nonzzero_149311 = !zzero_149310;
    bool nonzzero_cert_149314;
    
    if (!nonzzero_149311) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:124:78-89\n   #5  ftRelational.fut:123:9-124:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164999 = (int64_t) 2 * n_96851;
    
    if (futrts_indicesWithIncrement_12141(ctx, &ext_mem_164929, xs_mem_164928, n_96851, incr_96852) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_96851; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_149308 = add64(n_96851, i16_res_149291);
    int64_t zs_lhs_149309 = sub64(zm_lhs_149308, (int64_t) 1);
    int64_t m_149315 = sdiv_safe64(zs_lhs_149309, i16_res_149291);
    bool loop_cond_149316 = slt64((int64_t) 0, m_149315);
    
    if (mem_164938_cached_sizze_166324 < n_96851) {
        err = lexical_realloc(ctx, &mem_164938, &mem_164938_cached_sizze_166324, n_96851);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164937, &xs_mem_164928, "xs_mem_164928") != 0)
        return 1;
    for (int64_t i_149319 = 0; i_149319 < (int64_t) 8; i_149319++) {
        int32_t binop_x_149322 = sext_i64_i32(i_149319);
        int32_t binop_x_149323 = mul32(2, binop_x_149322);
        int32_t zm_lhs_149324 = add32(2, binop_x_149323);
        int32_t min_arg1_149325 = sub32(zm_lhs_149324, 1);
        int32_t min_res_149326 = smin32(16, min_arg1_149325);
        int32_t zp_lhs_149327 = sub32(min_res_149326, binop_x_149323);
        int32_t ij_bits_149328 = add32(1, zp_lhs_149327);
        int32_t up_to_149329 = shl32(1, ij_bits_149328);
        int64_t tmp_149330 = sext_i32_i64(zp_lhs_149327);
        bool bounds_invalid_upwards_149331 = slt32(zp_lhs_149327, 0);
        bool valid_149333 = !bounds_invalid_upwards_149331;
        bool range_valid_c_149334;
        
        if (!valid_149333) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149330, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:132:96-99\n   #5  ftRelational.fut:124:78-89\n   #6  ftRelational.fut:123:9-124:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_149347 = sext_i32_i64(up_to_149329);
        bool bounds_invalid_upwards_149348 = slt32(up_to_149329, 0);
        bool valid_149349 = !bounds_invalid_upwards_149348;
        bool range_valid_c_149350;
        
        if (!valid_149349) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149347, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:124:78-89\n   #5  ftRelational.fut:123:9-124:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_149332 = add64((int64_t) 1, tmp_149330);
        
        for (int64_t i_164713 = 0; i_164713 < n_96851; i_164713++) {
            int16_t eta_p_149336 = ((int16_t *) mem_param_164937.mem)[i_164713];
            int8_t defunc_0_f_res_149337;
            int8_t y_149339 = (int8_t) 0;
            
            for (int64_t i_149338 = 0; i_149338 < distance_149332; i_149338++) {
                int32_t binop_x_149340 = sext_i64_i32(i_149338);
                int32_t get_bit_arg0_149341 = add32(binop_x_149323, binop_x_149340);
                int32_t defunc_0_get_bit_res_149342;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_149342, get_bit_arg0_149341, eta_p_149336) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_149343 = get_bit_arg0_149341 == 15;
                int32_t defunc_0_get_bit_res_149344;
                
                if (cond_149343) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ defunc_0_get_bit_res_149342;
                    
                    defunc_0_get_bit_res_149344 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_149344 = defunc_0_get_bit_res_149342;
                }
                
                int8_t loopres_149346;
                
                if (futrts_set_bit_2464(ctx, &loopres_149346, binop_x_149340, y_149339, defunc_0_get_bit_res_149344) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_149346;
                
                y_149339 = y_tmp_165701;
            }
            defunc_0_f_res_149337 = y_149339;
            ((int8_t *) mem_164938)[i_164713] = defunc_0_f_res_149337;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_149351;
        int64_t offs_149354;
        
        if (memblock_set(ctx, &mem_param_164947, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_149354 = (int64_t) 0;
        for (int64_t i_149353 = 0; i_149353 < up_to_149347; i_149353++) {
            int32_t binop_x_149356 = sext_i64_i32(i_149353);
            int8_t index_primexp_149357 = zext_i32_i8(binop_x_149356);
            
            if (memblock_alloc(ctx, &mem_164949, bytes_164930, "mem_164949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_96851; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164938)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_149357;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164947.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_149354, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164949.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_149382 = add64(offs_149354, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164949, "mem_164949") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_149382;
            
            if (memblock_set(ctx, &mem_param_164947, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_149354 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164958, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_149351 = offs_149354;
        if (memblock_alloc(ctx, &mem_164960, bytes_164930, "mem_164960")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_96851});
        if (memblock_alloc(ctx, &mem_164962, bytes_164999, "mem_164962")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_164962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_164937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_96851});
        
        bool partitioned_scatter_res_149389;
        int64_t partitioned_scatter_res_149392;
        bool loop_while_149393;
        int64_t p_149396;
        
        loop_while_149393 = loop_cond_149316;
        p_149396 = (int64_t) 0;
        while (loop_while_149393) {
            int64_t lower_bound_149397 = mul64(i16_res_149291, p_149396);
            int64_t min_arg1_149398 = add64(i16_res_149291, lower_bound_149397);
            int64_t min_res_149399 = smin64(n_96851, min_arg1_149398);
            int64_t j_m_i_149400 = sub64(min_res_149399, lower_bound_149397);
            bool empty_slice_149401 = j_m_i_149400 == (int64_t) 0;
            int64_t m_149402 = sub64(j_m_i_149400, (int64_t) 1);
            int64_t i_p_m_t_s_149403 = add64(lower_bound_149397, m_149402);
            bool zzero_leq_i_p_m_t_s_149404 = sle64((int64_t) 0, i_p_m_t_s_149403);
            bool i_p_m_t_s_leq_w_149405 = slt64(i_p_m_t_s_149403, n_96851);
            bool zzero_lte_i_149406 = sle64((int64_t) 0, lower_bound_149397);
            bool i_lte_j_149407 = sle64(lower_bound_149397, min_res_149399);
            bool y_149408 = i_p_m_t_s_leq_w_149405 && zzero_lte_i_149406;
            bool y_149409 = zzero_leq_i_p_m_t_s_149404 && y_149408;
            bool forwards_ok_149410 = i_lte_j_149407 && y_149409;
            bool ok_or_empty_149411 = empty_slice_149401 || forwards_ok_149410;
            bool index_certs_149412;
            
            if (!ok_or_empty_149411) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149397, ":", (long long) min_res_149399, "] out of bounds for array of shape [", (long long) n_96851, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:132:96-99\n   #4  ftRelational.fut:124:78-89\n   #5  ftRelational.fut:123:9-124:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164969 = (int64_t) 8 * j_m_i_149400;
            int64_t bytes_164971 = (int64_t) 2 * j_m_i_149400;
            
            if (mem_164970_cached_sizze_166325 < bytes_164969) {
                err = lexical_realloc(ctx, &mem_164970, &mem_164970_cached_sizze_166325, bytes_164969);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164960.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149397, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            if (mem_164972_cached_sizze_166326 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166326, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_164962.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149397, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_96851; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164958.mem)[write_iter_164733];
                int64_t write_iv_164737 = ((int64_t *) mem_param_164934.mem)[write_iter_164733];
                int16_t write_iv_164738 = ((int16_t *) mem_param_164937.mem)[write_iter_164733];
                bool cond_157292 = sle64(lower_bound_149397, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_149399);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_149397);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149400)) {
                    ((int64_t *) mem_164970)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149400)) {
                    ((int16_t *) mem_164972)[lifted_lambda_res_157295] = write_iv_164738;
                }
            }
            
            int64_t tmp_149424 = add64((int64_t) 1, p_149396);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164960.mem, lower_bound_149397, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164970, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_164962.mem, lower_bound_149397, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149400});
            
            bool loop_cond_149432 = slt64(tmp_149424, m_149315);
            bool loop_while_tmp_165708 = loop_cond_149432;
            int64_t p_tmp_165711 = tmp_149424;
            
            loop_while_149393 = loop_while_tmp_165708;
            p_149396 = p_tmp_165711;
        }
        partitioned_scatter_res_149389 = loop_while_149393;
        partitioned_scatter_res_149392 = p_149396;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164937, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_164996, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_164995, &mem_param_164937, "mem_param_164937") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_164998, bytes_164930, "mem_164998")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_164996.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_96851});
    if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165000, bytes_164999, "mem_165000")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_165000.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_164995.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_96851});
    if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_164998, "mem_164998") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165000, "mem_165000") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166322, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166323, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164938);
        free(mem_164970);
        free(mem_164972);
        if (memblock_unref(ctx, &mem_165000, "mem_165000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164998, "mem_164998") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164962, "mem_164962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164960, "mem_164960") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164949, "mem_164949") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164947, "mem_param_164947") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164958, "ext_mem_164958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164937, "mem_param_164937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164995, "ext_mem_164995") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164996, "ext_mem_164996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164929, "ext_mem_164929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_166327, struct memblock *mem_out_p_166328, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_84062, int64_t b_84063, int16_t block_sizze_84064)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164939_cached_sizze_166329 = 0;
    unsigned char *mem_164939 = NULL;
    int64_t mem_164972_cached_sizze_166330 = 0;
    unsigned char *mem_164972 = NULL;
    int64_t mem_164974_cached_sizze_166331 = 0;
    unsigned char *mem_164974 = NULL;
    int64_t mem_164982_cached_sizze_166332 = 0;
    unsigned char *mem_164982 = NULL;
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock mem_165005;
    
    mem_165005.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_164961;
    
    mem_164961.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164950;
    
    mem_164950.references = NULL;
    
    struct memblock mem_param_164948;
    
    mem_param_164948.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock mem_param_164938;
    
    mem_param_164938.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_165002;
    
    ext_mem_165002.references = NULL;
    
    struct memblock ext_mem_165003;
    
    ext_mem_165003.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_152260 = sext_i16_i64(block_sizze_84064);
    int64_t bytes_164930 = (int64_t) 8 * n_84062;
    bool zzero_152280 = i16_res_152260 == (int64_t) 0;
    bool nonzzero_152281 = !zzero_152280;
    bool nonzzero_cert_152284;
    
    if (!nonzzero_152281) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:97:98-101\n   #4  ftRelational.fut:96:78-89\n   #5  ftRelational.fut:92:9-96:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165006 = n_84062 * b_84063;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_84062; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_152278 = add64(n_84062, i16_res_152260);
    int64_t zs_lhs_152279 = sub64(zm_lhs_152278, (int64_t) 1);
    int64_t m_152285 = sdiv_safe64(zs_lhs_152279, i16_res_152260);
    bool loop_cond_152286 = slt64((int64_t) 0, m_152285);
    
    if (mem_164939_cached_sizze_166329 < n_84062) {
        err = lexical_realloc(ctx, &mem_164939, &mem_164939_cached_sizze_166329, n_84062);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164982_cached_sizze_166332 < b_84063) {
        err = lexical_realloc(ctx, &mem_164982, &mem_164982_cached_sizze_166332, b_84063);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &k_mem_164928, "k_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164938, &pL_mem_164929, "pL_mem_164929") != 0)
        return 1;
    for (int64_t i_152289 = 0; i_152289 < (int64_t) 32; i_152289++) {
        int32_t binop_x_152292 = sext_i64_i32(i_152289);
        int32_t binop_x_152293 = mul32(2, binop_x_152292);
        int32_t zm_lhs_152294 = add32(2, binop_x_152293);
        int32_t min_arg1_152295 = sub32(zm_lhs_152294, 1);
        int32_t min_res_152296 = smin32(64, min_arg1_152295);
        int32_t zp_lhs_152297 = sub32(min_res_152296, binop_x_152293);
        int32_t ij_bits_152298 = add32(1, zp_lhs_152297);
        int32_t up_to_152299 = shl32(1, ij_bits_152298);
        int64_t tmp_152300 = sext_i32_i64(zp_lhs_152297);
        bool bounds_invalid_upwards_152301 = slt32(zp_lhs_152297, 0);
        bool valid_152303 = !bounds_invalid_upwards_152301;
        bool range_valid_c_152304;
        
        if (!valid_152303) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_152300, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:97:98-101\n   #5  ftRelational.fut:96:78-89\n   #6  ftRelational.fut:92:9-96:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_152328 = sext_i32_i64(up_to_152299);
        bool bounds_invalid_upwards_152329 = slt32(up_to_152299, 0);
        bool valid_152330 = !bounds_invalid_upwards_152329;
        bool range_valid_c_152331;
        
        if (!valid_152330) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_152328, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:97:98-101\n   #4  ftRelational.fut:96:78-89\n   #5  ftRelational.fut:92:9-96:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_152302 = add64((int64_t) 1, tmp_152300);
        
        for (int64_t i_164713 = 0; i_164713 < n_84062; i_164713++) {
            double eta_p_152306 = ((double *) mem_param_164934.mem)[i_164713];
            int64_t i64_arg0_152307 = futrts_to_bits64(eta_p_152306);
            int64_t unsign_arg0_152308 = ashr64(i64_arg0_152307, (int64_t) 63);
            int64_t unsign_arg0_152309 = (int64_t) 1 & unsign_arg0_152308;
            int32_t to_i32_res_152310 = zext_i64_i32(unsign_arg0_152309);
            bool cond_152311 = to_i32_res_152310 == 1;
            bool x_152312 = !cond_152311;
            int8_t defunc_0_f_res_152313;
            int8_t y_152315 = (int8_t) 0;
            
            for (int64_t i_152314 = 0; i_152314 < distance_152302; i_152314++) {
                int32_t binop_x_152316 = sext_i64_i32(i_152314);
                int32_t get_bit_arg0_152317 = add32(binop_x_152293, binop_x_152316);
                int64_t unsign_arg0_152318 = zext_i32_i64(get_bit_arg0_152317);
                int64_t unsign_arg0_152319 = ashr64(i64_arg0_152307, unsign_arg0_152318);
                int64_t unsign_arg0_152320 = (int64_t) 1 & unsign_arg0_152319;
                int32_t to_i32_res_152321 = zext_i64_i32(unsign_arg0_152320);
                bool cond_f_res_152322 = get_bit_arg0_152317 == 63;
                bool y_152323 = x_152312 && cond_f_res_152322;
                bool cond_152324 = cond_152311 || y_152323;
                int32_t defunc_0_get_bit_res_152325;
                
                if (cond_152324) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ to_i32_res_152321;
                    
                    defunc_0_get_bit_res_152325 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_152325 = to_i32_res_152321;
                }
                
                int8_t loopres_152327;
                
                if (futrts_set_bit_2464(ctx, &loopres_152327, binop_x_152316, y_152315, defunc_0_get_bit_res_152325) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_152327;
                
                y_152315 = y_tmp_165701;
            }
            defunc_0_f_res_152313 = y_152315;
            ((int8_t *) mem_164939)[i_164713] = defunc_0_f_res_152313;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_152332;
        int64_t offs_152335;
        
        if (memblock_set(ctx, &mem_param_164948, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_152335 = (int64_t) 0;
        for (int64_t i_152334 = 0; i_152334 < up_to_152328; i_152334++) {
            int32_t binop_x_152337 = sext_i64_i32(i_152334);
            int8_t index_primexp_152338 = zext_i32_i8(binop_x_152337);
            
            if (memblock_alloc(ctx, &mem_164950, bytes_164930, "mem_164950")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_84062; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164939)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_152338;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164948.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_152335, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164950.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_152363 = add64(offs_152335, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164950, "mem_164950") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_152363;
            
            if (memblock_set(ctx, &mem_param_164948, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_152335 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164959, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_152332 = offs_152335;
        if (memblock_alloc(ctx, &mem_164961, bytes_164930, "mem_164961")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164961.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_84062});
        if (memblock_alloc(ctx, &mem_164963, bytes_165006, "mem_164963")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {b_84063, (int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0, (int64_t []) {b_84063, (int64_t) 1}, (int64_t []) {n_84062, b_84063});
        
        bool partitioned_scatter_res_152370;
        int64_t partitioned_scatter_res_152373;
        bool loop_while_152374;
        int64_t p_152377;
        
        loop_while_152374 = loop_cond_152286;
        p_152377 = (int64_t) 0;
        while (loop_while_152374) {
            int64_t lower_bound_152378 = mul64(i16_res_152260, p_152377);
            int64_t min_arg1_152379 = add64(i16_res_152260, lower_bound_152378);
            int64_t min_res_152380 = smin64(n_84062, min_arg1_152379);
            int64_t j_m_i_152381 = sub64(min_res_152380, lower_bound_152378);
            bool empty_slice_152382 = j_m_i_152381 == (int64_t) 0;
            int64_t m_152383 = sub64(j_m_i_152381, (int64_t) 1);
            int64_t i_p_m_t_s_152384 = add64(lower_bound_152378, m_152383);
            bool zzero_leq_i_p_m_t_s_152385 = sle64((int64_t) 0, i_p_m_t_s_152384);
            bool i_p_m_t_s_leq_w_152386 = slt64(i_p_m_t_s_152384, n_84062);
            bool zzero_lte_i_152387 = sle64((int64_t) 0, lower_bound_152378);
            bool i_lte_j_152388 = sle64(lower_bound_152378, min_res_152380);
            bool y_152389 = i_p_m_t_s_leq_w_152386 && zzero_lte_i_152387;
            bool y_152390 = zzero_leq_i_p_m_t_s_152385 && y_152389;
            bool forwards_ok_152391 = i_lte_j_152388 && y_152390;
            bool ok_or_empty_152392 = empty_slice_152382 || forwards_ok_152391;
            bool index_certs_152393;
            
            if (!ok_or_empty_152392) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_152378, ":", (long long) min_res_152380, "] out of bounds for array of shape [", (long long) n_84062, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:97:98-101\n   #4  ftRelational.fut:96:78-89\n   #5  ftRelational.fut:92:9-96:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164971 = (int64_t) 8 * j_m_i_152381;
            int64_t bytes_164973 = b_84063 * j_m_i_152381;
            
            if (mem_164972_cached_sizze_166330 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166330, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164961.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_152378, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152381});
            if (mem_164974_cached_sizze_166331 < bytes_164973) {
                err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_166331, bytes_164973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_84063, (int64_t) 1}, (uint8_t *) mem_164963.mem, (int64_t) 0 + b_84063 * lower_bound_152378, (int64_t []) {b_84063, (int64_t) 1}, (int64_t []) {j_m_i_152381, b_84063});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_84062; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164959.mem)[write_iter_164733];
                double write_iv_164737 = ((double *) mem_param_164934.mem)[write_iter_164733];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0 + write_iter_164733 * b_84063, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84063});
                
                bool cond_157292 = sle64(lower_bound_152378, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_152380);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_152378);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152381)) {
                    ((double *) mem_164972)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152381)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_84063 - (int64_t) 1, b_84063))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_164974, lifted_lambda_res_157295 * b_84063, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84063});
                }
            }
            
            int64_t tmp_152405 = add64((int64_t) 1, p_152377);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164961.mem, lower_bound_152378, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152381});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, b_84063 * lower_bound_152378, (int64_t []) {b_84063, (int64_t) 1}, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_84063, (int64_t) 1}, (int64_t []) {j_m_i_152381, b_84063});
            
            bool loop_cond_152413 = slt64(tmp_152405, m_152285);
            bool loop_while_tmp_165708 = loop_cond_152413;
            int64_t p_tmp_165711 = tmp_152405;
            
            loop_while_152374 = loop_while_tmp_165708;
            p_152377 = p_tmp_165711;
        }
        partitioned_scatter_res_152370 = loop_while_152374;
        partitioned_scatter_res_152373 = p_152377;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164938, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_165003, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165002, &mem_param_164938, "mem_param_164938") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165005, bytes_164930, "mem_165005")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165005.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165003.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_84062});
    if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165007.mem, (int64_t) 0, (int64_t []) {b_84063, (int64_t) 1}, (uint8_t *) ext_mem_165002.mem, (int64_t) 0, (int64_t []) {b_84063, (int64_t) 1}, (int64_t []) {n_84062, b_84063});
    if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165005, "mem_165005") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165007, "mem_165007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166327, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166328, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164939);
        free(mem_164972);
        free(mem_164974);
        free(mem_164982);
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165005, "mem_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164950, "mem_164950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164938, "mem_param_164938") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_166333, struct memblock *mem_out_p_166334, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_83112, int64_t b_83113, int16_t block_sizze_83114)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164939_cached_sizze_166335 = 0;
    unsigned char *mem_164939 = NULL;
    int64_t mem_164972_cached_sizze_166336 = 0;
    unsigned char *mem_164972 = NULL;
    int64_t mem_164974_cached_sizze_166337 = 0;
    unsigned char *mem_164974 = NULL;
    int64_t mem_164982_cached_sizze_166338 = 0;
    unsigned char *mem_164982 = NULL;
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock mem_165005;
    
    mem_165005.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_164961;
    
    mem_164961.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164950;
    
    mem_164950.references = NULL;
    
    struct memblock mem_param_164948;
    
    mem_param_164948.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock mem_param_164938;
    
    mem_param_164938.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_165002;
    
    ext_mem_165002.references = NULL;
    
    struct memblock ext_mem_165003;
    
    ext_mem_165003.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_152260 = sext_i16_i64(block_sizze_83114);
    int64_t bytes_164930 = (int64_t) 8 * n_83112;
    bool zzero_152279 = i16_res_152260 == (int64_t) 0;
    bool nonzzero_152280 = !zzero_152279;
    bool nonzzero_cert_152283;
    
    if (!nonzzero_152280) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:97:98-101\n   #4  ftRelational.fut:91:78-89\n   #5  ftRelational.fut:87:9-91:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165004 = (int64_t) 4 * n_83112;
    int64_t bytes_165006 = n_83112 * b_83113;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_83112; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_152277 = add64(n_83112, i16_res_152260);
    int64_t zs_lhs_152278 = sub64(zm_lhs_152277, (int64_t) 1);
    int64_t m_152284 = sdiv_safe64(zs_lhs_152278, i16_res_152260);
    bool loop_cond_152285 = slt64((int64_t) 0, m_152284);
    
    if (mem_164939_cached_sizze_166335 < n_83112) {
        err = lexical_realloc(ctx, &mem_164939, &mem_164939_cached_sizze_166335, n_83112);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164982_cached_sizze_166338 < b_83113) {
        err = lexical_realloc(ctx, &mem_164982, &mem_164982_cached_sizze_166338, b_83113);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &k_mem_164928, "k_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164938, &pL_mem_164929, "pL_mem_164929") != 0)
        return 1;
    for (int64_t i_152288 = 0; i_152288 < (int64_t) 16; i_152288++) {
        int32_t binop_x_152291 = sext_i64_i32(i_152288);
        int32_t binop_x_152292 = mul32(2, binop_x_152291);
        int32_t zm_lhs_152293 = add32(2, binop_x_152292);
        int32_t min_arg1_152294 = sub32(zm_lhs_152293, 1);
        int32_t min_res_152295 = smin32(32, min_arg1_152294);
        int32_t zp_lhs_152296 = sub32(min_res_152295, binop_x_152292);
        int32_t ij_bits_152297 = add32(1, zp_lhs_152296);
        int32_t up_to_152298 = shl32(1, ij_bits_152297);
        int64_t tmp_152299 = sext_i32_i64(zp_lhs_152296);
        bool bounds_invalid_upwards_152300 = slt32(zp_lhs_152296, 0);
        bool valid_152302 = !bounds_invalid_upwards_152300;
        bool range_valid_c_152303;
        
        if (!valid_152302) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_152299, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:53:58-60\n   #4  ftSMJ.fut:97:98-101\n   #5  ftRelational.fut:91:78-89\n   #6  ftRelational.fut:87:9-91:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_152324 = sext_i32_i64(up_to_152298);
        bool bounds_invalid_upwards_152325 = slt32(up_to_152298, 0);
        bool valid_152326 = !bounds_invalid_upwards_152325;
        bool range_valid_c_152327;
        
        if (!valid_152326) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_152324, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:97:98-101\n   #4  ftRelational.fut:91:78-89\n   #5  ftRelational.fut:87:9-91:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_152301 = add64((int64_t) 1, tmp_152299);
        
        for (int64_t i_164713 = 0; i_164713 < n_83112; i_164713++) {
            float eta_p_152305 = ((float *) mem_param_164934.mem)[i_164713];
            int32_t i32_arg0_152306 = futrts_to_bits32(eta_p_152305);
            int32_t unsign_arg0_152307 = ashr32(i32_arg0_152306, 31);
            int32_t unsign_arg0_152308 = 1 & unsign_arg0_152307;
            bool cond_152309 = unsign_arg0_152308 == 1;
            bool x_152310 = !cond_152309;
            int8_t defunc_0_f_res_152311;
            int8_t y_152313 = (int8_t) 0;
            
            for (int64_t i_152312 = 0; i_152312 < distance_152301; i_152312++) {
                int32_t binop_x_152314 = sext_i64_i32(i_152312);
                int32_t get_bit_arg0_152315 = add32(binop_x_152292, binop_x_152314);
                int32_t unsign_arg0_152316 = ashr32(i32_arg0_152306, get_bit_arg0_152315);
                int32_t unsign_arg0_152317 = 1 & unsign_arg0_152316;
                bool cond_f_res_152318 = get_bit_arg0_152315 == 31;
                bool y_152319 = x_152310 && cond_f_res_152318;
                bool cond_152320 = cond_152309 || y_152319;
                int32_t defunc_0_get_bit_res_152321;
                
                if (cond_152320) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ unsign_arg0_152317;
                    
                    defunc_0_get_bit_res_152321 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_152321 = unsign_arg0_152317;
                }
                
                int8_t loopres_152323;
                
                if (futrts_set_bit_2464(ctx, &loopres_152323, binop_x_152314, y_152313, defunc_0_get_bit_res_152321) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_152323;
                
                y_152313 = y_tmp_165701;
            }
            defunc_0_f_res_152311 = y_152313;
            ((int8_t *) mem_164939)[i_164713] = defunc_0_f_res_152311;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_152328;
        int64_t offs_152331;
        
        if (memblock_set(ctx, &mem_param_164948, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_152331 = (int64_t) 0;
        for (int64_t i_152330 = 0; i_152330 < up_to_152324; i_152330++) {
            int32_t binop_x_152333 = sext_i64_i32(i_152330);
            int8_t index_primexp_152334 = zext_i32_i8(binop_x_152333);
            
            if (memblock_alloc(ctx, &mem_164950, bytes_164930, "mem_164950")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_83112; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164939)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_152334;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164948.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_152331, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164950.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_152359 = add64(offs_152331, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164950, "mem_164950") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_152359;
            
            if (memblock_set(ctx, &mem_param_164948, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_152331 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164959, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_152328 = offs_152331;
        if (memblock_alloc(ctx, &mem_164961, bytes_165004, "mem_164961")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_164961.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_83112});
        if (memblock_alloc(ctx, &mem_164963, bytes_165006, "mem_164963")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {b_83113, (int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0, (int64_t []) {b_83113, (int64_t) 1}, (int64_t []) {n_83112, b_83113});
        
        bool partitioned_scatter_res_152366;
        int64_t partitioned_scatter_res_152369;
        bool loop_while_152370;
        int64_t p_152373;
        
        loop_while_152370 = loop_cond_152285;
        p_152373 = (int64_t) 0;
        while (loop_while_152370) {
            int64_t lower_bound_152374 = mul64(i16_res_152260, p_152373);
            int64_t min_arg1_152375 = add64(i16_res_152260, lower_bound_152374);
            int64_t min_res_152376 = smin64(n_83112, min_arg1_152375);
            int64_t j_m_i_152377 = sub64(min_res_152376, lower_bound_152374);
            bool empty_slice_152378 = j_m_i_152377 == (int64_t) 0;
            int64_t m_152379 = sub64(j_m_i_152377, (int64_t) 1);
            int64_t i_p_m_t_s_152380 = add64(lower_bound_152374, m_152379);
            bool zzero_leq_i_p_m_t_s_152381 = sle64((int64_t) 0, i_p_m_t_s_152380);
            bool i_p_m_t_s_leq_w_152382 = slt64(i_p_m_t_s_152380, n_83112);
            bool zzero_lte_i_152383 = sle64((int64_t) 0, lower_bound_152374);
            bool i_lte_j_152384 = sle64(lower_bound_152374, min_res_152376);
            bool y_152385 = i_p_m_t_s_leq_w_152382 && zzero_lte_i_152383;
            bool y_152386 = zzero_leq_i_p_m_t_s_152381 && y_152385;
            bool forwards_ok_152387 = i_lte_j_152384 && y_152386;
            bool ok_or_empty_152388 = empty_slice_152378 || forwards_ok_152387;
            bool index_certs_152389;
            
            if (!ok_or_empty_152388) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_152374, ":", (long long) min_res_152376, "] out of bounds for array of shape [", (long long) n_83112, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:53:58-60\n   #3  ftSMJ.fut:97:98-101\n   #4  ftRelational.fut:91:78-89\n   #5  ftRelational.fut:87:9-91:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164971 = (int64_t) 4 * j_m_i_152377;
            int64_t bytes_164973 = b_83113 * j_m_i_152377;
            
            if (mem_164972_cached_sizze_166336 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166336, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164961.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_152374, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152377});
            if (mem_164974_cached_sizze_166337 < bytes_164973) {
                err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_166337, bytes_164973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_83113, (int64_t) 1}, (uint8_t *) mem_164963.mem, (int64_t) 0 + b_83113 * lower_bound_152374, (int64_t []) {b_83113, (int64_t) 1}, (int64_t []) {j_m_i_152377, b_83113});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_83112; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164959.mem)[write_iter_164733];
                float write_iv_164737 = ((float *) mem_param_164934.mem)[write_iter_164733];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0 + write_iter_164733 * b_83113, (int64_t []) {(int64_t) 1}, (int64_t []) {b_83113});
                
                bool cond_157292 = sle64(lower_bound_152374, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_152376);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_152374);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152377)) {
                    ((float *) mem_164972)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_152377)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_83113 - (int64_t) 1, b_83113))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_164974, lifted_lambda_res_157295 * b_83113, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_83113});
                }
            }
            
            int64_t tmp_152401 = add64((int64_t) 1, p_152373);
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164961.mem, lower_bound_152374, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_152377});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, b_83113 * lower_bound_152374, (int64_t []) {b_83113, (int64_t) 1}, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_83113, (int64_t) 1}, (int64_t []) {j_m_i_152377, b_83113});
            
            bool loop_cond_152409 = slt64(tmp_152401, m_152284);
            bool loop_while_tmp_165708 = loop_cond_152409;
            int64_t p_tmp_165711 = tmp_152401;
            
            loop_while_152370 = loop_while_tmp_165708;
            p_152373 = p_tmp_165711;
        }
        partitioned_scatter_res_152366 = loop_while_152370;
        partitioned_scatter_res_152369 = p_152373;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164938, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_165003, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165002, &mem_param_164938, "mem_param_164938") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165005, bytes_165004, "mem_165005")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165005.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165003.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_83112});
    if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165007.mem, (int64_t) 0, (int64_t []) {b_83113, (int64_t) 1}, (uint8_t *) ext_mem_165002.mem, (int64_t) 0, (int64_t []) {b_83113, (int64_t) 1}, (int64_t []) {n_83112, b_83113});
    if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165005, "mem_165005") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165007, "mem_165007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166333, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166334, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164939);
        free(mem_164972);
        free(mem_164974);
        free(mem_164982);
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165005, "mem_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164950, "mem_164950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164938, "mem_param_164938") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_166339, struct memblock *mem_out_p_166340, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_81278, int64_t b_81279, int16_t block_sizze_81280)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164939_cached_sizze_166341 = 0;
    unsigned char *mem_164939 = NULL;
    int64_t mem_164972_cached_sizze_166342 = 0;
    unsigned char *mem_164972 = NULL;
    int64_t mem_164974_cached_sizze_166343 = 0;
    unsigned char *mem_164974 = NULL;
    int64_t mem_164982_cached_sizze_166344 = 0;
    unsigned char *mem_164982 = NULL;
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock mem_165005;
    
    mem_165005.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_164961;
    
    mem_164961.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164950;
    
    mem_164950.references = NULL;
    
    struct memblock mem_param_164948;
    
    mem_param_164948.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock mem_param_164938;
    
    mem_param_164938.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_165002;
    
    ext_mem_165002.references = NULL;
    
    struct memblock ext_mem_165003;
    
    ext_mem_165003.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_149285 = sext_i16_i64(block_sizze_81280);
    int64_t bytes_164930 = (int64_t) 8 * n_81278;
    bool zzero_149304 = i16_res_149285 == (int64_t) 0;
    bool nonzzero_149305 = !zzero_149304;
    bool nonzzero_cert_149308;
    
    if (!nonzzero_149305) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:81:81-92\n   #5  ftRelational.fut:77:9-81:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165004 = (int64_t) 4 * n_81278;
    int64_t bytes_165006 = n_81278 * b_81279;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_81278; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_149302 = add64(n_81278, i16_res_149285);
    int64_t zs_lhs_149303 = sub64(zm_lhs_149302, (int64_t) 1);
    int64_t m_149309 = sdiv_safe64(zs_lhs_149303, i16_res_149285);
    bool loop_cond_149310 = slt64((int64_t) 0, m_149309);
    
    if (mem_164939_cached_sizze_166341 < n_81278) {
        err = lexical_realloc(ctx, &mem_164939, &mem_164939_cached_sizze_166341, n_81278);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164982_cached_sizze_166344 < b_81279) {
        err = lexical_realloc(ctx, &mem_164982, &mem_164982_cached_sizze_166344, b_81279);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &k_mem_164928, "k_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164938, &pL_mem_164929, "pL_mem_164929") != 0)
        return 1;
    for (int64_t i_149313 = 0; i_149313 < (int64_t) 16; i_149313++) {
        int32_t binop_x_149316 = sext_i64_i32(i_149313);
        int32_t binop_x_149317 = mul32(2, binop_x_149316);
        int32_t zm_lhs_149318 = add32(2, binop_x_149317);
        int32_t min_arg1_149319 = sub32(zm_lhs_149318, 1);
        int32_t min_res_149320 = smin32(32, min_arg1_149319);
        int32_t zp_lhs_149321 = sub32(min_res_149320, binop_x_149317);
        int32_t ij_bits_149322 = add32(1, zp_lhs_149321);
        int32_t up_to_149323 = shl32(1, ij_bits_149322);
        int64_t tmp_149324 = sext_i32_i64(zp_lhs_149321);
        bool bounds_invalid_upwards_149325 = slt32(zp_lhs_149321, 0);
        bool valid_149327 = !bounds_invalid_upwards_149325;
        bool range_valid_c_149328;
        
        if (!valid_149327) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149324, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:87:96-99\n   #5  ftRelational.fut:81:81-92\n   #6  ftRelational.fut:77:9-81:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_149341 = sext_i32_i64(up_to_149323);
        bool bounds_invalid_upwards_149342 = slt32(up_to_149323, 0);
        bool valid_149343 = !bounds_invalid_upwards_149342;
        bool range_valid_c_149344;
        
        if (!valid_149343) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149341, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:81:81-92\n   #5  ftRelational.fut:77:9-81:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_149326 = add64((int64_t) 1, tmp_149324);
        
        for (int64_t i_164713 = 0; i_164713 < n_81278; i_164713++) {
            int32_t eta_p_149330 = ((int32_t *) mem_param_164934.mem)[i_164713];
            int8_t defunc_0_f_res_149331;
            int8_t y_149333 = (int8_t) 0;
            
            for (int64_t i_149332 = 0; i_149332 < distance_149326; i_149332++) {
                int32_t binop_x_149334 = sext_i64_i32(i_149332);
                int32_t get_bit_arg0_149335 = add32(binop_x_149317, binop_x_149334);
                int32_t zgzg_res_155445 = ashr32(eta_p_149330, get_bit_arg0_149335);
                int32_t za_res_155446 = 1 & zgzg_res_155445;
                bool cond_149337 = get_bit_arg0_149335 == 31;
                int32_t defunc_0_get_bit_res_149338;
                
                if (cond_149337) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ za_res_155446;
                    
                    defunc_0_get_bit_res_149338 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_149338 = za_res_155446;
                }
                
                int8_t loopres_149340;
                
                if (futrts_set_bit_2464(ctx, &loopres_149340, binop_x_149334, y_149333, defunc_0_get_bit_res_149338) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_149340;
                
                y_149333 = y_tmp_165701;
            }
            defunc_0_f_res_149331 = y_149333;
            ((int8_t *) mem_164939)[i_164713] = defunc_0_f_res_149331;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_149345;
        int64_t offs_149348;
        
        if (memblock_set(ctx, &mem_param_164948, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_149348 = (int64_t) 0;
        for (int64_t i_149347 = 0; i_149347 < up_to_149341; i_149347++) {
            int32_t binop_x_149350 = sext_i64_i32(i_149347);
            int8_t index_primexp_149351 = zext_i32_i8(binop_x_149350);
            
            if (memblock_alloc(ctx, &mem_164950, bytes_164930, "mem_164950")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_81278; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164939)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_149351;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164948.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_149348, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164950.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_149376 = add64(offs_149348, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164950, "mem_164950") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_149376;
            
            if (memblock_set(ctx, &mem_param_164948, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_149348 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164959, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_149345 = offs_149348;
        if (memblock_alloc(ctx, &mem_164961, bytes_165004, "mem_164961")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_164961.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_81278});
        if (memblock_alloc(ctx, &mem_164963, bytes_165006, "mem_164963")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {b_81279, (int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0, (int64_t []) {b_81279, (int64_t) 1}, (int64_t []) {n_81278, b_81279});
        
        bool partitioned_scatter_res_149383;
        int64_t partitioned_scatter_res_149386;
        bool loop_while_149387;
        int64_t p_149390;
        
        loop_while_149387 = loop_cond_149310;
        p_149390 = (int64_t) 0;
        while (loop_while_149387) {
            int64_t lower_bound_149391 = mul64(i16_res_149285, p_149390);
            int64_t min_arg1_149392 = add64(i16_res_149285, lower_bound_149391);
            int64_t min_res_149393 = smin64(n_81278, min_arg1_149392);
            int64_t j_m_i_149394 = sub64(min_res_149393, lower_bound_149391);
            bool empty_slice_149395 = j_m_i_149394 == (int64_t) 0;
            int64_t m_149396 = sub64(j_m_i_149394, (int64_t) 1);
            int64_t i_p_m_t_s_149397 = add64(lower_bound_149391, m_149396);
            bool zzero_leq_i_p_m_t_s_149398 = sle64((int64_t) 0, i_p_m_t_s_149397);
            bool i_p_m_t_s_leq_w_149399 = slt64(i_p_m_t_s_149397, n_81278);
            bool zzero_lte_i_149400 = sle64((int64_t) 0, lower_bound_149391);
            bool i_lte_j_149401 = sle64(lower_bound_149391, min_res_149393);
            bool y_149402 = i_p_m_t_s_leq_w_149399 && zzero_lte_i_149400;
            bool y_149403 = zzero_leq_i_p_m_t_s_149398 && y_149402;
            bool forwards_ok_149404 = i_lte_j_149401 && y_149403;
            bool ok_or_empty_149405 = empty_slice_149395 || forwards_ok_149404;
            bool index_certs_149406;
            
            if (!ok_or_empty_149405) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149391, ":", (long long) min_res_149393, "] out of bounds for array of shape [", (long long) n_81278, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:81:81-92\n   #5  ftRelational.fut:77:9-81:93\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164971 = (int64_t) 4 * j_m_i_149394;
            int64_t bytes_164973 = b_81279 * j_m_i_149394;
            
            if (mem_164972_cached_sizze_166342 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166342, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164961.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149391, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149394});
            if (mem_164974_cached_sizze_166343 < bytes_164973) {
                err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_166343, bytes_164973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_81279, (int64_t) 1}, (uint8_t *) mem_164963.mem, (int64_t) 0 + b_81279 * lower_bound_149391, (int64_t []) {b_81279, (int64_t) 1}, (int64_t []) {j_m_i_149394, b_81279});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_81278; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164959.mem)[write_iter_164733];
                int32_t write_iv_164737 = ((int32_t *) mem_param_164934.mem)[write_iter_164733];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0 + write_iter_164733 * b_81279, (int64_t []) {(int64_t) 1}, (int64_t []) {b_81279});
                
                bool cond_157292 = sle64(lower_bound_149391, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_149393);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_149391);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149394)) {
                    ((int32_t *) mem_164972)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149394)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_81279 - (int64_t) 1, b_81279))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_164974, lifted_lambda_res_157295 * b_81279, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_81279});
                }
            }
            
            int64_t tmp_149418 = add64((int64_t) 1, p_149390);
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_164961.mem, lower_bound_149391, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149394});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, b_81279 * lower_bound_149391, (int64_t []) {b_81279, (int64_t) 1}, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_81279, (int64_t) 1}, (int64_t []) {j_m_i_149394, b_81279});
            
            bool loop_cond_149426 = slt64(tmp_149418, m_149309);
            bool loop_while_tmp_165708 = loop_cond_149426;
            int64_t p_tmp_165711 = tmp_149418;
            
            loop_while_149387 = loop_while_tmp_165708;
            p_149390 = p_tmp_165711;
        }
        partitioned_scatter_res_149383 = loop_while_149387;
        partitioned_scatter_res_149386 = p_149390;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164938, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_165003, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165002, &mem_param_164938, "mem_param_164938") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165005, bytes_165004, "mem_165005")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_165005.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_165003.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_81278});
    if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165007.mem, (int64_t) 0, (int64_t []) {b_81279, (int64_t) 1}, (uint8_t *) ext_mem_165002.mem, (int64_t) 0, (int64_t []) {b_81279, (int64_t) 1}, (int64_t []) {n_81278, b_81279});
    if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165005, "mem_165005") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165007, "mem_165007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166339, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166340, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164939);
        free(mem_164972);
        free(mem_164974);
        free(mem_164982);
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165005, "mem_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164950, "mem_164950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164938, "mem_param_164938") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_166345, struct memblock *mem_out_p_166346, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_82166, int64_t b_82167, int16_t block_sizze_82168)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164939_cached_sizze_166347 = 0;
    unsigned char *mem_164939 = NULL;
    int64_t mem_164972_cached_sizze_166348 = 0;
    unsigned char *mem_164972 = NULL;
    int64_t mem_164974_cached_sizze_166349 = 0;
    unsigned char *mem_164974 = NULL;
    int64_t mem_164982_cached_sizze_166350 = 0;
    unsigned char *mem_164982 = NULL;
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock mem_165005;
    
    mem_165005.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_164961;
    
    mem_164961.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164950;
    
    mem_164950.references = NULL;
    
    struct memblock mem_param_164948;
    
    mem_param_164948.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock mem_param_164938;
    
    mem_param_164938.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_165002;
    
    ext_mem_165002.references = NULL;
    
    struct memblock ext_mem_165003;
    
    ext_mem_165003.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_149285 = sext_i16_i64(block_sizze_82168);
    int64_t bytes_164930 = (int64_t) 8 * n_82166;
    bool zzero_149304 = i16_res_149285 == (int64_t) 0;
    bool nonzzero_149305 = !zzero_149304;
    bool nonzzero_cert_149308;
    
    if (!nonzzero_149305) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:86:81-92\n   #5  ftRelational.fut:82:9-86:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165006 = n_82166 * b_82167;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_82166; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_149302 = add64(n_82166, i16_res_149285);
    int64_t zs_lhs_149303 = sub64(zm_lhs_149302, (int64_t) 1);
    int64_t m_149309 = sdiv_safe64(zs_lhs_149303, i16_res_149285);
    bool loop_cond_149310 = slt64((int64_t) 0, m_149309);
    
    if (mem_164939_cached_sizze_166347 < n_82166) {
        err = lexical_realloc(ctx, &mem_164939, &mem_164939_cached_sizze_166347, n_82166);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164982_cached_sizze_166350 < b_82167) {
        err = lexical_realloc(ctx, &mem_164982, &mem_164982_cached_sizze_166350, b_82167);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &k_mem_164928, "k_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164938, &pL_mem_164929, "pL_mem_164929") != 0)
        return 1;
    for (int64_t i_149313 = 0; i_149313 < (int64_t) 32; i_149313++) {
        int32_t binop_x_149316 = sext_i64_i32(i_149313);
        int32_t binop_x_149317 = mul32(2, binop_x_149316);
        int32_t zm_lhs_149318 = add32(2, binop_x_149317);
        int32_t min_arg1_149319 = sub32(zm_lhs_149318, 1);
        int32_t min_res_149320 = smin32(64, min_arg1_149319);
        int32_t zp_lhs_149321 = sub32(min_res_149320, binop_x_149317);
        int32_t ij_bits_149322 = add32(1, zp_lhs_149321);
        int32_t up_to_149323 = shl32(1, ij_bits_149322);
        int64_t tmp_149324 = sext_i32_i64(zp_lhs_149321);
        bool bounds_invalid_upwards_149325 = slt32(zp_lhs_149321, 0);
        bool valid_149327 = !bounds_invalid_upwards_149325;
        bool range_valid_c_149328;
        
        if (!valid_149327) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149324, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:87:96-99\n   #5  ftRelational.fut:86:81-92\n   #6  ftRelational.fut:82:9-86:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_149341 = sext_i32_i64(up_to_149323);
        bool bounds_invalid_upwards_149342 = slt32(up_to_149323, 0);
        bool valid_149343 = !bounds_invalid_upwards_149342;
        bool range_valid_c_149344;
        
        if (!valid_149343) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149341, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:86:81-92\n   #5  ftRelational.fut:82:9-86:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_149326 = add64((int64_t) 1, tmp_149324);
        
        for (int64_t i_164713 = 0; i_164713 < n_82166; i_164713++) {
            int64_t eta_p_149330 = ((int64_t *) mem_param_164934.mem)[i_164713];
            int8_t defunc_0_f_res_149331;
            int8_t y_149333 = (int8_t) 0;
            
            for (int64_t i_149332 = 0; i_149332 < distance_149326; i_149332++) {
                int32_t binop_x_149334 = sext_i64_i32(i_149332);
                int32_t get_bit_arg0_149335 = add32(binop_x_149317, binop_x_149334);
                int32_t defunc_0_get_bit_res_149336;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_149336, get_bit_arg0_149335, eta_p_149330) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_149337 = get_bit_arg0_149335 == 63;
                int32_t defunc_0_get_bit_res_149338;
                
                if (cond_149337) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ defunc_0_get_bit_res_149336;
                    
                    defunc_0_get_bit_res_149338 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_149338 = defunc_0_get_bit_res_149336;
                }
                
                int8_t loopres_149340;
                
                if (futrts_set_bit_2464(ctx, &loopres_149340, binop_x_149334, y_149333, defunc_0_get_bit_res_149338) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_149340;
                
                y_149333 = y_tmp_165701;
            }
            defunc_0_f_res_149331 = y_149333;
            ((int8_t *) mem_164939)[i_164713] = defunc_0_f_res_149331;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_149345;
        int64_t offs_149348;
        
        if (memblock_set(ctx, &mem_param_164948, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_149348 = (int64_t) 0;
        for (int64_t i_149347 = 0; i_149347 < up_to_149341; i_149347++) {
            int32_t binop_x_149350 = sext_i64_i32(i_149347);
            int8_t index_primexp_149351 = zext_i32_i8(binop_x_149350);
            
            if (memblock_alloc(ctx, &mem_164950, bytes_164930, "mem_164950")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_82166; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164939)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_149351;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164948.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_149348, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164950.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_149376 = add64(offs_149348, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164950, "mem_164950") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_149376;
            
            if (memblock_set(ctx, &mem_param_164948, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_149348 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164959, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_149345 = offs_149348;
        if (memblock_alloc(ctx, &mem_164961, bytes_164930, "mem_164961")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164961.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_82166});
        if (memblock_alloc(ctx, &mem_164963, bytes_165006, "mem_164963")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {b_82167, (int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0, (int64_t []) {b_82167, (int64_t) 1}, (int64_t []) {n_82166, b_82167});
        
        bool partitioned_scatter_res_149383;
        int64_t partitioned_scatter_res_149386;
        bool loop_while_149387;
        int64_t p_149390;
        
        loop_while_149387 = loop_cond_149310;
        p_149390 = (int64_t) 0;
        while (loop_while_149387) {
            int64_t lower_bound_149391 = mul64(i16_res_149285, p_149390);
            int64_t min_arg1_149392 = add64(i16_res_149285, lower_bound_149391);
            int64_t min_res_149393 = smin64(n_82166, min_arg1_149392);
            int64_t j_m_i_149394 = sub64(min_res_149393, lower_bound_149391);
            bool empty_slice_149395 = j_m_i_149394 == (int64_t) 0;
            int64_t m_149396 = sub64(j_m_i_149394, (int64_t) 1);
            int64_t i_p_m_t_s_149397 = add64(lower_bound_149391, m_149396);
            bool zzero_leq_i_p_m_t_s_149398 = sle64((int64_t) 0, i_p_m_t_s_149397);
            bool i_p_m_t_s_leq_w_149399 = slt64(i_p_m_t_s_149397, n_82166);
            bool zzero_lte_i_149400 = sle64((int64_t) 0, lower_bound_149391);
            bool i_lte_j_149401 = sle64(lower_bound_149391, min_res_149393);
            bool y_149402 = i_p_m_t_s_leq_w_149399 && zzero_lte_i_149400;
            bool y_149403 = zzero_leq_i_p_m_t_s_149398 && y_149402;
            bool forwards_ok_149404 = i_lte_j_149401 && y_149403;
            bool ok_or_empty_149405 = empty_slice_149395 || forwards_ok_149404;
            bool index_certs_149406;
            
            if (!ok_or_empty_149405) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149391, ":", (long long) min_res_149393, "] out of bounds for array of shape [", (long long) n_82166, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:86:81-92\n   #5  ftRelational.fut:82:9-86:93\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164971 = (int64_t) 8 * j_m_i_149394;
            int64_t bytes_164973 = b_82167 * j_m_i_149394;
            
            if (mem_164972_cached_sizze_166348 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166348, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164961.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149391, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149394});
            if (mem_164974_cached_sizze_166349 < bytes_164973) {
                err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_166349, bytes_164973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_82167, (int64_t) 1}, (uint8_t *) mem_164963.mem, (int64_t) 0 + b_82167 * lower_bound_149391, (int64_t []) {b_82167, (int64_t) 1}, (int64_t []) {j_m_i_149394, b_82167});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_82166; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164959.mem)[write_iter_164733];
                int64_t write_iv_164737 = ((int64_t *) mem_param_164934.mem)[write_iter_164733];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0 + write_iter_164733 * b_82167, (int64_t []) {(int64_t) 1}, (int64_t []) {b_82167});
                
                bool cond_157292 = sle64(lower_bound_149391, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_149393);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_149391);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149394)) {
                    ((int64_t *) mem_164972)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149394)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_82167 - (int64_t) 1, b_82167))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_164974, lifted_lambda_res_157295 * b_82167, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_82167});
                }
            }
            
            int64_t tmp_149418 = add64((int64_t) 1, p_149390);
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_164961.mem, lower_bound_149391, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149394});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, b_82167 * lower_bound_149391, (int64_t []) {b_82167, (int64_t) 1}, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_82167, (int64_t) 1}, (int64_t []) {j_m_i_149394, b_82167});
            
            bool loop_cond_149426 = slt64(tmp_149418, m_149309);
            bool loop_while_tmp_165708 = loop_cond_149426;
            int64_t p_tmp_165711 = tmp_149418;
            
            loop_while_149387 = loop_while_tmp_165708;
            p_149390 = p_tmp_165711;
        }
        partitioned_scatter_res_149383 = loop_while_149387;
        partitioned_scatter_res_149386 = p_149390;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164938, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_165003, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165002, &mem_param_164938, "mem_param_164938") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165005, bytes_164930, "mem_165005")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_165005.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_165003.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_82166});
    if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165007.mem, (int64_t) 0, (int64_t []) {b_82167, (int64_t) 1}, (uint8_t *) ext_mem_165002.mem, (int64_t) 0, (int64_t []) {b_82167, (int64_t) 1}, (int64_t []) {n_82166, b_82167});
    if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165005, "mem_165005") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165007, "mem_165007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166345, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166346, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164939);
        free(mem_164972);
        free(mem_164974);
        free(mem_164982);
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165005, "mem_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164950, "mem_164950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164938, "mem_param_164938") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_166351, struct memblock *mem_out_p_166352, struct memblock k_mem_164928, struct memblock pL_mem_164929, int64_t n_80384, int64_t b_80385, int16_t block_sizze_80386)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164939_cached_sizze_166353 = 0;
    unsigned char *mem_164939 = NULL;
    int64_t mem_164972_cached_sizze_166354 = 0;
    unsigned char *mem_164972 = NULL;
    int64_t mem_164974_cached_sizze_166355 = 0;
    unsigned char *mem_164974 = NULL;
    int64_t mem_164982_cached_sizze_166356 = 0;
    unsigned char *mem_164982 = NULL;
    struct memblock mem_165007;
    
    mem_165007.references = NULL;
    
    struct memblock mem_165005;
    
    mem_165005.references = NULL;
    
    struct memblock mem_param_tmp_165697;
    
    mem_param_tmp_165697.references = NULL;
    
    struct memblock mem_param_tmp_165696;
    
    mem_param_tmp_165696.references = NULL;
    
    struct memblock mem_164963;
    
    mem_164963.references = NULL;
    
    struct memblock mem_164961;
    
    mem_164961.references = NULL;
    
    struct memblock mem_param_tmp_165702;
    
    mem_param_tmp_165702.references = NULL;
    
    struct memblock mem_164950;
    
    mem_164950.references = NULL;
    
    struct memblock mem_param_164948;
    
    mem_param_164948.references = NULL;
    
    struct memblock ext_mem_164959;
    
    ext_mem_164959.references = NULL;
    
    struct memblock mem_param_164938;
    
    mem_param_164938.references = NULL;
    
    struct memblock mem_param_164934;
    
    mem_param_164934.references = NULL;
    
    struct memblock ext_mem_165002;
    
    ext_mem_165002.references = NULL;
    
    struct memblock ext_mem_165003;
    
    ext_mem_165003.references = NULL;
    
    struct memblock mem_164931;
    
    mem_164931.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t i16_res_149285 = sext_i16_i64(block_sizze_80386);
    int64_t bytes_164930 = (int64_t) 8 * n_80384;
    bool zzero_149304 = i16_res_149285 == (int64_t) 0;
    bool nonzzero_149305 = !zzero_149304;
    bool nonzzero_cert_149308;
    
    if (!nonzzero_149305) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:76:81-92\n   #5  ftRelational.fut:72:9-76:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_165004 = (int64_t) 2 * n_80384;
    int64_t bytes_165006 = n_80384 * b_80385;
    
    if (memblock_alloc(ctx, &mem_164931, bytes_164930, "mem_164931")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165695 = 0; nest_i_165695 < n_80384; nest_i_165695++) {
        ((int64_t *) mem_164931.mem)[nest_i_165695] = (int64_t) 0;
    }
    
    int64_t zm_lhs_149302 = add64(n_80384, i16_res_149285);
    int64_t zs_lhs_149303 = sub64(zm_lhs_149302, (int64_t) 1);
    int64_t m_149309 = sdiv_safe64(zs_lhs_149303, i16_res_149285);
    bool loop_cond_149310 = slt64((int64_t) 0, m_149309);
    
    if (mem_164939_cached_sizze_166353 < n_80384) {
        err = lexical_realloc(ctx, &mem_164939, &mem_164939_cached_sizze_166353, n_80384);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164982_cached_sizze_166356 < b_80385) {
        err = lexical_realloc(ctx, &mem_164982, &mem_164982_cached_sizze_166356, b_80385);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_164934, &k_mem_164928, "k_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_164938, &pL_mem_164929, "pL_mem_164929") != 0)
        return 1;
    for (int64_t i_149313 = 0; i_149313 < (int64_t) 8; i_149313++) {
        int32_t binop_x_149316 = sext_i64_i32(i_149313);
        int32_t binop_x_149317 = mul32(2, binop_x_149316);
        int32_t zm_lhs_149318 = add32(2, binop_x_149317);
        int32_t min_arg1_149319 = sub32(zm_lhs_149318, 1);
        int32_t min_res_149320 = smin32(16, min_arg1_149319);
        int32_t zp_lhs_149321 = sub32(min_res_149320, binop_x_149317);
        int32_t ij_bits_149322 = add32(1, zp_lhs_149321);
        int32_t up_to_149323 = shl32(1, ij_bits_149322);
        int64_t tmp_149324 = sext_i32_i64(zp_lhs_149321);
        bool bounds_invalid_upwards_149325 = slt32(zp_lhs_149321, 0);
        bool valid_149327 = !bounds_invalid_upwards_149325;
        bool range_valid_c_149328;
        
        if (!valid_149327) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_149324, " is invalid.", "-> #0  ftbasics.fut:150:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:86-88\n   #3  ftSMJ.fut:32:58-60\n   #4  ftSMJ.fut:87:96-99\n   #5  ftRelational.fut:76:81-92\n   #6  ftRelational.fut:72:9-76:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_149341 = sext_i32_i64(up_to_149323);
        bool bounds_invalid_upwards_149342 = slt32(up_to_149323, 0);
        bool valid_149343 = !bounds_invalid_upwards_149342;
        bool range_valid_c_149344;
        
        if (!valid_149343) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_149341, " is invalid.", "-> #0  ftbasics.fut:174:21-30\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:76:81-92\n   #5  ftRelational.fut:72:9-76:93\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_149326 = add64((int64_t) 1, tmp_149324);
        
        for (int64_t i_164713 = 0; i_164713 < n_80384; i_164713++) {
            int16_t eta_p_149330 = ((int16_t *) mem_param_164934.mem)[i_164713];
            int8_t defunc_0_f_res_149331;
            int8_t y_149333 = (int8_t) 0;
            
            for (int64_t i_149332 = 0; i_149332 < distance_149326; i_149332++) {
                int32_t binop_x_149334 = sext_i64_i32(i_149332);
                int32_t get_bit_arg0_149335 = add32(binop_x_149317, binop_x_149334);
                int32_t defunc_0_get_bit_res_149336;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_149336, get_bit_arg0_149335, eta_p_149330) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_149337 = get_bit_arg0_149335 == 15;
                int32_t defunc_0_get_bit_res_149338;
                
                if (cond_149337) {
                    int32_t defunc_0_get_bit_res_t_res_157314 = 1 ^ defunc_0_get_bit_res_149336;
                    
                    defunc_0_get_bit_res_149338 = defunc_0_get_bit_res_t_res_157314;
                } else {
                    defunc_0_get_bit_res_149338 = defunc_0_get_bit_res_149336;
                }
                
                int8_t loopres_149340;
                
                if (futrts_set_bit_2464(ctx, &loopres_149340, binop_x_149334, y_149333, defunc_0_get_bit_res_149338) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_165701 = loopres_149340;
                
                y_149333 = y_tmp_165701;
            }
            defunc_0_f_res_149331 = y_149333;
            ((int8_t *) mem_164939)[i_164713] = defunc_0_f_res_149331;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_149345;
        int64_t offs_149348;
        
        if (memblock_set(ctx, &mem_param_164948, &mem_164931, "mem_164931") != 0)
            return 1;
        offs_149348 = (int64_t) 0;
        for (int64_t i_149347 = 0; i_149347 < up_to_149341; i_149347++) {
            int32_t binop_x_149350 = sext_i64_i32(i_149347);
            int8_t index_primexp_149351 = zext_i32_i8(binop_x_149350);
            
            if (memblock_alloc(ctx, &mem_164950, bytes_164930, "mem_164950")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_157319;
            int64_t defunc_0_reduce_res_157320;
            int64_t inpacc_157200;
            int64_t inpacc_157201;
            
            inpacc_157200 = (int64_t) 0;
            inpacc_157201 = (int64_t) 0;
            for (int64_t i_164731 = 0; i_164731 < n_80384; i_164731++) {
                int8_t eta_p_164899 = ((int8_t *) mem_164939)[i_164731];
                bool lifted_lambda_res_164900 = eta_p_164899 == index_primexp_149351;
                int64_t bool_res_164901 = btoi_bool_i64(lifted_lambda_res_164900);
                int64_t eta_p_164914 = ((int64_t *) mem_param_164948.mem)[i_164731];
                int64_t defunc_0_op_res_164915 = add64(inpacc_157200, bool_res_164901);
                int64_t zm_lhs_164916 = add64(offs_149348, defunc_0_op_res_164915);
                int64_t lifted_lambda_res_164917 = sub64(zm_lhs_164916, (int64_t) 1);
                int64_t defunc_0_f_res_164918 = mul64(bool_res_164901, lifted_lambda_res_164917);
                int64_t defunc_0_f_res_164919 = add64(eta_p_164914, defunc_0_f_res_164918);
                int64_t defunc_0_op_res_157249 = add64(inpacc_157201, bool_res_164901);
                
                ((int64_t *) mem_164950.mem)[i_164731] = defunc_0_f_res_164919;
                
                int64_t inpacc_tmp_165705 = defunc_0_op_res_164915;
                int64_t inpacc_tmp_165706 = defunc_0_op_res_157249;
                
                inpacc_157200 = inpacc_tmp_165705;
                inpacc_157201 = inpacc_tmp_165706;
            }
            inpacc_157319 = inpacc_157200;
            defunc_0_reduce_res_157320 = inpacc_157201;
            
            int64_t tmp_149376 = add64(offs_149348, defunc_0_reduce_res_157320);
            
            if (memblock_set(ctx, &mem_param_tmp_165702, &mem_164950, "mem_164950") != 0)
                return 1;
            
            int64_t offs_tmp_165703 = tmp_149376;
            
            if (memblock_set(ctx, &mem_param_164948, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
                return 1;
            offs_149348 = offs_tmp_165703;
        }
        if (memblock_set(ctx, &ext_mem_164959, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_149345 = offs_149348;
        if (memblock_alloc(ctx, &mem_164961, bytes_165004, "mem_164961")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_164961.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_164934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80384});
        if (memblock_alloc(ctx, &mem_164963, bytes_165006, "mem_164963")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, (int64_t) 0, (int64_t []) {b_80385, (int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0, (int64_t []) {b_80385, (int64_t) 1}, (int64_t []) {n_80384, b_80385});
        
        bool partitioned_scatter_res_149383;
        int64_t partitioned_scatter_res_149386;
        bool loop_while_149387;
        int64_t p_149390;
        
        loop_while_149387 = loop_cond_149310;
        p_149390 = (int64_t) 0;
        while (loop_while_149387) {
            int64_t lower_bound_149391 = mul64(i16_res_149285, p_149390);
            int64_t min_arg1_149392 = add64(i16_res_149285, lower_bound_149391);
            int64_t min_res_149393 = smin64(n_80384, min_arg1_149392);
            int64_t j_m_i_149394 = sub64(min_res_149393, lower_bound_149391);
            bool empty_slice_149395 = j_m_i_149394 == (int64_t) 0;
            int64_t m_149396 = sub64(j_m_i_149394, (int64_t) 1);
            int64_t i_p_m_t_s_149397 = add64(lower_bound_149391, m_149396);
            bool zzero_leq_i_p_m_t_s_149398 = sle64((int64_t) 0, i_p_m_t_s_149397);
            bool i_p_m_t_s_leq_w_149399 = slt64(i_p_m_t_s_149397, n_80384);
            bool zzero_lte_i_149400 = sle64((int64_t) 0, lower_bound_149391);
            bool i_lte_j_149401 = sle64(lower_bound_149391, min_res_149393);
            bool y_149402 = i_p_m_t_s_leq_w_149399 && zzero_lte_i_149400;
            bool y_149403 = zzero_leq_i_p_m_t_s_149398 && y_149402;
            bool forwards_ok_149404 = i_lte_j_149401 && y_149403;
            bool ok_or_empty_149405 = empty_slice_149395 || forwards_ok_149404;
            bool index_certs_149406;
            
            if (!ok_or_empty_149405) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_149391, ":", (long long) min_res_149393, "] out of bounds for array of shape [", (long long) n_80384, "].", "-> #0  ftbasics.fut:72:25-56\n   #1  ftSMJ.fut:18:86-88\n   #2  ftSMJ.fut:32:58-60\n   #3  ftSMJ.fut:87:96-99\n   #4  ftRelational.fut:76:81-92\n   #5  ftRelational.fut:72:9-76:93\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_164971 = (int64_t) 2 * j_m_i_149394;
            int64_t bytes_164973 = b_80385 * j_m_i_149394;
            
            if (mem_164972_cached_sizze_166354 < bytes_164971) {
                err = lexical_realloc(ctx, &mem_164972, &mem_164972_cached_sizze_166354, bytes_164971);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_164961.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_149391, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149394});
            if (mem_164974_cached_sizze_166355 < bytes_164973) {
                err = lexical_realloc(ctx, &mem_164974, &mem_164974_cached_sizze_166355, bytes_164973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_80385, (int64_t) 1}, (uint8_t *) mem_164963.mem, (int64_t) 0 + b_80385 * lower_bound_149391, (int64_t []) {b_80385, (int64_t) 1}, (int64_t []) {j_m_i_149394, b_80385});
            for (int64_t write_iter_164733 = 0; write_iter_164733 < n_80384; write_iter_164733++) {
                int64_t write_iv_164736 = ((int64_t *) ext_mem_164959.mem)[write_iter_164733];
                int16_t write_iv_164737 = ((int16_t *) mem_param_164934.mem)[write_iter_164733];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_164938.mem, (int64_t) 0 + write_iter_164733 * b_80385, (int64_t []) {(int64_t) 1}, (int64_t []) {b_80385});
                
                bool cond_157292 = sle64(lower_bound_149391, write_iv_164736);
                bool cond_t_res_157293 = slt64(write_iv_164736, min_res_149393);
                bool x_157294 = cond_157292 && cond_t_res_157293;
                int64_t lifted_lambda_res_157295;
                
                if (x_157294) {
                    int64_t lifted_lambda_res_t_res_157322 = sub64(write_iv_164736, lower_bound_149391);
                    
                    lifted_lambda_res_157295 = lifted_lambda_res_t_res_157322;
                } else {
                    lifted_lambda_res_157295 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149394)) {
                    ((int16_t *) mem_164972)[lifted_lambda_res_157295] = write_iv_164737;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_157295) && slt64(lifted_lambda_res_157295, j_m_i_149394)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_80385 - (int64_t) 1, b_80385))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_164974, lifted_lambda_res_157295 * b_80385, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_164982, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_80385});
                }
            }
            
            int64_t tmp_149418 = add64((int64_t) 1, p_149390);
            
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_164961.mem, lower_bound_149391, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_164972, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_149394});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_164963.mem, b_80385 * lower_bound_149391, (int64_t []) {b_80385, (int64_t) 1}, (uint8_t *) mem_164974, (int64_t) 0, (int64_t []) {b_80385, (int64_t) 1}, (int64_t []) {j_m_i_149394, b_80385});
            
            bool loop_cond_149426 = slt64(tmp_149418, m_149309);
            bool loop_while_tmp_165708 = loop_cond_149426;
            int64_t p_tmp_165711 = tmp_149418;
            
            loop_while_149387 = loop_while_tmp_165708;
            p_149390 = p_tmp_165711;
        }
        partitioned_scatter_res_149383 = loop_while_149387;
        partitioned_scatter_res_149386 = p_149390;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165696, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_165697, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164934, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_164938, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_165003, &mem_param_164934, "mem_param_164934") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_165002, &mem_param_164938, "mem_param_164938") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165005, bytes_165004, "mem_165005")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_165005.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_165003.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80384});
    if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_165007, bytes_165006, "mem_165007")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_165007.mem, (int64_t) 0, (int64_t []) {b_80385, (int64_t) 1}, (uint8_t *) ext_mem_165002.mem, (int64_t) 0, (int64_t []) {b_80385, (int64_t) 1}, (int64_t []) {n_80384, b_80385});
    if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165693, &mem_165005, "mem_165005") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_165007, "mem_165007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166351, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166352, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164939);
        free(mem_164972);
        free(mem_164974);
        free(mem_164982);
        if (memblock_unref(ctx, &mem_165007, "mem_165007") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_165005, "mem_165005") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165697, "mem_param_tmp_165697") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165696, "mem_param_tmp_165696") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164963, "mem_164963") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164961, "mem_164961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_165702, "mem_param_tmp_165702") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164950, "mem_164950") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164948, "mem_param_164948") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_164959, "ext_mem_164959") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164938, "mem_param_164938") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_164934, "mem_param_164934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165002, "ext_mem_165002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_165003, "ext_mem_165003") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164931, "mem_164931") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_12923(struct futhark_context *ctx, struct memblock *mem_out_p_166357, struct memblock *mem_out_p_166358, int64_t *out_prim_out_166359, int64_t *out_prim_out_166360, int32_t *out_prim_out_166361, struct memblock pXs_mem_164928, int64_t n_137755, int64_t b_137756, int32_t curDepth_137757, int32_t i_137759, int32_t j_137760)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164930_cached_sizze_166362 = 0;
    unsigned char *mem_164930 = NULL;
    int64_t mem_164932_cached_sizze_166363 = 0;
    unsigned char *mem_164932 = NULL;
    int64_t mem_164939_cached_sizze_166364 = 0;
    unsigned char *mem_164939 = NULL;
    int64_t mem_164940_cached_sizze_166365 = 0;
    unsigned char *mem_164940 = NULL;
    int64_t mem_164960_cached_sizze_166366 = 0;
    unsigned char *mem_164960 = NULL;
    struct memblock mem_164971;
    
    mem_164971.references = NULL;
    
    struct memblock mem_164969;
    
    mem_164969.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t prim_out_165695;
    int64_t prim_out_165696;
    int32_t prim_out_165697;
    int64_t dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761 = sub64(n_137755, (int64_t) 1);
    bool bounds_invalid_upwards_137765 = slt64(n_137755, (int64_t) 1);
    bool valid_137770 = !bounds_invalid_upwards_137765;
    bool range_valid_c_137771;
    
    if (!valid_137770) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) n_137755, " is invalid.", "-> #0  ftHashJoin.fut:216:23-28\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_155461 = mul64((int64_t) 8, b_137756);
    int64_t min_arg1_155462 = sub64(zm_lhs_155461, (int64_t) 1);
    int32_t i64_res_155447 = sext_i64_i32(b_137756);
    int32_t zm_lhs_155448 = mul32(8, i64_res_155447);
    int32_t min_arg1_155449 = sub32(zm_lhs_155448, 1);
    int32_t min_res_155450 = smin32(j_137760, min_arg1_155449);
    int32_t zm_rhs_155457 = sdiv32(min_res_155450, 8);
    int32_t zm_lhs_155458 = sub32(i64_res_155447, zm_rhs_155457);
    int32_t i32_arg0_155459 = sub32(zm_lhs_155458, 1);
    int64_t i32_res_155460 = sext_i32_i64(i32_arg0_155459);
    int64_t min_res_155463 = smin64(i32_res_155460, min_arg1_155462);
    bool y_155492 = slt64(min_res_155463, b_137756);
    bool x_155491 = sle64((int64_t) 0, min_res_155463);
    bool bounds_check_155493 = x_155491 && y_155492;
    bool index_certs_155494;
    
    if (!bounds_check_155493) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_155463, "] out of bounds for array of shape [", (long long) b_137756, "].", "-> #0  ftHashJoin.fut:32:38-54\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_rhs_155452 = sdiv32(i_137759, 8);
    int32_t zm_lhs_155453 = sub32(i64_res_155447, zm_rhs_155452);
    int32_t i32_arg0_155454 = sub32(zm_lhs_155453, 1);
    int64_t i32_res_155455 = sext_i32_i64(i32_arg0_155454);
    bool y_155481 = slt64(i32_res_155455, b_137756);
    bool x_155480 = sle64((int64_t) 0, i32_res_155455);
    bool bounds_check_155482 = x_155480 && y_155481;
    bool index_certs_155483;
    
    if (!bounds_check_155482) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_155455, "] out of bounds for array of shape [", (long long) b_137756, "].", "-> #0  ftHashJoin.fut:31:48-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t lastBit_155465 = smod32(min_res_155450, 8);
    int32_t zm_lhs_155468 = sub32(8, lastBit_155465);
    int32_t i32_arg0_155469 = sub32(zm_lhs_155468, 1);
    int8_t unsign_arg0_155470 = zext_i32_i8(i32_arg0_155469);
    int8_t unsign_arg0_155471 = lshr8((int8_t) -1, unsign_arg0_155470);
    int32_t firstBit_155464 = smod32(i_137759, 8);
    int8_t unsign_arg0_155466 = zext_i32_i8(firstBit_155464);
    int8_t first_bitMask_155467 = shl8((int8_t) -1, unsign_arg0_155466);
    int64_t bytes_164929 = (int64_t) 8 * dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761;
    
    if (mem_164930_cached_sizze_166362 < bytes_164929) {
        err = lexical_realloc(ctx, &mem_164930, &mem_164930_cached_sizze_166362, bytes_164929);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164932_cached_sizze_166363 < bytes_164929) {
        err = lexical_realloc(ctx, &mem_164932, &mem_164932_cached_sizze_166363, bytes_164929);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164939_cached_sizze_166364 < b_137756) {
        err = lexical_realloc(ctx, &mem_164939, &mem_164939_cached_sizze_166364, b_137756);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_164940_cached_sizze_166365 < b_137756) {
        err = lexical_realloc(ctx, &mem_164940, &mem_164940_cached_sizze_166365, b_137756);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_164728;
    int64_t scanacc_164722 = (int64_t) 0;
    
    for (int64_t i_164725 = 0; i_164725 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761; i_164725++) {
        int64_t index_primexp_164899 = add64((int64_t) 1, i_164725);
        bool x_157073 = sle64((int64_t) 0, index_primexp_164899);
        bool y_157074 = slt64(index_primexp_164899, n_137755);
        bool bounds_check_157075 = x_157073 && y_157074;
        bool index_certs_157076;
        
        if (!bounds_check_157075) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) index_primexp_164899, "] out of bounds for array of shape [", (long long) n_137755, "].", "-> #0  ftHashJoin.fut:217:22-30\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:217:8-44\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_157080 = slt64(i_164725, n_137755);
        bool index_certs_157082;
        
        if (!y_157080) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_164725, "] out of bounds for array of shape [", (long long) n_137755, "].", "-> #0  ftHashJoin.fut:217:32-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:217:8-44\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_164715 = 0; i_164715 < b_137756; i_164715++) {
            int8_t eta_p_157134 = ((int8_t *) pXs_mem_164928.mem)[index_primexp_164899 * b_137756 + i_164715];
            int8_t eta_p_157135 = ((int8_t *) pXs_mem_164928.mem)[i_164725 * b_137756 + i_164715];
            bool cond_157137 = sle64(i_164715, i32_res_155455);
            bool cond_t_res_157138 = sle64(min_res_155463, i_164715);
            bool x_157139 = cond_157137 && cond_t_res_157138;
            int8_t lifted_lambda_res_157140;
            
            if (x_157139) {
                lifted_lambda_res_157140 = eta_p_157134;
            } else {
                lifted_lambda_res_157140 = (int8_t) 0;
            }
            
            int8_t lifted_lambda_res_157145;
            
            if (x_157139) {
                lifted_lambda_res_157145 = eta_p_157135;
            } else {
                lifted_lambda_res_157145 = (int8_t) 0;
            }
            ((int8_t *) mem_164939)[i_164715] = lifted_lambda_res_157145;
            ((int8_t *) mem_164940)[i_164715] = lifted_lambda_res_157140;
        }
        
        int8_t za_lhs_157093 = ((int8_t *) mem_164940)[i32_res_155455];
        int8_t mod1_x_157094 = first_bitMask_155467 & za_lhs_157093;
        
        ((int8_t *) mem_164940)[i32_res_155455] = mod1_x_157094;
        
        int8_t za_lhs_157096 = ((int8_t *) mem_164940)[min_res_155463];
        int8_t tmp_157097 = unsign_arg0_155471 & za_lhs_157096;
        
        ((int8_t *) mem_164940)[min_res_155463] = tmp_157097;
        
        int8_t za_lhs_157106 = ((int8_t *) mem_164939)[i32_res_155455];
        int8_t mod1_x_157107 = first_bitMask_155467 & za_lhs_157106;
        
        ((int8_t *) mem_164939)[i32_res_155455] = mod1_x_157107;
        
        int8_t za_lhs_157109 = ((int8_t *) mem_164939)[min_res_155463];
        int8_t tmp_157110 = unsign_arg0_155471 & za_lhs_157109;
        
        ((int8_t *) mem_164939)[min_res_155463] = tmp_157110;
        
        bool defunc_0_reduce_res_157157;
        bool redout_164718 = 0;
        
        for (int64_t i_164719 = 0; i_164719 < b_137756; i_164719++) {
            int8_t eta_p_157127 = ((int8_t *) mem_164940)[i_164719];
            int8_t eta_p_157128 = ((int8_t *) mem_164939)[i_164719];
            bool lifted_lambda_res_157129 = eta_p_157127 == eta_p_157128;
            bool lifted_lambda_res_157130 = !lifted_lambda_res_157129;
            bool defunc_0_op_res_157123 = lifted_lambda_res_157130 || redout_164718;
            bool redout_tmp_165703 = defunc_0_op_res_157123;
            
            redout_164718 = redout_tmp_165703;
        }
        defunc_0_reduce_res_157157 = redout_164718;
        
        int64_t defunc_0_f_res_157124 = btoi_bool_i64(defunc_0_reduce_res_157157);
        int64_t defunc_0_op_res_148436 = add64(defunc_0_f_res_157124, scanacc_164722);
        
        ((int64_t *) mem_164930)[i_164725] = defunc_0_op_res_148436;
        ((int64_t *) mem_164932)[i_164725] = defunc_0_f_res_157124;
        
        int64_t scanacc_tmp_165698 = defunc_0_op_res_148436;
        
        scanacc_164722 = scanacc_tmp_165698;
    }
    discard_164728 = scanacc_164722;
    
    bool cond_148437 = dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761 == (int64_t) 0;
    bool x_148438 = !cond_148437;
    int64_t tmp_148439 = sub64(dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761, (int64_t) 1);
    bool x_148440 = sle64((int64_t) 0, tmp_148439);
    bool y_148441 = slt64(tmp_148439, dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761);
    bool bounds_check_148442 = x_148440 && y_148441;
    bool protect_assert_disj_148443 = cond_148437 || bounds_check_148442;
    bool index_certs_148444;
    
    if (!protect_assert_disj_148443) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_148439, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_148445;
    
    if (x_148438) {
        int64_t x_157158 = ((int64_t *) mem_164930)[tmp_148439];
        
        m_f_res_148445 = x_157158;
    } else {
        m_f_res_148445 = (int64_t) 0;
    }
    
    int64_t m_148447;
    
    if (cond_148437) {
        m_148447 = (int64_t) 0;
    } else {
        m_148447 = m_f_res_148445;
    }
    
    int64_t m_148457 = sub64(m_148447, (int64_t) 1);
    bool i_p_m_t_s_leq_w_148459 = slt64(m_148457, dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761);
    bool zzero_leq_i_p_m_t_s_148458 = sle64((int64_t) 0, m_148457);
    bool y_148461 = zzero_leq_i_p_m_t_s_148458 && i_p_m_t_s_leq_w_148459;
    bool i_lte_j_148460 = sle64((int64_t) 0, m_148447);
    bool forwards_ok_148462 = i_lte_j_148460 && y_148461;
    bool eq_x_zz_148454 = (int64_t) 0 == m_f_res_148445;
    bool p_and_eq_x_y_148455 = x_148438 && eq_x_zz_148454;
    bool empty_slice_148456 = cond_148437 || p_and_eq_x_y_148455;
    bool ok_or_empty_148463 = empty_slice_148456 || forwards_ok_148462;
    bool index_certs_148464;
    
    if (!ok_or_empty_148463) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_148447, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164959 = (int64_t) 8 * m_148447;
    int64_t conc_tmp_144268 = (int64_t) 1 + m_148447;
    int64_t bytes_164968 = (int64_t) 8 * conc_tmp_144268;
    int64_t bytes_164970 = (int64_t) 4 * conc_tmp_144268;
    
    if (mem_164960_cached_sizze_166366 < bytes_164959) {
        err = lexical_realloc(ctx, &mem_164960, &mem_164960_cached_sizze_166366, bytes_164959);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_165704 = 0; i_165704 < m_148447; i_165704++) {
        int64_t x_165705 = (int64_t) 1 + i_165704 * (int64_t) 1;
        
        ((int64_t *) mem_164960)[i_165704] = x_165705;
    }
    for (int64_t write_iter_164729 = 0; write_iter_164729 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_137761; write_iter_164729++) {
        int64_t write_iv_164731 = ((int64_t *) mem_164932)[write_iter_164729];
        int64_t write_iv_164732 = ((int64_t *) mem_164930)[write_iter_164729];
        int64_t index_primexp_164895 = add64((int64_t) 1, write_iter_164729);
        bool cond_157007 = write_iv_164731 == (int64_t) 1;
        int64_t lifted_lambda_res_157008;
        
        if (cond_157007) {
            int64_t lifted_lambda_res_t_res_157159 = sub64(write_iv_164732, (int64_t) 1);
            
            lifted_lambda_res_157008 = lifted_lambda_res_t_res_157159;
        } else {
            lifted_lambda_res_157008 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_157008) && slt64(lifted_lambda_res_157008, m_148447)) {
            ((int64_t *) mem_164960)[lifted_lambda_res_157008] = index_primexp_164895;
        }
    }
    if (memblock_alloc(ctx, &mem_164969, bytes_164968, "mem_164969")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165707 = 0; nest_i_165707 < (int64_t) 1; nest_i_165707++) {
        ((int64_t *) mem_164969.mem)[nest_i_165707] = (int64_t) 0;
    }
    
    int64_t tmp_offs_165708 = (int64_t) 0;
    
    if (!(tmp_offs_165708 == (int64_t) 0)) {
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165708, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164969.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
    }
    tmp_offs_165708 += (int64_t) 1;
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_164969.mem, tmp_offs_165708, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164960, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_148447});
    tmp_offs_165708 += m_148447;
    if (memblock_alloc(ctx, &mem_164971, bytes_164970, "mem_164971")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_165709 = 0; nest_i_165709 < conc_tmp_144268; nest_i_165709++) {
        ((int32_t *) mem_164971.mem)[nest_i_165709] = curDepth_137757;
    }
    if (memblock_set(ctx, &mem_out_165693, &mem_164969, "mem_164969") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_165694, &mem_164971, "mem_164971") != 0)
        return 1;
    prim_out_165695 = conc_tmp_144268;
    prim_out_165696 = conc_tmp_144268;
    prim_out_165697 = curDepth_137757;
    if (memblock_set(ctx, &*mem_out_p_166357, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166358, &mem_out_165694, "mem_out_165694") != 0)
        return 1;
    *out_prim_out_166359 = prim_out_165695;
    *out_prim_out_166360 = prim_out_165696;
    *out_prim_out_166361 = prim_out_165697;
    
  cleanup:
    {
        free(mem_164930);
        free(mem_164932);
        free(mem_164939);
        free(mem_164940);
        free(mem_164960);
        if (memblock_unref(ctx, &mem_164971, "mem_164971") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_164969, "mem_164969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165694, "mem_out_165694") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_166367, int32_t bit_79762, int16_t x_79763)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_165693;
    int16_t i32_res_144185 = sext_i32_i16(bit_79762);
    int16_t zgzg_res_144188 = ashr16(x_79763, i32_res_144185);
    int16_t za_res_144193 = (int16_t) 1 & zgzg_res_144188;
    int32_t to_i32_res_144195 = sext_i16_i32(za_res_144193);
    
    prim_out_165693 = to_i32_res_144195;
    *out_prim_out_166367 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_166368, int32_t bit_81544, int64_t x_81545)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_165693;
    int64_t i32_res_144185 = sext_i32_i64(bit_81544);
    int64_t zgzg_res_144188 = ashr64(x_81545, i32_res_144185);
    int64_t za_res_144193 = (int64_t) 1 & zgzg_res_144188;
    int32_t to_i32_res_144195 = sext_i64_i32(za_res_144193);
    
    prim_out_165693 = to_i32_res_144195;
    *out_prim_out_166368 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5624(struct futhark_context *ctx, int64_t *out_prim_out_166369, int64_t upper_bound_84091, int64_t n_84092)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    bool upper_bound_84093 = sle64((int64_t) 1, upper_bound_84091);
    bool assert_c_84095;
    
    if (!upper_bound_84093) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (upper_bound >= 1)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:189:21-58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_84104 = slt64(upper_bound_84091, n_84092);
    bool d_84113;
    int64_t d_84114;
    bool loop_while_84115;
    int64_t d_84116;
    
    loop_while_84115 = cond_84104;
    d_84116 = (int64_t) 1;
    while (loop_while_84115) {
        int64_t loopres_84117 = add64((int64_t) 1, d_84116);
        bool zzero_84119 = loopres_84117 == (int64_t) 0;
        bool nonzzero_84120 = !zzero_84119;
        bool nonzzero_cert_84121;
        
        if (!nonzzero_84120) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:190:36-38\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t zg_lhs_84122 = sdiv64(n_84092, loopres_84117);
        bool cond_84124 = slt64(upper_bound_84091, zg_lhs_84122);
        bool loop_cond_84125;
        
        if (cond_84124) {
            loop_cond_84125 = 1;
        } else {
            int64_t znze_lhs_84129 = smod64(n_84092, loopres_84117);
            bool loop_cond_f_res_84131 = znze_lhs_84129 == (int64_t) 0;
            bool loop_cond_f_res_84132 = !loop_cond_f_res_84131;
            
            loop_cond_84125 = loop_cond_f_res_84132;
        }
        
        bool loop_while_tmp_165694 = loop_cond_84125;
        int64_t d_tmp_165695 = loopres_84117;
        
        loop_while_84115 = loop_while_tmp_165694;
        d_84116 = d_tmp_165695;
    }
    d_84113 = loop_while_84115;
    d_84114 = d_84116;
    
    bool zzero_84134 = d_84114 == (int64_t) 0;
    bool nonzzero_84135 = !zzero_84134;
    bool nonzzero_cert_84136;
    
    if (!nonzzero_84135) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:191:7-9\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t greatest_divisor_leq_than_res_84137 = sdiv64(n_84092, d_84114);
    
    prim_out_165693 = greatest_divisor_leq_than_res_84137;
    *out_prim_out_166369 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12141(struct futhark_context *ctx, struct memblock *mem_out_p_166370, struct memblock nameless_mem_164928, int64_t n_96008, int64_t incr_96009)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t rng_96014 = add64(n_96008, incr_96009);
    bool bounds_invalid_upwards_96018 = slt64(rng_96014, incr_96009);
    bool valid_96023 = !bounds_invalid_upwards_96018;
    bool range_valid_c_96024;
    
    if (!valid_96023) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_96009, "..<", (long long) rng_96014, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164929 = (int64_t) 8 * n_96008;
    
    if (memblock_alloc(ctx, &mem_164930, bytes_164929, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165694 = 0; i_165694 < n_96008; i_165694++) {
        int64_t x_165695 = incr_96009 + i_165694 * (int64_t) 1;
        
        ((int64_t *) mem_164930.mem)[i_165694] = x_165695;
    }
    if (memblock_set(ctx, &mem_out_165693, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166370, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12162(struct futhark_context *ctx, struct memblock *mem_out_p_166371, struct memblock nameless_mem_164928, int64_t n_96876, int64_t incr_96877)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t rng_96882 = add64(n_96876, incr_96877);
    bool bounds_invalid_upwards_96886 = slt64(rng_96882, incr_96877);
    bool valid_96891 = !bounds_invalid_upwards_96886;
    bool range_valid_c_96892;
    
    if (!valid_96891) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_96877, "..<", (long long) rng_96882, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164929 = (int64_t) 8 * n_96876;
    
    if (memblock_alloc(ctx, &mem_164930, bytes_164929, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165694 = 0; i_165694 < n_96876; i_165694++) {
        int64_t x_165695 = incr_96877 + i_165694 * (int64_t) 1;
        
        ((int64_t *) mem_164930.mem)[i_165694] = x_165695;
    }
    if (memblock_set(ctx, &mem_out_165693, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166371, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12184(struct futhark_context *ctx, struct memblock *mem_out_p_166372, struct memblock nameless_mem_164928, int64_t n_97744, int64_t incr_97745)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t rng_97750 = add64(n_97744, incr_97745);
    bool bounds_invalid_upwards_97754 = slt64(rng_97750, incr_97745);
    bool valid_97759 = !bounds_invalid_upwards_97754;
    bool range_valid_c_97760;
    
    if (!valid_97759) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_97745, "..<", (long long) rng_97750, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164929 = (int64_t) 8 * n_97744;
    
    if (memblock_alloc(ctx, &mem_164930, bytes_164929, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165694 = 0; i_165694 < n_97744; i_165694++) {
        int64_t x_165695 = incr_97745 + i_165694 * (int64_t) 1;
        
        ((int64_t *) mem_164930.mem)[i_165694] = x_165695;
    }
    if (memblock_set(ctx, &mem_out_165693, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166372, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12206(struct futhark_context *ctx, struct memblock *mem_out_p_166373, struct memblock nameless_mem_164928, int64_t n_98612, int64_t incr_98613)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t rng_98618 = add64(n_98612, incr_98613);
    bool bounds_invalid_upwards_98622 = slt64(rng_98618, incr_98613);
    bool valid_98627 = !bounds_invalid_upwards_98622;
    bool range_valid_c_98628;
    
    if (!valid_98627) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_98613, "..<", (long long) rng_98618, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164929 = (int64_t) 8 * n_98612;
    
    if (memblock_alloc(ctx, &mem_164930, bytes_164929, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165694 = 0; i_165694 < n_98612; i_165694++) {
        int64_t x_165695 = incr_98613 + i_165694 * (int64_t) 1;
        
        ((int64_t *) mem_164930.mem)[i_165694] = x_165695;
    }
    if (memblock_set(ctx, &mem_out_165693, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166373, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_12227(struct futhark_context *ctx, struct memblock *mem_out_p_166374, struct memblock nameless_mem_164928, int64_t n_99501, int64_t incr_99502)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_164930;
    
    mem_164930.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    int64_t rng_99507 = add64(n_99501, incr_99502);
    bool bounds_invalid_upwards_99511 = slt64(rng_99507, incr_99502);
    bool valid_99516 = !bounds_invalid_upwards_99511;
    bool range_valid_c_99517;
    
    if (!valid_99516) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_99502, "..<", (long long) rng_99507, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_164929 = (int64_t) 8 * n_99501;
    
    if (memblock_alloc(ctx, &mem_164930, bytes_164929, "mem_164930")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_165694 = 0; i_165694 < n_99501; i_165694++) {
        int64_t x_165695 = incr_99502 + i_165694 * (int64_t) 1;
        
        ((int64_t *) mem_164930.mem)[i_165694] = x_165695;
    }
    if (memblock_set(ctx, &mem_out_165693, &mem_164930, "mem_164930") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166374, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_164930, "mem_164930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_11249(struct futhark_context *ctx, int64_t *out_prim_out_166375, int64_t *out_prim_out_166376, int64_t *out_prim_out_166377, int64_t *out_prim_out_166378, int64_t *out_prim_out_166379, int64_t slo_84321, int64_t shi_84322, int64_t tlo_84323, int64_t thi_84324, int64_t count_84325)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_165693;
    int64_t prim_out_165694;
    int64_t prim_out_165695;
    int64_t prim_out_165696;
    int64_t prim_out_165697;
    int64_t min_arg1_84328 = add64(slo_84321, count_84325);
    int64_t min_res_144186 = smin64(shi_84322, min_arg1_84328);
    int64_t min_arg1_84332 = add64(tlo_84323, count_84325);
    int64_t min_res_144189 = smin64(thi_84324, min_arg1_84332);
    int64_t zp_lhs_84336 = sub64(min_res_144186, slo_84321);
    int64_t zp_rhs_84338 = sub64(min_res_144189, tlo_84323);
    int64_t zm_lhs_84340 = add64(zp_lhs_84336, zp_rhs_84338);
    int64_t slack_84342 = sub64(zm_lhs_84340, count_84325);
    int64_t min_res_144192 = smin64(zp_lhs_84336, slack_84342);
    int64_t min_res_144195 = smin64(zp_rhs_84338, min_res_144192);
    int64_t max_arg1_84352 = sub64(min_res_144186, min_res_144195);
    int64_t max_res_144198 = smax64(slo_84321, max_arg1_84352);
    int64_t max_arg1_84356 = sub64(min_res_144189, min_res_144195);
    int64_t max_res_144201 = smax64(tlo_84323, max_arg1_84356);
    int64_t zm_rhs_84360 = sub64(max_res_144198, slo_84321);
    int64_t zm_lhs_84362 = sub64(count_84325, zm_rhs_84360);
    int64_t zm_rhs_84364 = sub64(max_res_144201, tlo_84323);
    int64_t count_84366 = sub64(zm_lhs_84362, zm_rhs_84364);
    
    prim_out_165693 = max_res_144198;
    prim_out_165694 = min_res_144186;
    prim_out_165695 = max_res_144201;
    prim_out_165696 = min_res_144189;
    prim_out_165697 = count_84366;
    *out_prim_out_166375 = prim_out_165693;
    *out_prim_out_166376 = prim_out_165694;
    *out_prim_out_166377 = prim_out_165695;
    *out_prim_out_166378 = prim_out_165696;
    *out_prim_out_166379 = prim_out_165697;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_scatter_13032(struct futhark_context *ctx, struct memblock *mem_out_p_166380, struct memblock dest_mem_164928, struct memblock is_mem_164929, struct memblock vs_mem_164930, int64_t nd_141122, int64_t n_141123, int64_t psizze_141124)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_164935_cached_sizze_166381 = 0;
    unsigned char *mem_164935 = NULL;
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    bool zzero_141132 = psizze_141124 == (int64_t) 0;
    bool nonzzero_141133 = !zzero_141132;
    bool nonzzero_cert_141134;
    
    if (!nonzzero_141133) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:66:23-29\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_141128 = add64(nd_141122, psizze_141124);
    int64_t zs_lhs_141130 = sub64(zm_lhs_141128, (int64_t) 1);
    int64_t m_141135 = sdiv64(zs_lhs_141130, psizze_141124);
    bool loop_cond_141139 = slt64((int64_t) 0, m_141135);
    bool partitioned_scatter_res_141140;
    int64_t partitioned_scatter_res_141142;
    bool loop_while_141143;
    int64_t p_141145;
    
    loop_while_141143 = loop_cond_141139;
    p_141145 = (int64_t) 0;
    while (loop_while_141143) {
        int64_t lower_bound_141146 = mul64(psizze_141124, p_141145);
        int64_t min_arg1_141148 = add64(psizze_141124, lower_bound_141146);
        int64_t min_res_144330 = smin64(nd_141122, min_arg1_141148);
        int64_t j_m_i_141157 = sub64(min_res_144330, lower_bound_141146);
        bool empty_slice_141164 = j_m_i_141157 == (int64_t) 0;
        int64_t m_141165 = sub64(j_m_i_141157, (int64_t) 1);
        int64_t i_p_m_t_s_141167 = add64(lower_bound_141146, m_141165);
        bool zzero_leq_i_p_m_t_s_141168 = sle64((int64_t) 0, i_p_m_t_s_141167);
        bool i_p_m_t_s_leq_w_141170 = slt64(i_p_m_t_s_141167, nd_141122);
        bool zzero_lte_i_141171 = sle64((int64_t) 0, lower_bound_141146);
        bool i_lte_j_141172 = sle64(lower_bound_141146, min_res_144330);
        bool y_141173 = i_p_m_t_s_leq_w_141170 && zzero_lte_i_141171;
        bool y_141174 = zzero_leq_i_p_m_t_s_141168 && y_141173;
        bool forwards_ok_141175 = i_lte_j_141172 && y_141174;
        bool ok_or_empty_141182 = empty_slice_141164 || forwards_ok_141175;
        bool index_certs_141184;
        
        if (!ok_or_empty_141182) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lower_bound_141146, ":", (long long) min_res_144330, "] out of bounds for array of shape [", (long long) nd_141122, "].", "-> #0  ftbasics.fut:72:25-56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_164934 = (int64_t) 8 * j_m_i_141157;
        
        if (mem_164935_cached_sizze_166381 < bytes_164934) {
            err = lexical_realloc(ctx, &mem_164935, &mem_164935_cached_sizze_166381, bytes_164934);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_164935, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) dest_mem_164928.mem, (int64_t) 0 + (int64_t) 1 * lower_bound_141146, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_141157});
        for (int64_t write_iter_164711 = 0; write_iter_164711 < n_141123; write_iter_164711++) {
            int64_t write_iv_164713 = ((int64_t *) vs_mem_164930.mem)[write_iter_164711];
            int64_t write_iv_164714 = ((int64_t *) is_mem_164929.mem)[write_iter_164711];
            bool cond_157006 = sle64(lower_bound_141146, write_iv_164714);
            bool cond_t_res_157007 = slt64(write_iv_164714, min_res_144330);
            bool x_157008 = cond_157006 && cond_t_res_157007;
            int64_t lifted_lambda_res_157009;
            
            if (x_157008) {
                int64_t lifted_lambda_res_t_res_157015 = sub64(write_iv_164714, lower_bound_141146);
                
                lifted_lambda_res_157009 = lifted_lambda_res_t_res_157015;
            } else {
                lifted_lambda_res_157009 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_157009) && slt64(lifted_lambda_res_157009, j_m_i_141157)) {
                ((int64_t *) mem_164935)[lifted_lambda_res_157009] = write_iv_164713;
            }
        }
        
        int64_t tmp_141202 = add64((int64_t) 1, p_141145);
        
        lmad_copy_8b(ctx, 1, (uint64_t *) dest_mem_164928.mem, lower_bound_141146, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_164935, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_141157});
        
        bool loop_cond_141247 = slt64(tmp_141202, m_141135);
        bool loop_while_tmp_165694 = loop_cond_141247;
        int64_t p_tmp_165696 = tmp_141202;
        
        loop_while_141143 = loop_while_tmp_165694;
        p_141145 = p_tmp_165696;
    }
    partitioned_scatter_res_141140 = loop_while_141143;
    partitioned_scatter_res_141142 = p_141145;
    if (memblock_set(ctx, &mem_out_165693, &dest_mem_164928, "dest_mem_164928") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_166380, &mem_out_165693, "mem_out_165693") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_164935);
        if (memblock_unref(ctx, &mem_out_165693, "mem_out_165693") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_166382, int32_t bit_79456, int8_t x_79457, int32_t b_79458)
{
    (void) ctx;
    
    int err = 0;
    int8_t prim_out_165693;
    int32_t i32_arg0_79459 = shl32(1, bit_79456);
    int32_t i32_arg_79461 = ~i32_arg0_79459;
    int8_t unsign_arg0_144329 = zext_i32_i8(i32_arg_79461);
    int8_t unsign_arg0_155445 = x_79457 & unsign_arg0_144329;
    int32_t i32_arg0_79466 = shl32(b_79458, bit_79456);
    int8_t unsign_arg0_144331 = zext_i32_i8(i32_arg0_79466);
    int8_t unsign_arg0_144334 = unsign_arg0_144331 | unsign_arg0_155445;
    
    prim_out_165693 = unsign_arg0_144334;
    *out_prim_out_166382 = prim_out_165693;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_partitionInfo *in4, const struct futhark_opaque_radix_hashTable *in5, const int64_t in6)
{
    int64_t nR_144113 = (int64_t) 0;
    int64_t b_144114 = (int64_t) 0;
    int64_t nS_144115 = (int64_t) 0;
    int64_t dz2081U_144116 = (int64_t) 0;
    int64_t dz2081U_144117 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118 = (int64_t) 0;
    int32_t radix_sizze_144119 = 0;
    int32_t maxDepth_144124 = 0;
    int32_t maxDepth_144127 = 0;
    int64_t scatter_psizze_144130 = (int64_t) 0;
    int64_t prim_out_165696 = (int64_t) 0;
    int64_t prim_out_165697 = (int64_t) 0;
    int64_t prim_out_165698 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock last_info_idx_mem_164935;
    
    last_info_idx_mem_164935.references = NULL;
    
    struct memblock first_info_idx_mem_164934;
    
    first_info_idx_mem_164934.references = NULL;
    
    struct memblock depths_mem_164933;
    
    depths_mem_164933.references = NULL;
    
    struct memblock bounds_mem_164932;
    
    bounds_mem_164932.references = NULL;
    
    struct memblock depths_mem_164931;
    
    depths_mem_164931.references = NULL;
    
    struct memblock bounds_mem_164930;
    
    bounds_mem_164930.references = NULL;
    
    struct memblock pS_mem_164929;
    
    pS_mem_164929.references = NULL;
    
    struct memblock pR_mem_164928;
    
    pR_mem_164928.references = NULL;
    radix_sizze_144119 = in0;
    pR_mem_164928 = in1->mem;
    nR_144113 = in1->shape[0];
    b_144114 = in1->shape[1];
    pS_mem_164929 = in2->mem;
    nS_144115 = in2->shape[0];
    b_144114 = in2->shape[1];
    bounds_mem_164930 = in3->v0->mem;
    dz2081U_144116 = in3->v0->shape[0];
    depths_mem_164931 = in3->v1->mem;
    dz2081U_144116 = in3->v1->shape[0];
    maxDepth_144124 = in3->v2;
    bounds_mem_164932 = in4->v0->mem;
    dz2081U_144117 = in4->v0->shape[0];
    depths_mem_164933 = in4->v1->mem;
    dz2081U_144117 = in4->v1->shape[0];
    maxDepth_144127 = in4->v2;
    first_info_idx_mem_164934 = in5->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118 = in5->v0->shape[0];
    last_info_idx_mem_164935 = in5->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118 = in5->v1->shape[0];
    scatter_psizze_144130 = in6;
    if (!((nR_144113 == in1->shape[0] && b_144114 == in1->shape[1]) && ((nS_144115 == in2->shape[0] && b_144114 == in2->shape[1]) && ((dz2081U_144116 == in3->v0->shape[0] && dz2081U_144116 == in3->v1->shape[0]) && ((dz2081U_144117 == in4->v0->shape[0] && dz2081U_144117 == in4->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118 == in5->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118 == in5->v1->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join(ctx, &mem_out_165693, &mem_out_165694, &mem_out_165695, &prim_out_165696, &prim_out_165697, &prim_out_165698, pR_mem_164928, pS_mem_164929, bounds_mem_164930, depths_mem_164931, bounds_mem_164932, depths_mem_164933, first_info_idx_mem_164934, last_info_idx_mem_164935, nR_144113, b_144114, nS_144115, dz2081U_144116, dz2081U_144117, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_144118, radix_sizze_144119, maxDepth_144124, maxDepth_144127, scatter_psizze_144130);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165696;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165697;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_165695;
            (*out0)->v2->shape[0] = prim_out_165698;
            (*out0)->v2->shape[1] = b_144114;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0)
{
    int64_t n_74295 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_164928;
    
    ks_mem_164928.references = NULL;
    ks_mem_164928 = in0->mem;
    n_74295 = in0->shape[0];
    if (!(n_74295 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_double(ctx, &prim_out_165693, ks_mem_164928, n_74295);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0)
{
    int64_t n_74118 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_164928;
    
    ks_mem_164928.references = NULL;
    ks_mem_164928 = in0->mem;
    n_74118 = in0->shape[0];
    if (!(n_74118 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_float(ctx, &prim_out_165693, ks_mem_164928, n_74118);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t n_73767 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_164928;
    
    ks_mem_164928.references = NULL;
    ks_mem_164928 = in0->mem;
    n_73767 = in0->shape[0];
    if (!(n_73767 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_int(ctx, &prim_out_165693, ks_mem_164928, n_73767);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t n_73941 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_164928;
    
    ks_mem_164928.references = NULL;
    ks_mem_164928 = in0->mem;
    n_73941 = in0->shape[0];
    if (!(n_73941 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_long(ctx, &prim_out_165693, ks_mem_164928, n_73941);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t n_73593 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_164928;
    
    ks_mem_164928.references = NULL;
    ks_mem_164928 = in0->mem;
    n_73593 = in0->shape[0];
    if (!(n_73593 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_short(ctx, &prim_out_165693, ks_mem_164928, n_73593);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4)
{
    int64_t n_140775 = (int64_t) 0;
    int64_t b_140776 = (int64_t) 0;
    int32_t radix_sizze_140777 = 0;
    int64_t offset_140779 = (int64_t) 0;
    int64_t sizze_thresh_140780 = (int64_t) 0;
    int32_t max_depth_140781 = 0;
    int64_t prim_out_165695 = (int64_t) 0;
    int32_t prim_out_165696 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pXs_mem_164928;
    
    pXs_mem_164928.references = NULL;
    radix_sizze_140777 = in0;
    pXs_mem_164928 = in1->mem;
    n_140775 = in1->shape[0];
    b_140776 = in1->shape[1];
    offset_140779 = in2;
    sizze_thresh_140780 = in3;
    max_depth_140781 = in4;
    if (!(n_140775 == in1->shape[0] && b_140776 == in1->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_partitions_from_partitioned_set(ctx, &mem_out_165693, &mem_out_165694, &prim_out_165695, &prim_out_165696, pXs_mem_164928, n_140775, b_140776, radix_sizze_140777, offset_140779, sizze_thresh_140780, max_depth_140781);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionInfo *) malloc(sizeof(struct futhark_opaque_partitionInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165695;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165695;
            (*out0)->v2 = prim_out_165696;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3)
{
    int64_t n_141596 = (int64_t) 0;
    int64_t b_141597 = (int64_t) 0;
    int64_t dz2080U_141598 = (int64_t) 0;
    int64_t dz2081U_141599 = (int64_t) 0;
    int32_t radix_sizze_141600 = 0;
    int32_t maxDepth_141604 = 0;
    int64_t scatter_psizze_141605 = (int64_t) 0;
    int64_t prim_out_165695 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock depths_mem_164930;
    
    depths_mem_164930.references = NULL;
    
    struct memblock bounds_mem_164929;
    
    bounds_mem_164929.references = NULL;
    
    struct memblock pXs_mem_164928;
    
    pXs_mem_164928.references = NULL;
    radix_sizze_141600 = in0;
    pXs_mem_164928 = in1->mem;
    n_141596 = in1->shape[0];
    b_141597 = in1->shape[1];
    bounds_mem_164929 = in2->v0->mem;
    dz2080U_141598 = in2->v0->shape[0];
    depths_mem_164930 = in2->v1->mem;
    dz2081U_141599 = in2->v1->shape[0];
    maxDepth_141604 = in2->v2;
    scatter_psizze_141605 = in3;
    if (!((n_141596 == in1->shape[0] && b_141597 == in1->shape[1]) && (dz2080U_141598 == in2->v0->shape[0] && dz2081U_141599 == in2->v1->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_create_hash_table_from_partitioned_set(ctx, &mem_out_165693, &mem_out_165694, &prim_out_165695, pXs_mem_164928, bounds_mem_164929, depths_mem_164930, n_141596, b_141597, dz2080U_141598, dz2081U_141599, radix_sizze_141600, maxDepth_141604, scatter_psizze_141605);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_radix_hashTable *) malloc(sizeof(struct futhark_opaque_radix_hashTable))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165695;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165695;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4)
{
    int64_t niz2084U_77908 = (int64_t) 0;
    int64_t dz2083U_77909 = (int64_t) 0;
    int64_t incr_77910 = (int64_t) 0;
    int64_t psizze_77911 = (int64_t) 0;
    int64_t pL_bytes_77913 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_77910 = in0;
    psizze_77911 = in1;
    is_mem_164928 = in2->mem;
    niz2084U_77908 = in2->shape[0];
    pL_bytes_77913 = in3;
    ys_mem_164929 = in4->mem;
    dz2083U_77909 = in4->shape[0];
    if (!(niz2084U_77908 == in2->shape[0] && (dz2083U_77909 == in4->shape[0] && pL_bytes_77913 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_GFTR(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, niz2084U_77908, dz2083U_77909, incr_77910, psizze_77911, pL_bytes_77913);
        if (ret == 0) {
            assert((*out0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = niz2084U_77908;
            (*out0)->shape[1] = pL_bytes_77913;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t niz2084U_77444 = (int64_t) 0;
    int64_t dz2083U_77445 = (int64_t) 0;
    int64_t incr_77446 = (int64_t) 0;
    int64_t psizze_77447 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_77446 = in0;
    psizze_77447 = in1;
    is_mem_164928 = in2->mem;
    niz2084U_77444 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    dz2083U_77445 = in3->shape[0];
    if (!(niz2084U_77444 == in2->shape[0] && dz2083U_77445 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, niz2084U_77444, dz2083U_77445, incr_77446, psizze_77447);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = niz2084U_77444;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4)
{
    int64_t ni_79416 = (int64_t) 0;
    int64_t n_79417 = (int64_t) 0;
    int64_t incr_79418 = (int64_t) 0;
    int64_t psizze_79419 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164930;
    
    ys_mem_164930.references = NULL;
    
    struct memblock is_mem_164929;
    
    is_mem_164929.references = NULL;
    
    struct memblock preVals_mem_164928;
    
    preVals_mem_164928.references = NULL;
    incr_79418 = in0;
    psizze_79419 = in1;
    preVals_mem_164928 = in2->mem;
    ni_79416 = in2->shape[0];
    is_mem_164929 = in3->mem;
    ni_79416 = in3->shape[0];
    ys_mem_164930 = in4->mem;
    n_79417 = in4->shape[0];
    if (!(ni_79416 == in2->shape[0] && (ni_79416 == in3->shape[0] && n_79417 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double_GFUR(ctx, &mem_out_165693, preVals_mem_164928, is_mem_164929, ys_mem_164930, ni_79416, n_79417, incr_79418, psizze_79419);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = ni_79416;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t niz2084U_77164 = (int64_t) 0;
    int64_t dz2083U_77165 = (int64_t) 0;
    int64_t incr_77166 = (int64_t) 0;
    int64_t psizze_77167 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_77166 = in0;
    psizze_77167 = in1;
    is_mem_164928 = in2->mem;
    niz2084U_77164 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    dz2083U_77165 = in3->shape[0];
    if (!(niz2084U_77164 == in2->shape[0] && dz2083U_77165 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, niz2084U_77164, dz2083U_77165, incr_77166, psizze_77167);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = niz2084U_77164;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4)
{
    int64_t ni_79115 = (int64_t) 0;
    int64_t n_79116 = (int64_t) 0;
    int64_t incr_79117 = (int64_t) 0;
    int64_t psizze_79118 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164930;
    
    ys_mem_164930.references = NULL;
    
    struct memblock is_mem_164929;
    
    is_mem_164929.references = NULL;
    
    struct memblock preVals_mem_164928;
    
    preVals_mem_164928.references = NULL;
    incr_79117 = in0;
    psizze_79118 = in1;
    preVals_mem_164928 = in2->mem;
    ni_79115 = in2->shape[0];
    is_mem_164929 = in3->mem;
    ni_79115 = in3->shape[0];
    ys_mem_164930 = in4->mem;
    n_79116 = in4->shape[0];
    if (!(ni_79115 == in2->shape[0] && (ni_79115 == in3->shape[0] && n_79116 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float_GFUR(ctx, &mem_out_165693, preVals_mem_164928, is_mem_164929, ys_mem_164930, ni_79115, n_79116, incr_79117, psizze_79118);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = ni_79115;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t niz2084U_76604 = (int64_t) 0;
    int64_t dz2083U_76605 = (int64_t) 0;
    int64_t incr_76606 = (int64_t) 0;
    int64_t psizze_76607 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_76606 = in0;
    psizze_76607 = in1;
    is_mem_164928 = in2->mem;
    niz2084U_76604 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    dz2083U_76605 = in3->shape[0];
    if (!(niz2084U_76604 == in2->shape[0] && dz2083U_76605 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, niz2084U_76604, dz2083U_76605, incr_76606, psizze_76607);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = niz2084U_76604;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4)
{
    int64_t ni_78513 = (int64_t) 0;
    int64_t n_78514 = (int64_t) 0;
    int64_t incr_78515 = (int64_t) 0;
    int64_t psizze_78516 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164930;
    
    ys_mem_164930.references = NULL;
    
    struct memblock is_mem_164929;
    
    is_mem_164929.references = NULL;
    
    struct memblock preVals_mem_164928;
    
    preVals_mem_164928.references = NULL;
    incr_78515 = in0;
    psizze_78516 = in1;
    preVals_mem_164928 = in2->mem;
    ni_78513 = in2->shape[0];
    is_mem_164929 = in3->mem;
    ni_78513 = in3->shape[0];
    ys_mem_164930 = in4->mem;
    n_78514 = in4->shape[0];
    if (!(ni_78513 == in2->shape[0] && (ni_78513 == in3->shape[0] && n_78514 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int_GFUR(ctx, &mem_out_165693, preVals_mem_164928, is_mem_164929, ys_mem_164930, ni_78513, n_78514, incr_78515, psizze_78516);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = ni_78513;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t niz2084U_76884 = (int64_t) 0;
    int64_t dz2083U_76885 = (int64_t) 0;
    int64_t incr_76886 = (int64_t) 0;
    int64_t psizze_76887 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_76886 = in0;
    psizze_76887 = in1;
    is_mem_164928 = in2->mem;
    niz2084U_76884 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    dz2083U_76885 = in3->shape[0];
    if (!(niz2084U_76884 == in2->shape[0] && dz2083U_76885 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, niz2084U_76884, dz2083U_76885, incr_76886, psizze_76887);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = niz2084U_76884;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4)
{
    int64_t ni_78814 = (int64_t) 0;
    int64_t n_78815 = (int64_t) 0;
    int64_t incr_78816 = (int64_t) 0;
    int64_t psizze_78817 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164930;
    
    ys_mem_164930.references = NULL;
    
    struct memblock is_mem_164929;
    
    is_mem_164929.references = NULL;
    
    struct memblock preVals_mem_164928;
    
    preVals_mem_164928.references = NULL;
    incr_78816 = in0;
    psizze_78817 = in1;
    preVals_mem_164928 = in2->mem;
    ni_78814 = in2->shape[0];
    is_mem_164929 = in3->mem;
    ni_78814 = in3->shape[0];
    ys_mem_164930 = in4->mem;
    n_78815 = in4->shape[0];
    if (!(ni_78814 == in2->shape[0] && (ni_78814 == in3->shape[0] && n_78815 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long_GFUR(ctx, &mem_out_165693, preVals_mem_164928, is_mem_164929, ys_mem_164930, ni_78814, n_78815, incr_78816, psizze_78817);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = ni_78814;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t niz2084U_76324 = (int64_t) 0;
    int64_t dz2083U_76325 = (int64_t) 0;
    int64_t incr_76326 = (int64_t) 0;
    int64_t psizze_76327 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_76326 = in0;
    psizze_76327 = in1;
    is_mem_164928 = in2->mem;
    niz2084U_76324 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    dz2083U_76325 = in3->shape[0];
    if (!(niz2084U_76324 == in2->shape[0] && dz2083U_76325 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, niz2084U_76324, dz2083U_76325, incr_76326, psizze_76327);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = niz2084U_76324;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4)
{
    int64_t ni_78212 = (int64_t) 0;
    int64_t n_78213 = (int64_t) 0;
    int64_t incr_78214 = (int64_t) 0;
    int64_t psizze_78215 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164930;
    
    ys_mem_164930.references = NULL;
    
    struct memblock is_mem_164929;
    
    is_mem_164929.references = NULL;
    
    struct memblock preVals_mem_164928;
    
    preVals_mem_164928.references = NULL;
    incr_78214 = in0;
    psizze_78215 = in1;
    preVals_mem_164928 = in2->mem;
    ni_78212 = in2->shape[0];
    is_mem_164929 = in3->mem;
    ni_78212 = in3->shape[0];
    ys_mem_164930 = in4->mem;
    n_78213 = in4->shape[0];
    if (!(ni_78212 == in2->shape[0] && (ni_78212 == in3->shape[0] && n_78213 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short_GFUR(ctx, &mem_out_165693, preVals_mem_164928, is_mem_164929, ys_mem_164930, ni_78212, n_78213, incr_78214, psizze_78215);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = ni_78212;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_136036 = (int64_t) 0;
    int64_t nS_136037 = (int64_t) 0;
    int64_t offset_R_136040 = (int64_t) 0;
    int64_t offset_S_136041 = (int64_t) 0;
    int64_t partitionsPerWindow_136042 = (int64_t) 0;
    int64_t numberOfWindows_136043 = (int64_t) 0;
    int64_t extParallelism_136044 = (int64_t) 0;
    int64_t scatter_psizze_136045 = (int64_t) 0;
    int64_t prim_out_165696 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock tS_mem_164929;
    
    tS_mem_164929.references = NULL;
    
    struct memblock tR_mem_164928;
    
    tR_mem_164928.references = NULL;
    tR_mem_164928 = in0->mem;
    nR_136036 = in0->shape[0];
    tS_mem_164929 = in1->mem;
    nS_136037 = in1->shape[0];
    offset_R_136040 = in2;
    offset_S_136041 = in3;
    partitionsPerWindow_136042 = in4;
    numberOfWindows_136043 = in5;
    extParallelism_136044 = in6;
    scatter_psizze_136045 = in7;
    if (!(nR_136036 == in0->shape[0] && nS_136037 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_double(ctx, &mem_out_165693, &mem_out_165694, &mem_out_165695, &prim_out_165696, tR_mem_164928, tS_mem_164929, nR_136036, nS_136037, offset_R_136040, offset_S_136041, partitionsPerWindow_136042, numberOfWindows_136043, extParallelism_136044, scatter_psizze_136045);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_double *) malloc(sizeof(struct futhark_opaque_joinPairs_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165696;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165696;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_165695;
            (*out0)->v2->shape[0] = prim_out_165696;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_131064 = (int64_t) 0;
    int64_t nS_131065 = (int64_t) 0;
    int64_t offset_R_131068 = (int64_t) 0;
    int64_t offset_S_131069 = (int64_t) 0;
    int64_t partitionsPerWindow_131070 = (int64_t) 0;
    int64_t numberOfWindows_131071 = (int64_t) 0;
    int64_t extParallelism_131072 = (int64_t) 0;
    int64_t scatter_psizze_131073 = (int64_t) 0;
    int64_t prim_out_165696 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock tS_mem_164929;
    
    tS_mem_164929.references = NULL;
    
    struct memblock tR_mem_164928;
    
    tR_mem_164928.references = NULL;
    tR_mem_164928 = in0->mem;
    nR_131064 = in0->shape[0];
    tS_mem_164929 = in1->mem;
    nS_131065 = in1->shape[0];
    offset_R_131068 = in2;
    offset_S_131069 = in3;
    partitionsPerWindow_131070 = in4;
    numberOfWindows_131071 = in5;
    extParallelism_131072 = in6;
    scatter_psizze_131073 = in7;
    if (!(nR_131064 == in0->shape[0] && nS_131065 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_float(ctx, &mem_out_165693, &mem_out_165694, &mem_out_165695, &prim_out_165696, tR_mem_164928, tS_mem_164929, nR_131064, nS_131065, offset_R_131068, offset_S_131069, partitionsPerWindow_131070, numberOfWindows_131071, extParallelism_131072, scatter_psizze_131073);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_float *) malloc(sizeof(struct futhark_opaque_joinPairs_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165696;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165696;
            assert(((*out0)->v2 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_165695;
            (*out0)->v2->shape[0] = prim_out_165696;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_121202 = (int64_t) 0;
    int64_t nS_121203 = (int64_t) 0;
    int64_t offset_R_121206 = (int64_t) 0;
    int64_t offset_S_121207 = (int64_t) 0;
    int64_t partitionsPerWindow_121208 = (int64_t) 0;
    int64_t numberOfWindows_121209 = (int64_t) 0;
    int64_t extParallelism_121210 = (int64_t) 0;
    int64_t scatter_psizze_121211 = (int64_t) 0;
    int64_t prim_out_165696 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock tS_mem_164929;
    
    tS_mem_164929.references = NULL;
    
    struct memblock tR_mem_164928;
    
    tR_mem_164928.references = NULL;
    tR_mem_164928 = in0->mem;
    nR_121202 = in0->shape[0];
    tS_mem_164929 = in1->mem;
    nS_121203 = in1->shape[0];
    offset_R_121206 = in2;
    offset_S_121207 = in3;
    partitionsPerWindow_121208 = in4;
    numberOfWindows_121209 = in5;
    extParallelism_121210 = in6;
    scatter_psizze_121211 = in7;
    if (!(nR_121202 == in0->shape[0] && nS_121203 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_int(ctx, &mem_out_165693, &mem_out_165694, &mem_out_165695, &prim_out_165696, tR_mem_164928, tS_mem_164929, nR_121202, nS_121203, offset_R_121206, offset_S_121207, partitionsPerWindow_121208, numberOfWindows_121209, extParallelism_121210, scatter_psizze_121211);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_int *) malloc(sizeof(struct futhark_opaque_joinPairs_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165696;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165696;
            assert(((*out0)->v2 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_165695;
            (*out0)->v2->shape[0] = prim_out_165696;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_126092 = (int64_t) 0;
    int64_t nS_126093 = (int64_t) 0;
    int64_t offset_R_126096 = (int64_t) 0;
    int64_t offset_S_126097 = (int64_t) 0;
    int64_t partitionsPerWindow_126098 = (int64_t) 0;
    int64_t numberOfWindows_126099 = (int64_t) 0;
    int64_t extParallelism_126100 = (int64_t) 0;
    int64_t scatter_psizze_126101 = (int64_t) 0;
    int64_t prim_out_165696 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock tS_mem_164929;
    
    tS_mem_164929.references = NULL;
    
    struct memblock tR_mem_164928;
    
    tR_mem_164928.references = NULL;
    tR_mem_164928 = in0->mem;
    nR_126092 = in0->shape[0];
    tS_mem_164929 = in1->mem;
    nS_126093 = in1->shape[0];
    offset_R_126096 = in2;
    offset_S_126097 = in3;
    partitionsPerWindow_126098 = in4;
    numberOfWindows_126099 = in5;
    extParallelism_126100 = in6;
    scatter_psizze_126101 = in7;
    if (!(nR_126092 == in0->shape[0] && nS_126093 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_long(ctx, &mem_out_165693, &mem_out_165694, &mem_out_165695, &prim_out_165696, tR_mem_164928, tS_mem_164929, nR_126092, nS_126093, offset_R_126096, offset_S_126097, partitionsPerWindow_126098, numberOfWindows_126099, extParallelism_126100, scatter_psizze_126101);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_long *) malloc(sizeof(struct futhark_opaque_joinPairs_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165696;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165696;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_165695;
            (*out0)->v2->shape[0] = prim_out_165696;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5, const int64_t in6, const int64_t in7)
{
    int64_t nR_116230 = (int64_t) 0;
    int64_t nS_116231 = (int64_t) 0;
    int64_t offset_R_116234 = (int64_t) 0;
    int64_t offset_S_116235 = (int64_t) 0;
    int64_t partitionsPerWindow_116236 = (int64_t) 0;
    int64_t numberOfWindows_116237 = (int64_t) 0;
    int64_t extParallelism_116238 = (int64_t) 0;
    int64_t scatter_psizze_116239 = (int64_t) 0;
    int64_t prim_out_165696 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165695;
    
    mem_out_165695.references = NULL;
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock tS_mem_164929;
    
    tS_mem_164929.references = NULL;
    
    struct memblock tR_mem_164928;
    
    tR_mem_164928.references = NULL;
    tR_mem_164928 = in0->mem;
    nR_116230 = in0->shape[0];
    tS_mem_164929 = in1->mem;
    nS_116231 = in1->shape[0];
    offset_R_116234 = in2;
    offset_S_116235 = in3;
    partitionsPerWindow_116236 = in4;
    numberOfWindows_116237 = in5;
    extParallelism_116238 = in6;
    scatter_psizze_116239 = in7;
    if (!(nR_116230 == in0->shape[0] && nS_116231 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_short(ctx, &mem_out_165693, &mem_out_165694, &mem_out_165695, &prim_out_165696, tR_mem_164928, tS_mem_164929, nR_116230, nS_116231, offset_R_116234, offset_S_116235, partitionsPerWindow_116236, numberOfWindows_116237, extParallelism_116238, scatter_psizze_116239);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_short *) malloc(sizeof(struct futhark_opaque_joinPairs_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = prim_out_165696;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = prim_out_165696;
            assert(((*out0)->v2 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v2->mem = mem_out_165695;
            (*out0)->v2->shape[0] = prim_out_165696;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_74372 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_164928;
    
    eta_p_mem_164928.references = NULL;
    eta_p_mem_164928 = in0->mem;
    nz2080U_74372 = in0->shape[0];
    if (!(nz2080U_74372 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_max_idx(ctx, &prim_out_165693, eta_p_mem_164928, nz2080U_74372);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1)
{
    int64_t n_111087 = (int64_t) 0;
    int64_t incr_111088 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_111088 = in0;
    xs_mem_164928 = in1->mem;
    n_111087 = in1->shape[0];
    if (!(n_111087 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_double(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_111087, incr_111088);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_111087;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_111087;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1)
{
    int64_t n_108942 = (int64_t) 0;
    int64_t incr_108943 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_108943 = in0;
    xs_mem_164928 = in1->mem;
    n_108942 = in1->shape[0];
    if (!(n_108942 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_float(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_108942, incr_108943);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_108942;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_108942;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1)
{
    int64_t n_104656 = (int64_t) 0;
    int64_t incr_104657 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_104657 = in0;
    xs_mem_164928 = in1->mem;
    n_104656 = in1->shape[0];
    if (!(n_104656 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_int(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_104656, incr_104657);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_104656;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_104656;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1)
{
    int64_t n_106797 = (int64_t) 0;
    int64_t incr_106798 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_106798 = in0;
    xs_mem_164928 = in1->mem;
    n_106797 = in1->shape[0];
    if (!(n_106797 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_long(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_106797, incr_106798);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_106797;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_106797;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1)
{
    int64_t n_102511 = (int64_t) 0;
    int64_t incr_102512 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_102512 = in0;
    xs_mem_164928 = in1->mem;
    n_102511 = in1->shape[0];
    if (!(n_102511 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_short(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_102511, incr_102512);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_102511;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_102511;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0)
{
    int64_t n_95983 = (int64_t) 0;
    int64_t b_95984 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    k_mem_164928 = in0->v0->mem;
    n_95983 = in0->v0->shape[0];
    pL_mem_164929 = in0->v1->mem;
    n_95983 = in0->v1->shape[0];
    b_95984 = in0->v1->shape[1];
    if (!(n_95983 == in0->v0->shape[0] && (n_95983 == in0->v1->shape[0] && b_95984 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_double(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_95983, b_95984);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_95983;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_95983;
            (*out0)->v1->shape[1] = b_95984;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0)
{
    int64_t n_93618 = (int64_t) 0;
    int64_t b_93619 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    k_mem_164928 = in0->v0->mem;
    n_93618 = in0->v0->shape[0];
    pL_mem_164929 = in0->v1->mem;
    n_93618 = in0->v1->shape[0];
    b_93619 = in0->v1->shape[1];
    if (!(n_93618 == in0->v0->shape[0] && (n_93618 == in0->v1->shape[0] && b_93619 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_float(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_93618, b_93619);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_93618;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_93618;
            (*out0)->v1->shape[1] = b_93619;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0)
{
    int64_t n_88898 = (int64_t) 0;
    int64_t b_88899 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    k_mem_164928 = in0->v0->mem;
    n_88898 = in0->v0->shape[0];
    pL_mem_164929 = in0->v1->mem;
    n_88898 = in0->v1->shape[0];
    b_88899 = in0->v1->shape[1];
    if (!(n_88898 == in0->v0->shape[0] && (n_88898 == in0->v1->shape[0] && b_88899 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_int(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_88898, b_88899);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_88898;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_88898;
            (*out0)->v1->shape[1] = b_88899;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0)
{
    int64_t n_91253 = (int64_t) 0;
    int64_t b_91254 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    k_mem_164928 = in0->v0->mem;
    n_91253 = in0->v0->shape[0];
    pL_mem_164929 = in0->v1->mem;
    n_91253 = in0->v1->shape[0];
    b_91254 = in0->v1->shape[1];
    if (!(n_91253 == in0->v0->shape[0] && (n_91253 == in0->v1->shape[0] && b_91254 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_long(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_91253, b_91254);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_91253;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_91253;
            (*out0)->v1->shape[1] = b_91254;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0)
{
    int64_t n_86533 = (int64_t) 0;
    int64_t b_86534 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    k_mem_164928 = in0->v0->mem;
    n_86533 = in0->v0->shape[0];
    pL_mem_164929 = in0->v1->mem;
    n_86533 = in0->v1->shape[0];
    b_86534 = in0->v1->shape[1];
    if (!(n_86533 == in0->v0->shape[0] && (n_86533 == in0->v1->shape[0] && b_86534 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_short(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_86533, b_86534);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_86533;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_86533;
            (*out0)->v1->shape[1] = b_86534;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_74332 = (int64_t) 0;
    int64_t prim_out_165693 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_164928;
    
    eta_p_mem_164928.references = NULL;
    eta_p_mem_164928 = in0->mem;
    nz2080U_74332 = in0->shape[0];
    if (!(nz2080U_74332 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_min_idx(ctx, &prim_out_165693, eta_p_mem_164928, nz2080U_74332);
        if (ret == 0) {
            *out0 = prim_out_165693;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t n_76042 = (int64_t) 0;
    int64_t incr_76043 = (int64_t) 0;
    int64_t block_sizze_76044 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_76043 = in0;
    block_sizze_76044 = in1;
    is_mem_164928 = in2->mem;
    n_76042 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    n_76042 = in3->shape[0];
    if (!(n_76042 == in2->shape[0] && n_76042 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_double(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, n_76042, incr_76043, block_sizze_76044);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = n_76042;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t n_75708 = (int64_t) 0;
    int64_t incr_75709 = (int64_t) 0;
    int64_t block_sizze_75710 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_75709 = in0;
    block_sizze_75710 = in1;
    is_mem_164928 = in2->mem;
    n_75708 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    n_75708 = in3->shape[0];
    if (!(n_75708 == in2->shape[0] && n_75708 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_float(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, n_75708, incr_75709, block_sizze_75710);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = n_75708;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t n_75040 = (int64_t) 0;
    int64_t incr_75041 = (int64_t) 0;
    int64_t block_sizze_75042 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_75041 = in0;
    block_sizze_75042 = in1;
    is_mem_164928 = in2->mem;
    n_75040 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    n_75040 = in3->shape[0];
    if (!(n_75040 == in2->shape[0] && n_75040 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_int(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, n_75040, incr_75041, block_sizze_75042);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = n_75040;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t n_75374 = (int64_t) 0;
    int64_t incr_75375 = (int64_t) 0;
    int64_t block_sizze_75376 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_75375 = in0;
    block_sizze_75376 = in1;
    is_mem_164928 = in2->mem;
    n_75374 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    n_75374 = in3->shape[0];
    if (!(n_75374 == in2->shape[0] && n_75374 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_long(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, n_75374, incr_75375, block_sizze_75376);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = n_75374;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t n_74706 = (int64_t) 0;
    int64_t incr_74707 = (int64_t) 0;
    int64_t block_sizze_74708 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock ys_mem_164929;
    
    ys_mem_164929.references = NULL;
    
    struct memblock is_mem_164928;
    
    is_mem_164928.references = NULL;
    incr_74707 = in0;
    block_sizze_74708 = in1;
    is_mem_164928 = in2->mem;
    n_74706 = in2->shape[0];
    ys_mem_164929 = in3->mem;
    n_74706 = in3->shape[0];
    if (!(n_74706 == in2->shape[0] && n_74706 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_short(ctx, &mem_out_165693, is_mem_164928, ys_mem_164929, n_74706, incr_74707, block_sizze_74708);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_165693;
            (*out0)->shape[0] = n_74706;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6)
{
    int64_t n_138594 = (int64_t) 0;
    int64_t b_138595 = (int64_t) 0;
    int64_t pL_b_138596 = (int64_t) 0;
    int16_t block_sizze_138597 = (int16_t) 0;
    int64_t gather_psizze_138598 = (int64_t) 0;
    int32_t radix_sizze_138599 = 0;
    int64_t sizze_thresh_138602 = (int64_t) 0;
    int32_t max_depth_138603 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    block_sizze_138597 = in0;
    gather_psizze_138598 = in1;
    radix_sizze_138599 = in2;
    xs_mem_164928 = in3->mem;
    n_138594 = in3->shape[0];
    b_138595 = in3->shape[1];
    pL_mem_164929 = in4->mem;
    n_138594 = in4->shape[0];
    pL_b_138596 = in4->shape[1];
    sizze_thresh_138602 = in5;
    max_depth_138603 = in6;
    if (!((n_138594 == in3->shape[0] && b_138595 == in3->shape[1]) && (n_138594 == in4->shape[0] && pL_b_138596 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFTR(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, pL_mem_164929, n_138594, b_138595, pL_b_138596, block_sizze_138597, gather_psizze_138598, radix_sizze_138599, sizze_thresh_138602, max_depth_138603);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFTR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_138594;
            (*out0)->v0->shape[1] = b_138595;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_138594;
            (*out0)->v1->shape[1] = pL_b_138596;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6)
{
    int64_t n_139961 = (int64_t) 0;
    int64_t b_139962 = (int64_t) 0;
    int16_t block_sizze_139963 = (int16_t) 0;
    int64_t gather_psizze_139964 = (int64_t) 0;
    int32_t radix_sizze_139965 = 0;
    int64_t offset_139967 = (int64_t) 0;
    int64_t sizze_thresh_139968 = (int64_t) 0;
    int32_t max_depth_139969 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    block_sizze_139963 = in0;
    gather_psizze_139964 = in1;
    radix_sizze_139965 = in2;
    xs_mem_164928 = in3->mem;
    n_139961 = in3->shape[0];
    b_139962 = in3->shape[1];
    offset_139967 = in4;
    sizze_thresh_139968 = in5;
    max_depth_139969 = in6;
    if (!(n_139961 == in3->shape[0] && b_139962 == in3->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFUR(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_139961, b_139962, block_sizze_139963, gather_psizze_139964, radix_sizze_139965, offset_139967, sizze_thresh_139968, max_depth_139969);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFUR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_139961;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_139961;
            (*out0)->v1->shape[1] = b_139962;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int16_t in1, const struct futhark_f64_1d *in2)
{
    int64_t n_100365 = (int64_t) 0;
    int64_t incr_100366 = (int64_t) 0;
    int16_t block_sizze_100367 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_100366 = in0;
    block_sizze_100367 = in1;
    xs_mem_164928 = in2->mem;
    n_100365 = in2->shape[0];
    if (!(n_100365 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_double(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_100365, incr_100366, block_sizze_100367);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_100365;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_100365;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int16_t in1, const struct futhark_f32_1d *in2)
{
    int64_t n_99476 = (int64_t) 0;
    int64_t incr_99477 = (int64_t) 0;
    int16_t block_sizze_99478 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_99477 = in0;
    block_sizze_99478 = in1;
    xs_mem_164928 = in2->mem;
    n_99476 = in2->shape[0];
    if (!(n_99476 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_float(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_99476, incr_99477, block_sizze_99478);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_99476;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_99476;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int16_t in1, const struct futhark_i32_1d *in2)
{
    int64_t n_97719 = (int64_t) 0;
    int64_t incr_97720 = (int64_t) 0;
    int16_t block_sizze_97721 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_97720 = in0;
    block_sizze_97721 = in1;
    xs_mem_164928 = in2->mem;
    n_97719 = in2->shape[0];
    if (!(n_97719 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_int(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_97719, incr_97720, block_sizze_97721);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_97719;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_97719;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int16_t in1, const struct futhark_i64_1d *in2)
{
    int64_t n_98587 = (int64_t) 0;
    int64_t incr_98588 = (int64_t) 0;
    int16_t block_sizze_98589 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_98588 = in0;
    block_sizze_98589 = in1;
    xs_mem_164928 = in2->mem;
    n_98587 = in2->shape[0];
    if (!(n_98587 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_long(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_98587, incr_98588, block_sizze_98589);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_98587;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_98587;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int16_t in1, const struct futhark_i16_1d *in2)
{
    int64_t n_96851 = (int64_t) 0;
    int64_t incr_96852 = (int64_t) 0;
    int16_t block_sizze_96853 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock xs_mem_164928;
    
    xs_mem_164928.references = NULL;
    incr_96852 = in0;
    block_sizze_96853 = in1;
    xs_mem_164928 = in2->mem;
    n_96851 = in2->shape[0];
    if (!(n_96851 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_short(ctx, &mem_out_165693, &mem_out_165694, xs_mem_164928, n_96851, incr_96852, block_sizze_96853);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_96851;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_96851;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int16_t in0, const struct futhark_opaque_sortStruct_double *in1)
{
    int64_t n_84062 = (int64_t) 0;
    int64_t b_84063 = (int64_t) 0;
    int16_t block_sizze_84064 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    block_sizze_84064 = in0;
    k_mem_164928 = in1->v0->mem;
    n_84062 = in1->v0->shape[0];
    pL_mem_164929 = in1->v1->mem;
    n_84062 = in1->v1->shape[0];
    b_84063 = in1->v1->shape[1];
    if (!(n_84062 == in1->v0->shape[0] && (n_84062 == in1->v1->shape[0] && b_84063 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_double(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_84062, b_84063, block_sizze_84064);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_84062;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_84062;
            (*out0)->v1->shape[1] = b_84063;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int16_t in0, const struct futhark_opaque_sortStruct_float *in1)
{
    int64_t n_83112 = (int64_t) 0;
    int64_t b_83113 = (int64_t) 0;
    int16_t block_sizze_83114 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    block_sizze_83114 = in0;
    k_mem_164928 = in1->v0->mem;
    n_83112 = in1->v0->shape[0];
    pL_mem_164929 = in1->v1->mem;
    n_83112 = in1->v1->shape[0];
    b_83113 = in1->v1->shape[1];
    if (!(n_83112 == in1->v0->shape[0] && (n_83112 == in1->v1->shape[0] && b_83113 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_float(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_83112, b_83113, block_sizze_83114);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_83112;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_83112;
            (*out0)->v1->shape[1] = b_83113;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int16_t in0, const struct futhark_opaque_sortStruct_int *in1)
{
    int64_t n_81278 = (int64_t) 0;
    int64_t b_81279 = (int64_t) 0;
    int16_t block_sizze_81280 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    block_sizze_81280 = in0;
    k_mem_164928 = in1->v0->mem;
    n_81278 = in1->v0->shape[0];
    pL_mem_164929 = in1->v1->mem;
    n_81278 = in1->v1->shape[0];
    b_81279 = in1->v1->shape[1];
    if (!(n_81278 == in1->v0->shape[0] && (n_81278 == in1->v1->shape[0] && b_81279 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_int(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_81278, b_81279, block_sizze_81280);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_81278;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_81278;
            (*out0)->v1->shape[1] = b_81279;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int16_t in0, const struct futhark_opaque_sortStruct_long *in1)
{
    int64_t n_82166 = (int64_t) 0;
    int64_t b_82167 = (int64_t) 0;
    int16_t block_sizze_82168 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    block_sizze_82168 = in0;
    k_mem_164928 = in1->v0->mem;
    n_82166 = in1->v0->shape[0];
    pL_mem_164929 = in1->v1->mem;
    n_82166 = in1->v1->shape[0];
    b_82167 = in1->v1->shape[1];
    if (!(n_82166 == in1->v0->shape[0] && (n_82166 == in1->v1->shape[0] && b_82167 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_long(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_82166, b_82167, block_sizze_82168);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_82166;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_82166;
            (*out0)->v1->shape[1] = b_82167;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int16_t in0, const struct futhark_opaque_sortStruct_short *in1)
{
    int64_t n_80384 = (int64_t) 0;
    int64_t b_80385 = (int64_t) 0;
    int16_t block_sizze_80386 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_165694;
    
    mem_out_165694.references = NULL;
    
    struct memblock mem_out_165693;
    
    mem_out_165693.references = NULL;
    
    struct memblock pL_mem_164929;
    
    pL_mem_164929.references = NULL;
    
    struct memblock k_mem_164928;
    
    k_mem_164928.references = NULL;
    block_sizze_80386 = in0;
    k_mem_164928 = in1->v0->mem;
    n_80384 = in1->v0->shape[0];
    pL_mem_164929 = in1->v1->mem;
    n_80384 = in1->v1->shape[0];
    b_80385 = in1->v1->shape[1];
    if (!(n_80384 == in1->v0->shape[0] && (n_80384 == in1->v1->shape[0] && b_80385 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_short(ctx, &mem_out_165693, &mem_out_165694, k_mem_164928, pL_mem_164929, n_80384, b_80385, block_sizze_80386);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_165693;
            (*out0)->v0->shape[0] = n_80384;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_165694;
            (*out0)->v1->shape[0] = n_80384;
            (*out0)->v1->shape[1] = b_80385;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
